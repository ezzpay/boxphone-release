{"version":3,"sources":["webpack://ezpay-auto/external commonjs \"@nestjs/core\"","webpack://ezpay-auto/external commonjs \"@nestjs/common\"","webpack://ezpay-auto/external commonjs \"@nestjs/swagger\"","webpack://ezpay-auto/external node-commonjs \"path\"","webpack://ezpay-auto/./src/app.module.ts","webpack://ezpay-auto/external commonjs \"@nestjs/bull\"","webpack://ezpay-auto/external commonjs \"@nestjs/schedule\"","webpack://ezpay-auto/external commonjs \"@nestjs/axios\"","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.module.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.service.ts","webpack://ezpay-auto/./src/common/services/ezpay-be-client.service.ts","webpack://ezpay-auto/external commonjs \"rxjs\"","webpack://ezpay-auto/external commonjs \"form-data\"","webpack://ezpay-auto/external node-commonjs \"fs\"","webpack://ezpay-auto/./src/common/constants/config.ts","webpack://ezpay-auto/external commonjs \"dotenv\"","webpack://ezpay-auto/./src/common/utils/time.ts","webpack://ezpay-auto/./src/modules/bank/bank.service.ts","webpack://ezpay-auto/./src/modules/bank/acb.service.ts","webpack://ezpay-auto/./src/common/modules/websocket/constants/websocket.ts","webpack://ezpay-auto/./src/modules/device/device.service.ts","webpack://ezpay-auto/./src/common/services/redis.service.ts","webpack://ezpay-auto/external commonjs \"ioredis\"","webpack://ezpay-auto/./src/modules/hcbox/hcbox.service.ts","webpack://ezpay-auto/./src/modules/bank/base/base-bank.service.ts","webpack://ezpay-auto/external node-commonjs \"fs/promises\"","webpack://ezpay-auto/./src/modules/bank/constants/bill.ts","webpack://ezpay-auto/./src/modules/ocr/ocr.ts","webpack://ezpay-auto/external commonjs \"ocr-space-api-wrapper\"","webpack://ezpay-auto/./src/common/constants/keyboard.ts","webpack://ezpay-auto/./src/modules/bank/constants/acbank.ts","webpack://ezpay-auto/./src/modules/bank/pg.service.ts","webpack://ezpay-auto/./src/modules/bank/constants/pgbank.ts","webpack://ezpay-auto/./src/modules/bank/constants/pg-bank-search.ts","webpack://ezpay-auto/./src/modules/bank/session-management.service.ts","webpack://ezpay-auto/./src/modules/device/device-lock.service.ts","webpack://ezpay-auto/external node-commonjs \"crypto\"","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal-errors.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal-job-manager.service.ts","webpack://ezpay-auto/external commonjs \"bull\"","webpack://ezpay-auto/external commonjs \"lodash\"","webpack://ezpay-auto/./src/common/redis/cron-lock.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.controller.ts","webpack://ezpay-auto/./src/modules/hcbox/hcbox.module.ts","webpack://ezpay-auto/./src/modules/device/device.module.ts","webpack://ezpay-auto/./src/modules/device/device.controller.ts","webpack://ezpay-auto/./src/modules/device/dto/device-config.dto.ts","webpack://ezpay-auto/external commonjs \"class-validator\"","webpack://ezpay-auto/./src/modules/bank/bank.module.ts","webpack://ezpay-auto/./src/modules/bank/bank.controller.ts","webpack://ezpay-auto/./src/common/modules/websocket/websocket.module.ts","webpack://ezpay-auto/./src/common/modules/websocket/hc-websocket.service.ts","webpack://ezpay-auto/external commonjs \"ws\"","webpack://ezpay-auto/./src/common/modules/websocket/panda-websocket.service.ts","webpack://ezpay-auto/./src/modules/bank/session-refresh.scheduler.ts","webpack://ezpay-auto/webpack/bootstrap","webpack://ezpay-auto/./src/main.ts"],"names":["module","require","AppModule","imports","redis","host","port","db","password","defaultJobOptions","removeOnComplete","removeOnFail","attempts","backoff","type","delay","providers","exports","WithdrawalModule","name","HcBoxModule","controllers","WithdrawalService","ezpayBeClient","bankService","deviceLock","redisService","wsService","deviceService","withdrawalId","key","this","status","error","message","withdrawal","assignedDeviceId","bankCode","amount","reason","assumedProcessing","processingSuccess","deviceConfig","deviceId","analysisResult","analyzedStatus","stack","sourceAccountNo","sourceBankCode","receipt","Inject","EzpayBeClientService","httpService","payload","attempt","url","formdata","FormData","response","headers","timeout","console","code","details","depth","axiosError","errorMessage","JSON","Math","path","process","boxType","parseInt","ezpayBe","apiUrl","apiKey","spaceocr","datacenterPrimary","datacenterSecond","keyFree","ms","Promise","resolve","setTimeout","BankService","acbService","pgService","hcBoxService","sessionManagement","Map","service","Array","force","lock","Error","operationId","Date","activeDevices","device","loginPromises","withdrawalCode","session","needsRefresh","isValidSession","AcbService","BaseBankService","super","options","x","y","config","xReturn","yReturn","Symbol","DeviceService","devices","async","availableAmount","smartOTP","accountNo","accountName","data","dto","existing","newAmount","RedisService","enableReadyCheck","maxRetriesPerRequest","lazyConnect","err","redisClient","onModuleDestroy","value","ttl","client","ttlSeconds","score","member","start","stop","min","max","limit","members","field","HcBoxService","bankBundleId","VIETCOMBANK","TPBANK","TECHCOMBANK","duration","text","folderPath","logger","maxAttempts","folderCreated","folderCreationInProgress","recursive","maxRetries","BUNDLE_ID","transitionTime","log","folder","imageFile","imagePath","base64Image","ext","billImage","rawPath","ocrResult","result","language","scale","OCREngine","isTable","parsedText","processingTimeInMilliseconds","imageSource","datacenter","ocrUrl","successValue","lowerValue","v","coordinatesObj","factor","Object","HC_NUMPAD_LAYOUT","HC_COMMON_COORDINATES","KEYBOARD_SWITCH","SHIFT_KEY","RETURN_KEY","PANDA_COMMON_COORDINATES","PANDA_NUMPAD_LAYOUT","HC_ACB_UI_COORDINATES","LOGIN_BUTTON","LOGIN_BUTTON_API","PASSWORD_FIELD","PANDA_ACB_UI_COORDINATES","PgService","LOGIN_BTN","transferMethod","beneficiaryAccountNo","toString","quality","bank","searchValue","HC_PG_UI_COORDINATES","TRANSFER_BTN","TRANSFER_INTERNAL_BTN","TRANSFER_EXTERNAL_BTN","CLOSE_ALLOW_CONTACT_POPUP_BTN","ACCOUNT_NUMBER_INPUT","SELECT_BANK_BTN","SEARCH_BANK_BTN","INTERNAL_AMOUNT_INPUT","HIDE_NUMPAD_BTN","CONTINUE_TRANSFER_BTN","BANK_SEARCH_BTN","BANK_SEARCH_INPUT","EXTERNAL_AMOUNT_INPUT","BACK_TO_HOME","PANDA_PG_UI_COORDINATES","coordinates","AGRIBANK","BIDV","SACOMBANK","HDBank","VPBANK","MBBANK","MSB","LPBANK","ACB","ABBANK","NCB","EXIMBANK","SEABANK","SCB","PVCOMBANK","KIENLONGBANK","BVBANK","VIETINBANK","OCB","VIETBANK","SHB","NAMABANK","SHINHANBANKVIETNAM","CIMB","SAIGONBANK","BACABANK","VIETABANK","GPBANK","HSBC","VRB","VIB","PANDA_PG_BANK_SEARCH_UI_COORDINATES","SessionManagementService","sessionTimeoutMs","refreshBeforeMs","expiresAt","loginTime","toUpperCase","refreshBeforeTime","DeviceLockService","lockType","lockedBy","metadataKey","lockId","lockMetadata","lockedAt","metadataStr","excludeType","additionalTtl","currentTtlSeconds","newTtlSeconds","ceil","ErrorType","fullText","pattern","WithdrawalProcessingError","errorType","WithdrawalJobManagerService","withdrawalService","withdrawalQueue","Set","isInitialized","availableDevices","udid","count","serviceStatus","capacity","jobsToPick","waitingJobs","length","i","job","removeError","currentRetries","manualRetryCount","lastErrorType","lastErrorReason","jobId","priority","now","delayedJobs","promoted","delayMs","e","String","waiting","delayed","active","completed","failed","processingJobs","queue","total","stats","getQueueStats","sampleWaitingJobs","id","opts","sampleDelayedJobs","periodicJobPicking","promoteDelayedJobsPeriodically","ttlMs","fn","lockVal","lua","WithdrawalController","jobManagerService","success","summary","description","DeviceModule","DeviceController","banks","existingConfig","errors","Get","UpdateDeviceConfigDto","o","IsString","IsNumber","IsOptional","BankModule","BankController","qualityValue","parseFloat","captureName","imageLength","xCoord","yCoord","isNaN","example","endX","endY","isPandaFormat","isHCFormat","pandaOptions","endXCoord","endYCoord","durationValue","end","number","digits","d","note","required","WebSocketModule","Global","provide","useClass","HCWebSocketService","isConnected","isProcessingRequest","onModuleInit","reject","WebSocket","firstKey","firstHandler","request","setImmediate","requestId","timeoutId","originalResolve","originalReject","clearTimeout","action","deviceIds","deviceIdsStr","comm","filePath","bundleId","content","char","currentMode","charLower","isUppercase","keyToLookup","keyCoords","requiredMode","digit","PandaWebSocketService","messageStr","deviceList","requestStr","savePath","SessionRefreshScheduler","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","app","viewsPath","NODE_ENV","__dirname","transform","whitelist","forbidNonWhitelisted","document"],"mappings":"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","sourcesContent":["module.exports = require(\"@nestjs/core\");","module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/swagger\");","module.exports = require(\"path\");","import { Module } from '@nestjs/common';\nimport { BullModule } from '@nestjs/bull';\nimport { ScheduleModule } from '@nestjs/schedule';\nimport { HttpModule } from '@nestjs/axios';\n\nimport { WithdrawalModule } from './modules/withdrawal/withdrawal.module';\nimport { HcBoxModule } from './modules/hcbox/hcbox.module';\nimport { DeviceModule } from './modules/device/device.module';\nimport { RedisService } from './common/services/redis.service';\nimport { WebSocketModule } from './common/modules/websocket/websocket.module';\nimport { config } from './common/constants/config';\nimport { BankModule } from './modules/bank/bank.module';\n\n@Module({\n  imports: [\n    BullModule.forRoot({\n      redis: {\n        host: config.redis.host,\n        port: config.redis.port,\n        db: config.redis.db,\n        password: config.redis.password,\n      },\n      defaultJobOptions: {\n        removeOnComplete: 10, // Keep last 10 completed jobs\n        removeOnFail: 50, // Keep last 50 failed jobs\n        attempts: 3, // Retry failed jobs 3 times\n        backoff: {\n          type: 'exponential',\n          delay: 2000, // 2 seconds initial delay\n        },\n      },\n    }),\n\n    // Scheduling\n    ScheduleModule.forRoot(),\n\n    // HTTP client\n    HttpModule,\n\n    // Feature modules\n    WithdrawalModule,\n    HcBoxModule,\n    DeviceModule,\n    WebSocketModule,\n    BankModule\n  ],\n  providers: [\n    RedisService,\n  ],\n  exports: [RedisService],\n})\nexport class AppModule {}\n\n","module.exports = require(\"@nestjs/bull\");","module.exports = require(\"@nestjs/schedule\");","module.exports = require(\"@nestjs/axios\");","import { Module, forwardRef } from '@nestjs/common';\nimport { BullModule } from '@nestjs/bull';\nimport { ScheduleModule } from '@nestjs/schedule';\nimport { WithdrawalService } from './withdrawal.service';\nimport { WithdrawalJobManagerService } from './withdrawal-job-manager.service';\nimport { WithdrawalController } from './withdrawal.controller';\nimport { EzpayBeClientService } from '../../common/services/ezpay-be-client.service';\nimport { RedisService } from '../../common/services/redis.service';\nimport { HcBoxModule } from '../hcbox/hcbox.module';\nimport { DeviceModule } from '../device/device.module';\nimport { BankModule } from '../bank/bank.module';\nimport { HttpModule } from '@nestjs/axios';\n\n@Module({\n  imports: [\n    BullModule.registerQueue({\n      name: 'wda-request', // Single queue - jobs c pick th cng\n    }),\n    ScheduleModule,\n    HcBoxModule,\n    forwardRef(() => DeviceModule),\n    BankModule,\n    HttpModule,\n  ],\n  controllers: [WithdrawalController],\n  providers: [\n    WithdrawalService,\n    WithdrawalJobManagerService,\n    EzpayBeClientService,\n    RedisService,\n  ],\n  exports: [WithdrawalService],\n})\nexport class WithdrawalModule {}\n\n","import { Injectable, Logger, Inject, forwardRef } from '@nestjs/common';\nimport { EzpayBeClientService } from '../../common/services/ezpay-be-client.service';\nimport { BankService } from '../bank/bank.service';\nimport { DeviceService } from '../device/device.service';\nimport { DeviceLockService } from '../device/device-lock.service';\nimport { RedisService } from '../../common/services/redis.service';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WithdrawalProcessingError, ErrorType } from './withdrawal-errors';\nimport { IAnalyzeTransferBillResult } from '../bank/interfaces/bank-service.interface';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\n\n@Injectable()\nexport class WithdrawalService {\n  private readonly logger = new Logger(WithdrawalService.name);\n  private readonly REDIS_PROCESSED_PREFIX = 'withdrawal:processed:';\n  private readonly PROCESSING_TTL = 3600 * 1000; // 1 hour in milliseconds\n  private readonly COMPLETED_TTL = 86400 * 1000; // 24 hours in milliseconds\n\n  constructor(\n    private readonly ezpayBeClient: EzpayBeClientService,\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    private readonly bankService: BankService,\n    @Inject(forwardRef(() => DeviceService))\n    private readonly deviceService: DeviceService,\n    private readonly deviceLock: DeviceLockService,\n    private readonly redisService: RedisService,\n  ) { }\n\n  /**\n   * Check if withdrawal was already processed\n   */\n  private async checkIfProcessed(withdrawalId: string): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      const status = await this.redisService.get(key);\n\n      if (status === 'completed') {\n        this.logger.warn(`Withdrawal ${withdrawalId} already completed`);\n        return true;\n      }\n\n      if (status === 'processing') {\n        this.logger.warn(`Withdrawal ${withdrawalId} is being processed by another instance`);\n        return true;\n      }\n\n      return false;\n    } catch (error) {\n      this.logger.error(`Error checking processed status for ${withdrawalId}: ${error.message}`);\n      // If Redis check fails, allow processing (fail open)\n      return false;\n    }\n  }\n\n  /**\n   * Mark withdrawal as processing (atomic operation using SETNX)\n   */\n  private async markAsProcessing(withdrawalId: string): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      // Use SETNX (SET if Not eXists) - atomic operation\n      // This ensures only one instance can mark as processing\n      const result = await this.redisService.setnx(key, 'processing', this.PROCESSING_TTL);\n\n      if (result === 'OK') {\n        this.logger.debug(`Marked withdrawal ${withdrawalId} as processing`);\n        return true;\n      }\n\n      // Key already exists - another instance is processing\n      this.logger.warn(`Withdrawal ${withdrawalId} is already being processed by another instance`);\n\n      return false;\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as processing: ${error.message}`);\n      // If Redis fails, allow processing (fail open)\n      return true;\n    }\n  }\n\n  /**\n   * Mark withdrawal as completed\n   */\n  private async markAsCompleted(withdrawalId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      await this.redisService.set(key, 'completed', this.COMPLETED_TTL);\n      this.logger.log(`Marked withdrawal ${withdrawalId} as completed`);\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as completed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Mark withdrawal as failed (remove from Redis to allow manual retry)\n   */\n  private async markAsFailed(withdrawalId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      await this.redisService.del(key);\n      this.logger.log(`Marked withdrawal ${withdrawalId} as failed (removed from processed list)`);\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as failed: ${error.message}`);\n    }\n  }\n\n  async processWithdrawal(withdrawal: Withdrawal, assignedDeviceId: string) {\n    const { withdrawalId, bankCode, amount } = withdrawal;\n\n    // 1. IDEMPOTENCY CHECK - m bo withdrawal cha c x l\n    const isProcessed = await this.checkIfProcessed(withdrawalId);\n    if (isProcessed) {\n      this.logger.warn(`Withdrawal ${withdrawalId} already processed or being processed, skipping`);\n\n      return;\n    }\n\n    // 2. Mark as processing (atomic operation)\n    const markAsProcessing = await this.markAsProcessing(withdrawalId);\n    if (!markAsProcessing) {\n      const reason = `Withdrawal ${withdrawalId} is being processed by another instance`;\n      this.logger.warn(reason);\n      // Throw error vi type TEMPORARY v c th retry sau khi instance khc xong\n      throw new WithdrawalProcessingError(reason, ErrorType.TEMPORARY, withdrawalId);\n    }\n\n    // Track Redis state  cleanup trong finally\n    let assumedProcessing = true; //  mark as processing\n    let processingSuccess = false; // Track xem c success khng\n\n    try {\n      this.logger.log(`Processing withdrawal: ${withdrawalId} for bank: ${bankCode}, amount: ${amount} on assigned device: ${assignedDeviceId}`);\n\n      const deviceConfig = await this.deviceService.getDeviceConfig(assignedDeviceId);\n      \n      // Verify assigned device is valid and ready\n      if (!deviceConfig || deviceConfig.status !== 'active') {\n        const reason = `Assigned device ${assignedDeviceId} is not active or not found`;\n        this.logger.error(reason);\n        await this.markAsFailed(withdrawalId);\n        assumedProcessing = false;\n        // Throw error vi type TEMPORARY v device c th active li sau\n        throw new WithdrawalProcessingError(reason, ErrorType.TEMPORARY, withdrawalId);\n      }\n\n      // TODO: 1 Auto find available balance for device\n      // Verify available amount\n      if (deviceConfig.availableAmount < amount) {\n        const reason = `Assigned device ${assignedDeviceId} has insufficient amount. Available: ${deviceConfig.availableAmount}, Required: ${amount}`;\n        this.logger.error(reason);\n        await this.markAsFailed(withdrawalId);\n        assumedProcessing = false;\n        await this.deviceService.updateDeviceConfig(assignedDeviceId, { status: 'deactive' });\n        throw new WithdrawalProcessingError(reason, ErrorType.TEMPORARY, withdrawalId);\n      }\n\n      // Check session of bank\n      const hasValidSession = await this.bankService.isSessionValid(assignedDeviceId, deviceConfig.bankCode);\n      if (!hasValidSession) {\n        const reason = `Assigned device ${assignedDeviceId} does not have valid session for bank ${deviceConfig.bankCode}`;\n        this.logger.error(reason);\n        await this.markAsFailed(withdrawalId);\n        assumedProcessing = false;\n        // Throw error vi type TEMPORARY v session c th c to li\n        throw new WithdrawalProcessingError(reason, ErrorType.TEMPORARY, withdrawalId);\n      }\n\n      const deviceId = assignedDeviceId;\n\n      await this.bankService.executeTransfer(withdrawal, deviceId, deviceConfig.bankCode);\n\n      this.deviceService.deductDeviceAmount(deviceId, amount).catch(() => {});\n\n      await this.markAsCompleted(withdrawalId);\n\n      // Mark as completed\n      processingSuccess = true; // nh du success\n      assumedProcessing = false; //  mark as completed, khng cn cleanup\n\n      const analysisResult = await this.bankService.analyzeTransferBill(deviceConfig.bankCode, withdrawal);\n\n      await this.notifyEzpayBe(withdrawal, analysisResult, deviceConfig);\n\n      if (analysisResult.analyzedStatus === 'unknown') {\n        await this.bankService.login(deviceConfig.bankCode, deviceId, true);\n      }\n\n      this.logger.log(`Successfully processed withdrawal: ${withdrawalId}`);\n    } catch (error) {\n      // Nu l WithdrawalProcessingError,  c markAsFailed ri, ch cn rethrow\n      if (error instanceof WithdrawalProcessingError) {\n        throw error; // Rethrow  job manager c th ly errorType\n      }\n\n      // Cc li khc\n      this.logger.error(`Error processing withdrawal ${withdrawalId}: ${error.message}`, error.stack);\n      await this.markAsFailed(withdrawalId);\n      assumedProcessing = false;\n      // Wrap unknown error\n      throw new WithdrawalProcessingError(\n        error.message || 'Unknown error',\n        ErrorType.UNKNOWN,\n        withdrawalId\n      );\n    } finally {\n      await this.deviceLock.releaseLock(assignedDeviceId);\n\n      // QUAN TRNG: Cleanup Redis nu  mark nhng cha cleanup (edge case: exception trc khi markAsFailed)\n      if (assumedProcessing && !processingSuccess) {\n        await this.markAsFailed(withdrawalId);\n      }\n    }\n  }\n\n  async notifyEzpayBe(withdrawal: Withdrawal, analysisResult: IAnalyzeTransferBillResult, deviceConfig: DeviceConfig): Promise<void> {\n    try {\n      const success = await this.ezpayBeClient.updateWithdrawalStatus(withdrawal._id, {\n        analyzedStatus: analysisResult.analyzedStatus,\n        sourceAccountNo: deviceConfig.accountNo,\n        sourceBankCode: deviceConfig.bankCode,\n        receipt: analysisResult.rawPath,\n      });\n      if (!success) {\n        this.logger.error(`Failed to notify ezpay-be about withdrawal ${withdrawal._id} status ${analysisResult.analyzedStatus}`);\n      }\n    } catch (error) {\n      this.logger.error(`Error notifying ezpay-be about withdrawal ${withdrawal._id}: ${error.message}`);\n      throw error;\n    }\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { HttpService } from '@nestjs/axios';\nimport { firstValueFrom } from 'rxjs';\nimport { AxiosError } from 'axios';\nimport * as FormData from 'form-data';\nimport { createReadStream } from 'fs';\nimport { config } from '../constants/config';\nimport { sleep } from '../utils/time';\nimport { BillAnalyzedStatus } from '@/modules/bank/interfaces/bank-service.interface';\n\n@Injectable()\nexport class EzpayBeClientService {\n  private readonly logger = new Logger(EzpayBeClientService.name);\n  private readonly apiUrl: string;\n  private readonly apiKey: string;\n\n  constructor(\n    private readonly httpService: HttpService\n  ) {\n    this.apiUrl = config.ezpayBe.apiUrl ?? 'http://localhost:3001';\n    this.apiKey = config.ezpayBe.apiKey ?? '';\n  }\n\n  async updateWithdrawalStatus(\n    withdrawalId: string,\n    payload: { \n      analyzedStatus: BillAnalyzedStatus, \n      sourceAccountNo: string, \n      sourceBankCode: string, \n      receipt: string }\n    ): Promise<boolean> {\n    const maxRetries = 3;\n    const baseDelay = 2000; // 2 seconds\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        const url = `${this.apiUrl}/api/internal/withdrawals/complete/${withdrawalId}`;\n\n        this.logger.log(`Updating withdrawal ${withdrawalId} status to ${payload.analyzedStatus} (attempt ${attempt + 1}/${maxRetries + 1})`);\n\n        const formdata = new FormData();\n        formdata.append('analyzedStatus', payload.analyzedStatus);\n        formdata.append('sourceAccountNo', payload.sourceAccountNo);\n        formdata.append('sourceBankCode', payload.sourceBankCode);\n        formdata.append('receipt', createReadStream(payload.receipt));\n\n        const response = await firstValueFrom(\n          this.httpService.patch(url, formdata, {\n            headers: {\n              ...formdata.getHeaders(),\n              'X-API-Key': this.apiKey,\n              'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n            },\n            timeout: 20000,\n          }),\n        );\n\n        if (response.status === 200 || response.status === 204) {\n          this.logger.log(`Successfully updated withdrawal ${withdrawalId} status to ${payload.analyzedStatus}`);\n          return true;\n        }\n\n        this.logger.warn(`Unexpected status code ${response.status} when updating withdrawal ${withdrawalId}`);\n      } catch (error) {\n        console.dir({\n          message: error.message,\n          code: error.code,\n          // MongoDB server thng tr v chi tit vi phm trong errInfo.details\n          details: error.errInfo?.details,\n        }, { depth: 10 });\n\n        const axiosError = error as AxiosError;\n        const payload = axiosError.response?.data;\n        const errorMessage = axiosError.message;\n\n        if (attempt < maxRetries) {\n          const delay = baseDelay * Math.pow(2, attempt); // Exponential backoff\n          this.logger.warn(\n            `Failed to update withdrawal ${withdrawalId} (attempt ${attempt + 1}/${maxRetries + 1}): ${errorMessage}. Payload: ${JSON.stringify(payload)}, Retrying in ${delay}ms`,\n          );\n          await sleep(delay);\n        } else {\n          this.logger.error(\n            `Failed to update withdrawal ${withdrawalId} after ${maxRetries + 1} attempts. Payload: ${JSON.stringify(payload)}, Error: ${errorMessage}`,\n          );\n          return false;\n        }\n      }\n    }\n\n    return false;\n  }\n}\n\n","module.exports = require(\"rxjs\");","module.exports = require(\"form-data\");","module.exports = require(\"fs\");","import { config as dotenvConfig } from 'dotenv';\nimport { join } from 'path';\n\ndotenvConfig({ path: join(process.cwd(), '.env') });\n\ninterface IConfig {\n\tboxType: 'HC' | 'PANDA';\n\tredis: {\n\t\thost: string;\n\t\tport: number;\n\t\tdb: number;\n\t\tpassword: string;\n\t};\n\tezpayBe: {\n\t\tapiUrl: string;\n\t\tapiKey: string;\n\t};\n\tspaceocr: {\n\t\tdatacenterPrimary: string;\n\t\tdatacenterSecond: string;\n\t\tkey: string;\n\t\tkeyFree: string;\n\t};\n}\n\nexport const config: IConfig = {\n\tboxType: 'PANDA',\n\tredis: {\n\t\thost: process.env.REDIS_HOST ?? '14.225.44.234',\n\t\tport: parseInt(process.env.REDIS_PORT ?? '6888'),\n\t\tdb: 3,\n\t\tpassword: process.env.REDIS_PWD ?? 'Dcsvnqvmn1',\n\t},\n\tezpayBe: {\n\t\tapiUrl: process.env.EZZPAY_BE ?? 'https://api-hn.botpro.world/payment',\n\t\tapiKey: process.env.EZZPAY_KEY ?? 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n\t},\n\tspaceocr: {\n\t\tdatacenterPrimary: 'https://apipro1.ocr.space/parse/image',\n\t\tdatacenterSecond: 'https://apipro2.ocr.space/parse/image',\n\t\tkey: 'G888CWKP2Y06X',\n\t\tkeyFree: 'K82766678488957',\n\t},\n}","module.exports = require(\"dotenv\");","export const sleep = (ms: number): Promise<void> => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};","import { Injectable, Logger } from '@nestjs/common';\nimport { AcbService } from './acb.service';\nimport { PgService } from './pg.service';\nimport { DeviceService } from '../device/device.service';\nimport { HcBoxService } from '../hcbox/hcbox.service';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { IBankService, IAnalyzeTransferBillResult } from './interfaces/bank-service.interface';\nimport { SessionManagementService } from './session-management.service';\nimport { DeviceLockService } from '../device/device-lock.service';\n\n/**\n * Bank Service Factory\n * Routes to appropriate bank-specific service based on bankCode\n */\n@Injectable()\nexport class BankService {\n  private readonly logger = new Logger(BankService.name);\n  private readonly bankServices: Map<string, IBankService> = new Map();\n\n  constructor(\n    private readonly acbService: AcbService,\n    private readonly pgService: PgService,\n    private readonly deviceService: DeviceService,\n    private readonly hcBoxService: HcBoxService,\n    private readonly sessionManagement: SessionManagementService,\n    private readonly deviceLock: DeviceLockService,\n  ) {\n    // Register all bank services\n    this.registerBankService(this.acbService);\n    this.registerBankService(this.pgService);\n  }\n\n  /**\n   * Register a bank service\n   */\n  private registerBankService(service: IBankService): void {\n    const bankCode = service.getBankCode().toUpperCase();\n    this.bankServices.set(bankCode, service);\n    this.logger.log(`Registered bank service: ${bankCode}`);\n  }\n\n  /**\n   * Get bank service by bank code (public method for controller)\n   */\n  getBankService(bankCode: string): IBankService | null {\n    const service = this.bankServices.get(bankCode.toUpperCase());\n    if (!service) {\n      this.logger.warn(`Bank service not found for bank code: ${bankCode}`);\n    }\n    return service || null;\n  }\n\n  /**\n   * Get all supported bank codes\n   */\n  getSupportedBanks(): string[] {\n    return Array.from(this.bankServices.keys());\n  }\n\n  /**\n   * Login to bank app on device (with locking)\n   */\n  async login(bankCode: string, deviceId: string, force: boolean = false): Promise<void> {\n    // Check if device is already locked (any type)\n    const isLocked = await this.deviceLock.isLocked(deviceId);\n    if (isLocked && !force) {\n      const lock = await this.deviceLock.getLock(deviceId);\n      throw new Error(\n        `Device ${deviceId} is currently locked by ${lock?.lockType} (${lock?.lockedBy}). Cannot login.`\n      );\n    }\n\n    // Acquire lock using unified format: operation:operationId\n    const operationId = `login:${bankCode}:${deviceId}:${Date.now()}`;\n    const lockAcquired = await this.deviceLock.acquireLock(\n      deviceId,\n      'login',\n      operationId,\n      5 * 60 * 1000 // 5 minutes for login process\n    );\n\n    if (!lockAcquired) {\n      throw new Error(`Failed to acquire lock for device ${deviceId}`);\n    }\n\n    try {\n      // Mark as logging in\n      await this.sessionManagement.markLoggingIn(deviceId, bankCode);\n\n      const service = this.getBankService(bankCode);\n      if (!service) {\n        throw new Error(`Bank service not found for bank code: ${bankCode}`);\n      }\n\n      this.logger.log(`Logging in to ${bankCode} on device ${deviceId}`);\n      await service.login(deviceId);\n\n      // Record successful login\n      await this.sessionManagement.recordLogin(deviceId, bankCode);\n      \n      this.logger.log(`Successfully logged in to ${bankCode} on device ${deviceId}`);\n    } catch (error) {\n      // Clear session on error\n      await this.sessionManagement.clearSession(deviceId, bankCode);\n      throw error;\n    } finally {\n      // Release login lock\n      await this.deviceLock.releaseLock(deviceId);\n    }\n  }\n\n  /**\n   * Login all active banks\n   */\n  async loginAllActiveBanks(): Promise<void> {\n    try {\n      const devices = await this.deviceService.listDevices();\n      const activeDevices = devices.filter(device => device.status === 'active' && device.bankCode);\n\n      if (activeDevices.length === 0) {\n        this.logger.warn('No active devices found to login');\n        return;\n      }\n\n      this.logger.log(`Logging in to ${activeDevices.length} active device(s)`);\n\n      // Release transfer locks for all active devices before login\n      for (const device of activeDevices) {\n        const deviceId = device.udid;\n        try {\n          await this.deviceLock.releaseLockByType(deviceId, 'transfer');\n        } catch (error) {\n          this.logger.warn(`Failed to release transfer lock for device ${deviceId}: ${error.message}`);\n        }\n      }\n\n      // Login all active devices\n      const loginPromises: Promise<void>[] = [];\n      for (const device of activeDevices) {\n        const bankCode = device.bankCode.toUpperCase();\n        const deviceId = device.udid;\n        loginPromises.push(\n          this.login(bankCode, deviceId, true).catch(error => {\n            this.logger.error(`Failed to login ${bankCode} on device ${deviceId}: ${error.message}`);\n          })\n        );\n      }\n\n      await Promise.allSettled(loginPromises);\n      this.logger.log(`Completed login process for all active banks`);\n    } catch (error) {\n      this.logger.error(`Error logging in all active banks: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Execute transfer with session check and retry logic\n   * NOTE: Device lock should be acquired by caller (WithdrawalService) before calling this method\n   */\n  executeTransfer(\n    withdrawal: Withdrawal, \n    deviceId: string, \n    bankCode: string,\n  ) {\n    const service = this.getBankService(bankCode);\n\n    return service.executeTransfer(withdrawal, deviceId);\n  }\n\n  /**\n   * Check if session is valid for a device\n   */\n  async isSessionValid(deviceId: string, bankCode: string): Promise<boolean> {\n    return await this.sessionManagement.isSessionValid(deviceId, bankCode);\n  }\n\n  /**\n   * Get bill image as base64 from withdrawal code\n   */\n  async getBillImage(bankCode: string, withdrawalCode: string): Promise<string | null> {\n    const service = this.getBankService(bankCode);\n    if (!service) {\n      this.logger.warn(`Bank ${bankCode} not supported, cannot get bill image`);\n      return null;\n    }\n    \n    return await service.getBillImage(withdrawalCode);\n  }\n\n  /**\n   * Analyze transfer bill and return image with analysis result\n   */\n  analyzeTransferBill(bankCode: string, withdrawal: Withdrawal): Promise<IAnalyzeTransferBillResult | null> {\n    const service = this.getBankService(bankCode);\n    if (!service) {\n      this.logger.warn(`Bank ${bankCode} not supported, cannot analyze transfer bill`);\n      return null;\n    }\n    \n    return service.analyzeTransferBill(withdrawal);\n  }\n\n  /**\n   * Check and refresh session if needed\n   */\n  async refreshSessionIfNeeded(deviceId: string, bankCode: string): Promise<boolean> {\n    // Get session to check status\n    const session = await this.sessionManagement.getSession(deviceId, bankCode);\n    \n    // Skip if device is already logging in\n    if (session?.status === 'logging_in') {\n      return false;\n    }\n\n    // Check if session needs refresh (within refresh window) OR if session is expired/missing\n    const needsRefresh = await this.sessionManagement.needsRefresh(deviceId, bankCode);\n    const isValidSession = await this.sessionManagement.isSessionValid(deviceId, bankCode);\n    \n    // Only proceed if session needs refresh OR session is invalid (expired/missing)\n    if (!needsRefresh && isValidSession) {\n      return false;\n    }\n\n    // Check if device is locked\n    const isLocked = await this.deviceLock.isLocked(deviceId);\n    if (isLocked) {\n      this.logger.warn(`Cannot refresh session for device ${deviceId} - device is locked`);\n      return false;\n    }\n\n    try {\n      if (!isValidSession) {\n        this.logger.log(`Session expired or missing for device ${deviceId}, bank ${bankCode}. Retrying login...`);\n      } else {\n        this.logger.log(`Refreshing session for device ${deviceId}, bank ${bankCode}`);\n      }\n      await this.login(bankCode, deviceId);\n      return true;\n    } catch (error) {\n      this.logger.error(`Failed to refresh session for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n}\n\n\n","import { Inject, Injectable } from '@nestjs/common';\nimport { WEBSOCKET_SERVICE } from '../../common/modules/websocket/constants/websocket';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\nimport { ICaptureScreenOptions, IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\nimport { COMMON_COORDINATES, KEYBOARD_LAYOUT } from '@/common/constants/keyboard';\nimport { ACB_UI_COORDINATES } from './constants/acbank';\n\n@Injectable()\nexport class AcbService extends BaseBankService {\n  protected readonly BANK_CODE = 'ACB';\n  protected readonly BUNDLE_ID = 'mobileapp.acb.com.vn';\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n  ) {\n    super(wsService, deviceService);\n  }\n\n  /**\n   * Capture screen of device (override to add name parameter)\n   */\n  async captureScreen(deviceId: string, options: ICaptureScreenOptions): Promise<void> {\n    // Type assertion  s dng type c th trong implementation\n    const typedOptions = options as { quality: number; folderPath: string };\n    \n    // try {\n    //   this.logger.log(`Capturing screen on device ${deviceId} with quality ${typedOptions.quality}`);\n    //   const base64Image = await this.wsService.takeScreenShot(deviceId, { quality: typedOptions.quality, filePath: typedOptions.folderPath });\n    //   console.log(base64Image);\n    //   this.logger.log(`Screen captured successfully on device ${deviceId}`);\n    // } catch (error) {\n    //   this.logger.error(`Error capturing screen on device ${deviceId}: ${error.message}`);\n    //   throw error;\n    // }  \n  }\n\n  /**\n   * Click on password field \"Mt khu\"\n   */\n  async clickPasswordField(deviceId: string): Promise<void> {\n    try {\n      const { x, y } = ACB_UI_COORDINATES.PASSWORD_FIELD;\n      this.logger.log(`Clicking password field on device ${deviceId} at coordinates (${x}, ${y})`);\n      await this.clickWithTransition(deviceId, x, y, 0.2);\n      // Wait for keyboard to appear\n      await sleep(1000);\n      this.logger.log(`Password field clicked successfully on device ${deviceId}`);\n    } catch (error) {\n      this.logger.error(`Error clicking password field on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Input password from device config\n   */\n  async inputPasswordFromConfig(deviceId: string): Promise<void> {\n    try {\n      const config = await this.deviceService.getDeviceConfig(deviceId);\n      if (!config || !config.password) {\n        throw new Error(`Password not configured for device ${deviceId}`);\n      }\n\n      await this.wsService.inputText(deviceId, config.password);\n    } catch (error) {\n      this.logger.error(`Error inputting password from config for device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Click on login button \"NG NHP\"\n   */\n  async clickLoginButton(deviceId: string): Promise<void> {\n    try {\n      const { x, y } = ACB_UI_COORDINATES.LOGIN_BUTTON;\n      this.logger.log(`Clicking login button on device ${deviceId} at coordinates (${x}, ${y})`);\n      await this.wsService.click(deviceId, x, y, 0.2);\n      // Wait for screen transition\n      await sleep(5000);\n      this.logger.log(`Login button clicked successfully on device ${deviceId}`);\n    } catch (error) {\n      this.logger.error(`Error clicking login button on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async login(deviceId: string): Promise<void> {\n    try {\n      // Step 0: Kill app\n      await this.killApp(deviceId);\n      // Step 1: Launch app\n      await this.launchApp(deviceId);\n      // Step 2: Click on login button\n      const { x, y } = ACB_UI_COORDINATES.LOGIN_BUTTON;\n      this.logger.log(`Clicking login button on device ${deviceId} at coordinates (${x}, ${y})`);\n      await this.wsService.click(deviceId, x, y, 0.2);\n      await sleep(2000);\n\n      // Step 4: Input password\n      await this.inputPasswordFromConfig(deviceId);\n      await sleep(2000);\n\n      // Step 5: Click on return key\n      const { x: xReturn, y: yReturn } = COMMON_COORDINATES.RETURN_KEY;\n      this.logger.log(`Clicking return key on device ${deviceId} at coordinates (${xReturn}, ${yReturn})`);\n      await this.wsService.click(deviceId, xReturn, yReturn, 0.2);\n      await sleep(2000);\n\n      // Step 6: Click on login button\n      await this.wsService.click(deviceId, 0.5, 0.62, 0.2);\n      await sleep(5000);\n      // Close notification\n      await this.wsService.click(deviceId, 0.3, 0.55, 0.2);\n      await this.wsService.click(deviceId, 0.5, 0.65, 0.2);\n\n    } catch (error) {\n      this.logger.error(`Error logging in on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Execute transfer for ACB bank\n   */\n  async executeTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    // try {\n    //   this.logger.log(`Executing ACB transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceId}`);\n\n    //   await this.wsService.click(deviceId, 0.5, 0.95, 0.2);\n    //   await this.wsService.click(deviceId, 0.3, 0.3, 0.2);\n    //   await this.wsService.click(deviceId, 0.5, 0.3, 0.2);\n    //   await this.wsService.click(deviceId, 0.5, 0.15, 0.2);\n\n\n\n\n    //   // TODO: Implement ACB-specific transfer flow\n    //   // Step 2: Navigate to transfer screen\n    //   // Step 3: Enter recipient account number\n    //   // Step 4: Enter amount\n    //   // Step 5: Enter description\n    //   // Step 6: Confirm transfer\n    //   // Step 7: Verify transfer success\n\n    //   this.logger.warn('ACB transfer flow is not fully implemented yet');\n    //   return true; // Placeholder\n    // } catch (error) {\n    //   this.logger.error(`Error executing ACB transfer for withdrawal ${withdrawal.withdrawalId}: ${error.message}`);\n    //   throw error;\n    // }\n  }\n\n  async executeInternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    // Because ACB bank merge internal transfer and external transfer, we use external transfer instead\n    return this.executeExternalTransfer(withdrawal, deviceId);\n  }\n\n  async executeExternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    console.warn('ACB executeExternalTransfer');\n  }\n}\n\n","export const WEBSOCKET_SERVICE = Symbol('WEBSOCKET_SERVICE');","import { Injectable, Logger, OnModuleInit } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { HcBoxService } from '../hcbox/hcbox.service';\nimport { DeviceConfig, UpdateDeviceConfigDto } from './dto/device-config.dto';\n\n@Injectable()\nexport class DeviceService implements OnModuleInit {\n  private readonly logger = new Logger(DeviceService.name);\n  private readonly REDIS_DEVICE_CONFIG_PREFIX = 'device:';\n  private readonly REDIS_DEVICE_CONFIG_SUFFIX = ':config';\n  private readonly REDIS_SERVICE_STATUS_KEY = 'service:status';\n\n  constructor(\n    private readonly redisService: RedisService,\n    private readonly hcBoxService: HcBoxService,\n  ) {}\n\n  async onModuleInit() {\n    // Always set service status to 'inactive' on server startup\n    try {\n      await this.setServiceStatus('inactive');\n      this.logger.log('Service status initialized to: inactive');\n    } catch (error) {\n      this.logger.error(`Failed to initialize service status: ${error.message}`);\n    }\n  }\n\n  async listDevices() {\n    try {\n      // Get devices from HC BOX service\n      const devices = await this.hcBoxService.listDevices();\n      \n      // Map bankCode and config from Redis for each device\n      // BankCode mapping is stored in Redis: device:{deviceId}:config\n      const devicesWithConfig = await Promise.all(\n        devices.map(async (device: any) => {\n          // Get saved config from Redis (includes bankCode mapping)\n          const config = await this.getDeviceConfig(device.udid);\n          \n            return {\n            ...device,\n            // Map bankCode from Redis config (persistent mapping)\n            bankCode: config?.bankCode || '',\n            availableAmount: config?.availableAmount || 0,\n            status: config?.status || 'deactive',\n            password: config?.password || '',\n            smartOTP: config?.smartOTP || '',\n            accountNo: config?.accountNo || '',\n            accountName: config?.accountName || '',\n          };\n        }),\n      );\n\n      return devicesWithConfig;\n    } catch (error) {\n      this.logger.error(`Error listing devices: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async getDeviceConfig(deviceId: string): Promise<DeviceConfig | null> {\n    try {\n      const key = `${this.REDIS_DEVICE_CONFIG_PREFIX}${deviceId}${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      const data = await this.redisService.get(key);\n      \n      if (!data) {\n        return null;\n      }\n\n      return JSON.parse(data) as DeviceConfig;\n    } catch (error) {\n      this.logger.error(`Error getting device config for ${deviceId}: ${error.message}`);\n      return null;\n    }\n  }\n\n  async updateDeviceConfig(deviceId: string, dto: UpdateDeviceConfigDto): Promise<DeviceConfig> {\n    try {\n      const key = `${this.REDIS_DEVICE_CONFIG_PREFIX}${deviceId}${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      \n      // Get existing config or create new\n      const existing = await this.getDeviceConfig(deviceId);\n      const config: DeviceConfig = {\n        deviceId,\n        // BankCode mapping: save once, persist in Redis\n        bankCode: dto.bankCode !== undefined ? dto.bankCode : existing?.bankCode || '',\n        availableAmount: dto.availableAmount !== undefined ? dto.availableAmount : existing?.availableAmount || 0,\n        status: dto.status !== undefined ? dto.status : existing?.status || 'deactive',\n        password: dto.password !== undefined ? dto.password : existing?.password || '',\n        smartOTP: dto.smartOTP !== undefined ? dto.smartOTP : existing?.smartOTP || '',\n        accountNo: dto.accountNo !== undefined ? dto.accountNo : existing?.accountNo || '',\n        accountName: dto.accountName !== undefined ? dto.accountName : existing?.accountName || '',\n      };\n\n      // Save to Redis (no expiration - persistent config including bankCode mapping)\n      // Key format: device:{deviceId}:config\n      await this.redisService.set(key, JSON.stringify(config));\n\n      this.logger.log(`Updated device config for ${deviceId} (bankCode: ${config.bankCode || 'not set'}): ${JSON.stringify(config)}`);\n      return config;\n    } catch (error) {\n      this.logger.error(`Error updating device config for ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async getServiceStatus(): Promise<'active' | 'inactive'> {\n    try {\n      const status = await this.redisService.get(this.REDIS_SERVICE_STATUS_KEY);\n      return (status as 'active' | 'inactive') || 'inactive';\n    } catch (error) {\n      this.logger.error(`Error getting service status: ${error.message}`);\n      return 'inactive';\n    }\n  }\n\n  async setServiceStatus(status: 'active' | 'inactive'): Promise<void> {\n    try {\n      await this.redisService.set(this.REDIS_SERVICE_STATUS_KEY, status);\n      this.logger.log(`Service status set to: ${status}`);\n    } catch (error) {\n      this.logger.error(`Error setting service status: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async deductDeviceAmount(deviceId: string, amount: number): Promise<boolean> {\n    try {\n      const config = await this.getDeviceConfig(deviceId);\n      if (!config) {\n        return false;\n      }\n\n      const newAmount = config.availableAmount - amount;\n      if (newAmount < 0) {\n        this.logger.warn(`Insufficient amount for device ${deviceId}. Available: ${config.availableAmount}, Requested: ${amount}`);\n        return false;\n      }\n\n      await this.updateDeviceConfig(deviceId, { availableAmount: newAmount });\n      return true;\n    } catch (error) {\n      this.logger.error(`Error deducting amount for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Check if there is at least one device with status = 'active'\n   */\n  async hasActiveDevice(): Promise<boolean> {\n    try {\n      const devices = await this.listDevices();\n      return devices.some(device => device.status === 'active');\n    } catch (error) {\n      this.logger.error(`Error checking active devices: ${error.message}`);\n      return false;\n    }\n  }\n}\n\n","import { Injectable, Logger, OnModuleDestroy } from '@nestjs/common';\nimport Redis from 'ioredis';\nimport { config } from '../constants/config';\n\n@Injectable()\nexport class RedisService implements OnModuleDestroy {\n  private readonly logger = new Logger(RedisService.name);\n  private redisClient: Redis | null = null;\n\n  constructor() {}\n\n  async getClient(): Promise<Redis> {\n    if (this.redisClient) {\n      return this.redisClient;\n    }\n\n    const host = config.redis.host ?? 'localhost';\n    const port = config.redis.port ?? 6379;\n    const password = config.redis.password ?? undefined;\n    const db = config.redis.db ?? 3;\n\n    this.redisClient = new Redis({\n      host,\n      port,\n      password,\n      db,\n      enableReadyCheck: false,\n      maxRetriesPerRequest: null,\n      lazyConnect: true,\n    });\n\n    this.redisClient.on('error', (err) => {\n      this.logger.error('Redis Client Error', err.stack || err.message);\n    });\n\n    this.redisClient.on('connect', () => {\n      this.logger.log('Redis Client Connected');\n    });\n\n    this.redisClient.on('ready', () => {\n      this.logger.log('Redis Client Ready');\n    });\n\n    this.redisClient.on('close', () => {\n      this.logger.warn('Redis Client Connection Closed');\n    });\n\n    this.redisClient.on('reconnecting', () => {\n      this.logger.log('Redis Client Reconnecting...');\n    });\n\n    await this.redisClient.connect();\n\n    return this.redisClient;\n  }\n\n  async disconnect(): Promise<void> {\n    if (this.redisClient) {\n      await this.redisClient.disconnect();\n      this.redisClient = null;\n      this.logger.log('Redis Client Disconnected');\n    }\n  }\n\n  async onModuleDestroy(): Promise<void> {\n    await this.disconnect();\n  }\n\n  // Basic operations\n  async get(key: string): Promise<string | null> {\n    const client = await this.getClient();\n    return client.get(key);\n  }\n\n  async set(key: string, value: string, ttl?: number): Promise<'OK'> {\n    const client = await this.getClient();\n    if (ttl) {\n      // Convert milliseconds to seconds for Redis SETEX\n      const ttlSeconds = Math.ceil(ttl / 1000);\n      return client.setex(key, ttlSeconds, value);\n    }\n    return client.set(key, value);\n  }\n\n  async setex(key: string, ttl: number, value: string): Promise<'OK'> {\n    const client = await this.getClient();\n    // Convert milliseconds to seconds for Redis SETEX\n    const ttlSeconds = Math.ceil(ttl / 1000);\n    return client.setex(key, ttlSeconds, value);\n  }\n\n  async del(key: string): Promise<number> {\n    const client = await this.getClient();\n    return client.del(key);\n  }\n\n  async exists(key: string): Promise<number> {\n    const client = await this.getClient();\n    return client.exists(key);\n  }\n\n  // Sorted Set operations\n  async zadd(key: string, score: number, member: string): Promise<number> {\n    const client = await this.getClient();\n    return client.zadd(key, score, member);\n  }\n\n  async zrange(key: string, start: number, stop: number): Promise<string[]> {\n    const client = await this.getClient();\n    return client.zrange(key, start, stop);\n  }\n\n  async zrangebyscore(key: string, min: number | string, max: number | string, limit?: { offset: number; count: number }): Promise<string[]> {\n    const client = await this.getClient();\n    if (limit) {\n      return client.zrangebyscore(key, min, max, 'LIMIT', limit.offset, limit.count);\n    }\n    return client.zrangebyscore(key, min, max);\n  }\n\n  async zrem(key: string, ...members: string[]): Promise<number> {\n    const client = await this.getClient();\n    return client.zrem(key, ...members);\n  }\n\n  // Set operations\n  async sadd(key: string, ...members: string[]): Promise<number> {\n    const client = await this.getClient();\n    return client.sadd(key, ...members);\n  }\n\n  async sismember(key: string, member: string): Promise<number> {\n    const client = await this.getClient();\n    return client.sismember(key, member);\n  }\n\n  // Hash operations\n  async hset(key: string, field: string, value: string): Promise<number> {\n    const client = await this.getClient();\n    return client.hset(key, field, value);\n  }\n\n  async hget(key: string, field: string): Promise<string | null> {\n    const client = await this.getClient();\n    return client.hget(key, field);\n  }\n\n  async hgetall(key: string): Promise<Record<string, string>> {\n    const client = await this.getClient();\n    return client.hgetall(key);\n  }\n\n  async expire(key: string, ttl: number): Promise<number> {\n    const client = await this.getClient();\n    return client.expire(key, ttl);\n  }\n\n  /**\n   * Set key if not exists (atomic operation)\n   * Returns 'OK' if key was set, null if key already exists\n   */\n  async setnx(key: string, value: string, ttl?: number): Promise<string | null> {\n    const client = await this.getClient();\n    if (ttl) {\n      // Convert milliseconds to seconds for Redis SET with NX and EX\n      const ttlSeconds = Math.ceil(ttl / 1000);\n      const result = await client.set(key, value, 'EX', ttlSeconds, 'NX');\n      return result;\n    }\n    const result = await client.set(key, value, 'NX');\n    return result;\n  }\n}\n\n","module.exports = require(\"ioredis\");","import { Inject, Injectable, Logger } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { ICaptureScreenOptions, IHCSwipeOptions, IPandaSwipeOptions, IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\n\n@Injectable()\nexport class HcBoxService {\n  private readonly logger = new Logger(HcBoxService.name);\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    private readonly wsService: IWebSocketService,\n  ) {}\n\n  async listDevices() {\n    try {\n      return await this.wsService.listDevices();\n    } catch (error) {\n      this.logger.error(`Error listing devices: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async executeTransfer(withdrawal: Withdrawal, deviceId: string): Promise<boolean> {\n    try {\n      this.logger.log(`Executing transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceId}`);\n\n      // Step 1: Launch bank app (example bundle ID for Vietcombank app)\n      // Note: This is a placeholder - actual bundle ID should be configured per bank\n      const bankBundleId = this.getBankBundleId(withdrawal.bankCode);\n      if (bankBundleId) {\n        await this.wsService.launchApp(deviceId, bankBundleId);\n        await sleep(3000); // Wait for app to launch\n      }\n\n      // Step 2: Navigate to transfer screen\n      // This is a simplified flow - actual implementation would need to know the app's UI structure\n      // Click on transfer/money transfer button (example coordinates - should be configured)\n      await this.wsService.click(deviceId, 0.5, 0.3, 0.2); // Example: center-top area\n      await sleep(2000);\n\n      // Step 3: Enter recipient account number\n      // This would require OCR or predefined coordinates based on the app\n      // For now, this is a placeholder that needs to be customized per bank app\n      this.logger.warn('Transfer execution flow needs to be customized per bank app UI');\n\n      // Step 4: Enter amount\n      // Step 5: Enter description\n      // Step 6: Confirm transfer\n\n      // For now, return true as a placeholder\n      // In production, this should verify the transfer was successful\n      this.logger.log(`Transfer execution completed for withdrawal ${withdrawal.withdrawalId}`);\n      return true;\n    } catch (error) {\n      this.logger.error(`Error executing transfer for withdrawal ${withdrawal.withdrawalId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  private getBankBundleId(bankCode: string): string | null {\n    // Map bank codes to iOS app bundle IDs\n    // These are examples and should be configured properly\n    const bundleIds: Record<string, string> = {\n      VIETCOMBANK: 'com.vietcombank.mobilebanking',\n      TPBANK: 'com.tpbank.mobilebanking',\n      TECHCOMBANK: 'com.techcombank.mobilebanking',\n      // Add more banks as needed\n    };\n\n    return bundleIds[bankCode] || null;\n  }\n\n  // Expose WebSocket service methods for direct use if needed\n  async click(deviceId: string, x: number, y: number, duration = 0.2): Promise<string> {\n    return this.wsService.click(deviceId, x, y, duration);\n  }\n\n  async swipe(deviceId: string, options: IHCSwipeOptions | IPandaSwipeOptions): Promise<string> {\n    return this.wsService.swipe(deviceId, options);\n  }\n\n  async screen(deviceId: string, options: ICaptureScreenOptions): Promise<string> {\n    return this.wsService.captureScreen(deviceId, options);\n  }\n\n  async home(deviceId: string): Promise<string> {\n    return this.wsService.home(deviceId);\n  }\n\n  async inputNumpadNumber(deviceId: string, value: string): Promise<void> {\n    return this.wsService.inputNumpadNumber(deviceId, value);\n  }\n\n  inputText(deviceId: string, text: string): Promise<void> {\n    return this.wsService.inputText(deviceId, text);\n  }\n}\n\n","import { Inject, Injectable, Logger } from '@nestjs/common';\nimport { DeviceService } from '../../device/device.service';\nimport { IAnalyzeTransferBillResult, IBankService } from '../interfaces/bank-service.interface';\nimport { Withdrawal } from '../../../common/interfaces/withdrawal.interface';\nimport { ICaptureScreenOptions, IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { sleep } from '@/common/utils/time';\nimport { existsSync, mkdirSync } from 'fs';\nimport { mkdir, readdir, readFile } from 'fs/promises';\nimport { join, resolve } from 'path';\nimport { getMimeType } from '../constants/bill';\nimport { analyzeBill, ocrBillPro } from '@/modules/ocr/ocr';\n\n\n/**\n * Base abstract class for all bank services\n * Provides common functionality and enforces interface implementation\n */\n@Injectable()\nexport abstract class BaseBankService implements IBankService {\n  protected readonly logger: Logger;\n  protected abstract readonly BANK_CODE: string;\n  protected abstract readonly BUNDLE_ID: string;\n\n  // Static flags  trnh race condition khi nhiu class cng khi to\n  protected readonly baseTransactionFolderPath = 'C:/EzpData';\n  private static folderCreationInProgress = false;\n  private static folderCreated = false;\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    protected readonly deviceService: DeviceService\n  ) {\n    this.logger = new Logger(this.constructor.name);\n    BaseBankService.createTransactionFolder(this.baseTransactionFolderPath, this.logger);\n  }\n\n  /**\n   * Kim tra v to base folder nu cha tn ti\n   * S dng static method  trnh race condition khi nhiu class cng khi to\n   */\n  private static createTransactionFolder(folderPath: string, logger: Logger): void {\n    // Nu  to ri th khng cn lm g\n    if (BaseBankService.folderCreated) {\n      return;\n    }\n\n    // Nu ang c process khc ang to folder, i mt cht ri check li\n    if (BaseBankService.folderCreationInProgress) {\n      // i ti a 100ms, check mi 10ms\n      let attempts = 0;\n      const maxAttempts = 10;\n      while (BaseBankService.folderCreationInProgress && attempts < maxAttempts) {\n        attempts++;\n        // Synchronous wait (ch dng trong constructor, khng block event loop lu)\n        const start = Date.now();\n        while (Date.now() - start < 10) {\n          // Busy wait 10ms\n        }\n      }\n      // Sau khi i, check li xem  to cha\n      if (BaseBankService.folderCreated || existsSync(folderPath)) {\n        BaseBankService.folderCreated = true;\n        return;\n      }\n    }\n\n    try {\n      // nh du ang to folder\n      BaseBankService.folderCreationInProgress = true;\n\n      // Kim tra li mt ln na (double-check pattern)\n      if (!existsSync(folderPath)) {\n        mkdirSync(folderPath, { recursive: true });\n        logger.log(`Created base folder: ${folderPath}`);\n      } else {\n        logger.debug(`Base folder already exists: ${folderPath}`);\n      }\n\n      // nh du  to xong\n      BaseBankService.folderCreated = true;\n    } catch (error) {\n      // Nu li l \"folder already exists\" th khng sao (c th xy ra trong race condition)\n      if ((error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        logger.error(`Failed to create base folder ${folderPath}: ${error.message}`);\n      } else {\n        // Folder  tn ti (c th do process khc  to), nh du l  to\n        BaseBankService.folderCreated = true;\n        logger.debug(`Base folder already exists (created by another process): ${folderPath}`);\n      }\n    } finally {\n      // Lun reset flag\n      BaseBankService.folderCreationInProgress = false;\n    }\n  }\n\n  getBankCode(): string {\n    return this.BANK_CODE;\n  }\n\n  /**\n   * Launch bank app on device with retry logic\n   */\n  async launchApp(deviceId: string, maxRetries: number = 3): Promise<void> {\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        if (attempt === 1) {\n          this.logger.log(`Launching ${this.BANK_CODE} app on device ${deviceId}`);\n        } else {\n          this.logger.log(`Retrying launch ${this.BANK_CODE} app on device ${deviceId} (attempt ${attempt}/${maxRetries})`);\n        }\n\n        await this.wsService.launchApp(deviceId, this.BUNDLE_ID);\n        await sleep(10000);\n\n        if (attempt > 1) {\n          this.logger.log(`${this.BANK_CODE} app launched successfully on device ${deviceId} after ${attempt} attempt(s)`);\n        } else {\n          this.logger.log(`${this.BANK_CODE} app launched successfully on device ${deviceId}`);\n        }\n        return;\n      } catch (error) {\n        const isTimeoutError = error instanceof Error && error.message.includes('timeout');\n\n        // If not a timeout error, throw immediately (no retry for non-timeout errors)\n        if (!isTimeoutError) {\n          this.logger.error(`Error launching ${this.BANK_CODE} app on device ${deviceId} (attempt ${attempt}/${maxRetries}): ${error.message}`);\n          throw error;\n        }\n\n        // Timeout error - retry if not last attempt\n        if (attempt < maxRetries) {\n          // Exponential backoff: 2s, 4s, 8s\n          const delay = Math.pow(2, attempt) * 1000;\n          this.logger.warn(\n            `WebSocket timeout when launching ${this.BANK_CODE} app on device ${deviceId} (attempt ${attempt}/${maxRetries}). Retrying in ${delay}ms...`\n          );\n          await sleep(delay);\n        } else {\n          // Last attempt failed with timeout\n          this.logger.error(`Error launching ${this.BANK_CODE} app on device ${deviceId} (attempt ${attempt}/${maxRetries}): ${error.message}`);\n          throw error;\n        }\n      }\n    }\n  }\n\n  async killApp(deviceId: string, maxRetries: number = 2): Promise<void> {\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        if (attempt === 1) {\n          this.logger.log(`Killing ${this.BANK_CODE} app on device ${deviceId}`);\n        } else {\n          this.logger.log(`Retrying kill ${this.BANK_CODE} app on device ${deviceId} (attempt ${attempt}/${maxRetries})`);\n        }\n\n        await this.wsService.killApp(deviceId, this.BUNDLE_ID);\n        // Wait for app to close\n        await sleep(3000);\n\n        if (attempt > 1) {\n          this.logger.log(`${this.BANK_CODE} app killed successfully on device ${deviceId} after ${attempt} attempt(s)`);\n        } else {\n          this.logger.log(`${this.BANK_CODE} app killed successfully on device ${deviceId}`);\n        }\n        return;\n      } catch (error) {\n        const isTimeoutError = error instanceof Error && error.message.includes('timeout');\n\n        // If not a timeout error, throw immediately (no retry for non-timeout errors)\n        if (!isTimeoutError) {\n          this.logger.error(`Error killing ${this.BANK_CODE} app on device ${deviceId} (attempt ${attempt}/${maxRetries}): ${error.message}`);\n          throw error;\n        }\n\n        // Timeout error - retry if not last attempt\n        if (attempt < maxRetries) {\n          // Exponential backoff: 1s, 2s\n          const delay = Math.pow(2, attempt - 1) * 1000;\n          this.logger.warn(\n            `WebSocket timeout when killing ${this.BANK_CODE} app on device ${deviceId} (attempt ${attempt}/${maxRetries}). Retrying in ${delay}ms...`\n          );\n          await sleep(delay);\n        } else {\n          // Last attempt failed with timeout\n          this.logger.error(`Error killing ${this.BANK_CODE} app on device ${deviceId} (attempt ${attempt}/${maxRetries}): ${error.message}`);\n          throw error;\n        }\n      }\n    }\n  }\n\n  /**\n   * Helper method for clicking with transition time and logging\n   */\n  async clickWithTransition(\n    deviceId: string,\n    x: number,\n    y: number,\n    transitionTime: number,\n    log: string = ''\n  ): Promise<void> {\n    await this.wsService.click(deviceId, x, y, 0.2);\n    if (log) {\n      this.logger.log(log);\n    }\n    // Wait for screen transition\n    await sleep(transitionTime);\n  }\n\n  async createBillFolder(folderPath: string): Promise<void> {\n    const path = resolve(this.baseTransactionFolderPath, folderPath);\n\n    await mkdir(path, { recursive: true });\n  }\n\n  /**\n   * Capture screen of device\n   */\n  async captureScreen(deviceId: string, options: ICaptureScreenOptions) {\n    this.logger.log(`Capturing screen on device ${deviceId} with folderPath: ${options.folderPath}`);\n\n    const path = resolve(this.baseTransactionFolderPath, options.folderPath);\n\n    await this.wsService.captureScreen(deviceId, {\n      ...options,\n      folderPath: path,\n    });\n    await sleep(5000);\n  }\n\n  /**\n   * c folder v tm file nh u tin, sau  convert sang base64\n   * @param folderPath ng dn n folder cha nh\n   * @returns Base64 string ca nh hoc null nu khng tm thy\n   */\n  async getBillImage(folderPath: string): Promise<string | null> {\n    try {\n      const folder = join(this.baseTransactionFolderPath, folderPath);\n      const files = await readdir(folder);\n\n      // Tm file nh u tin\n      const imageFile = files[0];\n\n      if (!imageFile) {\n        this.logger.warn(`No image file found in folder: ${folderPath}`);\n        return null;\n      }\n\n      // c file nh\n      const imagePath = join(folder, imageFile);\n      const imageBuffer = await readFile(imagePath);\n\n      // Convert sang base64\n      const base64Image = imageBuffer.toString('base64');\n\n      // Xc nh mime type t extension\n      const ext = imageFile.toLowerCase().substring(imageFile.lastIndexOf('.'));\n      const mimeType = getMimeType(ext);\n\n      return `data:${mimeType};base64,${base64Image}`;\n    } catch (error) {\n      this.logger.error(`Error loading image from folder ${folderPath}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * c folder v tm file nh u tin, sau  convert sang base64\n   * @param folderPath ng dn n folder cha nh\n   * @returns Base64 string ca nh hoc null nu khng tm thy\n   */\n  async getBillImagePath(folderPath: string): Promise<string | null> {\n    try {\n      const folder = join(this.baseTransactionFolderPath, folderPath);\n      const files = await readdir(folder);\n\n      // Tm file nh u tin\n      const imageFile = files[0];\n\n      if (!imageFile) {\n        this.logger.warn(`No image file found in folder: ${folderPath}`);\n        return null;\n      }\n\n      return join(folder, imageFile);\n    } catch (error) {\n      this.logger.error(`Error loading image from folder ${folderPath}: ${error.message}`);\n\n      return null;\n    }\n  }\n\n  async analyzeTransferBill(withdrawal: Partial<Withdrawal>): Promise<IAnalyzeTransferBillResult> {\n    const billImage = await this.getBillImagePath(withdrawal.withdrawalCode);\n\n    try {\n      // No image found\n      if (!billImage) {\n        return {\n          rawPath: null,\n          analyzedStatus: 'na',\n        };\n      }\n\n      const ocrResult = await ocrBillPro(billImage);\n\n      if (!ocrResult) {\n        return {\n          rawPath: billImage,\n          analyzedStatus: 'na'\n        }\n      }\n\n      const analyzedResult = analyzeBill(ocrResult.parsedText);\n\n      return {\n        rawPath: billImage,\n        analyzedStatus: analyzedResult.analyzedStatus,\n      };\n    } catch (error) {\n      this.logger.error(`Error analyzing transfer bill: ${error.message}`);\n\n      return {\n        rawPath: billImage,\n        analyzedStatus: 'na'\n      }\n    }\n  }\n\n  /**\n   * Abstract methods - must be implemented by each bank\n   */\n  abstract login(deviceId: string): Promise<void>;\n  abstract executeInternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void>;\n  abstract executeExternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void>;\n  abstract executeTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void>;\n}\n\n","module.exports = require(\"fs/promises\");","export const BILL_IMAGE_EXTENSIONS = ['.png'];\n\nexport const getMimeType = (ext: string): string => {\n  const mimeTypes: Record<string, string> = {\n    '.png': 'image/png'\n  };\n  return mimeTypes[ext.toLowerCase()] || 'image/png';\n}","import { config } from \"@/common/constants/config\";\nimport { ocrSpace } from \"ocr-space-api-wrapper\";\nimport { IAnalyzeTransferBillResult } from \"../bank/interfaces/bank-service.interface\";\nimport { Logger } from \"@nestjs/common\";\n\n\nconst logger = new Logger('OCRService');\n\n/**\n * OCR mt nh t base64 string\n * @param base64Image Base64 string ca nh\n */\nexport const ocrBillFree = async (base64Image: string) => {\n  try {\n    // const language = OCR_BANK_LANGUAGES[withdrawal.bankCode];\n\n    const result = await ocrSpace(base64Image,\n      {\n        apiKey: config.spaceocr.keyFree,\n        language: 'eng',\n        scale: true,\n        OCREngine: '2',\n        isTable: true,\n      });\n    return {\n      parsedText: result.ParsedResults[0].ParsedText,\n      processingTimeInMilliseconds: result.ProcessingTimeInMilliseconds,\n    };\n  } catch (error) {\n    console.error(`Error processing OCR: ${error.message}`);\n    throw error;\n  }\n}\n\n/**\n * OCR mt nh t base64 string hoc path\n * @param base64Image Base64 string ca nh\n */\nexport const ocrBillPro = async (imageSource: string) => {\n  try {\n    const randomServer = Math.floor(Math.random() * 2) + 1;\n    const datacenter = \n      randomServer === 1 ? config.spaceocr.datacenterPrimary : config.spaceocr.datacenterSecond;\n\n    const result = await ocrSpace(imageSource, {\n      apiKey: config.spaceocr.key,\n      language: 'eng',\n      scale: true,\n      OCREngine: '2',\n      isTable: true,\n      ocrUrl: datacenter\n    });\n    \n    return {\n      parsedText: result.ParsedResults[0].ParsedText,\n      processingTimeInMilliseconds: result.ProcessingTimeInMilliseconds,\n    };\n  } catch (error) {\n    logger.error(`Error processing OCR: ${error.message}`);\n    \n    return null;\n  }\n}\n\nconst successValue = [\n  'chuyn tin thnh cng',\n  'funds transfer successful',\n];\n\nexport const analyzeBill = (value: string): Omit<IAnalyzeTransferBillResult, 'rawPath'> => {\n  const lowerValue = value.toLowerCase();\n  if (successValue.some(v => lowerValue.includes(v))) {\n    return {\n      analyzedStatus: 'success'\n    };\n  }\n\n  return {\n    analyzedStatus: 'unknown',\n  };\n}","module.exports = require(\"ocr-space-api-wrapper\");","import { config } from \"./config\";\n\n/**\n * Converts an object of coordinates to percentage coordinates\n * Converts normalized coordinates (0-1) to percentage coordinates (0-100)\n * @param coordinatesObj - Object containing coordinate objects with x and y properties\n * @returns Object with all coordinate values multiplied by 100\n */\nexport const scaleCoordinates = <\n\tT extends Record<string, { x: number; y: number }>\n>(coordinatesObj: T, factor: number = 100): T => {\n\treturn Object.fromEntries(\n\t\tObject.entries(coordinatesObj).map(([key, value]) => [\n\t\t\tkey,\n\t\t\t{\n\t\t\t\tx: Math.round(value.x * factor),\n\t\t\t\ty: Math.round(value.y * factor),\n\t\t\t},\n\t\t])\n\t) as T;\n}\n\n// iOS Keyboard Layout (normalized 0-1 coordinates)\n// These are approximate coordinates for iOS keyboard - may need adjustment per device\n// Layout: QWERTY keyboard, numbers row at top when in number mode\nconst HC_KEYBOARD_LAYOUT: Record<string, { x: number; y: number }> = {\n\t// Numbers (when keyboard is in number mode)\n\t'0': { x: 0.95, y: 0.68 },\n\t'1': { x: 0.05, y: 0.68 },\n\t'2': { x: 0.15, y: 0.68 },\n\t'3': { x: 0.25, y: 0.68 },\n\t'4': { x: 0.35, y: 0.68 },\n\t'5': { x: 0.45, y: 0.68 },\n\t'6': { x: 0.55, y: 0.68 },\n\t'7': { x: 0.65, y: 0.68 },\n\t'8': { x: 0.75, y: 0.68 },\n\t'9': { x: 0.85, y: 0.68 },\n\t'@': { x: 0.85, y: 0.78 },\n\t'!': { x: 0.65, y: 0.88 },\n\t// Letters (lowercase - iOS keyboard default)\n\t'a': { x: 0.1, y: 0.78 },\n\t'b': { x: 0.6, y: 0.88 },\n\t'c': { x: 0.4, y: 0.88 },\n\t'd': { x: 0.3, y: 0.78 },\n\t'e': { x: 0.25, y: 0.68 },\n\t'f': { x: 0.4, y: 0.78 },\n\t'g': { x: 0.5, y: 0.78 },\n\t'h': { x: 0.6, y: 0.78 },\n\t'i': { x: 0.75, y: 0.68 },\n\t'j': { x: 0.7, y: 0.78 },\n\t'k': { x: 0.8, y: 0.78 },\n\t'l': { x: 0.9, y: 0.78 },\n\t'm': { x: 0.8, y: 0.88 },\n\t'n': { x: 0.7, y: 0.88 },\n\t'o': { x: 0.85, y: 0.68 },\n\t'p': { x: 0.95, y: 0.68 },\n\t'q': { x: 0.05, y: 0.68 },\n\t'r': { x: 0.35, y: 0.68 },\n\t's': { x: 0.2, y: 0.78 },\n\t't': { x: 0.45, y: 0.68 },\n\t'u': { x: 0.65, y: 0.68 },\n\t'v': { x: 0.5, y: 0.88 },\n\t'w': { x: 0.15, y: 0.68 },\n\t'x': { x: 0.3, y: 0.88 },\n\t'y': { x: 0.55, y: 0.68 },\n\t'z': { x: 0.2, y: 0.88 },\n\t// Space key\n\t' ': { x: 0.55, y: 0.95 },\n};\n\n/**\n *  NUMPAD Layout (normalized 0-1 coordinates)\n * The keys are 0-9, and the coordinates are normalized 0-1\n * The keys are arranged in a 3x3 grid\n * */\nconst HC_NUMPAD_LAYOUT: Record<string, { x: number; y: number }> = {\n\t'0': { x: 0.55, y: 0.95 },\n\t'1': { x: 0.25, y: 0.7 },\n\t'2': { x: 0.55, y: 0.7 },\n\t'3': { x: 0.85, y: 0.7 },\n\t'4': { x: 0.25, y: 0.8 },\n\t'5': { x: 0.55, y: 0.8 },\n\t'6': { x: 0.85, y: 0.8 },\n\t'7': { x: 0.25, y: 0.9 },\n\t'8': { x: 0.55, y: 0.9 },\n\t'9': { x: 0.85, y: 0.9 },\n};\n\nconst HC_COMMON_COORDINATES = {\n\t// Keyboard mode switch button - Switch between letter and number keyboard\n\tKEYBOARD_SWITCH: {\n\t\tx: 0.05, // Left side of keyboard\n\t\ty: 0.95, // bottom area of keyboard\n\t},\n\t// Shift key (uppercase) - Press before typing uppercase letter\n\t// After typing one uppercase letter, keyboard automatically returns to lowercase\n\tSHIFT_KEY: {\n\t\tx: 0.05, // Left side of keyboard\n\t\ty: 0.88, // Bottom area of keyboard\n\t},\n\t// Return/Enter key - Sometimes to dismiss keyboard, sometimes to submit/enter\n\tRETURN_KEY: {\n\t\tx: 0.95, // Right side of keyboard\n\t\ty: 0.95, // Bottom area of keyboard\n\t},\n}\n\nconst PANDA_COMMON_COORDINATES = scaleCoordinates(\n\tHC_COMMON_COORDINATES\n);\n\nconst PANDA_NUMPAD_LAYOUT = scaleCoordinates(\n\tHC_NUMPAD_LAYOUT\n);\n\n/**\n * Export Constants\n * @description Export the constants for the keyboard\n * @returns The constants for the keyboard\n */\n\nexport const COMMON_COORDINATES = config.boxType === 'PANDA' ? PANDA_COMMON_COORDINATES : HC_COMMON_COORDINATES;\nexport const KEYBOARD_LAYOUT = HC_KEYBOARD_LAYOUT;\nexport const NUMPAD_LAYOUT = config.boxType === 'PANDA' ? PANDA_NUMPAD_LAYOUT : HC_NUMPAD_LAYOUT;","// ACB UI Element Coordinates (normalized 0-1)\n\nimport { config } from \"@/common/constants/config\";\nimport { scaleCoordinates } from \"@/common/constants/keyboard\";\n\n// These coordinates are estimates based on screen layout and may need adjustment\nconst HC_ACB_UI_COORDINATES = {\n  // Button \"NG NHP\" (Login button) - Large blue button at bottom\n  // Located in lower portion, above smaller buttons (Ly OTP, ng k, M QR)\n  LOGIN_BUTTON: {\n    x: 0.5,  // Center horizontally (button spans almost full width)\n    y: 0.8, // Adjusted based on actual screen - above \"Qun thng tin ng nhp?\" link\n  },\n  LOGIN_BUTTON_API: {\n    x: 0.5,  // Center horizontally (button spans almost full width)\n    y: 0.62, // Adjusted based on actual screen - above \"Qun thng tin ng nhp?\" link\n  },\n  // Password input field \"Mt khu\" - Text input field\n  // Located in the center of the screen, below user name\n  PASSWORD_FIELD: {\n    x: 0.5,  // Center horizontally\n    y: 0.45, // Center of screen (below user name, above login button) \n  },\n};\n\nconst PANDA_ACB_UI_COORDINATES = scaleCoordinates(HC_ACB_UI_COORDINATES);\n\nexport const ACB_UI_COORDINATES = config.boxType === 'PANDA' ? PANDA_ACB_UI_COORDINATES : HC_ACB_UI_COORDINATES;","import { Inject, Injectable } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { sleep } from '@/common/utils/time';\nimport { PG_UI_COORDINATES } from './constants/pgbank';\nimport { config } from '@/common/constants/config';\nimport { PG_BANK_SEARCH_UI_COORDINATES } from './constants/pg-bank-search';\n\n@Injectable()\nexport class PgService extends BaseBankService {\n  protected readonly BANK_CODE = 'PGBANK';\n  protected readonly BUNDLE_ID = 'pgbankApp.pgbank.com.vn';\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n  ) {\n    super(wsService, deviceService);\n  }\n\n  /**\n   * Input password from device config with retry logic\n   */\n  private async inputPasswordFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.password) {\n      throw new Error(`Password not configured for device ${deviceId}`);\n    }\n    \n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        // Click password field and wait for UI to be ready\n        await this.clickWithTransition(deviceId, PG_UI_COORDINATES.PASSWORD_FIELD.x, PG_UI_COORDINATES.PASSWORD_FIELD.y, 1500);\n        \n        // Additional delay before input to ensure field is focused\n        await sleep(500);\n        \n        // Attempt to input password\n        await this.wsService.inputText(deviceId, config.password);\n        \n        // Success - return immediately\n        if (attempt > 1) {\n          this.logger.log(`Successfully input password on device ${deviceId} after ${attempt} attempt(s)`);\n        }\n        return;\n      } catch (error) {\n        const isTimeoutError = error instanceof Error && error.message.includes('timeout');\n        \n        // If not a timeout error, throw immediately (no retry for non-timeout errors)\n        if (!isTimeoutError) {\n          this.logger.error(`Error inputting password from config for device ${deviceId} (attempt ${attempt}/${maxRetries}): ${error.message}`);\n          throw error;\n        }\n        \n        // Timeout error - retry if not last attempt\n        if (attempt < maxRetries) {\n          // Exponential backoff: 1s, 2s, 4s\n          const delay = Math.pow(2, attempt - 1) * 1000;\n          this.logger.warn(\n            `WebSocket timeout when inputting password on device ${deviceId} (attempt ${attempt}/${maxRetries}). Retrying in ${delay}ms...`\n          );\n          await sleep(delay);\n        } else {\n          // Last attempt failed with timeout\n          this.logger.error(`Error inputting password from config for device ${deviceId} (attempt ${attempt}/${maxRetries}): ${error.message}`);\n          throw error;\n        }\n      }\n    }\n  }\n\n  /**\n   * Input SmartOTP from device config with retry logic\n   */\n  private async inputSmartOTPFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.smartOTP) {\n      throw new Error(`SmartOTP not configured for device ${deviceId}`);\n    }\n    \n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        // Additional delay before input to ensure numpad is ready\n        await sleep(500);\n        \n        // Attempt to input SmartOTP\n        await this.wsService.inputNumpadNumber(deviceId, config.smartOTP);\n        \n        // Success - return immediately\n        if (attempt > 1) {\n          this.logger.log(`Successfully input SmartOTP on device ${deviceId} after ${attempt} attempt(s)`);\n        }\n        return;\n      } catch (error) {\n        const isTimeoutError = error instanceof Error && error.message.includes('timeout');\n        \n        // If not a timeout error, throw immediately (no retry for non-timeout errors)\n        if (!isTimeoutError) {\n          this.logger.error(`Error inputting SmartOTP from config for device ${deviceId} (attempt ${attempt}/${maxRetries}): ${error.message}`);\n          throw error;\n        }\n        \n        // Timeout error - retry if not last attempt\n        if (attempt < maxRetries) {\n          // Exponential backoff: 1s, 2s, 4s\n          const delay = Math.pow(2, attempt - 1) * 1000;\n          this.logger.warn(\n            `WebSocket timeout when inputting SmartOTP on device ${deviceId} (attempt ${attempt}/${maxRetries}). Retrying in ${delay}ms...`\n          );\n          await sleep(delay);\n        } else {\n          // Last attempt failed with timeout\n          this.logger.error(`Error inputting SmartOTP from config for device ${deviceId} (attempt ${attempt}/${maxRetries}): ${error.message}`);\n          throw error;\n        }\n      }\n    }\n  }\n\n  /**\n   * Login to PG bank\n   */\n  async login(deviceId: string): Promise<void> {\n    try {\n      // Step 0: Kill app\n      await this.killApp(deviceId);\n\n      // Step 1: Launch app\n      await this.launchApp(deviceId);\n      await sleep(1000);\n\n      // Step 2: Input password\n      await this.inputPasswordFromConfig(deviceId);\n      await this.wsService.pressReturnKey(deviceId);\n\n      //Step 3: Click login button\n      const { x, y } = PG_UI_COORDINATES.LOGIN_BTN;\n      await this.clickWithTransition(\n        deviceId,\n        x,\n        y,\n        10000,\n        `Clicking login button after input password on device ${deviceId} at coordinates (${x}, ${y})`\n      );\n\n      this.logger.log(`PG login completed successfully on device ${deviceId}`);\n    } catch (error) {\n      this.logger.error(`Error logging in to PGBank on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async executeTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    const transferMethod = withdrawal.bankCode === 'PGBANK' \n      ? this.executeInternalTransfer(withdrawal, deviceId)\n      : this.executeExternalTransfer(withdrawal, deviceId);\n\n    await this.createBillFolder(withdrawal.withdrawalCode);\n    \n    return transferMethod;\n  }\n\n  async executeInternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    try {\n      this.logger.log(`Executing PG transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceId}`);\n      // Step 1: Navigate to transfer screen\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.TRANSFER_BTN.x,\n        PG_UI_COORDINATES.TRANSFER_BTN.y,\n        5000,\n        `[${deviceId}] - Clicking transfer button at coordinates (${PG_UI_COORDINATES.TRANSFER_BTN.x}, ${PG_UI_COORDINATES.TRANSFER_BTN.y})`\n      );\n\n      // Step 2: Click transfer internal button\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.TRANSFER_INTERNAL_BTN.x,\n        PG_UI_COORDINATES.TRANSFER_INTERNAL_BTN.y,\n        3000,\n        `[${deviceId}] - Clicking transfer internal button at coordinates (${PG_UI_COORDINATES.TRANSFER_INTERNAL_BTN.x}, ${PG_UI_COORDINATES.TRANSFER_INTERNAL_BTN.y})`\n      );\n\n      // Step 3: Close allow contact popup \n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.CLOSE_ALLOW_CONTACT_POPUP_BTN.x,\n        PG_UI_COORDINATES.CLOSE_ALLOW_CONTACT_POPUP_BTN.y,\n        3000,\n        `[${deviceId}] - Clicking close allow contact popup button at coordinates (${PG_UI_COORDINATES.CLOSE_ALLOW_CONTACT_POPUP_BTN.x}, ${PG_UI_COORDINATES.CLOSE_ALLOW_CONTACT_POPUP_BTN.y})`\n      );\n\n      // Step 4: Enter account number\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.ACCOUNT_NUMBER_INPUT.x,\n        PG_UI_COORDINATES.ACCOUNT_NUMBER_INPUT.y,\n        3000,\n        `[${deviceId}] - Clicking account number input field at coordinates (${PG_UI_COORDINATES.ACCOUNT_NUMBER_INPUT.x}, ${PG_UI_COORDINATES.ACCOUNT_NUMBER_INPUT.y})`\n      );\n      if (config.boxType === 'HC') {\n        // HC s dng bn phm tht  nhp\n        await this.wsService.switchKeyboardMode(deviceId);\n      }\n      await this.wsService.inputText(deviceId, withdrawal.beneficiaryAccountNo);\n      await this.wsService.pressReturnKey(deviceId);\n      await sleep(10000);\n\n      // Step 5: Enter amount\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.INTERNAL_AMOUNT_INPUT.x,\n        PG_UI_COORDINATES.INTERNAL_AMOUNT_INPUT.y,\n        1000,\n        `[${deviceId}] - Clicking amount input field at coordinates (${PG_UI_COORDINATES.INTERNAL_AMOUNT_INPUT.x}, ${PG_UI_COORDINATES.INTERNAL_AMOUNT_INPUT.y})`\n      );\n      // await this.wsService.inputNumpadNumber(deviceId, withdrawal.amount.toString());\n      await this.wsService.inputText(deviceId, withdrawal.amount.toString());\n\n\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.HIDE_NUMPAD_BTN.x,\n        PG_UI_COORDINATES.HIDE_NUMPAD_BTN.y,\n        500\n      );\n      await sleep(1000);\n\n      // Step 6: continue internal transfer\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n        PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n        10000,\n        `[${deviceId}] - Clicking continue transfer button at coordinates (${PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x}, ${PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y})`\n      );\n\n      // Step 7: Verify transfer success\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n        PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n        15_000,\n        `[${deviceId}] - Clicking continue transfer button at coordinates (${PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x}, ${PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y})`\n      );\n\n      // Step 8: Enter OTP (get from device config)\n      await this.inputSmartOTPFromConfig(deviceId);\n      await sleep(10000);\n\n      // Step 9: Capture screen\n      await this.captureScreen(deviceId, { quality: 0.5, folderPath: withdrawal.withdrawalCode });\n\n      // Step 10: Back to home\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.BACK_TO_HOME.x,\n        PG_UI_COORDINATES.BACK_TO_HOME.y,\n        10000,\n        `[${deviceId}] - Clicking back to home button at coordinates (${PG_UI_COORDINATES.BACK_TO_HOME.x}, ${PG_UI_COORDINATES.BACK_TO_HOME.y})`\n      );\n    } catch (error) {\n      this.logger.error(`[${deviceId}] - Error executing PG transfer for withdrawal ${withdrawal.withdrawalId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Execute external transfer for PG bank\n   */\n  async executeExternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    try {\n      this.logger.log(`Executing PG transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceId}`);\n      const bank = PG_BANK_SEARCH_UI_COORDINATES[withdrawal.bankCode];\n\n      if (!bank) {\n        throw new Error(`Bank ${withdrawal.bankCode} not found!`);\n      }\n\n      // Step 1: Navigate to transfer screen\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.TRANSFER_BTN.x,\n        PG_UI_COORDINATES.TRANSFER_BTN.y,\n        5000,\n        `[${deviceId}] - Clicking transfer button at coordinates (${PG_UI_COORDINATES.TRANSFER_BTN.x}, ${PG_UI_COORDINATES.TRANSFER_BTN.y})`\n      );\n\n      // Step 2: Click transfer external button\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.TRANSFER_EXTERNAL_BTN.x,\n        PG_UI_COORDINATES.TRANSFER_EXTERNAL_BTN.y,\n        3000,\n        `[${deviceId}] - Clicking transfer external button at coordinates (${PG_UI_COORDINATES.TRANSFER_EXTERNAL_BTN.x}, ${PG_UI_COORDINATES.TRANSFER_EXTERNAL_BTN.y})`\n      );\n\n      // Step 3: Enter account number\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.ACCOUNT_NUMBER_INPUT.x,\n        PG_UI_COORDINATES.ACCOUNT_NUMBER_INPUT.y,\n        2000,\n        `[${deviceId}] - Clicking account number field at coordinates (${PG_UI_COORDINATES.ACCOUNT_NUMBER_INPUT.x}, ${PG_UI_COORDINATES.ACCOUNT_NUMBER_INPUT.y})`\n      );\n\n      if (config.boxType === 'HC') {\n        // HC s dng bn phm tht  nhp\n        await this.wsService.switchKeyboardMode(deviceId);\n      }\n      await this.wsService.inputText(deviceId, withdrawal.beneficiaryAccountNo);\n      await this.wsService.pressReturnKey(deviceId);\n\n      // Step 4: Select bank\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.BANK_SEARCH_BTN.x,\n        PG_UI_COORDINATES.BANK_SEARCH_BTN.y,\n        1000,\n        `[${deviceId}] - Clicking account number field at coordinates (${PG_UI_COORDINATES.BANK_SEARCH_BTN.x}, ${PG_UI_COORDINATES.BANK_SEARCH_BTN.y})`\n      );\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.BANK_SEARCH_INPUT.x,\n        PG_UI_COORDINATES.BANK_SEARCH_INPUT.y,\n        2000,\n        `[${deviceId}] - Clicking account number field at coordinates (${PG_UI_COORDINATES.BANK_SEARCH_INPUT.x}, ${PG_UI_COORDINATES.BANK_SEARCH_INPUT.y})`\n      );\n      await this.wsService.inputText(deviceId, bank.searchValue);\n      await sleep(1000);\n      await this.wsService.pressReturnKey(deviceId);\n      await this.clickWithTransition(\n        deviceId,\n        bank.coordinates.x,\n        bank.coordinates.y,\n        10000,\n        `[${deviceId}] - Clicking bank at coordinates (${bank.coordinates.x}, ${bank.coordinates.y})`\n      );\n\n      // Swipe down\n      await this.wsService.swipe(deviceId, {type: '6'});\n      await sleep(3000);\n      // Step 5: Enter amount\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.EXTERNAL_AMOUNT_INPUT.x,\n        PG_UI_COORDINATES.EXTERNAL_AMOUNT_INPUT.y,\n        2000,\n        `[${deviceId}] - Clicking amount input field at coordinates (${PG_UI_COORDINATES.EXTERNAL_AMOUNT_INPUT.x}, ${PG_UI_COORDINATES.EXTERNAL_AMOUNT_INPUT.y})`\n      );\n\n      // await this.wsService.inputNumpadNumber(deviceId, withdrawal.amount.toString());\n      await this.wsService.inputText(deviceId, withdrawal.amount.toString());\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.HIDE_NUMPAD_BTN.x,\n        PG_UI_COORDINATES.HIDE_NUMPAD_BTN.y,\n        500\n      );\n\n      // Step 6: continue external transfer\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n        PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n        10_000,\n        `[${deviceId}] - Clicking continue transfer button at coordinates (${PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x}, ${PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y})`\n      );\n\n      // Step 7: Verify transfer success\n      await this.clickWithTransition\n        (\n          deviceId,\n          PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n          PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n          15_000,\n          `[${deviceId}] - Clicking continue transfer button at coordinates (${PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x}, ${PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y})`\n        );\n\n      // // Step 8: Enter OTP\n      await this.inputSmartOTPFromConfig(deviceId);\n      await sleep(10000);\n\n      // Step 9: Capture screen\n      await this.captureScreen(deviceId, { quality: 0.5, folderPath: withdrawal.withdrawalCode });\n\n      // Step 10: Back to home\n      await this.clickWithTransition(\n        deviceId,\n        PG_UI_COORDINATES.BACK_TO_HOME.x,\n        PG_UI_COORDINATES.BACK_TO_HOME.y,\n        10000,\n        `[${deviceId}] - Clicking back to home button at coordinates (${PG_UI_COORDINATES.BACK_TO_HOME.x}, ${PG_UI_COORDINATES.BACK_TO_HOME.y})`\n      );\n    } catch (error) {\n      this.logger.error(`[${deviceId}] - Error executing PG transfer for withdrawal ${withdrawal.withdrawalId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async onModuleInit() {\n    // await this.login('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await this.executeExternalTransfer({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   accountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // }, 'dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // const billImage = await this.analyzeTransferBill({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   accountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // });\n    // console.log(billImage);\n  }\n\n  onModuleDestroy(): void {\n    // this.killApp('590f1f9603f09330cf235485c6e76b10d0759a55');\n  }\n}\n\n","// HC PG UI Element Coordinates (normalized 0-1)\n\nimport { config } from \"@/common/constants/config\";\nimport { scaleCoordinates } from \"@/common/constants/keyboard\";\n\nconst HC_PG_UI_COORDINATES = {\n  LOGIN_BTN: {\n    x: 0.5,\n    y: 0.6,\n  },\n  PASSWORD_FIELD: {\n    x: 0.5,\n    y: 0.4,\n  },\n  TRANSFER_BTN: {\n    x: 0.7,\n    y: 0.7,\n  },\n  TRANSFER_INTERNAL_BTN: {\n    x: 0.2,\n    y: 0.2\n  },\n  TRANSFER_EXTERNAL_BTN: {\n    x: 0.4,\n    y: 0.2,\n  },\n  CLOSE_ALLOW_CONTACT_POPUP_BTN: {\n    x: 0.3,\n    y: 0.6,\n  },\n  ACCOUNT_NUMBER_INPUT: {\n    x: 0.4,\n    y: 0.43,\n  },\n  SELECT_BANK_BTN: {\n    x: 0.4,\n    y: 0.47,\n  },\n  SEARCH_BANK_BTN: {\n    x: 0.4,\n    y: 0.48,\n  },\n  INTERNAL_AMOUNT_INPUT: {\n    x: 0.5,\n    y: 0.6,\n  },\n  HIDE_NUMPAD_BTN: {\n    x: 0.05,\n    y: 0.4,\n  },\n  CONTINUE_TRANSFER_BTN: {\n    x: 0.5,\n    y: 0.9,\n  },\n  BANK_SEARCH_BTN: {\n    x: 0.4,\n    y: 0.45,\n  },\n  BANK_SEARCH_INPUT: {\n    x: 0.4,\n    y: 0.45,\n  },\n  EXTERNAL_AMOUNT_INPUT: {\n    x: 0.3,\n    y: 0.37,\n  },\n  BACK_TO_HOME: {\n    x: 0.2,\n    y: 0.9,\n  },\n};\n\nconst PANDA_PG_UI_COORDINATES = scaleCoordinates(HC_PG_UI_COORDINATES);\n\nexport const PG_UI_COORDINATES = config.boxType === 'PANDA' ? PANDA_PG_UI_COORDINATES : HC_PG_UI_COORDINATES;","import { config } from \"@/common/constants/config\";\n\n/**\n * HC PG bank search coordinates\n * V tr kt qu 1 (x: 0.5, y: 0.58)\n * V tr kt qu 2 (x: 0.5, y: 0.68)\n * V tr kt qu 3 (x: 0.5, y: 0.78)\n*/\ntype BankSearchCoordinate = {\n  searchValue: string;\n  coordinates: { x: number; y: number };\n};\n\ntype BankSearchCoordinates = Record<string, BankSearchCoordinate>;\n\n/**\n * Scale bank search coordinates by multiplying coordinates with factor\n */\nconst scaleBankSearchCoordinates = (\n  coordinates: BankSearchCoordinates,\n  factor: number = 100\n): BankSearchCoordinates => {\n  return Object.fromEntries(\n    Object.entries(coordinates).map(([key, value]) => [\n      key,\n      {\n        ...value,\n        coordinates: {\n          x: Math.round(value.coordinates.x * factor),\n          y: Math.round(value.coordinates.y * factor),\n        },\n      },\n    ])\n  ) as BankSearchCoordinates;\n};\n\nexport const HC_PG_BANK_SEARCH_UI_COORDINATES = {\n  VIETCOMBANK: {\n    searchValue: 'VIETCOMBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  AGRIBANK: {\n    searchValue: 'AGRIBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  BIDV: {\n    searchValue: 'BIDV',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  SACOMBANK: {\n    searchValue: 'SACOMBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  TECHCOMBANK: {\n    searchValue: 'TECHCOMBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  TPBANK: {\n    searchValue: 'TPBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  HDBank: {\n    searchValue: 'HDBank',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  VPBANK: {\n    searchValue: 'VPBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.78,  \n    },\n  },\n  MBBANK: {\n    searchValue: 'QUAN DOI',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },  \n  },\n  MSB: {\n    searchValue: 'MSB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  LPBANK: {\n    searchValue: 'LPBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  ACB: {\n    searchValue: 'ACB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  ABBANK: {\n    searchValue: 'ABANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  NCB: {\n    searchValue: 'NCB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  EXIMBANK: {\n    searchValue: 'EXIMBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  SEABANK: {\n    searchValue: 'SEABANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  SCB: {\n    searchValue: 'SCB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },  \n  PVCOMBANK: {\n    searchValue: 'PVCOMBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  KIENLONGBANK: {\n    searchValue: 'KIENLONG',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  BVBANK: {\n    searchValue: 'BVBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  VIETINBANK: {\n    searchValue: 'VIETINBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  OCB: {\n    searchValue: 'OCB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  VIETBANK: {\n    searchValue: 'VIETBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  SHB: {\n    searchValue: 'SHB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  NAMABANK: {\n    searchValue: 'NAM A BANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  SHINHANBANKVIETNAM: {\n    searchValue: 'SHINHAN BANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  CIMB: {\n    searchValue: 'CIMB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  SAIGONBANK: {\n    searchValue: 'SAIGONBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  BACABANK: {\n    searchValue: 'BAC',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  VIETABANK: {\n    searchValue: 'VIET A BANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  GPBANK: {\n    searchValue: 'GPBANK',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },  \n  HSBC: {\n    searchValue: 'HSBC',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  VRB: {\n    searchValue: 'VRB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  },\n  VIB: {\n    searchValue: 'VIB',\n    coordinates: {\n      x: 0.5,\n      y: 0.58,\n    },\n  }\n};\n\nconst PANDA_PG_BANK_SEARCH_UI_COORDINATES = scaleBankSearchCoordinates(\n  HC_PG_BANK_SEARCH_UI_COORDINATES,\n  100\n);\n\nexport const PG_BANK_SEARCH_UI_COORDINATES = \n  config.boxType === 'PANDA' ? PANDA_PG_BANK_SEARCH_UI_COORDINATES : HC_PG_BANK_SEARCH_UI_COORDINATES;","import { Injectable, Logger } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\n\nexport interface BankSessionConfig {\n  bankCode: string;\n  sessionTimeoutMs: number; // Session timeout in milliseconds\n  refreshBeforeMs: number; // Refresh session before this time (e.g., 1 minute before)\n}\n\nexport interface DeviceSession {\n  deviceId: string;\n  bankCode: string;\n  loginTime: number; // Timestamp when logged in\n  expiresAt: number; // Timestamp when session expires\n  status: 'logged_in' | 'logging_in' | 'expired';\n}\n\n@Injectable()\nexport class SessionManagementService {\n  private readonly logger = new Logger(SessionManagementService.name);\n  private readonly REDIS_SESSION_PREFIX = 'bank:session:';\n  \n  // Session timeout configuration for each bank (in milliseconds)\n  private readonly BANK_SESSION_CONFIGS: Map<string, BankSessionConfig> = new Map([\n    [\n      'ACB',\n      {\n        bankCode: 'ACB',\n        sessionTimeoutMs: 15 * 60 * 1000, // 15 minutes\n        refreshBeforeMs: 1 * 60 * 1000, // Refresh 1 minute before expiry\n      },\n    ],\n    [\n      'PGBANK',\n      {\n        bankCode: 'PGBANK',\n        sessionTimeoutMs: 5 * 60 * 1000, // 5 minutes\n        refreshBeforeMs: 30 * 1000, // Refresh 30 seconds before expiry\n      },\n    ],\n  ]);\n\n  constructor(private readonly redisService: RedisService) {}\n\n  /**\n   * Get session timeout for a bank\n   */\n  getSessionTimeout(bankCode: string): number {\n    const config = this.BANK_SESSION_CONFIGS.get(bankCode.toUpperCase());\n    return config?.sessionTimeoutMs || 5 * 60 * 1000; // Default 5 minutes\n  }\n\n  /**\n   * Get refresh before time for a bank\n   */\n  getRefreshBeforeTime(bankCode: string): number {\n    const config = this.BANK_SESSION_CONFIGS.get(bankCode.toUpperCase());\n    return config?.refreshBeforeMs || 30 * 1000; // Default 30 seconds\n  }\n\n  /**\n   * Record login session for a device\n   */\n  async recordLogin(deviceId: string, bankCode: string): Promise<void> {\n    const timeout = this.getSessionTimeout(bankCode);\n    const expiresAt = Date.now() + timeout;\n    \n    const session: DeviceSession = {\n      deviceId,\n      bankCode: bankCode.toUpperCase(),\n      loginTime: Date.now(),\n      expiresAt,\n      status: 'logged_in',\n    };\n\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    await this.redisService.set(key, JSON.stringify(session), timeout);\n    \n    this.logger.log(`Recorded login session for device ${deviceId}, bank ${bankCode}, expires at ${new Date(expiresAt).toISOString()}`);\n  }\n\n  /**\n   * Mark device as logging in\n   */\n  async markLoggingIn(deviceId: string, bankCode: string): Promise<void> {\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    const existing = await this.getSession(deviceId, bankCode);\n    \n    const session: DeviceSession = {\n      deviceId,\n      bankCode: bankCode.toUpperCase(),\n      loginTime: existing?.loginTime || Date.now(),\n      expiresAt: existing?.expiresAt || Date.now() + this.getSessionTimeout(bankCode),\n      status: 'logging_in',\n    };\n\n    await this.redisService.set(key, JSON.stringify(session), 5 * 60 * 1000); // 5 min TTL for login process\n    this.logger.log(`Marked device ${deviceId}, bank ${bankCode} as logging in`);\n  }\n\n  /**\n   * Get current session for a device\n   */\n  async getSession(deviceId: string, bankCode: string): Promise<DeviceSession | null> {\n    try {\n      const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n      const data = await this.redisService.get(key);\n      \n      if (!data) {\n        return null;\n      }\n\n      return JSON.parse(data) as DeviceSession;\n    } catch (error) {\n      this.logger.error(`Error getting session for device ${deviceId}, bank ${bankCode}: ${error.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Check if session is valid (not expired and not logging in)\n   */\n  async isSessionValid(deviceId: string, bankCode: string): Promise<boolean> {\n    const session = await this.getSession(deviceId, bankCode);\n    \n    if (!session) {\n      return false;\n    }\n\n    // Check if session is expired\n    if (session.expiresAt < Date.now()) {\n      return false;\n    }\n\n    // Check if device is currently logging in\n    if (session.status === 'logging_in') {\n      return false;\n    }\n\n    return session.status === 'logged_in';\n  }\n\n  /**\n   * Check if session needs refresh (within refresh window)\n   */\n  async needsRefresh(deviceId: string, bankCode: string): Promise<boolean> {\n    const session = await this.getSession(deviceId, bankCode);\n    \n    if (!session || session.status !== 'logged_in') {\n      return false;\n    }\n\n    const refreshBeforeTime = this.getRefreshBeforeTime(bankCode);\n    const timeUntilExpiry = session.expiresAt - Date.now();\n    \n    return timeUntilExpiry <= refreshBeforeTime;\n  }\n\n  /**\n   * Clear session\n   */\n  async clearSession(deviceId: string, bankCode: string): Promise<void> {\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    await this.redisService.del(key);\n    this.logger.log(`Cleared session for device ${deviceId}, bank ${bankCode}`);\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { randomUUID } from 'crypto';\n\nexport type DeviceLockType = 'login' | 'transfer';\n\nexport interface DeviceLock {\n  deviceId: string;\n  lockType: DeviceLockType;\n  lockedAt: number;\n  lockedBy: string; // Unified format: 'operation:operationId' (e.g., 'login:ACB:deviceId:timestamp' or 'withdraw:withdrawalId:deviceId')\n  ttl: number; // TTL in milliseconds\n  lockId: string; // Unique lock ID for safe release\n}\n\n// Lua script for atomic unlock (only unlock if lockId matches)\nconst UNLOCK_SCRIPT = `\nif redis.call(\"GET\", KEYS[1]) == ARGV[1] then\n  redis.call(\"DEL\", KEYS[2])\n  return redis.call(\"DEL\", KEYS[1])\nelse\n  return 0\nend\n`;\n\n@Injectable()\nexport class DeviceLockService {\n  private readonly logger = new Logger(DeviceLockService.name);\n  private readonly REDIS_LOCK_PREFIX = 'device:lock:';\n  private readonly DEFAULT_LOCK_TTL = 10 * 60 * 1000; // 10 minutes default\n\n  constructor(private readonly redisService: RedisService) {}\n\n  /**\n   * Acquire lock for a device (atomic operation using SET NX EX)\n   */\n  async acquireLock(\n    deviceId: string,\n    lockType: DeviceLockType,\n    lockedBy: string,\n    ttl: number = this.DEFAULT_LOCK_TTL\n  ): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const lockId = randomUUID();\n      const ttlSeconds = Math.ceil(ttl / 1000);\n\n      // Use atomic SET NX EX to acquire lock\n      // This ensures only one process can acquire the lock\n      const client = await this.redisService.getClient();\n      const result = await client.set(key, lockId, 'EX', ttlSeconds, 'NX');\n\n      if (result === 'OK') {\n        // Lock acquired successfully, store metadata\n        const lockMetadata: Omit<DeviceLock, 'lockId'> = {\n          deviceId,\n          lockType,\n          lockedAt: Date.now(),\n          lockedBy,\n          ttl,\n        };\n        await this.redisService.setex(metadataKey, ttlSeconds, JSON.stringify(lockMetadata));\n        \n        this.logger.log(`Acquired ${lockType} lock for device ${deviceId} (${lockedBy}) with lockId ${lockId}`);\n        return true;\n      }\n\n      // Lock already exists\n      this.logger.warn(\n        `Device ${deviceId} is already locked, cannot acquire lock`\n      );\n      return false;\n    } catch (error) {\n      this.logger.error(`Error acquiring lock for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Release lock for a device (atomic operation using Lua script)\n   */\n  async releaseLock(deviceId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const client = await this.redisService.getClient();\n      \n      // Get current lockId before releasing\n      const lockId = await client.get(key);\n      \n      if (!lockId) {\n        // Lock doesn't exist, clean up metadata if exists\n        await this.redisService.del(metadataKey);\n        this.logger.debug(`Device ${deviceId} is not locked, nothing to release`);\n        return;\n      }\n\n      // Use Lua script to atomically check and delete only if lockId matches\n      // This prevents releasing lock that was acquired by another process\n      const result = await client.eval(\n        UNLOCK_SCRIPT,\n        2, // number of keys\n        key, // KEYS[1] - lock key\n        metadataKey, // KEYS[2] - metadata key\n        lockId as string // ARGV[1] - lockId to verify\n      ) as number;\n\n      if (result === 1) {\n        this.logger.log(`Released lock for device ${deviceId} (lockId: ${lockId})`);\n      } else {\n        // Lock was already released or changed by another process\n        this.logger.warn(`Lock for device ${deviceId} was already released or changed (expected lockId: ${lockId})`);\n      }\n    } catch (error) {\n      this.logger.error(`Error releasing lock for device ${deviceId}: ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Get current lock for a device\n   */\n  async getLock(deviceId: string): Promise<DeviceLock | null> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const lockId = await this.redisService.get(key);\n      \n      if (!lockId) {\n        return null;\n      }\n\n      // Get metadata\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const metadataStr = await this.redisService.get(metadataKey);\n      \n      if (!metadataStr) {\n        // Metadata missing but lock exists - return minimal info\n        return {\n          deviceId,\n          lockType: 'transfer', // default\n          lockedAt: Date.now(),\n          lockedBy: 'unknown',\n          ttl: this.DEFAULT_LOCK_TTL,\n          lockId,\n        };\n      }\n\n      const metadata = JSON.parse(metadataStr) as Omit<DeviceLock, 'lockId'>;\n      return {\n        ...metadata,\n        lockId,\n      };\n    } catch (error) {\n      this.logger.error(`Error getting lock for device ${deviceId}: ${error.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Check if device is locked\n   */\n  async isLocked(deviceId: string, excludeType?: DeviceLockType): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const exists = await this.redisService.exists(key);\n      \n      if (!exists) {\n        return false;\n      }\n\n      const lock = await this.getLock(deviceId);\n      if (!lock) {\n        return false;\n      }\n\n      // If excludeType is provided, allow if lock is of that type\n      if (excludeType && lock.lockType === excludeType) {\n        return false;\n      }\n\n      return true;\n    } catch (error) {\n      this.logger.error(`Error checking lock status for device ${deviceId}: ${error.message}`);\n      // On error, assume not locked (fail open)\n      return false;\n    }\n  }\n\n  /**\n   * Extend lock TTL (with ownership verification)\n   */\n  async extendLock(deviceId: string, additionalTtl: number): Promise<boolean> {\n    try {\n      const lock = await this.getLock(deviceId);\n      \n      if (!lock) {\n        return false;\n      }\n\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const client = await this.redisService.getClient();\n      const currentTtlSeconds = await client.ttl(key);\n      \n      if (currentTtlSeconds <= 0) {\n        // Lock expired\n        return false;\n      }\n\n      const newTtlSeconds = Math.ceil((currentTtlSeconds * 1000 + additionalTtl) / 1000);\n      const expireResult = await client.expire(key, newTtlSeconds);\n      \n      if (expireResult === 1) {\n        // Also extend metadata TTL\n        await this.redisService.expire(metadataKey, newTtlSeconds);\n        \n        this.logger.log(`Extended lock for device ${deviceId} by ${additionalTtl}ms`);\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      this.logger.error(`Error extending lock for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Release lock by type (force release if lock type matches)\n   */\n  async releaseLockByType(deviceId: string, lockType: DeviceLockType): Promise<boolean> {\n    try {\n      const lock = await this.getLock(deviceId);\n      \n      if (!lock) {\n        return false;\n      }\n\n      // Only release if lock type matches\n      if (lock.lockType !== lockType) {\n        return false;\n      }\n\n      // Force release by directly deleting the keys (no lockId verification needed)\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      \n      await this.redisService.del(key);\n      await this.redisService.del(metadataKey);\n      \n      this.logger.log(`Force released ${lockType} lock for device ${deviceId}`);\n      return true;\n    } catch (error) {\n      this.logger.error(`Error releasing ${lockType} lock for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n}\n\n","module.exports = require(\"crypto\");","/**\n * Error types for withdrawal processing\n */\nexport enum ErrorType {\n  TEMPORARY = 'TEMPORARY',    // C th retry (session, network, device busy)\n  PERMANENT = 'PERMANENT',    // Khng nn retry (invalid data, insufficient funds)\n  UNKNOWN = 'UNKNOWN'         // Khng r, retry vi gii hn\n}\n\n/**\n * Custom error for withdrawal processing with error type classification\n */\nexport class WithdrawalProcessingError extends Error {\n  constructor(\n    message: string,\n    public readonly errorType: ErrorType,\n    public readonly withdrawalId: string\n  ) {\n    super(message);\n    this.name = 'WithdrawalProcessingError';\n  }\n}\n\n/**\n * Helper function to classify error type from reason string\n */\nexport function classifyError(reason: string, error?: Error): ErrorType {\n  const reasonLower = reason.toLowerCase();\n  const errorMessage = error?.message?.toLowerCase() || '';\n  \n  // Li tm thi - c th retry\n  const temporaryPatterns = [\n    'session',\n    'network',\n    'timeout',\n    'device',\n    'locked',\n    'busy',\n    'connection',\n    'temporary',\n    'not active',\n    'unexpectedly locked'\n  ];\n  \n  // Li vnh vin - khng nn retry\n  const permanentPatterns = [\n    'insufficient',\n    'invalid',\n    'not found',\n    'unauthorized',\n    'forbidden',\n    'bad request',\n    'required'\n  ];\n  \n  const fullText = `${reasonLower} ${errorMessage}`;\n  \n  if (permanentPatterns.some(pattern => fullText.includes(pattern))) {\n    return ErrorType.PERMANENT;\n  }\n  \n  if (temporaryPatterns.some(pattern => fullText.includes(pattern))) {\n    return ErrorType.TEMPORARY;\n  }\n  \n  return ErrorType.UNKNOWN;\n}\n\n","import { Injectable, Logger, OnModuleInit, Inject } from '@nestjs/common';\nimport { Cron } from '@nestjs/schedule';\nimport { InjectQueue } from '@nestjs/bull';\nimport { Queue, Job } from 'bull';\nimport { WithdrawalService } from './withdrawal.service';\nimport { DeviceService } from '../device/device.service';\nimport { DeviceLockService } from '../device/device-lock.service';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { WithdrawalProcessingError, ErrorType, classifyError } from './withdrawal-errors';\nimport { cloneDeep } from 'lodash';\nimport { withCronLock } from '@/common/redis/cron-lock';\n\n@Injectable()\nexport class WithdrawalJobManagerService implements OnModuleInit {\n  private readonly logger = new Logger(WithdrawalJobManagerService.name);\n  private processingJobs: Set<number | string> = new Set(); // Track job IDs being processed\n  private isInitialized = false;\n\n  constructor(\n    @InjectQueue('wda-request') private readonly withdrawalQueue: Queue<Withdrawal>,\n    private readonly withdrawalService: WithdrawalService,\n    private readonly deviceService: DeviceService,\n    private readonly deviceLock: DeviceLockService,\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n  ) { }\n\n  async onModuleInit() {\n    this.logger.log('WithdrawalJobManagerService initialized, waiting 5 seconds before starting...');\n    // Wait a bit for other services to initialize\n    setTimeout(() => {\n      this.initializeJobProcessing();\n    }, 5000);\n  }\n\n  /**\n   * Initialize job processing - pick jobs equal to number of active devices\n   */\n  private async initializeJobProcessing() {\n    if (this.isInitialized) {\n      return;\n    }\n\n    await this.startProcessing();\n  }\n\n  /**\n   * Start processing jobs - pick jobs equal to number of active devices\n   * Can be called when service status changes from inactive to active\n   */\n  async startProcessing(): Promise<void> {\n    try {\n      this.logger.log('Starting withdrawal job processing...');\n\n      await this.pickAndProcessJobs();\n\n      this.isInitialized = true;\n    } catch (error) {\n      this.logger.error(`Error starting job processing: ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Get list of available devices (Active AND Unlocked)\n   */\n  private async getAvailableDevices(): Promise<Array<{ udid: string; config: any }>> {\n    try {\n      const devices = await this.wsService.listDevices();\n      const availableDevices = [];\n\n      for (const device of devices) {\n        // 1. Check Config Status\n        const deviceConfig = await this.deviceService.getDeviceConfig(device.udid);\n        if (deviceConfig?.status !== 'active') {\n          continue;\n        }\n\n        // 2. Check Lock Status (Must be free)\n        const isLocked = await this.deviceLock.isLocked(device.udid);\n        if (isLocked) {\n          // this.logger.debug(`Device ${device.udid} is active but LOCKED. Skipping.`);\n          continue;\n        }\n\n        availableDevices.push({ udid: device.udid, config: deviceConfig });\n      }\n\n      return availableDevices;\n    } catch (error) {\n      this.logger.error(`Error getting available devices: ${error.message}`);\n      return [];\n    }\n  }\n\n  /**\n   * Pick and process jobs from queue\n   * Strategy: Find N available devices -> Pick N jobs -> Assign strictly\n   */\n  async pickAndProcessJobs(count?: number): Promise<void> {\n    try {\n      // Check service status\n      const serviceStatus = await this.deviceService.getServiceStatus();\n      if (serviceStatus !== 'active') {\n        this.logger.debug(`Service is ${serviceStatus}, cannot pick jobs`);\n        return;\n      }\n\n      // 1. Get Available Devices (Active + Unlocked)\n      const availableDevices = await this.getAvailableDevices();\n\n      // Filter out devices that are currently assigned to processing jobs (in-memory safeguard)\n      // Note: DeviceLock check above should cover this, but this adds extra layer if lock is acquired later\n      // Actually, since we process async, the lock might not be acquired yet if we just called processJob.\n      // But we don't map job->device in `processingJobs`.\n      // The best way is to rely on `getAvailableDevices` checking the Lock Service.\n\n      // Calculate capacity\n      const capacity = availableDevices.length;\n\n      if (capacity <= 0) {\n        // this.logger.debug(`No available (unlocked) devices. Waiting...`);\n        return;\n      }\n\n      // 2. Pick Jobs\n      // Number of jobs to pick = min(requested_count OR capacity, capacity)\n      // Since each job needs 1 unique device.\n      const jobsToPick = count ? Math.min(count, capacity) : capacity;\n\n      // Get waiting and delayed jobs separately\n      // getJobs(types, start, end): end is inclusive.\n      // If we want N jobs, index is 0 to N-1\n      const waitingJobs = await this.withdrawalQueue.getJobs(['waiting'], 0, jobsToPick - 1);\n\n\n      if (waitingJobs.length === 0) {\n        // this.logger.debug('No waiting jobs available in queue');\n        return;\n      }\n\n      this.logger.log(\n        `Found ${availableDevices.length} available devices. ` +\n        `Picking ${waitingJobs.length} jobs (${(waitingJobs || []).length} waiting.`\n      );\n\n      // 3. Assign Job -> Device\n      // We iterate through picked jobs and assign to available devices index-by-index\n      for (let i = 0; i < waitingJobs.length; i++) {\n        const job = waitingJobs[i];\n        const device = availableDevices[i]; // Guaranteed to exist because jobsToPick <= capacity\n\n        // Skip if already processing (safety check)\n        // TODO: remove log\n        this.logger.debug(`Processing jobs: ${JSON.stringify(this.processingJobs)}`);\n        if (this.processingJobs.has(job.id)) {\n          continue;\n        }\n\n        // CRITICAL: Acquire lock immediately to prevent race condition\n        const operationId = `withdraw:${job.data.withdrawalId}:${device.udid}`;\n        const lockAcquired = await this.deviceLock.acquireLock(\n          device.udid,\n          'transfer',\n          operationId,\n          3.68 * 60 * 1000 // 3.68 minutes\n        );\n\n        if (!lockAcquired) {\n          this.logger.warn(`Device ${device.udid} was locked after assignment, skipping job ${job.id}`);\n          continue; // Skip this job, it will be picked up later\n        }\n\n        // Lock acquired - process job\n        // Note: processWithdrawal will release the lock in its finally block\n        this.processJob(job, device.udid)\n          .catch(error => {\n            // Safety: release lock if processJob fails before processWithdrawal\n            this.deviceLock.releaseLock(device.udid).catch(() => { });\n            this.logger.error(`Error processing job ${job.id}: ${error.message}`, error.stack);\n          });\n      }\n    } catch (error) {\n      this.logger.error(`Error picking jobs: ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Process a single job with assigned device\n   */\n  private async processJob(job: Job<Withdrawal>, assignedDeviceId: string): Promise<void> {\n    const withdrawal = cloneDeep(job.data);\n    const { withdrawalId } = withdrawal;\n\n    try {\n      this.logger.log(`Successfully processed and removed withdrawal ${withdrawalId} from queue`);\n      await job.remove();\n    } catch (removeError) {\n      this.logger.warn(`Could not remove completed job ${job.id}: ${removeError.message}`);\n    }\n\n    if (!withdrawal || !withdrawal.withdrawalId) {\n      this.logger.error(`Invalid withdrawal data in job ${job.id}`);\n    }\n\n    // Mark as processing\n    this.processingJobs.add(job.id);\n\n    try {\n      await this.withdrawalService.processWithdrawal(withdrawal, assignedDeviceId);\n    } catch (error) {\n      // EXCEPTION = FAILED\n      this.logger.error(`Error processing withdrawal ${withdrawalId}: ${error.message}`, error.stack);\n\n      // Extract error type t error nu c\n      let errorType: ErrorType;\n      if (error instanceof WithdrawalProcessingError) {\n        errorType = error.errorType;\n      } else {\n        errorType = classifyError(error.message, error);\n      }\n\n      await this.handleJobFailure(withdrawal, error.message, errorType);\n    } finally {\n      // Remove from processing set\n      this.processingJobs.delete(job.id as number);\n    }\n  }\n\n  /**\n   * Handle Job Failure: Retry logic with error type classification\n   */\n  private async handleJobFailure(\n    withdrawal: Withdrawal,\n    reason: string,\n    errorType: ErrorType = ErrorType.UNKNOWN\n  ) {\n    const maxRetries = 3;\n\n    const currentRetries = withdrawal.manualRetryCount ?? 0;\n\n    this.logger.warn(\n      `Withdrawal ${withdrawal.withdrawalId} failed. ` +\n      `Reason: ${reason}. ` +\n      `Error Type: ${errorType}. ` +\n      `Retry attempt: ${currentRetries}/${maxRetries}`\n    );\n\n    if (currentRetries < maxRetries) {\n      if (errorType === ErrorType.UNKNOWN) {\n        return;\n      }\n\n      await this.withdrawalQueue.add(\n        'process-withdrawal-request',\n        {\n          ...withdrawal,\n          manualRetryCount: currentRetries + 1,\n          lastErrorType: errorType,\n          lastErrorReason: reason\n        },\n        {\n          attempts: 0,\n          removeOnComplete: false,\n          removeOnFail: false,\n          jobId: `withdrawal-request-${withdrawal.withdrawalId}`,\n          priority: 0,\n          delay: 30000, // 30s\n        }\n      );\n    } else {\n      this.logger.warn(`Max retries (${maxRetries}) exceeded for withdrawal ${withdrawal.withdrawalId}: ${errorType} error: ${reason}`);\n    }\n  }\n\n  private async promoteDelayedJobs() {\n    return withCronLock('cron:promote_delayed:withdrawal', 5000, async () => {\n      const now = Date.now();\n      const BATCH = 100;\n\n      // Ly mt batch job  delayed\n      const delayedJobs: Job[] = await this.withdrawalQueue.getJobs(\n        ['delayed'],\n        0,\n        BATCH - 1,\n      );\n\n      if (!delayedJobs.length) return;\n\n      let promoted = 0;\n\n      for (const job of delayedJobs) {\n        const delayMs = typeof job.opts?.delay === 'number' ? job.opts.delay : 0;\n        const ts = typeof job.timestamp === 'number' ? job.timestamp : 0;\n\n        const dueAt = ts + delayMs;\n\n        // ch promote job n hn\n        if (dueAt <= now) {\n          try {\n            // Bull h tr job.promote()  chuyn delayed -> waiting\n            await job.promote();\n            promoted++;\n          } catch (e) {\n            this.logger.debug(`Promote skipped for job ${job.id}: ${String(e)}`);\n          }\n        }\n      }\n\n      if (promoted > 0) {\n        this.logger.log(`Promoted ${promoted} delayed jobs to waiting`);\n      }\n    });\n  }\n\n  /**\n   * Manually trigger job picking (for testing or manual operations)\n   */\n  async triggerPickJobs(count: number = 1): Promise<void> {\n    await this.pickAndProcessJobs(count);\n  }\n\n  /**\n   * Get queue statistics\n   */\n  async getQueueStats() {\n    // Need to implement new stats logic if needed, but keeping existing is fine for now\n    // availableDevices logic changed slightly\n    const [waiting, delayed, active, completed, failed, availableDevices, serviceStatus] = await Promise.all([\n      this.withdrawalQueue.getWaitingCount(),\n      this.withdrawalQueue.getDelayedCount(),\n      this.withdrawalQueue.getActiveCount(),\n      this.withdrawalQueue.getCompletedCount(),\n      this.withdrawalQueue.getFailedCount(),\n      this.getAvailableDevices(),\n      this.deviceService.getServiceStatus(),\n    ]);\n\n    return {\n      serviceStatus,\n      activeDevices: availableDevices.length, // Now explicitly unlocked active devices\n      processingJobs: this.processingJobs.size,\n      isInitialized: this.isInitialized,\n      queue: {\n        waiting,\n        delayed,\n        active,\n        completed,\n        failed,\n        total: waiting + delayed + active,\n      },\n    };\n  }\n\n  /**\n   * Debug method: Get detailed queue information\n   */\n  async debugQueue() {\n    const stats = await this.getQueueStats();\n    const [waitingJobs, delayedJobs] = await Promise.all([\n      this.withdrawalQueue.getJobs(['waiting'], 0, 9), // Get first 10 waiting jobs\n      this.withdrawalQueue.getJobs(['delayed'], 0, 9), // Get first 10 delayed jobs\n    ]);\n\n    return {\n      ...stats,\n      sampleWaitingJobs: waitingJobs.map(job => ({\n        id: job.id,\n        data: job.data,\n        opts: job.opts,\n        manualRetryCount: (job.data as any).manualRetryCount\n      })),\n      sampleDelayedJobs: delayedJobs.map(job => ({\n        id: job.id,\n        data: job.data,\n        opts: job.opts,\n        manualRetryCount: (job.data as any).manualRetryCount\n      })),\n    };\n  }\n\n  /**\n   * Periodically check and pick jobs if there are available slots\n   * Runs every 5 seconds\n   */\n  @Cron('*/5 * * * * *')\n  async periodicJobPicking() {\n    await this.pickAndProcessJobs();\n  }\n\n  /**\n   * Promote delayed jobs to waiting jobs\n   * Runs every 5 seconds\n   */\n  @Cron('*/5 * * * * *')\n  async promoteDelayedJobsPeriodically() {\n    await this.promoteDelayedJobs();\n  }\n}\n","module.exports = require(\"bull\");","module.exports = require(\"lodash\");","import Redis from 'ioredis';\nimport { config } from '../constants/config';\n\nconst redis = new Redis({\n  host: config.redis.host,\n  port: config.redis.port,\n  password: config.redis.password,\n  db: config.redis.db,\n});\n\nexport const withCronLock = async (key: string, ttlMs: number, fn: () => Promise<void>) => {\n  const lockVal = `${process.pid}:${Date.now()}`;\n  const ok = await redis.set(key, lockVal, 'PX', ttlMs, 'NX');\n  if (!ok) return;\n\n  try {\n    await fn();\n  } finally {\n    // release best-effort: ch xo nu vn l ch lock\n    const lua = `\n      if redis.call(\"GET\", KEYS[1]) == ARGV[1] then\n        return redis.call(\"DEL\", KEYS[1])\n      end\n      return 0\n    `;\n    await redis.eval(lua, 1, key, lockVal);\n  }\n}","import { Controller, Get, Post, Logger } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse } from '@nestjs/swagger';\nimport { WithdrawalJobManagerService } from './withdrawal-job-manager.service';\n\n@ApiTags('withdrawal')\n@Controller('api/withdrawal')\nexport class WithdrawalController {\n  private readonly logger = new Logger(WithdrawalController.name);\n\n  constructor(\n    private readonly jobManagerService: WithdrawalJobManagerService,\n  ) {}\n\n  @Get('queue/stats')\n  @ApiOperation({ summary: 'Get withdrawal queue statistics' })\n  @ApiResponse({ status: 200, description: 'Queue statistics' })\n  async getQueueStats() {\n    return await this.jobManagerService.getQueueStats();\n  }\n\n  @Get('queue/debug')\n  @ApiOperation({ summary: 'Get detailed queue debug information' })\n  @ApiResponse({ status: 200, description: 'Detailed queue debug info' })\n  async debugQueue() {\n    return await this.jobManagerService.debugQueue();\n  }\n\n  @Post('queue/trigger')\n  @ApiOperation({ summary: 'Manually trigger job picking' })\n  @ApiResponse({ status: 200, description: 'Job picking triggered' })\n  async triggerJobPicking() {\n    this.logger.log('Manually triggering job picking...');\n    await this.jobManagerService.triggerPickJobs(1);\n    const stats = await this.jobManagerService.getQueueStats();\n    return {\n      success: true,\n      message: 'Job picking triggered',\n      stats,\n    };\n  }\n\n  @Post('queue/start')\n  @ApiOperation({ summary: 'Manually start job processing' })\n  @ApiResponse({ status: 200, description: 'Job processing started' })\n  async startProcessing() {\n    this.logger.log('Manually starting job processing...');\n    await this.jobManagerService.startProcessing();\n    const stats = await this.jobManagerService.getQueueStats();\n    return {\n      success: true,\n      message: 'Job processing started',\n      stats,\n    };\n  }\n}\n\n\n","import { Module } from '@nestjs/common';\nimport { HcBoxService } from './hcbox.service';\n\n@Module({\n  providers: [HcBoxService],\n  exports: [HcBoxService],\n})\nexport class HcBoxModule {}\n\n","import { Module, forwardRef } from '@nestjs/common';\nimport { DeviceController } from './device.controller';\nimport { DeviceService } from './device.service';\nimport { DeviceLockService } from './device-lock.service';\nimport { HcBoxModule } from '../hcbox/hcbox.module';\nimport { RedisService } from '../../common/services/redis.service';\nimport { BankModule } from '../bank/bank.module';\n\n@Module({\n  imports: [\n    HcBoxModule,\n    forwardRef(() => BankModule),\n  ],\n  controllers: [DeviceController],\n  providers: [\n    DeviceService,\n    DeviceLockService,\n    RedisService,\n  ],\n  exports: [\n    DeviceService,\n    DeviceLockService,\n  ],\n})\nexport class DeviceModule {}\n\n","import { Controller, Get, Put, Param, Body, Post, Render, HttpException, HttpStatus, Logger } from '@nestjs/common';\nimport { DeviceService } from './device.service';\nimport { UpdateDeviceConfigDto } from './dto/device-config.dto';\nimport { BankService } from '../bank/bank.service';\nimport { config } from '@/common/constants/config';\n\n@Controller()\nexport class DeviceController {\n  private readonly logger = new Logger(DeviceController.name);\n\n  constructor(\n    private readonly deviceService: DeviceService,\n    private readonly bankService: BankService,\n  ) { }\n\n  @Get()\n  @Render('devices')\n  async getDevicesPage() {\n    const devices = await this.deviceService.listDevices();\n    const serviceStatus = await this.deviceService.getServiceStatus();\n\n    return {\n      devices,\n      serviceStatus,\n      banks: ['VIETCOMBANK', 'TPBANK', 'TECHCOMBANK', 'ACB', 'PGBANK'],\n      boxType: config.boxType,\n    };\n  }\n\n  @Get('api/devices')\n  async getDevices() {\n    const devices = await this.deviceService.listDevices();\n    return {\n      success: true,\n      data: devices,\n    };\n  }\n\n  @Get('api/devices/:deviceId/config')\n  async getDeviceConfig(@Param('deviceId') deviceId: string) {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    return {\n      success: true,\n      data: config,\n    };\n  }\n\n  @Post('api/devices/:deviceId/retryLogin')\n  async retryLogin(@Param('deviceId') deviceId: string) {\n    try {\n      this.logger.log(`Retry login requested for device ${deviceId}`);\n\n      // Get device config to check bankCode and status\n      const deviceConfig = await this.deviceService.getDeviceConfig(deviceId);\n\n      if (!deviceConfig) {\n        throw new HttpException(\n          {\n            success: false,\n            error: `Device ${deviceId} not found or not configured`,\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      if (!deviceConfig.bankCode || deviceConfig.bankCode.trim() === '') {\n        throw new HttpException(\n          {\n            success: false,\n            error: `Device ${deviceId} does not have bankCode configured. Please configure bankCode first.`,\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      if (deviceConfig.status !== 'active') {\n        throw new HttpException(\n          {\n            success: false,\n            error: `Device ${deviceId} is not active. Please activate the device first.`,\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      // Attempt to login\n      const bankCode = deviceConfig.bankCode.toUpperCase();\n      await this.bankService.login(bankCode, deviceId);\n\n      return {\n        success: true,\n        message: `Successfully logged in to ${bankCode} on device ${deviceId}`,\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error retrying login for device ${deviceId}: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to retry login',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Put('api/devices/:deviceId/config')\n  async updateDeviceConfig(\n    @Param('deviceId') deviceId: string,\n    @Body() dto: UpdateDeviceConfigDto,\n  ) {\n    try {\n      this.logger.log(`Updating device config for ${deviceId}: ${JSON.stringify(dto)}`);\n\n      // Get existing config to check current status if status is not provided\n      const existingConfig = await this.deviceService.getDeviceConfig(deviceId);\n      const finalStatus = dto.status !== undefined ? dto.status : existingConfig?.status || 'deactive';\n\n      // Manual validation: if status is 'active' (either from dto or existing), all fields are required\n      if (finalStatus === 'active') {\n        const errors: string[] = [];\n\n        // Check bankCode: from dto or existing config\n        const bankCode = dto.bankCode !== undefined ? dto.bankCode : existingConfig?.bankCode;\n        if (!bankCode || bankCode.trim() === '') {\n          errors.push('Bank Code l bt buc khi status l active');\n        }\n\n        // Check availableAmount: from dto or existing config\n        const availableAmount = dto.availableAmount !== undefined ? dto.availableAmount : existingConfig?.availableAmount;\n        if (availableAmount === undefined || availableAmount === null || availableAmount < 0) {\n          errors.push('Available Amount l bt buc v phi >= 0 khi status l active');\n        }\n\n        // Check password: from dto or existing config\n        const password = dto.password !== undefined ? dto.password : existingConfig?.password;\n        if (!password || password.trim() === '') {\n          errors.push('Password l bt buc khi status l active');\n        }\n\n        // Check smartOTP: from dto or existing config\n        const smartOTP = dto.smartOTP !== undefined ? dto.smartOTP : existingConfig?.smartOTP;\n        if (!smartOTP || smartOTP.trim() === '') {\n          errors.push('Smart OTP l bt buc khi status l active');\n        }\n\n        if (errors.length > 0) {\n          throw new HttpException(\n            {\n              success: false,\n              error: errors.join(', '),\n            },\n            HttpStatus.BAD_REQUEST,\n          );\n        }\n      }\n\n      const config = await this.deviceService.updateDeviceConfig(deviceId, dto);\n      return {\n        success: true,\n        data: config,\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error updating device config for ${deviceId}: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to update device config',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('api/service/status')\n  async getServiceStatus() {\n    const status = await this.deviceService.getServiceStatus();\n    return {\n      success: true,\n      data: { status },\n    };\n  }\n\n  @Post('api/service/start')\n  async startService() {\n    try {\n      // Check if there is at least one device with status = 'active'\n      const hasActiveDevice = await this.deviceService.hasActiveDevice();\n\n      if (!hasActiveDevice) {\n        throw new HttpException(\n          {\n            success: false,\n            error: 'Vui lng active bank trc khi start',\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      // Login all active banks (Non-blocking: don't await completion)\n      // This allows devices to start working individually as soon as they finish login\n      this.bankService.loginAllActiveBanks().catch(err => {\n        this.logger.error(`Error during background login process: ${err.message}`);\n      });\n\n      // Give a small buffer for logins to acquire locks before enabling service\n      await new Promise(resolve => setTimeout(resolve, 2000));\n\n      // Set service status to active\n      await this.deviceService.setServiceStatus('active');\n\n      // Trigger job processing immediately\n      // (Optional: fetch JobManager and trigger? But cron will pick it up in <10s)\n\n      return {\n        success: true,\n        message: 'Service started successfully. Devices are logging in and will accept jobs when ready.',\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error starting service: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to start service',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Post('api/service/stop')\n  async stopService() {\n    await this.deviceService.setServiceStatus('inactive');\n    return {\n      success: true,\n      message: 'Service stopped successfully',\n    };\n  }\n}\n\n","import { IsOptional, IsString, IsNumber, IsIn, ValidateIf, IsNotEmpty, Min } from 'class-validator';\n\nexport class UpdateDeviceConfigDto {\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Bank Code is required when status is active' })\n  @IsString()\n  @IsOptional()\n  bankCode?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Available Amount is required when status is active' })\n  @IsNumber()\n  @Min(0, { message: 'Available Amount must be greater than or equal to 0' })\n  @IsOptional()\n  availableAmount?: number;\n\n  @IsOptional()\n  @IsString()\n  @IsIn(['active', 'deactive'])\n  status?: 'active' | 'deactive';\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Password is required when status is active' })\n  @IsString()\n  @IsOptional()\n  password?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Smart OTP is required when status is active' })\n  @IsString()\n  @IsOptional()\n  smartOTP?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Account No is required when status is active' })\n  @IsString()\n  @IsOptional()\n  accountNo?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Account Name is required when status is active' })\n  @IsString()\n  @IsOptional()\n  accountName?: string;\n}\n\nexport interface DeviceConfig {\n  deviceId: string;\n  bankCode?: string;\n  availableAmount: number;\n  status: 'active' | 'deactive';\n  password: string;\n  smartOTP: string;\n  accountNo: string;\n  accountName: string;\n}\n\n","module.exports = require(\"class-validator\");","import { Module, forwardRef } from '@nestjs/common';\nimport { BankService } from './bank.service';\nimport { AcbService } from './acb.service';\nimport { PgService } from './pg.service';\nimport { BankController } from './bank.controller';\nimport { HcBoxModule } from '../hcbox/hcbox.module';\nimport { DeviceModule } from '../device/device.module';\nimport { WebSocketModule } from '../../common/modules/websocket/websocket.module';\nimport { SessionManagementService } from './session-management.service';\nimport { SessionRefreshScheduler } from './session-refresh.scheduler';\nimport { RedisService } from '../../common/services/redis.service';\n\n@Module({\n  imports: [\n    HcBoxModule,\n    forwardRef(() => DeviceModule),\n    WebSocketModule\n  ],\n  controllers: [BankController],\n  providers: [\n    BankService,\n    AcbService,\n    PgService,\n    SessionManagementService,\n    SessionRefreshScheduler,\n    RedisService,\n  ],\n  exports: [BankService],\n})\nexport class BankModule {}\n\n","import { Controller, Post, Param, Get, Query, Logger, HttpException, HttpStatus, Inject } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiParam, ApiQuery, ApiResponse } from '@nestjs/swagger';\nimport { BankService } from './bank.service';\nimport { HcBoxService } from '../hcbox/hcbox.service';\nimport { IBankService } from './interfaces/bank-service.interface';\nimport { config } from '@/common/constants/config';\nimport { IWebSocketService, PandaSwipeType } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\n\n@ApiTags('bank')\n@Controller('api/bank/:bankCode')\nexport class BankController {\n  private readonly logger = new Logger(BankController.name);\n\n  constructor(\n    private readonly bankService: BankService,\n    private readonly hcBoxService: HcBoxService,\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n  ) {}\n\n  /**\n   * Get bank service by bank code\n   */\n  private getBankService(bankCode: string): IBankService {\n    const service = this.bankService.getBankService(bankCode);\n    if (!service) {\n      throw new HttpException(\n        {\n          success: false,\n          error: `Bank service not found for bank code: ${bankCode}. Supported banks: ${this.bankService.getSupportedBanks().join(', ')}`,\n        },\n        HttpStatus.BAD_REQUEST,\n      );\n    }\n    return service;\n  }\n\n  @Get('devices')\n  @ApiOperation({ summary: 'Get list of available devices' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiResponse({ status: 200, description: 'List of devices retrieved successfully' })\n  async getDevices(@Param('bankCode') bankCode: string) {\n    try {\n      const devices = await this.hcBoxService.listDevices();\n      return {\n        success: true,\n        data: devices,\n      };\n    } catch (error) {\n      this.logger.error(`Error getting devices: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/launch-app/:deviceId')\n  @ApiOperation({ summary: 'Test launching bank app on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiResponse({ status: 200, description: 'App launched successfully' })\n  async testLaunchApp(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n  ) {\n    try {\n      const service = this.getBankService(bankCode);\n      this.logger.log(`Testing ${bankCode} app launch on device: ${deviceId}`);\n      \n      await service.launchApp(deviceId);\n      \n      return {\n        success: true,\n        message: `${bankCode} app launched successfully on device ${deviceId}`,\n      };\n    } catch (error) {\n      this.logger.error(`Error testing ${bankCode} app launch: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/capture-screen/:deviceId')\n  @ApiOperation({ summary: 'Test screen capture on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'name', description: 'Screen capture name (optional)', required: false })\n  @ApiQuery({ name: 'quality', description: 'Image quality (0-1, default: 0.5)', required: false })\n  @ApiResponse({ status: 200, description: 'Screen captured successfully' })\n  async testCaptureScreen(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('name') name?: string,\n    @Query('quality') quality?: string,\n  ) {\n    try {\n      const service = this.getBankService(bankCode);\n      this.logger.log(`Testing screen capture on device: ${deviceId}`);\n      \n      const qualityValue = quality ? parseFloat(quality) : 0.5;\n      const captureName = name || `test-screen-capture-${Date.now()}`;\n      \n      const base64Image = await this.wsService.captureScreen(deviceId, {\n        quality: qualityValue,\n        folderPath: `C:/boxscreen/${captureName}.png`,\n      });\n      \n      return {\n        success: true,\n        message: `Screen captured successfully on device ${deviceId}`,\n        data: {\n          base64Image,\n          imageLength: base64Image?.length ?? 0,\n        },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing screen capture: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/click/:deviceId')\n  @ApiOperation({ summary: 'Test clicking at specific coordinates on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'x', description: 'X coordinate (HC: 0-1, Panda: 0-100)', required: true })\n  @ApiQuery({ name: 'y', description: 'Y coordinate (Hc: 0-1), Panda: 0-100', required: true })\n  @ApiResponse({ status: 200, description: 'Click completed successfully' })\n  async testClickAtCoordinates(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('x') x: string,\n    @Query('y') y: string,\n  ) {\n    try {\n      const xCoord = parseFloat(x);\n      const yCoord = parseFloat(y);\n\n      if (isNaN(xCoord) || isNaN(yCoord)) {\n        return {\n          success: false,\n          error: 'Invalid coordinates. x and y must be numbers between 0 and 1',\n          example: `/api/bank/${bankCode}/test/click/{deviceId}?x=0.5&y=0.55`,\n        };\n      }\n\n      this.logger.log(`Testing click at coordinates (${xCoord}, ${yCoord}) on device: ${deviceId}`);\n      \n      await this.wsService.click(deviceId, xCoord, yCoord);\n      \n      return {\n        success: true,\n        message: `Click completed successfully at coordinates (${xCoord}, ${yCoord}) on device ${deviceId}`,\n        coordinates: { x: xCoord, y: yCoord },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing click at coordinates: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/swipe/:deviceId')\n  @ApiOperation({ summary: 'Test swiping on a device. Format is determined by config.boxType (HC or PANDA)' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'x', description: 'X coordinate (HC: 0-1, Panda: 0-100). Required for HC and Panda types 0,1,2,10. Optional for Panda types 4,5,6,7,8,9', required: false })\n  @ApiQuery({ name: 'y', description: 'Y coordinate (HC: 0-1, Panda: 0-100). Required for HC and Panda types 0,1,2,10. Optional for Panda types 4,5,6,7,8,9', required: false })\n  @ApiQuery({ name: 'type', description: 'Panda pointer event type: 0=(press), 1=(lift), 2=(move), 4=(scroll up), 5=(scroll down), 6=(swipe up), 7=(swipe down), 8=(swipe left), 9=(swipe right), 10=(click). Required for Panda format.', required: false })\n  @ApiQuery({ name: 'endX', description: 'End X coordinate for HC (required for HC: 0-1)', required: false })\n  @ApiQuery({ name: 'endY', description: 'End Y coordinate for HC (required for HC: 0-1)', required: false })\n  @ApiQuery({ name: 'duration', description: 'Swipe duration for HC (default: 0.2)', required: false })\n  @ApiResponse({ status: 200, description: 'Swipe completed successfully' })\n  async testSwipe(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('x') x?: string,\n    @Query('y') y?: string,\n    @Query('type') type?: string,\n    @Query('endX') endX?: string,\n    @Query('endY') endY?: string,\n    @Query('duration') duration?: string,\n  ) {\n    try {\n      const service = this.getBankService(bankCode);\n      \n      // Determine format based on config.boxType\n      const isPandaFormat = config.boxType === 'PANDA';\n      const isHCFormat = config.boxType === 'HC';\n\n      if (isPandaFormat) {\n        // Panda format: type is required\n        if (!type) {\n          return {\n            success: false,\n            error: 'For Panda format: type is required',\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?type=0`,\n          };\n        }\n\n        // Validate type: must be one of the valid Panda types\n        const validTypes: PandaSwipeType[] = ['0', '1', '2', '4', '5', '6', '7', '8', '9', '10'];\n        if (!validTypes.includes(type as PandaSwipeType)) {\n          return {\n            success: false,\n            error: `Invalid type. Type must be one of: 0 (/press), 1 (/lift), 2 (/move), 4 (/scroll up), 5 (/scroll down), 6 (/swipe up), 7 (/swipe down), 8 (/swipe left), 9 (/swipe right), 10 (/click)`,\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?type=0`,\n          };\n        }\n\n        // For scroll (4,5) and swipe directions (6,7,8,9), x and y are optional\n        const noCoordinateTypes: PandaSwipeType[] = ['4', '5', '6', '7', '8', '9'];\n        const isNoCoordinateType = noCoordinateTypes.includes(type as PandaSwipeType);\n\n        // For other types (0,1,2,10), x and y are required\n        if (!isNoCoordinateType && (!x || !y)) {\n          return {\n            success: false,\n            error: `For Panda type ${type}: x and y are required`,\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n          };\n        }\n\n        // Build options object\n        const pandaOptions: any = {\n          type: type as PandaSwipeType,\n        };\n\n        // Only add x, y if provided (required for non-swipe-direction types, optional for swipe directions)\n        if (x && y) {\n          const xCoord = parseFloat(x);\n          const yCoord = parseFloat(y);\n\n          if (isNaN(xCoord) || isNaN(yCoord)) {\n            return {\n              success: false,\n              error: 'Invalid coordinates. x and y must be numbers between 0 and 100 for Panda',\n              example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n            };\n          }\n\n          // Validate coordinates for Panda (0-100)\n          if (xCoord < 0 || xCoord > 100 || yCoord < 0 || yCoord > 100) {\n            return {\n              success: false,\n              error: 'Invalid coordinates. x and y must be between 0 and 100 for Panda',\n              example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n            };\n          }\n\n          pandaOptions.x = xCoord.toString();\n          pandaOptions.y = yCoord.toString();\n        }\n\n        this.logger.log(`Testing Panda swipe on device: ${deviceId} with type=${type}${x && y ? `, x=${x}, y=${y}` : ' (swipe direction, no coordinates)'}`);\n        \n        await this.wsService.swipe(deviceId, pandaOptions);\n        \n        return {\n          success: true,\n          message: `Panda swipe completed successfully on device ${deviceId}`,\n          coordinates: {\n            type: type,\n            ...(x && y ? { x, y } : {}),\n          },\n        };\n      } else if (isHCFormat) {\n        // HC format: x, y, endX, endY, duration (x, y, endX, endY required)\n        if (!x || !y || !endX || !endY) {\n          return {\n            success: false,\n            error: 'For HC format: x, y, endX, and endY are required',\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        const xCoord = parseFloat(x);\n        const yCoord = parseFloat(y);\n        const endXCoord = parseFloat(endX);\n        const endYCoord = parseFloat(endY);\n        const durationValue = duration ? parseFloat(duration) : 0.2;\n\n        if (isNaN(xCoord) || isNaN(yCoord) || isNaN(endXCoord) || isNaN(endYCoord)) {\n          return {\n            success: false,\n            error: 'Invalid coordinates. x, y, endX, and endY must be numbers between 0 and 1 for HC',\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        // Validate coordinates for HC (0-1)\n        if (xCoord < 0 || xCoord > 1 || yCoord < 0 || yCoord > 1 || \n            endXCoord < 0 || endXCoord > 1 || endYCoord < 0 || endYCoord > 1) {\n          return {\n            success: false,\n            error: 'Invalid coordinates. x, y, endX, and endY must be between 0 and 1 for HC',\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        this.logger.log(`Testing HC swipe from (${xCoord}, ${yCoord}) to (${endXCoord}, ${endYCoord}) on device: ${deviceId}`);\n        \n        await this.wsService.swipe(deviceId, {\n          x: xCoord,\n          y: yCoord,\n          endX: endXCoord,\n          endY: endYCoord,\n          duration: durationValue,\n        });\n        \n        return {\n          success: true,\n          message: `HC swipe completed successfully from (${xCoord}, ${yCoord}) to (${endXCoord}, ${endYCoord}) on device ${deviceId}`,\n          coordinates: {\n            start: { x: xCoord, y: yCoord },\n            end: { x: endXCoord, y: endYCoord },\n            duration: durationValue,\n          },\n        };\n      } else {\n        return {\n          success: false,\n          error: `Invalid box type configuration: ${config.boxType}. Must be 'HC' or 'PANDA'`,\n        };\n      }\n    } catch (error) {\n      this.logger.error(`Error testing swipe: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/input-numpad/:deviceId')\n  @ApiOperation({ summary: 'Test inputting number using numpad layout on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'number', description: 'Number string to input (e.g., \"123\", \"456789\")', required: true })\n  @ApiResponse({ status: 200, description: 'Numpad number input completed successfully' })\n  async testInputNumpadNumber(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('number') number: string,\n  ) {\n    try {\n      const service = this.getBankService(bankCode);\n      \n      if (!number || number.trim().length === 0) {\n        return {\n          success: false,\n          error: 'Number is required and cannot be empty',\n          example: `/api/bank/${bankCode}/test/input-numpad/{deviceId}?number=123456`,\n        };\n      }\n\n      // Validate that number contains only digits\n      if (!/^\\d+$/.test(number)) {\n        return {\n          success: false,\n          error: 'Number must contain only digits (0-9)',\n          example: `/api/bank/${bankCode}/test/input-numpad/{deviceId}?number=123456`,\n        };\n      }\n\n      this.logger.log(`Testing numpad number input \"${number}\" on device: ${deviceId}`);\n      \n      await this.hcBoxService.inputNumpadNumber(deviceId, number);\n      \n      return {\n        success: true,\n        message: `Numpad number input completed successfully on device ${deviceId}`,\n        data: {\n          number: number,\n          digits: number.split('').map(d => parseInt(d)),\n        },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing numpad number input: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/input-text/:deviceId')\n  @ApiOperation({ summary: 'Test inputting text using keyboard layout on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'text', description: 'Text string to input (e.g., \"abc123\", \"test@email.com\")', required: true })\n  @ApiResponse({ status: 200, description: 'Text input completed successfully' })\n  async testInputText(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('text') text: string,\n  ) {\n    try {\n      const service = this.getBankService(bankCode);\n      \n      if (!text || text.trim().length === 0) {\n        return {\n          success: false,\n          error: 'Text is required and cannot be empty',\n          example: `/api/bank/${bankCode}/test/input-text/{deviceId}?text=abc123`,\n        };\n      }\n\n      this.logger.log(`Testing text input \"${text}\" on device: ${deviceId}`);\n      \n      await this.hcBoxService.inputText(deviceId, text);\n      \n      return {\n        success: true,\n        message: `Text input completed successfully on device ${deviceId}`,  \n      };\n    } catch (error) {\n      this.logger.error(`Error testing text input: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/press-return/:deviceId')\n  @ApiOperation({ summary: 'Test pressing return key on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiResponse({ status: 200, description: 'Return key pressed successfully' })\n  async testPressReturn(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n  ) {\n    try {\n      const service = this.getBankService(bankCode);\n      this.logger.log(`Testing press return key on device: ${deviceId}`);\n      \n      await this.wsService.pressReturnKey(deviceId);\n      \n      return {\n        success: true,\n        message: `Return key pressed successfully on device ${deviceId}`,\n        note: 'This key can dismiss keyboard or submit/enter depending on context',\n      };\n    } catch (error) {\n      this.logger.error(`Error testing press return: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n}\n\n","import { Global, Module } from '@nestjs/common';\nimport { HCWebSocketService } from './hc-websocket.service';\nimport { PandaWebSocketService } from './panda-websocket.service';\nimport { WEBSOCKET_SERVICE } from './constants/websocket';\nimport { config } from '@/common/constants/config';\n\n@Global()\n@Module({\n  providers: [\n    {\n      provide: WEBSOCKET_SERVICE,\n      useClass: config.boxType === 'PANDA' ? PandaWebSocketService : HCWebSocketService,\n    }\n  ],\n  exports: [WEBSOCKET_SERVICE],\n})\nexport class WebSocketModule {}\n\n","import { Injectable, Logger, OnModuleInit, OnModuleDestroy } from '@nestjs/common';\nimport * as WebSocket from 'ws';\nimport { ICaptureScreenOptions, IHCSwipeOptions, IWebSocketService } from './interface/websocket.interface';\nimport { COMMON_COORDINATES, KEYBOARD_LAYOUT, NUMPAD_LAYOUT } from '@/common/constants/keyboard';\nimport { sleep } from '@/common/utils/time';\nimport { omit } from 'lodash';\n\nexport interface HcBoxRequest {\n\taction: string;\n\tcomm?: any;\n\tsessionID?: string;\n}\n\nexport interface HcBoxResponse {\n\tStatusCode: number;\n\tresult: any;\n}\n\n@Injectable()\nexport class HCWebSocketService implements IWebSocketService, OnModuleInit, OnModuleDestroy {\n\tprivate readonly logger = new Logger(HCWebSocketService.name);\n\tprivate ws: WebSocket | null = null;\n\tprivate wsUrl: string;\n\tprivate reconnectAttempts = 0;\n\tprivate maxReconnectAttempts = 10;\n\tprivate reconnectDelay = 5000;\n\t// Sequential request queue - all requests are queued and processed one at a time\n\tprivate requestQueue: Array<{ \n\t\trequest: HcBoxRequest; \n\t\tresolve: (value: any) => void; \n\t\treject: (error: any) => void;\n\t\ttimeout: number;\n\t}> = [];\n\tprivate pendingRequests = new Map<string, { resolve: (value: any) => void; reject: (error: any) => void }>();\n\tprivate isConnected = false;\n\tprivate isProcessingRequest = false; // Flag to track if currently processing a request\n\n\tconstructor() {\n\t\tthis.wsUrl = 'ws://127.0.0.1:26608';\n\t}\n\n\tasync onModuleInit() {\n\t\tawait this.connect();\n\t}\n\n\tasync onModuleDestroy() {\n\t\tawait this.disconnect();\n\t}\n\n\tprivate async connect(): Promise<void> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tthis.logger.log(`Connecting to HC BOX WebSocket: ${this.wsUrl}`);\n\t\t\t\tthis.ws = new WebSocket(this.wsUrl);\n\n\t\t\t\tthis.ws.on('open', () => {\n\t\t\t\t\tthis.logger.log('HC BOX WebSocket connected');\n\t\t\t\t\tthis.isConnected = true;\n\t\t\t\t\tthis.reconnectAttempts = 0;\n\t\t\t\t\t// Start processing queue when connected\n\t\t\t\t\tthis.processRequestQueue();\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\n\t\t\t\tthis.ws.on('message', (data: WebSocket.Data) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst response: HcBoxResponse = JSON.parse(data.toString());\n\t\t\t\t\t\tthis.handleMessage(response);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tthis.logger.error(`Error parsing WebSocket message: ${error.message}`);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.ws.on('error', (error) => {\n\t\t\t\t\tthis.logger.error(`WebSocket error: ${error.message}`);\n\t\t\t\t\tthis.isConnected = false;\n\t\t\t\t\tif (this.reconnectAttempts === 0) {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.ws.on('close', () => {\n\t\t\t\t\tthis.logger.warn('HC BOX WebSocket closed');\n\t\t\t\t\tthis.isConnected = false;\n\t\t\t\t\tthis.scheduleReconnect();\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tthis.logger.error(`Error creating WebSocket connection: ${error.message}`);\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate scheduleReconnect(): void {\n\t\tif (this.reconnectAttempts >= this.maxReconnectAttempts) {\n\t\t\tthis.logger.error('Max reconnection attempts reached');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.reconnectAttempts++;\n\t\tconst delay = this.reconnectDelay * this.reconnectAttempts;\n\t\tthis.logger.log(`Scheduling reconnect attempt ${this.reconnectAttempts} in ${delay}ms`);\n\n\t\tsetTimeout(() => {\n\t\t\tthis.connect().catch((error) => {\n\t\t\t\tthis.logger.error(`Reconnection failed: ${error.message}`);\n\t\t\t});\n\t\t}, delay);\n\t}\n\n\tprivate async disconnect(): Promise<void> {\n\t\tif (this.ws) {\n\t\t\tthis.ws.close();\n\t\t\tthis.ws = null;\n\t\t\tthis.isConnected = false;\n\t\t}\n\t}\n\n\tprivate handleMessage(response: HcBoxResponse): void {\n\t\t// Handle responses - use FIFO approach since API doesn't provide request IDs\n\t\tif (this.pendingRequests.size > 0) {\n\t\t\tconst [firstKey, firstHandler] = this.pendingRequests.entries().next().value;\n\t\t\tthis.pendingRequests.delete(firstKey);\n\t\t\tif (response.StatusCode === 200) {\n\t\t\t\tfirstHandler.resolve(response.result);\n\t\t\t} else {\n\t\t\t\tfirstHandler.reject(new Error(`HC BOX error: ${response.StatusCode}`));\n\t\t\t}\n\t\t} else {\n\t\t\tthis.logger.warn(`Received response but no pending requests: ${JSON.stringify(response)}`);\n\t\t}\n\t}\n\n\t/**\n\t * Process requests sequentially from queue\n\t * Only one request is processed at a time to avoid timeout issues\n\t */\n\tprivate async processRequestQueue(): Promise<void> {\n\t\t// If already processing a request or queue is empty, do nothing\n\t\tif (this.isProcessingRequest || this.requestQueue.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If not connected, don't process (will process when connected)\n\t\tif (!this.isConnected || !this.ws) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Mark as processing\n\t\tthis.isProcessingRequest = true;\n\n\t\t// Get first request from queue\n\t\tconst { request, resolve, reject, timeout } = this.requestQueue.shift()!;\n\n\t\ttry {\n\t\t\t// Send request and wait for response\n\t\t\tconst result = await this._sendRequestOnce(request, timeout);\n\t\t\tresolve(result);\n\t\t} catch (error) {\n\t\t\treject(error);\n\t\t} finally {\n\t\t\t// Mark as done processing\n\t\t\tthis.isProcessingRequest = false;\n\t\t\t\n\t\t\t// Process next request if any\n\t\t\tif (this.requestQueue.length > 0) {\n\t\t\t\t// Use setImmediate to avoid stack overflow and allow event loop to process\n\t\t\t\tsetImmediate(() => this.processRequestQueue());\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Send a single WebSocket request (internal use only)\n\t * This method sends the request and waits for response\n\t */\n\tprivate async _sendRequestOnce(request: HcBoxRequest, timeout = 30000): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// Generate unique request ID\n\t\t\tconst requestId = Date.now().toString() + Math.random().toString(36).substr(2, 9);\n\t\t\tthis.pendingRequests.set(requestId, { resolve, reject });\n\n\t\t\tconst timeoutId = setTimeout(() => {\n\t\t\t\tthis.pendingRequests.delete(requestId);\n\t\t\t\treject(new Error('WebSocket request timeout'));\n\t\t\t}, timeout);\n\n\t\t\tconst originalResolve = resolve;\n\t\t\tconst originalReject = reject;\n\n\t\t\tresolve = (value: any) => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\toriginalResolve(value);\n\t\t\t};\n\n\t\t\treject = (error: any) => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\toriginalReject(error);\n\t\t\t};\n\n\t\t\tthis.pendingRequests.set(requestId, { resolve, reject });\n\n\t\t\ttry {\n\t\t\t\tthis.ws!.send(JSON.stringify(request));\n\t\t\t} catch (error) {\n\t\t\t\tthis.pendingRequests.delete(requestId);\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Send WebSocket request - all requests are queued and processed sequentially\n\t * This ensures no concurrent requests that could cause timeout issues\n\t */\n\tprivate async sendRequest(request: HcBoxRequest, timeout = 30000): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// Add request to queue\n\t\t\tthis.requestQueue.push({ request, resolve, reject, timeout });\n\t\t\t\n\t\t\t// Start processing queue (will do nothing if already processing)\n\t\t\tthis.processRequestQueue();\n\t\t});\n\t}\n\n\tasync listDevices(): Promise<any[]> {\n\t\tconst response = await this.sendRequest({ action: 'list' });\n\t\treturn Array.isArray(response) ? response : [];\n\t}\n\n\tasync click(deviceIds: string | string[], x: number, y: number, duration = 0.2): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'click',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t\tduration,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync swipe(\n\t\tdeviceIds: string | string[],\n\t\toptions: IHCSwipeOptions\n\t): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'swipe',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t\t...options\n\t\t\t},\n\t\t});\n\t}\n\n\tasync captureScreen(\n\t\tdeviceId: string,\n\t\toptions: ICaptureScreenOptions\n\t) {\n\t\treturn this.sendRequest({\n\t\t\taction: 'screen',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceId,\n\t\t\t\t...omit(options, 'folderPath'),\n\t\t\t\tfilePath: options.folderPath,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync home(deviceIds: string | string[]): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'home',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync launchApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'launchApp',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t\tcontent: bundleId,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync killApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'killApp',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t\tcontent: bundleId,\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t* Check if character is a number\n\t*/\n\tprivate isNumber(char: string): boolean {\n\t\treturn /^[0-9]$/.test(char);\n\t}\n\n\t/**\n\t * Check if character is a letter\n\t */\n\tprivate isLetter(char: string): boolean {\n\t\treturn /^[a-zA-Z]$/.test(char);\n\t}\n\n\t/**\n\t * Check if character is a special character that only appears in number mode\n\t * (e.g., @, !, etc.)\n\t */\n\tprivate isSpecialCharInNumberMode(char: string): boolean {\n\t\t// List of special characters that only appear in number mode\n\t\tconst specialChars = ['@', '!'];\n\t\treturn specialChars.includes(char);\n\t}\n\n\t/**\n\t * Switch keyboard mode (between letter and number)\n\t */\n\tasync switchKeyboardMode(deviceIds: string | string[]): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.KEYBOARD_SWITCH;\n\t\tthis.logger.log(`Switching keyboard mode on device ${deviceIds} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceIds, x, y, 0.2);\n\t\t// Wait for keyboard to switch\n\t\tawait sleep(500);\n\t\tthis.logger.log(`Keyboard mode switched successfully on device ${deviceIds}`);\n\t}\n\n\t/**\n\t * Press shift key for uppercase letter\n\t * Note: After typing one uppercase letter, keyboard automatically returns to lowercase\n\t */\n\tasync pressShiftKey(deviceIds: string | string[]): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.SHIFT_KEY;\n\t\tthis.logger.debug(`Pressing shift key on device ${deviceIds} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceIds, x, y, 0.2);\n\t\t// Small delay after pressing shift\n\t\tawait sleep(200);\n\t\tthis.logger.debug(`Shift key pressed successfully on device ${deviceIds}`);\n\t}\n\n\t/**\n\t * Press return/enter key\n\t * Note: This key can be used to:\n\t * - Dismiss keyboard (exit input mode)\n\t * - Submit/enter (depending on context)\n\t */\n\tasync pressReturnKey(deviceId: string): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.RETURN_KEY;\n\t\tthis.logger.log(`Pressing return key on device ${deviceId} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceId, x, y, 0.2);\n\t\t// Wait for action to complete\n\t\tawait sleep(500);\n\t\tthis.logger.log(`Return key pressed successfully on device ${deviceId}`);\n\t}\n\n\t/**\n\t * Input text value by clicking on keyboard keys\n\t * Automatically switches between number and letter keyboard as needed\n\t */\n\tasync inputText(deviceIds: string | string[], text: string): Promise<void> {\n\t\tif (!text || text.length === 0) {\n\t\t\tthrow new Error('Password cannot be empty');\n\t\t}\n\n\t\t// Track current keyboard mode\n\t\t// Default keyboard mode is 'letter' (bn phm mc nh l ch)\n\t\tlet currentMode: 'number' | 'letter' = 'letter';\n\n\t\t// Input each character\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tconst char = text[i];\n\t\t\tconst charLower = char.toLowerCase();\n\t\t\tconst isUppercase = char !== charLower && this.isLetter(char);\n\n\t\t\t// For special characters (like @, !), use char directly (they don't have lowercase)\n\t\t\t// For other characters, use charLower to find coordinates\n\t\t\tconst keyToLookup = this.isSpecialCharInNumberMode(char) ? char : charLower;\n\t\t\tconst keyCoords = KEYBOARD_LAYOUT[keyToLookup];\n\n\t\t\tif (!keyCoords) {\n\t\t\t\tthis.logger.warn(`Character '${char}' not found in keyboard layout. Skipping...`);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Determine required keyboard mode for this character\n\t\t\t// Special characters (like @, !) only appear in number mode\n\t\t\tlet requiredMode: 'number' | 'letter' | null = null;\n\t\t\tif (this.isNumber(charLower)) {\n\t\t\t\trequiredMode = 'number';\n\t\t\t} else if (this.isLetter(charLower)) {\n\t\t\t\trequiredMode = 'letter';\n\t\t\t} else if (this.isSpecialCharInNumberMode(char)) {\n\t\t\t\t// Special characters only appear in number mode\n\t\t\t\trequiredMode = 'number';\n\t\t\t}\n\n\t\t\t// Switch keyboard mode if needed (letter <-> number)\n\t\t\tif (requiredMode && currentMode !== requiredMode) {\n\t\t\t\tthis.logger.debug(`Switching keyboard to ${requiredMode} mode for character '${char}'`);\n\t\t\t\tawait this.switchKeyboardMode(deviceIds);\n\t\t\t\tcurrentMode = requiredMode;\n\t\t\t}\n\n\t\t\t// If uppercase letter, press shift key first\n\t\t\t// Note: After typing one uppercase letter, keyboard automatically returns to lowercase\n\t\t\tif (isUppercase && currentMode === 'letter') {\n\t\t\t\tthis.logger.debug(`Pressing shift key for uppercase letter '${char}'`);\n\t\t\t\tawait this.pressShiftKey(deviceIds);\n\t\t\t}\n\n\t\t\t// Click the key\n\t\t\t// For special characters, use char directly; for others, use charLower coordinates\n\t\t\tthis.logger.debug(`Clicking key '${keyToLookup}'${isUppercase ? ' (uppercase)' : ''} at (${keyCoords.x}, ${keyCoords.y})`);\n\t\t\tawait this.click(deviceIds, keyCoords.x, keyCoords.y, 0.15);\n\t\t\t// Small delay between key presses\n\t\t\tawait sleep(200);\n\t\t}\n\n\t\tthis.logger.log(`Text input completed on device ${deviceIds}`);\n\t}\n\n\t/**\n\t * Input number using numpad layout\n\t * @param deviceId - Device ID\n\t * @param value - Number string to input (e.g., \"123\", \"456789\")\n\t */\n\tasync inputNumpadNumber(deviceIds: string | string[], value: string) {\n\t\tif (!value || value.length === 0) {\n\t\t\tthrow new Error('value cannot be empty');\n\t\t}\n\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst digit = value[i];\n\n\t\t\tconst coordinates = NUMPAD_LAYOUT[digit];\n\n\t\t\tawait this.click(deviceIds, coordinates.x, coordinates.y, 0.15);\n\t\t\tthis.logger.debug(`Clicking key '${digit}' at (${coordinates.x}, ${coordinates.y})`);\n\t\t\tawait sleep(200);\n\t\t}\n\t}\n}\n\n\n","module.exports = require(\"ws\");","import { Injectable, Logger, OnModuleInit, OnModuleDestroy } from '@nestjs/common';\nimport * as WebSocket from 'ws';\nimport { ICaptureScreenOptions, IPandaSwipeOptions, IWebSocketService } from './interface/websocket.interface';\nimport { toString } from 'lodash';\nimport { sleep } from '@/common/utils/time';\nimport { COMMON_COORDINATES, NUMPAD_LAYOUT } from '@/common/constants/keyboard';\n\nexport interface PandaRequest<T> {\n  action: string;\n  /**\n   * \"all\" or \"xxx,xxx,xxx\" multiple devices separated by comma\n  */\n  devices?: string | string[];\n  data?: T;\n}\n\nexport interface PandaResponse<T> {\n  code: number;\n  message: string;\n  data: T;\n}\n\n@Injectable()\nexport class PandaWebSocketService implements IWebSocketService, OnModuleInit, OnModuleDestroy {\n  private readonly logger = new Logger(PandaWebSocketService.name);\n  private ws: WebSocket | null = null;\n  private wsUrl: string;\n  private reconnectAttempts = 0;\n  private maxReconnectAttempts = 10;\n  private reconnectDelay = 5000;\n  // Sequential request queue - all requests are queued and processed one at a time\n  private requestQueue: Array<{ \n    request: PandaRequest<any>; \n    resolve: (value: any) => void; \n    reject: (error: any) => void;\n    timeout: number;\n  }> = [];\n  private pendingRequests = new Map<string, { resolve: (value: any) => void; reject: (error: any) => void }>();\n  private isConnected = false;\n  private isProcessingRequest = false; // Flag to track if currently processing a request\n\n  constructor() {\n    this.wsUrl = 'ws://127.0.0.1:33333';\n  }\n\n  async onModuleInit() {\n    await this.connect();\n  }\n\n  async onModuleDestroy() {\n    await this.disconnect();\n  }\n\n  private async connect(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      try {\n        this.logger.log(`Connecting to Panda BOX WebSocket: ${this.wsUrl}`);\n        this.ws = new WebSocket(this.wsUrl);\n\n        this.ws.on('open', () => {\n          this.logger.log('Panda BOX WebSocket connected');\n          this.isConnected = true;\n          this.reconnectAttempts = 0;\n          // Start processing queue when connected\n          this.processRequestQueue();\n          resolve();\n        });\n\n        this.ws.on('message', (data: WebSocket.Data) => {\n          try {\n            const messageStr = data.toString();\n            const response: PandaResponse<any> = JSON.parse(messageStr);\n            this.handleMessage(response);\n          } catch (error) {\n            this.logger.error(`Error parsing WebSocket message: ${error.message}`, error.stack);\n            this.logger.error(`Raw message was: ${data.toString()}`);\n          }\n        });\n\n        this.ws.on('error', (error) => {\n          this.logger.error(`WebSocket error: ${error.message}`);\n          this.isConnected = false;\n          if (this.reconnectAttempts === 0) {\n            reject(error);\n          }\n        });\n\n        this.ws.on('close', () => {\n          this.logger.warn('Panda BOX WebSocket closed');\n          this.isConnected = false;\n          this.scheduleReconnect();\n        });\n      } catch (error) {\n        this.logger.error(`Error creating WebSocket connection: ${error.message}`);\n        reject(error);\n      }\n    });\n  }\n\n  private scheduleReconnect(): void {\n    if (this.reconnectAttempts >= this.maxReconnectAttempts) {\n      this.logger.error('Max reconnection attempts reached');\n      return;\n    }\n\n    this.reconnectAttempts++;\n    const delay = this.reconnectDelay * this.reconnectAttempts;\n    this.logger.log(`Scheduling reconnect attempt ${this.reconnectAttempts} in ${delay}ms`);\n\n    setTimeout(() => {\n      this.connect().catch((error) => {\n        this.logger.error(`Reconnection failed: ${error.message}`);\n      });\n    }, delay);\n  }\n\n  private async disconnect(): Promise<void> {\n    if (this.ws) {\n      this.ws.close();\n      this.ws = null;\n      this.isConnected = false;\n    }\n  }\n\n  private handleMessage<T>(response: PandaResponse<T>): void {\n    // this.logger.debug(`Received WebSocket message: ${JSON.stringify(response)}`);\n\n    // Handle responses - use FIFO approach since API doesn't provide request IDs\n    if (this.pendingRequests.size > 0) {\n      const [firstKey, firstHandler] = this.pendingRequests.entries().next().value;\n      this.pendingRequests.delete(firstKey);\n\n      // Check response code: 10000 = SUCCESS, others = error\n      if (response.code === 10000) {\n        firstHandler.resolve(response.data);\n      } else {\n        const errorMessage = response.message || `Panda BOX error: ${response.code}`;\n        firstHandler.reject(new Error(errorMessage));\n      }\n    } else {\n      // Check if this looks like a device list response (unsolicited update)\n      const isDeviceListResponse = Array.isArray(response.data) && \n        (response.data as any[]).length > 0 && \n        (response.data as any[])[0]?.serial !== undefined;\n      \n      if (isDeviceListResponse && response.code === 10000) {\n        // Likely an unsolicited device list update - log as debug instead of warning\n        const deviceList = response.data as any[];\n        this.logger.debug(`Received unsolicited device list update (no pending requests): ${deviceList.length} device(s)`);\n      } else {\n        // Other unsolicited responses or late responses - log as warning\n        this.logger.warn(`Received response but no pending requests: ${JSON.stringify(response)}`);\n      }\n    }\n  }\n\n  /**\n   * Process requests sequentially from queue\n   * Only one request is processed at a time to avoid timeout issues\n   */\n  private async processRequestQueue(): Promise<void> {\n    // If already processing a request or queue is empty, do nothing\n    if (this.isProcessingRequest || this.requestQueue.length === 0) {\n      return;\n    }\n\n    // If not connected, don't process (will process when connected)\n    if (!this.isConnected || !this.ws) {\n      return;\n    }\n\n    // Mark as processing\n    this.isProcessingRequest = true;\n\n    // Get first request from queue\n    const { request, resolve, reject, timeout } = this.requestQueue.shift()!;\n\n    try {\n      // Send request and wait for response\n      const result = await this._sendRequestOnce(request, timeout);\n      resolve(result);\n    } catch (error) {\n      reject(error);\n    } finally {\n      // Mark as done processing\n      this.isProcessingRequest = false;\n      \n      // Process next request if any\n      if (this.requestQueue.length > 0) {\n        // Use setImmediate to avoid stack overflow and allow event loop to process\n        setImmediate(() => this.processRequestQueue());\n      }\n    }\n  }\n\n  /**\n   * Send a single WebSocket request (internal use only)\n   * This method sends the request and waits for response\n   */\n  private async _sendRequestOnce<T>(request: PandaRequest<T>, timeout = 30000): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // Generate unique request ID\n      const requestId = Date.now().toString() + Math.random().toString(36).substr(2, 9);\n      this.pendingRequests.set(requestId, { resolve, reject });\n\n      const timeoutId = setTimeout(() => {\n        this.pendingRequests.delete(requestId);\n        reject(new Error('WebSocket request timeout'));\n      }, timeout);\n\n      const originalResolve = resolve;\n      const originalReject = reject;\n\n      resolve = (value: any) => {\n        clearTimeout(timeoutId);\n        originalResolve(value);\n      };\n\n      reject = (error: any) => {\n        clearTimeout(timeoutId);\n        originalReject(error);\n      };\n\n      this.pendingRequests.set(requestId, { resolve, reject });\n\n      try {\n        const requestStr = JSON.stringify(request);\n        // this.logger.debug(`Sending WebSocket request: ${requestStr}`);\n        this.ws!.send(requestStr);\n      } catch (error) {\n        this.logger.error(`Error sending WebSocket request: ${error.message}`, error.stack);\n        this.pendingRequests.delete(requestId);\n        clearTimeout(timeoutId);\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Send WebSocket request - all requests are queued and processed sequentially\n   * This ensures no concurrent requests that could cause timeout issues\n   */\n  private async sendRequest<T>(request: PandaRequest<T>, timeout = 30000): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // Add request to queue\n      this.requestQueue.push({ request, resolve, reject, timeout });\n      \n      // Start processing queue (will do nothing if already processing)\n      this.processRequestQueue();\n    });\n  }\n\n  async listDevices(): Promise<any[]> {\n    const response = await this.sendRequest({ action: 'list' });\n    const devices = response.map((device: any) => ({\n      ...device,\n      udid: device.serial,\n    }));\n    // TODO: Ping to telegram group\n    // this.logger.log(`Device list response received: ${JSON.stringify(response)}`);\n    if (devices.length <= 0) {\n      this.logger.error('No devices found!');\n      // TODO: Ping to telegram group\n    }\n    return devices;\n  }\n\n  async click(deviceIds: string | string[], x: number, y: number, duration = 0.2): Promise<string> {\n    return this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds,\n      \"data\": {\n        \"type\": \"10\", // 10: click\n        \"x\": toString(x),\n        \"y\": toString(y),\n      }\n    });\n  }\n\n  async swipe(\n    deviceIds: string | string[],\n    options: IPandaSwipeOptions\n  ): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": deviceIdsStr,\n      \"data\": options\n    });\n  }\n\n  async captureScreen(\n    deviceId: string,\n    options: ICaptureScreenOptions\n  ) {\n    return this.sendRequest({\n      \"action\": \"screenFile\",\n      \"devices\": deviceId,\n      \"data\": {\n        savePath: options.folderPath\n      }\n    });\n  }\n\n  async home(deviceIds: string | string[]): Promise<string> {\n    return this.sendRequest({\n      \"action\": \"pushEvent\",\n      \"devices\": deviceIds,\n      \"data\": {\n        \"type\": \"2\"\n      }\n    });\n  }\n\n  async launchApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest(\n      {\n        \"action\": \"startApp\",\n        \"devices\": deviceIdsStr,\n        \"data\": {\n          \"app\": bundleId\n        }\n      }\n    )\n  }\n\n  async killApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"stopApp\",\n      \"devices\": deviceIdsStr,\n      \"data\": {\n        \"app\": bundleId\n      }\n    });\n  }\n\n  /**\n\t * Switch keyboard mode (between letter and number)\n\t */\n\tasync switchKeyboardMode(deviceIds: string | string[]): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.KEYBOARD_SWITCH;\n\t\tthis.logger.log(`Switching keyboard mode on device ${deviceIds} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceIds, x * 100, y * 100, 0.2);\n\t\t// Wait for keyboard to switch\n\t\tawait sleep(500);\n\t\tthis.logger.log(`Keyboard mode switched successfully on device ${deviceIds}`);\n\t}\n\n\t/**\n\t * Press shift key for uppercase letter\n\t * Note: After typing one uppercase letter, keyboard automatically returns to lowercase\n\t */\n\tasync pressShiftKey(deviceIds: string | string[]): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.SHIFT_KEY;\n\t\tthis.logger.debug(`Pressing shift key on device ${deviceIds} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceIds, x * 100, y * 100, 0.2);\n\t\t// Small delay after pressing shift\n\t\tawait sleep(200);\n\t\tthis.logger.debug(`Shift key pressed successfully on device ${deviceIds}`);\n\t}\n\n  /**\n   * Press return/enter key\n   * Note: This key can be used to:\n   * - Dismiss keyboard (exit input mode)\n   * - Submit/enter (depending on context)\n   */\n  async pressReturnKey(deviceId: string): Promise<void> {\n    const { x, y } = COMMON_COORDINATES.RETURN_KEY;\n    this.logger.log(`Pressing return key on device ${deviceId} at coordinates (${x}, ${y})`);\n    await this.click(deviceId, x * 100, y * 100, 0.2);\n    // Wait for action to complete\n    await sleep(500);\n    this.logger.log(`Return key pressed successfully on device ${deviceId}`);\n  }\n\n  async inputText(deviceIds: string | string[], text: string): Promise<void> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"inputText\",\n      \"devices\": deviceIdsStr,\n      \"data\": {\n        \"content\": text\n      }\n    });\n  }\n\n  async inputNumpadNumber(deviceIds: string | string[], value: string) {\n\t\tif (!value || value.length === 0) {\n\t\t\tthrow new Error('value cannot be empty');\n\t\t}\n\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst digit = value[i];\n\n\t\t\tconst coordinates = NUMPAD_LAYOUT[digit];\n\n\t\t\tawait this.click(deviceIds, coordinates.x, coordinates.y);\n\t\t\tthis.logger.debug(`Clicking key '${digit}' at (${coordinates.x}, ${coordinates.y})`);\n\t\t\tawait sleep(200);\n\t\t}\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { Cron, CronExpression } from '@nestjs/schedule';\nimport { BankService } from './bank.service';\nimport { DeviceService } from '../device/device.service';\nimport { SessionManagementService } from './session-management.service';\n\n@Injectable()\nexport class SessionRefreshScheduler {\n  private readonly logger = new Logger(SessionRefreshScheduler.name);\n\n  constructor(\n    private readonly bankService: BankService,\n    private readonly deviceService: DeviceService,\n    private readonly sessionManagement: SessionManagementService,\n  ) {}\n\n  /**\n   * Check and refresh sessions every 30 seconds\n   */\n  @Cron(CronExpression.EVERY_30_SECONDS)\n  async refreshSessions() {\n    try {\n      const serviceStatus = await this.deviceService.getServiceStatus();\n      if (serviceStatus !== 'active') {\n        return; // Skip if service is not active\n      }\n\n      const devices = await this.deviceService.listDevices();\n      const activeDevices = devices.filter(device => device.status === 'active' && device.bankCode);\n\n      for (const device of activeDevices) {\n        const bankCode = device.bankCode.toUpperCase();\n        \n        try {\n          await this.bankService.refreshSessionIfNeeded(device.udid, bankCode);\n        } catch (error) {\n          this.logger.error(\n            `Error refreshing session for device ${device.udid}, bank ${bankCode}: ${error.message}`\n          );\n        }\n      }\n    } catch (error) {\n      this.logger.error(`Error in session refresh scheduler: ${error.message}`);\n    }\n  }\n}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { NestFactory } from '@nestjs/core';\nimport { ValidationPipe, Logger } from '@nestjs/common';\nimport { NestExpressApplication } from '@nestjs/platform-express';\nimport { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nimport { join } from 'path';\nimport { AppModule } from './app.module';\nimport { config as configEnv } from '@/common/constants/config';\n\nasync function bootstrap() {\n  const app = await NestFactory.create<NestExpressApplication>(AppModule);\n  const logger = new Logger('Bootstrap');\n\n  // Configure view engine (EJS)\n  // In development: src/views, in production: dist/views (after copying)\n  const viewsPath = process.env.NODE_ENV === 'production' \n    ? join(__dirname, 'views')\n    : join(process.cwd(), 'src', 'views');\n  app.setBaseViewsDir(viewsPath);\n  app.setViewEngine('ejs');\n  logger.log(`Views directory: ${viewsPath}`);\n\n  // Global validation pipe\n  app.useGlobalPipes(\n    new ValidationPipe({\n      transform: true,\n      whitelist: true,\n      forbidNonWhitelisted: true,\n    }),\n  );\n\n  // Swagger configuration\n  const config = new DocumentBuilder()\n    .setTitle('EzPay Auto API')\n    .setDescription('Automated withdrawal processing service with HC BOX integration')\n    .setVersion('1.0')\n    .addTag('bank', 'Bank operations')\n    .addTag('withdrawal', 'Withdrawal processing')\n    .addTag('device', 'Device management')\n    .addTag('hcbox', 'HC Box integration')\n    .build();\n  \n  const document = SwaggerModule.createDocument(app, config);\n  SwaggerModule.setup('docs', app, document);\n\n  const port = process.env.PORT || 3002;\n  logger.log(` Swagger documentation available at: http://localhost:${port}/docs`);\n  await app.listen(port);\n\n  logger.log(` EzPay Auto is running on: http://localhost:${port}`);\n  logger.log(` Withdrawal processing started by ${configEnv.boxType} box`);\n  logger.log(` Device management: http://localhost:${port}`);\n}\n\nbootstrap();\n\n"],"sourceRoot":"","file":"main.js"}