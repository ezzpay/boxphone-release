{"version":3,"sources":["webpack://ezpay-auto/external commonjs \"@nestjs/core\"","webpack://ezpay-auto/external commonjs \"@nestjs/common\"","webpack://ezpay-auto/external commonjs \"@nestjs/swagger\"","webpack://ezpay-auto/external node-commonjs \"path\"","webpack://ezpay-auto/./src/app.module.ts","webpack://ezpay-auto/external commonjs \"@nestjs/bull\"","webpack://ezpay-auto/external commonjs \"@nestjs/schedule\"","webpack://ezpay-auto/external commonjs \"@nestjs/axios\"","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.module.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.service.ts","webpack://ezpay-auto/./src/modules/bank/bank.service.ts","webpack://ezpay-auto/./src/modules/bank/acb.service.ts","webpack://ezpay-auto/./src/common/utils/time.ts","webpack://ezpay-auto/external node-commonjs \"fs\"","webpack://ezpay-auto/external node-commonjs \"fs/promises\"","webpack://ezpay-auto/./src/common/modules/websocket/constants/websocket.ts","webpack://ezpay-auto/./src/modules/device/device.service.ts","webpack://ezpay-auto/./src/common/services/redis.service.ts","webpack://ezpay-auto/external commonjs \"ioredis\"","webpack://ezpay-auto/./src/common/constants/config.ts","webpack://ezpay-auto/external commonjs \"dotenv\"","webpack://ezpay-auto/./src/modules/device/dto/device-config.dto.ts","webpack://ezpay-auto/external commonjs \"class-validator\"","webpack://ezpay-auto/./src/common/modules/websocket/constants/device.ts","webpack://ezpay-auto/./src/modules/device/device-lock.service.ts","webpack://ezpay-auto/external node-commonjs \"crypto\"","webpack://ezpay-auto/external commonjs \"lodash\"","webpack://ezpay-auto/./src/common/modules/websocket/panda-manager.service.ts","webpack://ezpay-auto/./src/common/modules/websocket/panda-android.service.ts","webpack://ezpay-auto/external commonjs \"ws\"","webpack://ezpay-auto/./src/common/constants/keyboard.ts","webpack://ezpay-auto/./src/modules/notifiction/telegram.service.ts","webpack://ezpay-auto/external commonjs \"axios\"","webpack://ezpay-auto/external commonjs \"form-data\"","webpack://ezpay-auto/./src/common/constants/message-title.ts","webpack://ezpay-auto/./src/common/modules/websocket/panda-ios.service.ts","webpack://ezpay-auto/./src/modules/ocr/services/image-preprocessing.service.ts","webpack://ezpay-auto/external commonjs \"sharp\"","webpack://ezpay-auto/./src/modules/ocr/services/ocr.service.ts","webpack://ezpay-auto/./src/modules/ocr/services/ocr-worker-pool.service.ts","webpack://ezpay-auto/external commonjs \"tesseract.js\"","webpack://ezpay-auto/./src/common/utils/string.ts","webpack://ezpay-auto/./src/modules/ocr/services/color-detection.service.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal-errors.ts","webpack://ezpay-auto/./src/modules/bank/base/base-bank.service.ts","webpack://ezpay-auto/external commonjs \"qrcode\"","webpack://ezpay-auto/./src/modules/bank/constants/analyze-bill.ts","webpack://ezpay-auto/./src/modules/bank/constants/acb-roi.ts","webpack://ezpay-auto/./src/modules/bank/constants/hd-roi.ts","webpack://ezpay-auto/./src/modules/bank/constants/pg-roi.ts","webpack://ezpay-auto/./src/modules/bank/constants/vcb-roi.ts","webpack://ezpay-auto/./src/modules/bank/constants/acbank.ts","webpack://ezpay-auto/./src/modules/bank/pg.service.ts","webpack://ezpay-auto/./src/modules/bank/constants/pgbank.ts","webpack://ezpay-auto/./src/modules/bank/constants/bank-code.ts","webpack://ezpay-auto/./src/modules/bank/hdbank.service.ts","webpack://ezpay-auto/./src/modules/bank/constants/hdbank.ts","webpack://ezpay-auto/./src/modules/bank/constants/pandaSwipType.ts","webpack://ezpay-auto/./src/modules/bank/vietcombank.service.ts","webpack://ezpay-auto/./src/modules/bank/session-management.service.ts","webpack://ezpay-auto/./src/modules/notifiction/notification.service.ts","webpack://ezpay-auto/./src/modules/notifiction/ezpay-be-client.service.ts","webpack://ezpay-auto/external commonjs \"rxjs\"","webpack://ezpay-auto/./src/common/utils/currency.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal-job-manager.service.ts","webpack://ezpay-auto/external commonjs \"bull\"","webpack://ezpay-auto/./src/common/interfaces/withdrawal.interface.ts","webpack://ezpay-auto/./src/common/redis/cron-lock.ts","webpack://ezpay-auto/./src/modules/window-app/window-app.service.ts","webpack://ezpay-auto/external node-commonjs \"child_process\"","webpack://ezpay-auto/external commonjs \"util\"","webpack://ezpay-auto/./src/modules/redis-lock/redis-lock.service.ts","webpack://ezpay-auto/./src/modules/withdrawal/constants/lock.ts","webpack://ezpay-auto/./src/common/utils/object-validation.ts","webpack://ezpay-auto/external commonjs \"class-transformer\"","webpack://ezpay-auto/./src/modules/withdrawal/constants/job.ts","webpack://ezpay-auto/./src/modules/withdrawal/constants/withdrawal-status.ts","webpack://ezpay-auto/./src/modules/withdrawal/constants/queue.ts","webpack://ezpay-auto/./src/modules/withdrawal/utils/jobs.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.controller.ts","webpack://ezpay-auto/./src/modules/device/device.module.ts","webpack://ezpay-auto/./src/modules/device/device.controller.ts","webpack://ezpay-auto/./src/modules/bank/bank.module.ts","webpack://ezpay-auto/./src/modules/bank/bank.controller.ts","webpack://ezpay-auto/./src/common/modules/websocket/websocket.module.ts","webpack://ezpay-auto/./src/modules/bank/session-refresh.scheduler.ts","webpack://ezpay-auto/./src/modules/ocr/ocr.module.ts","webpack://ezpay-auto/./src/modules/notifiction/notification.module.ts","webpack://ezpay-auto/./src/modules/window-app/window-app.module.ts","webpack://ezpay-auto/./src/modules/withdrawal/internal-transfer.service.ts","webpack://ezpay-auto/./src/modules/withdrawal/internal-job-manager.service.ts","webpack://ezpay-auto/./src/modules/redis-lock/redis-lock.module.ts","webpack://ezpay-auto/webpack/bootstrap","webpack://ezpay-auto/./src/main.ts"],"names":["module","require","AppModule","imports","redis","host","port","db","password","defaultJobOptions","removeOnComplete","removeOnFail","attempts","backoff","type","delay","providers","exports","WithdrawalModule","name","ScheduleModule","controllers","WithdrawalService","bankService","redisService","notificationService","httpService","deviceService","withdrawalId","key","this","status","error","message","withdrawal","deviceConfig","bankCode","amount","reason","analysisResult","analyzedStatus","deviceId","id","url","headers","timeout","Inject","BankService","acbService","pgService","hdBankService","vietcombankService","sessionManagement","deviceLock","telegramService","Map","service","Array","force","lock","Error","operationId","Date","deviceType","maxRetries","delayTime","devices","i","deviceConfigs","activeDevices","device","activeDeviceConfigs","config","disconnectedDevices","messageBlocks","text","options","parseMode","loginPromises","Promise","session","needsRefresh","isValidSession","folderPath","pollInterval","startTime","attemptCount","files","validFiles","async","file","fullPath","s","mtime","size","statError","f","a","b","latestFile","elapsed","AcbService","BaseBankService","ocrService","imagePreprocessingService","colorDetectionService","super","wsService","roi","rChangeThreshold","tempDir","initialR","recursive","tempScreenshotPath","beforeCaptureTime","now","maxFileWaitAttempts","fileWaitAttempt","pngFiles","latestMtime","filePath","fileStat","color","currentR","Math","BUNDLE_ID","expectedTexts","preprocess","grayscale","enhanceContrast","x","y","availableAmount","ACCOUNT_BALANCE_NUMBER","accountName","albumScreenHint","ALBUM_VI","verifiedAccountName","screenHint","affterFaceIdScreenHint","withdrawalCode","console","ms","resolve","setTimeout","Symbol","DeviceService","deviceLockService","pandaManagerService","pattern","keys","data","JSON","smartOTP","accountNo","transferLimitPerDay","doesHandleLargeAmount","minTransferAmount","transferType","dto","existing","hasExistingConfig","stringify","REDIS_DEVICE_CONFIG_SUFFIX","android","ios","success","err","newAmount","availableDevices","udid","RedisService","enableReadyCheck","maxRetriesPerRequest","lazyConnect","redisClient","onModuleDestroy","value","ttl","client","ttlSeconds","score","member","start","stop","min","max","limit","members","field","cursor","result","push","numberOfJobs","jobs","jobId","path","process","NODE_ENV","boxType","parseInt","ezpayBe","apiUrl","apiKey","ocr","poolSize","lang","rois","singleLine","crop","parseFloat","width","height","psm","charWhitelist","maxWidth","block","OCR_WHITELIST_BLOCK","full","spaceocr","datacenterPrimary","datacenterSecond","keyFree","UpdateDeviceConfigDto","DeviceBankCode","TransferType","o","IsString","IsNumber","IsOptional","PandaDeviceType","DeviceLockService","lockType","lockedBy","metadataKey","lockId","lockMetadata","lockedAt","metadataStr","excludeType","additionalTtl","currentTtlSeconds","newTtlSeconds","ceil","PandaManagerService","pandaAndroidService","pandaIosService","androidDevices","iosDevices","PandaAndroidService","isConnected","isProcessingRequest","reject","WebSocket","messageStr","response","firstKey","firstHandler","errorMessage","deviceList","request","setImmediate","requestId","timeoutId","originalResolve","originalReject","clearTimeout","requestStr","action","deviceIds","duration","deviceIdsStr","savePath","bundleId","command","apk","RETURN_KEY","digit","coordinates","fileType","phoneFolder","fileName","pop","coordinatesObj","factor","Object","HC_NUMPAD_LAYOUT","HC_COMMON_COORDINATES","KEYBOARD_SWITCH","SHIFT_KEY","PANDA_COMMON_COORDINATES","PANDA_NUMPAD_LAYOUT","TelegramService","baseURL","params","chatId","parsedChatId","chat_id","parse_mode","disable_web_page_preview","disableWebPagePreview","disable_notification","disableNotification","reply_to_message_id","replyToMessageId","photoUrl","photo","caption","stream","form","FormData","String","buffer","filename","mimeType","contentType","base64","cleaned","Buffer","input","idx","payload","retry","res","desc","waitMs","maxBodyLength","Infinity","maxContentLength","code","retryLeft","msg","Boolean","PandaIosService","ImagePreprocessingService","imageBuffer","image","sharp","metadata","originalWidth","originalHeight","cropX","cropY","cropWidth","cropHeight","finalCropX","finalCropY","finalCropWidth","finalCropHeight","processedImage","left","top","processedWidth","processedHeight","scaleFactor","kernel","withoutEnlargement","DEFAULT_ROI_CONFIG","OCRService","workerPoolService","fieldType","imagePath","totalStartTime","timingBreakdown","decodeImage","ocrRecognize","postprocess","decodeStart","roiConfig","preprocessStart","preprocessResult","ocrStart","ocrResult","postprocessStart","processedText","totalProcessingTime","confidence","processingTime","searchTexts","customROI","found","matchedTexts","normalizedText","searchText","includes","imageSource","totalTime","breakdown","OCRWorkerPoolService","isInitializing","isDestroyed","isAcquiring","onModuleInit","initPromises","length","_","index","warmupTime","stack","worker","Tesseract","logger","m","inUse","lastUsed","initializationPromise","workerInfo","p","pending","isTemporary","hadCustomParams","tessedit_pageseg_mode","tessedit_char_whitelist","total","w","waiting","terminatePromises","DEFAULT_BLUE_THRESHOLD","maxR","minG","minB","blueDominates","ColorDetectionService","info","resolveWithObject","channels","r","g","count","threshold","t","ErrorType","WithdrawalProcessingError","errorType","context","dir","cleanupError","maxAttempts","folderCreated","folderCreationInProgress","BANK_CODE","transitionTime","log","unexpectedTexts","roiInfo","readdirError","allSearchTexts","hasExpectedTexts","hasUnexpectedTexts","ocrTime","roiStr","screenHints","screenHintProcessed","hint","defaultRoi","screenHintFound","effectiveRoi","screenConfig","swipeOptions","attempt","ocrText","debugError","folder","ROI","billImage","rawPath","margin","firstPngFile","balanceText","balance","isNaN","PGBANK","HDBANK","ACB","VIETCOMBANK","LAUNCH_APP","VERIFY_ACCOUNT_NAME","TRANSACTION_CONFIRM","TRANSACTION_VERIFY","TRANSACTION_ENTER_OTP","TRANSACTION_SUCCESS","HOME_SCREEN","ALBUM_SCREEN","QR_CODE_SCREEN","FACE_CAPTURE_BUTTON","TRANSACTION_OTP_SAFEKEY","FACE_ID_POPPUP_ERROR","VERIFY_ACCOUNT_NUMBER","VERIFY_ACCOUNT_NAME_INTERNAL","OTP_ENTER","BILL_AREA","SWIPE_UP_SCREEN","INTERNAL_SWIPE_UP_SCREEN","WARNING_TRANSACTION","OTP_ENTER_OR_CONTINUE_TRANSFER","CONFIRM_AFTER_OTP","BOTTOM_BILL","WRONG_OTP_SCREEN","ACCOUNT_BALANCE_SCREEN","OTP_VERIFY","LOGIN_BUTTON","PASSWORD_FIELD","LOGIN_BUTTON_API","BALANCE_HIN_BUTTON","QR_CODE_BTN","IMAGE_LIBRARY_BTN","FIRST_IMAGE_BTN","ALBUM_BTN","IMGAE_CAMERA","CONTINUE_TRANSFER_BTN","CLOSE_TRANSACTION_BTN","BACK_TO_HOME_BTN","CLOSE_LOCATION_POPUP","FACE_ID_BTN","FACE_ID_POPPUP_CLOSE_BTN","FACE_ID","FACE_ID_ENG","FACE_ID_POPPUP_ERROR_ENG","ALBUM_ENG","PgService","amountText","HC_PG_UI_COORDINATES","LOGIN_BTN","TRANSFER_BTN","TRANSFER_INTERNAL_BTN","TRANSFER_EXTERNAL_BTN","CLOSE_ALLOW_CONTACT_POPUP_BTN","ACCOUNT_NUMBER_INPUT","SELECT_BANK_BTN","SEARCH_BANK_BTN","INTERNAL_AMOUNT_INPUT","HIDE_NUMPAD_BTN","BANK_SEARCH_BTN","BANK_SEARCH_INPUT","EXTERNAL_AMOUNT_INPUT","BACK_TO_HOME","SELECT_IMAGE_QR_CODE_BTN","HOME_ICON_HEADER","ACCOUNT","HIDE_LOGIN_KEYBOARD","PANDA_PG_UI_COORDINATES","BankCodeWithdrawal","HdBankService","TRANSACTION_VERIFY_NO_INPUT_OTP","SCROLL_DOWN","HDBank","HC_HD_UI_COORDINATES","HOME_ICON","CLOSE_WARNING_TRANSACTION_POPUP","INTERNAL_TRANSFER","TURN_OFF_WRONG_OTP_POPUP","PANDA_HD_UI_COORDINATES","ENTER_OTP","PandaSwipeTypeEnum","VietcombankService","SessionManagementService","sessionTimeoutMs","refreshBeforeMs","expiresAt","loginTime","toUpperCase","refreshBeforeTime","NotificationService","ezpayBeClient","sourceAccountNo","sourceBankCode","sourceAccountName","receiptPath","internalTransfer","EzpayBeClientService","axiosError","formdata","_id","Intl","WithdrawalJobManagerService","withdrawalService","windowsAppGitBashService","redisLockService","withdrawalQueue","withdrawalQueueLargeAmount","Set","isInitialized","isRestartingBoxphone","cronRestartBoxphoneEnabled","defaultMinTransferAmount","msToNextMinute","MESSAGE_TITLE","timeZone","processName","exePath","runAsAdmin","killAsAdmin","bank","currentBank","availableDevicesForSmallAmount","capacity","waitingJobsWithScore","job","deviceName","jobValidated","beneficiaryName","largeAmountDevices","assignedJobs","sortedDevices","sortedJobs","clonedJob","withdrawalValidated","withdrawalDetails","errorContext","billImagePath","currentRetries","NO_BILL_AFTER_OTP","UNKNOWN","manualRetryCount","lastErrorType","lastErrorReason","priority","description","delayedJobs","largeAmountDelayedJobs","promoted","delayMs","e","delayed","active","completed","failed","serviceStatus","processingJobs","queue","stats","getQueueStats","waitingJobs","sampleWaitingJobs","opts","sampleDelayedJobs","restartBoxphone","pickAndProcessJobs","promoteDelayedJobsPeriodically","lastRun","Number","Withdrawal","InternalTransfer","ttlMs","fn","lockVal","lua","execAsync","WindowsAppGitBashService","startTarget","gracefulWaitMs","forceKillWaitMs","startDelayMs","base","errorMsg","psCommand","windowsHide","useAdmin","retryError","retryMsg","taskkillError","taskkillMsg","processBaseName","killCommand","stdout","output","timeoutMs","args","target","RedisLockService","DtoClass","instance","enableImplicitConversion","errors","whitelist","forbidNonWhitelisted","forbidUnknownValues","validationError","ok","WithdrawalStatus","WITHDRAWAL_REQUEST","WITHDRAWAL_REQUEST_LARGE_AMOUNT","direction","WithdrawalController","jobManagerService","summary","DeviceModule","DeviceController","pandaConnectionStatus","banks","existingConfig","Get","BankModule","BankController","quality","qualityValue","captureName","base64Image","imageLength","xCoord","yCoord","example","endX","endY","isPandaFormat","isHCFormat","pandaOptions","endXCoord","endYCoord","durationValue","end","number","digits","d","note","imaggePath","outputPath","required","WebSocketModule","Global","provide","useClass","SessionRefreshScheduler","OCRModule","NotificationModule","WindowAppModule","InternalTransferService","internalTransferId","InternalTransferJobManagerService","internalTransferService","internalTransferQueue","availableBankInDevices","internalTransferDetails","RedisLockModule","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","app","viewsPath","__dirname","transform","document"],"mappings":"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","sourcesContent":["module.exports = require(\"@nestjs/core\");","module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/swagger\");","module.exports = require(\"path\");","import { Module } from '@nestjs/common';\nimport { BullModule } from '@nestjs/bull';\nimport { ScheduleModule } from '@nestjs/schedule';\nimport { HttpModule } from '@nestjs/axios';\n\nimport { WithdrawalModule } from './modules/withdrawal/withdrawal.module';\nimport { DeviceModule } from './modules/device/device.module';\nimport { RedisService } from './common/services/redis.service';\nimport { WebSocketModule } from './common/modules/websocket/websocket.module';\nimport { config } from './common/constants/config';\nimport { BankModule } from './modules/bank/bank.module';\nimport { OCRModule } from './modules/ocr/ocr.module';\nimport { NotificationModule } from './modules/notifiction/notification.module';\nimport { RedisLockModule } from './modules/redis-lock/redis-lock.module';\n\n@Module({\n  imports: [\n    BullModule.forRoot({\n      redis: {\n        host: config.redis.host,\n        port: config.redis.port,\n        db: config.redis.db,\n        password: config.redis.password,\n      },\n      defaultJobOptions: {\n        removeOnComplete: 10, // Keep last 10 completed jobs\n        removeOnFail: 50, // Keep last 50 failed jobs\n        attempts: 3, // Retry failed jobs 3 times\n        backoff: {\n          type: 'exponential',\n          delay: 2000, // 2 seconds initial delay\n        },\n      },\n    }),\n\n    // Scheduling\n    ScheduleModule.forRoot(),\n\n    // HTTP client\n    HttpModule,\n\n    // Feature modules\n    WithdrawalModule,\n    DeviceModule,\n    WebSocketModule,\n    BankModule,\n    OCRModule,\n    NotificationModule,\n    RedisLockModule\n  ],\n  providers: [\n    RedisService,\n  ],\n  exports: [RedisService],\n})\nexport class AppModule { }\n\n","module.exports = require(\"@nestjs/bull\");","module.exports = require(\"@nestjs/schedule\");","module.exports = require(\"@nestjs/axios\");","import { Module, forwardRef } from '@nestjs/common';\nimport { BullModule } from '@nestjs/bull';\nimport { ScheduleModule } from '@nestjs/schedule';\nimport { WithdrawalService } from './withdrawal.service';\nimport { WithdrawalJobManagerService } from './withdrawal-job-manager.service';\nimport { WithdrawalController } from './withdrawal.controller';\nimport { EzpayBeClientService } from '../notifiction/ezpay-be-client.service';\nimport { RedisService } from '../../common/services/redis.service';\nimport { DeviceModule } from '../device/device.module';\nimport { BankModule } from '../bank/bank.module';\nimport { HttpModule } from '@nestjs/axios';\nimport { WindowAppModule } from '../window-app/window-app.module';\nimport { bullQueueNames } from './constants/queue';\nimport { InternalTransferService } from './internal-transfer.service';\nimport { InternalTransferJobManagerService } from './internal-job-manager.service';\n\n@Module({\n  imports: [\n    BullModule.registerQueue(\n      {\n        name: bullQueueNames.WITHDRAWAL_REQUEST, // Single queue - jobs c pick th cng,\n        defaultJobOptions: {\n          attempts: 0,\n          removeOnComplete: false,\n          removeOnFail: false\n        },\n      },\n      {\n        name: bullQueueNames.WITHDRAWAL_REQUEST_LARGE_AMOUNT,\n        defaultJobOptions: {\n          attempts: 0,\n          removeOnComplete: false,\n          removeOnFail: false\n        },\n      },\n      {\n        name: bullQueueNames.INTERNAL_TRANSFER,\n        defaultJobOptions: {\n          attempts: 0,\n          removeOnComplete: false,\n          removeOnFail: false\n        },\n      }\n    ),\n    ScheduleModule,\n    forwardRef(() => DeviceModule),\n    BankModule,\n    HttpModule,\n    WindowAppModule\n  ],\n  controllers: [WithdrawalController],\n  providers: [\n    WithdrawalService,\n    WithdrawalJobManagerService,\n    EzpayBeClientService,\n    RedisService,\n    InternalTransferService,\n    InternalTransferJobManagerService\n  ],\n  exports: [WithdrawalService],\n})\nexport class WithdrawalModule {}\n\n","import { Injectable, Logger, Inject, forwardRef } from '@nestjs/common';\nimport { BankService } from '../bank/bank.service';\nimport { DeviceService } from '../device/device.service';\nimport { RedisService } from '../../common/services/redis.service';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { WithdrawalProcessingError, ErrorType } from './withdrawal-errors';\nimport { NotificationService } from '../notifiction/notification.service';\nimport { firstValueFrom } from 'rxjs';\nimport { config } from '@/common/constants/config';\nimport { HttpService } from '@nestjs/axios';\nimport { WithdrawalStatus } from './constants/withdrawal-status';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { formatCurrency } from '@/common/utils/currency';\n\n@Injectable()\nexport class WithdrawalService {\n  private readonly logger = new Logger('WithdrawalService');\n  private readonly REDIS_PROCESSED_PREFIX = 'withdrawal:processed:';\n  private readonly PROCESSING_TTL = 86400 * 1000 * 3; // 3 days in milliseconds\n  private readonly COMPLETED_TTL = 86400 * 1000 * 3; // 3 days in milliseconds\n\n  constructor(\n    private readonly bankService: BankService,\n    @Inject(forwardRef(() => DeviceService))\n    private readonly deviceService: DeviceService,\n    private readonly redisService: RedisService,\n    private readonly notificationService: NotificationService,\n    private readonly httpService: HttpService\n  ) { }\n\n  /**\n   * Check if withdrawal was already processed\n   */\n  private async checkIfProcessed(withdrawalId: string): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      const status = await this.redisService.get(key);\n\n      if (status === 'completed') {\n        this.logger.warn(`Withdrawal ${withdrawalId} already completed`);\n        return true;\n      }\n\n      if (status === 'processing') {\n        this.logger.warn(`Withdrawal ${withdrawalId} is being processed by another instance`);\n        return true;\n      }\n\n      return false;\n    } catch (error) {\n      this.logger.error(`Error checking processed status for ${withdrawalId}: ${error.message}`);\n      // If Redis check fails, allow processing (fail open)\n      return false;\n    }\n  }\n\n  /**\n   * Mark withdrawal as processing (atomic operation using SETNX)\n   */\n  private async markAsProcessing(withdrawalId: string): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      // Use SETNX (SET if Not eXists) - atomic operation\n      // This ensures only one instance can mark as processing\n      const result = await this.redisService.setnx(key, 'processing', this.PROCESSING_TTL);\n\n      if (result === 'OK') {\n        this.logger.debug(`Marked withdrawal ${withdrawalId} as processing`);\n        return true;\n      }\n\n      // Key already exists - another instance is processing\n      this.logger.warn(`Withdrawal ${withdrawalId} is already being processed by another instance`);\n\n      return false;\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as processing: ${error.message}`);\n      // If Redis fails, allow processing (fail open)\n      return true;\n    }\n  }\n\n  /**\n   * Mark withdrawal as completed\n   */\n  private async markAsCompleted(withdrawalId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      await this.redisService.set(key, 'completed', this.COMPLETED_TTL);\n      this.logger.log(`Marked withdrawal ${withdrawalId} as completed`);\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as completed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Mark withdrawal as failed (remove from Redis to allow manual retry)\n   */\n  private async markAsFailed(withdrawalId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      await this.redisService.del(key);\n      this.logger.log(`Marked withdrawal ${withdrawalId} as failed (removed from processed list)`);\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as failed: ${error.message}`);\n    }\n  }\n\n  async processWithdrawal(withdrawal: Withdrawal, deviceConfig: DeviceConfig) {\n    const { withdrawalId, bankCode, amount } = withdrawal;\n\n    // 1. IDEMPOTENCY CHECK - m bo withdrawal cha c x l\n    const isProcessed = await this.checkIfProcessed(withdrawalId);\n    if (isProcessed) {\n      this.logger.warn(`Withdrawal ${withdrawalId} already processed or being processed, skipping`);\n\n      return;\n    }\n\n    // 2. Mark as processing (atomic operation)\n    const markAsProcessing = await this.markAsProcessing(withdrawalId);\n    if (!markAsProcessing) {\n      const reason = `Withdrawal ${withdrawalId} is being processed by another instance`;\n      this.logger.warn(reason);\n      // Throw error vi type TEMPORARY v c th retry sau khi instance khc xong\n      throw new WithdrawalProcessingError(\n        reason, \n        ErrorType.TEMPORARY,\n        'Failed: Mark as processing'\n      );\n    }\n\n    try {\n      this.logger.log(`[${deviceConfig.accountName}] Processing withdrawal: ${withdrawalId} for bank: ${bankCode}, amount: ${amount}`);\n\n      // TODO: 1 Auto find available balance for device\n      // Verify available amount\n      if (deviceConfig.availableAmount < amount) {\n        const reason = `[${deviceConfig.accountName}] Assigned device has insufficient amount. Available: ${deviceConfig.availableAmount}, Required: ${amount}`;\n        this.logger.error(reason);\n\n        await this.markAsFailed(withdrawalId);\n\n        await this.deviceService.updateDeviceConfig(deviceConfig.deviceId, { status: 'deactive' });\n        \n        throw new WithdrawalProcessingError(\n          reason, ErrorType.TEMPORARY,\n          `Failed: Khng  s d (${formatCurrency(deviceConfig.availableAmount)})`\n        );\n      }\n\n      await this.bankService.executeTransferWithQRCode(withdrawal, deviceConfig, deviceConfig.bankCode);\n\n      this.deviceService.deductDeviceAmount(deviceConfig.deviceId, amount).catch(() => {});\n\n      const analysisResult = await this.bankService.analyzeTransferBill(deviceConfig.bankCode, withdrawal);\n\n      this.notificationService.completeWithdrawal(withdrawal, analysisResult, deviceConfig).catch(() => {});\n\n      if (analysisResult.analyzedStatus === 'unknown') {\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n      } else {\n        await this.bankService.goToHomeScreenFromBill(deviceConfig);\n      }\n\n      await this.markAsCompleted(withdrawalId);\n\n      this.logger.log(`Successfully processed withdrawal: ${withdrawalId}`);\n    } catch (error) {\n      await this.markAsFailed(withdrawalId);\n      \n      throw error;\n    }\n  }\n\n  async getWithdrawalDetails(id: string) {\n    const url = `${config.ezpayBe.apiUrl}/api/internal/withdrawals/${id}`;\n\n    const response = await firstValueFrom(\n      this.httpService.get<{\n        data: { \n          status: WithdrawalStatus; \n          withdrawalId: string; \n          withdrawalCode: string,\n          cryptoExchangeId: string;\n          bankCode: string;\n          beneficiaryAccountNo: string;\n          beneficiaryName: string;\n          amount: string;\n          /* ... add more field if needed, the api will return more */\n        }\n      }>(url, {\n        headers: {\n          'Content-Type': 'application/json',\n          'X-API-Key': config.ezpayBe.apiKey,\n          'x-internal-secret-key': config.ezpayBe.apiKey,\n        },\n        timeout: 20000,\n      }),\n    );\n\n    return response.data.data;\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { AcbService } from './acb.service';\nimport { PgService } from './pg.service';\nimport { HdBankService } from './hdbank.service';\nimport { VietcombankService } from './vietcombank.service';\nimport { DeviceService } from '../device/device.service';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { IBankService, IAnalyzeTransferBillResult } from './interfaces/bank-service.interface';\nimport { SessionManagementService } from './session-management.service';\nimport { DeviceLockService } from '../device/device-lock.service';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { TelegramService } from '../notifiction/telegram.service';\nimport { sleep } from '@/common/utils/time';\nimport { join } from 'path';\nimport { readdir, stat } from 'fs/promises';\nimport { existsSync } from 'fs';\nimport { PandaDeviceType } from '@/common/modules/websocket/constants/device';\n\n/**\n * Bank Service Factory\n * Routes to appropriate bank-specific service based on bankCode\n */\n@Injectable()\nexport class BankService {\n  private readonly logger = new Logger('BankService');\n  private readonly bankServices: Map<string, IBankService> = new Map();\n\n  constructor(\n    private readonly acbService: AcbService,\n    private readonly pgService: PgService,\n    private readonly hdBankService: HdBankService,\n    private readonly vietcombankService: VietcombankService,\n    private readonly deviceService: DeviceService,\n    private readonly sessionManagement: SessionManagementService,\n    private readonly deviceLock: DeviceLockService,\n    private readonly telegramService: TelegramService,\n  ) {\n    // Register all bank services\n    this.registerBankService(this.acbService);\n    this.registerBankService(this.pgService);\n    this.registerBankService(this.hdBankService);\n    // this.registerBankService(this.vietcombankService);\n  }\n\n  /**\n   * Register a bank service\n   */\n  private registerBankService(service: IBankService): void {\n    const bankCode = service.getBankCode().toUpperCase();\n    this.bankServices.set(bankCode, service);\n    this.logger.log(`Registered bank service: ${bankCode}`);\n  }\n\n  /**\n   * Get bank service by bank code (public method for controller)\n   */\n  getBankService(bankCode: string): IBankService | null {\n    const service = this.bankServices.get(bankCode.toUpperCase());\n\n    if (!service) {\n      throw new WithdrawalProcessingError(\n        `Bank ${bankCode} not supported! Cannot find bank service out!`, \n        ErrorType.PERMANENT\n      );\n    }\n\n    return service;\n  }\n\n  /**\n   * Get all supported bank codes\n   */\n  getSupportedBanks(): string[] {\n    return Array.from(this.bankServices.keys());\n  }\n\n  /**\n   * Login to bank app on device (with locking)\n   */\n  async login(bankCode: string, deviceId: string, force: boolean = false): Promise<void> {\n\n    if(force) {\n      await this.deviceLock.releaseLock(deviceId);\n    }\n\n    // Check if device is already locked (any type)\n    const isLocked = await this.deviceLock.isLocked(deviceId);\n    if (isLocked) {\n      const lock = await this.deviceLock.getLock(deviceId);\n      throw new Error(\n        `Device ${deviceId} is currently locked by ${lock?.lockType} (${lock?.lockedBy}). Cannot login.`\n      );\n    }\n\n    // Acquire lock using unified format: operation:operationId\n    const operationId = `login:${bankCode}:${deviceId}:${Date.now()}`;\n    const lockAcquired = await this.deviceLock.acquireLock(\n      deviceId,\n      'login',\n      operationId,\n      4.5 * 60 * 1000 // 5 minutes for login process\n    );\n\n    if (!lockAcquired) {\n      throw new Error(`Failed to acquire lock for device ${deviceId}`);\n    }\n\n    try {\n      // Mark as logging in\n      await this.sessionManagement.markLoggingIn(deviceId, bankCode);\n\n      const service = this.getBankService(bankCode);\n      if (!service) {\n        throw new Error(`Bank service not found for bank code: ${bankCode}`);\n      }\n\n      this.logger.log(`[${deviceId}] Logging in to ${bankCode}`);\n      await service.login(deviceId);\n\n      // Record successful login\n      await this.sessionManagement.recordLogin(deviceId, bankCode);\n      \n      this.logger.log(`[${deviceId}] Successfully logged in to ${bankCode}`);\n    } catch (error) {\n      // Clear session on error\n      await this.sessionManagement.clearSession(deviceId, bankCode);\n      throw error;\n    } finally {\n      // Release login lock\n      await this.deviceLock.releaseLock(deviceId);\n    }\n  }\n\n  /**\n   * Login all active banks\n   */\n  async loginAllActiveBanks(deviceType: PandaDeviceType = PandaDeviceType.ALL): Promise<void> {\n    try {\n      const maxRetries = 6;\n      const delayTime = 10000;\n      let devices = [];\n\n      for (let i = 0; i < maxRetries; i++) {\n        this.logger.log(`[${i + 1}/${maxRetries}] Retrying to list devices on login...`);\n        devices = await this.deviceService.listDevices(deviceType);\n        if (devices.length > 0) {\n          break;\n        }\n\n        await sleep(delayTime);\n      }\n\n      const deviceConfigs = await this.deviceService.listDeviceConfigs();\n      const activeDevices = devices.filter(device => device.status === 'active' && device.bankCode);\n      const activeDeviceConfigs = deviceConfigs.filter(config => config.status === 'active' && config.bankCode);\n\n      if (activeDevices.length < activeDeviceConfigs.length) {\n        const disconnectedDevices = activeDeviceConfigs.filter(config => !activeDevices.some(device => device.udid === config.deviceId));\n\n        const messageBlocks = disconnectedDevices.map(config => \n          `<b>Bank:</b> ${config.bankCode}\\n<b>Account:</b> ${config.accountName}`\n        ).join('\\n\\n');\n        \n        this.telegramService.sendMessage({\n          text: ` <b>Devices disconnected: ${disconnectedDevices.length}</b>\\n\\n${messageBlocks}`,\n          options: {\n            parseMode: 'HTML',\n          },\n        });\n      }\n\n      if (activeDevices.length === 0) {\n        this.logger.warn('No active devices found to login');\n        return;\n      }\n\n      // Release transfer locks for all active devices before login\n      for (const device of activeDevices) {\n        const deviceId = device.udid;\n        try {\n          await this.deviceLock.releaseLockByType(deviceId, 'transfer');\n        } catch (error) {\n          this.logger.warn(`Failed to release transfer lock for device ${deviceId}: ${error.message}`);\n        }\n      }\n\n      // Login all active devices\n      const loginPromises: Promise<void>[] = [];\n      for (const device of activeDevices) {\n        const bankCode = device.bankCode.toUpperCase();\n        const deviceId = device.udid;\n        loginPromises.push(\n          this.login(bankCode, deviceId, true).catch(error => {\n            this.logger.error(`Failed to login ${bankCode} on device ${deviceId}: ${error.message}`);\n          })\n        );\n      }\n\n      await Promise.allSettled(loginPromises);\n      this.logger.log(`Completed login process for all active banks`);\n    } catch (error) {\n      this.logger.error(`Error logging in all active banks: ${error.message}`);\n      throw error;\n    }\n  }\n\n  executeTransferWithQRCode(\n    withdrawal: Withdrawal, \n    deviceConfig: DeviceConfig, \n    bankCode: string,\n  ) {\n    const service = this.getBankService(bankCode);\n\n    return service.executeTransferWithQRCode(withdrawal, deviceConfig);\n  }\n\n  /**\n   * Check if session is valid for a device\n   */\n  async isSessionValid(deviceId: string, bankCode: string): Promise<boolean> {\n    return await this.sessionManagement.isSessionValid(deviceId, bankCode);\n  }\n\n  /**\n   * Analyze transfer bill and return image with analysis result\n   */\n  analyzeTransferBill(bankCode: string, withdrawal: Withdrawal): Promise<IAnalyzeTransferBillResult | null> {\n    const service = this.getBankService(bankCode);\n    \n    return service.analyzeTransferBill(bankCode, withdrawal);\n  }\n\n  /**\n   * Check and refresh session if needed\n   */\n  async refreshSessionIfNeeded(deviceId: string, bankCode: string): Promise<boolean> {\n    // Get session to check status\n    const session = await this.sessionManagement.getSession(deviceId, bankCode);\n    \n    // Skip if device is already logging in\n    if (session?.status === 'logging_in') {\n      return false;\n    }\n\n    // Check if session needs refresh (within refresh window) OR if session is expired/missing\n    const needsRefresh = await this.sessionManagement.needsRefresh(deviceId, bankCode);\n    const isValidSession = await this.sessionManagement.isSessionValid(deviceId, bankCode);\n    \n    // Only proceed if session needs refresh OR session is invalid (expired/missing)\n    if (!needsRefresh && isValidSession) {\n      return false;\n    }\n\n    // Check if device is locked\n    const isLocked = await this.deviceLock.isLocked(deviceId);\n    if (isLocked) {\n      this.logger.warn(`Cannot refresh session for device ${deviceId} - device is locked`);\n      return false;\n    }\n\n    try {\n      if (!isValidSession) {\n        this.logger.log(`Session expired or missing for device ${deviceId}, bank ${bankCode}. Retrying login...`);\n      } else {\n        this.logger.log(`Refreshing session for device ${deviceId}, bank ${bankCode}`);\n      }\n      await this.login(bankCode, deviceId);\n      return true;\n    } catch (error) {\n      this.logger.error(`Failed to refresh session for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n\n  createQRCodeAndTransferTo(bankCode: string, deviceId: string, withdrawal: Withdrawal): Promise<void> {\n    const service = this.getBankService(bankCode);\n\n    return service.createQRCodeAndTransferTo(deviceId, withdrawal);\n  }\n\n  captureScreen(bankCode: string, deviceId: string, folderPath: string): Promise<void> {\n    const service = this.getBankService(bankCode);\n    return service.captureScreen(deviceId, { folderPath });\n  }\n\n  getBillImagePath(bankCode: string, folderPath: string): Promise<string | null> {\n    const service = this.getBankService(bankCode);\n    return service.getBillImagePath(folderPath);\n  }\n\n  createBillFolder(bankCode: string, folderPath: string): Promise<void> {\n    const service = this.getBankService(bankCode);\n    return service.createBillFolder(folderPath);\n  }\n\n  goToHomeScreenFromBill(deviceConfig: DeviceConfig): Promise<void> {\n    const service = this.getBankService(deviceConfig.bankCode);\n\n    return service.goToHomeScreenFromBill(deviceConfig);\n  }\n\n  /*\n  * Only for testing purpose\n  */\n  async getLatestImagePath(\n    folderPath: string,\n    timeout: number = 10000,\n    pollInterval: number = 500\n  ): Promise<string | null> {\n    if (!folderPath) {\n      this.logger.warn('Folder path is null or empty');\n      return null;\n    }\n\n    const startTime = Date.now();\n    let attemptCount = 0;\n\n    this.logger.debug(\n      `Scanning folder for bill image: ${folderPath}, timeout: ${timeout}ms, pollInterval: ${pollInterval}ms`\n    );\n\n    while (Date.now() - startTime < timeout) {\n      attemptCount++;\n\n      try {\n        // Kim tra th mc c tn ti khng\n        if (!existsSync(folderPath)) {\n          await sleep(pollInterval);\n          continue;\n        }\n\n        const files = await readdir(folderPath);\n\n        if (files.length === 0) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`No files found in folder: ${folderPath}, retrying... (attempt ${attemptCount})`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Ly thng tin tt c cc file\n        const filesWithStat = await Promise.all(\n          files.map(async file => {\n            try {\n              const fullPath = join(folderPath, file);\n              const s = await stat(fullPath);\n              return { fullPath, mtime: s.mtimeMs, size: s.size };\n            } catch (statError) {\n              // Skip files that can't be stat'd\n              return null;\n            }\n          })\n        );\n\n        // Lc cc file hp l (size > 0)\n        const validFiles = filesWithStat.filter(\n          (f): f is { fullPath: string; mtime: number; size: number } => \n            f !== null && f.size > 0\n        );\n\n        if (validFiles.length === 0) {\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Sp xp theo thi gian modified mi nht\n        validFiles.sort((a, b) => b.mtime - a.mtime);\n\n        const latestFile = validFiles[0].fullPath;\n        const elapsed = Date.now() - startTime;\n        this.logger.log(\n          `Found latest bill image: ${latestFile} after ${elapsed}ms (${attemptCount} attempts)`\n        );\n\n        return latestFile;\n      } catch (error) {\n        this.logger.debug(\n          `Error scanning folder ${folderPath} (attempt ${attemptCount}): ${error.message}, retrying...`\n        );\n        await sleep(pollInterval);\n      }\n    }\n\n    // Timeout - khng tm thy file\n    const elapsed = Date.now() - startTime;\n    this.logger.warn(\n      `Timeout scanning folder for bill image: ${folderPath} after ${elapsed}ms (${attemptCount} attempts)`\n    );\n    return null;\n  }\n}\n\n\n","import { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\nimport { existsSync } from 'fs';\nimport { mkdir, readdir, stat, unlink } from 'fs/promises';\nimport { join } from 'path';\nimport { Inject, Injectable } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { PANDA_SERVICE_ANDROID } from '../../common/modules/websocket/constants/websocket';\nimport { DeviceService } from '../device/device.service';\nimport { DeviceBankCode, DeviceConfig } from '../device/dto/device-config.dto';\nimport { TelegramService } from '../notifiction/telegram.service';\nimport { ImagePreprocessingService } from '../ocr/services/image-preprocessing.service';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { ColorDetectionService } from '../ocr/services/color-detection.service';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { BaseBankService } from './base/base-bank.service';\nimport { ACB_ROI_EXPECTED } from './constants/acb-roi';\nimport { ACB_SCREEN_AFTER_FACE_ID_HINT, ACB_SCREEN_ALBUM_HINT, ACB_SCREEN_HINT_NAME, ACB_SCREEN_OTP_HINT, ACB_UI_COORDINATES } from './constants/acbank';\nimport type { ROI } from '../ocr/services/image-preprocessing.service';\n\n/** Config cho waitForBlueButton - ch cn detect color change (so snh R trc/sau) */\ninterface WaitForBlueButtonConfig {\n  roi: ROI;\n  timeout?: number;\n  pollInterval?: number;\n  /** Ngng chnh lch R  coi l  i mu. Default: 15 */\n  rChangeThreshold?: number;\n}\n\n@Injectable()\nexport class AcbService extends BaseBankService {\n  protected readonly BANK_CODE = 'ACB';\n  protected readonly BUNDLE_ID = 'mobile.acb.com.vn';\n\n  constructor(\n    @Inject(PANDA_SERVICE_ANDROID)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n    ocrService: OCRService,\n    imagePreprocessingService: ImagePreprocessingService,\n    private readonly colorDetectionService: ColorDetectionService,\n    private readonly telegramService: TelegramService,\n  ) {\n    super(wsService, deviceService, ocrService, imagePreprocessingService);\n  }\n\n  /**\n   * i detect color change trong ROI (so snh R trc v R sau).\n   * Ch cn gi tr R thay i vt ngng l return true.\n   */\n  private async waitForBlueButton(\n    deviceId: string,\n    config: WaitForBlueButtonConfig,\n  ): Promise<boolean> {\n    const { roi, timeout = 30000, pollInterval = 500, rChangeThreshold = 15 } = config;\n    const startTime = Date.now();\n    let attemptCount = 0;\n    const baseFolder = 'C:/EasyTrx';\n    const tempDir = join(baseFolder, `color_scan_${deviceId}`);\n    let initialR: number | null = null;\n\n    this.logger.debug(\n      `[${deviceId}] waitForBlueButton: ROI x=${roi.x}, y=${roi.y}, w=${roi.width}, h=${roi.height}, ` +\n      `timeout=${timeout}ms, poll=${pollInterval}ms, rChangeThreshold=${rChangeThreshold}`,\n    );\n\n    try {\n      await this.cleanupFolder(tempDir, deviceId);\n      await mkdir(tempDir, { recursive: true });\n\n      while (Date.now() - startTime < timeout) {\n        attemptCount++;\n        let tempScreenshotPath: string | null = null;\n\n        try {\n          const beforeCaptureTime = Date.now();\n          await this.wsService.captureScreen(deviceId, { folderPath: tempDir });\n\n          let latestFile: string | null = null;\n          const maxFileWaitAttempts = 5;\n          let fileWaitAttempt = 0;\n\n          while (fileWaitAttempt < maxFileWaitAttempts && !latestFile) {\n            fileWaitAttempt++;\n            await sleep(500);\n            try {\n              if (!existsSync(tempDir)) continue;\n              const files = await readdir(tempDir);\n              const pngFiles = files.filter(f => f.endsWith('.png'));\n              if (pngFiles.length === 0) continue;\n\n              let latestMtime = 0;\n              for (const file of pngFiles) {\n                const filePath = join(tempDir, file);\n                try {\n                  const fileStat = await stat(filePath);\n                  if (fileStat.size === 0) continue;\n                  if (fileStat.mtimeMs >= beforeCaptureTime - 2000 && fileStat.mtimeMs > latestMtime) {\n                    latestMtime = fileStat.mtimeMs;\n                    latestFile = filePath;\n                  }\n                } catch { continue; }\n              }\n            } catch { continue; }\n          }\n\n          if (!latestFile) {\n            if (attemptCount <= 2 || attemptCount % 5 === 0) {\n              this.logger.debug(\n                `[${deviceId}] waitForBlueButton attempt ${attemptCount}: no screenshot file found in ${tempDir}`,\n              );\n            }\n            await sleep(pollInterval);\n            continue;\n          }\n\n          tempScreenshotPath = latestFile;\n          const color = await this.colorDetectionService.getMeanColor(tempScreenshotPath, roi);\n          if (!color) {\n            await sleep(pollInterval);\n            continue;\n          }\n          const currentR = color.r;\n\n          if (initialR === null) {\n            initialR = currentR;\n            this.logger.debug(`[${deviceId}] waitForBlueButton initial R=${initialR}`);\n          } else if (Math.abs(currentR - initialR) > rChangeThreshold) {\n            await this.cleanupFolder(tempDir, deviceId);\n            const elapsed = Date.now() - startTime;\n            this.logger.log(\n              `[${deviceId}] Color change detected (R: ${initialR} -> ${currentR}) after ${elapsed}ms (${attemptCount} attempts)`,\n            );\n            return true;\n          }\n\n          if (tempScreenshotPath) {\n            try { await unlink(tempScreenshotPath); } catch { /* ignore */ }\n          }\n\n          if (attemptCount % 5 === 0) {\n            this.logger.debug(`[${deviceId}] waitForBlueButton attempt ${attemptCount}, still waiting...`);\n          }\n\n          await sleep(pollInterval);\n        } catch (error) {\n          this.logger.debug(`[${deviceId}] waitForBlueButton error (attempt ${attemptCount}): ${error.message}`);\n          await sleep(pollInterval);\n        }\n      }\n\n      await this.cleanupFolder(tempDir, deviceId);\n      const elapsed = Date.now() - startTime;\n      this.logger.warn(\n        `[${deviceId}] waitForBlueButton timeout after ${elapsed}ms (${attemptCount} attempts)`,\n      );\n      return false;\n    } catch (error) {\n      await this.cleanupFolder(tempDir, deviceId);\n      throw error;\n    }\n  }\n\n  async launchApp(deviceId: string) {\n    await this.wsService.launchApp(deviceId, this.BUNDLE_ID);\n    const doesLaunchAppSuccess = await this.verifyScreenState(deviceId, {\n      expectedTexts: ['ng nhp'],\n      timeout: 30_000,\n      pollInterval: 500,\n      roi: ACB_ROI_EXPECTED.LAUNCH_APP,\n      preprocess: {\n        // increase constrast for image recognition\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesLaunchAppSuccess) {\n      throw new Error('Failed to launch ACB app and go to login screen');\n    } else {\n      this.logger.log(`[${deviceId}] - Get login app screen`);\n      await sleep(2000);\n    }\n  }\n\n\n  /**\n   * Click on password field \"Mt khu\"\n   */\n  async clickPasswordField(deviceId: string): Promise<void> {\n    try {\n      const { x, y } = ACB_UI_COORDINATES.PASSWORD_FIELD;\n      this.logger.log(`Clicking password field on device ${deviceId} at coordinates (${x}, ${y})`);\n      await this.clickWithTransition(deviceId, x, y, 0.2);\n      // Wait for keyboard to appear\n      await sleep(1000);\n      this.logger.log(`Password field clicked successfully on device ${deviceId}`);\n    } catch (error) {\n      this.logger.error(`Error clicking password field on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Input password from device config\n   */\n  async inputPasswordFromConfig(deviceId: string): Promise<void> {\n    try {\n      const config = await this.deviceService.getDeviceConfig(deviceId);\n\n      if (!config || !config.password) {\n        throw new Error(`Password not configured for device ${deviceId}`);\n      }\n\n      await this.clickWithTransition(deviceId, ACB_UI_COORDINATES.PASSWORD_FIELD.x, ACB_UI_COORDINATES.PASSWORD_FIELD.y, 2000);\n\n      await this.wsService.inputText(deviceId, config.password);\n      await sleep(1000);\n\n      await this.wsService.pressReturnKey(deviceId);\n      await sleep(1000);\n\n    } catch (error) {\n      this.logger.error(`Error inputting password from config for device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Click on login button \"NG NHP\"\n   */\n  async clickLoginButton(deviceId: string): Promise<void> {\n    try {\n      const { x, y } = ACB_UI_COORDINATES.LOGIN_BUTTON;\n      this.logger.log(`Clicking login button on device ${deviceId} at coordinates (${x}, ${y})`);\n      await this.wsService.click(deviceId, x, y, 0.2);\n      // Wait for screen transition\n      await sleep(5000);\n      this.logger.log(`Login button clicked successfully on device ${deviceId}`);\n    } catch (error) {\n      this.logger.error(`Error clicking login button on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async login(deviceId: string): Promise<void> {\n    // Step 0: Kill app\n    await this.killApp(deviceId);\n    await sleep(1000);\n\n    // Step 1: Launch app\n    await this.launchApp(deviceId);\n\n    // Step 2: Click on login button\n    const { x, y } = ACB_UI_COORDINATES.LOGIN_BUTTON;\n    await this.wsService.click(deviceId, x, y, 0.2);\n    await sleep(2000);\n\n    // Step 3: Input password\n    await this.inputPasswordFromConfig(deviceId);\n\n    // Step 4: Click login button\n    const doesLoginSuccess = await this.clickAndWaitForScreen(deviceId,\n      ACB_UI_COORDINATES.LOGIN_BUTTON_API.x,\n      ACB_UI_COORDINATES.LOGIN_BUTTON_API.y,\n      {\n        expectedTexts: ['trang ch', 'qut m qr'],\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: ACB_ROI_EXPECTED.HOME_SCREEN,\n      }\n    );\n\n    if (!doesLoginSuccess) {\n      this.telegramService.sendMessage({\n        text: ' Login Error'\n          + `\\n\\n<b>Device:</b> ${deviceId}`\n          + `\\n<b>Error:</b> Khng th ng nhp vo app ACB.`,\n        options: {\n          parseMode: 'HTML'\n        }\n      });\n\n      throw new Error('Failed to login to ACB');\n    } else {\n      await this.clickWithTransition(\n        deviceId,\n        ACB_UI_COORDINATES.CLOSE_LOCATION_POPUP.x,\n        ACB_UI_COORDINATES.CLOSE_LOCATION_POPUP.y,\n        1000\n      );\n      this.logger.log(`[${deviceId}] - Login successfully`);\n    }\n    const availableAmount = await this.getBalance(deviceId);\n    if (availableAmount) {\n      await this.deviceService.updateDeviceConfig(deviceId, { availableAmount });\n    } else {\n      this.logger.warn(`[${deviceId}] - Get balance failed`);\n    }\n  }\n\n  async getBalance(deviceId: string): Promise<number | null> {\n    try {\n      await sleep(2000);\n      const doesGetAccountScreen = await this.clickAndWaitForScreen(deviceId,\n        ACB_UI_COORDINATES.BALANCE_HIN_BUTTON.x,\n        ACB_UI_COORDINATES.BALANCE_HIN_BUTTON.y,\n        {\n          expectedTexts: ['VN'],\n          timeout: 20_000,\n          pollInterval: 500,\n          roi: ACB_ROI_EXPECTED.ACCOUNT_BALANCE_NUMBER,\n        }\n      );\n\n      if (!doesGetAccountScreen) {\n        return 0;\n      }\n\n      // Extract balance from ROI using helper method from base class\n      return await this.extractBalanceFromROI(deviceId, ACB_ROI_EXPECTED.ACCOUNT_BALANCE_NUMBER);\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error extracting balance: ${error.message}`, error.stack);\n      return 0;\n    }\n  }\n\n  async executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    this.logger.log(`Executing ACB transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceConfig.deviceId}`);\n    await this.cleanScreenshot(deviceConfig.deviceId);\n\n    // Step 1: Click QR code button\n    const doesClickQRCodeSuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      ACB_UI_COORDINATES.QR_CODE_BTN.x,\n      ACB_UI_COORDINATES.QR_CODE_BTN.y,\n      {\n        expectedTexts: ['chn nh t th vin'],\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: ACB_ROI_EXPECTED.QR_CODE_SCREEN\n      }\n    )\n    if (!doesClickQRCodeSuccess) {\n      throw new WithdrawalProcessingError(\n        `[${deviceConfig.accountName}] Failed to click QR code button`,\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: MH chn nh t th vin'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get QR code screen`);\n    }\n\n    // Step 2: Click image library button\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      ACB_UI_COORDINATES.IMAGE_LIBRARY_BTN.x,\n      ACB_UI_COORDINATES.IMAGE_LIBRARY_BTN.y,\n      100\n    );\n\n    const albumScreenHint = await this.detectScreenByHint(deviceConfig.deviceId,\n      ACB_SCREEN_ALBUM_HINT,\n      {\n        timeout: 10_000,\n        pollInterval: 500,\n      }\n    );\n\n    if (!albumScreenHint) {\n      throw new WithdrawalProcessingError(\n        `[${deviceConfig.accountName}] Failed to get album screen`,\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Khng detect c mn hnh album'\n      );\n    }\n    if(albumScreenHint.name === ACB_SCREEN_HINT_NAME.ALBUM_VI) {\n      await this.clickWithTransition(deviceConfig.deviceId, 70, 39, 2000);\n      await this.clickWithTransition(deviceConfig.deviceId, 75, 55, 2000);\n      await this.clickWithTransition(deviceConfig.deviceId, 15, 50, 2000);\n      await this.clickWithTransition(deviceConfig.deviceId, 85, 92, 1000);\n    } else {\n      await this.clickWithTransition(deviceConfig.deviceId, 60, 50, 2000);\n      await this.clickWithTransition(deviceConfig.deviceId, 25, 65, 2000);\n      await this.clickWithTransition(deviceConfig.deviceId, 15, 65, 1000);\n    }\n\n\n    // Step 4: Verify account name\n    let verifiedAccountName = false;\n    verifiedAccountName = await this.verifyScreenState(\n      deviceConfig.deviceId,\n      {\n        expectedTexts: [withdrawal.beneficiaryName],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: ACB_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    )\n\n    if (!verifiedAccountName) {\n      throw new WithdrawalProcessingError(\n        'Choose wrong image qrcode',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: MH tra tn ti khon'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Verified account name screen`);\n    }\n\n    // Step 5: Continue transaction and expect transaction confirm screen\n    const doesTransactionConfirm = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      ACB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      ACB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Xc nhn chuyn'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: ACB_ROI_EXPECTED.TRANSACTION_CONFIRM,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    )\n\n    if (!doesTransactionConfirm) {\n      throw new WithdrawalProcessingError(\n        'Transaction confirm screen not found',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: MH Xc nhn giao dch'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction confirm screen`);\n    }\n\n    // Step 6: Continue transaction and expect OTP enter screen\n    const doesTransactionOTPEnter = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      ACB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      ACB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Nhp mt m'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: ACB_ROI_EXPECTED.TRANSACTION_ENTER_OTP,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    )\n\n    if (!doesTransactionOTPEnter) {\n      throw new WithdrawalProcessingError(\n        'Transaction enter otp screen not found',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: MH Nhp mt m'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction enter otp screen`);\n    }\n\n    // Step 7: Input smart OTP\n    await this.inputSmartOTPFromConfig(deviceConfig.deviceId);\n    await sleep(2000);\n    // Step 8: Get screen state\n    const screenHint = await this.detectScreenByHint(deviceConfig.deviceId,\n      ACB_SCREEN_OTP_HINT,\n      {\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: ACB_ROI_EXPECTED.TRANSACTION_VERIFY,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    );\n\n    if (!screenHint) {\n      throw new WithdrawalProcessingError(\n        'Transaction verify screen not found',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Khng detect c screen hint'\n      );\n    }\n    // Step 9: If face id screen, wait 15 seconds and confirm face id\n    if (screenHint.name === ACB_SCREEN_HINT_NAME.FACE_ID || screenHint.name === ACB_SCREEN_HINT_NAME.FACE_ID_ENG) {\n      const doesFaceCaptureButton = await this.waitForBlueButton(deviceConfig.deviceId, {\n        roi: ACB_ROI_EXPECTED.FACE_CAPTURE_BUTTON,\n        timeout: 20_000,\n        pollInterval: 500,\n      });\n      if (!doesFaceCaptureButton) {\n        throw new WithdrawalProcessingError(\n          'Face capture button not found',\n          ErrorType.FORCE_LOGIN_AND_REQUEUE,\n          'Failed: MH Chup anh khuon mat'\n        );\n      } else {\n        this.logger.log(`[${deviceConfig.accountName}] - Get Face capture button`);\n      }\n      await sleep(1_000);\n      await this.wsService.click(deviceConfig.deviceId, ACB_UI_COORDINATES.FACE_ID_BTN.x, ACB_UI_COORDINATES.FACE_ID_BTN.y, 0.2);\n      // Detect popup error affter face id \n      const affterFaceIdScreenHint = await this.detectScreenByHint(deviceConfig.deviceId,\n        ACB_SCREEN_AFTER_FACE_ID_HINT,\n        {\n          timeout: 30_000,\n          pollInterval: 500,\n          roi: ACB_ROI_EXPECTED.FACE_ID_POPPUP_ERROR,\n          preprocess: {\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      );\n  \n      if (!affterFaceIdScreenHint) {\n        throw new WithdrawalProcessingError(\n          'Affter face id screen not found',\n          ErrorType.FORCE_LOGIN_AND_REQUEUE,\n          'Failed: Khng detect c mn hnh sau khi qut face id'\n        );\n      }\n      if(affterFaceIdScreenHint.name === ACB_SCREEN_HINT_NAME.FACE_ID_POPPUP_ERROR || \n        affterFaceIdScreenHint.name === ACB_SCREEN_HINT_NAME.FACE_ID_POPPUP_ERROR_ENG\n      ) {\n        await this.wsService.click(deviceConfig.deviceId, ACB_UI_COORDINATES.FACE_ID_POPPUP_CLOSE_BTN.x, ACB_UI_COORDINATES.FACE_ID_POPPUP_CLOSE_BTN.y, 0.2);\n        await sleep(1_000);\n        const doesTransactionOTPConfirm = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n          ACB_UI_COORDINATES.FACE_ID_BTN.x,\n          ACB_UI_COORDINATES.FACE_ID_BTN.y,\n          {\n            expectedTexts: ['OTP safekey'],\n            timeout: 30_000,\n            pollInterval: 500,\n            roi: ACB_ROI_EXPECTED.TRANSACTION_VERIFY,\n            preprocess: {\n              grayscale: true,\n              enhanceContrast: true\n            }\n          }\n        )\n        if (!doesTransactionOTPConfirm) {\n          throw new WithdrawalProcessingError(\n            'Face id screen not found',\n            ErrorType.FORCE_LOGIN_AND_REQUEUE,\n            'Failed: MH Chup anh khuon mat'\n          );\n        } else {\n          this.logger.log(`[${deviceConfig.accountName}] - Get Face id screen`);\n        }\n      }\n    }\n\n    // Step 10: Continue transaction and expect transaction success screen\n    const doesTransactionSuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      ACB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      ACB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Chuyn tin thnh cng'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: ACB_ROI_EXPECTED.TRANSACTION_SUCCESS,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    )\n\n    if (!doesTransactionSuccess) {\n      throw new WithdrawalProcessingError(\n        'Transaction success screen not found',\n        ErrorType.NO_BILL_AFTER_OTP,\n        'Failed: MH Chuyn tin thnh cng'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction success screen`);\n    }\n\n    // Step 6: Capture screen\n    await sleep(500);\n    await this.captureScreen(deviceConfig.deviceId, { folderPath: withdrawal.withdrawalCode });\n    await sleep(2000);\n  }\n\n  private async inputSmartOTPFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.smartOTP) {\n      throw new Error(`SmartOTP not configured for device ${deviceId}`);\n    }\n\n    await sleep(2000);\n    await this.wsService.inputText(deviceId, config.smartOTP);\n  }\n\n  async executeInternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    // Because ACB bank merge internal transfer and external transfer, we use external transfer instead\n    return this.executeExternalTransfer(withdrawal, deviceId);\n  }\n\n  async executeExternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    console.warn('ACB executeExternalTransfer');\n  }\n\n  async goToHomeScreenFromBill(deviceConfig: DeviceConfig) {\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      ACB_UI_COORDINATES.CLOSE_TRANSACTION_BTN.x,\n      ACB_UI_COORDINATES.CLOSE_TRANSACTION_BTN.y,\n      2000\n    )\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      ACB_UI_COORDINATES.BACK_TO_HOME_BTN.x,\n      ACB_UI_COORDINATES.BACK_TO_HOME_BTN.y,\n      1000\n    );\n  }\n\n\n  async onModuleInit() {\n    return\n    await this.executeTransferWithQRCode({\n      _id: '8746238746783264',\n      withdrawalId: 'WDR0912368',\n      withdrawalCode: 'WDR091236898',\n      bankCode: 'PGBANK',\n      beneficiaryAccountNo: '00125412001',\n      beneficiaryName: 'tran nguyen anh duc',\n      amount: 2500,\n      status: 'pending',\n      description: '1',\n      priority: 1,\n      transferCode: \"00020101021238520010A000000727012200069704160108477603370208QRIBFTTA5303704540425005802VN6304B18D\",\n      createdAt: new Date().toDateString(),\n    }, {\n      deviceId: 'R58N3394KDF',\n      availableAmount: 100000000,\n      status: 'active',\n      password: '686868',\n      smartOTP: '868686',\n      bankCode: DeviceBankCode.ACB,\n      accountNo: '00125412001',\n      accountName: 'Nguyen Huy Phong',\n    }\n    )\n  }\n}\n\n","export const sleep = (ms: number): Promise<void> => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};","module.exports = require(\"fs\");","module.exports = require(\"fs/promises\");","export const PANDA_SERVICE_ANDROID = Symbol('PANDA_SERVICE_ANDROID');\nexport const PANDA_SERVICE_IOS = Symbol('PANDA_SERVICE_IOS');","import { forwardRef, HttpException, HttpStatus, Inject, Injectable, Logger, OnModuleInit } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { DeviceBankCode, DeviceConfig, TransferType, UpdateDeviceConfigDto } from './dto/device-config.dto';\nimport { DeviceLockService } from './device-lock.service'\nimport { BankService } from '../bank/bank.service';\nimport { isNil, omit } from 'lodash';\nimport { PandaManagerService } from '@/common/modules/websocket/panda-manager.service';\nimport { PandaDeviceType } from '@/common/modules/websocket/constants/device';\n\n@Injectable()\nexport class DeviceService implements OnModuleInit {\n  private readonly logger = new Logger('DeviceService');\n  private readonly REDIS_DEVICE_CONFIG_PREFIX = 'device:';\n  private readonly REDIS_DEVICE_CONFIG_SUFFIX = ':config';\n  private readonly REDIS_SERVICE_STATUS_KEY = 'service:status';\n\n  constructor(\n    private readonly redisService: RedisService,\n    private readonly deviceLockService: DeviceLockService,\n    @Inject(forwardRef(() => BankService))\n    private readonly bankService: BankService,\n    private readonly pandaManagerService: PandaManagerService,\n  ) { }\n\n  async onModuleInit() {\n    // Always set service status to 'inactive' on server startup\n    try {\n      await this.setServiceStatus('inactive');\n      this.logger.log('Service status initialized to: inactive');\n    } catch (error) {\n      this.logger.error(`Failed to initialize service status: ${error.message}`);\n    }\n  }\n\n  async listDeviceConfigs(): Promise<DeviceConfig[]> {\n    try {\n      // Get all keys matching pattern device:*:config\n      const pattern = `${this.REDIS_DEVICE_CONFIG_PREFIX}*${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      const keys = await this.redisService.keys(pattern);\n\n      if (keys.length === 0) {\n        return [];\n      }\n\n      // Get all configs in parallel\n      const configs = await Promise.all(\n        keys.map(async (key) => {\n          try {\n            const data = await this.redisService.get(key);\n            if (!data) {\n              return null;\n            }\n            return JSON.parse(data) as DeviceConfig;\n          } catch (error) {\n            this.logger.error(`Error parsing config for key ${key}: ${error.message}`);\n            return null;\n          }\n        }),\n      );\n\n      // Filter out null values and return\n      return configs.filter((config) => !isNil(config));\n    } catch (error) {\n      this.logger.error(`Error listing device configs: ${error.message}`);\n\n      return [];\n    }\n  }\n\n  async listDevices(deviceType: PandaDeviceType = PandaDeviceType.ALL) {\n    try {\n      const devices = await this.pandaManagerService.getDevices(deviceType);\n\n      // Map bankCode and config from Redis for each device\n      // BankCode mapping is stored in Redis: device:{deviceId}:config\n      const devicesWithConfig = await Promise.all(\n        devices.map(async (device) => {\n          // Get saved config from Redis (includes bankCode mapping)\n          const config = await this.getDeviceConfig(device.udid);\n\n          return {\n            ...device,\n            // Map bankCode from Redis config (persistent mapping)\n            bankCode: config?.bankCode || '',\n            availableAmount: config?.availableAmount || 0,\n            status: config?.status || 'deactive',\n            password: config?.password || '',\n            smartOTP: config?.smartOTP || '',\n            accountNo: config?.accountNo || '',\n            accountName: config?.accountName || '',\n            transferLimitPerDay: config?.transferLimitPerDay,\n            doesHandleLargeAmount: config?.doesHandleLargeAmount,\n            minTransferAmount: config?.minTransferAmount,\n            transferType: config?.transferType,\n            deviceType: config?.deviceType,\n          };\n        }),\n      );\n\n      return devicesWithConfig;\n    } catch (error) {\n      this.logger.error(`Error listing devices: ${error.message}`);\n\n      return [];\n    }\n  }\n\n  async getDeviceConfig(deviceId: string): Promise<DeviceConfig | null> {\n    try {\n      const key = `${this.REDIS_DEVICE_CONFIG_PREFIX}${deviceId}${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      const data = await this.redisService.get(key);\n\n      if (!data) {\n        return null;\n      }\n\n      return JSON.parse(data) as DeviceConfig;\n    } catch (error) {\n      this.logger.error(`Error getting device config for ${deviceId}: ${error.message}`);\n      return null;\n    }\n  }\n\n  async getDeviceConfigSafe(deviceId: string): Promise<DeviceConfig | null> {\n    try {\n      const config = await this.getDeviceConfig(deviceId);\n      if (!config) {\n        return null;\n      }\n\n      // Hide password and smartOTP from response\n      return {\n        ...config,\n        password: config.password ? '' : undefined,\n        smartOTP: config.smartOTP ? '' : undefined,\n      };\n    } catch (error) {\n      this.logger.error(`Error getting safe device config for ${deviceId}: ${error.message}`);\n      return null;\n    }\n  }\n\n  async updateDeviceConfig(deviceId: string, dto: UpdateDeviceConfigDto): Promise<DeviceConfig> {\n    try {\n      const key = `${this.REDIS_DEVICE_CONFIG_PREFIX}${deviceId}${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n\n      // Get existing config or create new\n      const existing = await this.getDeviceConfig(deviceId);\n\n      // If device already has config, password and smartOTP cannot be updated\n      // Always keep existing password and smartOTP if config exists\n      const hasExistingConfig = existing?.password || existing?.smartOTP;\n      const password = hasExistingConfig\n        ? (existing?.password || '')\n        : (dto.password !== undefined ? dto.password : '');\n      const smartOTP = hasExistingConfig\n        ? (existing?.smartOTP || '')\n        : (dto.smartOTP !== undefined ? dto.smartOTP : '');\n\n      const config: DeviceConfig = {\n        deviceId,\n        // BankCode mapping: save once, persist in Redis\n        bankCode: dto.bankCode !== undefined ? dto.bankCode : existing?.bankCode || '' as DeviceBankCode,\n        availableAmount: dto.availableAmount !== undefined ? dto.availableAmount : existing?.availableAmount || 0,\n        status: dto.status !== undefined ? dto.status : existing?.status || 'deactive',\n        password,\n        smartOTP,\n        accountNo: dto.accountNo !== undefined ? dto.accountNo : existing?.accountNo || '',\n        accountName: dto.accountName !== undefined ? dto.accountName : existing?.accountName || '',\n        transferLimitPerDay: dto.transferLimitPerDay !== undefined ? dto.transferLimitPerDay : existing?.transferLimitPerDay,\n        doesHandleLargeAmount: dto.doesHandleLargeAmount !== undefined ? dto.doesHandleLargeAmount : existing?.doesHandleLargeAmount,\n        minTransferAmount: dto.minTransferAmount !== undefined ? dto.minTransferAmount : existing?.minTransferAmount,\n        transferType: dto.transferType !== undefined ? dto.transferType : existing?.transferType,\n        deviceType: dto.deviceType !== undefined ? dto.deviceType : existing?.deviceType,\n      };\n\n      // Save to Redis (no expiration - persistent config including bankCode mapping)\n      // Key format: device:{deviceId}:config\n      await this.redisService.set(key, JSON.stringify(config));\n\n      this.logger.log(`[${deviceId}] Updated device config (bankCode: ${config.bankCode || 'not set'}): ${JSON.stringify(omit(config, ['password', 'smartOTP']))}`);\n      return config;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error updating device config: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async deleteDeviceConfig(deviceId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_DEVICE_CONFIG_PREFIX}${deviceId}${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      await this.redisService.del(key);\n\n      this.logger.log(`[${deviceId}] Deleted device config`);\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error deleting device config: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async getServiceStatus(): Promise<'active' | 'inactive'> {\n    try {\n      const status = await this.redisService.get(this.REDIS_SERVICE_STATUS_KEY);\n      return (status as 'active' | 'inactive') || 'inactive';\n    } catch (error) {\n      this.logger.error(`Error getting service status: ${error.message}`);\n      return 'inactive';\n    }\n  }\n\n  getPandaConnectionStatus() {\n    return {\n      android: this.pandaManagerService.isAndroidConnected(),\n      ios: this.pandaManagerService.isIosConnected(),\n    };\n  }\n\n  async setServiceStatus(status: 'active' | 'inactive'): Promise<void> {\n    try {\n      await this.redisService.set(this.REDIS_SERVICE_STATUS_KEY, status);\n      this.logger.log(`Service status set to: ${status}`);\n    } catch (error) {\n      this.logger.error(`Error setting service status: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async startService() {\n    try {\n      // Check if there is at least one device with status = 'active'\n      const hasActiveDevice = await this.hasActiveDevice();\n\n      if (!hasActiveDevice) {\n        throw new HttpException(\n          {\n            success: false,\n            error: 'Vui lng active bank trc khi start',\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      // Login all active banks (Non-blocking: don't await completion)\n      // This allows devices to start working individually as soon as they finish login\n      this.bankService.loginAllActiveBanks().catch(err => {\n        this.logger.error(`Error during background login process: ${err.message}`);\n      });\n\n      // Give a small buffer for logins to acquire locks before enabling service\n      await new Promise(resolve => setTimeout(resolve, 2000));\n\n      // Set service status to active\n      await this.setServiceStatus('active');\n\n      // Trigger job processing immediately\n      // (Optional: fetch JobManager and trigger? But cron will pick it up in <10s)\n\n      return {\n        success: true,\n        message: 'Service started successfully. Devices are logging in and will accept jobs when ready.',\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error starting service: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to start service',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  async deductDeviceAmount(deviceId: string, amount: number): Promise<boolean> {\n    try {\n      const config = await this.getDeviceConfig(deviceId);\n      if (!config) {\n        return false;\n      }\n\n      const newAmount = config.availableAmount - amount;\n      if (newAmount < 0) {\n        this.logger.warn(`Insufficient amount for device ${deviceId}. Available: ${config.availableAmount}, Requested: ${amount}`);\n        return false;\n      }\n\n      await this.updateDeviceConfig(deviceId, { availableAmount: newAmount });\n      return true;\n    } catch (error) {\n      this.logger.error(`Error deducting amount for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n\n  async increaseDeviceAmount(deviceId: string, amount: number): Promise<boolean> {\n    try {\n      const config = await this.getDeviceConfig(deviceId);\n      if (!config) {\n        return false;\n      }\n\n      const newAmount = config.availableAmount + amount;\n      if (newAmount < 0) {\n        this.logger.warn(`Insufficient amount for device ${deviceId}. Available: ${config.availableAmount}, Requested: ${amount}`);\n        return false;\n      }\n\n      await this.updateDeviceConfig(deviceId, { availableAmount: newAmount });\n      return true;\n    } catch (error) {\n      this.logger.error(`Error deducting amount for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Check if there is at least one device with status = 'active'\n   */\n  async hasActiveDevice(): Promise<boolean> {\n    try {\n      const devices = await this.listDevices();\n      return devices.some(device => device.status === 'active');\n    } catch (error) {\n      this.logger.error(`Error checking active devices: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Get list of available devices of bank out (Transfer Type OUT) (Active AND Unlocked)\n   */\n  async getAvailableDevices() {\n    try {\n      const devices = await this.pandaManagerService.getDevices();\n      const availableDevices: Array<DeviceConfig> = [];\n\n      for (const device of devices) {\n        // 1. Check Config Status\n        const deviceConfig = await this.getDeviceConfig(device.udid);\n\n        if (deviceConfig?.status !== 'active') {\n          continue;\n        }\n\n        // 2. Check Lock Status (Must be free)\n        const isLocked = await this.deviceLockService.isLocked(device.udid);\n        if (isLocked) {\n          // this.logger.debug(`Device ${device.udid} is active but LOCKED. Skipping.`);\n          continue;\n        }\n\n        // 3. Check session of bank because cron for login run every 30 seconds but cron for pick job run every 5 seconds\n        const hasValidSession = await this.bankService.isSessionValid(device.udid, deviceConfig.bankCode);\n        if (!hasValidSession) {\n          this.logger.error(`[${device.udid}] Device does not have valid session for bank ${deviceConfig.bankCode}`);\n\n          continue;\n        }\n\n        if (deviceConfig.transferType !== TransferType.OUT && deviceConfig.transferType !== TransferType.ALL) {\n          continue;\n        }\n\n        availableDevices.push(deviceConfig);\n      }\n\n      return availableDevices;\n    } catch (error) {\n      this.logger.error(`Error getting available devices: ${error.message}`);\n      return [];\n    }\n  }\n\n  /**\n   * Get list of available devices of bank IN\n   */\n  async getBankInAvailableDevices() {\n    try {\n      const devices = await this.pandaManagerService.getDevices(PandaDeviceType.ANDROID);\n      const availableDevices: Array<DeviceConfig> = [];\n\n      for (const device of devices) {\n        // 1. Check Config Status\n        const deviceConfig = await this.getDeviceConfig(device.udid);\n\n        if (deviceConfig?.status !== 'active') {\n          continue;\n        }\n\n        // 2. Check Lock Status (Must be free)\n        const isLocked = await this.deviceLockService.isLocked(device.udid);\n        if (isLocked) {\n          continue;\n        }\n\n        // 3. Check session of bank because cron for login run every 30 seconds but cron for pick job run every 5 seconds\n        const hasValidSession = await this.bankService.isSessionValid(device.udid, deviceConfig.bankCode);\n        if (!hasValidSession) {\n          this.logger.error(`[${device.udid}] Device does not have valid session for bank ${deviceConfig.bankCode}`);\n\n          continue;\n        }\n\n        if (\n          deviceConfig.transferType !== TransferType.IN \n          && deviceConfig.transferType !== TransferType.ALL\n        ) {\n          continue;\n        }\n\n        availableDevices.push(deviceConfig);\n      }\n\n      return availableDevices;\n    } catch (error) {\n      this.logger.error(`Error getting bank in: ${error.message}`);\n      return [];\n    }\n  }\n}\n\n","import { Injectable, Logger, OnModuleDestroy } from '@nestjs/common';\nimport Redis from 'ioredis';\nimport { config } from '../constants/config';\n\n@Injectable()\nexport class RedisService implements OnModuleDestroy {\n  private readonly logger = new Logger('RedisService');\n  private redisClient: Redis | null = null;\n\n  constructor() {}\n\n  async getClient(): Promise<Redis> {\n    if (this.redisClient) {\n      return this.redisClient;\n    }\n\n    const host = config.redis.host ?? 'localhost';\n    const port = config.redis.port ?? 6379;\n    const password = config.redis.password ?? undefined;\n    const db = config.redis.db ?? 3;\n\n    this.redisClient = new Redis({\n      host,\n      port,\n      password,\n      db,\n      enableReadyCheck: false,\n      maxRetriesPerRequest: null,\n      lazyConnect: true,\n    });\n\n    this.redisClient.on('error', (err) => {\n      this.logger.error('Redis Client Error', err.stack || err.message);\n    });\n\n    this.redisClient.on('connect', () => {\n      this.logger.log('Redis Client Connected');\n    });\n\n    this.redisClient.on('ready', () => {\n      this.logger.log('Redis Client Ready');\n    });\n\n    this.redisClient.on('close', () => {\n      this.logger.warn('Redis Client Connection Closed');\n    });\n\n    this.redisClient.on('reconnecting', () => {\n      this.logger.log('Redis Client Reconnecting...');\n    });\n\n    await this.redisClient.connect();\n\n    return this.redisClient;\n  }\n\n  async disconnect(): Promise<void> {\n    if (this.redisClient) {\n      await this.redisClient.disconnect();\n      this.redisClient = null;\n      this.logger.log('Redis Client Disconnected');\n    }\n  }\n\n  async onModuleDestroy(): Promise<void> {\n    await this.disconnect();\n  }\n\n  // Basic operations\n  async get(key: string): Promise<string | null> {\n    const client = await this.getClient();\n    return client.get(key);\n  }\n\n  async set(key: string, value: string, ttl?: number): Promise<'OK'> {\n    const client = await this.getClient();\n    if (ttl) {\n      // Convert milliseconds to seconds for Redis SETEX\n      const ttlSeconds = Math.ceil(ttl / 1000);\n      return client.setex(key, ttlSeconds, value);\n    }\n    return client.set(key, value);\n  }\n\n  async setex(key: string, ttl: number, value: string): Promise<'OK'> {\n    const client = await this.getClient();\n    // Convert milliseconds to seconds for Redis SETEX\n    const ttlSeconds = Math.ceil(ttl / 1000);\n    return client.setex(key, ttlSeconds, value);\n  }\n\n  async del(key: string): Promise<number> {\n    const client = await this.getClient();\n    return client.del(key);\n  }\n\n  async exists(key: string): Promise<number> {\n    const client = await this.getClient();\n    return client.exists(key);\n  }\n\n  // Sorted Set operations\n  async zadd(key: string, score: number, member: string): Promise<number> {\n    const client = await this.getClient();\n    return client.zadd(key, score, member);\n  }\n\n  async zrange(key: string, start: number, stop: number): Promise<string[]> {\n    const client = await this.getClient();\n    return client.zrange(key, start, stop);\n  }\n\n  async zrangebyscore(key: string, min: number | string, max: number | string, limit?: { offset: number; count: number }): Promise<string[]> {\n    const client = await this.getClient();\n    if (limit) {\n      return client.zrangebyscore(key, min, max, 'LIMIT', limit.offset, limit.count);\n    }\n    return client.zrangebyscore(key, min, max);\n  }\n\n  async zrem(key: string, ...members: string[]): Promise<number> {\n    const client = await this.getClient();\n    return client.zrem(key, ...members);\n  }\n\n  // Set operations\n  async sadd(key: string, ...members: string[]): Promise<number> {\n    const client = await this.getClient();\n    return client.sadd(key, ...members);\n  }\n\n  async sismember(key: string, member: string): Promise<number> {\n    const client = await this.getClient();\n    return client.sismember(key, member);\n  }\n\n  // Hash operations\n  async hset(key: string, field: string, value: string): Promise<number> {\n    const client = await this.getClient();\n    return client.hset(key, field, value);\n  }\n\n  async hget(key: string, field: string): Promise<string | null> {\n    const client = await this.getClient();\n    return client.hget(key, field);\n  }\n\n  async hgetall(key: string): Promise<Record<string, string>> {\n    const client = await this.getClient();\n    return client.hgetall(key);\n  }\n\n  async expire(key: string, ttl: number): Promise<number> {\n    const client = await this.getClient();\n    return client.expire(key, ttl);\n  }\n\n  /**\n   * Get all keys matching a pattern using SCAN (safe for production)\n   * @param pattern - Redis key pattern (e.g., 'device:lock:*')\n   * @returns Array of matching keys\n   */\n  async keys(pattern: string): Promise<string[]> {\n    const client = await this.getClient();\n    const keys: string[] = [];\n    let cursor = '0';\n\n    do {\n      const result = await client.scan(cursor, 'MATCH', pattern, 'COUNT', 100);\n      cursor = result[0];\n      keys.push(...result[1]);\n    } while (cursor !== '0');\n\n    return keys;\n  }\n\n  /**\n   * Set key if not exists (atomic operation)\n   * Returns 'OK' if key was set, null if key already exists\n   */\n  async setnx(key: string, value: string, ttl?: number): Promise<string | null> {\n    const client = await this.getClient();\n    if (ttl) {\n      // Convert milliseconds to seconds for Redis SET with NX and EX\n      const ttlSeconds = Math.ceil(ttl / 1000);\n      const result = await client.set(key, value, 'EX', ttlSeconds, 'NX');\n      return result;\n    }\n    const result = await client.set(key, value, 'NX');\n    return result;\n  }\n\n  async pickFromZSet(key: string, numberOfJobs: number = 1) {\n    const client = await this.getClient();\n\n    const jobs = await client.zrange(key, 0, numberOfJobs - 1, 'WITHSCORES');\n\n    if (!jobs || jobs.length === 0) {\n      return [];\n    }\n\n    const result: Array<{\n      jobId: string;\n      score: string;\n    }> = [];\n\n    for (let i = 0; i < jobs.length; i += 2) {\n      result.push({\n        jobId: jobs[i],\n        score: jobs[i + 1]\n      })\n    }\n\n    return result;\n  }\n}\n\n","module.exports = require(\"ioredis\");","import { config as dotenvConfig } from 'dotenv';\nimport { join } from 'path';\n\ndotenvConfig({ path: join(process.cwd(), '.env') });\n\nexport type NodeEnv = 'development' | 'production';\n\nexport interface IConfig {\n\tNODE_ENV: NodeEnv;\n\tboxType: 'HC' | 'PANDA';\n\tredis: {\n\t\thost: string;\n\t\tport: number;\n\t\tdb: number;\n\t\tpassword: string;\n\t};\n\tezpayBe: {\n\t\tapiUrl: string;\n\t\tapiKey: string;\n\t};\n\tocr: {\n\t\tpoolSize: number;\n\t\tlang: string;\n\t\trois: {\n\t\t\t[fieldType: string]: {\n\t\t\t\tcrop: {\n\t\t\t\t\tx: number; // ratio 0-1\n\t\t\t\t\ty: number; // ratio 0-1\n\t\t\t\t\twidth: number; // ratio 0-1\n\t\t\t\t\theight: number; // ratio 0-1\n\t\t\t\t};\n\t\t\t\tpsm: number; // Page Segmentation Mode\n\t\t\t\tcharWhitelist?: string;\n\t\t\t\tmaxWidth?: number; // Max width for downscale (pixels)\n\t\t\t};\n\t\t};\n\t};\n\tspaceocr: {\n\t\tdatacenterPrimary: string;\n\t\tdatacenterSecond: string;\n\t\tkey: string;\n\t\tkeyFree: string;\n\t};\n}\n\nexport const config: IConfig = {\n\tNODE_ENV: (process.env.NODE_ENV || 'production') as NodeEnv,\n\tboxType: 'PANDA',\n\tredis: {\n\t\thost: process.env.REDIS_HOST ?? '14.225.44.234',\n\t\tport: parseInt(process.env.REDIS_PORT ?? '6888'),\n\t\tdb: 3,\n\t\tpassword: process.env.REDIS_PWD ?? 'Dcsvnqvmn1',\n\t},\n\tezpayBe: {\n\t\tapiUrl: process.env.EZZPAY_BE ?? 'https://api-hn.botpro.world/payment',\n\t\tapiKey: process.env.EZZPAY_KEY ?? 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n\t},\n\tocr: {\n\t\tpoolSize: parseInt(process.env.OCR_POOL_SIZE || '10', 10),\n\t\tlang: process.env.OCR_LANG || 'vie+eng', // eng+vie, vie\n\t\trois: {\n\t\t\t// Single line text (account numbers, amounts, etc.)\n\t\t\tsingleLine: {\n\t\t\t\tcrop: {\n\t\t\t\t\tx: parseFloat(process.env.OCR_ROI_SINGLE_X || '0'),\n\t\t\t\t\ty: parseFloat(process.env.OCR_ROI_SINGLE_Y || '0'),\n\t\t\t\t\twidth: parseFloat(process.env.OCR_ROI_SINGLE_WIDTH || '1'),\n\t\t\t\t\theight: parseFloat(process.env.OCR_ROI_SINGLE_HEIGHT || '1'),\n\t\t\t\t},\n\t\t\t\tpsm: parseInt(process.env.OCR_PSM_SINGLE || '7', 10), // Single line\n\t\t\t\tcharWhitelist: process.env.OCR_WHITELIST_SINGLE || '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz .-',\n\t\t\t\tmaxWidth: parseInt(process.env.OCR_MAX_WIDTH_SINGLE || '800', 10),\n\t\t\t},\n\t\t\t// Block text (paragraphs, multiple lines)\n\t\t\tblock: {\n\t\t\t\tcrop: {\n\t\t\t\t\tx: parseFloat(process.env.OCR_ROI_BLOCK_X || '0'),\n\t\t\t\t\ty: parseFloat(process.env.OCR_ROI_BLOCK_Y || '0'),\n\t\t\t\t\twidth: parseFloat(process.env.OCR_ROI_BLOCK_WIDTH || '1'),\n\t\t\t\t\theight: parseFloat(process.env.OCR_ROI_BLOCK_HEIGHT || '1'),\n\t\t\t\t},\n\t\t\t\tpsm: parseInt(process.env.OCR_PSM_BLOCK || '6', 10), // Uniform block\n\t\t\t\tcharWhitelist: process.env.OCR_WHITELIST_BLOCK || undefined,\n\t\t\t\tmaxWidth: parseInt(process.env.OCR_MAX_WIDTH_BLOCK || '1200', 10),\n\t\t\t},\n\t\t\t// Full screen (default)\n\t\t\tfull: {\n\t\t\t\tcrop: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\twidth: 1,\n\t\t\t\t\theight: 1,\n\t\t\t\t},\n\t\t\t\tpsm: parseInt(process.env.OCR_PSM_FULL || '6', 10),\n\t\t\t\tcharWhitelist: undefined,\n\t\t\t\tmaxWidth: parseInt(process.env.OCR_MAX_WIDTH_FULL || '1200', 10),\n\t\t\t},\n\t\t},\n\t},\n\tspaceocr: {\n\t\tdatacenterPrimary: 'https://apipro1.ocr.space/parse/image',\n\t\tdatacenterSecond: 'https://apipro2.ocr.space/parse/image',\n\t\tkey: 'G888CWKP2Y06X',\n\t\tkeyFree: 'K82766678488957',\n\t},\n}","module.exports = require(\"dotenv\");","import { IsOptional, IsString, IsNumber, IsIn, ValidateIf, IsNotEmpty, Min, IsBoolean } from 'class-validator';\nimport { PandaDeviceType } from '@/common/modules/websocket/constants/device';\n\nexport class UpdateDeviceConfigDto {\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Bank Code is required when status is active' })\n  @IsString()\n  @IsOptional()\n  bankCode?: DeviceBankCode;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Available Amount is required when status is active' })\n  @IsNumber()\n  @Min(0, { message: 'Available Amount must be greater than or equal to 0' })\n  @IsOptional()\n  availableAmount?: number;\n\n  @IsOptional()\n  @IsString()\n  @IsIn(['active', 'deactive'])\n  status?: 'active' | 'deactive';\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Password is required when status is active' })\n  @IsString()\n  @IsOptional()\n  password?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Smart OTP is required when status is active' })\n  @IsString()\n  @IsOptional()\n  smartOTP?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Account No is required when status is active' })\n  @IsString()\n  @IsOptional()\n  accountNo?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Account Name is required when status is active' })\n  @IsString()\n  @IsOptional()\n  accountName?: string;\n\n  @IsOptional()\n  @IsNumber()\n  @Min(0, { message: 'Transfer Limit Per Day must be greater than or equal to 0' })\n  transferLimitPerDay?: number;\n\n  @IsOptional()\n  @IsBoolean()\n  doesHandleLargeAmount?: boolean;\n\n  @IsOptional()\n  @IsNumber()\n  @Min(0, { message: 'Min Transfer Amount must be greater than or equal to 0' })\n  minTransferAmount?: number;\n\n  @IsOptional()\n  @IsString()\n  @IsIn(['IN', 'OUT', 'ALL'], { message: 'Transfer Type must be either IN, OUT, or ALL' })\n  transferType?: TransferType;\n\n  @IsOptional()\n  @IsString()\n  @IsIn([PandaDeviceType.ANDROID, PandaDeviceType.IOS], { message: 'Device Type must be either ANDROID or IOS' })\n  deviceType?: PandaDeviceType;\n}\n\nexport enum DeviceBankCode{\n  ACB = 'ACB',\n  PGBANK = 'PGBANK',\n  HDBANK = 'HDBANK',\n  VIETCOMBANK = 'VIETCOMBANK'\n}\n\nexport enum TransferType {\n  IN = 'IN',\n  OUT = 'OUT',\n  ALL = 'ALL'\n}\n\nexport interface DeviceConfig {\n  deviceId: string;\n  bankCode: DeviceBankCode;\n  availableAmount: number;\n  status: 'active' | 'deactive';\n  password: string;\n  smartOTP: string;\n  accountNo: string;\n  accountName: string;\n  transferLimitPerDay?: number;\n  doesHandleLargeAmount?: boolean;\n  minTransferAmount?: number;\n  transferType?: TransferType;\n  deviceType?: PandaDeviceType;\n}\n\n","module.exports = require(\"class-validator\");","export enum PandaDeviceType {\n  ANDROID = 'ANDROID',\n  IOS = 'IOS',\n  ALL = 'ALL',\n}","import { Injectable, Logger } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { randomUUID } from 'crypto';\n\nexport type DeviceLockType = 'login' | 'transfer' | 'internal-transfer';\n\nexport interface DeviceLock {\n  deviceId: string;\n  lockType: DeviceLockType;\n  lockedAt: number;\n  lockedBy: string; // Unified format: 'operation:operationId' (e.g., 'login:ACB:deviceId:timestamp' or 'withdraw:withdrawalId:deviceId')\n  ttl: number; // TTL in milliseconds\n  lockId: string; // Unique lock ID for safe release\n}\n\n// Lua script for atomic unlock (only unlock if lockId matches)\nconst UNLOCK_SCRIPT = `\nif redis.call(\"GET\", KEYS[1]) == ARGV[1] then\n  redis.call(\"DEL\", KEYS[2])\n  return redis.call(\"DEL\", KEYS[1])\nelse\n  return 0\nend\n`;\n\n@Injectable()\nexport class DeviceLockService {\n  private readonly logger = new Logger('DeviceLockService');\n  private readonly REDIS_LOCK_PREFIX = 'device:lock:';\n  private readonly DEFAULT_LOCK_TTL = 10 * 60 * 1000; // 10 minutes default\n\n  constructor(private readonly redisService: RedisService) {}\n\n  /**\n   * Acquire lock for a device (atomic operation using SET NX EX)\n   */\n  async acquireLock(\n    deviceId: string,\n    lockType: DeviceLockType,\n    lockedBy: string,\n    ttl: number = this.DEFAULT_LOCK_TTL\n  ): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const lockId = randomUUID();\n      const ttlSeconds = Math.ceil(ttl / 1000);\n\n      // Use atomic SET NX EX to acquire lock\n      // This ensures only one process can acquire the lock\n      const client = await this.redisService.getClient();\n      const result = await client.set(key, lockId, 'EX', ttlSeconds, 'NX');\n\n      if (result === 'OK') {\n        // Lock acquired successfully, store metadata\n        const lockMetadata: Omit<DeviceLock, 'lockId'> = {\n          deviceId,\n          lockType,\n          lockedAt: Date.now(),\n          lockedBy,\n          ttl,\n        };\n        await this.redisService.setex(metadataKey, ttlSeconds, JSON.stringify(lockMetadata));\n        \n        this.logger.log(`[${deviceId}] Acquired ${lockType} lock (${lockedBy}) with lockId ${lockId}`);\n        return true;\n      }\n\n      // Lock already exists\n      this.logger.warn(\n        `[${deviceId}] Device is already locked, cannot acquire lock`\n      );\n      return false;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error acquiring lock: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Release lock for a device (atomic operation using Lua script)\n   */\n  async releaseLock(deviceId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const client = await this.redisService.getClient();\n      \n      // Get current lockId before releasing\n      const lockId = await client.get(key);\n      \n      if (!lockId) {\n        // Lock doesn't exist, clean up metadata if exists\n        await this.redisService.del(metadataKey);\n        this.logger.debug(`[${deviceId}] Device is not locked, nothing to release`);\n        return;\n      }\n\n      // Use Lua script to atomically check and delete only if lockId matches\n      // This prevents releasing lock that was acquired by another process\n      const result = await client.eval(\n        UNLOCK_SCRIPT,\n        2, // number of keys\n        key, // KEYS[1] - lock key\n        metadataKey, // KEYS[2] - metadata key\n        lockId as string // ARGV[1] - lockId to verify\n      ) as number;\n\n      if (result === 1) {\n        this.logger.log(`[${deviceId}] Released lock (lockId: ${lockId})`);\n      } else {\n        // Lock was already released or changed by another process\n        this.logger.warn(`[${deviceId}] Lock was already released or changed (expected lockId: ${lockId})`);\n      }\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error releasing lock: ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Get current lock for a device\n   */\n  async getLock(deviceId: string): Promise<DeviceLock | null> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const lockId = await this.redisService.get(key);\n      \n      if (!lockId) {\n        return null;\n      }\n\n      // Get metadata\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const metadataStr = await this.redisService.get(metadataKey);\n      \n      if (!metadataStr) {\n        // Metadata missing but lock exists - return minimal info\n        return {\n          deviceId,\n          lockType: 'transfer', // default\n          lockedAt: Date.now(),\n          lockedBy: 'unknown',\n          ttl: this.DEFAULT_LOCK_TTL,\n          lockId,\n        };\n      }\n\n      const metadata = JSON.parse(metadataStr) as Omit<DeviceLock, 'lockId'>;\n      return {\n        ...metadata,\n        lockId,\n      };\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error getting lock: ${error.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Check if device is locked\n   */\n  async isLocked(deviceId: string, excludeType?: DeviceLockType): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const exists = await this.redisService.exists(key);\n      \n      if (!exists) {\n        return false;\n      }\n\n      const lock = await this.getLock(deviceId);\n      if (!lock) {\n        return false;\n      }\n\n      // If excludeType is provided, allow if lock is of that type\n      if (excludeType && lock.lockType === excludeType) {\n        return false;\n      }\n\n      return true;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error checking lock status: ${error.message}`);\n      // On error, assume not locked (fail open)\n      return false;\n    }\n  }\n\n  /**\n   * Extend lock TTL (with ownership verification)\n   */\n  async extendLock(deviceId: string, additionalTtl: number): Promise<boolean> {\n    try {\n      const lock = await this.getLock(deviceId);\n      \n      if (!lock) {\n        return false;\n      }\n\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const client = await this.redisService.getClient();\n      const currentTtlSeconds = await client.ttl(key);\n      \n      if (currentTtlSeconds <= 0) {\n        // Lock expired\n        return false;\n      }\n\n      const newTtlSeconds = Math.ceil((currentTtlSeconds * 1000 + additionalTtl) / 1000);\n      const expireResult = await client.expire(key, newTtlSeconds);\n      \n      if (expireResult === 1) {\n        // Also extend metadata TTL\n        await this.redisService.expire(metadataKey, newTtlSeconds);\n        \n        this.logger.log(`[${deviceId}] Extended lock by ${additionalTtl}ms`);\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error extending lock: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Release lock by type (force release if lock type matches)\n   */\n  async releaseLockByType(deviceId: string, lockType: DeviceLockType): Promise<boolean> {\n    try {\n      const lock = await this.getLock(deviceId);\n      \n      if (!lock) {\n        return false;\n      }\n\n      // Only release if lock type matches\n      if (lock.lockType !== lockType) {\n        return false;\n      }\n\n      // Force release by directly deleting the keys (no lockId verification needed)\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      \n      await this.redisService.del(key);\n      await this.redisService.del(metadataKey);\n      \n      this.logger.log(`[${deviceId}] Force released ${lockType} lock`);\n      return true;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error releasing ${lockType} lock: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Get all device lock keys matching pattern device:lock:*\n   * @returns Array of device lock keys (without the prefix)\n   */\n  async hasAnyLockKeys(): Promise<number> {\n    try {\n      const pattern = `${this.REDIS_LOCK_PREFIX}*`;\n      const allKeys = await this.redisService.keys(pattern);\n      \n      // Filter out metadata keys (device:lock:*:meta) and extract deviceId\n      const lockKeys = allKeys.filter(key => !key.endsWith(':meta'))\n      \n      return lockKeys.length;\n    } catch (error) {\n      this.logger.error(`Error getting all lock keys: ${error.message}`);\n      return 0;\n    }\n  }\n}\n\n","module.exports = require(\"crypto\");","module.exports = require(\"lodash\");","import { Inject, Injectable } from '@nestjs/common';\nimport { PandaAndroidService } from './panda-android.service';\nimport { PandaIosService } from './panda-ios.service';\nimport { PANDA_SERVICE_ANDROID, PANDA_SERVICE_IOS } from './constants/websocket';\nimport { IWebSocketService } from './interface/websocket.interface';\nimport { PandaDeviceType } from './constants/device';\nimport { IPandaDevice } from './interface/device';\n\n@Injectable()\nexport class PandaManagerService {\n  private readonly pandaServices: Map<string, IWebSocketService> = new Map();\n\n  constructor(\n    @Inject(PANDA_SERVICE_ANDROID)\n    private readonly pandaAndroidService: PandaAndroidService,\n    @Inject(PANDA_SERVICE_IOS)\n    private readonly pandaIosService: PandaIosService,\n  ) {\n    this.registerPandaService(PandaDeviceType.ANDROID, this.pandaAndroidService);\n    this.registerPandaService(PandaDeviceType.IOS, this.pandaIosService);\n  }\n\n  /**\n   * Register a panda service\n   */\n  private registerPandaService(deviceType: PandaDeviceType, service: IWebSocketService): void {\n    this.pandaServices.set(deviceType, service);\n  }\n\n  getPandaService(deviceType: PandaDeviceType): IWebSocketService {\n    return this.pandaServices.get(deviceType);\n  }\n\n  isConnected(): boolean {\n    return this.pandaAndroidService.isConnectedStatus() || this.pandaIosService.isConnectedStatus();\n  }\n\n  isAndroidConnected(): boolean {\n    return this.pandaAndroidService.isConnectedStatus();\n  }\n\n  isIosConnected(): boolean {\n    return this.pandaIosService.isConnectedStatus();\n  }\n\n  /**\n   * Get all devices from both Android and iOS\n   */\n  async getDevices(deviceType: PandaDeviceType = PandaDeviceType.ALL) {\n    let androidDevices: Array<IPandaDevice> = [];\n    let iosDevices: Array<IPandaDevice> = [];\n\n    switch (deviceType) {\n      case PandaDeviceType.ALL:\n        if (this.pandaAndroidService.isConnectedStatus()) {\n          androidDevices = await this.pandaAndroidService.listDevices();\n        }\n\n        if (this.pandaIosService.isConnectedStatus()) {\n          iosDevices = await this.pandaIosService.listDevices();\n        }\n\n        break;\n\n      case PandaDeviceType.ANDROID:\n        if (this.pandaAndroidService.isConnectedStatus()) {\n          androidDevices = await this.pandaAndroidService.listDevices();\n        }\n        \n        break;\n\n      case PandaDeviceType.IOS:\n        if (this.pandaIosService.isConnectedStatus()) {\n          iosDevices = await this.pandaIosService.listDevices();\n        }\n        break;\n\n      default:\n        return [];\n    }\n\n    return [...androidDevices, ...iosDevices];\n  }\n}","import { Injectable, Logger, OnModuleInit, OnModuleDestroy } from '@nestjs/common';\nimport * as WebSocket from 'ws';\nimport { ICaptureScreenOptions, IPandaSwipeOptions, IWebSocketService } from './interface/websocket.interface';\nimport { toString } from 'lodash';\nimport { sleep } from '@/common/utils/time';\nimport { ANDROID_COMMON_COORDINATES, COMMON_COORDINATES, NUMPAD_LAYOUT } from '@/common/constants/keyboard';\nimport { TelegramService } from '@/modules/notifiction/telegram.service';\nimport { IPandaDevice } from './interface/device';\nimport { MESSAGE_TITLE } from '@/common/constants/message-title';\n\nexport interface PandaRequest<T> {\n  action: string;\n  /**\n   * \"all\" or \"xxx,xxx,xxx\" multiple devices separated by comma\n  */\n  devices?: string | string[];\n  data?: T;\n}\n\nexport interface PandaResponse<T> {\n  code: number;\n  message: string;\n  data: T;\n}\n\n@Injectable()\nexport class PandaAndroidService implements IWebSocketService, OnModuleInit, OnModuleDestroy {\n  private readonly logger = new Logger('PandaAndroidService');\n  private ws: WebSocket | null = null;\n  private wsUrl: string;\n  private reconnectAttempts = 0;\n  private maxReconnectAttempts = 10;\n  private reconnectDelay = 5000;\n  // Sequential request queue - all requests are queued and processed one at a time\n  private requestQueue: Array<{\n    request: PandaRequest<any>;\n    resolve: (value: any) => void;\n    reject: (error: any) => void;\n    timeout: number;\n  }> = [];\n  private pendingRequests = new Map<string, { resolve: (value: any) => void; reject: (error: any) => void }>();\n  private isConnected = false;\n  private isProcessingRequest = false; // Flag to track if currently processing a request\n\n  constructor(\n    private readonly telegramService: TelegramService,\n  ) {\n    this.wsUrl = 'ws://127.0.0.1:22222';\n  }\n\n  onModuleInit() {\n    this.connect()\n      .catch((error) => {\n        this.logger.warn(`Auto-connect PANDA ANDROID failed: ${error.message}. Will retry later.`);\n      });\n  }\n\n  async onModuleDestroy() {\n    await this.disconnect();\n  }\n\n  private async connect(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      try {\n        this.logger.log(`Connecting to Panda BOX WebSocket: ${this.wsUrl}`);\n        this.ws = new WebSocket(this.wsUrl);\n\n        this.ws.on('open', () => {\n          this.logger.log('Panda BOX WebSocket connected');\n          this.isConnected = true;\n          this.reconnectAttempts = 0;\n          // Start processing queue when connected\n          this.processRequestQueue();\n          resolve();\n        });\n\n        this.ws.on('message', (data: WebSocket.Data) => {\n          try {\n            const messageStr = data.toString();\n            const response: PandaResponse<any> = JSON.parse(messageStr);\n            this.handleMessage(response);\n          } catch (error) {\n            this.logger.error(`Error parsing WebSocket message: ${error.message}`, error.stack);\n            this.logger.error(`Raw message was: ${data.toString()}`);\n          }\n        });\n\n        this.ws.on('error', (error) => {\n          this.logger.error(`WebSocket error: ${error.message}`);\n          this.isConnected = false;\n          if (this.reconnectAttempts === 0) {\n            reject(error);\n          }\n        });\n\n        this.ws.on('close', () => {\n          this.logger.warn('Panda BOX WebSocket closed');\n          this.isConnected = false;\n          this.scheduleReconnect();\n        });\n      } catch (error) {\n        this.logger.error(`Error creating WebSocket connection: ${error.message}`);\n        reject(error);\n      }\n    });\n  }\n\n  private scheduleReconnect(): void {\n    if (this.reconnectAttempts >= this.maxReconnectAttempts) {\n      this.logger.error('Max reconnection attempts reached');\n\n      this.telegramService\n        .sendMessage({\n          text: ` Connection Error ${MESSAGE_TITLE}`\n            + `\\n\\n<b>Kt ni vo boxphone software tht bi.</b>`\n            + `\\n<b>Max retry:</b> ${this.maxReconnectAttempts}`\n            + `\\n<b>Current retry:</b> ${this.reconnectAttempts}`\n            + `\\n<b>Retry delay:</b> ${this.reconnectDelay}ms`,\n          options: {\n            parseMode: 'HTML'\n          }\n        });\n\n      return;\n    }\n\n    this.reconnectAttempts++;\n    const delay = this.reconnectDelay * this.reconnectAttempts;\n    this.logger.log(`Scheduling reconnect attempt ${this.reconnectAttempts} in ${delay}ms`);\n\n    setTimeout(() => {\n      this.connect().catch((error) => {\n        this.logger.error(`Reconnection failed: ${error.message}`);\n      });\n    }, delay);\n  }\n\n  private async disconnect(): Promise<void> {\n    if (this.ws) {\n      this.ws.close();\n      this.ws = null;\n      this.isConnected = false;\n    }\n  }\n\n  private handleMessage<T>(response: PandaResponse<T>): void {\n    // this.logger.debug(`Received WebSocket message: ${JSON.stringify(response)}`);\n\n    // Handle responses - use FIFO approach since API doesn't provide request IDs\n    if (this.pendingRequests.size > 0) {\n      const [firstKey, firstHandler] = this.pendingRequests.entries().next().value;\n      this.pendingRequests.delete(firstKey);\n\n      // Check response code: 10000 = SUCCESS, others = error\n      if (response.code === 10000) {\n        firstHandler.resolve(response.data);\n      } else {\n        const errorMessage = response.message || `Panda BOX error: ${response.code}`;\n        firstHandler.reject(new Error(errorMessage));\n      }\n    } else {\n      // Check if this looks like a device list response (unsolicited update)\n      const isDeviceListResponse = Array.isArray(response.data) &&\n        (response.data as any[]).length > 0 &&\n        (response.data as any[])[0]?.serial !== undefined;\n\n      if (isDeviceListResponse && response.code === 10000) {\n        // Likely an unsolicited device list update - log as debug instead of warning\n        const deviceList = response.data as any[];\n        this.logger.debug(`Received unsolicited device list update (no pending requests): ${deviceList.length} device(s)`);\n      } else {\n        // Other unsolicited responses or late responses - log as warning\n        this.logger.warn(`Received response but no pending requests: ${JSON.stringify(response)}`);\n      }\n    }\n  }\n\n  /**\n   * Process requests sequentially from queue\n   * Only one request is processed at a time to avoid timeout issues\n   */\n  private async processRequestQueue(): Promise<void> {\n    // If already processing a request or queue is empty, do nothing\n    if (this.isProcessingRequest || this.requestQueue.length === 0) {\n      return;\n    }\n\n    // If not connected, don't process (will process when connected)\n    if (!this.isConnected || !this.ws) {\n      return;\n    }\n\n    // Mark as processing\n    this.isProcessingRequest = true;\n\n    // Get first request from queue\n    const { request, resolve, reject, timeout } = this.requestQueue.shift()!;\n\n    try {\n      // Send request and wait for response\n      const result = await this._sendRequestOnce(request, timeout);\n      resolve(result);\n    } catch (error) {\n      reject(error);\n    } finally {\n      // Mark as done processing\n      this.isProcessingRequest = false;\n\n      // Process next request if any\n      if (this.requestQueue.length > 0) {\n        // Use setImmediate to avoid stack overflow and allow event loop to process\n        setImmediate(() => this.processRequestQueue());\n      }\n    }\n  }\n\n  /**\n   * Send a single WebSocket request (internal use only)\n   * This method sends the request and waits for response\n   */\n  private async _sendRequestOnce<T>(request: PandaRequest<T>, timeout = 30000): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // Generate unique request ID\n      const requestId = Date.now().toString() + Math.random().toString(36).substr(2, 9);\n      this.pendingRequests.set(requestId, { resolve, reject });\n\n      const timeoutId = setTimeout(() => {\n        this.pendingRequests.delete(requestId);\n        reject(new Error('WebSocket request timeout'));\n      }, timeout);\n\n      const originalResolve = resolve;\n      const originalReject = reject;\n\n      resolve = (value: any) => {\n        clearTimeout(timeoutId);\n        originalResolve(value);\n      };\n\n      reject = (error: any) => {\n        clearTimeout(timeoutId);\n        originalReject(error);\n      };\n\n      this.pendingRequests.set(requestId, { resolve, reject });\n\n      try {\n        const requestStr = JSON.stringify(request);\n\n        this.ws!.send(requestStr);\n      } catch (error) {\n        this.logger.error(`Error sending WebSocket request: ${error.message}`, error.stack);\n        this.pendingRequests.delete(requestId);\n        clearTimeout(timeoutId);\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Send WebSocket request - all requests are queued and processed sequentially\n   * This ensures no concurrent requests that could cause timeout issues\n   */\n  private async sendRequest<T>(request: PandaRequest<T>, timeout = 30000): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // Add request to queue\n      this.requestQueue.push({ request, resolve, reject, timeout });\n\n      // Start processing queue (will do nothing if already processing)\n      this.processRequestQueue();\n    });\n  }\n\n  async listDevices(): Promise<IPandaDevice[]> {\n    const response: Array<IPandaDevice> = await this.sendRequest({ action: 'list' });\n\n    const devices = response.map((device) => ({\n      ...device,\n      udid: device.serial,\n    }));\n\n    // TODO: Ping to telegram group\n    if (devices.length <= 0) {\n      this.logger.error('No devices found!');\n    }\n\n    return devices;\n  }\n\n  async click(deviceIds: string | string[], x: number, y: number, duration = 0.2): Promise<string> {\n    await this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds,\n      \"data\": {\n        \"type\": \"0\",\n        \"x\": toString(x),\n        \"y\": toString(y),\n      }\n    });\n\n    await sleep(200);\n\n    return this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds,\n      \"data\": {\n        \"type\": \"1\",\n        \"x\": toString(x),\n        \"y\": toString(y),\n      }\n    });\n  }\n\n  async swipe(\n    deviceIds: string | string[],\n    options: IPandaSwipeOptions\n  ): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": deviceIdsStr,\n      \"data\": options\n    });\n  }\n\n  async captureScreen(\n    deviceId: string,\n    options: ICaptureScreenOptions\n  ) {\n    return this.sendRequest({\n      action: 'Screen',\n      devices: deviceId,\n      data: {\n        savePath: options.folderPath,\n      }\n    });\n  }\n\n  async home(deviceIds: string | string[]): Promise<string> {\n    return this.sendRequest({\n      \"action\": \"pushEvent\",\n      \"devices\": deviceIds,\n      \"data\": {\n        \"type\": \"2\"\n      }\n    });\n  }\n\n  async launchApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\n    return this.sendRequest({\n      action: 'adb',\n      devices: deviceIdsStr,\n      data: {\n        command: `adb shell monkey -p ${bundleId} -c android.intent.category.LAUNCHER 1`,\n      }\n    });\n  }\n\n  async killApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\n    return this.sendRequest({\n      action: 'stopApk',\n      devices: deviceIdsStr,\n      data: {\n        apk: bundleId,\n      }\n    });\n  }\n\n  /**\n   * Switch keyboard mode (between letter and number)\n   */\n  async switchKeyboardMode(deviceIds: string | string[]): Promise<void> {\n    const { x, y } = COMMON_COORDINATES.KEYBOARD_SWITCH;\n    this.logger.log(`Switching keyboard mode on device ${deviceIds} at coordinates (${x}, ${y})`);\n    await this.click(deviceIds, x, y, 0.2);\n    // Wait for keyboard to switch\n    await sleep(500);\n    this.logger.log(`Keyboard mode switched successfully on device ${deviceIds}`);\n  }\n\n  /**\n   * Press shift key for uppercase letter\n   * Note: After typing one uppercase letter, keyboard automatically returns to lowercase\n   */\n  async pressShiftKey(deviceIds: string | string[]): Promise<void> {\n    const { x, y } = COMMON_COORDINATES.SHIFT_KEY;\n    this.logger.debug(`Pressing shift key on device ${deviceIds} at coordinates (${x}, ${y})`);\n    await this.click(deviceIds, x, y, 0.2);\n    // Small delay after pressing shift\n    await sleep(200);\n    this.logger.debug(`Shift key pressed successfully on device ${deviceIds}`);\n  }\n\n  /**\n   * Press return/enter key\n   * Note: This key can be used to:\n   * - Dismiss keyboard (exit input mode)\n   * - Submit/enter (depending on context)\n   */\n  async pressReturnKey(deviceId: string): Promise<void> {\n    const { x, y } = ANDROID_COMMON_COORDINATES.RETURN_KEY;;\n    await this.click(deviceId, x, y, 0.2);\n    // Wait for action to complete\n    await sleep(500);\n  }\n\n  async inputText(deviceIds: string | string[], text: string): Promise<void> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\n    return this.sendRequest({\n      action: 'adb',\n      devices: deviceIdsStr,\n      data: {\n        command: `adb shell input text ${text}`,\n      }\n    });\n  }\n\n  async inputNumpadNumber(deviceIds: string | string[], value: string) {\n    if (!value || value.length === 0) {\n      throw new Error('value cannot be empty');\n    }\n\n    for (let i = 0; i < value.length; i++) {\n      const digit = value[i];\n\n      const coordinates = NUMPAD_LAYOUT[digit];\n\n      await this.click(deviceIds, coordinates.x, coordinates.y);\n      this.logger.debug(`Clicking key '${digit}' at (${coordinates.x}, ${coordinates.y})`);\n      await sleep(200);\n    }\n  }\n\n  async transferFile(deviceIds: string | string[], filePath: string, fileType: number = 1): Promise<any> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    const phoneFolder = '/sdcard/DCIM/Camera/';\n\n    this.logger.log(`Transferring file ${filePath} to device(s) ${deviceIdsStr} with fileType ${fileType}`);\n\n    await this.sendRequest({\n      action: 'adb',\n      devices: deviceIdsStr,\n      data: {\n        command: `adb push ${filePath} ${phoneFolder}`,\n      }\n    });\n\n    await sleep(1000);\n\n    const fileName = filePath.split('\\\\').pop();\n\n    await this.sendRequest({\n      action: 'adb',\n      devices: deviceIdsStr,\n      data: {\n        command: `adb shell am broadcast -a android.intent.action.MEDIA_SCANNER_SCAN_FILE -d \"file://${phoneFolder}${fileName}\"`,\n      }\n    });\n  }\n\n  async cleanScreenshot(deviceId: string): Promise<void> {\n    return this.sendRequest({\n      action: 'adb',\n      devices: deviceId,\n      data: {\n        command: 'adb shell rm -rf /sdcard/*Screenshot*.png',\n      }\n    });\n  }\n\n  isConnectedStatus() {\n    return this.isConnected;\n  }\n}","module.exports = require(\"ws\");","import { config } from \"./config\";\n\n/**\n * Converts an object of coordinates to percentage coordinates\n * Converts normalized coordinates (0-1) to percentage coordinates (0-100)\n * @param coordinatesObj - Object containing coordinate objects with x and y properties\n * @returns Object with all coordinate values multiplied by 100\n */\nexport const scaleCoordinates = <\n\tT extends Record<string, { x: number; y: number }>\n>(coordinatesObj: T, factor: number = 100): T => {\n\treturn Object.fromEntries(\n\t\tObject.entries(coordinatesObj).map(([key, value]) => [\n\t\t\tkey,\n\t\t\t{\n\t\t\t\tx: Math.round(value.x * factor),\n\t\t\t\ty: Math.round(value.y * factor),\n\t\t\t},\n\t\t])\n\t) as T;\n}\n\n// iOS Keyboard Layout (normalized 0-1 coordinates)\n// These are approximate coordinates for iOS keyboard - may need adjustment per device\n// Layout: QWERTY keyboard, numbers row at top when in number mode\nconst HC_KEYBOARD_LAYOUT: Record<string, { x: number; y: number }> = {\n\t// Numbers (when keyboard is in number mode)\n\t'0': { x: 0.95, y: 0.68 },\n\t'1': { x: 0.05, y: 0.68 },\n\t'2': { x: 0.15, y: 0.68 },\n\t'3': { x: 0.25, y: 0.68 },\n\t'4': { x: 0.35, y: 0.68 },\n\t'5': { x: 0.45, y: 0.68 },\n\t'6': { x: 0.55, y: 0.68 },\n\t'7': { x: 0.65, y: 0.68 },\n\t'8': { x: 0.75, y: 0.68 },\n\t'9': { x: 0.85, y: 0.68 },\n\t'@': { x: 0.85, y: 0.78 },\n\t'!': { x: 0.65, y: 0.88 },\n\t// Letters (lowercase - iOS keyboard default)\n\t'a': { x: 0.1, y: 0.78 },\n\t'b': { x: 0.6, y: 0.88 },\n\t'c': { x: 0.4, y: 0.88 },\n\t'd': { x: 0.3, y: 0.78 },\n\t'e': { x: 0.25, y: 0.68 },\n\t'f': { x: 0.4, y: 0.78 },\n\t'g': { x: 0.5, y: 0.78 },\n\t'h': { x: 0.6, y: 0.78 },\n\t'i': { x: 0.75, y: 0.68 },\n\t'j': { x: 0.7, y: 0.78 },\n\t'k': { x: 0.8, y: 0.78 },\n\t'l': { x: 0.9, y: 0.78 },\n\t'm': { x: 0.8, y: 0.88 },\n\t'n': { x: 0.7, y: 0.88 },\n\t'o': { x: 0.85, y: 0.68 },\n\t'p': { x: 0.95, y: 0.68 },\n\t'q': { x: 0.05, y: 0.68 },\n\t'r': { x: 0.35, y: 0.68 },\n\t's': { x: 0.2, y: 0.78 },\n\t't': { x: 0.45, y: 0.68 },\n\t'u': { x: 0.65, y: 0.68 },\n\t'v': { x: 0.5, y: 0.88 },\n\t'w': { x: 0.15, y: 0.68 },\n\t'x': { x: 0.3, y: 0.88 },\n\t'y': { x: 0.55, y: 0.68 },\n\t'z': { x: 0.2, y: 0.88 },\n\t// Space key\n\t' ': { x: 0.55, y: 0.95 },\n};\n\n/**\n *  NUMPAD Layout (normalized 0-1 coordinates)\n * The keys are 0-9, and the coordinates are normalized 0-1\n * The keys are arranged in a 3x3 grid\n * */\nconst HC_NUMPAD_LAYOUT: Record<string, { x: number; y: number }> = {\n\t'0': { x: 0.55, y: 0.95 },\n\t'1': { x: 0.25, y: 0.7 },\n\t'2': { x: 0.55, y: 0.7 },\n\t'3': { x: 0.85, y: 0.7 },\n\t'4': { x: 0.25, y: 0.8 },\n\t'5': { x: 0.55, y: 0.8 },\n\t'6': { x: 0.85, y: 0.8 },\n\t'7': { x: 0.25, y: 0.9 },\n\t'8': { x: 0.55, y: 0.9 },\n\t'9': { x: 0.85, y: 0.9 },\n};\n\nconst HC_COMMON_COORDINATES = {\n\t// Keyboard mode switch button - Switch between letter and number keyboard\n\tKEYBOARD_SWITCH: {\n\t\tx: 0.05, // Left side of keyboard\n\t\ty: 0.95, // bottom area of keyboard\n\t},\n\t// Shift key (uppercase) - Press before typing uppercase letter\n\t// After typing one uppercase letter, keyboard automatically returns to lowercase\n\tSHIFT_KEY: {\n\t\tx: 0.05, // Left side of keyboard\n\t\ty: 0.88, // Bottom area of keyboard\n\t},\n\t// Return/Enter key - Sometimes to dismiss keyboard, sometimes to submit/enter\n\tRETURN_KEY: {\n\t\tx: 0.95, // Right side of keyboard\n\t\ty: 0.95, // Bottom area of keyboard\n\t},\n}\n\nconst PANDA_COMMON_COORDINATES = scaleCoordinates(\n\tHC_COMMON_COORDINATES\n);\n\nconst PANDA_NUMPAD_LAYOUT = scaleCoordinates(\n\tHC_NUMPAD_LAYOUT\n);\n\n/**\n * Export Constants\n * @description Export the constants for the keyboard\n * @returns The constants for the keyboard\n */\n\nexport const COMMON_COORDINATES = config.boxType === 'PANDA' ? PANDA_COMMON_COORDINATES : HC_COMMON_COORDINATES;\nexport const KEYBOARD_LAYOUT = HC_KEYBOARD_LAYOUT;\nexport const NUMPAD_LAYOUT = config.boxType === 'PANDA' ? PANDA_NUMPAD_LAYOUT : HC_NUMPAD_LAYOUT;\nexport const ANDROID_COMMON_COORDINATES = {\n\tRETURN_KEY: {\n\t\tx: 91, // Right side of keyboard\n\t\ty: 91, // Bottom area of keyboard\n\t},\n}","import { sleep } from '@/common/utils/time';\nimport { Injectable, Logger } from '@nestjs/common';\nimport axios, { AxiosInstance } from 'axios';\nimport * as FormData from 'form-data';\nimport { createReadStream } from 'fs';\n\ntype TelegramChatId = string | number;\n\ninterface TelegramSendMessageOptions {\n  parseMode?: 'Markdown' | 'MarkdownV2' | 'HTML';\n  disableWebPagePreview?: boolean;\n  disableNotification?: boolean;\n  replyToMessageId?: number;\n}\n\ninterface TelegramSendPhotoOptions {\n  caption?: string;\n  parseMode?: 'Markdown' | 'MarkdownV2' | 'HTML';\n  disableNotification?: boolean;\n}\n\n@Injectable()\nexport class TelegramService {\n  private readonly logger = new Logger(TelegramService.name);\n  private readonly http: AxiosInstance;\n\n  private readonly token = '8514906447:AAGFB2Fsl21IeF1tJvt8y6UsuoyNCIVcwCE';\n  private readonly defaultChatId: TelegramChatId = '-5288197652';\n  private readonly baseUrl = 'https://api.telegram.org';\n\n  constructor() {\n    this.http = axios.create({\n      baseURL: `${this.baseUrl}/bot${this.token}`,\n      timeout: 15_000,\n      // validateStatus: () => true, // bt nu bn mun t handle mi status\n    });\n  }\n\n  // ---------- Public API ----------\n\n  async sendMessage(\n    params: {\n      text: string,\n      chatId?: TelegramChatId,\n      options: TelegramSendMessageOptions,\n    }): Promise<void> {\n    const { text, chatId, options = {} } = params;\n    const parsedChatId = chatId ?? this.mustDefaultChatId();\n\n    return this.requestWithRetry('/sendMessage', {\n      chat_id: parsedChatId,\n      text,\n      parse_mode: options.parseMode ?? 'HTML',\n      disable_web_page_preview: options.disableWebPagePreview ?? false,\n      disable_notification: options.disableNotification ?? false,\n      reply_to_message_id: options.replyToMessageId ?? undefined,\n    })\n  }\n\n  async sendPhotoByUrl(\n    photoUrl: string,\n    chatId: TelegramChatId = this.mustDefaultChatId(),\n    options: TelegramSendPhotoOptions = {},\n  ): Promise<void> {\n    await this.requestWithRetry('/sendPhoto', {\n      chat_id: chatId,\n      photo: photoUrl,\n      caption: options.caption,\n      parse_mode: options.parseMode,\n      disable_notification: options.disableNotification,\n    });\n  }\n\n  async sendPhotoByFile(\n    data: {\n      filePath: string,\n      chatId?: TelegramChatId;\n      options?: TelegramSendPhotoOptions;\n    }\n  ): Promise<void> {\n    const { filePath, chatId, options = {} } = data;\n    const parsedChatId = chatId ?? this.mustDefaultChatId();\n\n    const stream = createReadStream(filePath);\n    const form = new FormData();\n    form.append('chat_id', String(parsedChatId));\n    form.append('photo', stream);\n    if (options.caption) form.append('caption', options.caption);\n    if (options.parseMode) form.append('parse_mode', options.parseMode);\n    if (options.disableNotification !== undefined) {\n      form.append('disable_notification', String(options.disableNotification));\n    }\n  \n    return this.requestFormWithRetry('/sendPhoto', form);\n  }\n\n  async sendPhotoByBuffer(\n    buffer: Buffer,\n    filename = 'image.png',\n    mimeType = 'image/png',\n    chatId: TelegramChatId = this.mustDefaultChatId(),\n    options: TelegramSendPhotoOptions = {},\n  ): Promise<void> {\n    const form = new FormData();\n    form.append('chat_id', String(chatId));\n    form.append('photo', buffer, { filename, contentType: mimeType });\n    if (options.caption) form.append('caption', options.caption);\n    if (options.parseMode) form.append('parse_mode', options.parseMode);\n    if (options.disableNotification !== undefined) {\n      form.append('disable_notification', String(options.disableNotification));\n    }\n\n    this.requestFormWithRetry('/sendPhoto', form)\n      .catch((error) => {\n        this.logger.error('Error sending telegram photo', error.stack);\n      });\n  }\n\n  async sendPhotoByBase64(\n    base64: string,\n    filename = 'image.png',\n    mimeType = 'image/png',\n    chatId: TelegramChatId = this.mustDefaultChatId(),\n    options: TelegramSendPhotoOptions = {},\n  ): Promise<void> {\n    const cleaned = this.stripBase64Prefix(base64);\n    const buffer = Buffer.from(cleaned, 'base64');\n    await this.sendPhotoByBuffer(buffer, filename, mimeType, chatId, options);\n  }\n\n  // ---------- Internal helpers ----------\n\n  private mustDefaultChatId(): TelegramChatId {\n    if (!this.defaultChatId) {\n      throw new Error('TELEGRAM_DEFAULT_CHAT_ID is missing and no chatId was provided.');\n    }\n    return this.defaultChatId;\n  }\n\n  private stripBase64Prefix(input: string): string {\n    // Handles \"data:image/png;base64,....\"\n    const idx = input.indexOf('base64,');\n    return idx >= 0 ? input.slice(idx + 'base64,'.length) : input;\n  }\n\n  private async requestWithRetry(path: string, payload: Record<string, any>, retry = 2): Promise<void> {\n    try {\n      const res = await this.http.post(path, payload);\n\n      // Telegram tr ok=false khi li logic\n      if (!res.data?.ok) {\n        const desc = res.data?.description ?? 'Unknown Telegram error';\n        throw new Error(`Telegram API error: ${desc}`);\n      }\n    } catch (err: any) {\n      if (retry > 0 && this.isRetryable(err)) {\n        const waitMs = this.backoffMs(retry);\n        this.logger.warn(`Telegram request failed, retrying in ${waitMs}ms: ${this.safeErr(err)}`);\n        await sleep(waitMs);\n        return this.requestWithRetry(path, payload, retry - 1);\n      }\n\n      this.logger.error(`Telegram request failed: ${this.safeErr(err)}`);\n      throw err;\n    }\n  }\n\n  private async requestFormWithRetry(path: string, form: FormData, retry = 2): Promise<void> {\n    try {\n      const res = await this.http.post(path, form, {\n        headers: form.getHeaders(),\n        maxBodyLength: Infinity,\n        maxContentLength: Infinity,\n      });\n\n      if (!res.data?.ok) {\n        const desc = res.data?.description ?? 'Unknown Telegram error';\n        throw new Error(`Telegram API error: ${desc}`);\n      }\n    } catch (err: any) {\n      if (retry > 0 && this.isRetryable(err)) {\n        const waitMs = this.backoffMs(retry);\n        this.logger.warn(`Telegram form request failed, retrying in ${waitMs}ms: ${this.safeErr(err)}`);\n        await sleep(waitMs);\n        return this.requestFormWithRetry(path, form, retry - 1);\n      }\n\n      this.logger.error(`Telegram form request failed: ${this.safeErr(err)}`);\n    }\n  }\n\n  private isRetryable(err: any): boolean {\n    // network / timeout / 5xx\n    const code = err?.code;\n    const status = err?.response?.status;\n\n    if (code === 'ECONNABORTED') return true; // timeout\n    if (status >= 500 && status <= 599) return true;\n    if (!status && (code === 'ENOTFOUND' || code === 'ECONNRESET' || code === 'EAI_AGAIN')) return true;\n\n    return false;\n  }\n\n  private backoffMs(retryLeft: number): number {\n    // retryLeft: 2 -> 400ms, 1 -> 800ms\n    const step = (2 - retryLeft) + 1;\n    return 400 * step;\n  }\n\n  private safeErr(err: any): string {\n    const status = err?.response?.status;\n    const desc = err?.response?.data?.description;\n    const msg = err?.message;\n    return [status ? `status=${status}` : '', desc ? `desc=${desc}` : '', msg ? `msg=${msg}` : '']\n      .filter(Boolean)\n      .join(' | ');\n  }\n}\n","module.exports = require(\"axios\");","module.exports = require(\"form-data\");","import { config } from \"./config\";\n\nexport const MESSAGE_TITLE = config.NODE_ENV === 'development' ? '(local dev)' : '';","import { Injectable, Logger, OnModuleInit, OnModuleDestroy } from '@nestjs/common';\nimport * as WebSocket from 'ws';\nimport { ICaptureScreenOptions, IPandaSwipeOptions, IWebSocketService } from './interface/websocket.interface';\nimport { toString } from 'lodash';\nimport { sleep } from '@/common/utils/time';\nimport { COMMON_COORDINATES, NUMPAD_LAYOUT } from '@/common/constants/keyboard';\nimport { TelegramService } from '@/modules/notifiction/telegram.service';\nimport { IPandaDevice } from './interface/device';\nimport { MESSAGE_TITLE } from '@/common/constants/message-title';\n\nexport interface PandaRequest<T> {\n  action: string;\n  /**\n   * \"all\" or \"xxx,xxx,xxx\" multiple devices separated by comma\n  */\n  devices?: string | string[];\n  data?: T;\n}\n\nexport interface PandaResponse<T> {\n  code: number;\n  message: string;\n  data: T;\n}\n\n@Injectable()\nexport class PandaIosService implements IWebSocketService, OnModuleInit, OnModuleDestroy {\n  private readonly logger = new Logger('PandaIosService');\n  private ws: WebSocket | null = null;\n  private wsUrl: string;\n  private reconnectAttempts = 0;\n  private maxReconnectAttempts = 10;\n  private reconnectDelay = 5000;\n  // Sequential request queue - all requests are queued and processed one at a time\n  private requestQueue: Array<{\n    request: PandaRequest<any>;\n    resolve: (value: any) => void;\n    reject: (error: any) => void;\n    timeout: number;\n  }> = [];\n  private pendingRequests = new Map<string, { resolve: (value: any) => void; reject: (error: any) => void }>();\n  private isConnected = false;\n  private isProcessingRequest = false; // Flag to track if currently processing a request\n\n  constructor(\n    private readonly telegramService: TelegramService,\n  ) {\n    this.wsUrl = 'ws://127.0.0.1:33333';\n  }\n\n  onModuleInit() {\n    this.connect()\n      .catch((error) => {\n        this.logger.warn(`Auto-connect PANDA IOS failed: ${error.message}. Will retry later.`);\n      });\n  }\n\n  async onModuleDestroy() {\n    await this.disconnect();\n  }\n\n  private async connect(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      try {\n        this.logger.log(`Connecting to Panda BOX WebSocket: ${this.wsUrl}`);\n        this.ws = new WebSocket(this.wsUrl);\n\n        this.ws.on('open', () => {\n          this.logger.log('Panda BOX WebSocket connected');\n          this.isConnected = true;\n          this.reconnectAttempts = 0;\n          // Start processing queue when connected\n          this.processRequestQueue();\n          resolve();\n        });\n\n        this.ws.on('message', (data: WebSocket.Data) => {\n          try {\n            const messageStr = data.toString();\n            const response: PandaResponse<any> = JSON.parse(messageStr);\n            this.handleMessage(response);\n          } catch (error) {\n            this.logger.error(`Error parsing WebSocket message: ${error.message}`, error.stack);\n            this.logger.error(`Raw message was: ${data.toString()}`);\n          }\n        });\n\n        this.ws.on('error', (error) => {\n          this.logger.error(`WebSocket error: ${error.message}`);\n          this.isConnected = false;\n          if (this.reconnectAttempts === 0) {\n            reject(error);\n          }\n        });\n\n        this.ws.on('close', () => {\n          this.logger.warn('Panda BOX WebSocket closed');\n          this.isConnected = false;\n          this.scheduleReconnect();\n        });\n      } catch (error) {\n        this.logger.error(`Error creating WebSocket connection: ${error.message}`);\n        reject(error);\n      }\n    });\n  }\n\n  private scheduleReconnect(): void {\n    if (this.reconnectAttempts >= this.maxReconnectAttempts) {\n      this.logger.error('Max reconnection attempts reached');\n\n      this.telegramService\n        .sendMessage({\n          text: ` Connection Error ${MESSAGE_TITLE}`\n            + `\\n\\n<b>Kt ni vo boxphone software tht bi.</b>`\n            + `\\n<b>Max retry:</b> ${this.maxReconnectAttempts}`\n            + `\\n<b>Current retry:</b> ${this.reconnectAttempts}`\n            + `\\n<b>Retry delay:</b> ${this.reconnectDelay}ms`,\n          options: {\n            parseMode: 'HTML'\n          }\n        });\n\n      return;\n    }\n\n    this.reconnectAttempts++;\n    const delay = this.reconnectDelay * this.reconnectAttempts;\n    this.logger.log(`Scheduling reconnect attempt ${this.reconnectAttempts} in ${delay}ms`);\n\n    setTimeout(() => {\n      this.connect().catch((error) => {\n        this.logger.error(`Reconnection failed: ${error.message}`);\n      });\n    }, delay);\n  }\n\n  private async disconnect(): Promise<void> {\n    if (this.ws) {\n      this.ws.close();\n      this.ws = null;\n      this.isConnected = false;\n    }\n  }\n\n  private handleMessage<T>(response: PandaResponse<T>): void {\n    // this.logger.debug(`Received WebSocket message: ${JSON.stringify(response)}`);\n\n    // Handle responses - use FIFO approach since API doesn't provide request IDs\n    if (this.pendingRequests.size > 0) {\n      const [firstKey, firstHandler] = this.pendingRequests.entries().next().value;\n      this.pendingRequests.delete(firstKey);\n\n      // Check response code: 10000 = SUCCESS, others = error\n      if (response.code === 10000) {\n        firstHandler.resolve(response.data);\n      } else {\n        const errorMessage = response.message || `Panda BOX error: ${response.code}`;\n        firstHandler.reject(new Error(errorMessage));\n      }\n    } else {\n      // Check if this looks like a device list response (unsolicited update)\n      const isDeviceListResponse = Array.isArray(response.data) &&\n        (response.data as any[]).length > 0 &&\n        (response.data as any[])[0]?.serial !== undefined;\n\n      if (isDeviceListResponse && response.code === 10000) {\n        // Likely an unsolicited device list update - log as debug instead of warning\n        const deviceList = response.data as any[];\n        this.logger.debug(`Received unsolicited device list update (no pending requests): ${deviceList.length} device(s)`);\n      } else {\n        // Other unsolicited responses or late responses - log as warning\n        this.logger.warn(`Received response but no pending requests: ${JSON.stringify(response)}`);\n      }\n    }\n  }\n\n  /**\n   * Process requests sequentially from queue\n   * Only one request is processed at a time to avoid timeout issues\n   */\n  private async processRequestQueue(): Promise<void> {\n    // If already processing a request or queue is empty, do nothing\n    if (this.isProcessingRequest || this.requestQueue.length === 0) {\n      return;\n    }\n\n    // If not connected, don't process (will process when connected)\n    if (!this.isConnected || !this.ws) {\n      return;\n    }\n\n    // Mark as processing\n    this.isProcessingRequest = true;\n\n    // Get first request from queue\n    const { request, resolve, reject, timeout } = this.requestQueue.shift()!;\n\n    try {\n      // Send request and wait for response\n      const result = await this._sendRequestOnce(request, timeout);\n      resolve(result);\n    } catch (error) {\n      reject(error);\n    } finally {\n      // Mark as done processing\n      this.isProcessingRequest = false;\n\n      // Process next request if any\n      if (this.requestQueue.length > 0) {\n        // Use setImmediate to avoid stack overflow and allow event loop to process\n        setImmediate(() => this.processRequestQueue());\n      }\n    }\n  }\n\n  /**\n   * Send a single WebSocket request (internal use only)\n   * This method sends the request and waits for response\n   */\n  private async _sendRequestOnce<T>(request: PandaRequest<T>, timeout = 30000): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // Generate unique request ID\n      const requestId = Date.now().toString() + Math.random().toString(36).substr(2, 9);\n      this.pendingRequests.set(requestId, { resolve, reject });\n\n      const timeoutId = setTimeout(() => {\n        this.pendingRequests.delete(requestId);\n        reject(new Error('WebSocket request timeout'));\n      }, timeout);\n\n      const originalResolve = resolve;\n      const originalReject = reject;\n\n      resolve = (value: any) => {\n        clearTimeout(timeoutId);\n        originalResolve(value);\n      };\n\n      reject = (error: any) => {\n        clearTimeout(timeoutId);\n        originalReject(error);\n      };\n\n      this.pendingRequests.set(requestId, { resolve, reject });\n\n      try {\n        const requestStr = JSON.stringify(request);\n        // this.logger.debug(`Sending WebSocket request: ${requestStr}`);\n        this.ws!.send(requestStr);\n      } catch (error) {\n        this.logger.error(`Error sending WebSocket request: ${error.message}`, error.stack);\n        this.pendingRequests.delete(requestId);\n        clearTimeout(timeoutId);\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Send WebSocket request - all requests are queued and processed sequentially\n   * This ensures no concurrent requests that could cause timeout issues\n   */\n  private async sendRequest<T>(request: PandaRequest<T>, timeout = 30000): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // Add request to queue\n      this.requestQueue.push({ request, resolve, reject, timeout });\n\n      // Start processing queue (will do nothing if already processing)\n      this.processRequestQueue();\n    });\n  }\n\n  async listDevices(): Promise<IPandaDevice[]> {\n    const response: Array<IPandaDevice> = await this.sendRequest({ action: 'list' });\n    const devices = response.map((device) => ({\n      ...device,\n      udid: device.serial,\n    }));\n\n    // TODO: Ping to telegram group\n    if (devices.length <= 0) {\n      this.logger.error('No devices found!');\n    }\n\n    return devices;\n  }\n\n  async click(deviceIds: string | string[], x: number, y: number, duration = 0.2): Promise<string> {\n    return this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds,\n      \"data\": {\n        \"type\": \"10\", // 10: click\n        \"x\": toString(x),\n        \"y\": toString(y),\n      }\n    });\n  }\n\n  async swipe(\n    deviceIds: string | string[],\n    options: IPandaSwipeOptions\n  ): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": deviceIdsStr,\n      \"data\": options\n    });\n  }\n\n  async captureScreen(\n    deviceId: string,\n    options: ICaptureScreenOptions\n  ) {\n    return this.sendRequest({\n      \"action\": \"screenFile\",\n      \"devices\": deviceId,\n      \"data\": {\n        savePath: options.folderPath\n      }\n    });\n  }\n\n  async home(deviceIds: string | string[]): Promise<string> {\n    return this.sendRequest({\n      \"action\": \"pushEvent\",\n      \"devices\": deviceIds,\n      \"data\": {\n        \"type\": \"2\"\n      }\n    });\n  }\n\n  async launchApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest(\n      {\n        \"action\": \"startApp\",\n        \"devices\": deviceIdsStr,\n        \"data\": {\n          \"app\": bundleId\n        }\n      }\n    )\n  }\n\n  async killApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"stopApp\",\n      \"devices\": deviceIdsStr,\n      \"data\": {\n        \"app\": bundleId\n      }\n    });\n  }\n\n  /**\n   * Switch keyboard mode (between letter and number)\n   */\n  async switchKeyboardMode(deviceIds: string | string[]): Promise<void> {\n    const { x, y } = COMMON_COORDINATES.KEYBOARD_SWITCH;\n    this.logger.log(`Switching keyboard mode on device ${deviceIds} at coordinates (${x}, ${y})`);\n    await this.click(deviceIds, x, y, 0.2);\n    // Wait for keyboard to switch\n    await sleep(500);\n    this.logger.log(`Keyboard mode switched successfully on device ${deviceIds}`);\n  }\n\n  /**\n   * Press shift key for uppercase letter\n   * Note: After typing one uppercase letter, keyboard automatically returns to lowercase\n   */\n  async pressShiftKey(deviceIds: string | string[]): Promise<void> {\n    const { x, y } = COMMON_COORDINATES.SHIFT_KEY;\n    this.logger.debug(`Pressing shift key on device ${deviceIds} at coordinates (${x}, ${y})`);\n    await this.click(deviceIds, x, y, 0.2);\n    // Small delay after pressing shift\n    await sleep(200);\n    this.logger.debug(`Shift key pressed successfully on device ${deviceIds}`);\n  }\n\n  /**\n   * Press return/enter key\n   * Note: This key can be used to:\n   * - Dismiss keyboard (exit input mode)\n   * - Submit/enter (depending on context)\n   */\n  async pressReturnKey(deviceId: string): Promise<void> {\n    const { x, y } = COMMON_COORDINATES.RETURN_KEY;;\n    await this.click(deviceId, x, y, 0.2);\n    // Wait for action to complete\n    await sleep(500);\n  }\n\n  async inputText(deviceIds: string | string[], text: string): Promise<void> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"inputText\",\n      \"devices\": deviceIdsStr,\n      \"data\": {\n        \"content\": text\n      }\n    });\n  }\n\n  async inputNumpadNumber(deviceIds: string | string[], value: string) {\n    if (!value || value.length === 0) {\n      throw new Error('value cannot be empty');\n    }\n\n    for (let i = 0; i < value.length; i++) {\n      const digit = value[i];\n\n      const coordinates = NUMPAD_LAYOUT[digit];\n\n      await this.click(deviceIds, coordinates.x, coordinates.y);\n      this.logger.debug(`Clicking key '${digit}' at (${coordinates.x}, ${coordinates.y})`);\n      await sleep(200);\n    }\n  }\n\n  async transferFile(deviceIds: string | string[], filePath: string, fileType: number = 1): Promise<any> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    this.logger.log(`Transferring file ${filePath} to device(s) ${deviceIdsStr} with fileType ${fileType}`);\n    return this.sendRequest({\n      \"action\": \"uploadFile\",\n      \"devices\": deviceIdsStr,\n      \"data\": {\n        \"filePath\": filePath,\n        \"fileType\": fileType\n      }\n    });\n  }\n\n  async cleanScreenshot(deviceId: string): Promise<void> {\n    // No needs for ios\n    return;\n  }\n\n  isConnectedStatus() {\n    return this.isConnected;\n  }\n}","import { Injectable, Logger } from '@nestjs/common';\nimport * as sharp from 'sharp';\n\nexport interface ROI {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}\n\nexport interface PreprocessResult {\n  buffer: Buffer;\n  metadata: {\n    originalWidth: number;\n    originalHeight: number;\n    processedWidth: number;\n    processedHeight: number;\n    scaleFactor: number;\n  };\n}\n\nexport interface PreprocessOptions {\n  grayscale?: boolean;\n  enhanceContrast?: boolean;\n}\n\n@Injectable()\nexport class ImagePreprocessingService {\n  private readonly logger = new Logger('ImagePreprocessingService');\n  private readonly MIN_DIMENSION = 10; // Minimum pixels for any dimension\n\n  /**\n   * Validate ROI values (should be between 0 and 1)\n   */\n  private validateROI(roi: ROI): void {\n    if (roi.x < 0 || roi.x > 1) {\n      throw new Error(`Invalid ROI x: ${roi.x} (must be 0-1)`);\n    }\n    if (roi.y < 0 || roi.y > 1) {\n      throw new Error(`Invalid ROI y: ${roi.y} (must be 0-1)`);\n    }\n    if (roi.width <= 0 || roi.width > 1) {\n      throw new Error(`Invalid ROI width: ${roi.width} (must be 0-1)`);\n    }\n    if (roi.height <= 0 || roi.height > 1) {\n      throw new Error(`Invalid ROI height: ${roi.height} (must be 0-1)`);\n    }\n    if (roi.x + roi.width > 1.001) { // Small tolerance for floating point\n      throw new Error(`ROI extends beyond image: x(${roi.x}) + width(${roi.width}) > 1`);\n    }\n    if (roi.y + roi.height > 1.001) {\n      throw new Error(`ROI extends beyond image: y(${roi.y}) + height(${roi.height}) > 1`);\n    }\n  }\n\n  /**\n   * Preprocess image: decode, crop ROI, and downscale if needed\n   */\n  async preprocess(\n    imageBuffer: Buffer,\n    roi: ROI,\n    maxWidth?: number,\n    options: PreprocessOptions = {},\n  ): Promise<PreprocessResult> {\n    try {\n      // Validate ROI\n      this.validateROI(roi);\n\n      // Load image and get metadata\n      const image = sharp(imageBuffer);\n      const metadata = await image.metadata();\n      const originalWidth = metadata.width || 0;\n      const originalHeight = metadata.height || 0;\n\n      if (originalWidth === 0 || originalHeight === 0) {\n        throw new Error('Invalid image dimensions: width or height is 0');\n      }\n\n      if (originalWidth < this.MIN_DIMENSION || originalHeight < this.MIN_DIMENSION) {\n        throw new Error(`Image too small: ${originalWidth}x${originalHeight} (min: ${this.MIN_DIMENSION}x${this.MIN_DIMENSION})`);\n      }\n\n      // Calculate absolute crop coordinates\n      const cropX = Math.floor(roi.x * originalWidth);\n      const cropY = Math.floor(roi.y * originalHeight);\n      const cropWidth = Math.floor(roi.width * originalWidth);\n      const cropHeight = Math.floor(roi.height * originalHeight);\n\n      // Ensure crop is within image bounds and has valid dimensions\n      const finalCropX = Math.max(0, Math.min(cropX, originalWidth - 1));\n      const finalCropY = Math.max(0, Math.min(cropY, originalHeight - 1));\n      const finalCropWidth = Math.max(this.MIN_DIMENSION, Math.min(cropWidth, originalWidth - finalCropX));\n      const finalCropHeight = Math.max(this.MIN_DIMENSION, Math.min(cropHeight, originalHeight - finalCropY));\n\n      // Crop ROI\n      let processedImage = image.clone().extract({\n        left: finalCropX,\n        top: finalCropY,\n        width: finalCropWidth,\n        height: finalCropHeight,\n      });\n\n      // Downscale if needed\n      let processedWidth = finalCropWidth;\n      let processedHeight = finalCropHeight;\n      let scaleFactor = 1;\n\n      if (maxWidth && finalCropWidth > maxWidth) {\n        scaleFactor = maxWidth / finalCropWidth;\n        processedWidth = maxWidth;\n        processedHeight = Math.max(this.MIN_DIMENSION, Math.floor(finalCropHeight * scaleFactor));\n        processedImage = processedImage.resize(processedWidth, processedHeight, {\n          kernel: sharp.kernel.lanczos3, // High quality downscale\n          withoutEnlargement: true,\n        });\n      }\n\n      // Optional: convert to grayscale (can improve OCR accuracy)\n      if (options.grayscale) {\n        processedImage = processedImage.grayscale();\n      }\n\n      // Optional: enhance contrast\n      if (options.enhanceContrast) {\n        processedImage = processedImage.normalize();\n      }\n\n      // Convert to PNG buffer for OCR (tesseract works best with PNG)\n      const processedBuffer = await processedImage.png().toBuffer();\n\n      // TODO: Uncomment this when debugging\n      // const processingTime = Date.now() - startTime;\n      // this.logger.debug(\n      //   `Preprocessing: ${processingTime}ms | ` +\n      //   `Original: ${originalWidth}x${originalHeight} | ` +\n      //   `ROI: ${finalCropX},${finalCropY} ${finalCropWidth}x${finalCropHeight} | ` +\n      //   `Processed: ${processedWidth}x${processedHeight} (scale: ${scaleFactor.toFixed(2)})`,\n      // );\n\n      return {\n        buffer: processedBuffer,\n        metadata: {\n          originalWidth,\n          originalHeight,\n          processedWidth,\n          processedHeight,\n          scaleFactor,\n        },\n      };\n    } catch (error) {\n      this.logger.error(`Image preprocessing error: ${error.message}`, error.stack);\n      throw error;\n    }\n  }\n}\n\n","module.exports = require(\"sharp\");","import { Injectable, Logger } from '@nestjs/common';\nimport { readFile } from 'fs/promises';\nimport { OCRWorkerPoolService } from './ocr-worker-pool.service';\nimport { ImagePreprocessingService, ROI, PreprocessOptions } from './image-preprocessing.service';\nimport { normalizeBankAccountName } from '@/common/utils/string';\nimport { config, IConfig } from '@/common/constants/config';\n\n// Re-export types for consumers\nexport { ROI, PreprocessOptions } from './image-preprocessing.service';\n\nexport interface OCRResult {\n  text: string;\n  confidence: number;\n  processingTime: number;\n  timingBreakdown: {\n    decodeImage: number;\n    preprocess: number;\n    ocrRecognize: number;\n    postprocess: number;\n  };\n}\n\nexport type FieldType = 'singleLine' | 'block' | 'full';\n\n// Default ROI config for fallback\nconst DEFAULT_ROI_CONFIG = {\n  crop: { x: 0, y: 0, width: 1, height: 1 },\n  psm: 6,\n  charWhitelist: undefined,\n  maxWidth: 1200,\n};\n\n@Injectable()\nexport class OCRService {\n  private readonly logger = new Logger(OCRService.name);\n  private readonly ocrConfig: Pick<IConfig['ocr'], 'poolSize' | 'lang' | 'rois'>;\n\n  constructor(\n    private readonly workerPoolService: OCRWorkerPoolService,\n    private readonly imagePreprocessingService: ImagePreprocessingService,\n  ) {\n    this.ocrConfig = {\n      poolSize: config.ocr.poolSize,\n      lang: config.ocr.lang,\n      rois: {\n        full: DEFAULT_ROI_CONFIG,\n        singleLine: { ...DEFAULT_ROI_CONFIG, psm: 7 },\n        block: { ...DEFAULT_ROI_CONFIG, psm: 6 },\n      },\n    };\n  }\n\n  /**\n   * Validate and normalize ROI values\n   */\n  private validateROI(roi: ROI): ROI {\n    return {\n      x: Math.max(0, Math.min(1, roi.x || 0)),\n      y: Math.max(0, Math.min(1, roi.y || 0)),\n      width: Math.max(0.01, Math.min(1, roi.width || 1)),\n      height: Math.max(0.01, Math.min(1, roi.height || 1)),\n    };\n  }\n\n  /**\n   * Get ROI config for a field type with proper fallback\n   */\n  private getROIConfig(fieldType: FieldType) {\n    const config = this.ocrConfig.rois?.[fieldType]\n      || this.ocrConfig.rois?.full\n      || DEFAULT_ROI_CONFIG;\n\n    return {\n      crop: config.crop || DEFAULT_ROI_CONFIG.crop,\n      psm: config.psm ?? DEFAULT_ROI_CONFIG.psm,\n      charWhitelist: config.charWhitelist,\n      maxWidth: config.maxWidth ?? DEFAULT_ROI_CONFIG.maxWidth,\n    };\n  }\n\n  /**\n   * Recognize text from image file path\n   */\n  async recognizeFromFile(\n    imagePath: string,\n    options: {\n      fieldType?: FieldType;\n      customROI?: ROI;\n      language?: string;\n      /** Image preprocessing options */\n      preprocess?: PreprocessOptions;\n    } = {},\n  ): Promise<OCRResult | null> {\n    const totalStartTime = Date.now();\n    const timingBreakdown = {\n      decodeImage: 0,\n      preprocess: 0,\n      ocrRecognize: 0,\n      postprocess: 0,\n    };\n\n    try {\n      // Step 1: Decode/Load image\n      const decodeStart = Date.now();\n      const imageBuffer = await readFile(imagePath);\n      timingBreakdown.decodeImage = Date.now() - decodeStart;\n\n      // Step 2: Get ROI config based on field type\n      const fieldType = options.fieldType || 'full';\n      const roiConfig = this.getROIConfig(fieldType);\n      const roi = this.validateROI(options.customROI || roiConfig.crop);\n\n      // Step 3: Crop and preprocess\n      const preprocessStart = Date.now();\n      const preprocessResult = await this.imagePreprocessingService.preprocess(\n        imageBuffer,\n        roi,\n        roiConfig.maxWidth,\n        options.preprocess, // Pass preprocessing options\n      );\n      timingBreakdown.preprocess = Date.now() - preprocessStart;\n\n      // Step 4: OCR recognize\n      const ocrStart = Date.now();\n      const ocrResult = await this.workerPoolService.recognize(\n        preprocessResult.buffer,\n        {\n          psm: roiConfig.psm,\n          charWhitelist: roiConfig.charWhitelist,\n        },\n      );\n      timingBreakdown.ocrRecognize = Date.now() - ocrStart;\n\n      // Step 5: Postprocess (trim and normalize)\n      const postprocessStart = Date.now();\n      const processedText = this.postprocessText(ocrResult.text);\n      timingBreakdown.postprocess = Date.now() - postprocessStart;\n\n      const totalProcessingTime = Date.now() - totalStartTime;\n\n      // Log timing breakdown\n      this.logTimingBreakdown(\n        imagePath,\n        fieldType,\n        totalProcessingTime,\n        timingBreakdown,\n        ocrResult.confidence,\n      );\n\n      return {\n        text: processedText,\n        confidence: ocrResult.confidence,\n        processingTime: totalProcessingTime,\n        timingBreakdown,\n      };\n    } catch (error) {\n      this.logger.error(`OCR error for ${imagePath}: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n  /**\n   * Recognize text from image buffer\n   */\n  async recognizeFromBuffer(\n    imageBuffer: Buffer,\n    options: {\n      fieldType?: FieldType;\n      customROI?: ROI;\n      language?: string;\n      /** Image preprocessing options */\n      preprocess?: PreprocessOptions;\n    } = {},\n  ): Promise<OCRResult | null> {\n    const totalStartTime = Date.now();\n    const timingBreakdown = {\n      decodeImage: 0,\n      preprocess: 0,\n      ocrRecognize: 0,\n      postprocess: 0,\n    };\n\n    try {\n      // Step 1: Image is already decoded (buffer provided)\n      timingBreakdown.decodeImage = 0;\n\n      // Step 2: Get ROI config based on field type\n      const fieldType = options.fieldType || 'full';\n      const roiConfig = this.getROIConfig(fieldType);\n      const roi = this.validateROI(options.customROI || roiConfig.crop);\n\n      // Step 3: Crop and preprocess\n      const preprocessStart = Date.now();\n      const preprocessResult = await this.imagePreprocessingService.preprocess(\n        imageBuffer,\n        roi,\n        roiConfig.maxWidth,\n        options.preprocess, // Pass preprocessing options\n      );\n      timingBreakdown.preprocess = Date.now() - preprocessStart;\n\n      // Step 4: OCR recognize\n      const ocrStart = Date.now();\n      const ocrResult = await this.workerPoolService.recognize(\n        preprocessResult.buffer,\n        {\n          psm: roiConfig.psm,\n          charWhitelist: roiConfig.charWhitelist,\n        },\n      );\n      timingBreakdown.ocrRecognize = Date.now() - ocrStart;\n\n      // Step 5: Postprocess\n      const postprocessStart = Date.now();\n      const processedText = this.postprocessText(ocrResult.text);\n      timingBreakdown.postprocess = Date.now() - postprocessStart;\n\n      const totalProcessingTime = Date.now() - totalStartTime;\n\n      // Log timing breakdown\n      this.logTimingBreakdown(\n        'buffer',\n        fieldType,\n        totalProcessingTime,\n        timingBreakdown,\n        ocrResult.confidence,\n      );\n\n      return {\n        text: processedText,\n        confidence: ocrResult.confidence,\n        processingTime: totalProcessingTime,\n        timingBreakdown,\n      };\n    } catch (error) {\n      this.logger.error(`OCR error from buffer: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n  /**\n   * Fast screen OCR - search for specific texts\n   */\n  async fastScreenOCR(\n    imagePath: string,\n    searchTexts: string[],\n    options: {\n      fieldType?: FieldType;\n      customROI?: ROI;\n      preprocess?: PreprocessOptions;\n    } = {},\n  ): Promise<{\n    found: boolean;\n    matchedTexts: string[];\n    result: OCRResult | null;\n  }> {\n    const result = await this.recognizeFromFile(imagePath, {\n      fieldType: options.fieldType || 'full',\n      customROI: options.customROI,\n      preprocess: options.preprocess,\n    });\n\n    if (!result || !result.text) {\n      return {\n        found: false,\n        matchedTexts: [],\n        result,\n      };\n    }\n\n    const normalizedText = normalizeBankAccountName(result.text);\n    const matchedTexts = searchTexts.filter((searchText) =>\n      normalizedText.includes(normalizeBankAccountName(searchText)),\n    );\n\n    return {\n      found: matchedTexts.length > 0,\n      matchedTexts,\n      result,\n    };\n  }\n\n  /**\n   * Postprocess text: trim, normalize whitespace\n   */\n  private postprocessText(text: string): string {\n    return text\n      .trim()\n      .replace(/\\s+/g, ' ') // Normalize multiple spaces to single space\n      .replace(/\\n{3,}/g, '\\n\\n'); // Normalize multiple newlines\n  }\n\n  /**\n   * Log detailed timing breakdown\n   */\n  private logTimingBreakdown(\n    imageSource: string,\n    fieldType: FieldType,\n    totalTime: number,\n    breakdown: {\n      decodeImage: number;\n      preprocess: number;\n      ocrRecognize: number;\n      postprocess: number;\n    },\n    confidence: number,\n  ): void {\n    const breakdownStr = [\n      `decode=${breakdown.decodeImage}ms`,\n      `preprocess=${breakdown.preprocess}ms`,\n      `ocr=${breakdown.ocrRecognize}ms`,\n      `postprocess=${breakdown.postprocess}ms`,\n    ].join(' | ');\n\n    // TODO: Uncomment this when debugging\n    // this.logger.log(\n    //   `OCR [${fieldType}] ${imageSource}: ` +\n    //   `total=${totalTime}ms (${breakdownStr}) | ` +\n    //   `confidence=${confidence.toFixed(2)}%`,\n    // );\n\n    // Warn if total time exceeds target (1s for p95)\n    if (totalTime > 1000) {\n      this.logger.warn(\n        ` OCR latency exceeded target: ${totalTime}ms > 1000ms (p95 target)`,\n      );\n    }\n  }\n}\n\n","import { Injectable, Logger, OnModuleInit, OnModuleDestroy } from '@nestjs/common';\nimport * as Tesseract from 'tesseract.js';\nimport { config } from '@/common/constants/config';\n\ninterface WorkerInfo {\n  id: number;\n  worker: Tesseract.Worker;\n  inUse: boolean;\n  lastUsed: number;\n}\n\ninterface PendingRequest {\n  resolve: (worker: WorkerInfo) => void;\n  reject: (error: Error) => void;\n  timeout: NodeJS.Timeout;\n}\n\n@Injectable()\nexport class OCRWorkerPoolService implements OnModuleInit, OnModuleDestroy {\n  private readonly logger = new Logger('OCRWorkerPoolService');\n  private readonly pool: WorkerInfo[] = [];\n  private readonly waitingQueue: PendingRequest[] = [];\n  private readonly poolSize: number;\n  private readonly lang: string;\n  private readonly maxWaitTime = 5000; // 5 seconds max wait\n  private readonly maxPoolSize = 10; // Maximum workers to prevent resource exhaustion\n  private isInitializing = false;\n  private isDestroyed = false;\n  private isAcquiring = false; // Mutex flag for atomic acquisition\n  private initializationPromise: Promise<void> | null = null;\n\n  constructor() {\n    // Validate pool size: minimum 1, maximum 10\n    this.poolSize = Math.max(1, Math.min(config.ocr.poolSize, this.maxPoolSize));\n    this.lang = config.ocr.lang;\n\n    if (config.ocr.poolSize > this.maxPoolSize) {\n      this.logger.warn(\n        `OCR_POOL_SIZE (${config.ocr.poolSize}) exceeds maximum (${this.maxPoolSize}). Using ${this.maxPoolSize}.`\n      );\n    }\n  }\n\n  async onModuleInit(): Promise<void> {\n    await this.warmPool();\n  }\n\n  async onModuleDestroy(): Promise<void> {\n    this.isDestroyed = true;\n    // Reject all pending requests\n    this.rejectAllPending(new Error('OCR service is shutting down'));\n    await this.terminateAll();\n  }\n\n  /**\n   * Warm up worker pool during module initialization\n   */\n  private async warmPool(): Promise<void> {\n    if (this.isInitializing) {\n      return this.initializationPromise || Promise.resolve();\n    }\n\n    this.isInitializing = true;\n    this.initializationPromise = this.doWarmPool();\n\n    try {\n      await this.initializationPromise;\n    } finally {\n      this.isInitializing = false;\n    }\n  }\n\n  private async doWarmPool(): Promise<void> {\n    const startTime = Date.now();\n    this.logger.log(`Warming up OCR worker pool (size: ${this.poolSize}, lang: ${this.lang})...`);\n\n    const initPromises = Array.from({ length: this.poolSize }, (_, index) =>\n      this.createWorker(index),\n    );\n\n    try {\n      await Promise.all(initPromises);\n      const warmupTime = Date.now() - startTime;\n      this.logger.log(\n        `OCR worker pool warmed up successfully in ${warmupTime}ms. Pool size: ${this.pool.length}`,\n      );\n    } catch (error) {\n      this.logger.error(`Failed to warm up worker pool: ${error.message}`, error.stack);\n      // Clean up partially initialized workers\n      await this.terminateAll();\n      throw error;\n    }\n  }\n\n  /**\n   * Create and initialize a single worker\n   */\n  private async createWorker(index: number): Promise<void> {\n    try {\n      const worker = await Tesseract.createWorker(\n        this.lang,\n        1,\n        {\n          logger: (m: any) => {\n            // Only log errors\n            if (m.status === 'error') {\n              this.logger.error(`Tesseract worker ${index} error: ${m.message}`);\n            }\n          },\n        },\n      );\n\n      this.pool.push({\n        id: index,\n        worker,\n        inUse: false,\n        lastUsed: Date.now(),\n      });\n\n      this.logger.debug(`Worker ${index} created successfully`);\n    } catch (error) {\n      this.logger.error(`Failed to create worker ${index}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Acquire a worker from the pool with proper queue management\n   */\n  private async acquireWorker(): Promise<WorkerInfo> {\n    if (this.isDestroyed) {\n      throw new Error('OCR service is destroyed');\n    }\n\n    // Wait for pool initialization if still warming up\n    if (this.isInitializing && this.initializationPromise) {\n      await this.initializationPromise;\n    }\n\n    // Try to find an available worker (atomic check and set)\n    const workerInfo = this.tryAcquireFromPool();\n    if (workerInfo) {\n      return workerInfo;\n    }\n\n    // No available worker, add to waiting queue\n    return this.waitForWorker();\n  }\n\n  /**\n   * Try to acquire a worker from pool with mutex lock\n   * This ensures atomic acquisition in concurrent scenarios\n   */\n  private tryAcquireFromPool(): WorkerInfo | null {\n    // Check mutex - if another operation is in progress, return null\n    if (this.isAcquiring) {\n      return null;\n    }\n\n    // Set mutex\n    this.isAcquiring = true;\n\n    try {\n      for (const workerInfo of this.pool) {\n        if (!workerInfo.inUse) {\n          workerInfo.inUse = true;\n          workerInfo.lastUsed = Date.now();\n          return workerInfo;\n        }\n      }\n      return null;\n    } finally {\n      // Release mutex\n      this.isAcquiring = false;\n    }\n  }\n\n  /**\n   * Wait for a worker to become available\n   */\n  private waitForWorker(): Promise<WorkerInfo> {\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        // Remove from queue\n        const index = this.waitingQueue.findIndex(p => p.resolve === resolve);\n        if (index !== -1) {\n          this.waitingQueue.splice(index, 1);\n        }\n\n        // Create temporary worker as fallback\n        this.logger.warn('Timeout waiting for worker, creating temporary worker');\n        this.createTemporaryWorker()\n          .then(resolve)\n          .catch(reject);\n      }, this.maxWaitTime);\n\n      this.waitingQueue.push({ resolve, reject, timeout });\n    });\n  }\n\n  /**\n   * Create a temporary worker (not in pool)\n   */\n  private async createTemporaryWorker(): Promise<WorkerInfo> {\n    const tempWorker = await Tesseract.createWorker(this.lang, 1, {\n      logger: () => { },\n    });\n    return {\n      id: -1, // Negative ID indicates temporary\n      worker: tempWorker,\n      inUse: true,\n      lastUsed: Date.now(),\n    };\n  }\n\n  /**\n   * Release a worker back to the pool\n   */\n  private releaseWorker(workerInfo: WorkerInfo): void {\n    // Check if there are waiting requests\n    if (this.waitingQueue.length > 0) {\n      const pending = this.waitingQueue.shift()!;\n      clearTimeout(pending.timeout);\n      workerInfo.lastUsed = Date.now();\n      // Worker stays inUse, just transfer to next requester\n      pending.resolve(workerInfo);\n    } else {\n      workerInfo.inUse = false;\n      workerInfo.lastUsed = Date.now();\n    }\n  }\n\n  /**\n   * Reject all pending requests\n   */\n  private rejectAllPending(error: Error): void {\n    while (this.waitingQueue.length > 0) {\n      const pending = this.waitingQueue.shift()!;\n      clearTimeout(pending.timeout);\n      pending.reject(error);\n    }\n  }\n\n  /**\n   * Get a worker and execute OCR with automatic cleanup\n   */\n  async recognize(\n    imageBuffer: Buffer,\n    options: {\n      psm?: number;\n      charWhitelist?: string;\n    } = {},\n  ): Promise<{ text: string; confidence: number }> {\n    const workerInfo = await this.acquireWorker();\n    const isTemporary = workerInfo.id < 0;\n\n    const { psm, charWhitelist } = options;\n    const hadCustomParams = psm !== undefined || !!charWhitelist;\n\n    try {\n      // Set parameters in one call if possible\n      const params: Record<string, any> = {};\n      if (psm !== undefined) {\n        params.tessedit_pageseg_mode = psm;\n      }\n      if (charWhitelist) {\n        params.tessedit_char_whitelist = charWhitelist;\n      }\n\n      if (Object.keys(params).length > 0) {\n        await workerInfo.worker.setParameters(params);\n      }\n\n      // Perform OCR\n      const { data } = await workerInfo.worker.recognize(imageBuffer);\n\n      return {\n        text: data.text,\n        confidence: data.confidence,\n      };\n    } finally {\n      if (isTemporary) {\n        // Terminate temporary worker immediately\n        try {\n          await workerInfo.worker.terminate();\n        } catch (error) {\n          this.logger.warn(`Failed to terminate temporary worker: ${error.message}`);\n        }\n      } else {\n        // Reset worker parameters if we changed them\n        if (hadCustomParams) {\n          try {\n            await workerInfo.worker.setParameters({\n              tessedit_pageseg_mode: 6 as any, // Reset to default PSM 6 (SINGLE_BLOCK)\n              tessedit_char_whitelist: '', // Clear whitelist\n            });\n          } catch (error) {\n            this.logger.warn(`Failed to reset worker parameters: ${error.message}`);\n          }\n        }\n        this.releaseWorker(workerInfo);\n      }\n    }\n  }\n\n  /**\n   * Get pool statistics for monitoring\n   */\n  getPoolStats(): { total: number; inUse: number; waiting: number } {\n    return {\n      total: this.pool.length,\n      inUse: this.pool.filter(w => w.inUse).length,\n      waiting: this.waitingQueue.length,\n    };\n  }\n\n  /**\n   * Terminate all workers in the pool\n   */\n  private async terminateAll(): Promise<void> {\n    if (this.pool.length === 0) {\n      return;\n    }\n\n    this.logger.log(`Terminating ${this.pool.length} OCR workers...`);\n\n    const terminatePromises = this.pool.map((workerInfo) =>\n      workerInfo.worker\n        .terminate()\n        .then(() => {\n          this.logger.debug(`Worker ${workerInfo.id} terminated`);\n        })\n        .catch((error) => {\n          this.logger.error(`Error terminating worker ${workerInfo.id}: ${error.message}`);\n        }),\n    );\n\n    await Promise.all(terminatePromises);\n    this.pool.length = 0;\n    this.logger.log('All OCR workers terminated');\n  }\n}\n\n","module.exports = require(\"tesseract.js\");","export const removeVietnameseTones = (input: string): string => {\n  if (!input) {\n\t\treturn '';\n\t}\n\n  return input\n    // Normalize to Unicode NFD form\n    .normalize('NFD')\n    // Remove all diacritical marks\n    .replace(/[\\u0300-\\u036f]/g, '')\n    // Handle special Vietnamese characters\n    .replace(//g, 'd')\n    .replace(//g, 'D');\n}\n\nexport const normalizeBankAccountName = (name: string) => {\n\tif (!name) {\n\t\treturn '';\n\t}\n\n\tconst transformed = removeVietnameseTones(name);\n\t\n\treturn transformed.trim().replace(/ /g, '').toLocaleUpperCase();\n}","import { Injectable, Logger } from '@nestjs/common';\nimport * as sharp from 'sharp';\nimport { ROI } from './image-preprocessing.service';\n\nexport interface RGB {\n  r: number;\n  g: number;\n  b: number;\n}\n\nexport interface BlueButtonThreshold {\n  /** Red must be below this (blue has low red). Default: 150 */\n  maxR?: number;\n  /** Green must be above this. Default: 80 */\n  minG?: number;\n  /** Blue must be above this. Default: 120 */\n  minB?: number;\n  /** Blue should dominate: B > R. Default: true */\n  blueDominates?: boolean;\n}\n\nconst DEFAULT_BLUE_THRESHOLD: Required<BlueButtonThreshold> = {\n  maxR: 150,\n  minG: 80,\n  minB: 120,\n  blueDominates: true,\n};\n\n@Injectable()\nexport class ColorDetectionService {\n  private readonly logger = new Logger(ColorDetectionService.name);\n\n  /**\n   * Get mean RGB color of a region from image file\n   */\n  async getMeanColor(imagePath: string, roi: ROI): Promise<RGB | null> {\n    try {\n      const image = sharp(imagePath);\n      const metadata = await image.metadata();\n      const width = metadata.width || 0;\n      const height = metadata.height || 0;\n\n      if (width === 0 || height === 0) return null;\n\n      const cropX = Math.floor(roi.x * width);\n      const cropY = Math.floor(roi.y * height);\n      const cropWidth = Math.max(10, Math.floor(roi.width * width));\n      const cropHeight = Math.max(10, Math.floor(roi.height * height));\n\n      const { data, info } = await image\n        .extract({\n          left: Math.min(cropX, width - cropWidth),\n          top: Math.min(cropY, height - cropHeight),\n          width: cropWidth,\n          height: cropHeight,\n        })\n        .raw()\n        .toBuffer({ resolveWithObject: true });\n\n      const channels = info.channels;\n      let r = 0;\n      let g = 0;\n      let b = 0;\n      let count = 0;\n\n      for (let i = 0; i < data.length; i += channels) {\n        r += data[i];\n        g += data[i + 1];\n        b += data[i + 2];\n        count++;\n      }\n\n      if (count === 0) return null;\n\n      return {\n        r: Math.round(r / count),\n        g: Math.round(g / count),\n        b: Math.round(b / count),\n      };\n    } catch (error) {\n      this.logger.error(`getMeanColor error: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n  /**\n   * Check if color matches blue button criteria\n   */\n  isBlue(color: RGB, threshold: BlueButtonThreshold = {}): boolean {\n    const t = { ...DEFAULT_BLUE_THRESHOLD, ...threshold };\n    if (color.r > t.maxR) return false;\n    if (color.g < t.minG) return false;\n    if (color.b < t.minB) return false;\n    if (t.blueDominates && color.b <= color.r) return false;\n    return true;\n  }\n\n  /**\n   * Check if image region is blue (convenience method)\n   */\n  async isRegionBlue(\n    imagePath: string,\n    roi: ROI,\n    threshold?: BlueButtonThreshold,\n  ): Promise<boolean> {\n    const color = await this.getMeanColor(imagePath, roi);\n    if (!color) {\n      this.logger.debug(`[ColorDetection] getMeanColor returned null`);\n      return false;\n    }\n    const result = this.isBlue(color, threshold);\n    this.logger.debug(\n      `[ColorDetection] ROI mean RGB: R=${color.r} G=${color.g} B=${color.b} => isBlue=${result}`,\n    );\n    return result;\n  }\n}\n","/**\n * Error types for withdrawal processing\n */\nexport enum ErrorType {\n  TEMPORARY = 'TEMPORARY',    // C th retry (session, network, device busy). Ch : Li ny ch bn ra trc khi thc hin transfer\n  PERMANENT = 'PERMANENT', // Khng nn retry (invalid data, insufficient funds)\n  FORCE_LOGIN_AND_REQUEUE = 'FORCE_LOGIN_AND_REQUEUE', // Force login again, and requeue the job\n  FORCE_LOGIN_NO_REQUEUE = 'FORCE_LOGIN_NO_REQUEUE', // Force login again, but do not requeue the job\n  NO_BILL_AFTER_OTP = 'NO_BILL_AFTER_OTP', // No bill image found after OTP\n}\n\n/**\n * Custom error for withdrawal processing with error type classification\n */\nexport class WithdrawalProcessingError extends Error {\n  constructor(\n    message: string,\n    public readonly errorType: ErrorType,\n    public readonly context: string = ''\n  ) {\n    super(message);\n    this.name = 'WithdrawalProcessingError';\n\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\n","import { Logger } from '@nestjs/common';\nimport { DeviceService } from '../../device/device.service';\nimport { IAnalyzeTransferBillResult, IBankService } from '../interfaces/bank-service.interface';\nimport { Withdrawal } from '../../../common/interfaces/withdrawal.interface';\nimport { ICaptureScreenOptions, IHCSwipeOptions, IPandaSwipeOptions, IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\nimport { existsSync, mkdirSync } from 'fs';\nimport { mkdir, readdir, stat, unlink, rm, readFile } from 'fs/promises';\nimport { join, resolve } from 'path';\nimport { OCRService } from '@/modules/ocr/services/ocr.service';\nimport { ImagePreprocessingService, ROI } from '@/modules/ocr/services/image-preprocessing.service';\nimport { toFile as QRCodeToFile } from 'qrcode';\nimport { DeviceConfig } from '@/modules/device/dto/device-config.dto';\nimport { ANALYZE_BILL_ROI } from '../constants/analyze-bill';\nimport { normalizeBankAccountName, removeVietnameseTones } from '@/common/utils/string';\n\n/**\n * Screen verification configuration\n */\nexport interface ScreenVerificationConfig {\n  // Text markers  identify mn hnh (dng OCR)\n  expectedTexts?: string[];\n  // Text markers khng c xut hin ( verify  ri mn hnh c)\n  unexpectedTexts?: string[];\n  // Timeout ti a  i mn hnh xut hin (ms)\n  timeout?: number;\n  // Polling interval - check mi X ms\n  pollInterval?: number;\n  // ROI  ch OCR mt vng c th (optional - nu khng c s OCR full screen)\n  roi?: ROI;\n  // Field type cho OCR (singleLine, block, full)\n  fieldType?: 'singleLine' | 'block' | 'full';\n  // Preprocessing options\n  preprocess?: {\n    grayscale?: boolean;\n    enhanceContrast?: boolean;\n  };\n}\n\n/**\n * Base abstract class for all bank services\n * Provides common functionality and enforces interface implementation\n */\nexport abstract class BaseBankService implements IBankService {\n  protected readonly logger: Logger;\n  protected abstract readonly BANK_CODE: string;\n  protected abstract BUNDLE_ID: string;\n\n  // Static flags  trnh race condition khi nhiu class cng khi to\n  protected readonly baseTransactionFolderPath = 'C:/EasyData';\n  protected readonly baseTransactionExecutionFolder = 'C:/EasyTrx';\n  protected readonly baseBalanceFolder = 'C:/EasyBalance';\n  private static folderCreationInProgress = false;\n  private static folderCreated = false;\n\n  constructor(\n    protected readonly wsService: IWebSocketService,\n    protected readonly deviceService: DeviceService,\n    protected ocrService: OCRService,\n    protected readonly imagePreprocessingService: ImagePreprocessingService,\n  ) {\n    this.logger = new Logger('BaseBankService');\n    BaseBankService.createTransactionFolder(this.baseTransactionFolderPath, this.logger);\n    BaseBankService.createTransactionFolder(this.baseTransactionExecutionFolder, this.logger);\n  }\n\n  /**\n   * Kim tra v to base folder nu cha tn ti\n   * S dng static method  trnh race condition khi nhiu class cng khi to\n   */\n  private static createTransactionFolder(folderPath: string, logger: Logger): void {\n    // Nu  to ri th khng cn lm g\n    if (BaseBankService.folderCreated) {\n      return;\n    }\n\n    // Nu ang c process khc ang to folder, i mt cht ri check li\n    if (BaseBankService.folderCreationInProgress) {\n      // i ti a 100ms, check mi 10ms\n      let attempts = 0;\n      const maxAttempts = 10;\n      while (BaseBankService.folderCreationInProgress && attempts < maxAttempts) {\n        attempts++;\n        // Synchronous wait (ch dng trong constructor, khng block event loop lu)\n        const start = Date.now();\n        while (Date.now() - start < 10) {\n          // Busy wait 10ms\n        }\n      }\n      // Sau khi i, check li xem  to cha\n      if (BaseBankService.folderCreated || existsSync(folderPath)) {\n        BaseBankService.folderCreated = true;\n        return;\n      }\n    }\n\n    try {\n      // nh du ang to folder\n      BaseBankService.folderCreationInProgress = true;\n\n      // Kim tra li mt ln na (double-check pattern)\n      if (!existsSync(folderPath)) {\n        mkdirSync(folderPath, { recursive: true });\n        logger.log(`Created base folder: ${folderPath}`);\n      } else {\n        logger.debug(`Base folder already exists: ${folderPath}`);\n      }\n\n      // nh du  to xong\n      BaseBankService.folderCreated = true;\n    } catch (error) {\n      // Nu li l \"folder already exists\" th khng sao (c th xy ra trong race condition)\n      if ((error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        logger.error(`Failed to create base folder ${folderPath}: ${error.message}`);\n      } else {\n        // Folder  tn ti (c th do process khc  to), nh du l  to\n        BaseBankService.folderCreated = true;\n        logger.debug(`Base folder already exists (created by another process): ${folderPath}`);\n      }\n    } finally {\n      // Lun reset flag\n      BaseBankService.folderCreationInProgress = false;\n    }\n  }\n\n  getBankCode(): string {\n    return this.BANK_CODE;\n  }\n\n  async killApp(deviceId: string): Promise<void> {\n    this.logger.log(`[${deviceId}] Killing ${this.BANK_CODE} app`);\n    await this.wsService.killApp(deviceId, this.BUNDLE_ID);\n  }\n\n  async cleanScreenshot(deviceId: string): Promise<void> {\n    await this.wsService.cleanScreenshot(deviceId);\n  }\n\n  /**\n   * Helper method for clicking with transition time and logging\n   */\n  async clickWithTransition(\n    deviceId: string,\n    x: number,\n    y: number,\n    transitionTime: number,\n    log: string = ''\n  ): Promise<void> {\n    await this.wsService.click(deviceId, x, y, 0.2);\n    if (log) {\n      this.logger.log(log);\n    }\n    // Wait for screen transition\n    await sleep(transitionTime);\n  }\n\n  // Helper function  cleanup folder\n  protected cleanupFolder = async (dir: string, deviceId: string) => {\n    if (existsSync(dir)) {\n      try {\n        await rm(dir, { recursive: true, force: true });\n        // this.logger.debug(`[${deviceId}] Cleaned up temp folder: ${tempDir}`);\n      } catch (cleanupError) {\n        // Ignore cleanup errors\n        this.logger.debug(`[${deviceId}] Failed to cleanup folder: ${cleanupError.message}`);\n      }\n    }\n  };\n\n  /**\n   * Verify screen state bng cch capture v check text qua Local OCR\n   * Flow:\n   * 1. Capture screen  lu vo folder tm (unique mi ln chy)\n   * 2. Local OCR c text t file (nhanh, khng cn API)\n   * 3. So snh vi expected/unexpected texts\n   * 4. Xa c folder tm sau khi OCR\n   * 5. Return true nu match, false nu khng\n   */\n  protected async verifyScreenState(\n    deviceId: string,\n    config: ScreenVerificationConfig\n  ): Promise<boolean> {\n    const {\n      expectedTexts = [],\n      unexpectedTexts = [],\n      timeout = 30000,\n      pollInterval = 500,\n      roi,\n      fieldType = 'full',\n      preprocess,\n    } = config;\n\n    const startTime = Date.now();\n    let attemptCount = 0;\n\n    // To folder tm cho mi ln verifyScreenState (1 device ch lm 1 action nn khng c conflict)\n    const tempDir = join(this.baseTransactionExecutionFolder, `scan_${deviceId}`);\n\n    // Log vi ROI info nu c\n    const roiInfo = roi\n      ? `ROI: x=${roi.x}, y=${roi.y}, w=${roi.width}, h=${roi.height}`\n      : 'Full screen';\n\n    this.logger.debug(\n      `[${deviceId}] Starting screen verification. ` +\n      `Expected: [${expectedTexts.join(', ')}], ` +\n      `Unexpected: [${unexpectedTexts.join(', ')}], ` +\n      `${roiInfo}, ` +\n      `Timeout: ${timeout}ms, Poll: ${pollInterval}ms`\n    );\n\n    try {\n      // Xa folder c nu tn ti (t ln chy trc b crash/timeout)\n      await this.cleanupFolder(tempDir, deviceId);\n\n      // To folder tm mi\n      await mkdir(tempDir, { recursive: true });\n\n      while (Date.now() - startTime < timeout) {\n        attemptCount++;\n        let tempScreenshotPath: string | null = null;\n\n        try {\n\n          // Ghi nhn thi im trc khi capture  ch ly file mi\n          const beforeCaptureTime = Date.now();\n\n          // Capture screen vo folder (file s c gen vi UUID.png)\n          await this.wsService.captureScreen(deviceId, {\n            folderPath: tempDir\n          });\n\n          // Bc 2: i v tm file mi nht (retry nhiu ln  m bo file c lu)\n          let latestFile: string | null = null;\n          const maxFileWaitAttempts = 5;\n          let fileWaitAttempt = 0;\n\n          while (fileWaitAttempt < maxFileWaitAttempts && !latestFile) {\n            fileWaitAttempt++;\n            await sleep(500); // i 500ms mi ln\n\n            try {\n              if (!existsSync(tempDir)) {\n                continue;\n              }\n\n              const files = await readdir(tempDir);\n              const pngFiles = files.filter(f => f.endsWith('.png'));\n\n              if (pngFiles.length === 0) {\n                continue; // Cha c file, i tip\n              }\n\n              // Tm file c mtime mi nht (ch ly file c to sau capture)\n              let latestMtime = 0;\n              const now = Date.now();\n              for (const file of pngFiles) {\n                const filePath = join(tempDir, file);\n                try {\n                  const fileStat = await stat(filePath);\n                  if (fileStat.size === 0) {\n                    continue;\n                  }\n\n                  // Ch ly file c to sau thi im capture\n                  if (fileStat.mtimeMs >= beforeCaptureTime - 2000) {\n                    if (fileStat.mtimeMs > latestMtime) {\n                      latestMtime = fileStat.mtimeMs;\n                      latestFile = filePath;\n                    }\n                  }\n                } catch (statError) {\n                  continue;\n                }\n              }\n            } catch (readdirError) {\n              // Folder cha tn ti hoc khng c c, i tip\n              continue;\n            }\n          }\n\n          if (!latestFile) {\n            // this.logger.debug(`[${deviceId}] No screenshot files found in folder after ${fileWaitAttempt} attempts, retrying capture...`);\n            await sleep(pollInterval);\n            continue;\n          }\n\n          tempScreenshotPath = latestFile;\n\n          // Bc 4: Gi OCR Service vi ROI nu c\n          const allSearchTexts = [...expectedTexts, ...unexpectedTexts];\n          const ocrResult = await this.ocrService.fastScreenOCR(\n            tempScreenshotPath,\n            allSearchTexts,\n            {\n              fieldType: roi ? 'singleLine' : fieldType,\n              customROI: roi,\n              preprocess: preprocess,\n            }\n          );\n\n          // Bc 5: X l kt qu OCR\n          if (!ocrResult || !ocrResult.found) {\n            await sleep(pollInterval);\n            continue;\n          }\n\n          // Bc 6: So snh vi expected texts - Check if expected texts are in matchedTexts\n          const hasExpectedTexts = expectedTexts.length === 0 || expectedTexts.some(text =>\n            ocrResult.matchedTexts.includes(text)\n          );\n\n          // Bc 7: Check unexpected texts (khng c xut hin)\n          const hasUnexpectedTexts = unexpectedTexts.some(text =>\n            ocrResult.matchedTexts.includes(text)\n          );\n\n          // Bc 8: Verify kt qu\n          if (hasExpectedTexts || hasUnexpectedTexts) {\n            // Xa folder khi success\n            await this.cleanupFolder(tempDir, deviceId);\n\n            const elapsed = Date.now() - startTime;\n            const ocrTime = ocrResult.result?.processingTime || 0;\n            const roiStr = roi ? ` (ROI: ${roi.x},${roi.y} ${roi.width}x${roi.height})` : '';\n            this.logger.log(\n              `[${deviceId}] Screen verified successfully after ${elapsed}ms ` +\n              `(${attemptCount} attempts, OCR: ${ocrTime}ms)${roiStr}. ` +\n              `Matched: [${ocrResult.matchedTexts.join(', ')}]`\n            );\n            return true;\n          }\n\n          // Cha ng mn hnh, log debug\n          if (attemptCount % 5 === 0) {\n            this.logger.debug(\n              `[${deviceId}] Screen not matched yet (attempt ${attemptCount}). ` +\n              `Matched texts: [${ocrResult.matchedTexts.join(', ')}], ` +\n              `Expected: [${expectedTexts.join(', ')}]`\n            );\n          }\n\n          // Xa file screenshot sau mi attempt  trnh tch t\n          if (tempScreenshotPath) {\n            try {\n              await unlink(tempScreenshotPath);\n            } catch {\n              // Ignore unlink errors\n            }\n          }\n\n          // i trc khi th li\n          await sleep(pollInterval);\n\n        } catch (error) {\n          this.logger.debug(\n            `[${deviceId}] Error verifying screen (attempt ${attemptCount}): ${error.message}, retrying...`\n          );\n          await sleep(pollInterval);\n        }\n      }\n\n      // Timeout - xa folder trc khi return\n      await this.cleanupFolder(tempDir, deviceId);\n\n      const elapsed = Date.now() - startTime;\n      this.logger.warn(\n        `[${deviceId}] Screen verification timeout after ${elapsed}ms ` +\n        `(${attemptCount} attempts). Expected: [${expectedTexts.join(', ')}]`\n      );\n      return false;\n\n    } catch (error) {\n      // Cleanup folder nu c li nghim trng\n      await this.cleanupFolder(tempDir, deviceId);\n      throw error;\n    }\n  }\n\n  async getLatestImagePath(\n    folderPath: string,\n    timeout: number = 10000,\n    pollInterval: number = 500\n  ): Promise<string | null> {\n    if (!folderPath) {\n      this.logger.warn('Folder path is null or empty');\n      return null;\n    }\n\n    const startTime = Date.now();\n    let attemptCount = 0;\n\n    this.logger.debug(\n      `Scanning folder for bill image: ${folderPath}, timeout: ${timeout}ms, pollInterval: ${pollInterval}ms`\n    );\n\n    while (Date.now() - startTime < timeout) {\n      attemptCount++;\n\n      try {\n        // Kim tra th mc c tn ti khng\n        if (!existsSync(folderPath)) {\n          await sleep(pollInterval);\n          continue;\n        }\n\n        const files = await readdir(folderPath);\n\n        if (files.length === 0) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`No files found in folder: ${folderPath}, retrying... (attempt ${attemptCount})`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Ly thng tin tt c cc file\n        const filesWithStat = await Promise.all(\n          files.map(async file => {\n            try {\n              const fullPath = join(folderPath, file);\n              const s = await stat(fullPath);\n              return { fullPath, mtime: s.mtimeMs, size: s.size };\n            } catch (statError) {\n              // Skip files that can't be stat'd\n              return null;\n            }\n          })\n        );\n\n        // Lc cc file hp l (size > 0)\n        const validFiles = filesWithStat.filter(\n          (f): f is { fullPath: string; mtime: number; size: number } => \n            f !== null && f.size > 0\n        );\n\n        if (validFiles.length === 0) {\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Sp xp theo thi gian modified mi nht\n        validFiles.sort((a, b) => b.mtime - a.mtime);\n\n        const latestFile = validFiles[0].fullPath;\n        const elapsed = Date.now() - startTime;\n        this.logger.log(\n          `Found latest bill image: ${latestFile} after ${elapsed}ms (${attemptCount} attempts)`\n        );\n\n        return latestFile;\n      } catch (error) {\n        this.logger.debug(\n          `Error scanning folder ${folderPath} (attempt ${attemptCount}): ${error.message}, retrying...`\n        );\n        await sleep(pollInterval);\n      }\n    }\n\n    // Timeout - khng tm thy file\n    const elapsed = Date.now() - startTime;\n    this.logger.warn(\n      `Timeout scanning folder for bill image: ${folderPath} after ${elapsed}ms (${attemptCount} attempts)`\n    );\n    return null;\n  }\n\n  async detectScreenByHint(\n    deviceId: string,\n    screenHints: Array<{\n      name: string;\n      hint: string;\n      /** ROI cho hint ny; nu khng c th dng config.roi */\n      roi?: ROI;\n    }>,\n    config: Pick<ScreenVerificationConfig, 'timeout' | 'pollInterval' | 'roi' | 'preprocess'>\n  ): Promise<{\n    name: string;\n    hint: string;\n  } | null> {\n    const tempDir = join(this.baseTransactionExecutionFolder, `scan_${deviceId}`);\n    const screenHintProcessed = screenHints.map(screenHint => {\n      return {\n        name: screenHint.name,\n        hint: removeVietnameseTones(screenHint.hint),\n        roi: screenHint.roi,\n      };\n    });\n\n\n    const startTime = Date.now();\n    let attemptCount = 0\n    const { roi, timeout, pollInterval } = config;\n\n    // Log vi ROI info nu c\n    const roiInfo = roi\n      ? `ROI: x=${roi.x}, y=${roi.y}, w=${roi.width}, h=${roi.height}`\n      : 'Full screen';\n\n    this.logger.debug(\n      `[${deviceId}] Start detecting screen. ` +\n      `Screen: [${screenHints.map(screenHint => screenHint.name).join(' or ')}], ` +\n      `${roiInfo}, ` +\n      `Timeout: ${timeout}ms, Poll: ${pollInterval}ms`\n    );\n\n    try {\n      // Xa folder c nu tn ti (t ln chy trc b crash/timeout)\n      await this.cleanupFolder(tempDir, deviceId);\n\n      // To folder tm mi\n      await mkdir(tempDir, { recursive: true });\n\n      while (Date.now() - startTime < timeout) {\n        attemptCount++;\n        let tempScreenshotPath: string | null = null;\n\n        try {\n\n          // Ghi nhn thi im trc khi capture  ch ly file mi\n          const beforeCaptureTime = Date.now();\n\n          // Capture screen vo folder (file s c gen vi UUID.png)\n          await this.wsService.captureScreen(deviceId, {\n            folderPath: tempDir\n          });\n\n          // Bc 2: i v tm file mi nht (retry nhiu ln  m bo file c lu)\n          let latestFile: string | null = null;\n          const maxFileWaitAttempts = 5;\n          let fileWaitAttempt = 0;\n\n          while (fileWaitAttempt < maxFileWaitAttempts && !latestFile) {\n            fileWaitAttempt++;\n            await sleep(500); // i 500ms mi ln\n\n            try {\n              if (!existsSync(tempDir)) {\n                continue;\n              }\n\n              const files = await readdir(tempDir);\n              const pngFiles = files.filter(f => f.endsWith('.png'));\n\n              if (pngFiles.length === 0) {\n                continue; // Cha c file, i tip\n              }\n\n              // Tm file c mtime mi nht (ch ly file c to sau capture)\n              let latestMtime = 0;\n              for (const file of pngFiles) {\n                const filePath = join(tempDir, file);\n                try {\n                  const fileStat = await stat(filePath);\n                  if (fileStat.size === 0) {\n                    continue;\n                  }\n\n                  // Ch ly file c to sau thi im capture\n                  if (fileStat.mtimeMs >= beforeCaptureTime - 2000) {\n                    if (fileStat.mtimeMs > latestMtime) {\n                      latestMtime = fileStat.mtimeMs;\n                      latestFile = filePath;\n                    }\n                  }\n                } catch (statError) {\n                  continue;\n                }\n              }\n            } catch (readdirError) {\n              // Folder cha tn ti hoc khng c c, i tip\n              continue;\n            }\n          }\n\n          if (!latestFile) {\n            // this.logger.debug(`[${deviceId}] No screenshot files found in folder after ${fileWaitAttempt} attempts, retrying capture...`);\n            await sleep(pollInterval);\n            continue;\n          }\n\n          // Bc 4: Find screen hints (mi hint dng roi ca chnh n hoc config.roi)\n          const imageBuffer = await readFile(latestFile);\n\n          const defaultRoi: ROI = config.roi ?? {\n            x: 0,\n            y: 0,\n            width: 1,\n            height: 1,\n          };\n\n          let screenHintFound: (typeof screenHintProcessed)[number] | undefined;\n          for (const screenHint of screenHintProcessed) {\n            const effectiveRoi = screenHint.roi ?? defaultRoi;\n            const processedImage = await this.imagePreprocessingService.preprocess(\n              imageBuffer,\n              effectiveRoi,\n              undefined,\n              config.preprocess\n            );\n            const ocrResult = await this.ocrService.recognizeFromBuffer(processedImage.buffer);\n            if (!ocrResult.text) {\n              continue;\n            }\n            const normalizedText = removeVietnameseTones(ocrResult.text);\n            if (normalizedText.toLowerCase().includes(screenHint.hint.toLowerCase())) {\n              screenHintFound = screenHint;\n              break;\n            }\n          }\n\n          if (!screenHintFound) {\n            await sleep(pollInterval);\n            continue;\n          }\n\n          // Xa file screenshot sau mi attempt  trnh tch t\n          if (tempScreenshotPath) {\n            try {\n              await unlink(tempScreenshotPath);\n            } catch {\n              // Ignore unlink errors\n            }\n          }\n\n          return screenHintFound;\n\n        } catch (error) {\n          this.logger.debug(\n            `[${deviceId}] Error verifying screen (attempt ${attemptCount}): ${error.message}, retrying...`\n          );\n          await sleep(pollInterval);\n        }\n      }\n\n      // Timeout - xa folder trc khi return\n      await this.cleanupFolder(tempDir, deviceId);\n\n      const elapsed = Date.now() - startTime;\n      this.logger.warn(\n        `[${deviceId}] Screen verification timeout after ${elapsed}ms ` +\n        `(${attemptCount} attempts). Expected: Find [${screenHints.map(s => s.name).join(' or ')}],`\n      );\n\n      return null;\n\n    } catch (error) {\n      // Cleanup folder nu c li nghim trng\n      await this.cleanupFolder(tempDir, deviceId);\n      throw error;\n    }\n  }\n\n  /**\n   * Click v t ng verify mn hnh  chuyn\n   * Thay th cho clickWithTransition vi screen verification\n   */\n  protected async clickAndWaitForScreen(\n    deviceId: string,\n    x: number,\n    y: number,\n    screenConfig: ScreenVerificationConfig,\n    log?: string\n  ): Promise<boolean> {\n    // Click\n    await this.wsService.click(deviceId, x, y, 0.2);\n    if (log) {\n      this.logger.log(log);\n    }\n    \n    const verified = await this.verifyScreenState(deviceId, screenConfig);\n    \n    // TODO: Uncomment this when debugging\n    // this.logger.debug(`[${deviceId}] Screen verified after click at (${x}, ${y})`);\n    return verified\n  }\n\n  /**\n   * Swipe v t ng verify mn hnh  chuyn\n   * Retry ti a 3 ln nu khng detect c screen, mi ln timeout 1s\n   */\n  protected async swipeAndWaitForScreen(\n    deviceId: string,\n    swipeOptions: IHCSwipeOptions | IPandaSwipeOptions,\n    screenConfig: ScreenVerificationConfig,\n    log?: string\n  ): Promise<boolean> {\n    const maxRetries = 3;\n    const timeoutPerAttempt = 3000 // 1 second\n\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      // Swipe\n      await this.wsService.swipe(deviceId, swipeOptions);\n      await sleep(800);\n      if (log && attempt === 1) {\n        this.logger.log(log);\n      }\n\n      // Verify screen vi timeout 1s cho mi attempt\n      const verified = await this.verifyScreenState(deviceId, {\n        ...screenConfig,\n        timeout: timeoutPerAttempt,\n      });\n\n      if (verified) {\n        if (attempt > 1) {\n          this.logger.log(`[${deviceId}] Screen verified after ${attempt} swipe attempts`);\n        }\n        return true;\n      }\n\n      // Nu khng detect c, capture v OCR  log ra text c detect\n      try {\n        const tempDir = join(this.baseTransactionExecutionFolder, `scan_${deviceId}_debug`);\n\n        // Xa folder c trc khi to mi (trnh file c b ln)\n        if (existsSync(tempDir)) {\n          try {\n            await rm(tempDir, { recursive: true, force: true });\n          } catch { }\n        }\n\n        await mkdir(tempDir, { recursive: true });\n\n        const beforeCaptureTime = Date.now();\n        await this.wsService.captureScreen(deviceId, {\n          folderPath: tempDir\n        });\n\n        // i v tm file mi nht (retry  m bo file c lu)\n        let latestFile: string | null = null;\n        const maxFileWaitAttempts = 5;\n        let fileWaitAttempt = 0;\n\n        while (fileWaitAttempt < maxFileWaitAttempts && !latestFile) {\n          fileWaitAttempt++;\n          await sleep(500);\n\n          try {\n            if (!existsSync(tempDir)) {\n              continue;\n            }\n\n            const files = await readdir(tempDir);\n            const pngFiles = files.filter(f => f.endsWith('.png'));\n\n            if (pngFiles.length === 0) {\n              continue;\n            }\n\n            let latestMtime = 0;\n            for (const file of pngFiles) {\n              const filePath = join(tempDir, file);\n              try {\n                const fileStat = await stat(filePath);\n                if (fileStat.size > 0 && fileStat.mtimeMs >= beforeCaptureTime - 2000) {\n                  if (fileStat.mtimeMs > latestMtime) {\n                    latestMtime = fileStat.mtimeMs;\n                    latestFile = filePath;\n                  }\n                }\n              } catch { }\n            }\n          } catch { }\n        }\n\n        if (latestFile) {\n          const { expectedTexts = [], unexpectedTexts = [], roi, fieldType = 'full', preprocess } = screenConfig;\n          const allSearchTexts = [...expectedTexts, ...unexpectedTexts];\n\n          let ocrText = '';\n          let matchedTexts: string[] = [];\n\n          // OCR  xem text c detect\n          if (allSearchTexts.length > 0) {\n            // C searchTexts, dng fastScreenOCR\n            const ocrResult = await this.ocrService.fastScreenOCR(\n              latestFile,\n              allSearchTexts,\n              {\n                fieldType: roi ? 'singleLine' : fieldType,\n                customROI: roi,\n                preprocess: preprocess,\n              }\n            );\n            ocrText = ocrResult?.result?.text || '';\n            matchedTexts = ocrResult?.matchedTexts || [];\n          } else {\n            // Khng c searchTexts, OCR full  xem text\n            const ocrResult = await this.ocrService.recognizeFromFile(\n              latestFile,\n              {\n                fieldType: roi ? 'singleLine' : fieldType,\n                customROI: roi,\n                preprocess: preprocess,\n              }\n            );\n            ocrText = ocrResult?.text || '';\n          }\n\n          // Log ra text c detect\n          const roiStr = roi ? ` ROI: (${roi.x},${roi.y} ${roi.width}x${roi.height})` : '';\n          if (ocrText) {\n            this.logger.warn(\n              `[${deviceId}] Swipe attempt ${attempt}/${maxRetries} - OCR detected text: \"${ocrText}\"` +\n              (matchedTexts.length > 0 ? ` | Matched texts: [${matchedTexts.join(', ')}]` : '') +\n              ` | Expected: [${expectedTexts.join(', ') || 'none'}]${roiStr}`\n            );\n          } else {\n            this.logger.warn(\n              `[${deviceId}] Swipe attempt ${attempt}/${maxRetries} - OCR found no text${roiStr}`\n            );\n          }\n        } else {\n          this.logger.warn(\n            `[${deviceId}] Swipe attempt ${attempt}/${maxRetries} - Could not find screenshot file after ${fileWaitAttempt} attempts`\n          );\n        }\n\n        // Cleanup debug folder\n        try {\n          await rm(tempDir, { recursive: true, force: true });\n        } catch { }\n      } catch (debugError) {\n        // Log debug errors  bit vn \n        this.logger.debug(`[${deviceId}] Failed to debug OCR: ${debugError.message}`);\n      }\n\n      // Nu khng detect c v cha ht retry, log v th li\n      if (attempt < maxRetries) {\n        this.logger.debug(`[${deviceId}] Screen not detected after swipe (attempt ${attempt}/${maxRetries}), retrying...`);\n      }\n    }\n\n    // Tt c attempts u fail\n    this.logger.warn(`[${deviceId}] Failed to detect screen after ${maxRetries} swipe attempts`);\n    return false;\n  }\n\n  async createBillFolder(folderPath: string): Promise<void> {\n    const path = resolve(this.baseTransactionFolderPath, folderPath);\n\n    /*\n    * S dng khi retry clear  trnh li c nh\n    */\n    if (existsSync(path)) {\n      await rm(path, { recursive: true, force: true });\n    }\n\n    await mkdir(path, { recursive: true });\n  }\n\n  /**\n   * Capture screen of device\n   */\n  async captureScreen(deviceId: string, options: ICaptureScreenOptions) {\n    this.logger.log(`Capturing screen on device ${deviceId} with folderPath: ${options.folderPath}`);\n\n    const path = resolve(this.baseTransactionFolderPath, options.folderPath);\n\n    await this.wsService.captureScreen(deviceId, {\n      ...options,\n      folderPath: path,\n    });\n\n    await sleep(500);\n  }\n\n  /**\n   * Qut th mc cho n khi timeout v tr v file mi nht\n   * @param folderPath ng dn n folder cha nh\n   * @param timeout Timeout ti a  i file (ms), mc nh 30000ms (30s)\n   * @param pollInterval Khong thi gian gia cc ln qut (ms), mc nh 500ms\n   * @returns ng dn file mi nht hoc null nu khng tm thy\n   */\n  async getBillImagePath(\n    folderPath: string,\n    timeout: number = 10000,\n    pollInterval: number = 500\n  ): Promise<string | null> {\n    if (!folderPath) {\n      this.logger.warn('Folder path is null or empty');\n      return null;\n    }\n\n    const folder = join(this.baseTransactionFolderPath, folderPath);\n    const startTime = Date.now();\n    let attemptCount = 0;\n\n    this.logger.debug(\n      `Scanning folder for bill image: ${folderPath}, timeout: ${timeout}ms, pollInterval: ${pollInterval}ms`\n    );\n\n    while (Date.now() - startTime < timeout) {\n      attemptCount++;\n\n      try {\n        // Kim tra th mc c tn ti khng\n        if (!existsSync(folder)) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`Folder does not exist yet: ${folderPath}, retrying...`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        const files = await readdir(folder);\n\n        if (files.length === 0) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`No files found in folder: ${folderPath}, retrying... (attempt ${attemptCount})`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Ly thng tin tt c cc file\n        const filesWithStat = await Promise.all(\n          files.map(async file => {\n            try {\n              const fullPath = join(folder, file);\n              const s = await stat(fullPath);\n              return { fullPath, mtime: s.mtimeMs, size: s.size };\n            } catch (statError) {\n              // Skip files that can't be stat'd\n              return null;\n            }\n          })\n        );\n\n        // Lc cc file hp l (size > 0)\n        const validFiles = filesWithStat.filter(\n          (f): f is { fullPath: string; mtime: number; size: number } =>\n            f !== null && f.size > 0\n        );\n\n        if (validFiles.length === 0) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`No valid files found in folder: ${folderPath}, retrying... (attempt ${attemptCount})`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Sp xp theo thi gian modified mi nht\n        validFiles.sort((a, b) => b.mtime - a.mtime);\n\n        const latestFile = validFiles[0].fullPath;\n        const elapsed = Date.now() - startTime;\n        this.logger.log(\n          `Found latest bill image: ${latestFile} after ${elapsed}ms (${attemptCount} attempts)`\n        );\n\n        return latestFile;\n      } catch (error) {\n        this.logger.debug(\n          `Error scanning folder ${folderPath} (attempt ${attemptCount}): ${error.message}, retrying...`\n        );\n        await sleep(pollInterval);\n      }\n    }\n\n    // Timeout - khng tm thy file\n    const elapsed = Date.now() - startTime;\n    this.logger.warn(\n      `Timeout scanning folder for bill image: ${folderPath} after ${elapsed}ms (${attemptCount} attempts)`\n    );\n    return null;\n  }\n\n  async analyzeTransferBill(bankCode: string, withdrawal: Partial<Withdrawal>): Promise<IAnalyzeTransferBillResult> {\n    const { ROI, expectedTexts } = ANALYZE_BILL_ROI[bankCode];\n    const billImage = await this.getBillImagePath(withdrawal.withdrawalCode);\n\n    try {\n      // No image found\n      if (!billImage) {\n        this.logger.warn(`No bill image path ${withdrawal.withdrawalCode}`);\n\n        return {\n          rawPath: null,\n          analyzedStatus: 'na',\n        };\n      }\n\n      // const ocrResult = await ocrBillPro(billImage);\n      const ocrResult = await this.ocrService.fastScreenOCR(\n        billImage,\n        expectedTexts,\n        {\n          fieldType: 'singleLine',\n          customROI: ROI,\n          preprocess: {\n            // increase constrast for image recognition\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      );\n\n      if (!ocrResult.found) {\n        this.logger.warn(`No OCR result found for ${withdrawal.withdrawalCode}`);\n\n        return {\n          rawPath: billImage,\n          analyzedStatus: 'na'\n        }\n      }\n\n      return {\n        rawPath: billImage,\n        analyzedStatus: ocrResult.found ? 'success' : 'unknown',\n      };\n    } catch (error) {\n      this.logger.error(`Error analyzing transfer bill: ${error.message}`);\n\n      return {\n        rawPath: billImage,\n        analyzedStatus: 'na'\n      }\n    }\n  }\n\n  async createQRCodeAndTransferTo(deviceId: string, withdrawal: Withdrawal) {\n    const folderPath = join(this.baseTransactionExecutionFolder, 'qrcode');\n\n    await mkdir(folderPath, { recursive: true });\n    const fileName = `qr_${withdrawal.withdrawalCode}.png`;\n    const filePath = join(folderPath, fileName);\n\n    await QRCodeToFile(\n      filePath,\n      withdrawal.transferCode,\n      {\n        type: 'png',\n        width: 228,\n        margin: 2\n      }\n    );\n\n    await sleep(500);\n\n    await this.wsService.transferFile(deviceId, filePath, 1);\n\n    await sleep(500);\n\n    this.logger.log(`[${deviceId}] QR code is created and transferred for withdrawal ${withdrawal.withdrawalId}`);\n  }\n\n  protected async extractBalanceFromROI(\n    deviceId: string,\n    roi: ROI\n  ): Promise<number> {\n    const tempDir = join(this.baseBalanceFolder, `balance_${deviceId}`);\n    \n    try {\n      // Capture screen to extract balance text\n      await sleep(1000);\n      await mkdir(tempDir, { recursive: true });\n      // Use wsService.captureScreen directly since we already have the full path\n      // Base class captureScreen resolves against baseTransactionFolderPath which is wrong here\n      await this.wsService.captureScreen(deviceId, { folderPath: tempDir });\n      await sleep(2000);\n\n      // Get the first image file in tempDir\n      let imagePath: string | null = null;\n      const maxFileWaitAttempts = 5;\n      let fileWaitAttempt = 0;\n\n      while (fileWaitAttempt < maxFileWaitAttempts && !imagePath) {\n        fileWaitAttempt++;\n        await sleep(500); // i 500ms mi ln\n\n        try {\n          if (!existsSync(tempDir)) {\n            continue;\n          }\n\n          const files = await readdir(tempDir);\n          const pngFiles = files.filter(f => f.endsWith('.png'));\n\n          if (pngFiles.length === 0) {\n            continue; // Cha c file, i tip\n          }\n\n          // Ly file PNG u tin\n          const firstPngFile = pngFiles[0];\n          const filePath = join(tempDir, firstPngFile);\n          \n          // Kim tra file c hp l khng (size > 0)\n          try {\n            const fileStat = await stat(filePath);\n            if (fileStat.size > 0) {\n              imagePath = filePath;\n            }\n          } catch (statError) {\n            continue;\n          }\n        } catch (readdirError) {\n          // Folder cha tn ti hoc khng c c, i tip\n          continue;\n        }\n      }\n      \n      if (!imagePath) {\n        this.logger.warn(`[${deviceId}] Failed to capture balance screen`);\n        await this.cleanupFolder(tempDir, deviceId);\n\n        return 0;\n      }\n\n      // Extract text from ROI using OCR\n      const ocrResult = await this.ocrService.recognizeFromFile(imagePath, {\n        fieldType: 'singleLine',\n        customROI: roi,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true,\n        },\n      });\n\n      if (!ocrResult || !ocrResult.text) {\n        this.logger.warn(`[${deviceId}] Failed to extract balance text from ROI`);\n        await this.cleanupFolder(tempDir, deviceId);\n        return 0;\n      }\n\n      // Clean balance text: remove all non-numeric characters\n      // For VND, dots (.) and commas (,) are thousand separators, not decimal points\n      // So we remove them all and parse as integer\n      let balanceText = ocrResult.text.replace(/[^\\d]/g, '');\n      \n      // Parse as integer since VND doesn't have decimals\n      const balance = parseInt(balanceText, 10);\n      this.logger.debug(`[${deviceId}] OCR text: \"${ocrResult.text}\" -> Cleaned: \"${balanceText}\" -> Parsed: ${balance}`);\n\n      if (isNaN(balance)) {\n        this.logger.warn(`[${deviceId}] Could not parse balance from OCR text: ${ocrResult.text}`);\n        await this.cleanupFolder(tempDir, deviceId);\n        return 0;\n      }\n\n      this.logger.log(\n        `[${deviceId}] Extracted balance: ${balance.toLocaleString('vi-VN')} VND ` +\n        `(confidence: ${ocrResult.confidence.toFixed(2)}%, time: ${ocrResult.processingTime}ms)`\n      );\n\n\n      // Cleanup folder sau khi phn tch xong\n      await this.cleanupFolder(tempDir, deviceId);\n\n      return balance;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error extracting balance from ROI: ${error.message}`, error.stack);\n      // Cleanup folder nu c li\n      await this.cleanupFolder(tempDir, deviceId);\n      return 0;\n    }\n  }\n\n  /**\n   * Abstract methods - must be implemented by each bank\n   */\n  abstract login(deviceId: string): Promise<void>;\n  abstract launchApp(deviceId: string): Promise<void>;\n  abstract executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void>;\n  abstract goToHomeScreenFromBill(deviceConfig: DeviceConfig): Promise<void>;\n  abstract getBalance(deviceId: string): Promise<number | null>;\n}\n\n","module.exports = require(\"qrcode\");","import { ACB_ROI_EXPECTED } from \"./acb-roi\";\nimport { HD_ROI_EXPECTED } from \"./hd-roi\";\nimport { PG_ROI_EXPECTED } from \"./pg-roi\";\nimport { VCB_ROI_EXPECTED } from \"./vcb-roi\";\n\nexport const ANALYZE_BILL_ROI = {\n  PGBANK: {\n    ROI: PG_ROI_EXPECTED.TRANSACTION_SUCCESS,\n    expectedTexts: ['chuyn tin thnh cng'],\n  },\n  HDBANK: {\n    ROI: HD_ROI_EXPECTED.BILL_AREA,\n    expectedTexts: ['Kt qu giao dch'],\n  },\n  ACB: {\n    ROI: ACB_ROI_EXPECTED.TRANSACTION_SUCCESS,\n    expectedTexts: ['Chuyn tin thnh cng'],\n  },\n  VIETCOMBANK: {\n    ROI: VCB_ROI_EXPECTED.TRANSACTION_SUCCESS,\n    expectedTexts: ['Giao dch thnh cng'],\n  },\n};","export const ACB_ROI_EXPECTED: Record<string, {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}> = {\n  LAUNCH_APP: {\n    x: 0.3,\n    y: 0.79,\n    width: 0.4,\n    height: 0.05\n  },\n  VERIFY_ACCOUNT_NAME: {\n    x: 0.1,\n    y: 0.3,\n    width: 0.8,\n    height: 0.04\n  },\n  TRANSACTION_CONFIRM: {\n    x: 0.05,\n    y: 0.1,\n    width: 0.6,\n    height: 0.05\n  },\n  TRANSACTION_VERIFY: {\n    x: 0.1,\n    y: 0.05,\n    width: 0.8,\n    height: 0.15\n  },\n  TRANSACTION_ENTER_OTP: {\n    x: 0.2,\n    y: 0.05,\n    width: 0.35,\n    height: 0.1\n  },\n  TRANSACTION_SUCCESS: {\n    x: 0.05,\n    y: 0.2,\n    width: 0.65,\n    height: 0.06\n  },\n  HOME_SCREEN: {\n    x: 0.02,\n    y: 0.93,\n    width: 0.4,\n    height: 0.05\n  },\n  ALBUM_SCREEN: {\n    x: 0.6,\n    y: 0.35,\n    width: 0.2,\n    height: 0.05\n  },\n  ACCOUNT_BALANCE_NUMBER: {\n    x: 0.05,\n    y: 0.22,\n    width: 0.56,\n    height: 0.05\n  },\n  QR_CODE_SCREEN: {\n    x: 0.3,\n    y: 0.65,\n    width: 0.5,\n    height: 0.05\n  },\n  /** Nt trn chp nh khun mt - i chuyn trng  xanh ri click */\n  FACE_CAPTURE_BUTTON: {\n    x: 0.4,\n    y: 0.8,\n    width: 0.2,\n    height: 0.08,\n  },\n  TRANSACTION_OTP_SAFEKEY: {\n    x: 0.06,\n    y: 0.27,\n    width: 0.4,\n    height: 0.05\n  },\n  FACE_ID_POPPUP_ERROR: {\n    x:  0.4,\n    y: 0.22,\n    width: 0.2,\n    height: 0.1\n  },\n}","export const HD_ROI_EXPECTED: Record<string, {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}> = {\n  LAUNCH_APP: {\n    x: 0.1,\n    y: 0.54,\n    width: 0.7,\n    height: 0.1\n  },\n  VERIFY_ACCOUNT_NUMBER: {\n    x: 0.05,\n    y: 0.4,\n    width: 0.9,\n    height: 0.2\n  },\n  VERIFY_ACCOUNT_NAME: {\n    x: 0.045,\n    y: 0.4,\n    width: 0.83,\n    height: 0.35\n  },\n  VERIFY_ACCOUNT_NAME_INTERNAL: {\n    x: 0.4,\n    y: 0.26,\n    width: 0.6,\n    height: 0.25\n  },\n  OTP_ENTER: {\n    x: 0.1,\n    y: 0.25,\n    width: 0.8,\n    height: 0.1\n  },\n  TRANSACTION_VERIFY: {\n    x: 0.1,\n    y: 0.5,\n    width: 0.4,\n    height: 0.1\n  },\n  TRANSACTION_SUCCESS: {\n    x: 0.2,\n    y: 0.3,\n    width: 0.6,\n    height: 0.1\n  },\n  BILL_AREA: {\n    x: 0.085,\n    y: 0.025,\n    width: 0.6,\n    height: 0.075\n  },\n  HOME_SCREEN: {\n    x: 0.02,\n    y: 0.7,\n    width: 0.98,\n    height: 0.3\n  },\n  ALBUM_SCREEN: {\n    x: 0.18,\n    y: 0.02,\n    width: 0.8,\n    height: 0.085\n  },\n  SWIPE_UP_SCREEN: {\n    x: 0.01,\n    y: 0.5,\n    width: 0.5,\n    height: 0.1\n  },\n  INTERNAL_SWIPE_UP_SCREEN: {\n    x: 0.01,\n    y: 0.65,\n    width: 0.5,\n    height: 0.1\n  },\n  WARNING_TRANSACTION: {\n    x: 0.14,\n    y: 0.39,\n    width: 0.72,\n    height: 0.2\n  }, \n  OTP_ENTER_OR_CONTINUE_TRANSFER: {\n    x: 0.03,\n    y: 0.1,\n    width: 0.95,\n    height: 0.6\n  },\n  CONFIRM_AFTER_OTP: {\n    x: 0.03,\n    y: 0.5,\n    width: 0.95,\n    height: 0.2\n  },\n  BOTTOM_BILL : {\n    x: 0.03,\n    y: 0.8,\n    width: 0.9,\n    height: 0.1\n  },\n  ACCOUNT_BALANCE_NUMBER: {\n    x: 0.4,\n    y: 0.28,\n    width: 0.6,\n    height: 0.05\n  },\n  WRONG_OTP_SCREEN: {\n    x: 0.04,\n    y: 0.15,\n    width: 0.9,\n    height: 0.6\n  },\n} ","export const PG_ROI_EXPECTED: Record<string, {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}> = {\n  LAUNCH_APP: {\n    x: 0.04,\n    y: 0.53,\n    width: 0.73,\n    height: 0.078\n  },\n  VERIFY_ACCOUNT_NAME: {\n    x: 0.04,\n    y: 0.36,\n    width: 0.81,\n    height: 0.28\n  },\n  TRANSACTION_CONFIRM: {\n    x: 0.085,\n    y: 0.023,\n    width: 0.8,\n    height: 0.08\n  },\n  TRANSACTION_VERIFY: {\n    x: 0.085,\n    y: 0.023,\n    width: 0.8,\n    height: 0.08\n  },\n  TRANSACTION_SUCCESS: {\n    x: 0.06,\n    y: 0.212,\n    width: 0.88,\n    height: 0.1\n  },\n  HOME_SCREEN: {\n    x: 0.02,\n    y: 0.7,\n    width: 0.98,\n    height: 0.3\n  },\n  ALBUM_SCREEN: {\n    x: 0.18,\n    y: 0.02,\n    width: 0.8,\n    height: 0.085\n  },\n  ACCOUNT_BALANCE_SCREEN :{\n    x: 0.15,\n    y: 0.15,\n    width: 0.5,\n    height: 0.05\n  },\n  ACCOUNT_BALANCE_NUMBER: {\n    x: 0.1,\n    y: 0.33,\n    width: 0.6,\n    height: 0.05\n  }\n}","import { ROI } from \"@/modules/ocr/services/image-preprocessing.service\";\n\nexport const VCB_ROI_EXPECTED: Record<string, {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}> = {\n  LAUNCH_APP: {\n    x: 0.3,\n    y: 0.5,\n    width: 0.4,\n    height: 0.1\n  },\n  VERIFY_ACCOUNT_NUMBER: {\n    x: 0.05,\n    y: 0.45,\n    width: 0.9,\n    height: 0.2\n  },\n  VERIFY_ACCOUNT_NAME: {\n    x: 0.05,\n    y: 0.55,\n    width: 0.8,\n    height: 0.1\n  },\n  OTP_ENTER: {\n    x: 0.1,\n    y: 0.5,\n    width: 0.4,\n    height: 0.1\n  },\n  OTP_VERIFY: {\n    x: 0.1,\n    y: 0.4,\n    width: 0.5,\n    height: 0.1\n  },\n  TRANSACTION_VERIFY: {\n    x: 0.5,\n    y: 0.1,\n    width: 0.4,\n    height: 0.1\n  },\n  TRANSACTION_SUCCESS: {\n    x: 0.2,\n    y: 0.2,\n    width: 0.6,\n    height: 0.1\n  },\n  HOME_SCREEN: {\n    x: 0.02,\n    y: 0.55,\n    width: 0.5,\n    height: 0.1\n  },\n  ALBUM_SCREEN: {\n    x: 0.02,\n    y: 0.02,\n    width: 0.98,\n    height: 0.2\n  }\n}","import { ACB_ROI_EXPECTED } from \"./acb-roi\";\n\nexport const  ACB_UI_COORDINATES = {\n  LOGIN_BUTTON: {\n    x: 50,\n    y: 82,\n  },\n  PASSWORD_FIELD: {\n    x: 50,\n    y: 39,\n  },\n  LOGIN_BUTTON_API: {\n    x: 50,\n    y: 55,\n  },\n  BALANCE_HIN_BUTTON: {\n    x: 9,\n    y: 21\n  },\n  QR_CODE_BTN: {\n    x: 30,\n    y: 92\n  },\n  IMAGE_LIBRARY_BTN: {\n    x: 50,\n    y: 68\n  },\n  FIRST_IMAGE_BTN: {\n    x: 15,\n    y: 65\n  },\n  ALBUM_BTN: {\n    x: 60,\n    y: 50\n  },\n  IMGAE_CAMERA: {\n    x: 25,\n    y: 65\n  },\n  CONTINUE_TRANSFER_BTN: {\n    x: 50,\n    y: 93\n  },\n  CLOSE_TRANSACTION_BTN: {\n    x: 22,\n    y: 92\n  },\n  BACK_TO_HOME_BTN: {\n    x: 90,\n    y: 8\n  },\n  CLOSE_LOCATION_POPUP: {\n    x: 30,\n    y: 70\n  },\n  FACE_ID_BTN: {\n    x: 50,\n    y: 85\n  },\n  FACE_ID_POPPUP_CLOSE_BTN: {\n    x: 50,\n    // y: 26.5\n    y: 25.3\n  }\n};\n\nexport const ACB_SCREEN_HINT_NAME = {\n  FACE_ID: 'FACE_ID',\n  FACE_ID_ENG: 'FACE_ID_ENG',\n  TRANSACTION_VERIFY: 'TRANSACTION_VERIFY',\n  FACE_ID_POPPUP_ERROR: 'FACE_ID_POPPUP_ERROR',\n  FACE_ID_POPPUP_ERROR_ENG: 'FACE_ID_POPPUP_ERROR_ENG',\n  ALBUM_ENG: 'ALBUM_ENG',\n  ALBUM_VI: 'ALBUM_VI'\n}\n\nexport const ACB_SCREEN_ALBUM_HINT = [\n  {\n    name: ACB_SCREEN_HINT_NAME.ALBUM_VI,\n    hint: 'b su tp',\n    roi: {\n      x: 0.6,\n      y: 0.35,\n      width: 0.2,\n      height: 0.05\n    }\n  },\n  {\n    name: ACB_SCREEN_HINT_NAME.ALBUM_ENG,\n    hint: 'album',\n    roi: {\n      x: 0.5,\n      y: 0.45,\n      width: 0.2,\n      height: 0.1\n    }\n  }\n]\n\nexport const ACB_SCREEN_OTP_HINT = [\n  {\n    name: ACB_SCREEN_HINT_NAME.FACE_ID,\n    hint: 'Chup anh khuon mat',\n  },\n  {\n    name: ACB_SCREEN_HINT_NAME.FACE_ID_ENG,\n    hint: 'take a photo',\n  },\n  {\n    name: ACB_SCREEN_HINT_NAME.TRANSACTION_VERIFY,\n    hint: 'chi tit giao dch',\n    roi: ACB_ROI_EXPECTED.TRANSACTION_OTP_SAFEKEY,\n  }\n]\n\nexport const ACB_SCREEN_AFTER_FACE_ID_HINT = [\n  {\n    name: ACB_SCREEN_HINT_NAME.FACE_ID_POPPUP_ERROR,\n    hint: 'ng',\n  },\n  {\n    name: ACB_SCREEN_HINT_NAME.FACE_ID_POPPUP_ERROR_ENG,\n    hint: 'close',\n  },\n  {\n    name: ACB_SCREEN_HINT_NAME.TRANSACTION_VERIFY,\n    hint: 'chi tit giao dch',\n    roi: ACB_ROI_EXPECTED.TRANSACTION_OTP_SAFEKEY,\n  }\n\n]","import { Inject, Injectable } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { PANDA_SERVICE_IOS } from '@/common/modules/websocket/constants/websocket';\nimport { sleep } from '@/common/utils/time';\nimport { PG_UI_COORDINATES } from './constants/pgbank';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { PG_ROI_EXPECTED } from './constants/pg-roi';\nimport { BankCodeWithdrawal } from './constants/bank-code';\nimport { TelegramService } from '../notifiction/telegram.service';\nimport { ImagePreprocessingService } from '../ocr/services/image-preprocessing.service';\n\n@Injectable()\nexport class PgService extends BaseBankService {\n  protected readonly BANK_CODE = 'PGBANK';\n  protected readonly BUNDLE_ID = 'pgbankApp.pgbank.com.vn';\n\n  constructor(\n    @Inject(PANDA_SERVICE_IOS)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n    ocrService: OCRService,\n    imagePreprocessingService: ImagePreprocessingService,\n    private readonly telegramService: TelegramService,\n  ) {\n    super(wsService, deviceService, ocrService, imagePreprocessingService);\n  }\n\n  private async inputPasswordFromConfig(deviceId: string): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.password) {\n      throw new Error(`Password not configured for device ${deviceId}`);\n    }\n\n    // Click password field and wait for UI to be ready\n    await this.clickWithTransition(deviceId, PG_UI_COORDINATES.PASSWORD_FIELD.x, PG_UI_COORDINATES.PASSWORD_FIELD.y, 1500);\n\n    // Attempt to input password\n    await this.wsService.inputText(deviceId, config.password);\n    await sleep(1000);\n\n    // Hide keyboard\n    await this.clickWithTransition(deviceId, PG_UI_COORDINATES.HIDE_LOGIN_KEYBOARD.x, PG_UI_COORDINATES.HIDE_LOGIN_KEYBOARD.y, 1000);\n  }\n\n  private async inputSmartOTPFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.smartOTP) {\n      throw new Error(`SmartOTP not configured for device ${deviceId}`);\n    }\n\n    await sleep(2000);\n    await this.wsService.inputText(deviceId, config.smartOTP);\n  }\n\n  async launchApp(deviceId: string) {\n    await this.wsService.launchApp(deviceId, this.BUNDLE_ID);\n    const doesLaunchAppSuccess = await this.verifyScreenState(deviceId, {\n      expectedTexts: ['ng nhp'],\n      timeout: 10_000,\n      pollInterval: 500,\n      roi: PG_ROI_EXPECTED.LAUNCH_APP,\n      preprocess: {\n        // increase constrast for image recognition\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesLaunchAppSuccess) {\n      throw new Error('Failed to launch PGBank app and go to login screen');\n    } else {\n      this.logger.log(`[${deviceId}] - Get login app screen`);\n    }\n  }\n\n  /**\n   * Login to PG bank\n   */\n  async login(deviceId: string): Promise<void> {\n    // Step 0: Kill app\n    await this.killApp(deviceId);\n    await sleep(1000);\n\n    // Step 1: Launch app\n    await this.launchApp(deviceId);\n    await sleep(3000);\n\n    // Step 2: Input password\n    await this.inputPasswordFromConfig(deviceId);\n\n    // Step 3: Click login button\n    const doesLoginSuccess = await this.clickAndWaitForScreen(deviceId,\n      PG_UI_COORDINATES.LOGIN_BTN.x,\n      PG_UI_COORDINATES.LOGIN_BTN.y,\n      {\n        expectedTexts: ['ti khon', 'chuyn tin', 'tit kim'],\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: PG_ROI_EXPECTED.HOME_SCREEN,\n      }\n    );\n\n    if (!doesLoginSuccess) {\n      this.telegramService.sendMessage({\n        text: ' Login Error'\n          + `\\n\\n<b>Device:</b> ${deviceId}`\n          + `\\n<b>Error:</b> Khng th ng nhp vo app PGBank.`,\n        options: {\n          parseMode: 'HTML'\n        }\n      });\n\n      throw new Error('Failed to login to PGBank');\n    } else {\n      this.logger.log(`[${deviceId}] - Login successfully`);\n    }\n    const availableAmount = await this.getBalance(deviceId);\n    if(availableAmount) {\n      await this.deviceService.updateDeviceConfig(deviceId, { availableAmount });\n    } else {\n      this.logger.warn(`[${deviceId}] - Get balance failed`);\n    }\n  }\n\n  async executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n\n    this.logger.log(`Executing PG transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceConfig.deviceId}`);\n    // Step 1: Click QR code button\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      PG_UI_COORDINATES.QR_CODE_BTN.x,\n      PG_UI_COORDINATES.QR_CODE_BTN.y,\n      5000\n    )\n\n    // Step 2: Click image library button\n    const doesClickImageLibrarySuccess = await this.clickAndWaitForScreen(\n      deviceConfig.deviceId,\n      PG_UI_COORDINATES.IMAGE_LIBRARY_BTN.x,\n      PG_UI_COORDINATES.IMAGE_LIBRARY_BTN.y,\n      {\n        expectedTexts: ['nh'],\n        timeout: 10_000,\n        pollInterval: 500,\n        roi: PG_ROI_EXPECTED.ALBUM_SCREEN\n      }\n    )\n\n    if (!doesClickImageLibrarySuccess) {\n      throw new WithdrawalProcessingError(\n        `[${deviceConfig.accountName}] Failed to get image library screen`,\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: MH m th vin nh'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get image library screen`);\n    }\n\n    // Step 3: Click first image\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      PG_UI_COORDINATES.FIRST_IMAGE_BTN.x,\n      PG_UI_COORDINATES.FIRST_IMAGE_BTN.y,\n      2000\n    )\n\n    // Step 4: Verify account name\n    let verifiedAccountName = false;\n    if (withdrawal.bankCode === BankCodeWithdrawal.PGBANK) {\n      verifiedAccountName = await this.clickAndWaitForScreen(\n        deviceConfig.deviceId,\n        PG_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n        PG_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n        {\n          expectedTexts: [withdrawal.beneficiaryName],\n          timeout: 30_000,\n          pollInterval: 500,\n          preprocess: {\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      )\n    } else {\n      verifiedAccountName = await this.clickAndWaitForScreen(\n        deviceConfig.deviceId,\n        PG_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n        PG_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n        {\n          expectedTexts: [withdrawal.beneficiaryName],\n          timeout: 30_000,\n          pollInterval: 500,\n          roi: PG_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n          preprocess: {\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      )\n    }\n\n    if (!verifiedAccountName) {\n      throw new WithdrawalProcessingError(\n        'Choose wrong image qrcode',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: MH tra tn ti khon'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Verified account name screen`);\n    }\n\n    // Step 4: Continue transaction and expect transaction confirm screen\n    const doesTransactionConfirm = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Xc nhn giao dch'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: PG_ROI_EXPECTED.TRANSACTION_CONFIRM,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    )\n\n    if (!doesTransactionConfirm) {\n      throw new WithdrawalProcessingError(\n        'Transaction confirm screen not found',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: MH Xc nhn giao dch'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction confirm screen`);\n    }\n\n    // Step 5: Continue transaction and expect transaction verification\n    const doesTransactionCVerify = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Xc thc giao dch'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: PG_ROI_EXPECTED.TRANSACTION_VERIFY,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    )\n\n    if (!doesTransactionCVerify) {\n      throw new WithdrawalProcessingError(\n        'Transaction verification screen not found',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: MH Xc thc giao dch'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verification screen`);\n    }\n\n    // Step 5: Enter OTP\n    await this.inputSmartOTPFromConfig(deviceConfig.deviceId);\n    const doesTransactionSuccess = await this.verifyScreenState(deviceConfig.deviceId, {\n      expectedTexts: ['Chuyn tin thnh cng'],\n      timeout: 30_000,\n      pollInterval: 500,\n      roi: PG_ROI_EXPECTED.TRANSACTION_SUCCESS,\n      preprocess: {\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesTransactionSuccess) {\n      throw new WithdrawalProcessingError(\n        'Transaction success screen not found', \n        ErrorType.NO_BILL_AFTER_OTP,\n        'Failed: MH Chuyn tin thnh cng'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction success screen`);\n    }\n\n    // Step 6: Capture screen\n    await sleep(500);\n    await this.captureScreen(deviceConfig.deviceId, { folderPath: withdrawal.withdrawalCode });\n  }\n\n  async goToHomeScreenFromBill(deviceConfig: DeviceConfig) {\n    const gotoHomeScreen = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      PG_UI_COORDINATES.BACK_TO_HOME.x,\n      PG_UI_COORDINATES.BACK_TO_HOME.y,\n      {\n        expectedTexts: ['ti khon', 'chuyn tin', 'tit kim'],\n        timeout: 10_000,\n        pollInterval: 500,\n        roi: PG_ROI_EXPECTED.HOME_SCREEN,\n      }\n    );\n\n    if (!gotoHomeScreen) {\n      throw new WithdrawalProcessingError('Failed to login to PGBank', ErrorType.FORCE_LOGIN_NO_REQUEUE);\n    } else {\n      this.logger.log(`[${deviceConfig.deviceId}] - Get to home screen`);\n    }\n  }\n\n  /**\n   * Extract transaction amount t khung mu   cui mn hnh\n   * ROI da trn screenshot \"Kt qu giao dch\" ca PGBank\n   */\n  async extractTransactionAmount(imagePath: string): Promise<number | null> {\n    try {\n      const result = await this.ocrService.recognizeFromFile(imagePath, {\n        fieldType: 'singleLine',\n        customROI: {\n          x: 0.05,      // 5% from left (c margin nh)\n          y: 0.75,      // 75% from top (khong cui white card)\n          width: 0.9,   // 90% width (full width tr margin)\n          height: 0.12, // 12% height (  cha text + padding)\n        },\n        preprocess: {\n          grayscale: true,        // Chuyn sang grayscale\n          enhanceContrast: true,  // Tng contrast cho text trn nn \n        },\n      });\n\n      if (!result) {\n        this.logger.warn('Failed to extract transaction amount from ROI');\n        return null;\n      }\n\n      // Clean s tin: ch ly s v du phy/chm\n      const amountText = result.text.replace(/[^\\d.,]/g, '').replace(/,/g, '');\n      const amount = parseFloat(amountText);\n\n      if (isNaN(amount)) {\n        this.logger.warn(`Could not parse amount from OCR text: ${result.text}`);\n        return null;\n      }\n\n      this.logger.log(\n        `Extracted transaction amount: ${amount.toLocaleString('vi-VN')} VND ` +\n        `(confidence: ${result.confidence.toFixed(2)}%, time: ${result.processingTime}ms)`\n      );\n\n      return amount;\n    } catch (error) {\n      this.logger.error(`Error extracting transaction amount: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n  async getBalance(deviceId: string): Promise<number | null> {\n    try {\n      await sleep(2000);\n      const doesGetAccountScreen = await this.clickAndWaitForScreen(deviceId,\n        PG_UI_COORDINATES.ACCOUNT.x,\n        PG_UI_COORDINATES.ACCOUNT.y,\n        {\n          unexpectedTexts: ['Ti khon thanh ton'],\n          timeout: 20_000,\n          pollInterval: 500,\n          roi: PG_ROI_EXPECTED.ACCOUNT_BALANCE_SCREEN,\n        }\n      );\n      \n      if(!doesGetAccountScreen) {\n        return 0;\n      }\n\n      // Extract balance from ROI using helper method from base class\n      return await this.extractBalanceFromROI(deviceId, PG_ROI_EXPECTED.ACCOUNT_BALANCE_NUMBER);\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error extracting balance: ${error.message}`, error.stack);\n      return 0;\n    } finally {\n      await this.wsService.click(deviceId, PG_UI_COORDINATES.BACK_TO_HOME_BTN.x, PG_UI_COORDINATES.BACK_TO_HOME_BTN.y);\n    }\n  }\n\n\n  async onModuleInit() {\n\n    // ROI cho khung mu  cha s tin giao dch ( cui mn hnh)\n    // const ROIresult = await this.ocrService.recognizeFromFile('C:/temp/test.png', {\n    //   fieldType: 'singleLine',\n    //   customROI: {\n    //     x: 0.05,      // 5% from left (c margin nh)\n    //     y: 0.75,      // 75% from top (khong cui white card)\n    //     width: 0.9,   // 90% width (full width tr margin)\n    //     height: 0.12, // 12% height (  cha text + padding)\n    //   },\n    //   preprocess: {\n    //     grayscale: true,        // Chuyn sang grayscale  tng  chnh xc\n    //     enhanceContrast: true,  // Tng contrast cho text mu  trn nn \n    //   },\n    // });\n\n\n    // await this.launchApp('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await sleep(5000);\n    // await this.login('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await this.executeExternalTransfer({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   beneficiaryAccountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // }, 'dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // const billImage = await this.analyzeTransferBill({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   accountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // });\n    // console.log(billImage);\n  }\n\n  onModuleDestroy(): void {\n    // this.killApp('590f1f9603f09330cf235485c6e76b10d0759a55');\n  }\n}\n\n","// HC PG UI Element Coordinates (normalized 0-1)\n\nimport { config } from \"@/common/constants/config\";\nimport { scaleCoordinates } from \"@/common/constants/keyboard\";\n\nconst HC_PG_UI_COORDINATES = {\n  LOGIN_BTN: {\n    x: 0.5,\n    y: 0.6,\n  },\n  PASSWORD_FIELD: {\n    x: 0.5,\n    y: 0.435,\n  },\n  TRANSFER_BTN: {\n    x: 0.7,\n    y: 0.7,\n  },\n  TRANSFER_INTERNAL_BTN: {\n    x: 0.2,\n    y: 0.2\n  },\n  TRANSFER_EXTERNAL_BTN: {\n    x: 0.4,\n    y: 0.2,\n  },\n  CLOSE_ALLOW_CONTACT_POPUP_BTN: {\n    x: 0.3,\n    y: 0.6,\n  },\n  ACCOUNT_NUMBER_INPUT: {\n    x: 0.4,\n    y: 0.43,\n  },\n  SELECT_BANK_BTN: {\n    x: 0.4,\n    y: 0.47,\n  },\n  SEARCH_BANK_BTN: {\n    x: 0.4,\n    y: 0.48,\n  },\n  INTERNAL_AMOUNT_INPUT: {\n    x: 0.5,\n    y: 0.6,\n  },\n  HIDE_NUMPAD_BTN: {\n    x: 0.05,\n    y: 0.4,\n  },\n  CONTINUE_TRANSFER_BTN: {\n    x: 0.5,\n    y: 0.9,\n  },\n  BANK_SEARCH_BTN: {\n    x: 0.4,\n    y: 0.45,\n  },\n  BANK_SEARCH_INPUT: {\n    x: 0.4,\n    y: 0.45,\n  },\n  EXTERNAL_AMOUNT_INPUT: {\n    x: 0.3,\n    y: 0.37,\n  },\n  BACK_TO_HOME: {\n    x: 0.2,\n    y: 0.9,\n  },\n  QR_CODE_BTN: {\n    x: 0.2,\n    y: 0.9,\n  },\n  IMAGE_LIBRARY_BTN: {  \n    x: 0.8,\n    y: 0.9,\n  },\n  FIRST_IMAGE_BTN: {  \n    x: 0.3,\n    y: 0.3,\n  },\n  SELECT_IMAGE_QR_CODE_BTN: {  \n    x: 0.95,\n    y: 0.95,\n  },\n  HOME_ICON_HEADER: {  \n    x: 0.95,\n    y: 0.05,\n  },\n  ACCOUNT: {\n    x: 0.5,\n    y: 0.7\n  },\n  BACK_TO_HOME_BTN: {\n    x: 0.07,\n    y: 0.06,\n  },\n  HIDE_LOGIN_KEYBOARD: {\n    x: 0.3,\n    y: 0.25,\n  },\n};\n\nconst PANDA_PG_UI_COORDINATES = scaleCoordinates(HC_PG_UI_COORDINATES);\n\nexport const PG_UI_COORDINATES = config.boxType === 'PANDA' ? PANDA_PG_UI_COORDINATES : HC_PG_UI_COORDINATES;","export enum BankCodeWithdrawal {\n  VIETCOMBANK = 'VIETCOMBANK',\n  AGRIBANK = 'AGRIBANK',\n  BIDV = 'BIDV',\n  SACOMBANK = 'SACOMBANK',\n  TECHCOMBANK = 'TECHCOMBANK',\n  TPBANK = 'TPBANK',\n  HDBank = 'HDBank',\n  VPBANK = 'VPBANK',\n  MBBANK = 'MBBANK',\n  MSB = 'MSB',\n  LPBANK = 'LPBANK',\n  ACB = 'ACB',\n  ABBANK = 'ABBANK',\n  NCB = 'NCB',\n  EXIMBANK = 'EXIMBANK',\n  SEABANK = 'SEABANK',\n  SCB = 'SCB',\n  PVCOMBANK = 'PVCOMBANK',\n  KIENLONGBANK = 'KIENLONGBANK',\n  BVBANK = 'BVBANK', // Vietcapitalbank\n  VIETINBANK = 'VIETINBANK',\n  OCB = 'OCB',\n  VIETBANK = 'VIETBANK',\n  SHB = 'SHB',\n  NAMABANK = 'NAMABANK',\n  SHINHANBANKVIETNAM = 'SHINHANBANKVIETNAM',\n  CIMB = 'CIMB',\n  SAIGONBANK = 'SAIGONBANK',\n  BACABANK = 'BACABANK',\n  VIETABANK = 'VIETABANK',\n  GPBANK = 'GPBANK',\n  HSBC = 'HSBC',\n  VRB = 'VRB',\n  VIB = 'VIB',\n  PGBANK = 'PGBANK',\n}","import { PANDA_SERVICE_IOS } from '@/common/modules/websocket/constants/websocket';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\nimport { Inject, Injectable } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { BankCodeWithdrawal } from './constants/bank-code';\nimport { HD_SCREEN_HINT_NAME, HD_SCREEN_OTP_HINT, HD_UI_COORDINATES } from './constants/hdbank';\nimport { HD_ROI_EXPECTED } from './constants/hd-roi';\nimport { PandaSwipeTypeEnum } from './constants/pandaSwipType';\nimport { ImagePreprocessingService } from '../ocr/services/image-preprocessing.service';\n\n@Injectable()\nexport class HdBankService extends BaseBankService {\n  protected readonly BANK_CODE = 'HDBANK';\n  protected readonly BUNDLE_ID = 'com.vnpay.HDBank';\n\n  constructor(\n    @Inject(PANDA_SERVICE_IOS)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n    ocrService: OCRService,\n    imagePreprocessingService: ImagePreprocessingService\n  ) {\n    super(wsService, deviceService, ocrService, imagePreprocessingService);\n  }\n\n  private async inputPasswordFromConfig(deviceId: string): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.password) {\n      throw new Error(`Password not configured for device ${deviceId}`);\n    }\n\n    // Click password field and wait for UI to be ready\n    await this.clickWithTransition(deviceId, HD_UI_COORDINATES.PASSWORD_FIELD.x, HD_UI_COORDINATES.PASSWORD_FIELD.y, 1500);\n\n    // Attempt to input password\n    await this.wsService.inputText(deviceId, config.password);\n    await sleep(1000);\n\n  }\n\n  private async inputSmartOTPFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.smartOTP) {\n      throw new Error(`SmartOTP not configured for device ${deviceId}`);\n    }\n\n    await sleep(500);\n    await this.wsService.inputText(deviceId, config.smartOTP);\n  }\n\n  async launchApp(deviceId: string) {\n    await this.wsService.launchApp(deviceId, this.BUNDLE_ID);\n    const doesLaunchAppSuccess = await this.verifyScreenState(deviceId, {\n      expectedTexts: ['ng nhp'],\n      timeout: 10_000,\n      pollInterval: 500,\n      roi: HD_ROI_EXPECTED.LAUNCH_APP,\n      preprocess: {\n        // increase constrast for image recognition\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesLaunchAppSuccess) {\n      throw new Error('Failed to launch HDBank app and go to login screen');\n    } else {\n      this.logger.log(`[${deviceId}] - Get login app screen`);\n    }\n  }\n\n  /**\n   * Login to PG bank\n   */\n  async login(deviceId: string): Promise<void> {\n    // Step 0: Kill app\n    await this.killApp(deviceId);\n    await sleep(2000);\n\n    // Step 1: Launch app\n    await this.launchApp(deviceId);\n    // Step 2: Input password\n    await this.inputPasswordFromConfig(deviceId);\n\n    // Step 3: Click login button\n    const doesLoginSuccess = await this.clickAndWaitForScreen(deviceId,\n      HD_UI_COORDINATES.LOGIN_BTN.x,\n      HD_UI_COORDINATES.LOGIN_BTN.y,\n      {\n        expectedTexts: ['ti khon', 'chuyn khon'],\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.HOME_SCREEN,\n      }\n    );\n\n\n    if (!doesLoginSuccess) {\n      throw new Error('Failed to login to HDBank');\n    } else {\n      this.logger.log(`[${deviceId}] - Login successfully`);\n    }\n    const availableAmount = await this.getBalance(deviceId);\n    if (availableAmount) {\n      await this.deviceService.updateDeviceConfig(deviceId, { availableAmount });\n    } else {\n      this.logger.warn(`[${deviceId}] - Get balance failed`);\n    }\n  }\n\n  async executeExternalTransfer(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    const verifiedAccount = await this.clickAndWaitForScreen(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n      HD_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n      {\n        expectedTexts: [withdrawal.beneficiaryName],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n      }\n    )\n    if (!verifiedAccount) {\n      ;\n      throw new WithdrawalProcessingError(\n        'Choose wrong image qrcode',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Kim tra tn ti khon'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Verified account name screen`);\n    }\n\n    //Step 5: Swipe up to continue button\n    await sleep(500);\n    const doesSwipeSuccess = await this.swipeAndWaitForScreen(deviceConfig.deviceId, { type: PandaSwipeTypeEnum.SWIPE_UP }, {\n      expectedTexts: ['danh ba th hng'],\n      timeout: 10_000,\n      pollInterval: 500,\n      roi: HD_ROI_EXPECTED.SWIPE_UP_SCREEN,\n      preprocess: {\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesSwipeSuccess) {\n      throw new WithdrawalProcessingError(\n        'Swipe up failed',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Vut ln  tip tc'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Swipe up screen`);\n    }\n\n    // Step 5.5: Continue transaction and expect transaction verification\n    await this.clickWithTransition(deviceConfig.deviceId, HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x, HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y, 500);\n\n    // Step 6: Get screen state\n    const screenHint = await this.detectScreenByHint(deviceConfig.deviceId,\n      HD_SCREEN_OTP_HINT,\n      {\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.OTP_ENTER_OR_CONTINUE_TRANSFER,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    );\n\n    if (!screenHint) {\n      throw new WithdrawalProcessingError(\n        'Couldn\\'t get HD Screen state not found',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Ly trng thi mn hnh OTP'\n      );\n    } else {\n      await sleep(1000);\n      switch (screenHint.name) {\n        case HD_SCREEN_HINT_NAME.ENTER_OTP:\n          // Step 6.5: Enter OTP\n          await this.inputSmartOTPFromConfig(deviceConfig.deviceId);\n          await sleep(1000);\n          const isConfirmAfterOTP = await this.verifyScreenState(deviceConfig.deviceId, {\n            expectedTexts: ['OTP s t ng lm mi'],\n            timeout: 30_000,\n            pollInterval: 500,\n            roi: HD_ROI_EXPECTED.CONFIRM_AFTER_OTP,\n            preprocess: {\n              grayscale: true,\n              enhanceContrast: true\n            }\n          });\n\n          if (!isConfirmAfterOTP) {\n            throw new WithdrawalProcessingError(\n              'Confirm after OTP screen not found',\n              ErrorType.FORCE_LOGIN_AND_REQUEUE,\n              'Failed: MH Xc nhn OTP'\n            );\n          } else {\n            this.logger.log(`[${deviceConfig.accountName}] - Get Confirm after OTP screen`);\n          }\n\n          break;\n        case HD_SCREEN_HINT_NAME.TRANSACTION_VERIFY_NO_INPUT_OTP:\n          await sleep(3000);\n          break;\n        default:\n          throw new WithdrawalProcessingError('Unknown screen state', ErrorType.FORCE_LOGIN_AND_REQUEUE);\n      }\n    }\n\n    // Step 7: Click transfer button\n    const isWrongOtpScreen = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Mt khu giao dch khng ng'],\n        timeout: 5_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.WRONG_OTP_SCREEN,\n        preprocess: {\n          // increase constrast for image recognition\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    );\n\n    if (!isWrongOtpScreen) {\n      const doesTransactionSucceeded = await this.verifyScreenState(deviceConfig.deviceId, {\n        expectedTexts: ['GIAO DCH THNH CNG'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.TRANSACTION_SUCCESS,\n        preprocess: {\n          // increase constrast for image recognition\n          grayscale: true,\n          enhanceContrast: true\n        }\n      });\n\n      if (!doesTransactionSucceeded) {\n        throw new WithdrawalProcessingError(\n          'Transaction verify screen not found',\n          ErrorType.NO_BILL_AFTER_OTP,\n          'Failed: MH Chuyn tin thnh cng'\n        );\n      } else {\n        this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n      }\n    } else {\n      await this.clickWithTransition(\n        deviceConfig.deviceId,\n        HD_UI_COORDINATES.TURN_OFF_WRONG_OTP_POPUP.x,\n        HD_UI_COORDINATES.TURN_OFF_WRONG_OTP_POPUP.y,\n        1000\n      );\n\n      const doesTransactionSucceeded = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n        HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n        HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n        {\n          expectedTexts: ['GIAO DCH THNH CNG'],\n          timeout: 30_000,\n          pollInterval: 500,\n          roi: HD_ROI_EXPECTED.TRANSACTION_SUCCESS,\n          preprocess: {\n            // increase constrast for image recognition\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      );\n\n      if (!doesTransactionSucceeded) {\n        throw new WithdrawalProcessingError(\n          'Transaction verify screen not found',\n          ErrorType.NO_BILL_AFTER_OTP,\n          'Failed: MH Chuyn tin thnh cng'\n        );\n      } else {\n        this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n      }\n    }\n\n    // Step 8: Finding bill area for capture\n    await sleep(1000);\n    await this.wsService.swipe(deviceConfig.deviceId, { type: PandaSwipeTypeEnum.SCROLL_DOWN });\n\n\n    // Step 9: Capture screen\n    await sleep(1000);\n    await this.captureScreen(deviceConfig.deviceId, { folderPath: withdrawal.withdrawalCode });\n    await sleep(2000);\n\n  }\n\n  async executeInternalTransfer(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    const verifiedAccountNumber = await this.clickAndWaitForScreen(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n      HD_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n      {\n        expectedTexts: [withdrawal.beneficiaryAccountNo],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.VERIFY_ACCOUNT_NUMBER,\n      }\n    )\n    if (!verifiedAccountNumber) {\n      ;\n      throw new WithdrawalProcessingError(\n        'Choose wrong image qrcode',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Kim tra s ti khon'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Verified account number screen`);\n    }\n\n    //Step 5: Swipe up to continue button\n    await sleep(500);\n    const doesSwipeSuccess = await this.swipeAndWaitForScreen(deviceConfig.deviceId, { type: PandaSwipeTypeEnum.SWIPE_UP }, {\n      expectedTexts: ['danh ba th hng'],\n      timeout: 10_000,\n      pollInterval: 500,\n      roi: HD_ROI_EXPECTED.INTERNAL_SWIPE_UP_SCREEN,\n      preprocess: {\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesSwipeSuccess) {\n      throw new WithdrawalProcessingError(\n        'Swipe up failed',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Vut ln  tip tc'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Swipe up screen`);\n    }\n\n    // Step 5.5: Continue transaction and expect transaction verification\n    await this.clickWithTransition(deviceConfig.deviceId, HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x, HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y, 500);\n\n    // Step 6: Get screen state\n    const screenHint = await this.detectScreenByHint(deviceConfig.deviceId,\n      HD_SCREEN_OTP_HINT,\n      {\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.OTP_ENTER_OR_CONTINUE_TRANSFER,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    );\n\n    if (!screenHint) {\n      throw new WithdrawalProcessingError(\n        'Couldn\\'t get HD Screen state not found',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Ly trng thi mn hnh OTP'\n      );\n    } else {\n      await sleep(1000);\n      switch (screenHint.name) {\n        case HD_SCREEN_HINT_NAME.ENTER_OTP:\n          // Step 6.5: Enter OTP\n          await this.inputSmartOTPFromConfig(deviceConfig.deviceId);\n          await sleep(1000);\n          const isConfirmAfterOTP = await this.verifyScreenState(deviceConfig.deviceId, {\n            expectedTexts: ['OTP s t ng lm mi'],\n            timeout: 30_000,\n            pollInterval: 500,\n            roi: HD_ROI_EXPECTED.CONFIRM_AFTER_OTP,\n            preprocess: {\n              grayscale: true,\n              enhanceContrast: true\n            }\n          });\n\n          if (!isConfirmAfterOTP) {\n            throw new WithdrawalProcessingError(\n              'Confirm after OTP screen not found',\n              ErrorType.FORCE_LOGIN_AND_REQUEUE,\n              'Failed: MH Xc nhn OTP'\n            );\n          } else {\n            this.logger.log(`[${deviceConfig.accountName}] - Get Confirm after OTP screen`);\n          }\n\n          break;\n        case HD_SCREEN_HINT_NAME.TRANSACTION_VERIFY_NO_INPUT_OTP:\n          await sleep(3000);\n          break;\n        default:\n          throw new WithdrawalProcessingError('Unknown screen state', ErrorType.FORCE_LOGIN_AND_REQUEUE);\n      }\n    }\n\n    // Step 6: Verify account name\n    const verifiedAccountName = await this.verifyScreenState(deviceConfig.deviceId, {\n      expectedTexts: [withdrawal.beneficiaryName],\n      timeout: 30_000,\n      pollInterval: 500,\n      roi: HD_ROI_EXPECTED.VERIFY_ACCOUNT_NAME_INTERNAL,\n    });\n\n    if (!verifiedAccountName) {\n      throw new WithdrawalProcessingError(\n        'Choose wrong account name',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: Tra tn ti khon ni b HDBANK'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Verified account number screen`);\n    }\n\n    // Step 7: Click transfer button\n    const isWrongOtpScreen = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Mt khu giao dch khng ng'],\n        timeout: 5_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.WRONG_OTP_SCREEN,\n        preprocess: {\n          // increase constrast for image recognition\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    );\n\n    if (!isWrongOtpScreen) {\n      const doesTransactionSucceeded = await this.verifyScreenState(deviceConfig.deviceId, {\n        expectedTexts: ['GIAO DCH THNH CNG'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.TRANSACTION_SUCCESS,\n        preprocess: {\n          // increase constrast for image recognition\n          grayscale: true,\n          enhanceContrast: true\n        }\n      });\n\n      if (!doesTransactionSucceeded) {\n        throw new WithdrawalProcessingError(\n          'Transaction verify screen not found',\n          ErrorType.NO_BILL_AFTER_OTP,\n          'Failed: MH Chuyn tin thnh cng'\n        );\n      } else {\n        this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n      }\n    } else {\n      await this.clickWithTransition(\n        deviceConfig.deviceId,\n        HD_UI_COORDINATES.TURN_OFF_WRONG_OTP_POPUP.x,\n        HD_UI_COORDINATES.TURN_OFF_WRONG_OTP_POPUP.y,\n        1000\n      );\n\n      const doesTransactionSucceeded = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n        HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n        HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n        {\n          expectedTexts: ['GIAO DCH THNH CNG'],\n          timeout: 30_000,\n          pollInterval: 500,\n          roi: HD_ROI_EXPECTED.TRANSACTION_SUCCESS,\n          preprocess: {\n            // increase constrast for image recognition\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      );\n\n      if (!doesTransactionSucceeded) {\n        throw new WithdrawalProcessingError(\n          'Transaction verify screen not found',\n          ErrorType.NO_BILL_AFTER_OTP,\n          'Failed: MH Chuyn tin thnh cng'\n        );\n      } else {\n        this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n      }\n    }\n\n    // Step 8: Finding bill area for capture\n    await sleep(1000);\n    await this.wsService.swipe(deviceConfig.deviceId, { type: PandaSwipeTypeEnum.SCROLL_DOWN });\n\n\n    // Step 9: Capture screen\n    await sleep(1000);\n    await this.captureScreen(deviceConfig.deviceId, { folderPath: withdrawal.withdrawalCode });\n    await sleep(2000);\n\n  }\n\n  async executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    this.logger.log(`Executing HDBank transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceConfig.deviceId}`);\n\n    // Step 1: Click QR code button\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.QR_CODE_BTN.x,\n      HD_UI_COORDINATES.QR_CODE_BTN.y,\n      3000\n    )\n\n    await sleep(2000)\n\n    const doesClickImageLibrarySuccess = await this.clickAndWaitForScreen(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.IMAGE_LIBRARY_BTN.x,\n      HD_UI_COORDINATES.IMAGE_LIBRARY_BTN.y,\n      {\n        expectedTexts: ['nh'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.ALBUM_SCREEN\n      }\n    )\n\n    if (!doesClickImageLibrarySuccess) {\n      throw new WithdrawalProcessingError(\n        'Failed to click image library button',\n        ErrorType.FORCE_LOGIN_AND_REQUEUE,\n        'Failed: M th vin nh'\n      );\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get image library screen`);\n    }\n\n\n    // Step 3: Click first image\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.FIRST_IMAGE_BTN.x,\n      HD_UI_COORDINATES.FIRST_IMAGE_BTN.y,\n      2000\n    )\n\n    if (withdrawal.bankCode === BankCodeWithdrawal.HDBank) {\n      await this.executeInternalTransfer(withdrawal, deviceConfig);\n    } else {\n      await this.executeExternalTransfer(withdrawal, deviceConfig);\n    }\n  }\n\n  async goToHomeScreenFromBill(deviceConfig: DeviceConfig) {\n    // Force login to go to home screen\n    await this.login(deviceConfig.deviceId);\n  }\n\n  /**\n   * Extract account balance from screen\n   * ROI da trn screenshot balance ca HDBank\n   */\n  async getBalance(deviceId: string): Promise<number | null> {\n    try {\n      await sleep(2000);\n      const doesGetBalanceSuccess = await this.clickAndWaitForScreen(deviceId,\n        HD_UI_COORDINATES.INTERNAL_TRANSFER.x,\n        HD_UI_COORDINATES.INTERNAL_TRANSFER.y,\n        {\n          expectedTexts: ['VND'],\n          timeout: 20_000,\n          pollInterval: 500,\n          roi: HD_ROI_EXPECTED.ACCOUNT_BALANCE_NUMBER,\n        }\n      );\n\n      if (!doesGetBalanceSuccess) {\n        return 0;\n      }\n\n      // Extract balance from ROI using helper method from base class\n      return await this.extractBalanceFromROI(deviceId, HD_ROI_EXPECTED.ACCOUNT_BALANCE_NUMBER);\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error extracting balance: ${error.message}`, error.stack);\n      return 0;\n    }\n  }\n\n\n  async onModuleInit() {\n    // await sleep(15000);\n\n    //  await this.executeTransferWithQRCode({\n    //     _id: '8746238746783264',\n    //     withdrawalId: 'WDR0912368',\n    //     withdrawalCode: 'WDR091236898',\n    //     bankCode: 'VIETCOMBANK',\n    //     beneficiaryAccountNo: '00125412001',\n    //     beneficiaryName: 'Nguyen Ngoc NHat Nam',\n    //     amount: 2500,\n    //     status: 'pending',\n    //     description: '1',\n    //     transferCode: \"00020101021238550010A000000727012500069704230111001254120010208QRIBFTTA53037045405100005802VN63047B1E\",\n    //     createdAt: new Date().toDateString(),\n    //   }, {\n    //     deviceId: 'd82a6bc97f69542441e28342da9ef4280da5275e',\n    //     availableAmount: 1000000,\n    //     status: 'active',\n    //     password: '686868',\n    //     smartOTP: '868686',\n    //     bankCode: 'HDBANK',\n    //     accountNo: '00125412001',\n    //     accountName: 'Nguyen Huy Phong',\n    //   }\n    //   )\n\n    // await this.launchApp('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await sleep(5000);\n    // await this.login('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await this.executeExternalTransfer({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   beneficiaryAccountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // }, 'dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // const billImage = await this.analyzeTransferBill({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   accountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // });\n    // console.log(billImage);\n  }\n\n  onModuleDestroy(): void {\n    // this.killApp('590f1f9603f09330cf235485c6e76b10d0759a55');\n  }\n}\n\n","// HC PG UI Element Coordinates (normalized 0-1)\n\nimport { config } from \"@/common/constants/config\";\nimport { scaleCoordinates } from \"@/common/constants/keyboard\";\n\nconst HC_HD_UI_COORDINATES = {\n  LOGIN_BTN: {\n    x: 0.5,\n    y: 0.6,\n  },\n  PASSWORD_FIELD: {\n    x: 0.5,\n    y: 0.5,\n  },\n  TRANSFER_BTN: {\n    x: 0.7,\n    y: 0.7,\n  },\n  TRANSFER_INTERNAL_BTN: {\n    x: 0.2,\n    y: 0.2\n  },\n  TRANSFER_EXTERNAL_BTN: {\n    x: 0.4,\n    y: 0.2,\n  },\n  CLOSE_ALLOW_CONTACT_POPUP_BTN: {\n    x: 0.3,\n    y: 0.6,\n  },\n  ACCOUNT_NUMBER_INPUT: {\n    x: 0.4,\n    y: 0.43,\n  },\n  SELECT_BANK_BTN: {\n    x: 0.4,\n    y: 0.47,\n  },\n  SEARCH_BANK_BTN: {\n    x: 0.4,\n    y: 0.48,\n  },\n  INTERNAL_AMOUNT_INPUT: {\n    x: 0.5,\n    y: 0.6,\n  },\n  HIDE_NUMPAD_BTN: {\n    x: 0.05,\n    y: 0.4,\n  },\n  CONTINUE_TRANSFER_BTN: {\n    x: 0.5,\n    y: 0.85,\n  },\n  BANK_SEARCH_BTN: {\n    x: 0.4,\n    y: 0.45,\n  },\n  BANK_SEARCH_INPUT: {\n    x: 0.4,\n    y: 0.45,\n  },\n  EXTERNAL_AMOUNT_INPUT: {\n    x: 0.3,\n    y: 0.37,\n  },\n  BACK_TO_HOME: {\n    x: 0.2,\n    y: 0.98,\n  },\n  QR_CODE_BTN: {\n    x: 0.5,\n    y: 0.95,\n  },\n  IMAGE_LIBRARY_BTN: {  \n    x: 0.5,\n    y: 0.85,\n  },\n  FIRST_IMAGE_BTN: {  \n    x: 0.3,\n    y: 0.3,\n  },\n  SELECT_IMAGE_QR_CODE_BTN: {  \n    x: 0.95,\n    y: 0.95,\n  },\n  HOME_ICON: {  \n    x: 0.11,\n    y: 0.94,\n  },\n  CLOSE_WARNING_TRANSACTION_POPUP: {\n    x: 0.73,\n    y: 0.62,\n  },\n  INTERNAL_TRANSFER: {\n    x: 0.11,\n    y: 0.93,\n  },\n  TURN_OFF_WRONG_OTP_POPUP: {\n    x: 0.5,\n    y: 0.6,\n  },\n};\n\nconst PANDA_HD_UI_COORDINATES = scaleCoordinates(HC_HD_UI_COORDINATES);\n\nexport const HD_UI_COORDINATES = config.boxType === 'PANDA' ? PANDA_HD_UI_COORDINATES : HC_HD_UI_COORDINATES;\n\nexport const HD_SCREEN_HINT_NAME = {\n  ENTER_OTP: 'ENTER_OTP',\n  TRANSACTION_VERIFY_NO_INPUT_OTP: 'TRANSACTION_VERIFY_NO_INPUT_OTP',\n}\n\nexport const HD_SCREEN_OTP_HINT = [\n  {\n    name: HD_SCREEN_HINT_NAME.ENTER_OTP,\n    hint: 'Vui long nhap ma PIN HDBank OTP',\n  },\n  {\n    name: HD_SCREEN_HINT_NAME.TRANSACTION_VERIFY_NO_INPUT_OTP,\n    hint: 'OTP se tu dong lam moi',\n  }\n]\n","export type PandaSwipeType = '0' | '1' | '2' | '4' | '5' | '6' | '7' | '8' | '9' | '10';\nexport enum PandaSwipeTypeEnum {\n  SCROLL_UP = '4',\n  SCROLL_DOWN = '5',\n  SWIPE_UP = '6',\n  SWIPE_DOWN = '7',\n  SWIPE_LEFT = '8',\n  SWIPE_RIGHT = '9',\n  CLICK = '0',\n}","import { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\nimport { Inject, Injectable } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\n\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { BankCodeWithdrawal } from './constants/bank-code';\nimport { VCB_ROI_EXPECTED } from './constants/vcb-roi';\nimport { VCB_UI_COORDINATES } from './constants/vietcombank';\nimport { PandaSwipeTypeEnum } from './constants/pandaSwipType';\nimport { ImagePreprocessingService } from '../ocr/services/image-preprocessing.service';\n\n@Injectable()\nexport class VietcombankService {\n// extends BaseBankService {\n  // protected readonly BANK_CODE = 'VIETCOMBANK';\n  // protected readonly BUNDLE_ID = 'com.vcb.VCB';\n\n  // constructor(\n  //   @Inject(WEBSOCKET_SERVICE)\n  //   protected readonly wsService: IWebSocketService,\n  //   deviceService: DeviceService,\n  //   ocrService: OCRService,\n  //   imagePreprocessingService: ImagePreprocessingService\n  // ) {\n  //   super(wsService, deviceService, ocrService, imagePreprocessingService);\n  // }\n\n  // private async inputPasswordFromConfig(deviceId: string): Promise<void> {\n  //   const config = await this.deviceService.getDeviceConfig(deviceId);\n  //   if (!config || !config.password) {\n  //     throw new Error(`Password not configured for device ${deviceId}`);\n  //   }\n    \n  //   // Click password field and wait for UI to be ready\n  //   await this.clickWithTransition(deviceId, VCB_UI_COORDINATES.PASSWORD_FIELD.x, VCB_UI_COORDINATES.PASSWORD_FIELD.y, 1500);\n\n  //   // Attempt to input password\n  //   await this.wsService.inputText(deviceId, config.password);\n  //   await sleep(1000);\n  //   await this.wsService.pressReturnKey(deviceId);\n  //   await sleep(500);\n  // }\n\n  // private async inputSmartOTPFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n  //   const config = await this.deviceService.getDeviceConfig(deviceId);\n  //   if (!config || !config.smartOTP) {\n  //     throw new Error(`SmartOTP not configured for device ${deviceId}`);\n  //   }\n    \n  //   await sleep(500);\n  //   await this.wsService.inputText(deviceId, config.smartOTP);\n  // }\n\n  // async launchApp(deviceId: string) {\n  //   await this.wsService.launchApp(deviceId, this.BUNDLE_ID);\n  //   const doesLaunchAppSuccess = await this.verifyScreenState(deviceId, {\n  //     expectedTexts: ['ng nhp'],\n  //     timeout: 10_000,\n  //     pollInterval: 500,\n  //     roi: VCB_ROI_EXPECTED.LAUNCH_APP,\n  //     preprocess: {\n  //       // increase constrast for image recognition\n  //       grayscale: true,\n  //       enhanceContrast: true\n  //     }\n  //   });\n\n  //   if (!doesLaunchAppSuccess) {\n  //     throw new WithdrawalProcessingError('Failed to launch VIETCOMBANK app', ErrorType.FORCE_LOGIN_AND_REQUEUE);\n  //   } else {\n  //     this.logger.log(`[${deviceId}] - Get login app screen`);\n  //   }\n  // }\n\n  // /**\n  //  * Login to PG bank\n  //  */\n  // async login(deviceId: string): Promise<void> {\n  //   // Step 0: Kill app\n  //   await this.killApp(deviceId);\n  //   await sleep(2000);\n\n  //   // Step 1: Launch app\n  //   await this.launchApp(deviceId);\n\n  //   await this.verifyScreenState(deviceId, {\n  //     expectedTexts: ['ng nhp'],\n  //     timeout: 20_000,\n  //     pollInterval: 500,\n  //     roi: VCB_ROI_EXPECTED.LAUNCH_APP,\n  //   });\n\n  //   // Step 2: Input password\n  //   await this.inputPasswordFromConfig(deviceId);\n\n  //   // Step 3: Click login button\n  //   const doesLoginSuccess = await this.clickAndWaitForScreen(deviceId,\n  //     VCB_UI_COORDINATES.LOGIN_BTN.x,\n  //     VCB_UI_COORDINATES.LOGIN_BTN.y,\n  //     {\n  //       expectedTexts: ['Chc nng a thch'],\n  //       timeout: 20_000,\n  //       pollInterval: 500,\n  //       roi: VCB_ROI_EXPECTED.HOME_SCREEN,\n  //     }\n  //   );\n\n  //   if (!doesLoginSuccess) {\n  //     throw new WithdrawalProcessingError('Failed to login to VIETCOMBANK', ErrorType.FORCE_LOGIN_AND_REQUEUE);\n  //   } else {\n  //     this.logger.log(`[${deviceId}] - Login successfully`);\n  //   }\n  // }\n\n  // async executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n  //   this.logger.log(`Executing VIETCOMBANK transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceConfig.deviceId}`);\n\n  //   // Step 1: Click QR code button\n  //   await this.clickWithTransition(\n  //     deviceConfig.deviceId,\n  //     VCB_UI_COORDINATES.QR_CODE_BTN.x,\n  //     VCB_UI_COORDINATES.QR_CODE_BTN.y,\n  //     3000\n  //   )\n\n  //   await sleep(2000)\n\n  //   const doesClickImageLibrarySuccess = await this.clickAndWaitForScreen(\n  //     deviceConfig.deviceId,\n  //     VCB_UI_COORDINATES.IMAGE_LIBRARY_BTN.x,\n  //     VCB_UI_COORDINATES.IMAGE_LIBRARY_BTN.y,\n  //     {\n  //       expectedTexts: ['nh', 'Album'],\n  //       timeout: 30_000,\n  //       pollInterval: 500,\n  //       roi: VCB_ROI_EXPECTED.ALBUM_SCREEN,\n  //     }\n  //   )\n\n  //   if (!doesClickImageLibrarySuccess) {\n  //     throw new WithdrawalProcessingError('Failed to click image library button', ErrorType.FORCE_LOGIN_AND_REQUEUE);\n  //   } else {\n  //     this.logger.log(`[${deviceConfig.accountName}] - Get image library screen`);\n  //   }\n    \n\n  //   // Step 3: Click first image\n  //   const verifiedAccount = await this.clickAndWaitForScreen(\n  //     deviceConfig.deviceId,\n  //     VCB_UI_COORDINATES.FIRST_IMAGE_BTN.x,\n  //     VCB_UI_COORDINATES.FIRST_IMAGE_BTN.y,\n  //     {\n  //       expectedTexts: [withdrawal.beneficiaryName],\n  //       timeout: 30_000,\n  //       pollInterval: 500,\n  //       roi: VCB_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n  //     }\n  //   )\n\n  //   // Step 4: Verify account name\n  //   // let verifiedAccount = false;\n  //   // if (withdrawal.bankCode === BankCodeWithdrawal.VIETCOMBANK) {\n  //   //   verifiedAccount = await this.clickAndWaitForScreen(\n  //   //     deviceConfig.deviceId,\n  //   //     VCB_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n  //   //     VCB_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n  //   //     {\n  //   //       expectedTexts: [withdrawal.beneficiaryAccountNo],\n  //   //       timeout: 30_000,\n  //   //       pollInterval: 500,\n  //   //       roi: VCB_ROI_EXPECTED.VERIFY_ACCOUNT_NUMBER,\n  //   //     }\n  //   //   )\n  //   // } else {\n  //   //   verifiedAccount = await this.clickAndWaitForScreen(\n  //   //     deviceConfig.deviceId,\n  //   //     VCB_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n  //   //     VCB_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n  //   //     {\n  //   //       expectedTexts: [withdrawal.beneficiaryName],\n  //   //       timeout: 30_000,\n  //   //       pollInterval: 500,\n  //   //       roi: VCB_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n  //   //     }\n  //   //   )\n  //   // }\n\n  //   if (!verifiedAccount) {\n  //     await this.clickWithTransition(deviceConfig.deviceId, VCB_UI_COORDINATES.HOME_ICON.x, VCB_UI_COORDINATES.HOME_ICON.y, 2000);\n  //     throw new WithdrawalProcessingError('Choose wrong image qrcode', ErrorType.TEMPORARY);\n  //   } else {\n  //     this.logger.log(`[${deviceConfig.accountName}] - Get Verified account name screen`);\n  //   }\n\n  //   // await this.wsService.swipe(deviceConfig.deviceId, {type: PandaSwipeTypeEnum.SWIPE_UP});\n\n  //   // Step 5: Continue transaction and expect transaction verification\n  //   const doesTransactionVerify = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n  //     VCB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n  //     VCB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n  //     {\n  //       expectedTexts: ['kim tra v xc nhn'],\n  //       timeout: 30_000,\n  //       pollInterval: 500, \n  //       roi: VCB_ROI_EXPECTED.TRANSACTION_VERIFY,\n  //     }\n  //   )\n\n  //   if (!doesTransactionVerify) {\n  //     throw new WithdrawalProcessingError('Transaction verification screen not found', ErrorType.FORCE_LOGIN_AND_REQUEUE);\n  //   } else {\n  //     this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verification screen`);\n  //   }\n\n\n  //   const doesOTPEnterSuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n  //     VCB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n  //     VCB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n  //     {\n  //       expectedTexts: ['smart OTP'],\n  //       timeout: 30_000,\n  //       pollInterval: 500, \n  //       roi: VCB_ROI_EXPECTED.OTP_ENTER,\n  //     }\n  //   )\n    \n    \n  //   if (!doesOTPEnterSuccess) {\n  //     throw new WithdrawalProcessingError('Transaction verify screen not found', ErrorType.FORCE_LOGIN_AND_REQUEUE);\n  //   } else {\n  //     this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n  //   }\n  //       // Step 5: Enter OTP\n  //   await this.inputSmartOTPFromConfig(deviceConfig.deviceId);\n  //   await sleep(500);\n\n  //   const doesOTPVerifySuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n  //     VCB_UI_COORDINATES.OTP_ENTER_TRANSFER_BTN.x,\n  //     VCB_UI_COORDINATES.OTP_ENTER_TRANSFER_BTN.y,\n  //     {\n  //       expectedTexts: ['M xc thc giao dch'],\n  //       timeout: 30_000,\n  //       pollInterval: 500, \n  //       roi: VCB_ROI_EXPECTED.OTP_VERIFY,\n  //     }\n  //   )\n    \n    \n  //   if (!doesOTPVerifySuccess) {\n  //     throw new WithdrawalProcessingError('Transaction verify screen not found', ErrorType.NO_BILL_AFTER_OTP);\n  //   } else {\n  //     this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n  //   }\n\n  //   const doesTransactionSuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n  //     VCB_UI_COORDINATES.CONTINUE_OTP_VERIFY_BTN.x,\n  //     VCB_UI_COORDINATES.CONTINUE_OTP_VERIFY_BTN.y,\n  //     {\n  //       expectedTexts: ['Giao dch thnh cng'],\n  //       timeout: 30_000,\n  //       pollInterval: 500, \n  //       roi: VCB_ROI_EXPECTED.TRANSACTION_SUCCESS,\n  //       preprocess: {\n  //         // increase constrast for image recognition\n  //         grayscale: true,\n  //         enhanceContrast: true\n  //       }\n\n  //     }\n  //   )\n    \n  //   if (!doesTransactionSuccess) {\n  //     throw new WithdrawalProcessingError('Transaction success screen not found', ErrorType.NO_BILL_AFTER_OTP);\n  //   } else {\n  //     this.logger.log(`[${deviceConfig.accountName}] - Get Transaction success screen`);\n  //   }\n\n\n    \n  //   // Step 6: Capture screen\n  //   await sleep(500);\n  //   await this.captureScreen(deviceConfig.deviceId, { folderPath: withdrawal.withdrawalCode });\n\n  //   // Step 7: Back to home\n  //   await this.clickWithTransition(\n  //     deviceConfig.deviceId,\n  //     VCB_UI_COORDINATES.HOME_ICON.x,\n  //     VCB_UI_COORDINATES.HOME_ICON.y,\n  //     5000,\n  //     `[${deviceConfig.accountName}] - Get back to home screen`\n  //   );\n  // }\n\n  // async goToHomeScreenFromBill() {\n  //   console.warn('VCB not implement');\n  // }\n\n  // async getBalance(deviceId: string): Promise<number | null> {\n  //   return 0;\n  // }\n\n  // /**\n  //  * Extract transaction amount t khung mu   cui mn hnh\n  //  * ROI da trn screenshot \"Kt qu giao dch\" ca VIETCOMBANK\n  //  */\n  // async extractTransactionAmount(imagePath: string): Promise<number | null> {\n  //   try {\n  //     const result = await this.ocrService.recognizeFromFile(imagePath, {\n  //       fieldType: 'singleLine',\n  //       customROI: {\n  //         x: 0.05,      // 5% from left (c margin nh)\n  //         y: 0.75,      // 75% from top (khong cui white card)\n  //         width: 0.9,   // 90% width (full width tr margin)\n  //         height: 0.12, // 12% height (  cha text + padding)\n  //       },\n  //       preprocess: {\n  //         grayscale: true,        // Chuyn sang grayscale\n  //         enhanceContrast: true,  // Tng contrast cho text trn nn \n  //       },\n  //     });\n\n  //     if (!result) {\n  //       this.logger.warn('Failed to extract transaction amount from ROI');\n  //       return null;\n  //     }\n\n  //     // Clean s tin: ch ly s v du phy/chm\n  //     const amountText = result.text.replace(/[^\\d.,]/g, '').replace(/,/g, '');\n  //     const amount = parseFloat(amountText);\n\n  //     if (isNaN(amount)) {\n  //       this.logger.warn(`Could not parse amount from OCR text: ${result.text}`);\n  //       return null;\n  //     }\n\n  //     this.logger.log(\n  //       `Extracted transaction amount: ${amount.toLocaleString('vi-VN')} VND ` +\n  //       `(confidence: ${result.confidence.toFixed(2)}%, time: ${result.processingTime}ms)`\n  //     );\n\n  //     return amount;\n  //   } catch (error) {\n  //     this.logger.error(`Error extracting transaction amount: ${error.message}`, error.stack);\n  //     return null;\n  //   }\n  // }\n\n\n  // async onModuleInit() {\n  //   // sleep(5000);\n  //   // await this.executeTransferWithQRCode({\n  //   //     _id: '8746238746783264',\n  //   //     withdrawalId: 'WDR0912368',\n  //   //     withdrawalCode: 'WDR091236898',\n  //   //     bankCode: 'VIETCOMBANK',\n  //   //     beneficiaryAccountNo: '00125412001',\n  //   //     beneficiaryName: 'Nguyen Huy Phong',\n  //   //     amount: 2500,\n  //   //     status: 'pending',\n  //   //     description: '1',\n  //   //     transferCode: \"00020101021238550010A000000727012500069704230111001254120010208QRIBFTTA53037045405100005802VN63047B1E\",\n  //   //     createdAt: new Date().toDateString(),\n  //   //   }, {\n  //   //     deviceId: '28be90c4f8da3c9def8d0f4fe3a8efcb70367738',\n  //   //     availableAmount: 1000000,\n  //   //     status: 'active',\n  //   //     password: '123456',\n  //   //     smartOTP: '123456',\n  //   //     bankCode: 'VIETCOMBANK',\n  //   //     accountNo: '00125412001',\n  //   //     accountName: 'Nguyen Huy Phong',\n  //   //   }\n  //   //   )\n   \n  //   // await this.executeExternalTransfer({\n  //   //   _id: '8746238746783264',\n  //   //   withdrawalId: 'WDR0912368',\n  //   //   withdrawalCode: 'WDR091236898',\n  //   //   bankCode: 'TPBANK',\n  //   //   beneficiaryAccountNo: '00125412001',\n  //   //   beneficiaryName: 'Nguyen Huy Phong',\n  //   //   amount: 2500,\n  //   //   status: 'pending',\n  //   //   description: '1',\n  //   //   createdAt: new Date().toDateString(),\n  //   // }, 'dfe547d8200f554b5497ed89e2dbb47d57649356');\n  //   // const billImage = await this.analyzeTransferBill({\n  //   //   _id: '8746238746783264',\n  //   //   withdrawalId: 'WDR0912368',\n  //   //   withdrawalCode: 'WDR091236898',\n  //   //   bankCode: 'TPBANK',\n  //   //   accountNo: '00125412001',\n  //   //   beneficiaryName: 'Nguyen Huy Phong',\n  //   //   amount: 2500,\n  //   //   status: 'pending',\n  //   //   description: '1',\n  //   //   createdAt: new Date().toDateString(),\n  //   // });\n  //   // console.log(billImage);\n  // }\n\n  // onModuleDestroy(): void {\n  //   // this.killApp('590f1f9603f09330cf235485c6e76b10d0759a55');\n  // }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\n\nexport interface BankSessionConfig {\n  bankCode: string;\n  sessionTimeoutMs: number; // Session timeout in milliseconds\n  refreshBeforeMs: number; // Refresh session before this time (e.g., 1 minute before)\n}\n\nexport interface DeviceSession {\n  deviceId: string;\n  bankCode: string;\n  loginTime: number; // Timestamp when logged in\n  expiresAt: number; // Timestamp when session expires\n  status: 'logged_in' | 'logging_in' | 'expired';\n}\n\n@Injectable()\nexport class SessionManagementService {\n  private readonly logger = new Logger('SessionManagementService');\n  private readonly REDIS_SESSION_PREFIX = 'bank:session:';\n  \n  // Session timeout configuration for each bank (in milliseconds)\n  private readonly BANK_SESSION_CONFIGS: Map<string, BankSessionConfig> = new Map([\n    [\n      'ACB',\n      {\n        bankCode: 'ACB',\n        sessionTimeoutMs: 60 * 60 * 1000, // 60 minutes\n        refreshBeforeMs: 1 * 60 * 1000, // Refresh 1 minute before expiry\n      },\n    ],\n    [\n      'PGBANK',\n      {\n        bankCode: 'PGBANK',\n        sessionTimeoutMs: 4.5 * 60 * 1000, // 4.5 minutes\n        refreshBeforeMs: 30 * 1000, // Refresh 30 seconds before expiry\n      },\n    ],\n    [\n      'HDBANK',\n      {\n        bankCode: 'HDBANK',\n        sessionTimeoutMs: 7.5 * 60 * 1000, // 4.5 minutes\n        refreshBeforeMs: 30 * 1000, // Refresh 30 seconds before expiry\n      },\n    ],\n  ]);\n\n  constructor(private readonly redisService: RedisService) {}\n\n  /**\n   * Get session timeout for a bank\n   */\n  getSessionTimeout(bankCode: string): number {\n    const config = this.BANK_SESSION_CONFIGS.get(bankCode.toUpperCase());\n    return config?.sessionTimeoutMs || 4.5 * 60 * 1000; // Default 4.5 minutes\n  }\n\n  /**\n   * Get refresh before time for a bank\n   */\n  getRefreshBeforeTime(bankCode: string): number {\n    const config = this.BANK_SESSION_CONFIGS.get(bankCode.toUpperCase());\n    return config?.refreshBeforeMs || 30 * 1000; // Default 30 seconds\n  }\n\n  /**\n   * Record login session for a device\n   */\n  async recordLogin(deviceId: string, bankCode: string): Promise<void> {\n    const timeout = this.getSessionTimeout(bankCode);\n    const expiresAt = Date.now() + timeout;\n    \n    const session: DeviceSession = {\n      deviceId,\n      bankCode: bankCode.toUpperCase(),\n      loginTime: Date.now(),\n      expiresAt,\n      status: 'logged_in',\n    };\n\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    await this.redisService.set(key, JSON.stringify(session), timeout);\n    \n    this.logger.log(`[${deviceId}] Recorded login session (bank: ${bankCode}, expires at: ${new Date(expiresAt).toISOString()})`);\n  }\n\n  /**\n   * Mark device as logging in\n   */\n  async markLoggingIn(deviceId: string, bankCode: string): Promise<void> {\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    const existing = await this.getSession(deviceId, bankCode);\n    \n    const session: DeviceSession = {\n      deviceId,\n      bankCode: bankCode.toUpperCase(),\n      loginTime: existing?.loginTime || Date.now(),\n      expiresAt: existing?.expiresAt || Date.now() + this.getSessionTimeout(bankCode),\n      status: 'logging_in',\n    };\n\n    await this.redisService.set(key, JSON.stringify(session), 5 * 60 * 1000); // 5 min TTL for login process\n    this.logger.log(`Marked device ${deviceId}, bank ${bankCode} as logging in`);\n  }\n\n  /**\n   * Get current session for a device\n   */\n  async getSession(deviceId: string, bankCode: string): Promise<DeviceSession | null> {\n    try {\n      const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n      const data = await this.redisService.get(key);\n      \n      if (!data) {\n        return null;\n      }\n\n      return JSON.parse(data) as DeviceSession;\n    } catch (error) {\n      this.logger.error(`Error getting session for device ${deviceId}, bank ${bankCode}: ${error.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Check if session is valid (not expired and not logging in)\n   */\n  async isSessionValid(deviceId: string, bankCode: string): Promise<boolean> {\n    const session = await this.getSession(deviceId, bankCode);\n    \n    if (!session) {\n      return false;\n    }\n\n    // Check if session is expired\n    if (session.expiresAt < Date.now()) {\n      return false;\n    }\n\n    // Check if device is currently logging in\n    if (session.status === 'logging_in') {\n      return false;\n    }\n\n    return session.status === 'logged_in';\n  }\n\n  /**\n   * Check if session needs refresh (within refresh window)\n   */\n  async needsRefresh(deviceId: string, bankCode: string): Promise<boolean> {\n    const session = await this.getSession(deviceId, bankCode);\n    \n    if (!session || session.status !== 'logged_in') {\n      return false;\n    }\n\n    const refreshBeforeTime = this.getRefreshBeforeTime(bankCode);\n    const timeUntilExpiry = session.expiresAt - Date.now();\n    \n    return timeUntilExpiry <= refreshBeforeTime;\n  }\n\n  /**\n   * Clear session\n   */\n  async clearSession(deviceId: string, bankCode: string): Promise<void> {\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    await this.redisService.del(key);\n    this.logger.log(`Cleared session for device ${deviceId}, bank ${bankCode}`);\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { EzpayBeClientService } from './ezpay-be-client.service';\nimport { IAnalyzeTransferBillResult } from '../bank/interfaces/bank-service.interface';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { IUpdateWithdrawal } from './interface/update-withdrawal';\n\n@Injectable()\nexport class NotificationService {\n  private readonly logger = new Logger('NotificationService');\n\n  constructor(\n    private readonly ezpayBeClient: EzpayBeClientService,\n  ) {}\n\n  async completeWithdrawal(\n    withdrawal: Withdrawal, \n    analysisResult: IAnalyzeTransferBillResult, \n    deviceConfig: DeviceConfig): Promise<void> \n  {\n    this.ezpayBeClient\n      .completeWithdrawal(withdrawal._id, {\n        analyzedStatus: analysisResult.analyzedStatus,\n        sourceAccountNo: deviceConfig.accountNo,\n        sourceBankCode: deviceConfig.bankCode,\n        sourceAccountName: deviceConfig.accountName,\n      }).catch((error) => {\n        this.logger.error(`[${withdrawal.withdrawalCode}] - Error updating withdrawal status for ${withdrawal._id} - ${error.stack}`);\n      });\n\n    this.ezpayBeClient\n      .uploadReceipt(withdrawal._id, analysisResult.rawPath)\n      .catch((error) => {\n        this.logger.error(`[${withdrawal.withdrawalCode}] - Error uploading receipt for ${withdrawal._id} - ${error.stack}`);\n      });\n  }\n\n  updateWithdrawal(id: string, data: IUpdateWithdrawal) {\n    return this.ezpayBeClient.updateWithdrawal(id, data);\n  }\n\n  uploadReceipt(id: string, receiptPath: string) {\n    return this.ezpayBeClient.uploadReceipt(id, receiptPath);\n  }\n\n  async completeInternalTransfer(\n    internalTransfer: Withdrawal, \n    analysisResult: IAnalyzeTransferBillResult\n  ): Promise<void> {\n    this.ezpayBeClient\n      .completeInternalTransfer(internalTransfer._id, {\n        analyzedStatus: analysisResult.analyzedStatus,\n      }).catch((error) => {\n        this.logger.error(`[${internalTransfer.withdrawalCode}] - Error updating internal transfer status for ${internalTransfer._id} - ${error.stack}`);\n      });\n\n    this.ezpayBeClient\n      .uploadInternalTransferReceipt(internalTransfer._id, analysisResult.rawPath)\n      .catch((error) => {\n        this.logger.error(`[${internalTransfer.withdrawalCode}] - Error uploading receipt for ${internalTransfer._id} - ${error.stack}`);\n      });\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { HttpService } from '@nestjs/axios';\nimport { firstValueFrom } from 'rxjs';\nimport { AxiosError } from 'axios';\nimport * as FormData from 'form-data';\nimport { createReadStream } from 'fs';\nimport { config } from '../../common/constants/config';\nimport { sleep } from '../../common/utils/time';\nimport { BillAnalyzedStatus } from '@/modules/bank/interfaces/bank-service.interface';\nimport { IUpdateWithdrawal } from './interface/update-withdrawal';\nimport { IUpdateInternalTransfer } from './interface/update-internal-transfer';\n\n@Injectable()\nexport class EzpayBeClientService {\n  private readonly logger = new Logger('EzpayBeClientService');\n  private readonly apiUrl: string;\n  private readonly apiKey: string;\n\n  constructor(\n    private readonly httpService: HttpService\n  ) {\n    this.apiUrl = config.ezpayBe.apiUrl ?? 'http://localhost:3001';\n    this.apiKey = config.ezpayBe.apiKey ?? '';\n  }\n\n  async completeWithdrawal(\n    withdrawalId: string,\n    payload: {\n      analyzedStatus: BillAnalyzedStatus,\n      sourceBankCode: string,\n      sourceAccountNo: string,\n      sourceAccountName: string,\n    }\n  ): Promise<boolean> {\n    const maxRetries = 3;\n    const baseDelay = 2000; // 2 seconds\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        const url = `${this.apiUrl}/api/internal/withdrawals/complete/${withdrawalId}`;\n\n        this.logger.log(`Updating withdrawal ${withdrawalId} status to ${payload.analyzedStatus} (attempt ${attempt + 1}/${maxRetries + 1})`);\n\n        const data = {\n          analyzedStatus: payload.analyzedStatus,\n          sourceBankCode: payload.sourceBankCode,\n          sourceAccountNo: payload.sourceAccountNo,\n          sourceAccountName: payload.sourceAccountName\n        };\n\n        const response = await firstValueFrom(\n          this.httpService.patch(url, data, {\n            headers: {\n              'Content-Type': 'application/json',\n              'X-API-Key': this.apiKey,\n              'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n            },\n            timeout: 20000,\n          }),\n        );\n\n        if (response.status === 200 || response.status === 204) {\n          this.logger.log(`Successfully updated withdrawal ${withdrawalId} status to ${payload.analyzedStatus}`);\n\n          return;\n        }\n\n        this.logger.warn(`Unexpected status code ${response.status} when updating withdrawal ${withdrawalId}`);\n      } catch (error) {\n        const axiosError = error as AxiosError;\n        const payload = axiosError.response?.data;\n        const errorMessage = axiosError.message;\n\n        if (attempt < maxRetries) {\n          const delay = baseDelay * Math.pow(2, attempt); // Exponential backoff\n          this.logger.warn(\n            `Failed to update withdrawal ${withdrawalId} (attempt ${attempt + 1}/${maxRetries + 1}): ${errorMessage}. Payload: ${JSON.stringify(payload)}, Retrying in ${delay}ms`,\n          );\n          await sleep(delay);\n        } else {\n          this.logger.error(\n            `Failed to update withdrawal ${withdrawalId} after ${maxRetries + 1} attempts. Payload: ${JSON.stringify(payload)}, Error: ${errorMessage}`,\n          );\n        }\n      }\n    }\n  }\n\n  async uploadReceipt(withdrawalId: string, receiptPath: string) {\n    const maxRetries = 3;\n    const baseDelay = 2000; // 2 seconds\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        const url = `${this.apiUrl}/api/internal/withdrawals/upload-receipt/${withdrawalId}`;\n\n        this.logger.log(`Uploading bill for withdrawal ${withdrawalId} (attempt ${attempt + 1}/${maxRetries + 1})`);\n\n        if (!receiptPath) {\n          this.logger.warn(`No receipt path provided for withdrawal ${withdrawalId}`);\n\n          return;\n        }\n\n        const formdata = new FormData();\n        formdata.append('receipt', createReadStream(receiptPath));\n\n        const response = await firstValueFrom(\n          this.httpService.patch(url, formdata, {\n            headers: {\n              ...formdata.getHeaders(),\n              'X-API-Key': this.apiKey,\n              'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n            },\n            timeout: 20000,\n          }),\n        );\n\n        if (response.status === 200 || response.status === 204) {\n          this.logger.log(`Successfully uploaded bill for withdrawal ${withdrawalId}`);\n\n          return;\n        }\n\n        this.logger.warn(`Unexpected status code ${response.status} when uploading bill for withdrawal ${withdrawalId}`);\n      } catch (error) {\n        const axiosError = error as AxiosError;\n        const response = axiosError.response?.data;\n        const errorMessage = axiosError.message;\n\n        if (attempt < maxRetries) {\n          const delay = baseDelay * Math.pow(2, attempt); // Exponential backoff\n          this.logger.warn(\n            `Failed to upload bill for withdrawal ${withdrawalId} (attempt ${attempt + 1}/${maxRetries + 1}): ${errorMessage}. Response: ${JSON.stringify(response)}, Retrying in ${delay}ms`,\n          );\n          await sleep(delay);\n        } else {\n          this.logger.error(\n            `Failed to upload bill for withdrawal ${withdrawalId} after ${maxRetries + 1} attempts. Response: ${JSON.stringify(response)}, Error: ${errorMessage}`,\n          );\n        }\n      }\n    }\n  }\n\n  updateWithdrawal(id: string, data: IUpdateWithdrawal) {\n    this.logger.log(`Updating withdrawal ${id} data ${JSON.stringify(data)}`);\n\n    const url = `${this.apiUrl}/api/internal/withdrawals/${id}`;\n\n    return firstValueFrom(\n      this.httpService.patch(url, data, {\n        headers: {\n          'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n        },\n      }),\n    );\n  }\n\n  async completeInternalTransfer(\n    withdrawalId: string,\n    payload: {\n      analyzedStatus: BillAnalyzedStatus,\n    }\n  ): Promise<boolean> {\n    const maxRetries = 3;\n    const baseDelay = 2000; // 2 seconds\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        const url = `${this.apiUrl}/api/internal/internal-transfers/complete/${withdrawalId}`;\n\n        this.logger.log(`Updating internal transfer ${withdrawalId} status to ${payload.analyzedStatus} (attempt ${attempt + 1}/${maxRetries + 1})`);\n\n        const data = {\n          analyzedStatus: payload.analyzedStatus,\n        };\n\n        const response = await firstValueFrom(\n          this.httpService.patch(url, data, {\n            headers: {\n              'Content-Type': 'application/json',\n              'X-API-Key': this.apiKey,\n              'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n            },\n            timeout: 20000,\n          }),\n        );\n\n        if (response.status === 200 || response.status === 204) {\n          this.logger.log(`Successfully updated internal transfer ${withdrawalId} status to ${payload.analyzedStatus}`);\n\n          return;\n        }\n\n        this.logger.warn(`Unexpected status code ${response.status} when updating internal transfer ${withdrawalId}`);\n      } catch (error) {\n        const axiosError = error as AxiosError;\n        const payload = axiosError.response?.data;\n        const errorMessage = axiosError.message;\n\n        if (attempt < maxRetries) {\n          const delay = baseDelay * Math.pow(2, attempt); // Exponential backoff\n          this.logger.warn(\n            `Failed to update internal transfer ${withdrawalId} (attempt ${attempt + 1}/${maxRetries + 1}): ${errorMessage}. Payload: ${JSON.stringify(payload)}, Retrying in ${delay}ms`,\n          );\n          await sleep(delay);\n        } else {\n          this.logger.error(\n            `Failed to update internal transfer ${withdrawalId} after ${maxRetries + 1} attempts. Payload: ${JSON.stringify(payload)}, Error: ${errorMessage}`,\n          );\n        }\n      }\n    }\n  }\n\n  async uploadInternalTransferReceipt(_id: string, receiptPath: string) {\n    const maxRetries = 3;\n    const baseDelay = 2000; // 2 seconds\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        const url = `${this.apiUrl}/api/internal/internal-transfers/upload-receipt/${_id}`;\n\n        this.logger.log(`Uploading bill for internal transfer ${_id} (attempt ${attempt + 1}/${maxRetries + 1})`);\n\n        if (!receiptPath) {\n          this.logger.warn(`No receipt path provided for internal transfer ${_id}`);\n\n          return;\n        }\n\n        const formdata = new FormData();\n        formdata.append('receipt', createReadStream(receiptPath));\n\n        const response = await firstValueFrom(\n          this.httpService.patch(url, formdata, {\n            headers: {\n              ...formdata.getHeaders(),\n              'X-API-Key': this.apiKey,\n              'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n            },\n            timeout: 20000,\n          }),\n        );\n\n        if (response.status === 200 || response.status === 204) {\n          this.logger.log(`Successfully uploaded bill for internal transfer ${_id}`);\n\n          return;\n        }\n\n        this.logger.warn(`Unexpected status code ${response.status} when uploading bill for internal transfer ${_id}`);\n      } catch (error) {\n        const axiosError = error as AxiosError;\n        const response = axiosError.response?.data;\n        const errorMessage = axiosError.message;\n\n        if (attempt < maxRetries) {\n          const delay = baseDelay * Math.pow(2, attempt); // Exponential backoff\n          this.logger.warn(\n            `Failed to upload bill for internal transfer ${_id} (attempt ${attempt + 1}/${maxRetries + 1}): ${errorMessage}. Response: ${JSON.stringify(response)}, Retrying in ${delay}ms`,\n          );\n          await sleep(delay);\n        } else {\n          this.logger.error(\n            `Failed to upload bill for internal transfer ${_id} after ${maxRetries + 1} attempts. Response: ${JSON.stringify(response)}, Error: ${errorMessage}`,\n          );\n        }\n      }\n    }\n  }\n\n  updateInternalTransfer(_id: string, data: IUpdateInternalTransfer) {\n    this.logger.log(`Updating internal transfer ${_id} data ${JSON.stringify(data)}`);\n\n    const url = `${this.apiUrl}/api/internal/internal-transfers/${_id}`;\n\n    return firstValueFrom(\n      this.httpService.patch(url, data, {\n        headers: {\n          'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n        },\n      }),\n    );\n  }\n}\n\n","module.exports = require(\"rxjs\");","export const formatCurrency = (amount: number) => new Intl.NumberFormat('en-US').format(amount);","import { Injectable, Logger, OnModuleInit, Inject } from '@nestjs/common';\nimport { Cron, CronExpression } from '@nestjs/schedule';\nimport { InjectQueue } from '@nestjs/bull';\nimport { Queue, Job } from 'bull';\nimport { WithdrawalService } from './withdrawal.service';\nimport { DeviceService } from '../device/device.service';\nimport { DeviceLockService } from '../device/device-lock.service';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { WithdrawalProcessingError, ErrorType } from './withdrawal-errors';\nimport { cloneDeep, toString } from 'lodash';\nimport { withCronLock } from '@/common/redis/cron-lock';\nimport { BankService } from '../bank/bank.service';\nimport { NotificationService } from '../notifiction/notification.service';\nimport { WindowsAppGitBashService } from '../window-app/window-app.service';\nimport { RedisLockService } from '../redis-lock/redis-lock.service';\nimport { SYSTEM_LOCK_BOXPHONE, SYSTEM_LOCK_PAUSE_PROCESSING } from './constants/lock';\nimport { TelegramService } from '../notifiction/telegram.service';\nimport { sleep } from '@/common/utils/time';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { validateObjectResult } from '@/common/utils/object-validation';\nimport { RedisService } from '@/common/services/redis.service';\nimport { DELAY_RETRY_JOB, JOB_PRIORITY_KEY, JOB_PROCESS_NAME } from './constants/job';\nimport { WithdrawalStatus } from './constants/withdrawal-status';\nimport { formatCurrency } from '@/common/utils/currency';\nimport { bullQueueNames } from './constants/queue';\nimport { sortDevices, sortJobs } from './utils/jobs';\nimport { PandaManagerService } from '@/common/modules/websocket/panda-manager.service';\nimport { MESSAGE_TITLE } from '@/common/constants/message-title';\nimport { PandaDeviceType } from '@/common/modules/websocket/constants/device';\n\n@Injectable()\nexport class WithdrawalJobManagerService implements OnModuleInit {\n  private readonly logger = new Logger('WithdrawalJobManagerService');\n  private processingJobs: Set<number | string> = new Set(); // Track job IDs being processed\n  private isInitialized = false;\n  private isRestartingBoxphone = false; // prevent multiple restart boxphone at the same time\n  private cronRestartBoxphoneEnabled = false;\n  private readonly defaultMinTransferAmount = -Infinity;\n\n  constructor(\n    @InjectQueue(bullQueueNames.WITHDRAWAL_REQUEST)\n    private readonly withdrawalQueue: Queue<Withdrawal>,\n    @InjectQueue(bullQueueNames.WITHDRAWAL_REQUEST_LARGE_AMOUNT)\n    private readonly withdrawalQueueLargeAmount: Queue<Withdrawal>,\n    private readonly withdrawalService: WithdrawalService,\n    private readonly deviceService: DeviceService,\n    private readonly deviceLockService: DeviceLockService,\n    private readonly pandaManagerService: PandaManagerService,\n    private readonly bankService: BankService,\n    private readonly notificationService: NotificationService,\n    private readonly windowsAppGitBashService: WindowsAppGitBashService,\n    private readonly redisLockService: RedisLockService,\n    private readonly telegramService: TelegramService,\n    private readonly redisService: RedisService,\n  ) { }\n\n  async onModuleInit() {\n    this.logger.log('WithdrawalJobManagerService initialized, waiting 5 seconds before starting...');\n    // Wait a bit for other services to initialize\n    this.initializeJobProcessing();\n    this.scheduleCronRestartBoxphone();\n  }\n\n  /**\n   * Initialize job processing - pick jobs equal to number of active devices\n   */\n  private async initializeJobProcessing() {\n    setTimeout(async () => {\n      if (this.isInitialized) {\n        return;\n      }\n\n      this.logger.log('Starting withdrawal job processing...');\n      await this.pickAndProcessJobs();\n\n      this.isInitialized = true;\n    }, 5000);\n\n  }\n\n  private scheduleCronRestartBoxphone() {\n    // Nu khng c lp delay th job s chy lun vo giy 0 pht tip theo\n    const now = new Date();\n    const msToNextMinute =\n      (60 - now.getSeconds()) * 1000 - now.getMilliseconds();\n\n    setTimeout(() => {\n      this.cronRestartBoxphoneEnabled = true;\n    }, msToNextMinute);\n  }\n\n  private async restartBoxphone() {\n    const hasTransferGoing = await this.deviceLockService.hasAnyLockKeys();\n\n    if (!hasTransferGoing) {\n      this.telegramService\n        .sendMessage({\n          text: `Boxphone software... ${MESSAGE_TITLE}`\n            + `\\n\\n<b>Khi ng li:</b> ${new Date().toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' })}`\n            + '\\n<b>D kin:</b> 3 pht.'\n          ,\n          options: {\n            parseMode: 'HTML'\n          }\n        });\n\n      await this.windowsAppGitBashService.restartApp({\n        processName: 'xiaowei_iphone.exe',\n        exePath: 'C:/Users/Public/Desktop/.lnk',\n        runAsAdmin: true,\n        killAsAdmin: true\n      });\n\n      this.telegramService\n        .sendMessage({\n          text: ' <b>Boxphone software</b>'\n            + `\\n\\n<b>Khi ng li thnh cng:</b> ${new Date().toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' })}`\n            + '\\nLogin tt c thit b sau 1 pht:'\n          ,\n          options: {\n            parseMode: 'HTML'\n          }\n        });\n\n      try {\n        await sleep(5000); // wait 10 seconds for connecting to socket\n        await this.bankService.loginAllActiveBanks(PandaDeviceType.IOS);\n      } catch (error) {\n        this.logger.error(`Error logging in all active banks: ${error.stack}`);\n      } finally {\n        await sleep(1000);\n        await this.redisLockService.releaseLock(SYSTEM_LOCK_BOXPHONE);\n      }\n    }\n  }\n\n  private async getClosestMinTransferAmountDevice(amount: number) {\n    const device = await this.deviceService.listDeviceConfigs();\n    const largeAmountDevices = device.filter(device => device.doesHandleLargeAmount);\n\n    /**\n     * Kim tra c phi l n to so vi config ca bankout khng\n     * V d c danh sch bank vi minTransferAmount l [100000, 200000, 300000]\n     * V amount l 150000\n     * Th s tr v 100000\n     * \n     * Amount l 400000\n     * Th s tr v 300000\n     * \n     */\n    const closestMinTransferAmount = largeAmountDevices\n      .filter(bank => bank.doesHandleLargeAmount && bank.minTransferAmount <= amount)\n      .reduce((max, currentBank) => {\n        return currentBank.minTransferAmount > max ? currentBank.minTransferAmount : max;\n      }, this.defaultMinTransferAmount);\n\n    return closestMinTransferAmount;\n  }\n\n  private async getQueue(amount: number) {\n    const closestMinTransferAmount = await this.getClosestMinTransferAmountDevice(amount);\n\n    // Nu khng c bank no set minTransferAmount, th s s dng queue default x l n nh\n    if (closestMinTransferAmount === this.defaultMinTransferAmount) {\n      return this.withdrawalQueue;\n    } else {\n      return this.withdrawalQueueLargeAmount;\n    }\n  }\n\n  /**\n   * Pick and process jobs from queue\n   * Strategy: Find N available devices -> Pick N jobs -> Assign strictly\n   */\n  async pickAndProcessJobs(): Promise<void> {\n    try {\n      // 1. Get Available Devices (Active + Unlocked)\n      const availableDevices = await this.deviceService.getAvailableDevices();\n      const availableDevicesForSmallAmount = availableDevices.filter(device => !device.doesHandleLargeAmount);\n\n      // Calculate capacity\n      const capacity = availableDevicesForSmallAmount.length;\n\n      if (capacity <= 0) {\n        // this.logger.debug(`No available (unlocked) devices. Waiting...`);\n        return;\n      }\n\n      // Get job with priority from bull queue\n      const waitingJobsWithScore = await this.redisService.pickFromZSet(JOB_PRIORITY_KEY, capacity);\n\n      if (waitingJobsWithScore.length === 0) {\n        // this.logger.debug('No waiting jobs available in queue');\n        return;\n      }\n\n      // 3. Assign Job -> Device\n      // We iterate through picked jobs and assign to available devices index-by-index\n      for (let i = 0; i < waitingJobsWithScore.length; i++) {\n        const jobId = waitingJobsWithScore[i].jobId;\n        const job = await this.withdrawalQueue.getJob(jobId);\n        const device = availableDevicesForSmallAmount[i]; // Guaranteed to exist because jobsToPick <= capacity\n        const deviceName = `${device.bankCode} - ${device.accountName}`;\n\n        // Skip if already processing (safety check)\n        if (this.processingJobs.has(job.id)) {\n          continue;\n        }\n\n        // CRITICAL: Acquire lock immediately to prevent race condition\n        const operationId = `withdraw:${job.data.withdrawalId}:${device.deviceId}`;\n        const lockAcquired = await this.deviceLockService.acquireLock(\n          device.deviceId,\n          'transfer',\n          operationId,\n          3.68 * 60 * 1000 // 3.68 minutes\n        );\n\n        if (!lockAcquired) {\n          this.logger.warn(`Device ${device.deviceId} was locked after assignment, skipping job ${job.id}`);\n          continue;\n        }\n\n        const withdrawal = cloneDeep(job.data);\n        const jobValidated = await validateObjectResult(Withdrawal, withdrawal);\n\n        if (!jobValidated.ok) {\n          this.logger.error(`Invalid withdrawal: missing ${jobValidated.errors.map(error => error.property).join(', ')}`);\n\n          this.notificationService\n            .updateWithdrawal(withdrawal._id, {\n              status: WithdrawalStatus.FAILED\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          this.telegramService.sendMessage({\n            text: ` <b>Failed Withdraw. Retrying...</b>`\n              + `\\n${withdrawal.withdrawalId}`\n              + `\\n${withdrawal.withdrawalCode}`\n              + `\\n$Failed: Thng tin job khng hp l`\n              + `\\n\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n              + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n              + `\\n<b>Description:</b>  ${withdrawal.description}`,\n            options: {\n              parseMode: 'HTML'\n            }\n          }).catch((error) => {\n            this.logger.error(`Error sending message for withdrawal ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n          });\n\n          await job.remove();\n\n          continue\n        }\n\n        this.logger.log(\n          `Found job ${withdrawal.withdrawalId} is normal job job. `\n          + `Assigned to ${deviceName}`\n        );\n\n        this.processingJobs.add(job.id);\n        await job.remove();\n\n        // Lock acquired - process job\n        // Note: processWithdrawal will release the lock in its finally block\n        this.processJob(withdrawal, device)\n          .catch(error => {\n            this.logger.error(`Error processing job ${job.id}: ${error.message}`, error.stack);\n          })\n          .finally(() => {\n            // Safety: release lock if processJob fails before processWithdrawal\n            this.deviceLockService.releaseLock(device.deviceId).catch(() => { });\n            this.processingJobs.delete(job.id);\n          });\n      }\n    } catch (error) {\n      this.logger.error(`Error picking jobs: ${error.message}`, error.stack);\n    }\n  }\n\n  async pickAndProcessLargeAmountJobs(): Promise<void> {\n    try {\n      const availableDevices = await this.deviceService.getAvailableDevices();\n      const jobs = await this.withdrawalQueueLargeAmount.getJobs(['waiting'], 0, -1);\n      const largeAmountDevices = availableDevices.filter(device => device.doesHandleLargeAmount);\n      const assignedJobs = new Set<Job<Withdrawal>>();\n\n      const sortedDevices = sortDevices(largeAmountDevices, 'minTransferAmount', 'desc');\n      const sortedJobs = sortJobs(jobs, 'priority', 'asc');\n\n      for (const device of sortedDevices) {\n        const deviceName = `${device.bankCode} - ${device.accountName}`;\n        const job = sortedJobs.find(\n          job => !assignedJobs.has(job) && job.data.amount >= device.minTransferAmount,\n        );\n\n        if (!job || this.processingJobs.has(job.id)) {\n          continue;\n        }\n\n        const operationId = `withdraw:${job.data.withdrawalId}:${device.deviceId}`;\n        const lockAcquired = await this.deviceLockService.acquireLock(\n          device.deviceId,\n          'transfer',\n          operationId,\n          3.68 * 60 * 1000 // 3.68 minutes\n        );\n\n        if (!lockAcquired) {\n          this.logger.warn(`Device ${deviceName} was locked after assignment, skipping job ${job.data.withdrawalId}`);\n          continue;\n        }\n\n        const clonedJob = cloneDeep(job);\n        const withdrawal = clonedJob.data;\n        assignedJobs.add(clonedJob);\n        this.processingJobs.add(clonedJob.id);\n        await job.remove();\n\n        const withdrawalValidated = await validateObjectResult(Withdrawal, withdrawal);\n\n        if (!withdrawalValidated.ok) {\n          this.logger.error(`Invalid withdrawal: missing ${withdrawalValidated.errors.map(error => error.property).join(', ')}`);\n\n          this.notificationService\n            .updateWithdrawal(withdrawal._id, {\n              status: WithdrawalStatus.FAILED\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          this.telegramService.sendMessage({\n            text: ` <b>Failed Withdraw. Retrying...</b>`\n              + `\\n${withdrawal.withdrawalId}`\n              + `\\n${withdrawal.withdrawalCode}`\n              + `\\n$Failed: Thng tin job khng hp l`\n              + `\\n\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n              + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n              + `\\n<b>Description:</b>  ${withdrawal.description}`,\n            options: {\n              parseMode: 'HTML'\n            }\n          }).catch((error) => {\n            this.logger.error(`Error sending message for withdrawal ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n          });\n\n          continue;\n        }\n\n        this.logger.log(\n          `Found job ${withdrawal.withdrawalId} is large amount job. `\n          + `Assigned to ${deviceName}`\n        );\n\n        this.processJob(withdrawal, device)\n          .catch(error => {\n            this.logger.error(`Error processing job ${job.id}: ${error.message}`, error.stack);\n          })\n          .finally(() => {\n            // Safety: release lock if processJob fails before processWithdrawal\n            this.deviceLockService.releaseLock(device.deviceId).catch(() => { });\n            this.processingJobs.delete(job.id);\n          });\n      }\n\n    } catch (error) {\n      this.logger.error(`Error picking jobs: ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Process a single job with assigned device\n   */\n  private async processJob(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    try {\n      const { _id, withdrawalId } = withdrawal;\n      const withdrawalDetails = await this.withdrawalService.getWithdrawalDetails(_id);\n\n      if (![WithdrawalStatus.PENDING, WithdrawalStatus.RETRY].includes(withdrawalDetails.status)) {\n        this.logger.warn(`WDA ${withdrawalId} (${withdrawalDetails.status}) is not pending or retry, skipping`);\n\n        throw new WithdrawalProcessingError(`Withdrawal not pending or retry, skipping (${withdrawalDetails.status})`, ErrorType.PERMANENT);\n      }\n\n      if (withdrawalDetails.status === WithdrawalStatus.RETRY) {\n        this.telegramService.sendMessage({\n          text: ` <b>Retrying Withdrawal...</b>`\n            + `\\n${withdrawal.withdrawalId} - ${withdrawal.withdrawalCode}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n            + `\\n<b>Description:</b>  ${withdrawal.description}`,\n          options: {\n            parseMode: 'HTML'\n          }\n        }).catch((error) => {\n          this.logger.error(`Error sending message for withdrawal ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n        });\n      }\n\n      this.notificationService\n        .updateWithdrawal(_id, {\n          status: WithdrawalStatus.PROCESSING,\n          sourceBankCode: deviceConfig.bankCode,\n          sourceAccountNo: deviceConfig.accountNo,\n          sourceAccountName: deviceConfig.accountName,\n        })\n        .catch((error) => {\n          this.logger.error(`Error updating withdrawal status for ${withdrawalId}: ${error.message}`, error.stack);\n        });\n\n      await this.bankService.createQRCodeAndTransferTo(deviceConfig.bankCode, deviceConfig.deviceId, withdrawal);\n      await this.bankService.createBillFolder(deviceConfig.bankCode, withdrawal.withdrawalCode);\n      await this.withdrawalService.processWithdrawal(withdrawal, deviceConfig);\n    } catch (error) {\n      // Extract error type t error nu c\n      let errorType: ErrorType;\n      let errorContext: string;\n\n      if (error instanceof WithdrawalProcessingError) {\n        errorType = error.errorType;\n        errorContext = error.context;\n        this.logger.error(`Controlled Error ${withdrawal.withdrawalId}: ${errorType}-${error.message}`, error.stack);\n\n        await this.handleJobFailure(deviceConfig, withdrawal, error.message, errorType, errorContext);\n      } else {\n        this.logger.error(`Uncontrolled Error ${withdrawal.withdrawalId}: ${errorType}-${error.message}`, error.stack);\n\n        await this.bankService.createBillFolder(deviceConfig.bankCode, withdrawal.withdrawalCode);\n        await sleep(1000);\n        await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, withdrawal.withdrawalCode);\n        const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, withdrawal.withdrawalCode);\n\n        if (billImagePath) {\n          this.logger.log(`Uploading receipt for withdrawal ${withdrawal.withdrawalCode} - ${billImagePath}`);\n\n          await this.notificationService.uploadReceipt(withdrawal._id, billImagePath);\n        }\n\n        await this.notificationService.updateWithdrawal(withdrawal._id, {\n          status: WithdrawalStatus.UNKNOWN\n        });\n\n        this.telegramService.sendMessage({\n          text: ` <b>Failed Withdraw.</b>`\n            + `\\n${withdrawal.withdrawalId}`\n            + `\\n${withdrawal.withdrawalCode}`\n            + `\\n${error.message}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n            + `\\n<b>Description:</b>  ${withdrawal.description}`,\n          options: {\n            parseMode: 'HTML'\n          }\n        }).catch((error) => {\n          this.logger.error(`Error sending message for withdrawal ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n        });\n\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n      }\n    }\n  }\n\n  /**\n   * Handle Job Failure: Retry logic with error type classification\n   */\n  private async handleJobFailure(\n    deviceConfig: DeviceConfig,\n    withdrawal: Withdrawal,\n    reason: string,\n    errorType: ErrorType = ErrorType.PERMANENT,\n    errorContext: string = ''\n  ) {\n    const maxRetries = 2;\n    const currentRetries = withdrawal.manualRetryCount ?? 1;\n    const withdrawalQueue = await this.getQueue(withdrawal.amount);\n\n    switch (errorType) {\n      case ErrorType.PERMANENT:\n        this.notificationService\n          .updateWithdrawal(withdrawal._id, {\n            status: WithdrawalStatus.FAILED\n          })\n          .catch((error) => {\n            this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n          });\n\n        this.telegramService.sendMessage({\n          text: ` <b>Failed Withdraw. Retrying...</b>`\n            + `\\n${withdrawal.withdrawalId}`\n            + `\\n${withdrawal.withdrawalCode}`\n            + `\\n${errorContext}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n            + `\\n<b>Description:</b>  ${withdrawal.description}`,\n          options: {\n            parseMode: 'HTML'\n          }\n        }).catch((error) => {\n          this.logger.error(`Error sending message for withdrawal ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n        });\n\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n\n        return;\n\n      case ErrorType.FORCE_LOGIN_NO_REQUEUE:\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n\n        return;\n\n      case ErrorType.NO_BILL_AFTER_OTP:\n        await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, withdrawal.withdrawalCode);\n        const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, withdrawal.withdrawalCode);\n\n        if (billImagePath) {\n          this.logger.log(`Uploading receipt for withdrawal ${withdrawal.withdrawalCode} - ${billImagePath}`);\n\n          await this.notificationService.uploadReceipt(withdrawal._id, billImagePath);\n        }\n\n        await this.notificationService.updateWithdrawal(withdrawal._id, {\n          status: WithdrawalStatus.UNKNOWN\n        });\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n\n        return;\n\n      case ErrorType.FORCE_LOGIN_AND_REQUEUE: // Force Login s cho retry nn khng cn break\n        this.logger.warn(\n          `Added ${withdrawal.withdrawalId} to queue for retrying. (${currentRetries}/${maxRetries})` +\n          `Reason: ${reason}. ` +\n          `Error Type: ${errorType}.`\n        );\n\n        if (currentRetries < maxRetries) {\n\n          await withdrawalQueue.add(\n            JOB_PROCESS_NAME,\n            {\n              ...withdrawal,\n              manualRetryCount: currentRetries + 1,\n              lastErrorType: errorType,\n              lastErrorReason: reason\n            },\n            {\n              jobId: `wda-${withdrawal.withdrawalId}`,\n              priority: 1,\n              delay: DELAY_RETRY_JOB,\n            }\n          );\n\n          this.notificationService\n            .updateWithdrawal(withdrawal._id, {\n              status: WithdrawalStatus.RETRY\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, withdrawal.withdrawalCode);\n          const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, withdrawal.withdrawalCode);\n\n          const caption = ` <b>Failed Withdraw. Retrying...</b>`\n            + `\\n${withdrawal.withdrawalId}`\n            + `\\n${withdrawal.withdrawalCode}`\n            + `\\n${errorContext}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n            + `\\n<b>Description:</b>  ${withdrawal.description}`;\n\n          await this.telegramService.sendPhotoByFile({\n            filePath: billImagePath,\n            options: {\n              parseMode: 'HTML',\n              caption\n            }\n          });\n        } else {\n          this.logger.warn(`Max retries (${maxRetries}) exceeded for withdrawal ${withdrawal.withdrawalId}: ${errorType} error: ${reason}`);\n\n          this.notificationService\n            .updateWithdrawal(withdrawal._id, {\n              status: WithdrawalStatus.FAILED\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, withdrawal.withdrawalCode);\n          const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, withdrawal.withdrawalCode);\n\n          const caption = ` <b>Failed Withdraw. Max retries exceeded...</b>`\n            + `\\n${withdrawal.withdrawalId}`\n            + `\\n${withdrawal.withdrawalCode}`\n            + `\\n${errorContext}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n            + `\\n<b>Description:</b>  ${withdrawal.description}`;\n\n          await this.telegramService.sendPhotoByFile({\n            filePath: billImagePath,\n            options: {\n              parseMode: 'HTML',\n              caption\n            }\n          });\n        }\n\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n        break;\n\n      case ErrorType.TEMPORARY:\n        this.logger.warn(\n          `Added ${withdrawal.withdrawalId} to queue for retrying. (${currentRetries}/${maxRetries})` +\n          `Reason: ${reason}. ` +\n          `Error Type: ${errorType}.`\n        );\n\n        if (currentRetries < maxRetries) {\n\n          await withdrawalQueue.add(\n            JOB_PROCESS_NAME,\n            {\n              ...withdrawal,\n              manualRetryCount: currentRetries + 1,\n              lastErrorType: errorType,\n              lastErrorReason: reason\n            },\n            {\n              jobId: `wda-${withdrawal.withdrawalId}`,\n              priority: 1,\n              delay: DELAY_RETRY_JOB,\n            }\n          );\n\n          this.notificationService\n            .updateWithdrawal(withdrawal._id, {\n              status: WithdrawalStatus.RETRY\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          this.telegramService.sendMessage({\n            text: ` <b>Failed Withdraw. Retrying...</b>`\n              + `\\n${withdrawal.withdrawalId}`\n              + `\\n${withdrawal.withdrawalCode}`\n              + `\\n${errorContext}`\n              + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n              + `\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n              + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n              + `\\n<b>Description:</b>  ${withdrawal.description}`,\n            options: {\n              parseMode: 'HTML'\n            }\n          }).catch((error) => {\n            this.logger.error(`Error sending message for withdrawal ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n          });\n\n        } else {\n          this.logger.warn(`Max retries (${maxRetries}) exceeded for withdrawal ${withdrawal.withdrawalId}: ${errorType} error: ${reason}`);\n\n          this.notificationService\n            .updateWithdrawal(withdrawal._id, {\n              status: WithdrawalStatus.FAILED\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, withdrawal.withdrawalCode);\n          const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, withdrawal.withdrawalCode);\n\n          const caption = ` <b>Failed Withdraw. Max retries exceeded...</b>`\n            + `\\n${withdrawal.withdrawalId}`\n            + `\\n${withdrawal.withdrawalCode}`\n            + `\\n${errorContext}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${withdrawal.bankCode} - ${withdrawal.beneficiaryAccountNo} - ${withdrawal.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(withdrawal.amount)}`\n            + `\\n<b>Description:</b>  ${withdrawal.description}`\n\n          await this.telegramService.sendPhotoByFile({\n            filePath: billImagePath,\n            options: {\n              parseMode: 'HTML',\n              caption\n            }\n          });\n        }\n        break;\n    }\n  }\n\n  private async promoteDelayedJobs() {\n    return withCronLock('cron:promote_delayed:withdrawal', 5000, async () => {\n      const now = Date.now();\n      const BATCH = 100;\n\n      // Ly mt batch job  delayed\n      const delayedJobs: Job[] = await this.withdrawalQueue.getJobs(\n        ['delayed'],\n        0,\n        BATCH - 1,\n      );\n      const largeAmountDelayedJobs: Job[] = await this.withdrawalQueueLargeAmount.getJobs(\n        ['delayed'],\n        0,\n        BATCH - 1,\n      );\n\n      if (!delayedJobs.length && !largeAmountDelayedJobs.length) return;\n\n      let promoted = 0;\n\n      for (const job of [...delayedJobs, ...largeAmountDelayedJobs]) {\n        const delayMs = typeof job.opts?.delay === 'number' ? job.opts.delay : 0;\n        const ts = typeof job.timestamp === 'number' ? job.timestamp : 0;\n\n        const dueAt = ts + delayMs;\n\n        // ch promote job n hn\n        if (dueAt <= now) {\n          try {\n            // Bull h tr job.promote()  chuyn delayed -> waiting\n            await job.promote();\n            promoted++;\n          } catch (e) {\n            this.logger.debug(`Promote skipped for job ${job.id}: ${String(e)}`);\n          }\n        }\n      }\n\n      if (promoted > 0) {\n        this.logger.log(`Promoted ${promoted} delayed jobs to waiting`);\n      }\n    });\n  }\n\n  /**\n   * TODO: remove\n   * Manually trigger job picking (for testing or manual operations)\n   */\n  // async triggerPickJobs(count: number = 1): Promise<void> {\n  //   await this.pickAndProcessJobs(count);\n  // }\n\n  /**\n   * Get queue statistics\n   */\n  async getQueueStats() {\n    // Need to implement new stats logic if needed, but keeping existing is fine for now\n    // availableDevices logic changed slightly\n    const [waiting, delayed, active, completed, failed, availableDevices, serviceStatus] = await Promise.all([\n      this.withdrawalQueue.getWaitingCount(),\n      this.withdrawalQueue.getDelayedCount(),\n      this.withdrawalQueue.getActiveCount(),\n      this.withdrawalQueue.getCompletedCount(),\n      this.withdrawalQueue.getFailedCount(),\n      this.deviceService.getAvailableDevices(),\n      this.deviceService.getServiceStatus(),\n    ]);\n\n    return {\n      serviceStatus,\n      activeDevices: availableDevices.length, // Now explicitly unlocked active devices\n      processingJobs: this.processingJobs.size,\n      isInitialized: this.isInitialized,\n      queue: {\n        waiting,\n        delayed,\n        active,\n        completed,\n        failed,\n        total: waiting + delayed + active,\n      },\n    };\n  }\n\n  /**\n   * Debug method: Get detailed queue information\n   */\n  async debugQueue() {\n    const stats = await this.getQueueStats();\n    const [waitingJobs, delayedJobs] = await Promise.all([\n      this.withdrawalQueue.getJobs(['waiting'], 0, 9), // Get first 10 waiting jobs\n      this.withdrawalQueue.getJobs(['delayed'], 0, 9), // Get first 10 delayed jobs\n    ]);\n\n    return {\n      ...stats,\n      sampleWaitingJobs: waitingJobs.map(job => ({\n        id: job.id,\n        data: job.data,\n        opts: job.opts,\n        manualRetryCount: (job.data as any).manualRetryCount\n      })),\n      sampleDelayedJobs: delayedJobs.map(job => ({\n        id: job.id,\n        data: job.data,\n        opts: job.opts,\n        manualRetryCount: (job.data as any).manualRetryCount\n      })),\n    };\n  }\n\n  /**\n   * Periodically check and pick jobs if there are available slots\n   * Runs every 5 seconds\n   */\n  @Cron(CronExpression.EVERY_5_SECONDS)\n  async periodicJobPicking() {\n    const isNeedRestartBoxphone = await this.redisLockService.getLock(SYSTEM_LOCK_BOXPHONE);\n\n    if (isNeedRestartBoxphone) {\n      if (this.isRestartingBoxphone) {\n        return\n      }\n\n      this.isRestartingBoxphone = true;\n      await this.restartBoxphone();\n      this.isRestartingBoxphone = false;\n\n      return;\n    }\n\n    const doesPauseProcessingJob = await this.redisLockService.isLocked(SYSTEM_LOCK_PAUSE_PROCESSING);\n\n    if (doesPauseProcessingJob) {\n      this.logger.warn('Transfer is paused by admin temporarily!');\n      return;\n    }\n\n    if (!this.pandaManagerService.isConnected()) {\n      this.logger.error(`Panda is not connected, cannot pick jobs`);\n\n      return;\n    }\n\n    // Check service status\n    const serviceStatus = await this.deviceService.getServiceStatus();\n    if (serviceStatus !== 'active') {\n      this.logger.debug(`Service is ${serviceStatus}, cannot pick jobs`);\n      return;\n    }\n\n    await this.pickAndProcessJobs();\n    await this.pickAndProcessLargeAmountJobs();\n  }\n\n  /**\n   * Promote delayed jobs to waiting jobs\n   * Runs every 5 seconds\n   */\n  @Cron(CronExpression.EVERY_5_SECONDS)\n  async promoteDelayedJobsPeriodically() {\n    await this.promoteDelayedJobs();\n  }\n\n  /**\n   * Promote delayed jobs to waiting jobs\n   * Runs every 40 minutes\n   */\n  @Cron('* * * * *')\n  async restartPandaBoxPeriodically() {\n    const serviceStatus = await this.deviceService.getServiceStatus();\n\n    if (!this.cronRestartBoxphoneEnabled || serviceStatus === 'inactive') {\n      return;\n    }\n\n    const key = 'panda:last-restart';\n    const timeToRestart = 3 * 60 * 60 * 1000; // 3 hours\n    const lastRun = await this.redisService.get(key);\n    const now = Date.now();\n\n    if (!lastRun || now - Number(lastRun) >= timeToRestart) {\n      await this.redisService.set(key, toString(now));\n      await this.redisLockService.acquireLock(SYSTEM_LOCK_BOXPHONE, 3 * 60 * 1000); // 3 minutes\n    }\n  }\n}\n","module.exports = require(\"bull\");","import { ErrorType } from \"@/modules/withdrawal/withdrawal-errors\";\nimport { IsNotEmpty, IsOptional } from \"class-validator\";\n\nexport class Withdrawal {\n  @IsNotEmpty()\n  _id: string;\n  \n  @IsNotEmpty()\n  withdrawalId: string;\n\n  @IsNotEmpty()\n  withdrawalCode: string;\n\n  @IsNotEmpty()\n  bankCode: string;\n\n  @IsNotEmpty()\n  beneficiaryAccountNo: string;\n\n  @IsNotEmpty()\n  beneficiaryName: string;\n\n  @IsNotEmpty()\n  amount: number;\n  \n  @IsNotEmpty()\n  transferCode: string;\n\n  @IsNotEmpty()\n  status: string;\n\n  @IsNotEmpty()\n  description: string;\n\n  @IsNotEmpty()\n  priority: number;\n\n  @IsNotEmpty()\n  createdAt: string;\n\n  @IsOptional()\n  manualRetryCount?: number;\n\n  @IsOptional()\n  lastErrorType?: ErrorType;\n\n  @IsOptional()\n  lastErrorReason?: string;\n}\n\nexport class InternalTransfer extends Withdrawal {\n  @IsNotEmpty()\n  beneficiaryBankDeviceId: string;\n}\n\n","import Redis from 'ioredis';\nimport { config } from '../constants/config';\n\nconst redis = new Redis({\n  host: config.redis.host,\n  port: config.redis.port,\n  password: config.redis.password,\n  db: config.redis.db,\n});\n\nexport const withCronLock = async (key: string, ttlMs: number, fn: () => Promise<void>) => {\n  const lockVal = `${process.pid}:${Date.now()}`;\n  const ok = await redis.set(key, lockVal, 'PX', ttlMs, 'NX');\n  if (!ok) return;\n\n  try {\n    await fn();\n  } finally {\n    // release best-effort: ch xo nu vn l ch lock\n    const lua = `\n      if redis.call(\"GET\", KEYS[1]) == ARGV[1] then\n        return redis.call(\"DEL\", KEYS[1])\n      end\n      return 0\n    `;\n    await redis.eval(lua, 1, key, lockVal);\n  }\n}","import { Injectable, Logger } from '@nestjs/common';\nimport { exec } from 'child_process';\nimport { promisify } from 'util';\nimport { sleep } from '@/common/utils/time';\n\nconst execAsync = promisify(exec);\n\ntype RestartParams = {\n  processName: string;       // \"notepad.exe\", \"chrome.exe\"\n  exePath?: string;          // \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\"\n  startTarget?: string;      // \"notepad\" | \"calc\" | \"https://...\" | \"C:\\\\folder\"\n  gracefulWaitMs?: number;   // default 1200\n  forceKillWaitMs?: number;  // default 500\n  startDelayMs?: number;     // default 300\n  runAsAdmin?: boolean;      // default false - Chy vi quyn Administrator (s hin UAC prompt)\n  killAsAdmin?: boolean;     // default false - Kill process vi quyn Administrator nu gp \"access denied\"\n};\n\n@Injectable()\nexport class WindowsAppGitBashService {\n  private readonly logger = new Logger(WindowsAppGitBashService.name);\n\n  async restartApp(params: RestartParams): Promise<void> {\n    const {\n      processName,\n      exePath,\n      startTarget,\n      gracefulWaitMs = 1200,\n      forceKillWaitMs = 500,\n      startDelayMs = 300,\n      runAsAdmin = false,\n      killAsAdmin = false,\n    } = params;\n\n    try {\n      // 1) ng ng dng mt cch graceful (best effort)\n      await this.closeMainWindow(processName).catch(() => {});\n\n      // 2) i mt cht, ri kill cng (best effort)\n      await sleep(gracefulWaitMs);\n      await this.forceKill(processName, killAsAdmin).catch(() => {});\n\n      // 3) m bo process  tt hon ton\n      await sleep(forceKillWaitMs);\n      await this.waitUntilNotRunning(processName, 5000).catch(() => {});\n\n      // 4) Khi ng li ng dng\n      await sleep(startDelayMs);\n\n      if (exePath) {\n        await this.startApp({ exePath, runAsAdmin });\n        return;\n      }\n\n      if (startTarget) {\n        await this.startApp({ startTarget, runAsAdmin });\n        return;\n      }\n\n      // fallback: start theo base name\n      const base = processName.replace(/\\.exe$/i, '');\n      await this.startApp({ startTarget: base, runAsAdmin });\n    } catch (error: any) {\n      const errorMsg = error?.message || String(error);\n      this.logger.error(`[restart] Failed to restart app: ${errorMsg}`, error?.stack);\n      throw error;\n    }\n  }\n\n  // -----------------------------\n  // Windows process management\n  // -----------------------------\n\n  /**\n   * ng ca s chnh ca ng dng mt cch graceful\n   */\n  private async closeMainWindow(processName: string): Promise<void> {\n    const base = processName.replace(/\\.exe$/i, '');\n    \n    // S dng PowerShell  ng ca s mt cch graceful\n    const psCommand = `Get-Process -Name \"${this.escapePs(base)}\" -ErrorAction SilentlyContinue | ForEach-Object { $_.CloseMainWindow() | Out-Null }`;\n    const command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${this.escapePs(psCommand)}\"`;\n\n    // TODO: Uncomment when debugging\n    // this.logger.debug(`Graceful close: ${processName}`);\n    \n    try {\n      await execAsync(command, { windowsHide: true });\n    } catch (error: any) {\n      // Ignore errors nu process khng tn ti\n      const errorMsg = error?.message || String(error) || '';\n      if (!errorMsg.includes('Cannot find a process')) {\n        throw error;\n      }\n    }\n  }\n\n  /**\n   * Force kill process bng taskkill hoc PowerShell\n   * @param processName - Tn process cn kill\n   * @param useAdmin - S dng quyn admin  kill (nu gp \"access denied\")\n   */\n  private async forceKill(processName: string, useAdmin: boolean = false): Promise<void> {\n    const base = processName.replace(/\\.exe$/i, '');\n    \n    // TODO: Uncomment when debugging\n    // this.logger.debug(`Force kill: ${processName}${useAdmin ? ' (with admin)' : ''}`);\n\n    try {\n      // Th kill bng PowerShell trc (tt hn vi child processes)\n      await this.forceKillWithPowerShell(base, useAdmin);\n      // Nu thnh cng, return ngay\n      return;\n    } catch (error: any) {\n      const errorMsg = (error?.message || error?.stderr || String(error) || '').toLowerCase();\n      \n      // Ignore nu process khng tn ti (khng cn kill na)\n      if (\n        errorMsg.includes('cannot find a process') ||\n        errorMsg.includes('process not found') ||\n        errorMsg.includes('cannot find process')\n      ) {\n        this.logger.debug(`Process not found (expected): ${processName}`);\n        return;\n      }\n\n      // Nu l \"access denied\" v cha dng admin, th li vi admin\n      if (\n        (errorMsg.includes('access is denied') || errorMsg.includes('access denied')) &&\n        !useAdmin\n      ) {\n        this.logger.warn(`Access denied, retrying with admin privileges: ${processName}`);\n        try {\n          await this.forceKillWithPowerShell(base, true);\n          return;\n        } catch (retryError: any) {\n          const retryMsg = (retryError?.message || retryError?.stderr || String(retryError) || '').toLowerCase();\n          \n          // Nu retry vi admin vn li, fallback sang taskkill\n          if (\n            !retryMsg.includes('cannot find a process') &&\n            !retryMsg.includes('process not found')\n          ) {\n            this.logger.debug(`PowerShell kill with admin failed, trying taskkill: ${processName}`);\n          } else {\n            // Process  khng tn ti\n            return;\n          }\n        }\n      }\n\n      // Fallback: th taskkill nu PowerShell fail\n      try {\n        const shouldUseAdmin = useAdmin || errorMsg.includes('access denied') || errorMsg.includes('access is denied');\n        let command: string;\n        \n        if (shouldUseAdmin) {\n          // S dng PowerShell  chy taskkill vi quyn admin\n          // Escape process name ng cch cho ArgumentList\n          const escapedProcessName = processName.replace(/\"/g, '`\"');\n          // S dng single quotes trong PowerShell  trnh escape phc tp\n          const psCommand = `Start-Process taskkill -ArgumentList '/F','/IM','${escapedProcessName}','/T' -Verb RunAs -Wait -WindowStyle Hidden`;\n          // Escape cho command line\n          command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${psCommand.replace(/\"/g, '`\"').replace(/\\$/g, '`$')}\"`;\n        } else {\n          command = `taskkill /F /IM \"${processName}\" /T`;\n        }\n        \n        await execAsync(command, { windowsHide: true });\n      } catch (taskkillError: any) {\n        const taskkillMsg = (taskkillError?.message || taskkillError?.stderr || String(taskkillError) || '').toLowerCase();\n        \n        // Ignore nu process khng tn ti\n        if (\n          taskkillMsg.includes('not found') ||\n          taskkillMsg.includes('no tasks are running') ||\n          taskkillMsg.includes('the system cannot find')\n        ) {\n          this.logger.debug(`Process not found (expected): ${processName}`);\n          return;\n        }\n\n        // Nu vn l \"access denied\", log warning nhng khng throw (best effort)\n        if (taskkillMsg.includes('access is denied') || taskkillMsg.includes('access denied')) {\n          this.logger.warn(`Cannot kill process (access denied): ${processName}. Process may require administrator privileges to terminate.`);\n          return;\n        }\n\n        // Log warning cho cc li khc nhng khng throw (best effort)\n        this.logger.warn(`Kill process warning: ${taskkillMsg}`);\n      }\n    }\n  }\n\n  /**\n   * Kill process bng PowerShell Stop-Process (x l child processes tt hn)\n   */\n  private async forceKillWithPowerShell(processBaseName: string, useAdmin: boolean = false): Promise<void> {\n    // S dng PowerShell Stop-Process vi -Force  kill tt c child processes\n    // -Force s kill process ngay c khi c child processes\n    const escapedName = processBaseName.replace(/'/g, \"''\");\n    const killCommand = `Get-Process -Name '${escapedName}' -ErrorAction SilentlyContinue | Stop-Process -Force -ErrorAction Stop`;\n    \n    let command: string;\n    \n    if (useAdmin) {\n      // S dng Start-Process vi RunAs  c quyn admin\n      // Escaping: single quotes trong PowerShell argument list\n      const escapedKillCommand = killCommand.replace(/'/g, \"''\").replace(/\"/g, '`\"');\n      // S dng double quotes bn ngoi v escape ng cch\n      const psCommand = `Start-Process powershell -ArgumentList '-NoProfile','-ExecutionPolicy','Bypass','-Command',\\\"${escapedKillCommand}\\\" -Verb RunAs -Wait -WindowStyle Hidden`;\n      command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${psCommand.replace(/\"/g, '`\"').replace(/\\$/g, '`$')}\"`;\n    } else {\n      // Dng single quotes trong PowerShell  trnh escape phc tp\n      command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${killCommand.replace(/\"/g, '`\"').replace(/\\$/g, '`$')}\"`;\n    }\n\n    try {\n      await execAsync(command, { windowsHide: true });\n    } catch (error: any) {\n      const errorMsg = (error?.message || error?.stderr || String(error) || '').toLowerCase();\n      \n      // Ignore nu process khng tn ti\n      if (\n        errorMsg.includes('cannot find a process') ||\n        errorMsg.includes('process not found') ||\n        errorMsg.includes('cannot find process')\n      ) {\n        this.logger.debug(`Process not found (expected): ${processBaseName}`);\n        return;\n      }\n      \n      throw error; // Re-throw  caller x l\n    }\n  }\n\n  /**\n   * Kim tra xem process c ang chy khng\n   */\n  private async isRunning(processName: string): Promise<boolean> {\n    try {\n      const command = `tasklist /FI \"IMAGENAME eq ${processName}\" /FO CSV /NH`;\n      const { stdout } = await execAsync(command, { windowsHide: true });\n      \n      const output = stdout.toLowerCase().trim();\n      if (!output || output.includes('no tasks') || output === 'info:') {\n        return false;\n      }\n      \n      return output.includes(processName.toLowerCase());\n    } catch (error) {\n      // Nu c li khi check, coi nh khng chy\n      return false;\n    }\n  }\n\n  /**\n   * i cho n khi process khng cn chy\n   */\n  private async waitUntilNotRunning(processName: string, timeoutMs: number): Promise<void> {\n    const start = Date.now();\n    \n    while (Date.now() - start < timeoutMs) {\n      const running = await this.isRunning(processName);\n      if (!running) {\n        return;\n      }\n      await sleep(250);\n    }\n    \n    this.logger.warn(`Process still running after ${timeoutMs}ms: ${processName}`);\n  }\n\n  /**\n   * Khi ng ng dng\n   * @param args - Tham s khi ng ng dng\n   * @param args.exePath - ng dn y  n file exe\n   * @param args.startTarget - Target  khi ng (exe name, URL, file path)\n   * @param args.runAsAdmin - Chy vi quyn Administrator (hin UAC prompt)\n   */\n  private async startApp(args: { exePath?: string; startTarget?: string; runAsAdmin?: boolean }): Promise<void> {\n    const target = args.exePath ?? args.startTarget ?? '';\n    const runAsAdmin = args.runAsAdmin ?? false;\n    \n    if (!target) {\n      throw new Error('Start target is empty');\n    }\n\n    // TODO: Uncomment when debugging\n    // const adminText = runAsAdmin ? ' as Administrator' : '';\n    // this.logger.debug(`[restart] Starting app${adminText}: ${target}`);\n\n    try {\n      if (runAsAdmin) {\n        // S dng PowerShell Start-Process vi -Verb RunAs  chy vi quyn admin\n        // S hin th UAC prompt cho ngi dng\n        // S dng single quotes trong PowerShell  trnh phi escape c bit\n        const escapedTarget = target.replace(/'/g, \"''\"); // Escape single quotes trong PowerShell\n        const psCommand = `Start-Process -FilePath '${escapedTarget}' -Verb RunAs`;\n        // Escape double quotes v $ cho command line\n        const escapedCommand = psCommand.replace(/\"/g, '`\"').replace(/\\$/g, '`$');\n        const command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${escapedCommand}\"`;\n        \n        await execAsync(command);\n        this.logger.log(`App started with Administrator privileges: ${target}`);\n      } else {\n        // S dng start command ca Windows  m ng dng bnh thng\n        // start \"\"  khng hin th title ca command prompt\n        const command = `start \"\" \"${target}\"`;\n        await execAsync(command, { windowsHide: true });\n\n        this.logger.log(`App started successfully: ${target}`);\n      }\n      \n      // i mt cht  ng dng khi ng\n      await sleep(500);\n      \n    } catch (error: any) {\n      const errorMsg = error?.message || String(error);\n      this.logger.error(`Failed to start app: ${target}`, errorMsg);\n      throw error;\n    }\n  }\n\n  // -----------------------------\n  // Utils\n  // -----------------------------\n\n  private escapePs(value: string): string {\n    // Escape \" v $ trong PowerShell string\n    return value.replace(/\"/g, '`\"').replace(/\\$/g, '`$');\n  }\n}\n","module.exports = require(\"child_process\");","module.exports = require(\"util\");","import { Injectable, Logger } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { randomUUID } from 'crypto';\n\n// Lua script for atomic unlock (only unlock if lockId matches)\nconst UNLOCK_SCRIPT = `\nif redis.call(\"GET\", KEYS[1]) == ARGV[1] then\n  return redis.call(\"DEL\", KEYS[1])\nelse\n  return 0\nend\n`;\n\n@Injectable()\nexport class RedisLockService {\n  private readonly logger = new Logger('RedisLockService');\n  private readonly DEFAULT_LOCK_TTL = 3 * 60 * 1000; // 3 minutes default\n\n  constructor(private readonly redisService: RedisService) {}\n\n  /**\n   * Acquire lock for a device (atomic operation using SET NX EX)\n   */\n  async acquireLock(\n    key: string,\n    ttl: number = this.DEFAULT_LOCK_TTL\n  ): Promise<boolean> {\n    try {\n      const lockId = randomUUID();\n      const ttlSeconds = Math.ceil(ttl / 1000);\n\n      // Use atomic SET NX EX to acquire lock\n      // This ensures only one process can acquire the lock\n      const client = await this.redisService.getClient();\n      const result = await client.set(key, lockId, 'EX', ttlSeconds, 'NX');\n\n      return result === 'OK';\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Release lock for a device (atomic operation using Lua script)\n   */\n  async releaseLock(key: string): Promise<void> {\n    try {\n      const client = await this.redisService.getClient();\n      \n      // Get current lockId before releasing\n      const lockId = await client.get(key);\n      \n      if (!lockId) {\n        return;\n      }\n\n      // Use Lua script to atomically check and delete only if lockId matches\n      // This prevents releasing lock that was acquired by another process\n      const result = await client.eval(\n        UNLOCK_SCRIPT,\n        1, // number of keys\n        key, // KEYS[1] - lock key\n        lockId as string // ARGV[1] - lockId to verify\n      ) as number;\n\n      if (result === 1) {\n        this.logger.log(`Released lock (lockId: ${key}:${lockId})`);\n      } else {\n        // Lock was already released or changed by another process\n        this.logger.warn(`Lock was already released or changed (expected lockId: ${key}:${lockId})`);\n      }\n    } catch (error) {\n      this.logger.error(`Error releasing lock: ${key} ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Get current lock\n   */\n  async getLock(key: string): Promise<string | null> {\n    try {\n      const lockId = await this.redisService.get(key);\n\n      return lockId ?? null;\n    } catch (error) {\n      this.logger.error(`[${key}] Error getting lock: ${error.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Check if lock is acquired\n   */\n  async isLocked(key: string): Promise<boolean> {\n    try {\n      const lockId = await this.getLock(key);\n\n      return !!lockId;\n    } catch (error) {\n      this.logger.error(`[${key}] Error checking lock status: ${error.message}`);\n      // On error, assume not locked (fail open)\n      return false;\n    }\n  }\n}\n\n","export const SYSTEM_LOCK_BOXPHONE = 'system:lock:boxphone';\nexport const SYSTEM_LOCK_PAUSE_PROCESSING = 'system:lock:pauseprocessing';","import { plainToInstance } from 'class-transformer';\nimport { validate } from 'class-validator';\n\nexport const validateObjectResult = async <T extends object>(\n  DtoClass: new () => T,\n  payload: unknown,\n) => {\n  const instance = plainToInstance(DtoClass, payload, {\n    enableImplicitConversion: true,\n  });\n\n  const errors = await validate(instance, {\n    whitelist: true,\n    forbidNonWhitelisted: true,\n    forbidUnknownValues: true,\n    validationError: { target: false, value: false },\n  });\n\n  return { ok: errors.length === 0, instance, errors };\n}","module.exports = require(\"class-transformer\");","export const JOB_PRIORITY_KEY = 'bull:wda-request:priority';\nexport const JOB_PRIORITY_KEY_LARGE_AMOUNT = 'bull:wda-request-large-amount:priority';\nexport const DELAY_RETRY_JOB = 15000; // 15 seconds\nexport const JOB_PROCESS_NAME = 'process-withdrawal-request';\nexport const JOB_PROCESS_NAME_INTERNAL_JOB = 'process-internal-transfer';\nexport const JOB_PRIORITY_KEY_INTERNAL_JOB = 'bull:internal-transfer:priority';","export enum WithdrawalStatus {\n  PENDING = 'PENDING',\n  FAILED = 'FAILED',\n  PROCESSING = 'PROCESSING',\n  RETRY = 'RETRY',\n  COMPLETED = 'COMPLETED',\n  UNKNOWN = 'UNKNOWN', // Khi phn tch nh mn hnh khng th xc nh trng thi chuyn thnh cng\n  NA = 'NA', // Khi khng c nh hoc phn tch nh b li\n}","export const bullQueueNames = {\n  WITHDRAWAL_REQUEST: 'wda-request',\n  WITHDRAWAL_REQUEST_LARGE_AMOUNT: 'wda-request-large-amount',\n  INTERNAL_TRANSFER: 'internal-transfer',\n};","import { Withdrawal } from \"@/common\";\nimport { DeviceConfig } from \"@/modules/device/dto/device-config.dto\";\nimport { Job } from \"bull\";\n\nexport const sortDevices = (\n  devices: DeviceConfig[],\n  key: 'minTransferAmount',\n  direction: 'asc' | 'desc'\n): DeviceConfig[] => {\n  if (direction === 'asc') {\n    return [...devices].sort((a, b) => a[key] - b[key]);\n  } else {\n    return [...devices].sort((a, b) => b[key] - a[key]);\n  }\n}\n\nexport const sortJobs = (\n  jobs: Job<Withdrawal>[],\n  key: 'priority',\n  direction: 'asc' | 'desc'\n): Job<Withdrawal>[] => {\n  if (direction === 'asc') {\n    return jobs.sort((a, b) => a.data[key] - b.data[key]);\n  } else {\n    return jobs.sort((a, b) => b.data[key] - a.data[key]);\n  }\n}","import { Controller, Get, Post, Logger } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse } from '@nestjs/swagger';\nimport { WithdrawalJobManagerService } from './withdrawal-job-manager.service';\n\n@ApiTags('withdrawal')\n@Controller('api/withdrawal')\nexport class WithdrawalController {\n  private readonly logger = new Logger('WithdrawalController');\n\n  constructor(\n    private readonly jobManagerService: WithdrawalJobManagerService,\n  ) {}\n\n  @Get('queue/stats')\n  @ApiOperation({ summary: 'Get withdrawal queue statistics' })\n  @ApiResponse({ status: 200, description: 'Queue statistics' })\n  async getQueueStats() {\n    return await this.jobManagerService.getQueueStats();\n  }\n\n  @Get('queue/debug')\n  @ApiOperation({ summary: 'Get detailed queue debug information' })\n  @ApiResponse({ status: 200, description: 'Detailed queue debug info' })\n  async debugQueue() {\n    return await this.jobManagerService.debugQueue();\n  }\n\n  // TODO: remove\n  // @Post('queue/trigger')\n  // @ApiOperation({ summary: 'Manually trigger job picking' })\n  // @ApiResponse({ status: 200, description: 'Job picking triggered' })\n  // async triggerJobPicking() {\n  //   this.logger.log('Manually triggering job picking...');\n  //   await this.jobManagerService.triggerPickJobs(1);\n  //   const stats = await this.jobManagerService.getQueueStats();\n  //   return {\n  //     success: true,\n  //     message: 'Job picking triggered',\n  //     stats,\n  //   };\n  // }\n\n  // TODO: remove\n  // @Post('queue/start')\n  // @ApiOperation({ summary: 'Manually start job processing' })\n  // @ApiResponse({ status: 200, description: 'Job processing started' })\n  // async startProcessing() {\n  //   this.logger.log('Manually starting job processing...');\n  //   await this.jobManagerService.startProcessing();\n  //   const stats = await this.jobManagerService.getQueueStats();\n  //   return {\n  //     success: true,\n  //     message: 'Job processing started',\n  //     stats,\n  //   };\n  // }\n}\n\n\n","import { Module, forwardRef } from '@nestjs/common';\nimport { DeviceController } from './device.controller';\nimport { DeviceService } from './device.service';\nimport { DeviceLockService } from './device-lock.service';\nimport { RedisService } from '../../common/services/redis.service';\nimport { BankModule } from '../bank/bank.module';\n\n@Module({\n  imports: [\n    forwardRef(() => BankModule),\n  ],\n  controllers: [DeviceController],\n  providers: [\n    DeviceService,\n    DeviceLockService,\n    RedisService,\n  ],\n  exports: [\n    DeviceService,\n    DeviceLockService,\n  ],\n})\nexport class DeviceModule {}\n\n","import { Controller, Get, Put, Param, Body, Post, Delete, Render, HttpException, HttpStatus, Logger } from '@nestjs/common';\nimport { DeviceService } from './device.service';\nimport { UpdateDeviceConfigDto } from './dto/device-config.dto';\nimport { BankService } from '../bank/bank.service';\nimport { config } from '@/common/constants/config';\n\n@Controller()\nexport class DeviceController {\n  private readonly logger = new Logger('DeviceController');\n\n  constructor(\n    private readonly deviceService: DeviceService,\n    private readonly bankService: BankService,\n  ) { }\n\n  @Get()\n  @Render('devices')\n  async getDevicesPage() {\n    const devices = await this.deviceService.listDevices();\n    const serviceStatus = await this.deviceService.getServiceStatus();\n    const pandaConnectionStatus = this.deviceService.getPandaConnectionStatus();\n\n    return {\n      devices,\n      serviceStatus,\n      pandaConnectionStatus,\n      banks: ['ACB', 'HDBANK', 'PGBANK', 'TECHCOMBANK', 'TPBANK', 'VIETCOMBANK'],\n      boxType: config.boxType\n    };\n  }\n\n  @Get('api/devices')\n  async getDevices() {\n    const devices = await this.deviceService.listDevices();\n    return {\n      success: true,\n      data: devices,\n    };\n  }\n\n  @Get('api/devices/:deviceId/config')\n  async getDeviceConfig(@Param('deviceId') deviceId: string) {\n    const config = await this.deviceService.getDeviceConfigSafe(deviceId);\n    return {\n      success: true,\n      data: config,\n    };\n  }\n\n  @Post('api/devices/:deviceId/retryLogin')\n  async retryLogin(@Param('deviceId') deviceId: string) {\n    try {\n      this.logger.log(`Retry login requested for device ${deviceId}`);\n\n      // Get device config to check bankCode and status\n      const deviceConfig = await this.deviceService.getDeviceConfig(deviceId);\n\n      if (!deviceConfig) {\n        throw new HttpException(\n          {\n            success: false,\n            error: `Device ${deviceId} not found or not configured`,\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      if (!deviceConfig.bankCode || deviceConfig.bankCode.trim() === '') {\n        throw new HttpException(\n          {\n            success: false,\n            error: `Device ${deviceId} does not have bankCode configured. Please configure bankCode first.`,\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      // Attempt to login\n      const bankCode = deviceConfig.bankCode.toUpperCase();\n      await this.bankService.login(bankCode, deviceId);\n\n      return {\n        success: true,\n        message: `Successfully logged in to ${bankCode} on device ${deviceId}`,\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error retrying login for device ${deviceId}: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to retry login',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Put('api/devices/:deviceId/config')\n  async updateDeviceConfig(\n    @Param('deviceId') deviceId: string,\n    @Body() dto: UpdateDeviceConfigDto,\n  ) {\n    try {\n      this.logger.log(`Updating device config for ${deviceId}: ${JSON.stringify(dto)}`);\n\n      // Get existing config to check current status if status is not provided\n      const existingConfig = await this.deviceService.getDeviceConfig(deviceId);\n      const finalStatus = dto.status !== undefined ? dto.status : existingConfig?.status || 'deactive';\n\n      // Manual validation: if status is 'active' (either from dto or existing), all fields are required\n      if (finalStatus === 'active') {\n        const errors: string[] = [];\n\n        // Check bankCode: from dto or existing config\n        const bankCode = dto.bankCode !== undefined ? dto.bankCode : existingConfig?.bankCode;\n        if (!bankCode || bankCode.trim() === '') {\n          errors.push('Bank Code l bt buc khi status l active');\n        }\n\n        // Check availableAmount: from dto or existing config\n        const availableAmount = dto.availableAmount !== undefined ? dto.availableAmount : existingConfig?.availableAmount;\n        if (availableAmount === undefined || availableAmount === null || availableAmount < 0) {\n          errors.push('Available Amount l bt buc v phi >= 0 khi status l active');\n        }\n\n        // Check password: from dto or existing config\n        const password = dto.password !== undefined ? dto.password : existingConfig?.password;\n        if (!password || password.trim() === '') {\n          errors.push('Password l bt buc khi status l active');\n        }\n\n        // Check smartOTP: from dto or existing config\n        const smartOTP = dto.smartOTP !== undefined ? dto.smartOTP : existingConfig?.smartOTP;\n        if (!smartOTP || smartOTP.trim() === '') {\n          errors.push('Smart OTP l bt buc khi status l active');\n        }\n\n        if (errors.length > 0) {\n          throw new HttpException(\n            {\n              success: false,\n              error: errors.join(', '),\n            },\n            HttpStatus.BAD_REQUEST,\n          );\n        }\n      }\n\n      const config = await this.deviceService.updateDeviceConfig(deviceId, dto);\n      return {\n        success: true,\n        data: config,\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error updating device config for ${deviceId}: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to update device config',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('api/service/status')\n  async getServiceStatus() {\n    const status = await this.deviceService.getServiceStatus();\n    return {\n      success: true,\n      data: { status },\n    };\n  }\n\n  @Post('api/service/start')\n  async startService() {\n    return await this.deviceService.startService();\n  }\n\n  @Post('api/service/stop')\n  async stopService() {\n    await this.deviceService.setServiceStatus('inactive');\n    return {\n      success: true,\n      message: 'Service stopped successfully',\n    };\n  }\n\n  @Delete('api/devices/:deviceId/config')\n  async deleteDeviceConfig(@Param('deviceId') deviceId: string) {\n    await this.deviceService.deleteDeviceConfig(deviceId);\n    return {\n      success: true,\n      message: 'Device config deleted successfully',\n    };\n  }\n}\n\n","import { Module, forwardRef } from '@nestjs/common';\nimport { BankService } from './bank.service';\nimport { AcbService } from './acb.service';\nimport { PgService } from './pg.service';\nimport { HdBankService } from './hdbank.service';\nimport { BankController } from './bank.controller';\nimport { DeviceModule } from '../device/device.module';\nimport { WebSocketModule } from '../../common/modules/websocket/websocket.module';\nimport { SessionManagementService } from './session-management.service';\nimport { SessionRefreshScheduler } from './session-refresh.scheduler';\nimport { RedisService } from '../../common/services/redis.service';\nimport { OCRModule } from '../ocr/ocr.module';\nimport { NotificationModule } from '../notifiction/notification.module';\nimport { VietcombankService } from './vietcombank.service';\n\n@Module({\n  imports: [\n    forwardRef(() => DeviceModule),\n    WebSocketModule,\n    OCRModule,\n    NotificationModule\n  ],\n  controllers: [BankController],\n  providers: [\n    BankService,\n    AcbService,\n    PgService,\n    HdBankService,\n    VietcombankService,\n    SessionManagementService,\n    SessionRefreshScheduler,\n    RedisService,\n  ],\n  exports: [BankService],\n})\nexport class BankModule {}\n\n","import { Controller, Post, Param, Get, Query, Logger, HttpException, HttpStatus, Inject } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiParam, ApiQuery, ApiResponse } from '@nestjs/swagger';\nimport { BankService } from './bank.service';\nimport { IBankService } from './interfaces/bank-service.interface';\nimport { config } from '@/common/constants/config';\nimport { PandaSwipeType } from '@/common/modules/websocket/interface/websocket.interface';\nimport { mkdir, readFile, writeFile, rm } from 'fs/promises';\nimport { ImagePreprocessingService } from '../ocr/services/image-preprocessing.service';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { removeVietnameseTones } from '@/common/utils/string';\nimport { PandaManagerService } from '@/common/modules/websocket/panda-manager.service';\nimport { PandaDeviceType } from '@/common/modules/websocket/constants/device';\n\n@ApiTags('bank')\n@Controller('api/bank/:deviceType')\nexport class BankController {\n  private readonly logger = new Logger('BankController');\n\n  constructor(\n    private readonly bankService: BankService,\n    private readonly pandaManagerService: PandaManagerService,\n    private readonly imagePreprocessingService: ImagePreprocessingService,\n    private readonly ocrService: OCRService,\n  ) { }\n\n  /**\n   * Get bank service by bank code\n   */\n  private getBankService(bankCode: string): IBankService {\n    const service = this.bankService.getBankService(bankCode);\n    if (!service) {\n      throw new HttpException(\n        {\n          success: false,\n          error: `Bank service not found for bank code: ${bankCode}. Supported banks: ${this.bankService.getSupportedBanks().join(', ')}`,\n        },\n        HttpStatus.BAD_REQUEST,\n      );\n    }\n    return service;\n  }\n\n  @Get('devices')\n  @ApiOperation({ summary: 'Get list of available devices' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiResponse({ status: 200, description: 'List of devices retrieved successfully' })\n  async getDevices(@Param('deviceType') deviceType: PandaDeviceType) {\n    try {\n      const devices = await this.pandaManagerService.getPandaService(deviceType).listDevices();\n\n      return {\n        success: true,\n        data: devices,\n      };\n    } catch (error) {\n      this.logger.error(`Error getting devices: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/launch-app/:deviceId')\n  @ApiOperation({ summary: 'Test launching bank app on a device' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiParam({ name: 'bundleId', description: 'Bundle ID' })\n  @ApiResponse({ status: 200, description: 'App launched successfully' })\n  async testLaunchApp(\n    @Param('deviceType') deviceType: PandaDeviceType,\n    @Param('deviceId') deviceId: string,\n    @Param('bundleId') bundleId: string,\n  ) {\n    try {\n      const wsService = this.pandaManagerService.getPandaService(deviceType);\n      await wsService.launchApp(deviceId, bundleId);\n\n      return {\n        success: true,\n        message: `${bundleId} app launched successfully on device ${deviceId}`,\n      };\n    } catch (error) {\n      this.logger.error(`Error testing ${bundleId} app launch: ${error.message}`);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  \n  @Post('test/capture-screen/:deviceId')\n  @ApiOperation({ summary: 'Test screen capture on a device' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'name', description: 'Screen capture name (optional)', required: false })\n  @ApiQuery({ name: 'quality', description: 'Image quality (0-1, default: 0.5)', required: false })\n  @ApiResponse({ status: 200, description: 'Screen captured successfully' })\n  async testCaptureScreen(\n    @Param('deviceType') deviceType: PandaDeviceType,\n    @Param('deviceId') deviceId: string,\n    @Query('name') name?: string,\n    @Query('quality') quality?: string,\n  ) {\n    try {\n      this.logger.log(`Testing screen capture on device: ${deviceId}`);\n\n      const qualityValue = quality ? parseFloat(quality) : 0.5;\n      const captureName = name || `test-screen-capture-${Date.now()}`;\n\n      const base64Image = await this.pandaManagerService.getPandaService(deviceType).captureScreen(deviceId, {\n        quality: qualityValue,\n        folderPath: `C:/boxscreen/${captureName}.png`,\n      });\n\n      return {\n        success: true,\n        message: `Screen captured successfully on device ${deviceId}`,\n        data: {\n          base64Image,\n          imageLength: base64Image?.length ?? 0,\n        },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing screen capture: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/click/:deviceId')\n  @ApiOperation({ summary: 'Test clicking at specific coordinates on a device' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'x', description: 'X coordinate (HC: 0-1, Panda: 0-100)', required: true })\n  @ApiQuery({ name: 'y', description: 'Y coordinate (Hc: 0-1), Panda: 0-100', required: true })\n  @ApiResponse({ status: 200, description: 'Click completed successfully' })\n  async testClickAtCoordinates(\n    @Param('deviceType') deviceType: PandaDeviceType,\n    @Param('deviceId') deviceId: string,\n    @Query('x') x: string,\n    @Query('y') y: string,\n  ) {\n    try {\n      const xCoord = parseFloat(x);\n      const yCoord = parseFloat(y);\n\n      if (isNaN(xCoord) || isNaN(yCoord)) {\n        return {\n          success: false,\n          error: 'Invalid coordinates. x and y must be numbers between 0 and 1',\n          example: `/api/bank/${deviceType}/test/click/{deviceId}?x=0.5&y=0.55`,\n        };\n      }\n\n      this.logger.log(`Testing click at coordinates (${xCoord}, ${yCoord}) on device: ${deviceId}`);\n\n      await this.pandaManagerService.getPandaService(deviceType).click(deviceId, xCoord, yCoord);\n\n      return {\n        success: true,\n        message: `Click completed successfully at coordinates (${xCoord}, ${yCoord}) on device ${deviceId}`,\n        coordinates: { x: xCoord, y: yCoord },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing click at coordinates: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/swipe/:deviceId')\n  @ApiOperation({ summary: 'Test swiping on a device. Format is determined by config.boxType (HC or PANDA)' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'x', description: 'X coordinate (HC: 0-1, Panda: 0-100). Required for HC and Panda types 0,1,2,10. Optional for Panda types 4,5,6,7,8,9', required: false })\n  @ApiQuery({ name: 'y', description: 'Y coordinate (HC: 0-1, Panda: 0-100). Required for HC and Panda types 0,1,2,10. Optional for Panda types 4,5,6,7,8,9', required: false })\n  @ApiQuery({ name: 'type', description: 'Panda pointer event type: 0=(press), 1=(lift), 2=(move), 4=(scroll up), 5=(scroll down), 6=(swipe up), 7=(swipe down), 8=(swipe left), 9=(swipe right), 10=(click). Required for Panda format.', required: false })\n  @ApiQuery({ name: 'endX', description: 'End X coordinate for HC (required for HC: 0-1)', required: false })\n  @ApiQuery({ name: 'endY', description: 'End Y coordinate for HC (required for HC: 0-1)', required: false })\n  @ApiQuery({ name: 'duration', description: 'Swipe duration for HC (default: 0.2)', required: false })\n  @ApiResponse({ status: 200, description: 'Swipe completed successfully' })\n  async testSwipe(\n    @Param('deviceType') deviceType: PandaDeviceType,\n    @Param('deviceId') deviceId: string,\n    @Query('x') x?: string,\n    @Query('y') y?: string,\n    @Query('type') type?: string,\n    @Query('endX') endX?: string,\n    @Query('endY') endY?: string,\n    @Query('duration') duration?: string,\n  ) {\n    try {\n      // Determine format based on config.boxType\n      const isPandaFormat = config.boxType === 'PANDA';\n      const isHCFormat = config.boxType === 'HC';\n\n      if (isPandaFormat) {\n        // Panda format: type is required\n        if (!type) {\n          return {\n            success: false,\n            error: 'For Panda format: type is required',\n            example: `/api/bank/${deviceType}/test/swipe/{deviceId}?type=0`,\n          };\n        }\n\n        // Validate type: must be one of the valid Panda types\n        const validTypes: PandaSwipeType[] = ['0', '1', '2', '4', '5', '6', '7', '8', '9', '10'];\n        if (!validTypes.includes(type as PandaSwipeType)) {\n          return {\n            success: false,\n            error: `Invalid type. Type must be one of: 0 (/press), 1 (/lift), 2 (/move), 4 (/scroll up), 5 (/scroll down), 6 (/swipe up), 7 (/swipe down), 8 (/swipe left), 9 (/swipe right), 10 (/click)`,\n            example: `/api/bank/${deviceType}/test/swipe/{deviceId}?type=0`,\n          };\n        }\n\n        // For scroll (4,5) and swipe directions (6,7,8,9), x and y are optional\n        const noCoordinateTypes: PandaSwipeType[] = ['4', '5', '6', '7', '8', '9'];\n        const isNoCoordinateType = noCoordinateTypes.includes(type as PandaSwipeType);\n\n        // For other types (0,1,2,10), x and y are required\n        if (!isNoCoordinateType && (!x || !y)) {\n          return {\n            success: false,\n            error: `For Panda type ${type}: x and y are required`,\n            example: `/api/bank/${deviceType}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n          };\n        }\n\n        // Build options object\n        const pandaOptions: any = {\n          type: type as PandaSwipeType,\n        };\n\n        // Only add x, y if provided (required for non-swipe-direction types, optional for swipe directions)\n        if (x && y) {\n          const xCoord = parseFloat(x);\n          const yCoord = parseFloat(y);\n\n          if (isNaN(xCoord) || isNaN(yCoord)) {\n            return {\n              success: false,\n              error: 'Invalid coordinates. x and y must be numbers between 0 and 100 for Panda',\n              example: `/api/bank/${deviceType}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n            };\n          }\n\n          // Validate coordinates for Panda (0-100)\n          if (xCoord < 0 || xCoord > 100 || yCoord < 0 || yCoord > 100) {\n            return {\n              success: false,\n              error: 'Invalid coordinates. x and y must be between 0 and 100 for Panda',\n              example: `/api/bank/${deviceType}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n            };\n          }\n\n          pandaOptions.x = xCoord.toString();\n          pandaOptions.y = yCoord.toString();\n        }\n\n        this.logger.log(`Testing Panda swipe on device: ${deviceId} with type=${type}${x && y ? `, x=${x}, y=${y}` : ' (swipe direction, no coordinates)'}`);\n\n        await this.pandaManagerService.getPandaService(deviceType).swipe(deviceId, pandaOptions);\n\n        return {\n          success: true,\n          message: `Panda swipe completed successfully on device ${deviceId}`,\n          coordinates: {\n            type: type,\n            ...(x && y ? { x, y } : {}),\n          },\n        };\n      } else if (isHCFormat) {\n        // HC format: x, y, endX, endY, duration (x, y, endX, endY required)\n        if (!x || !y || !endX || !endY) {\n          return {\n            success: false,\n            error: 'For HC format: x, y, endX, and endY are required',\n            example: `/api/bank/${deviceType}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        const xCoord = parseFloat(x);\n        const yCoord = parseFloat(y);\n        const endXCoord = parseFloat(endX);\n        const endYCoord = parseFloat(endY);\n        const durationValue = duration ? parseFloat(duration) : 0.2;\n\n        if (isNaN(xCoord) || isNaN(yCoord) || isNaN(endXCoord) || isNaN(endYCoord)) {\n          return {\n            success: false,\n            error: 'Invalid coordinates. x, y, endX, and endY must be numbers between 0 and 1 for HC',\n            example: `/api/bank/${deviceType}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        // Validate coordinates for HC (0-1)\n        if (xCoord < 0 || xCoord > 1 || yCoord < 0 || yCoord > 1 ||\n          endXCoord < 0 || endXCoord > 1 || endYCoord < 0 || endYCoord > 1) {\n          return {\n            success: false,\n            error: 'Invalid coordinates. x, y, endX, and endY must be between 0 and 1 for HC',\n            example: `/api/bank/${deviceType}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        this.logger.log(`Testing HC swipe from (${xCoord}, ${yCoord}) to (${endXCoord}, ${endYCoord}) on device: ${deviceId}`);\n\n        await this.pandaManagerService.getPandaService(deviceType).swipe(deviceId, {\n          x: xCoord,\n          y: yCoord,\n          endX: endXCoord,\n          endY: endYCoord,\n          duration: durationValue,\n        });\n\n        return {\n          success: true,\n          message: `HC swipe completed successfully from (${xCoord}, ${yCoord}) to (${endXCoord}, ${endYCoord}) on device ${deviceId}`,\n          coordinates: {\n            start: { x: xCoord, y: yCoord },\n            end: { x: endXCoord, y: endYCoord },\n            duration: durationValue,\n          },\n        };\n      } else {\n        return {\n          success: false,\n          error: `Invalid box type configuration: ${config.boxType}. Must be 'HC' or 'PANDA'`,\n        };\n      }\n    } catch (error) {\n      this.logger.error(`Error testing swipe: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/input-numpad/:deviceId')\n  @ApiOperation({ summary: 'Test inputting number using numpad layout on a device' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'number', description: 'Number string to input (e.g., \"123\", \"456789\")', required: true })\n  @ApiResponse({ status: 200, description: 'Numpad number input completed successfully' })\n  async testInputNumpadNumber(\n    @Param('deviceType') deviceType: PandaDeviceType,\n    @Param('deviceId') deviceId: string,\n    @Query('number') number: string,\n  ) {\n    try {\n\n      if (!number || number.trim().length === 0) {\n        return {\n          success: false,\n          error: 'Number is required and cannot be empty',\n          example: `/api/bank/${deviceType}/test/input-numpad/{deviceId}?number=123456`,\n        };\n      }\n\n      // Validate that number contains only digits\n      if (!/^\\d+$/.test(number)) {\n        return {\n          success: false,\n          error: 'Number must contain only digits (0-9)',\n          example: `/api/bank/${deviceType}/test/input-numpad/{deviceId}?number=123456`,\n        };\n      }\n\n      this.logger.log(`Testing numpad number input \"${number}\" on device: ${deviceId}`);\n\n      await this.pandaManagerService.getPandaService(deviceType).inputNumpadNumber(deviceId, number);\n\n      return {\n        success: true,\n        message: `Numpad number input completed successfully on device ${deviceId}`,\n        data: {\n          number: number,\n          digits: number.split('').map(d => parseInt(d)),\n        },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing numpad number input: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/input-text/:deviceId')\n  @ApiOperation({ summary: 'Test inputting text using keyboard layout on a device' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'text', description: 'Text string to input (e.g., \"abc123\", \"test@email.com\")', required: true })\n  @ApiResponse({ status: 200, description: 'Text input completed successfully' })\n  async testInputText(\n    @Param('deviceType') deviceType: PandaDeviceType,\n    @Param('deviceId') deviceId: string,\n    @Query('text') text: string,\n  ) {\n    try {\n      if (!text || text.trim().length === 0) {\n        return {\n          success: false,\n          error: 'Text is required and cannot be empty',\n          example: `/api/bank/${deviceType}/test/input-text/{deviceId}?text=abc123`,\n        };\n      }\n\n      this.logger.log(`Testing text input \"${text}\" on device: ${deviceId}`);\n\n      await this.pandaManagerService.getPandaService(deviceType).inputText(deviceId, text);\n\n      return {\n        success: true,\n        message: `Text input completed successfully on device ${deviceId}`,\n      };\n    } catch (error) {\n      this.logger.error(`Error testing text input: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/press-return/:deviceId')\n  @ApiOperation({ summary: 'Test pressing return key on a device' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiResponse({ status: 200, description: 'Return key pressed successfully' })\n  async testPressReturn(\n    @Param('deviceType') deviceType: PandaDeviceType,\n    @Param('deviceId') deviceId: string,\n  ) {\n    try {\n      this.logger.log(`Testing press return key on device: ${deviceId}`);\n\n      await this.pandaManagerService.getPandaService(deviceType).pressReturnKey(deviceId);\n\n      return {\n        success: true,\n        message: `Return key pressed successfully on device ${deviceId}`,\n        note: 'This key can dismiss keyboard or submit/enter depending on context',\n      };\n    } catch (error) {\n      this.logger.error(`Error testing press return: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/roi')\n  @ApiOperation({ summary: 'Test ROI detection on a device' })\n  @ApiParam({ name: 'deviceType', description: 'Device type (ANDROID, IOS)' })\n  @ApiQuery({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'x', description: 'X coordinate', required: true })\n  @ApiQuery({ name: 'y', description: 'Y coordinate', required: true })\n  @ApiQuery({ name: 'width', description: 'Width', required: true })\n  @ApiQuery({ name: 'height', description: 'Height', required: true })\n  async testRoi(\n    @Param('deviceType') deviceType: PandaDeviceType,\n    @Query('deviceId') deviceId: string,\n    @Query('x') x: string,\n    @Query('y') y: string,\n    @Query('width') width: string,\n    @Query('height') height: string,\n  ) {\n    const folderPath = 'C:/testroi';\n    \n    // Xa folder v to li (ti u hn xa tng file)\n    try {\n      await rm(folderPath, { recursive: true, force: true });\n      this.logger.log(` xa folder ${folderPath}`);\n    } catch (error) {\n      // Folder c th cha tn ti, khng sao\n      this.logger.debug(`Khng th xa folder: ${error.message}`);\n    }\n    \n    await mkdir(folderPath, { recursive: true });\n\n    await this.pandaManagerService.getPandaService(deviceType).captureScreen(deviceId, {\n      folderPath: folderPath,\n    });\n\n    const imaggePath = await this.bankService.getLatestImagePath(folderPath);\n    const imageBuffer = await readFile(imaggePath);\n\n    const processedImage = await this.imagePreprocessingService.preprocess(\n      imageBuffer, \n      {\n        x: parseFloat(x),\n        y: parseFloat(y),\n        width: parseFloat(width),\n        height: parseFloat(height),\n      },  \n      undefined,\n      {\n        grayscale: true,\n        enhanceContrast: true\n      }\n    );\n\n    const ocrResult =   await this.ocrService.recognizeFromBuffer(processedImage.buffer);\n\n    // Ghi image buffer ra file\n    const outputPath = `${folderPath}/processed-${Date.now()}.png`;\n    await writeFile(outputPath, processedImage.buffer);\n\n    return {\n      ...ocrResult,\n      normalizedText: removeVietnameseTones(ocrResult.text),\n    }\n  }\n}\n\n","import { Global, Module } from '@nestjs/common';\nimport { PANDA_SERVICE_ANDROID, PANDA_SERVICE_IOS } from './constants/websocket';\nimport { RedisService } from '@/common/services/redis.service';\nimport { PandaAndroidService } from './panda-android.service';\nimport { PandaIosService } from './panda-ios.service';\nimport { PandaManagerService } from './panda-manager.service';\n\n@Global()\n@Module({\n  providers: [\n    RedisService,\n    {\n      provide: PANDA_SERVICE_ANDROID,\n      useClass: PandaAndroidService,\n    },\n    {\n      provide: PANDA_SERVICE_IOS,\n      useClass: PandaIosService\n    },\n    PandaManagerService\n  ],\n  exports: [PandaManagerService, PANDA_SERVICE_ANDROID, PANDA_SERVICE_IOS],\n})\nexport class WebSocketModule {}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { Cron } from '@nestjs/schedule';\nimport { BankService } from './bank.service';\nimport { DeviceService } from '../device/device.service';\nimport { SessionManagementService } from './session-management.service';\nimport { RedisLockService } from '../redis-lock/redis-lock.service';\nimport { SYSTEM_LOCK_BOXPHONE } from '../withdrawal/constants/lock';\n\n@Injectable()\nexport class SessionRefreshScheduler {\n  private readonly logger = new Logger('SessionRefreshScheduler');\n\n  constructor(\n    private readonly bankService: BankService,\n    private readonly deviceService: DeviceService,\n    private readonly sessionManagement: SessionManagementService,\n    private readonly redisLockService: RedisLockService,\n  ) {}\n\n  /**\n   * Check and refresh sessions every 30 seconds\n   */\n  @Cron('*/15 * * * * *') // every 15 seconds\n  async refreshSessions() {\n    try {\n\n      const isNeedRestartBoxphone = await this.redisLockService.getLock(SYSTEM_LOCK_BOXPHONE);\n\n      if (isNeedRestartBoxphone) {\n        return;\n      }\n\n      const serviceStatus = await this.deviceService.getServiceStatus();\n      if (serviceStatus !== 'active') {\n        return; // Skip if service is not active\n      }\n\n      const devices = await this.deviceService.listDevices();\n      const activeDevices = devices.filter(device => device.status === 'active' && device.bankCode);\n\n      for (const device of activeDevices) {\n        const bankCode = device.bankCode.toUpperCase();\n        \n        try {\n          await this.bankService.refreshSessionIfNeeded(device.udid, bankCode);\n        } catch (error) {\n          this.logger.error(\n            `Error refreshing session for device ${device.udid}, bank ${bankCode}: ${error.message}`\n          );\n        }\n      }\n    } catch (error) {\n      this.logger.error(`Error in session refresh scheduler: ${error.message}`);\n    }\n  }\n}\n\n","import { Module } from '@nestjs/common';\nimport { OCRWorkerPoolService } from './services/ocr-worker-pool.service';\nimport { ImagePreprocessingService } from './services/image-preprocessing.service';\nimport { OCRService } from './services/ocr.service';\nimport { ColorDetectionService } from './services/color-detection.service';\n\n@Module({\n  providers: [\n    OCRWorkerPoolService,\n    ImagePreprocessingService,\n    OCRService,\n    ColorDetectionService,\n  ],\n  exports: [\n    OCRService,\n    OCRWorkerPoolService, // Export for pool stats monitoring\n    ImagePreprocessingService, // Export for advanced use cases\n    ColorDetectionService, // Export for color detection (e.g. waitForBlueButton)\n  ],\n})\nexport class OCRModule { }\n\n","import { Global, Module } from '@nestjs/common';\nimport { NotificationService } from './notification.service';\nimport { EzpayBeClientService } from './ezpay-be-client.service';\nimport { HttpModule } from '@nestjs/axios';\nimport { TelegramService } from './telegram.service';\n\n@Global()\n@Module({\n  imports: [\n    HttpModule,\n  ],\n  providers: [\n    NotificationService,\n    EzpayBeClientService,\n    TelegramService\n  ],\n  exports: [\n    NotificationService,\n    TelegramService\n  ],\n})\nexport class NotificationModule { }\n\n","import { Module } from '@nestjs/common';\nimport { WindowsAppGitBashService } from './window-app.service';\n\n@Module({\n  providers: [\n    WindowsAppGitBashService\n  ],\n  exports: [WindowsAppGitBashService],\n})\nexport class WindowAppModule {}\n\n","import { config } from '@/common/constants/config';\nimport { formatCurrency } from '@/common/utils/currency';\nimport { HttpService } from '@nestjs/axios';\nimport { Inject, Injectable, Logger, forwardRef } from '@nestjs/common';\nimport { firstValueFrom } from 'rxjs';\nimport { InternalTransfer } from '../../common/interfaces/withdrawal.interface';\nimport { RedisService } from '../../common/services/redis.service';\nimport { BankService } from '../bank/bank.service';\nimport { DeviceService } from '../device/device.service';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { NotificationService } from '../notifiction/notification.service';\nimport { WithdrawalStatus } from './constants/withdrawal-status';\nimport { ErrorType, WithdrawalProcessingError } from './withdrawal-errors';\n\n@Injectable()\nexport class InternalTransferService {\n  private readonly logger = new Logger('InternalTransferService');\n  private readonly REDIS_PROCESSED_PREFIX = 'internal-transfer:processed:';\n  private readonly PROCESSING_TTL = 86400 * 1000 * 3; // 3 days in milliseconds\n  private readonly COMPLETED_TTL = 86400 * 1000 * 3; // 3 days in milliseconds\n\n  constructor(\n    private readonly bankService: BankService,\n    @Inject(forwardRef(() => DeviceService))\n    private readonly deviceService: DeviceService,\n    private readonly redisService: RedisService,\n    private readonly notificationService: NotificationService,\n    private readonly httpService: HttpService\n  ) { }\n\n  /**\n   * Check if withdrawal was already processed\n   */\n  private async checkIfProcessed(internalTransferId: string): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${internalTransferId}`;\n      const status = await this.redisService.get(key);\n\n      if (status === 'completed') {\n        this.logger.warn(`Internal transfer ${internalTransferId} already completed`);\n        return true;\n      }\n\n      if (status === 'processing') {\n        this.logger.warn(`Internal transfer ${internalTransferId} is being processed by another instance`);\n        return true;\n      }\n\n      return false;\n    } catch (error) {\n      this.logger.error(`Error checking processed status for ${internalTransferId}: ${error.message}`);\n      // If Redis check fails, allow processing (fail open)\n      return false;\n    }\n  }\n\n  /**\n   * Mark withdrawal as processing (atomic operation using SETNX)\n   */\n  private async markAsProcessing(internalTransferId: string): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${internalTransferId}`;\n      // Use SETNX (SET if Not eXists) - atomic operation\n      // This ensures only one instance can mark as processing\n      const result = await this.redisService.setnx(key, 'processing', this.PROCESSING_TTL);\n\n      if (result === 'OK') {\n        this.logger.debug(`Marked internal transfer ${internalTransferId} as processing`);\n        return true;\n      }\n\n      // Key already exists - another instance is processing\n      this.logger.warn(`Internal transfer ${internalTransferId} is already being processed by another instance`);\n\n      return false;\n    } catch (error) {\n      this.logger.error(`Error marking internal transfer ${internalTransferId} as processing: ${error.message}`);\n      // If Redis fails, allow processing (fail open)\n      return true;\n    }\n  }\n\n  /**\n   * Mark withdrawal as completed\n   */\n  private async markAsCompleted(internalTransferId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${internalTransferId}`;\n      await this.redisService.set(key, 'completed', this.COMPLETED_TTL);\n      this.logger.log(`Marked internal transfer ${internalTransferId} as completed`);\n    } catch (error) {\n      this.logger.error(`Error marking internal transfer ${internalTransferId} as completed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Mark withdrawal as failed (remove from Redis to allow manual retry)\n   */\n  private async markAsFailed(internalTransferId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${internalTransferId}`;\n      await this.redisService.del(key);\n      this.logger.log(`Marked internal transfer ${internalTransferId} as failed (removed from processed list)`);\n    } catch (error) {\n      this.logger.error(`Error marking internal transfer ${internalTransferId} as failed: ${error.message}`);\n    }\n  }\n\n  async processInternalTransfer(internalTransfer: InternalTransfer, deviceConfig: DeviceConfig) {\n    const { withdrawalId, bankCode, amount } = internalTransfer;\n\n    // 1. IDEMPOTENCY CHECK - m bo withdrawal cha c x l\n    const isProcessed = await this.checkIfProcessed(withdrawalId);\n    if (isProcessed) {\n      this.logger.warn(`Withdrawal ${withdrawalId} already processed or being processed, skipping`);\n\n      return;\n    }\n\n    // 2. Mark as processing (atomic operation)\n    const markAsProcessing = await this.markAsProcessing(withdrawalId);\n    if (!markAsProcessing) {\n      const reason = `Withdrawal ${withdrawalId} is being processed by another instance`;\n      this.logger.warn(reason);\n      // Throw error vi type TEMPORARY v c th retry sau khi instance khc xong\n      throw new WithdrawalProcessingError(\n        reason, \n        ErrorType.TEMPORARY,\n        'Failed: Mark as processing'\n      );\n    }\n\n    try {\n      this.logger.log(`[${deviceConfig.accountName}] Processing withdrawal: ${withdrawalId} for bank: ${bankCode}, amount: ${amount}`);\n\n      await this.bankService.executeTransferWithQRCode(internalTransfer, deviceConfig, deviceConfig.bankCode);\n\n      this.deviceService.deductDeviceAmount(deviceConfig.deviceId, amount).catch(() => {});\n\n      this.deviceService.increaseDeviceAmount(internalTransfer.beneficiaryBankDeviceId, amount).catch(() => {});\n\n      const analysisResult = await this.bankService.analyzeTransferBill(deviceConfig.bankCode, internalTransfer);\n\n      this.notificationService.completeInternalTransfer(internalTransfer, analysisResult).catch(() => {});\n\n      if (analysisResult.analyzedStatus === 'unknown') {\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n      } else {\n        await this.bankService.goToHomeScreenFromBill(deviceConfig);\n      }\n\n      await this.markAsCompleted(withdrawalId);\n\n      this.logger.log(`Successfully processed withdrawal: ${withdrawalId}`);\n    } catch (error) {\n      await this.markAsFailed(withdrawalId);\n      \n      throw error;\n    }\n  }\n\n  async getInternalTransferDetails(id: string) {\n    const url = `${config.ezpayBe.apiUrl}/api/internal/internal-transfers/${id}`;\n\n    const response = await firstValueFrom(\n      this.httpService.get<{\n        data: { \n          status: WithdrawalStatus; \n          withdrawalId: string; \n          withdrawalCode: string,\n          cryptoExchangeId: string;\n          bankCode: string;\n          beneficiaryAccountNo: string;\n          beneficiaryName: string;\n          amount: string;\n          /* ... add more field if needed, the api will return more */\n        }\n      }>(url, {\n        headers: {\n          'Content-Type': 'application/json',\n          'X-API-Key': config.ezpayBe.apiKey,\n          'x-internal-secret-key': config.ezpayBe.apiKey,\n        },\n        timeout: 20000,\n      }),\n    );\n\n    return response.data.data;\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { Cron, CronExpression } from '@nestjs/schedule';\nimport { Job, Queue } from 'bull';\nimport { DeviceService } from '../device/device.service';\nimport { DeviceLockService } from '../device/device-lock.service';\nimport { InternalTransfer } from '../../common/interfaces/withdrawal.interface';\nimport { WithdrawalProcessingError, ErrorType } from './withdrawal-errors';\nimport { cloneDeep } from 'lodash';\nimport { withCronLock } from '@/common/redis/cron-lock';\nimport { BankService } from '../bank/bank.service';\nimport { TelegramService } from '../notifiction/telegram.service';\nimport { sleep } from '@/common/utils/time';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { validateObjectResult } from '@/common/utils/object-validation';\nimport { RedisService } from '@/common/services/redis.service';\nimport { DELAY_RETRY_JOB, JOB_PRIORITY_KEY_INTERNAL_JOB, JOB_PROCESS_NAME_INTERNAL_JOB } from './constants/job';\nimport { WithdrawalStatus } from './constants/withdrawal-status';\nimport { formatCurrency } from '@/common/utils/currency';\nimport { PandaManagerService } from '@/common/modules/websocket/panda-manager.service';\nimport { bullQueueNames } from './constants/queue';\nimport { InjectQueue } from '@nestjs/bull';\nimport { InternalTransferService } from './internal-transfer.service';\nimport { EzpayBeClientService } from '../notifiction/ezpay-be-client.service';\n\n@Injectable()\nexport class InternalTransferJobManagerService {\n  private readonly logger = new Logger('InternalTransferJobManagerService');\n  private processingJobs: Set<number | string> = new Set();\n\n  constructor(\n    @InjectQueue(bullQueueNames.INTERNAL_TRANSFER)\n    private readonly internalTransferQueue: Queue<InternalTransfer>,\n    private readonly deviceService: DeviceService,\n    private readonly deviceLockService: DeviceLockService,\n    private readonly pandaManagerService: PandaManagerService,\n    private readonly bankService: BankService,\n    private readonly ezpayBeClient: EzpayBeClientService,\n    private readonly telegramService: TelegramService,\n    private readonly redisService: RedisService,\n    private readonly internalTransferService: InternalTransferService,\n  ) { }\n\n  /**\n   * Pick and process jobs from queue\n   * Strategy: Find N available devices -> Pick N jobs -> Assign strictly\n   */\n  async pickAndProcessJobs(): Promise<void> {\n    try {\n      // 1. Get Available Devices (Active + Unlocked)\n      const availableBankInDevices = await this.deviceService.getBankInAvailableDevices();\n\n      // Calculate capacity\n      const capacity = availableBankInDevices.length;\n\n      if (capacity <= 0) {\n        return;\n      }\n\n      // Get job with priority from bull queue\n      const waitingJobsWithScore = await this.redisService.pickFromZSet(JOB_PRIORITY_KEY_INTERNAL_JOB, capacity);\n\n      if (waitingJobsWithScore.length === 0) {\n        return;\n      }\n\n      // 3. Assign Job -> Device\n      // We iterate through picked jobs and assign to available devices index-by-index\n      for (let i = 0; i < waitingJobsWithScore.length; i++) {\n        const jobId = waitingJobsWithScore[i].jobId;\n        const job = await this.internalTransferQueue.getJob(jobId);\n        const device = availableBankInDevices[i]; // Guaranteed to exist because jobsToPick <= capacity\n        const deviceName = `${device.bankCode} - ${device.transferType} - ${device.accountName}`;\n\n        // Skip if already processing (safety check)\n        if (this.processingJobs.has(job.id)) {\n          continue;\n        }\n\n        // CRITICAL: Acquire lock immediately to prevent race condition\n        const operationId = `internal-transfer:${job.data.withdrawalId}:${device.deviceId}`;\n        const lockAcquired = await this.deviceLockService.acquireLock(\n          device.deviceId,\n          'internal-transfer',\n          operationId,\n          3.68 * 60 * 1000 // 3.68 minutes\n        );\n\n        if (!lockAcquired) {\n          this.logger.warn(`Device ${device.deviceId} was locked after assignment, skipping job ${job.id}`);\n          continue;\n        }\n\n        const internalTransfer = cloneDeep(job.data);\n        const jobValidated = await validateObjectResult(InternalTransfer, internalTransfer);\n\n        if (!jobValidated.ok) {\n          this.logger.error(`Invalid Internal Transfer: missing ${jobValidated.errors.map(error => error.property).join(', ')}`);\n\n          this.ezpayBeClient\n            .updateInternalTransfer(internalTransfer._id, {\n              status: WithdrawalStatus.FAILED\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating internal transfer status for ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          this.telegramService.sendMessage({\n            text: ` <b>Failed Internal Transfer. Retrying...</b>`\n              + `\\n${internalTransfer.withdrawalId}`\n              + `\\n${internalTransfer.withdrawalCode}`\n              + `\\nFailed: Thng tin job khng hp l`\n              + `\\n\\n<b>To:</b> ${internalTransfer.bankCode} - ${internalTransfer.beneficiaryAccountNo} - ${internalTransfer.beneficiaryName}`\n              + `\\n<b>Amount:</b>  ${formatCurrency(internalTransfer.amount)}`\n              + `\\n<b>Description:</b>  ${internalTransfer.description}`,\n            options: {\n              parseMode: 'HTML'\n            }\n          }).catch((error) => {\n            this.logger.error(`Error sending message for withdrawal ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n          });\n\n          await job.remove();\n\n          continue\n        }\n\n        this.logger.log(\n          `Found job ${internalTransfer.withdrawalId} is internal transfer job. `\n          + `Assigned to ${deviceName}`\n        );\n\n        this.processingJobs.add(job.id);\n        await job.remove();\n\n        // Lock acquired - process job\n        // Note: processInternalTransfer will release the lock in its finally block\n        this.processJob(internalTransfer, device)\n          .catch(error => {\n            this.logger.error(`Error processing job ${job.id}: ${error.message}`, error.stack);\n          })\n          .finally(() => {\n            // Safety: release lock if processJob fails before processInternalTransfer\n            this.deviceLockService.releaseLock(device.deviceId).catch(() => { });\n            this.processingJobs.delete(job.id);\n          });\n      }\n    } catch (error) {\n      this.logger.error(`Error picking jobs: ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Process a single job with assigned device\n   */\n  private async processJob(internalTransfer: InternalTransfer, deviceConfig: DeviceConfig): Promise<void> {\n    try {\n      const { _id, withdrawalId } = internalTransfer;\n      const internalTransferDetails = await this.internalTransferService.getInternalTransferDetails(_id);\n\n      if (![WithdrawalStatus.PENDING, WithdrawalStatus.RETRY].includes(internalTransferDetails.status)) {\n        this.logger.warn(`Internal transfer ${withdrawalId} (${internalTransferDetails.status}) is not pending or retry, skipping`);\n\n        throw new WithdrawalProcessingError(`Internal transfer not pending or retry, skipping (${internalTransferDetails.status})`, ErrorType.PERMANENT);\n      }\n\n      if (internalTransferDetails.status === WithdrawalStatus.RETRY) {\n        this.telegramService.sendMessage({\n          text: ` <b>Retrying Internal Transfer...</b>`\n            + `\\n${internalTransfer.withdrawalId} - ${internalTransfer.withdrawalCode}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${internalTransfer.bankCode} - ${internalTransfer.beneficiaryAccountNo} - ${internalTransfer.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(internalTransfer.amount)}`\n            + `\\n<b>Description:</b>  ${internalTransfer.description}`,\n          options: {\n            parseMode: 'HTML'\n          }\n        }).catch((error) => {\n          this.logger.error(`Error sending message for internal transfer ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n        });\n      }\n\n      this.ezpayBeClient\n        .updateInternalTransfer(_id, {\n          status: WithdrawalStatus.PROCESSING,\n        })\n        .catch((error) => {\n          this.logger.error(`Error updating internal transfer status for ${withdrawalId}: ${error.message}`, error.stack);\n        });\n\n      await this.bankService.createQRCodeAndTransferTo(deviceConfig.bankCode, deviceConfig.deviceId, internalTransfer);\n      await this.bankService.createBillFolder(deviceConfig.bankCode, internalTransfer.withdrawalCode);\n      await this.internalTransferService.processInternalTransfer(internalTransfer, deviceConfig);\n    } catch (error) {\n      // Extract error type t error nu c\n      let errorType: ErrorType;\n      let errorContext: string;\n\n      if (error instanceof WithdrawalProcessingError) {\n        errorType = error.errorType;\n        errorContext = error.context;\n        this.logger.error(`Controlled Error ${internalTransfer.withdrawalId}: ${errorType}-${error.message}`, error.stack);\n\n        await this.handleJobFailure(deviceConfig, internalTransfer, error.message, errorType, errorContext);\n      } else {\n        this.logger.error(`Uncontrolled Error ${internalTransfer.withdrawalId}: ${errorType}-${error.message}`, error.stack);\n\n        await this.bankService.createBillFolder(deviceConfig.bankCode, internalTransfer.withdrawalCode);\n        await sleep(1000);\n        await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, internalTransfer.withdrawalCode);\n        const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, internalTransfer.withdrawalCode);\n\n        if (billImagePath) {\n          this.logger.log(`Uploading receipt for internal transfer ${internalTransfer.withdrawalCode} - ${billImagePath}`);\n\n          await this.ezpayBeClient.uploadInternalTransferReceipt(internalTransfer._id, billImagePath);\n        }\n\n        await this.ezpayBeClient.updateInternalTransfer(internalTransfer._id, {\n          status: WithdrawalStatus.UNKNOWN\n        });\n\n        this.telegramService.sendMessage({\n          text: ` <b>Failed Internal Transfer.</b>`\n            + `\\n${internalTransfer.withdrawalId}`\n            + `\\n${internalTransfer.withdrawalCode}`\n            + `\\n${error.message}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${internalTransfer.bankCode} - ${internalTransfer.beneficiaryAccountNo} - ${internalTransfer.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(internalTransfer.amount)}`\n            + `\\n<b>Description:</b>  ${internalTransfer.description}`,\n          options: {\n            parseMode: 'HTML'\n          }\n        }).catch((error) => {\n          this.logger.error(`Error sending message for withdrawal ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n        });\n\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n      }\n    }\n  }\n\n  /**\n   * Handle Job Failure: Retry logic with error type classification\n   */\n  private async handleJobFailure(\n    deviceConfig: DeviceConfig,\n    internalTransfer: InternalTransfer,\n    reason: string,\n    errorType: ErrorType = ErrorType.PERMANENT,\n    errorContext: string = ''\n  ) {\n    const maxRetries = 2;\n    const currentRetries = internalTransfer.manualRetryCount ?? 1;\n\n    switch (errorType) {\n      case ErrorType.PERMANENT:\n        this.ezpayBeClient\n          .updateInternalTransfer(internalTransfer._id, {\n            status: WithdrawalStatus.FAILED\n          })\n          .catch((error) => {\n            this.logger.error(`Error updating withdrawal status for ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n          });\n\n        this.telegramService.sendMessage({\n          text: ` <b>Failed Internal Transfer. Retrying...</b>`\n            + `\\n${internalTransfer.withdrawalId}`\n            + `\\n${internalTransfer.withdrawalCode}`\n            + `\\n${errorContext}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${internalTransfer.bankCode} - ${internalTransfer.beneficiaryAccountNo} - ${internalTransfer.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(internalTransfer.amount)}`\n            + `\\n<b>Description:</b>  ${internalTransfer.description}`,\n          options: {\n            parseMode: 'HTML'\n          }\n        }).catch((error) => {\n          this.logger.error(`Error sending message for withdrawal ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n        });\n\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n\n        return;\n\n      case ErrorType.FORCE_LOGIN_NO_REQUEUE:\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n\n        return;\n\n      case ErrorType.NO_BILL_AFTER_OTP:\n        await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, internalTransfer.withdrawalCode);\n        const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, internalTransfer.withdrawalCode);\n\n        if (billImagePath) {\n          this.logger.log(`Uploading receipt for internal transfer ${internalTransfer.withdrawalCode} - ${billImagePath}`);\n\n          await this.ezpayBeClient.uploadInternalTransferReceipt(internalTransfer._id, billImagePath);\n        }\n\n        await this.ezpayBeClient.updateInternalTransfer(internalTransfer._id, {\n          status: WithdrawalStatus.UNKNOWN\n        });\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n\n        return;\n\n      case ErrorType.FORCE_LOGIN_AND_REQUEUE: // Force Login s cho retry nn khng cn break\n        this.logger.warn(\n          `Added ${internalTransfer.withdrawalId} to queue for retrying. (${currentRetries}/${maxRetries})` +\n          `Reason: ${reason}. ` +\n          `Error Type: ${errorType}.`\n        );\n\n        if (currentRetries < maxRetries) {\n\n          await this.internalTransferQueue.add(\n            JOB_PROCESS_NAME_INTERNAL_JOB,\n            {\n              ...internalTransfer,\n              manualRetryCount: currentRetries + 1,\n              lastErrorType: errorType,\n              lastErrorReason: reason\n            },\n            {\n              jobId: `int-${internalTransfer.withdrawalId}`,\n              priority: 1,\n              delay: DELAY_RETRY_JOB,\n            }\n          );\n\n          this.ezpayBeClient\n            .updateInternalTransfer(internalTransfer._id, {\n              status: WithdrawalStatus.RETRY\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, internalTransfer.withdrawalCode);\n          const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, internalTransfer.withdrawalCode);\n\n          const caption = ` <b>Failed Internal Transfer. Retrying...</b>`\n            + `\\n${internalTransfer.withdrawalId}`\n            + `\\n${internalTransfer.withdrawalCode}`\n            + `\\n${errorContext}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${internalTransfer.bankCode} - ${internalTransfer.beneficiaryAccountNo} - ${internalTransfer.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(internalTransfer.amount)}`\n            + `\\n<b>Description:</b>  ${internalTransfer.description}`;\n\n          await this.telegramService.sendPhotoByFile({\n            filePath: billImagePath,\n            options: {\n              parseMode: 'HTML',\n              caption\n            }\n          });\n        } else {\n          this.logger.warn(`Max retries (${maxRetries}) exceeded for internal transfer ${internalTransfer.withdrawalId}: ${errorType} error: ${reason}`);\n\n          this.ezpayBeClient\n            .updateInternalTransfer(internalTransfer._id, {\n              status: WithdrawalStatus.FAILED\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating internal transfer status for ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, internalTransfer.withdrawalCode);\n          const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, internalTransfer.withdrawalCode);\n\n          const caption = ` <b>Failed Internal Transfer. Max retries exceeded...</b>`\n            + `\\n${internalTransfer.withdrawalId}`\n            + `\\n${internalTransfer.withdrawalCode}`\n            + `\\n${errorContext}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${internalTransfer.bankCode} - ${internalTransfer.beneficiaryAccountNo} - ${internalTransfer.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(internalTransfer.amount)}`\n            + `\\n<b>Description:</b>  ${internalTransfer.description}`;\n\n          await this.telegramService.sendPhotoByFile({\n            filePath: billImagePath,\n            options: {\n              parseMode: 'HTML',\n              caption\n            }\n          });\n        }\n\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n        break;\n\n      case ErrorType.TEMPORARY:\n        this.logger.warn(\n          `Added ${internalTransfer.withdrawalId} to queue for retrying. (${currentRetries}/${maxRetries})` +\n          `Reason: ${reason}. ` +\n          `Error Type: ${errorType}.`\n        );\n\n        if (currentRetries < maxRetries) {\n\n          await this.internalTransferQueue.add(\n            JOB_PROCESS_NAME_INTERNAL_JOB,\n            {\n              ...internalTransfer,\n              manualRetryCount: currentRetries + 1,\n              lastErrorType: errorType,\n              lastErrorReason: reason\n            },\n            {\n              jobId: `int-${internalTransfer.withdrawalId}`,\n              priority: 1,\n              delay: DELAY_RETRY_JOB,\n            }\n          );\n\n          this.ezpayBeClient\n            .updateInternalTransfer(internalTransfer._id, {\n              status: WithdrawalStatus.RETRY\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          this.telegramService.sendMessage({\n            text: ` <b>Failed Internal Transfer. Retrying...</b>`\n              + `\\n${internalTransfer.withdrawalId}`\n              + `\\n${internalTransfer.withdrawalCode}`\n              + `\\n${errorContext}`\n              + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n              + `\\n<b>To:</b> ${internalTransfer.bankCode} - ${internalTransfer.beneficiaryAccountNo} - ${internalTransfer.beneficiaryName}`\n              + `\\n<b>Amount:</b>  ${formatCurrency(internalTransfer.amount)}`\n              + `\\n<b>Description:</b>  ${internalTransfer.description}`,\n            options: {\n              parseMode: 'HTML'\n            }\n          }).catch((error) => {\n            this.logger.error(`Error sending message for internal transfer ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n          });\n\n        } else {\n          this.logger.warn(`Max retries (${maxRetries}) exceeded for internal transfer ${internalTransfer.withdrawalId}: ${errorType} error: ${reason}`);\n\n          this.ezpayBeClient\n            .updateInternalTransfer(internalTransfer._id, {\n              status: WithdrawalStatus.FAILED\n            })\n            .catch((error) => {\n              this.logger.error(`Error updating internal transfer status for ${internalTransfer.withdrawalId}: ${error.message}`, error.stack);\n            });\n\n          await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, internalTransfer.withdrawalCode);\n          const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, internalTransfer.withdrawalCode);\n\n          const caption = ` <b>Failed Internal Transfer. Max retries exceeded...</b>`\n            + `\\n${internalTransfer.withdrawalId}`\n            + `\\n${internalTransfer.withdrawalCode}`\n            + `\\n${errorContext}`\n            + `\\n\\n<b>From:</b>  ${deviceConfig.bankCode} - ${deviceConfig.accountName}`\n            + `\\n<b>To:</b> ${internalTransfer.bankCode} - ${internalTransfer.beneficiaryAccountNo} - ${internalTransfer.beneficiaryName}`\n            + `\\n<b>Amount:</b>  ${formatCurrency(internalTransfer.amount)}`\n            + `\\n<b>Description:</b>  ${internalTransfer.description}`\n\n          await this.telegramService.sendPhotoByFile({\n            filePath: billImagePath,\n            options: {\n              parseMode: 'HTML',\n              caption\n            }\n          });\n        }\n        break;\n    }\n  }\n\n  private async promoteDelayedJobs() {\n    return withCronLock('cron:promote_delayed:internal-transfer', 5000, async () => {\n      const now = Date.now();\n      const BATCH = 100;\n\n      // Ly mt batch job  delayed\n      const delayedJobs: Job[] = await this.internalTransferQueue.getJobs(\n        ['delayed'],\n        0,\n        BATCH - 1,\n      );\n\n      if (!delayedJobs.length) return;\n\n      let promoted = 0;\n\n      for (const job of delayedJobs) {\n        const delayMs = typeof job.opts?.delay === 'number' ? job.opts.delay : 0;\n        const ts = typeof job.timestamp === 'number' ? job.timestamp : 0;\n\n        const dueAt = ts + delayMs;\n\n        // ch promote job n hn\n        if (dueAt <= now) {\n          try {\n            // Bull h tr job.promote()  chuyn delayed -> waiting\n            await job.promote();\n            promoted++;\n          } catch (e) {\n            this.logger.debug(`Promote skipped for job ${job.id}: ${String(e)}`);\n          }\n        }\n      }\n\n      if (promoted > 0) {\n        this.logger.log(`Promoted ${promoted} delayed jobs to waiting`);\n      }\n    });\n  }\n\n  /**\n   * Periodically check and pick jobs if there are available slots\n   * Runs every 5 seconds\n   */\n  @Cron(CronExpression.EVERY_5_SECONDS)\n  async periodicJobPicking() {\n    if (!this.pandaManagerService.isConnected()) {\n      this.logger.error(`Panda is not connected, cannot pick jobs`);\n\n      return;\n    }\n\n    // Check service status\n    const serviceStatus = await this.deviceService.getServiceStatus();\n    if (serviceStatus !== 'active') {\n      this.logger.debug(`Service is ${serviceStatus}, cannot pick jobs`);\n      return;\n    }\n\n    await this.pickAndProcessJobs();\n  }\n\n  /**\n   * Promote delayed jobs to waiting jobs\n   * Runs every 5 seconds\n   */\n  @Cron(CronExpression.EVERY_5_SECONDS)\n  async promoteDelayedJobsPeriodically() {\n    await this.promoteDelayedJobs();\n  }\n}\n","import { Global, Module } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { RedisLockService } from './redis-lock.service';\n\n@Global()\n@Module({\n  providers: [\n    RedisService,\n    RedisLockService,\n  ],\n  exports: [\n    RedisLockService\n  ],\n})\nexport class RedisLockModule {}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { NestFactory } from '@nestjs/core';\nimport { ValidationPipe, Logger } from '@nestjs/common';\nimport { NestExpressApplication } from '@nestjs/platform-express';\nimport { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nimport { join } from 'path';\nimport { AppModule } from './app.module';\nimport { config as configEnv } from '@/common/constants/config';\n\nasync function bootstrap() {\n  const app = await NestFactory.create<NestExpressApplication>(AppModule, {\n    // logger: process.env.NODE_ENV === 'production'\n    //   ? ['error', 'warn', 'log']\n    //   : ['error', 'warn', 'log', 'debug', 'verbose'],\n  });\n\n  const logger = new Logger('Bootstrap');\n\n  // Configure view engine (EJS)\n  // In development: src/views, in production: dist/views (after copying)\n  const viewsPath = process.env.NODE_ENV === 'production' \n    ? join(__dirname, 'views')\n    : join(process.cwd(), 'src', 'views');\n  app.setBaseViewsDir(viewsPath);\n  app.setViewEngine('ejs');\n  logger.log(`Views directory: ${viewsPath}`);\n\n  // Global validation pipe\n  app.useGlobalPipes(\n    new ValidationPipe({\n      transform: true,\n      whitelist: true,\n      forbidNonWhitelisted: true,\n    }),\n  );\n\n  // Swagger configuration\n  const config = new DocumentBuilder()\n    .setTitle('EzPay Auto API')\n    .setDescription('Automated withdrawal processing service with HC BOX integration')\n    .setVersion('1.0')\n    .addTag('bank', 'Bank operations')\n    .addTag('withdrawal', 'Withdrawal processing')\n    .addTag('device', 'Device management')\n    .addTag('hcbox', 'HC Box integration')\n    .build();\n  \n  const document = SwaggerModule.createDocument(app, config);\n  SwaggerModule.setup('docs', app, document);\n\n  const port = process.env.PORT || 3002;\n  logger.log(` Swagger documentation available at: http://localhost:${port}/docs`);\n  await app.listen(port);\n\n  logger.log(` EzPay Auto is running on: http://localhost:${port}`);\n  logger.log(` Withdrawal processing started by ${configEnv.boxType} box`);\n  logger.log(` Device management: http://localhost:${port}`);\n}\n\nbootstrap();\n\n"],"sourceRoot":"","file":"main.js"}