{"version":3,"sources":["webpack://ezpay-auto/external commonjs \"@nestjs/core\"","webpack://ezpay-auto/external commonjs \"@nestjs/common\"","webpack://ezpay-auto/external commonjs \"@nestjs/swagger\"","webpack://ezpay-auto/external node-commonjs \"path\"","webpack://ezpay-auto/./src/app.module.ts","webpack://ezpay-auto/external commonjs \"@nestjs/bull\"","webpack://ezpay-auto/external commonjs \"@nestjs/schedule\"","webpack://ezpay-auto/external commonjs \"@nestjs/axios\"","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.module.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.service.ts","webpack://ezpay-auto/./src/modules/bank/bank.service.ts","webpack://ezpay-auto/./src/modules/bank/acb.service.ts","webpack://ezpay-auto/./src/common/modules/websocket/constants/websocket.ts","webpack://ezpay-auto/./src/modules/device/device.service.ts","webpack://ezpay-auto/./src/common/services/redis.service.ts","webpack://ezpay-auto/external commonjs \"ioredis\"","webpack://ezpay-auto/./src/common/constants/config.ts","webpack://ezpay-auto/external commonjs \"dotenv\"","webpack://ezpay-auto/./src/modules/device/device-lock.service.ts","webpack://ezpay-auto/external node-commonjs \"crypto\"","webpack://ezpay-auto/external commonjs \"lodash\"","webpack://ezpay-auto/./src/modules/bank/base/base-bank.service.ts","webpack://ezpay-auto/./src/common/utils/time.ts","webpack://ezpay-auto/external node-commonjs \"fs\"","webpack://ezpay-auto/external node-commonjs \"fs/promises\"","webpack://ezpay-auto/./src/modules/ocr/services/ocr.service.ts","webpack://ezpay-auto/./src/modules/ocr/services/ocr-worker-pool.service.ts","webpack://ezpay-auto/external commonjs \"tesseract.js\"","webpack://ezpay-auto/./src/modules/ocr/services/image-preprocessing.service.ts","webpack://ezpay-auto/external commonjs \"sharp\"","webpack://ezpay-auto/./src/common/utils/string.ts","webpack://ezpay-auto/external commonjs \"qrcode\"","webpack://ezpay-auto/./src/modules/bank/constants/analyze-bill.ts","webpack://ezpay-auto/./src/modules/bank/constants/hd-roi.ts","webpack://ezpay-auto/./src/modules/bank/constants/pg-roi.ts","webpack://ezpay-auto/./src/modules/bank/constants/vcb-roi.ts","webpack://ezpay-auto/./src/common/constants/keyboard.ts","webpack://ezpay-auto/./src/modules/bank/constants/acbank.ts","webpack://ezpay-auto/./src/modules/bank/pg.service.ts","webpack://ezpay-auto/./src/modules/bank/constants/pgbank.ts","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal-errors.ts","webpack://ezpay-auto/./src/modules/bank/constants/bank-code.ts","webpack://ezpay-auto/./src/modules/notifiction/telegram.service.ts","webpack://ezpay-auto/external commonjs \"axios\"","webpack://ezpay-auto/external commonjs \"form-data\"","webpack://ezpay-auto/./src/modules/bank/hdbank.service.ts","webpack://ezpay-auto/./src/modules/bank/constants/hdbank.ts","webpack://ezpay-auto/./src/modules/bank/constants/pandaSwipType.ts","webpack://ezpay-auto/./src/modules/bank/vietcombank.service.ts","webpack://ezpay-auto/./src/modules/bank/constants/vietcombank.ts","webpack://ezpay-auto/./src/modules/bank/session-management.service.ts","webpack://ezpay-auto/./src/modules/notifiction/notification.service.ts","webpack://ezpay-auto/./src/modules/notifiction/ezpay-be-client.service.ts","webpack://ezpay-auto/external commonjs \"rxjs\"","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal-job-manager.service.ts","webpack://ezpay-auto/external commonjs \"bull\"","webpack://ezpay-auto/./src/common/interfaces/withdrawal.interface.ts","webpack://ezpay-auto/external commonjs \"class-validator\"","webpack://ezpay-auto/./src/common/redis/cron-lock.ts","webpack://ezpay-auto/./src/modules/withdrawal/constants/withdrawal-status.ts","webpack://ezpay-auto/./src/modules/window-app/window-app.service.ts","webpack://ezpay-auto/external node-commonjs \"child_process\"","webpack://ezpay-auto/external commonjs \"util\"","webpack://ezpay-auto/./src/modules/redis-lock/redis-lock.service.ts","webpack://ezpay-auto/./src/modules/withdrawal/constants/lock.ts","webpack://ezpay-auto/./src/common/utils/object-validation.ts","webpack://ezpay-auto/external commonjs \"class-transformer\"","webpack://ezpay-auto/./src/modules/withdrawal/withdrawal.controller.ts","webpack://ezpay-auto/./src/modules/hcbox/hcbox.module.ts","webpack://ezpay-auto/./src/modules/hcbox/hcbox.service.ts","webpack://ezpay-auto/./src/modules/device/device.module.ts","webpack://ezpay-auto/./src/modules/device/device.controller.ts","webpack://ezpay-auto/./src/modules/device/dto/device-config.dto.ts","webpack://ezpay-auto/./src/modules/bank/bank.module.ts","webpack://ezpay-auto/./src/modules/bank/bank.controller.ts","webpack://ezpay-auto/./src/common/modules/websocket/websocket.module.ts","webpack://ezpay-auto/./src/common/modules/websocket/hc-websocket.service.ts","webpack://ezpay-auto/external commonjs \"ws\"","webpack://ezpay-auto/./src/common/modules/websocket/panda-websocket.service.ts","webpack://ezpay-auto/./src/modules/bank/session-refresh.scheduler.ts","webpack://ezpay-auto/./src/modules/ocr/ocr.module.ts","webpack://ezpay-auto/./src/modules/notifiction/notification.module.ts","webpack://ezpay-auto/./src/modules/window-app/window-app.module.ts","webpack://ezpay-auto/./src/modules/redis-lock/redis-lock.module.ts","webpack://ezpay-auto/webpack/bootstrap","webpack://ezpay-auto/./src/main.ts"],"names":["module","require","AppModule","imports","redis","host","port","db","password","defaultJobOptions","removeOnComplete","removeOnFail","attempts","backoff","type","delay","providers","exports","WithdrawalModule","name","HcBoxModule","controllers","WithdrawalService","bankService","redisService","notificationService","httpService","wsService","deviceService","withdrawalId","key","this","status","error","message","withdrawal","assignedDeviceId","bankCode","amount","reason","deviceConfig","analysisResult","analyzedStatus","id","url","headers","timeout","Inject","BankService","acbService","pgService","hdBankService","vietcombankService","sessionManagement","deviceLock","telegramService","Map","service","Array","deviceId","force","lock","Error","operationId","Date","maxRetries","delayTime","devices","i","listDevices","deviceConfigs","activeDevices","device","activeDeviceConfigs","config","disconnectedDevices","messageBlocks","text","options","parseMode","loginPromises","Promise","session","needsRefresh","isValidSession","folderPath","pollInterval","startTime","attemptCount","files","validFiles","async","file","fullPath","s","mtime","size","statError","f","a","b","latestFile","elapsed","AcbService","BaseBankService","ocrService","super","x","y","xReturn","yReturn","console","Symbol","DeviceService","deviceLockService","pattern","keys","data","JSON","availableAmount","smartOTP","accountNo","accountName","dto","existing","hasExistingConfig","stringify","REDIS_DEVICE_CONFIG_SUFFIX","success","err","resolve","setTimeout","newAmount","availableDevices","udid","RedisService","enableReadyCheck","maxRetriesPerRequest","lazyConnect","redisClient","onModuleDestroy","value","ttl","client","ttlSeconds","Math","score","member","start","stop","min","max","limit","members","field","cursor","result","push","path","process","NODE_ENV","boxType","parseInt","ezpayBe","apiUrl","apiKey","ocr","poolSize","lang","rois","singleLine","crop","parseFloat","width","height","psm","charWhitelist","maxWidth","block","OCR_WHITELIST_BLOCK","full","spaceocr","datacenterPrimary","datacenterSecond","keyFree","DeviceLockService","lockType","lockedBy","metadataKey","lockId","lockMetadata","lockedAt","metadataStr","excludeType","additionalTtl","currentTtlSeconds","newTtlSeconds","ceil","logger","maxAttempts","folderCreated","folderCreationInProgress","recursive","BANK_CODE","transitionTime","log","expectedTexts","unexpectedTexts","roi","fieldType","preprocess","tempDir","roiInfo","cleanupFolder","cleanupError","mkdirError","tempScreenshotPath","beforeCaptureTime","now","latestMtime","pngFiles","filePath","fileStat","readdirError","allSearchTexts","ocrResult","customROI","hasExpectedTexts","hasUnexpectedTexts","ocrTime","roiStr","screenConfig","swipeOptions","attempt","folder","ROI","billImage","rawPath","grayscale","enhanceContrast","fileName","margin","ms","DEFAULT_ROI_CONFIG","OCRService","workerPoolService","imagePreprocessingService","imagePath","totalStartTime","timingBreakdown","decodeImage","ocrRecognize","postprocess","decodeStart","imageBuffer","roiConfig","preprocessStart","preprocessResult","ocrStart","postprocessStart","processedText","totalProcessingTime","confidence","processingTime","searchTexts","found","matchedTexts","normalizedText","searchText","includes","imageSource","totalTime","breakdown","OCRWorkerPoolService","isInitializing","isDestroyed","isAcquiring","onModuleInit","initPromises","length","_","index","warmupTime","stack","worker","Tesseract","m","inUse","lastUsed","initializationPromise","workerInfo","reject","p","pending","clearTimeout","isTemporary","hadCustomParams","params","Object","tessedit_pageseg_mode","tessedit_char_whitelist","total","w","waiting","terminatePromises","ImagePreprocessingService","image","sharp","metadata","originalWidth","originalHeight","cropX","cropY","cropWidth","cropHeight","finalCropX","finalCropY","finalCropWidth","finalCropHeight","processedImage","left","top","processedWidth","processedHeight","scaleFactor","kernel","withoutEnlargement","buffer","input","PGBANK","HDBANK","VIETCOMBANK","LAUNCH_APP","VERIFY_ACCOUNT_NUMBER","VERIFY_ACCOUNT_NAME","OTP_ENTER","TRANSACTION_VERIFY","TRANSACTION_SUCCESS","HOME_SCREEN","ALBUM_SCREEN","SWIPE_UP_SCREEN","TRANSACTION_CONFIRM","OTP_VERIFY","coordinatesObj","factor","HC_NUMPAD_LAYOUT","HC_COMMON_COORDINATES","KEYBOARD_SWITCH","SHIFT_KEY","RETURN_KEY","PANDA_COMMON_COORDINATES","PANDA_NUMPAD_LAYOUT","HC_ACB_UI_COORDINATES","LOGIN_BUTTON","LOGIN_BUTTON_API","PASSWORD_FIELD","PANDA_ACB_UI_COORDINATES","PgService","BUNDLE_ID","verifiedAccountName","withdrawalCode","amountText","isNaN","HC_PG_UI_COORDINATES","LOGIN_BTN","TRANSFER_BTN","TRANSFER_INTERNAL_BTN","TRANSFER_EXTERNAL_BTN","CLOSE_ALLOW_CONTACT_POPUP_BTN","ACCOUNT_NUMBER_INPUT","SELECT_BANK_BTN","SEARCH_BANK_BTN","INTERNAL_AMOUNT_INPUT","HIDE_NUMPAD_BTN","CONTINUE_TRANSFER_BTN","BANK_SEARCH_BTN","BANK_SEARCH_INPUT","EXTERNAL_AMOUNT_INPUT","BACK_TO_HOME","QR_CODE_BTN","IMAGE_LIBRARY_BTN","FIRST_IMAGE_BTN","SELECT_IMAGE_QR_CODE_BTN","HOME_ICON_HEADER","PANDA_PG_UI_COORDINATES","ErrorType","WithdrawalProcessingError","errorType","BankCodeWithdrawal","TelegramService","baseURL","chatId","parsedChatId","chat_id","parse_mode","disable_web_page_preview","disableWebPagePreview","disable_notification","disableNotification","reply_to_message_id","replyToMessageId","photoUrl","photo","caption","stream","form","String","filename","mimeType","contentType","base64","cleaned","Buffer","idx","payload","retry","res","desc","waitMs","maxBodyLength","Infinity","maxContentLength","code","retryLeft","msg","Boolean","HdBankService","verifiedAccount","HDBank","HC_HD_UI_COORDINATES","HOME_ICON","PANDA_HD_UI_COORDINATES","PandaSwipeTypeEnum","VietcombankService","HC_VCB_UI_COORDINATES","CONTINUE_OTP_VERIFY_BTN","OTP_ENTER_TRANSFER_BTN","PANDA_VCB_UI_COORDINATES","SessionManagementService","sessionTimeoutMs","refreshBeforeMs","expiresAt","loginTime","toUpperCase","refreshBeforeTime","NotificationService","ezpayBeClient","sourceAccountNo","sourceBankCode","sourceAccountName","receiptPath","EzpayBeClientService","response","axiosError","errorMessage","formdata","FormData","WithdrawalJobManagerService","withdrawalService","windowsAppGitBashService","redisLockService","withdrawalQueue","Set","isInitialized","isRestartingBoxphone","cronRestartBoxphoneEnabled","msToNextMinute","timeZone","processName","exePath","runAsAdmin","killAsAdmin","count","restartBoxphone","serviceStatus","capacity","jobsToPick","waitingJobs","job","validateJob","_id","withdrawalDetails","currentRetries","NO_BILL_AFTER_OTP","billImagePath","UNKNOWN","FORCE_LOGIN","manualRetryCount","lastErrorType","lastErrorReason","jobId","priority","delayedJobs","promoted","delayMs","e","delayed","active","completed","failed","processingJobs","queue","stats","getQueueStats","sampleWaitingJobs","opts","sampleDelayedJobs","periodicJobPicking","promoteDelayedJobsPeriodically","Withdrawal","ttlMs","fn","lockVal","lua","WithdrawalStatus","execAsync","WindowsAppGitBashService","startTarget","gracefulWaitMs","forceKillWaitMs","startDelayMs","base","errorMsg","psCommand","command","windowsHide","useAdmin","retryError","retryMsg","taskkillError","taskkillMsg","processBaseName","killCommand","stdout","output","timeoutMs","args","target","RedisLockService","DtoClass","instance","enableImplicitConversion","errors","whitelist","forbidNonWhitelisted","forbidUnknownValues","validationError","ok","WithdrawalController","jobManagerService","summary","description","HcBoxService","bankBundleId","TPBANK","TECHCOMBANK","duration","DeviceModule","DeviceController","banks","existingConfig","Get","UpdateDeviceConfigDto","o","IsString","IsNumber","IsOptional","BankModule","BankController","quality","qualityValue","captureName","base64Image","imageLength","xCoord","yCoord","example","coordinates","endX","endY","isPandaFormat","isHCFormat","pandaOptions","endXCoord","endYCoord","durationValue","end","number","digits","d","note","imaggePath","outputPath","required","WebSocketModule","Global","provide","useClass","HCWebSocketService","isConnected","isProcessingRequest","WebSocket","firstKey","firstHandler","request","setImmediate","requestId","timeoutId","originalResolve","originalReject","action","deviceIds","deviceIdsStr","comm","bundleId","content","char","currentMode","charLower","isUppercase","keyToLookup","keyCoords","requiredMode","digit","fileType","PandaWebSocketService","messageStr","deviceList","requestStr","savePath","SessionRefreshScheduler","OCRModule","NotificationModule","WindowAppModule","RedisLockModule","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","app","viewsPath","__dirname","transform","document"],"mappings":"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","sourcesContent":["module.exports = require(\"@nestjs/core\");","module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/swagger\");","module.exports = require(\"path\");","import { Module } from '@nestjs/common';\nimport { BullModule } from '@nestjs/bull';\nimport { ScheduleModule } from '@nestjs/schedule';\nimport { HttpModule } from '@nestjs/axios';\n\nimport { WithdrawalModule } from './modules/withdrawal/withdrawal.module';\nimport { HcBoxModule } from './modules/hcbox/hcbox.module';\nimport { DeviceModule } from './modules/device/device.module';\nimport { RedisService } from './common/services/redis.service';\nimport { WebSocketModule } from './common/modules/websocket/websocket.module';\nimport { config } from './common/constants/config';\nimport { BankModule } from './modules/bank/bank.module';\nimport { OCRModule } from './modules/ocr/ocr.module';\nimport { NotificationModule } from './modules/notifiction/notification.module';\nimport { WindowAppModule } from './modules/window-app/window-app.module';\nimport { RedisLockModule } from './modules/redis-lock/redis-lock.module';\n\n@Module({\n  imports: [\n    BullModule.forRoot({\n      redis: {\n        host: config.redis.host,\n        port: config.redis.port,\n        db: config.redis.db,\n        password: config.redis.password,\n      },\n      defaultJobOptions: {\n        removeOnComplete: 10, // Keep last 10 completed jobs\n        removeOnFail: 50, // Keep last 50 failed jobs\n        attempts: 3, // Retry failed jobs 3 times\n        backoff: {\n          type: 'exponential',\n          delay: 2000, // 2 seconds initial delay\n        },\n      },\n    }),\n\n    // Scheduling\n    ScheduleModule.forRoot(),\n\n    // HTTP client\n    HttpModule,\n\n    // Feature modules\n    WithdrawalModule,\n    HcBoxModule,\n    DeviceModule,\n    WebSocketModule,\n    BankModule,\n    OCRModule,\n    NotificationModule,\n    RedisLockModule\n  ],\n  providers: [\n    RedisService,\n  ],\n  exports: [RedisService],\n})\nexport class AppModule {}\n\n","module.exports = require(\"@nestjs/bull\");","module.exports = require(\"@nestjs/schedule\");","module.exports = require(\"@nestjs/axios\");","import { Module, forwardRef } from '@nestjs/common';\nimport { BullModule } from '@nestjs/bull';\nimport { ScheduleModule } from '@nestjs/schedule';\nimport { WithdrawalService } from './withdrawal.service';\nimport { WithdrawalJobManagerService } from './withdrawal-job-manager.service';\nimport { WithdrawalController } from './withdrawal.controller';\nimport { EzpayBeClientService } from '../notifiction/ezpay-be-client.service';\nimport { RedisService } from '../../common/services/redis.service';\nimport { HcBoxModule } from '../hcbox/hcbox.module';\nimport { DeviceModule } from '../device/device.module';\nimport { BankModule } from '../bank/bank.module';\nimport { HttpModule } from '@nestjs/axios';\nimport { WindowAppModule } from '../window-app/window-app.module';\n\n@Module({\n  imports: [\n    BullModule.registerQueue({\n      name: 'wda-request', // Single queue - jobs c pick th cng\n    }),\n    ScheduleModule,\n    HcBoxModule,\n    forwardRef(() => DeviceModule),\n    BankModule,\n    HttpModule,\n    WindowAppModule\n  ],\n  controllers: [WithdrawalController],\n  providers: [\n    WithdrawalService,\n    WithdrawalJobManagerService,\n    EzpayBeClientService,\n    RedisService,\n  ],\n  exports: [WithdrawalService],\n})\nexport class WithdrawalModule {}\n\n","import { Injectable, Logger, Inject, forwardRef } from '@nestjs/common';\nimport { BankService } from '../bank/bank.service';\nimport { DeviceService } from '../device/device.service';\nimport { RedisService } from '../../common/services/redis.service';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WithdrawalProcessingError, ErrorType } from './withdrawal-errors';\nimport { NotificationService } from '../notifiction/notification.service';\nimport { firstValueFrom } from 'rxjs';\nimport { config } from '@/common/constants/config';\nimport { HttpService } from '@nestjs/axios';\nimport { WithdrawalStatus } from './constants/withdrawal-status';\n\n@Injectable()\nexport class WithdrawalService {\n  private readonly logger = new Logger('WithdrawalService');\n  private readonly REDIS_PROCESSED_PREFIX = 'withdrawal:processed:';\n  private readonly PROCESSING_TTL = 86400 * 1000 * 3; // 3 days in milliseconds\n  private readonly COMPLETED_TTL = 86400 * 1000 * 3; // 3 days in milliseconds\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    private readonly bankService: BankService,\n    @Inject(forwardRef(() => DeviceService))\n    private readonly deviceService: DeviceService,\n    private readonly redisService: RedisService,\n    private readonly notificationService: NotificationService,\n    private readonly httpService: HttpService\n  ) { }\n\n  /**\n   * Check if withdrawal was already processed\n   */\n  private async checkIfProcessed(withdrawalId: string): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      const status = await this.redisService.get(key);\n\n      if (status === 'completed') {\n        this.logger.warn(`Withdrawal ${withdrawalId} already completed`);\n        return true;\n      }\n\n      if (status === 'processing') {\n        this.logger.warn(`Withdrawal ${withdrawalId} is being processed by another instance`);\n        return true;\n      }\n\n      return false;\n    } catch (error) {\n      this.logger.error(`Error checking processed status for ${withdrawalId}: ${error.message}`);\n      // If Redis check fails, allow processing (fail open)\n      return false;\n    }\n  }\n\n  /**\n   * Mark withdrawal as processing (atomic operation using SETNX)\n   */\n  private async markAsProcessing(withdrawalId: string): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      // Use SETNX (SET if Not eXists) - atomic operation\n      // This ensures only one instance can mark as processing\n      const result = await this.redisService.setnx(key, 'processing', this.PROCESSING_TTL);\n\n      if (result === 'OK') {\n        this.logger.debug(`Marked withdrawal ${withdrawalId} as processing`);\n        return true;\n      }\n\n      // Key already exists - another instance is processing\n      this.logger.warn(`Withdrawal ${withdrawalId} is already being processed by another instance`);\n\n      return false;\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as processing: ${error.message}`);\n      // If Redis fails, allow processing (fail open)\n      return true;\n    }\n  }\n\n  /**\n   * Mark withdrawal as completed\n   */\n  private async markAsCompleted(withdrawalId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      await this.redisService.set(key, 'completed', this.COMPLETED_TTL);\n      this.logger.log(`Marked withdrawal ${withdrawalId} as completed`);\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as completed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Mark withdrawal as failed (remove from Redis to allow manual retry)\n   */\n  private async markAsFailed(withdrawalId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_PROCESSED_PREFIX}${withdrawalId}`;\n      await this.redisService.del(key);\n      this.logger.log(`Marked withdrawal ${withdrawalId} as failed (removed from processed list)`);\n    } catch (error) {\n      this.logger.error(`Error marking withdrawal ${withdrawalId} as failed: ${error.message}`);\n    }\n  }\n\n  async processWithdrawal(withdrawal: Withdrawal, assignedDeviceId: string) {\n    const { withdrawalId, bankCode, amount } = withdrawal;\n\n    // 1. IDEMPOTENCY CHECK - m bo withdrawal cha c x l\n    const isProcessed = await this.checkIfProcessed(withdrawalId);\n    if (isProcessed) {\n      this.logger.warn(`Withdrawal ${withdrawalId} already processed or being processed, skipping`);\n\n      return;\n    }\n\n    // 2. Mark as processing (atomic operation)\n    const markAsProcessing = await this.markAsProcessing(withdrawalId);\n    if (!markAsProcessing) {\n      const reason = `Withdrawal ${withdrawalId} is being processed by another instance`;\n      this.logger.warn(reason);\n      // Throw error vi type TEMPORARY v c th retry sau khi instance khc xong\n      throw new WithdrawalProcessingError(reason, ErrorType.TEMPORARY);\n    }\n\n    try {\n      this.logger.log(`[${assignedDeviceId}] Processing withdrawal: ${withdrawalId} for bank: ${bankCode}, amount: ${amount}`);\n\n      const deviceConfig = await this.deviceService.getDeviceConfig(assignedDeviceId);\n\n      // TODO: 1 Auto find available balance for device\n      // Verify available amount\n      if (deviceConfig.availableAmount < amount) {\n        const reason = `[${assignedDeviceId}] Assigned device has insufficient amount. Available: ${deviceConfig.availableAmount}, Required: ${amount}`;\n        this.logger.error(reason);\n        await this.markAsFailed(withdrawalId);\n      \n        await this.deviceService.updateDeviceConfig(assignedDeviceId, { status: 'deactive' });\n        \n        throw new WithdrawalProcessingError(reason, ErrorType.TEMPORARY);\n      }\n\n      await this.bankService.executeTransferWithQRCode(withdrawal, deviceConfig, deviceConfig.bankCode);\n\n      this.deviceService.deductDeviceAmount(assignedDeviceId, amount).catch(() => {});\n\n      const analysisResult = await this.bankService.analyzeTransferBill(deviceConfig.bankCode, withdrawal);\n\n      this.notificationService.completeWithdrawal(withdrawal, analysisResult, deviceConfig).catch(() => {});\n\n      if (analysisResult.analyzedStatus === 'unknown') {\n        await this.bankService.login(deviceConfig.bankCode, assignedDeviceId, true);\n      }\n\n      await this.markAsCompleted(withdrawalId);\n\n      this.logger.log(`Successfully processed withdrawal: ${withdrawalId}`);\n    } catch (error) {\n      await this.markAsFailed(withdrawalId);\n\n      if (error instanceof WithdrawalProcessingError) {\n        throw error;\n      }\n\n      //unknown error\n      throw new WithdrawalProcessingError(\n        error.message || 'Unknown error',\n        ErrorType.PERMANENT\n      );\n    }\n  }\n\n  async getWithdrawalDetails(id: string) {\n    const url = `${config.ezpayBe.apiUrl}/api/internal/withdrawals/${id}`;\n\n    const response = await firstValueFrom(\n      this.httpService.get<{\n        data: { \n          status: WithdrawalStatus; \n          withdrawalId: string; \n          withdrawalCode: string,\n          cryptoExchangeId: string;\n          bankCode: string;\n          beneficiaryAccountNo: string;\n          beneficiaryName: string;\n          amount: string;\n          /* ... add more field if needed, the api will return more */\n        }\n      }>(url, {\n        headers: {\n          'Content-Type': 'application/json',\n          'X-API-Key': config.ezpayBe.apiKey,\n          'x-internal-secret-key': config.ezpayBe.apiKey,\n        },\n        timeout: 20000,\n      }),\n    );\n\n    return response.data.data;\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { AcbService } from './acb.service';\nimport { PgService } from './pg.service';\nimport { HdBankService } from './hdbank.service';\nimport { VietcombankService } from './vietcombank.service';\nimport { DeviceService } from '../device/device.service';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { IBankService, IAnalyzeTransferBillResult } from './interfaces/bank-service.interface';\nimport { SessionManagementService } from './session-management.service';\nimport { DeviceLockService } from '../device/device-lock.service';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { TelegramService } from '../notifiction/telegram.service';\nimport { sleep } from '@/common/utils/time';\nimport { join } from 'path';\nimport { readdir, stat } from 'fs/promises';\nimport { existsSync } from 'fs';\n\n/**\n * Bank Service Factory\n * Routes to appropriate bank-specific service based on bankCode\n */\n@Injectable()\nexport class BankService {\n  private readonly logger = new Logger('BankService');\n  private readonly bankServices: Map<string, IBankService> = new Map();\n\n  constructor(\n    private readonly acbService: AcbService,\n    private readonly pgService: PgService,\n    private readonly hdBankService: HdBankService,\n    private readonly vietcombankService: VietcombankService,\n    private readonly deviceService: DeviceService,\n    private readonly sessionManagement: SessionManagementService,\n    private readonly deviceLock: DeviceLockService,\n    private readonly telegramService: TelegramService,\n  ) {\n    // Register all bank services\n    this.registerBankService(this.acbService);\n    this.registerBankService(this.pgService);\n    this.registerBankService(this.hdBankService);\n    this.registerBankService(this.vietcombankService);\n  }\n\n  /**\n   * Register a bank service\n   */\n  private registerBankService(service: IBankService): void {\n    const bankCode = service.getBankCode().toUpperCase();\n    this.bankServices.set(bankCode, service);\n    this.logger.log(`Registered bank service: ${bankCode}`);\n  }\n\n  /**\n   * Get bank service by bank code (public method for controller)\n   */\n  getBankService(bankCode: string): IBankService | null {\n    const service = this.bankServices.get(bankCode.toUpperCase());\n\n    if (!service) {\n      throw new WithdrawalProcessingError(\n        `Bank ${bankCode} not supported! Cannot find bank service out!`, \n        ErrorType.PERMANENT\n      );\n    }\n\n    return service;\n  }\n\n  /**\n   * Get all supported bank codes\n   */\n  getSupportedBanks(): string[] {\n    return Array.from(this.bankServices.keys());\n  }\n\n  /**\n   * Login to bank app on device (with locking)\n   */\n  async login(bankCode: string, deviceId: string, force: boolean = false): Promise<void> {\n\n    if(force) {\n      await this.deviceLock.releaseLock(deviceId);\n    }\n\n    // Check if device is already locked (any type)\n    const isLocked = await this.deviceLock.isLocked(deviceId);\n    if (isLocked) {\n      const lock = await this.deviceLock.getLock(deviceId);\n      throw new Error(\n        `Device ${deviceId} is currently locked by ${lock?.lockType} (${lock?.lockedBy}). Cannot login.`\n      );\n    }\n\n    // Acquire lock using unified format: operation:operationId\n    const operationId = `login:${bankCode}:${deviceId}:${Date.now()}`;\n    const lockAcquired = await this.deviceLock.acquireLock(\n      deviceId,\n      'login',\n      operationId,\n      4.5 * 60 * 1000 // 5 minutes for login process\n    );\n\n    if (!lockAcquired) {\n      throw new Error(`Failed to acquire lock for device ${deviceId}`);\n    }\n\n    try {\n      // Mark as logging in\n      await this.sessionManagement.markLoggingIn(deviceId, bankCode);\n\n      const service = this.getBankService(bankCode);\n      if (!service) {\n        throw new Error(`Bank service not found for bank code: ${bankCode}`);\n      }\n\n      this.logger.log(`[${deviceId}] Logging in to ${bankCode}`);\n      await service.login(deviceId);\n\n      // Record successful login\n      await this.sessionManagement.recordLogin(deviceId, bankCode);\n      \n      this.logger.log(`[${deviceId}] Successfully logged in to ${bankCode}`);\n    } catch (error) {\n      // Clear session on error\n      await this.sessionManagement.clearSession(deviceId, bankCode);\n      throw error;\n    } finally {\n      // Release login lock\n      await this.deviceLock.releaseLock(deviceId);\n    }\n  }\n\n  /**\n   * Login all active banks\n   */\n  async loginAllActiveBanks(): Promise<void> {\n    try {\n      const maxRetries = 6;\n      const delayTime = 10000;\n      let devices = [];\n\n      for (let i = 0; i < maxRetries; i++) {\n        this.logger.log(`[${i + 1}/${maxRetries}] Retrying to list devices on login...`);\n        devices = await this.deviceService.listDevices();\n        if (devices.length > 0) {\n          break;\n        }\n\n        await sleep(delayTime);\n      }\n\n      const deviceConfigs = await this.deviceService.listDeviceConfigs();\n      const activeDevices = devices.filter(device => device.status === 'active' && device.bankCode);\n      const activeDeviceConfigs = deviceConfigs.filter(config => config.status === 'active' && config.bankCode);\n\n      if (activeDevices.length < activeDeviceConfigs.length) {\n        const disconnectedDevices = activeDeviceConfigs.filter(config => !activeDevices.some(device => device.udid === config.deviceId));\n\n        const messageBlocks = disconnectedDevices.map(config => \n          `<b>Bank:</b> ${config.bankCode}\\n<b>Account:</b> ${config.accountName}`\n        ).join('\\n\\n');\n        \n        this.telegramService.sendMessage({\n          text: ` <b>Devices disconnected: ${disconnectedDevices.length}</b>\\n\\n${messageBlocks}`,\n          options: {\n            parseMode: 'HTML',\n          },\n        });\n      }\n\n      if (activeDevices.length === 0) {\n        this.logger.warn('No active devices found to login');\n        return;\n      }\n\n      // Release transfer locks for all active devices before login\n      for (const device of activeDevices) {\n        const deviceId = device.udid;\n        try {\n          await this.deviceLock.releaseLockByType(deviceId, 'transfer');\n        } catch (error) {\n          this.logger.warn(`Failed to release transfer lock for device ${deviceId}: ${error.message}`);\n        }\n      }\n\n      // Login all active devices\n      const loginPromises: Promise<void>[] = [];\n      for (const device of activeDevices) {\n        const bankCode = device.bankCode.toUpperCase();\n        const deviceId = device.udid;\n        loginPromises.push(\n          this.login(bankCode, deviceId, true).catch(error => {\n            this.logger.error(`Failed to login ${bankCode} on device ${deviceId}: ${error.message}`);\n          })\n        );\n      }\n\n      await Promise.allSettled(loginPromises);\n      this.logger.log(`Completed login process for all active banks`);\n    } catch (error) {\n      this.logger.error(`Error logging in all active banks: ${error.message}`);\n      throw error;\n    }\n  }\n\n  executeTransferWithQRCode(\n    withdrawal: Withdrawal, \n    deviceConfig: DeviceConfig, \n    bankCode: string,\n  ) {\n    const service = this.getBankService(bankCode);\n\n    return service.executeTransferWithQRCode(withdrawal, deviceConfig);\n  }\n\n  /**\n   * Check if session is valid for a device\n   */\n  async isSessionValid(deviceId: string, bankCode: string): Promise<boolean> {\n    return await this.sessionManagement.isSessionValid(deviceId, bankCode);\n  }\n\n  /**\n   * Analyze transfer bill and return image with analysis result\n   */\n  analyzeTransferBill(bankCode: string, withdrawal: Withdrawal): Promise<IAnalyzeTransferBillResult | null> {\n    const service = this.getBankService(bankCode);\n    \n    return service.analyzeTransferBill(bankCode, withdrawal);\n  }\n\n  /**\n   * Check and refresh session if needed\n   */\n  async refreshSessionIfNeeded(deviceId: string, bankCode: string): Promise<boolean> {\n    // Get session to check status\n    const session = await this.sessionManagement.getSession(deviceId, bankCode);\n    \n    // Skip if device is already logging in\n    if (session?.status === 'logging_in') {\n      return false;\n    }\n\n    // Check if session needs refresh (within refresh window) OR if session is expired/missing\n    const needsRefresh = await this.sessionManagement.needsRefresh(deviceId, bankCode);\n    const isValidSession = await this.sessionManagement.isSessionValid(deviceId, bankCode);\n    \n    // Only proceed if session needs refresh OR session is invalid (expired/missing)\n    if (!needsRefresh && isValidSession) {\n      return false;\n    }\n\n    // Check if device is locked\n    const isLocked = await this.deviceLock.isLocked(deviceId);\n    if (isLocked) {\n      this.logger.warn(`Cannot refresh session for device ${deviceId} - device is locked`);\n      return false;\n    }\n\n    try {\n      if (!isValidSession) {\n        this.logger.log(`Session expired or missing for device ${deviceId}, bank ${bankCode}. Retrying login...`);\n      } else {\n        this.logger.log(`Refreshing session for device ${deviceId}, bank ${bankCode}`);\n      }\n      await this.login(bankCode, deviceId);\n      return true;\n    } catch (error) {\n      this.logger.error(`Failed to refresh session for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n\n  createQRCodeAndTransferTo(bankCode: string, deviceId: string, withdrawal: Withdrawal): Promise<void> {\n    const service = this.getBankService(bankCode);\n\n    return service.createQRCodeAndTransferTo(deviceId, withdrawal);\n  }\n\n  captureScreen(bankCode: string, deviceId: string, folderPath: string): Promise<void> {\n    const service = this.getBankService(bankCode);\n    return service.captureScreen(deviceId, { folderPath });\n  }\n\n  getBillImagePath(bankCode: string, folderPath: string): Promise<string | null> {\n    const service = this.getBankService(bankCode);\n    return service.getBillImagePath(folderPath);\n  }\n\n  createBillFolder(bankCode: string, folderPath: string): Promise<void> {\n    const service = this.getBankService(bankCode);\n    return service.createBillFolder(folderPath);\n  }\n\n  /*\n  * Only for testing purpose\n  */\n  async testGetLatestImagePath(\n    folderPath: string,\n    timeout: number = 10000,\n    pollInterval: number = 500\n  ): Promise<string | null> {\n    if (!folderPath) {\n      this.logger.warn('Folder path is null or empty');\n      return null;\n    }\n\n    const startTime = Date.now();\n    let attemptCount = 0;\n\n    this.logger.debug(\n      `Scanning folder for bill image: ${folderPath}, timeout: ${timeout}ms, pollInterval: ${pollInterval}ms`\n    );\n\n    while (Date.now() - startTime < timeout) {\n      attemptCount++;\n\n      try {\n        // Kim tra th mc c tn ti khng\n        if (!existsSync(folderPath)) {\n          await sleep(pollInterval);\n          continue;\n        }\n\n        const files = await readdir(folderPath);\n\n        if (files.length === 0) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`No files found in folder: ${folderPath}, retrying... (attempt ${attemptCount})`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Ly thng tin tt c cc file\n        const filesWithStat = await Promise.all(\n          files.map(async file => {\n            try {\n              const fullPath = join(folderPath, file);\n              const s = await stat(fullPath);\n              return { fullPath, mtime: s.mtimeMs, size: s.size };\n            } catch (statError) {\n              // Skip files that can't be stat'd\n              return null;\n            }\n          })\n        );\n\n        // Lc cc file hp l (size > 0)\n        const validFiles = filesWithStat.filter(\n          (f): f is { fullPath: string; mtime: number; size: number } => \n            f !== null && f.size > 0\n        );\n\n        if (validFiles.length === 0) {\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Sp xp theo thi gian modified mi nht\n        validFiles.sort((a, b) => b.mtime - a.mtime);\n\n        const latestFile = validFiles[0].fullPath;\n        const elapsed = Date.now() - startTime;\n        this.logger.log(\n          `Found latest bill image: ${latestFile} after ${elapsed}ms (${attemptCount} attempts)`\n        );\n\n        return latestFile;\n      } catch (error) {\n        this.logger.debug(\n          `Error scanning folder ${folderPath} (attempt ${attemptCount}): ${error.message}, retrying...`\n        );\n        await sleep(pollInterval);\n      }\n    }\n\n    // Timeout - khng tm thy file\n    const elapsed = Date.now() - startTime;\n    this.logger.warn(\n      `Timeout scanning folder for bill image: ${folderPath} after ${elapsed}ms (${attemptCount} attempts)`\n    );\n    return null;\n  }\n}\n\n\n","import { Inject, Injectable } from '@nestjs/common';\nimport { WEBSOCKET_SERVICE } from '../../common/modules/websocket/constants/websocket';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\nimport { ICaptureScreenOptions, IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\nimport { COMMON_COORDINATES, KEYBOARD_LAYOUT } from '@/common/constants/keyboard';\nimport { ACB_UI_COORDINATES } from './constants/acbank';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\n\n@Injectable()\nexport class AcbService extends BaseBankService {\n  protected readonly BANK_CODE = 'ACB';\n  protected readonly BUNDLE_ID = 'mobileapp.acb.com.vn';\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n    ocrService: OCRService\n  ) {\n    super(wsService, deviceService, ocrService);\n  }\n\n  launchApp(deviceId: string): Promise<void> {\n    throw new Error('Method not implemented.');\n  }\n\n  /**\n   * Capture screen of device (override to add name parameter)\n   */\n  async captureScreen(deviceId: string, options: ICaptureScreenOptions): Promise<void> {\n    // Type assertion  s dng type c th trong implementation\n    const typedOptions = options as { quality: number; folderPath: string };\n    \n    // try {\n    //   this.logger.log(`Capturing screen on device ${deviceId} with quality ${typedOptions.quality}`);\n    //   const base64Image = await this.wsService.takeScreenShot(deviceId, { quality: typedOptions.quality, filePath: typedOptions.folderPath });\n    //   console.log(base64Image);\n    //   this.logger.log(`Screen captured successfully on device ${deviceId}`);\n    // } catch (error) {\n    //   this.logger.error(`Error capturing screen on device ${deviceId}: ${error.message}`);\n    //   throw error;\n    // }  \n  }\n\n  /**\n   * Click on password field \"Mt khu\"\n   */\n  async clickPasswordField(deviceId: string): Promise<void> {\n    try {\n      const { x, y } = ACB_UI_COORDINATES.PASSWORD_FIELD;\n      this.logger.log(`Clicking password field on device ${deviceId} at coordinates (${x}, ${y})`);\n      await this.clickWithTransition(deviceId, x, y, 0.2);\n      // Wait for keyboard to appear\n      await sleep(1000);\n      this.logger.log(`Password field clicked successfully on device ${deviceId}`);\n    } catch (error) {\n      this.logger.error(`Error clicking password field on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Input password from device config\n   */\n  async inputPasswordFromConfig(deviceId: string): Promise<void> {\n    try {\n      const config = await this.deviceService.getDeviceConfig(deviceId);\n      if (!config || !config.password) {\n        throw new Error(`Password not configured for device ${deviceId}`);\n      }\n\n      await this.wsService.inputText(deviceId, config.password);\n    } catch (error) {\n      this.logger.error(`Error inputting password from config for device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Click on login button \"NG NHP\"\n   */\n  async clickLoginButton(deviceId: string): Promise<void> {\n    try {\n      const { x, y } = ACB_UI_COORDINATES.LOGIN_BUTTON;\n      this.logger.log(`Clicking login button on device ${deviceId} at coordinates (${x}, ${y})`);\n      await this.wsService.click(deviceId, x, y, 0.2);\n      // Wait for screen transition\n      await sleep(5000);\n      this.logger.log(`Login button clicked successfully on device ${deviceId}`);\n    } catch (error) {\n      this.logger.error(`Error clicking login button on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async login(deviceId: string): Promise<void> {\n    try {\n      // Step 0: Kill app\n      await this.killApp(deviceId);\n      // Step 1: Launch app\n      await this.launchApp(deviceId);\n      // Step 2: Click on login button\n      const { x, y } = ACB_UI_COORDINATES.LOGIN_BUTTON;\n      this.logger.log(`Clicking login button on device ${deviceId} at coordinates (${x}, ${y})`);\n      await this.wsService.click(deviceId, x, y, 0.2);\n      await sleep(2000);\n\n      // Step 4: Input password\n      await this.inputPasswordFromConfig(deviceId);\n      await sleep(2000);\n\n      // Step 5: Click on return key\n      const { x: xReturn, y: yReturn } = COMMON_COORDINATES.RETURN_KEY;\n      this.logger.log(`Clicking return key on device ${deviceId} at coordinates (${xReturn}, ${yReturn})`);\n      await this.wsService.click(deviceId, xReturn, yReturn, 0.2);\n      await sleep(2000);\n\n      // Step 6: Click on login button\n      await this.wsService.click(deviceId, 0.5, 0.62, 0.2);\n      await sleep(5000);\n      // Close notification\n      await this.wsService.click(deviceId, 0.3, 0.55, 0.2);\n      await this.wsService.click(deviceId, 0.5, 0.65, 0.2);\n\n    } catch (error) {\n      this.logger.error(`Error logging in on device ${deviceId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Execute transfer for ACB bank\n   */\n  async executeTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    // try {\n    //   this.logger.log(`Executing ACB transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceId}`);\n\n    //   await this.wsService.click(deviceId, 0.5, 0.95, 0.2);\n    //   await this.wsService.click(deviceId, 0.3, 0.3, 0.2);\n    //   await this.wsService.click(deviceId, 0.5, 0.3, 0.2);\n    //   await this.wsService.click(deviceId, 0.5, 0.15, 0.2);\n\n\n\n\n    //   // TODO: Implement ACB-specific transfer flow\n    //   // Step 2: Navigate to transfer screen\n    //   // Step 3: Enter recipient account number\n    //   // Step 4: Enter amount\n    //   // Step 5: Enter description\n    //   // Step 6: Confirm transfer\n    //   // Step 7: Verify transfer success\n\n    //   this.logger.warn('ACB transfer flow is not fully implemented yet');\n    //   return true; // Placeholder\n    // } catch (error) {\n    //   this.logger.error(`Error executing ACB transfer for withdrawal ${withdrawal.withdrawalId}: ${error.message}`);\n    //   throw error;\n    // }\n  }\n\n  async executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    console.warn('ACB executeTransferWithQRCode');\n  }\n\n  async executeInternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    // Because ACB bank merge internal transfer and external transfer, we use external transfer instead\n    return this.executeExternalTransfer(withdrawal, deviceId);\n  }\n\n  async executeExternalTransfer(withdrawal: Withdrawal, deviceId: string): Promise<void> {\n    console.warn('ACB executeExternalTransfer');\n  }\n}\n\n","export const WEBSOCKET_SERVICE = Symbol('WEBSOCKET_SERVICE');","import { forwardRef, HttpException, HttpStatus, Inject, Injectable, Logger, OnModuleInit } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { DeviceConfig, UpdateDeviceConfigDto } from './dto/device-config.dto';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { DeviceLockService } from './device-lock.service'\nimport { BankService } from '../bank/bank.service';\nimport { isNil, omit } from 'lodash';\n\n@Injectable()\nexport class DeviceService implements OnModuleInit {\n  private readonly logger = new Logger('DeviceService');\n  private readonly REDIS_DEVICE_CONFIG_PREFIX = 'device:';\n  private readonly REDIS_DEVICE_CONFIG_SUFFIX = ':config';\n  private readonly REDIS_SERVICE_STATUS_KEY = 'service:status';\n\n  constructor(\n    private readonly redisService: RedisService,\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    private readonly deviceLockService: DeviceLockService,\n    @Inject(forwardRef(() => BankService))\n    private readonly bankService: BankService,\n  ) {}\n\n  async onModuleInit() {\n    // Always set service status to 'inactive' on server startup\n    try {\n      await this.setServiceStatus('inactive');\n      this.logger.log('Service status initialized to: inactive');\n    } catch (error) {\n      this.logger.error(`Failed to initialize service status: ${error.message}`);\n    }\n  }\n\n  async listDeviceConfigs(): Promise<DeviceConfig[]> {\n    try {\n      // Get all keys matching pattern device:*:config\n      const pattern = `${this.REDIS_DEVICE_CONFIG_PREFIX}*${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      const keys = await this.redisService.keys(pattern);\n      \n      if (keys.length === 0) {\n        return [];\n      }\n\n      // Get all configs in parallel\n      const configs = await Promise.all(\n        keys.map(async (key) => {\n          try {\n            const data = await this.redisService.get(key);\n            if (!data) {\n              return null;\n            }\n            return JSON.parse(data) as DeviceConfig;\n          } catch (error) {\n            this.logger.error(`Error parsing config for key ${key}: ${error.message}`);\n            return null;\n          }\n        }),\n      );\n\n      // Filter out null values and return\n      return configs.filter((config) => !isNil(config));\n    } catch (error) {\n      this.logger.error(`Error listing device configs: ${error.message}`);\n\n      return [];\n    }\n  }\n\n  async listDevices() {\n    try {\n      const devices = await this.wsService.listDevices();\n      \n      // Map bankCode and config from Redis for each device\n      // BankCode mapping is stored in Redis: device:{deviceId}:config\n      const devicesWithConfig = await Promise.all(\n        devices.map(async (device: any) => {\n          // Get saved config from Redis (includes bankCode mapping)\n          const config = await this.getDeviceConfig(device.udid);\n          \n            return {\n            ...device,\n            // Map bankCode from Redis config (persistent mapping)\n            bankCode: config?.bankCode || '',\n            availableAmount: config?.availableAmount || 0,\n            status: config?.status || 'deactive',\n            password: config?.password || '',\n            smartOTP: config?.smartOTP || '',\n            accountNo: config?.accountNo || '',\n            accountName: config?.accountName || '',\n          };\n        }),\n      );\n\n      return devicesWithConfig;\n    } catch (error) {\n      this.logger.error(`Error listing devices: ${error.message}`);\n      \n      return [];\n    }\n  }\n\n  async getDeviceConfig(deviceId: string): Promise<DeviceConfig | null> {\n    try {\n      const key = `${this.REDIS_DEVICE_CONFIG_PREFIX}${deviceId}${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      const data = await this.redisService.get(key);\n      \n      if (!data) {\n        return null;\n      }\n\n      return JSON.parse(data) as DeviceConfig;\n    } catch (error) {\n      this.logger.error(`Error getting device config for ${deviceId}: ${error.message}`);\n      return null;\n    }\n  }\n\n  async getDeviceConfigSafe(deviceId: string): Promise<DeviceConfig | null> {\n    try {\n      const config = await this.getDeviceConfig(deviceId);\n      if (!config) {\n        return null;\n      }\n\n      // Hide password and smartOTP from response\n      return {\n        ...config,\n        password: config.password ? '' : undefined,\n        smartOTP: config.smartOTP ? '' : undefined,\n      };\n    } catch (error) {\n      this.logger.error(`Error getting safe device config for ${deviceId}: ${error.message}`);\n      return null;\n    }\n  }\n\n  async updateDeviceConfig(deviceId: string, dto: UpdateDeviceConfigDto): Promise<DeviceConfig> {\n    try {\n      const key = `${this.REDIS_DEVICE_CONFIG_PREFIX}${deviceId}${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      \n      // Get existing config or create new\n      const existing = await this.getDeviceConfig(deviceId);\n      \n      // If device already has config, password and smartOTP cannot be updated\n      // Always keep existing password and smartOTP if config exists\n      const hasExistingConfig = existing?.password || existing?.smartOTP;\n      const password = hasExistingConfig \n        ? (existing?.password || '')\n        : (dto.password !== undefined ? dto.password : '');\n      const smartOTP = hasExistingConfig \n        ? (existing?.smartOTP || '')\n        : (dto.smartOTP !== undefined ? dto.smartOTP : '');\n      \n      const config: DeviceConfig = {\n        deviceId,\n        // BankCode mapping: save once, persist in Redis\n        bankCode: dto.bankCode !== undefined ? dto.bankCode : existing?.bankCode || '',\n        availableAmount: dto.availableAmount !== undefined ? dto.availableAmount : existing?.availableAmount || 0,\n        status: dto.status !== undefined ? dto.status : existing?.status || 'deactive',\n        password,\n        smartOTP,\n        accountNo: dto.accountNo !== undefined ? dto.accountNo : existing?.accountNo || '',\n        accountName: dto.accountName !== undefined ? dto.accountName : existing?.accountName || '',\n      };\n\n      // Save to Redis (no expiration - persistent config including bankCode mapping)\n      // Key format: device:{deviceId}:config\n      await this.redisService.set(key, JSON.stringify(config));\n\n      this.logger.log(`[${deviceId}] Updated device config (bankCode: ${config.bankCode || 'not set'}): ${JSON.stringify(omit(config, ['password', 'smartOTP']))}`);\n      return config;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error updating device config: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async deleteDeviceConfig(deviceId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_DEVICE_CONFIG_PREFIX}${deviceId}${this.REDIS_DEVICE_CONFIG_SUFFIX}`;\n      await this.redisService.del(key);\n\n      this.logger.log(`[${deviceId}] Deleted device config`);\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error deleting device config: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async getServiceStatus(): Promise<'active' | 'inactive'> {\n    try {\n      const status = await this.redisService.get(this.REDIS_SERVICE_STATUS_KEY);\n      return (status as 'active' | 'inactive') || 'inactive';\n    } catch (error) {\n      this.logger.error(`Error getting service status: ${error.message}`);\n      return 'inactive';\n    }\n  }\n\n  async setServiceStatus(status: 'active' | 'inactive'): Promise<void> {\n    try {\n      await this.redisService.set(this.REDIS_SERVICE_STATUS_KEY, status);\n      this.logger.log(`Service status set to: ${status}`);\n    } catch (error) {\n      this.logger.error(`Error setting service status: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async startService() {\n    try {\n      // Check if there is at least one device with status = 'active'\n      const hasActiveDevice = await this.hasActiveDevice();\n\n      if (!hasActiveDevice) {\n        throw new HttpException(\n          {\n            success: false,\n            error: 'Vui lng active bank trc khi start',\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      // Login all active banks (Non-blocking: don't await completion)\n      // This allows devices to start working individually as soon as they finish login\n      this.bankService.loginAllActiveBanks().catch(err => {\n        this.logger.error(`Error during background login process: ${err.message}`);\n      });\n\n      // Give a small buffer for logins to acquire locks before enabling service\n      await new Promise(resolve => setTimeout(resolve, 2000));\n\n      // Set service status to active\n      await this.setServiceStatus('active');\n\n      // Trigger job processing immediately\n      // (Optional: fetch JobManager and trigger? But cron will pick it up in <10s)\n\n      return {\n        success: true,\n        message: 'Service started successfully. Devices are logging in and will accept jobs when ready.',\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error starting service: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to start service',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  async deductDeviceAmount(deviceId: string, amount: number): Promise<boolean> {\n    try {\n      const config = await this.getDeviceConfig(deviceId);\n      if (!config) {\n        return false;\n      }\n\n      const newAmount = config.availableAmount - amount;\n      if (newAmount < 0) {\n        this.logger.warn(`Insufficient amount for device ${deviceId}. Available: ${config.availableAmount}, Requested: ${amount}`);\n        return false;\n      }\n\n      await this.updateDeviceConfig(deviceId, { availableAmount: newAmount });\n      return true;\n    } catch (error) {\n      this.logger.error(`Error deducting amount for device ${deviceId}: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Check if there is at least one device with status = 'active'\n   */\n  async hasActiveDevice(): Promise<boolean> {\n    try {\n      const devices = await this.listDevices();\n      return devices.some(device => device.status === 'active');\n    } catch (error) {\n      this.logger.error(`Error checking active devices: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Get list of available devices (Active AND Unlocked)\n   */\n  async getAvailableDevices() {\n    try {\n      const devices = await this.wsService.listDevices();\n      const availableDevices: Array<DeviceConfig> = [];\n\n      for (const device of devices) {\n        // 1. Check Config Status\n        const deviceConfig = await this.getDeviceConfig(device.udid);\n\n        if (deviceConfig?.status !== 'active') {\n          continue;\n        }\n\n        // 2. Check Lock Status (Must be free)\n        const isLocked = await this.deviceLockService.isLocked(device.udid);\n        if (isLocked) {\n          // this.logger.debug(`Device ${device.udid} is active but LOCKED. Skipping.`);\n          continue;\n        }\n\n        // 3. Check session of bank because cron for login run every 30 seconds but cron for pick job run every 5 seconds\n        const hasValidSession = await this.bankService.isSessionValid(device.udid, deviceConfig.bankCode);\n        if (!hasValidSession) {\n          this.logger.error(`[${device.udid}] Device does not have valid session for bank ${deviceConfig.bankCode}`);\n\n          continue;\n        }\n\n        availableDevices.push(deviceConfig);\n      }\n\n      return availableDevices;\n    } catch (error) {\n      this.logger.error(`Error getting available devices: ${error.message}`);\n      return [];\n    }\n  }\n}\n\n","import { Injectable, Logger, OnModuleDestroy } from '@nestjs/common';\nimport Redis from 'ioredis';\nimport { config } from '../constants/config';\n\n@Injectable()\nexport class RedisService implements OnModuleDestroy {\n  private readonly logger = new Logger('RedisService');\n  private redisClient: Redis | null = null;\n\n  constructor() {}\n\n  async getClient(): Promise<Redis> {\n    if (this.redisClient) {\n      return this.redisClient;\n    }\n\n    const host = config.redis.host ?? 'localhost';\n    const port = config.redis.port ?? 6379;\n    const password = config.redis.password ?? undefined;\n    const db = config.redis.db ?? 3;\n\n    this.redisClient = new Redis({\n      host,\n      port,\n      password,\n      db,\n      enableReadyCheck: false,\n      maxRetriesPerRequest: null,\n      lazyConnect: true,\n    });\n\n    this.redisClient.on('error', (err) => {\n      this.logger.error('Redis Client Error', err.stack || err.message);\n    });\n\n    this.redisClient.on('connect', () => {\n      this.logger.log('Redis Client Connected');\n    });\n\n    this.redisClient.on('ready', () => {\n      this.logger.log('Redis Client Ready');\n    });\n\n    this.redisClient.on('close', () => {\n      this.logger.warn('Redis Client Connection Closed');\n    });\n\n    this.redisClient.on('reconnecting', () => {\n      this.logger.log('Redis Client Reconnecting...');\n    });\n\n    await this.redisClient.connect();\n\n    return this.redisClient;\n  }\n\n  async disconnect(): Promise<void> {\n    if (this.redisClient) {\n      await this.redisClient.disconnect();\n      this.redisClient = null;\n      this.logger.log('Redis Client Disconnected');\n    }\n  }\n\n  async onModuleDestroy(): Promise<void> {\n    await this.disconnect();\n  }\n\n  // Basic operations\n  async get(key: string): Promise<string | null> {\n    const client = await this.getClient();\n    return client.get(key);\n  }\n\n  async set(key: string, value: string, ttl?: number): Promise<'OK'> {\n    const client = await this.getClient();\n    if (ttl) {\n      // Convert milliseconds to seconds for Redis SETEX\n      const ttlSeconds = Math.ceil(ttl / 1000);\n      return client.setex(key, ttlSeconds, value);\n    }\n    return client.set(key, value);\n  }\n\n  async setex(key: string, ttl: number, value: string): Promise<'OK'> {\n    const client = await this.getClient();\n    // Convert milliseconds to seconds for Redis SETEX\n    const ttlSeconds = Math.ceil(ttl / 1000);\n    return client.setex(key, ttlSeconds, value);\n  }\n\n  async del(key: string): Promise<number> {\n    const client = await this.getClient();\n    return client.del(key);\n  }\n\n  async exists(key: string): Promise<number> {\n    const client = await this.getClient();\n    return client.exists(key);\n  }\n\n  // Sorted Set operations\n  async zadd(key: string, score: number, member: string): Promise<number> {\n    const client = await this.getClient();\n    return client.zadd(key, score, member);\n  }\n\n  async zrange(key: string, start: number, stop: number): Promise<string[]> {\n    const client = await this.getClient();\n    return client.zrange(key, start, stop);\n  }\n\n  async zrangebyscore(key: string, min: number | string, max: number | string, limit?: { offset: number; count: number }): Promise<string[]> {\n    const client = await this.getClient();\n    if (limit) {\n      return client.zrangebyscore(key, min, max, 'LIMIT', limit.offset, limit.count);\n    }\n    return client.zrangebyscore(key, min, max);\n  }\n\n  async zrem(key: string, ...members: string[]): Promise<number> {\n    const client = await this.getClient();\n    return client.zrem(key, ...members);\n  }\n\n  // Set operations\n  async sadd(key: string, ...members: string[]): Promise<number> {\n    const client = await this.getClient();\n    return client.sadd(key, ...members);\n  }\n\n  async sismember(key: string, member: string): Promise<number> {\n    const client = await this.getClient();\n    return client.sismember(key, member);\n  }\n\n  // Hash operations\n  async hset(key: string, field: string, value: string): Promise<number> {\n    const client = await this.getClient();\n    return client.hset(key, field, value);\n  }\n\n  async hget(key: string, field: string): Promise<string | null> {\n    const client = await this.getClient();\n    return client.hget(key, field);\n  }\n\n  async hgetall(key: string): Promise<Record<string, string>> {\n    const client = await this.getClient();\n    return client.hgetall(key);\n  }\n\n  async expire(key: string, ttl: number): Promise<number> {\n    const client = await this.getClient();\n    return client.expire(key, ttl);\n  }\n\n  /**\n   * Get all keys matching a pattern using SCAN (safe for production)\n   * @param pattern - Redis key pattern (e.g., 'device:lock:*')\n   * @returns Array of matching keys\n   */\n  async keys(pattern: string): Promise<string[]> {\n    const client = await this.getClient();\n    const keys: string[] = [];\n    let cursor = '0';\n\n    do {\n      const result = await client.scan(cursor, 'MATCH', pattern, 'COUNT', 100);\n      cursor = result[0];\n      keys.push(...result[1]);\n    } while (cursor !== '0');\n\n    return keys;\n  }\n\n  /**\n   * Set key if not exists (atomic operation)\n   * Returns 'OK' if key was set, null if key already exists\n   */\n  async setnx(key: string, value: string, ttl?: number): Promise<string | null> {\n    const client = await this.getClient();\n    if (ttl) {\n      // Convert milliseconds to seconds for Redis SET with NX and EX\n      const ttlSeconds = Math.ceil(ttl / 1000);\n      const result = await client.set(key, value, 'EX', ttlSeconds, 'NX');\n      return result;\n    }\n    const result = await client.set(key, value, 'NX');\n    return result;\n  }\n}\n\n","module.exports = require(\"ioredis\");","import { config as dotenvConfig } from 'dotenv';\nimport { join } from 'path';\n\ndotenvConfig({ path: join(process.cwd(), '.env') });\n\nexport type NodeEnv = 'development' | 'production';\n\nexport interface IConfig {\n\tNODE_ENV: NodeEnv;\n\tboxType: 'HC' | 'PANDA';\n\tredis: {\n\t\thost: string;\n\t\tport: number;\n\t\tdb: number;\n\t\tpassword: string;\n\t};\n\tezpayBe: {\n\t\tapiUrl: string;\n\t\tapiKey: string;\n\t};\n\tocr: {\n\t\tpoolSize: number;\n\t\tlang: string;\n\t\trois: {\n\t\t\t[fieldType: string]: {\n\t\t\t\tcrop: {\n\t\t\t\t\tx: number; // ratio 0-1\n\t\t\t\t\ty: number; // ratio 0-1\n\t\t\t\t\twidth: number; // ratio 0-1\n\t\t\t\t\theight: number; // ratio 0-1\n\t\t\t\t};\n\t\t\t\tpsm: number; // Page Segmentation Mode\n\t\t\t\tcharWhitelist?: string;\n\t\t\t\tmaxWidth?: number; // Max width for downscale (pixels)\n\t\t\t};\n\t\t};\n\t};\n\tspaceocr: {\n\t\tdatacenterPrimary: string;\n\t\tdatacenterSecond: string;\n\t\tkey: string;\n\t\tkeyFree: string;\n\t};\n}\n\nexport const config: IConfig = {\n\tNODE_ENV: (process.env.NODE_ENV || 'production') as NodeEnv,\n\tboxType: 'PANDA',\n\tredis: {\n\t\thost: process.env.REDIS_HOST ?? '14.225.44.234',\n\t\tport: parseInt(process.env.REDIS_PORT ?? '6888'),\n\t\tdb: 3,\n\t\tpassword: process.env.REDIS_PWD ?? 'Dcsvnqvmn1',\n\t},\n\tezpayBe: {\n\t\tapiUrl: process.env.EZZPAY_BE ?? 'https://api-hn.botpro.world/payment',\n\t\tapiKey: process.env.EZZPAY_KEY ?? 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n\t},\n\tocr: {\n\t\tpoolSize: parseInt(process.env.OCR_POOL_SIZE || '4', 10),\n\t\tlang: process.env.OCR_LANG || 'vie', // eng+vie, vie\n\t\trois: {\n\t\t\t// Single line text (account numbers, amounts, etc.)\n\t\t\tsingleLine: {\n\t\t\t\tcrop: {\n\t\t\t\t\tx: parseFloat(process.env.OCR_ROI_SINGLE_X || '0'),\n\t\t\t\t\ty: parseFloat(process.env.OCR_ROI_SINGLE_Y || '0'),\n\t\t\t\t\twidth: parseFloat(process.env.OCR_ROI_SINGLE_WIDTH || '1'),\n\t\t\t\t\theight: parseFloat(process.env.OCR_ROI_SINGLE_HEIGHT || '1'),\n\t\t\t\t},\n\t\t\t\tpsm: parseInt(process.env.OCR_PSM_SINGLE || '7', 10), // Single line\n\t\t\t\tcharWhitelist: process.env.OCR_WHITELIST_SINGLE || '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz .-',\n\t\t\t\tmaxWidth: parseInt(process.env.OCR_MAX_WIDTH_SINGLE || '800', 10),\n\t\t\t},\n\t\t\t// Block text (paragraphs, multiple lines)\n\t\t\tblock: {\n\t\t\t\tcrop: {\n\t\t\t\t\tx: parseFloat(process.env.OCR_ROI_BLOCK_X || '0'),\n\t\t\t\t\ty: parseFloat(process.env.OCR_ROI_BLOCK_Y || '0'),\n\t\t\t\t\twidth: parseFloat(process.env.OCR_ROI_BLOCK_WIDTH || '1'),\n\t\t\t\t\theight: parseFloat(process.env.OCR_ROI_BLOCK_HEIGHT || '1'),\n\t\t\t\t},\n\t\t\t\tpsm: parseInt(process.env.OCR_PSM_BLOCK || '6', 10), // Uniform block\n\t\t\t\tcharWhitelist: process.env.OCR_WHITELIST_BLOCK || undefined,\n\t\t\t\tmaxWidth: parseInt(process.env.OCR_MAX_WIDTH_BLOCK || '1200', 10),\n\t\t\t},\n\t\t\t// Full screen (default)\n\t\t\tfull: {\n\t\t\t\tcrop: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\twidth: 1,\n\t\t\t\t\theight: 1,\n\t\t\t\t},\n\t\t\t\tpsm: parseInt(process.env.OCR_PSM_FULL || '6', 10),\n\t\t\t\tcharWhitelist: undefined,\n\t\t\t\tmaxWidth: parseInt(process.env.OCR_MAX_WIDTH_FULL || '1200', 10),\n\t\t\t},\n\t\t},\n\t},\n\tspaceocr: {\n\t\tdatacenterPrimary: 'https://apipro1.ocr.space/parse/image',\n\t\tdatacenterSecond: 'https://apipro2.ocr.space/parse/image',\n\t\tkey: 'G888CWKP2Y06X',\n\t\tkeyFree: 'K82766678488957',\n\t},\n}","module.exports = require(\"dotenv\");","import { Injectable, Logger } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { randomUUID } from 'crypto';\n\nexport type DeviceLockType = 'login' | 'transfer';\n\nexport interface DeviceLock {\n  deviceId: string;\n  lockType: DeviceLockType;\n  lockedAt: number;\n  lockedBy: string; // Unified format: 'operation:operationId' (e.g., 'login:ACB:deviceId:timestamp' or 'withdraw:withdrawalId:deviceId')\n  ttl: number; // TTL in milliseconds\n  lockId: string; // Unique lock ID for safe release\n}\n\n// Lua script for atomic unlock (only unlock if lockId matches)\nconst UNLOCK_SCRIPT = `\nif redis.call(\"GET\", KEYS[1]) == ARGV[1] then\n  redis.call(\"DEL\", KEYS[2])\n  return redis.call(\"DEL\", KEYS[1])\nelse\n  return 0\nend\n`;\n\n@Injectable()\nexport class DeviceLockService {\n  private readonly logger = new Logger('DeviceLockService');\n  private readonly REDIS_LOCK_PREFIX = 'device:lock:';\n  private readonly DEFAULT_LOCK_TTL = 10 * 60 * 1000; // 10 minutes default\n\n  constructor(private readonly redisService: RedisService) {}\n\n  /**\n   * Acquire lock for a device (atomic operation using SET NX EX)\n   */\n  async acquireLock(\n    deviceId: string,\n    lockType: DeviceLockType,\n    lockedBy: string,\n    ttl: number = this.DEFAULT_LOCK_TTL\n  ): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const lockId = randomUUID();\n      const ttlSeconds = Math.ceil(ttl / 1000);\n\n      // Use atomic SET NX EX to acquire lock\n      // This ensures only one process can acquire the lock\n      const client = await this.redisService.getClient();\n      const result = await client.set(key, lockId, 'EX', ttlSeconds, 'NX');\n\n      if (result === 'OK') {\n        // Lock acquired successfully, store metadata\n        const lockMetadata: Omit<DeviceLock, 'lockId'> = {\n          deviceId,\n          lockType,\n          lockedAt: Date.now(),\n          lockedBy,\n          ttl,\n        };\n        await this.redisService.setex(metadataKey, ttlSeconds, JSON.stringify(lockMetadata));\n        \n        this.logger.log(`[${deviceId}] Acquired ${lockType} lock (${lockedBy}) with lockId ${lockId}`);\n        return true;\n      }\n\n      // Lock already exists\n      this.logger.warn(\n        `[${deviceId}] Device is already locked, cannot acquire lock`\n      );\n      return false;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error acquiring lock: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Release lock for a device (atomic operation using Lua script)\n   */\n  async releaseLock(deviceId: string): Promise<void> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const client = await this.redisService.getClient();\n      \n      // Get current lockId before releasing\n      const lockId = await client.get(key);\n      \n      if (!lockId) {\n        // Lock doesn't exist, clean up metadata if exists\n        await this.redisService.del(metadataKey);\n        this.logger.debug(`[${deviceId}] Device is not locked, nothing to release`);\n        return;\n      }\n\n      // Use Lua script to atomically check and delete only if lockId matches\n      // This prevents releasing lock that was acquired by another process\n      const result = await client.eval(\n        UNLOCK_SCRIPT,\n        2, // number of keys\n        key, // KEYS[1] - lock key\n        metadataKey, // KEYS[2] - metadata key\n        lockId as string // ARGV[1] - lockId to verify\n      ) as number;\n\n      if (result === 1) {\n        this.logger.log(`[${deviceId}] Released lock (lockId: ${lockId})`);\n      } else {\n        // Lock was already released or changed by another process\n        this.logger.warn(`[${deviceId}] Lock was already released or changed (expected lockId: ${lockId})`);\n      }\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error releasing lock: ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Get current lock for a device\n   */\n  async getLock(deviceId: string): Promise<DeviceLock | null> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const lockId = await this.redisService.get(key);\n      \n      if (!lockId) {\n        return null;\n      }\n\n      // Get metadata\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const metadataStr = await this.redisService.get(metadataKey);\n      \n      if (!metadataStr) {\n        // Metadata missing but lock exists - return minimal info\n        return {\n          deviceId,\n          lockType: 'transfer', // default\n          lockedAt: Date.now(),\n          lockedBy: 'unknown',\n          ttl: this.DEFAULT_LOCK_TTL,\n          lockId,\n        };\n      }\n\n      const metadata = JSON.parse(metadataStr) as Omit<DeviceLock, 'lockId'>;\n      return {\n        ...metadata,\n        lockId,\n      };\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error getting lock: ${error.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Check if device is locked\n   */\n  async isLocked(deviceId: string, excludeType?: DeviceLockType): Promise<boolean> {\n    try {\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const exists = await this.redisService.exists(key);\n      \n      if (!exists) {\n        return false;\n      }\n\n      const lock = await this.getLock(deviceId);\n      if (!lock) {\n        return false;\n      }\n\n      // If excludeType is provided, allow if lock is of that type\n      if (excludeType && lock.lockType === excludeType) {\n        return false;\n      }\n\n      return true;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error checking lock status: ${error.message}`);\n      // On error, assume not locked (fail open)\n      return false;\n    }\n  }\n\n  /**\n   * Extend lock TTL (with ownership verification)\n   */\n  async extendLock(deviceId: string, additionalTtl: number): Promise<boolean> {\n    try {\n      const lock = await this.getLock(deviceId);\n      \n      if (!lock) {\n        return false;\n      }\n\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      const client = await this.redisService.getClient();\n      const currentTtlSeconds = await client.ttl(key);\n      \n      if (currentTtlSeconds <= 0) {\n        // Lock expired\n        return false;\n      }\n\n      const newTtlSeconds = Math.ceil((currentTtlSeconds * 1000 + additionalTtl) / 1000);\n      const expireResult = await client.expire(key, newTtlSeconds);\n      \n      if (expireResult === 1) {\n        // Also extend metadata TTL\n        await this.redisService.expire(metadataKey, newTtlSeconds);\n        \n        this.logger.log(`[${deviceId}] Extended lock by ${additionalTtl}ms`);\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error extending lock: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Release lock by type (force release if lock type matches)\n   */\n  async releaseLockByType(deviceId: string, lockType: DeviceLockType): Promise<boolean> {\n    try {\n      const lock = await this.getLock(deviceId);\n      \n      if (!lock) {\n        return false;\n      }\n\n      // Only release if lock type matches\n      if (lock.lockType !== lockType) {\n        return false;\n      }\n\n      // Force release by directly deleting the keys (no lockId verification needed)\n      const key = `${this.REDIS_LOCK_PREFIX}${deviceId}`;\n      const metadataKey = `${this.REDIS_LOCK_PREFIX}${deviceId}:meta`;\n      \n      await this.redisService.del(key);\n      await this.redisService.del(metadataKey);\n      \n      this.logger.log(`[${deviceId}] Force released ${lockType} lock`);\n      return true;\n    } catch (error) {\n      this.logger.error(`[${deviceId}] Error releasing ${lockType} lock: ${error.message}`);\n      return false;\n    }\n  }\n\n  /**\n   * Get all device lock keys matching pattern device:lock:*\n   * @returns Array of device lock keys (without the prefix)\n   */\n  async hasAnyLockKeys(): Promise<number> {\n    try {\n      const pattern = `${this.REDIS_LOCK_PREFIX}*`;\n      const allKeys = await this.redisService.keys(pattern);\n      \n      // Filter out metadata keys (device:lock:*:meta) and extract deviceId\n      const lockKeys = allKeys.filter(key => !key.endsWith(':meta'))\n      \n      return lockKeys.length;\n    } catch (error) {\n      this.logger.error(`Error getting all lock keys: ${error.message}`);\n      return 0;\n    }\n  }\n}\n\n","module.exports = require(\"crypto\");","module.exports = require(\"lodash\");","import { Inject, Injectable, Logger } from '@nestjs/common';\nimport { DeviceService } from '../../device/device.service';\nimport { IAnalyzeTransferBillResult, IBankService } from '../interfaces/bank-service.interface';\nimport { Withdrawal } from '../../../common/interfaces/withdrawal.interface';\nimport { ICaptureScreenOptions, IHCSwipeOptions, IPandaSwipeOptions, IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { sleep } from '@/common/utils/time';\nimport { existsSync, mkdirSync } from 'fs';\nimport { mkdir, readdir, stat, unlink, rm } from 'fs/promises';\nimport { join, resolve } from 'path';\nimport { OCRService } from '@/modules/ocr/services/ocr.service';\nimport { ROI } from '@/modules/ocr/services/image-preprocessing.service';\nimport { toFile as QRCodeToFile } from 'qrcode';\nimport { DeviceConfig } from '@/modules/device/dto/device-config.dto';\nimport { ANALYZE_BILL_ROI } from '../constants/analyze-bill';\n\n/**\n * Screen verification configuration\n */\nexport interface ScreenVerificationConfig {\n  // Text markers  identify mn hnh (dng OCR)\n  expectedTexts?: string[];\n  // Text markers khng c xut hin ( verify  ri mn hnh c)\n  unexpectedTexts?: string[];\n  // Timeout ti a  i mn hnh xut hin (ms)\n  timeout?: number;\n  // Polling interval - check mi X ms\n  pollInterval?: number;\n  // ROI  ch OCR mt vng c th (optional - nu khng c s OCR full screen)\n  roi?: ROI;\n  // Field type cho OCR (singleLine, block, full)\n  fieldType?: 'singleLine' | 'block' | 'full';\n  // Preprocessing options\n  preprocess?: {\n    grayscale?: boolean;\n    enhanceContrast?: boolean;\n  };\n}\n\n/**\n * Base abstract class for all bank services\n * Provides common functionality and enforces interface implementation\n */\n@Injectable()\nexport abstract class BaseBankService implements IBankService {\n  protected readonly logger: Logger;\n  protected abstract readonly BANK_CODE: string;\n  protected abstract readonly BUNDLE_ID: string;\n\n  // Static flags  trnh race condition khi nhiu class cng khi to\n  protected readonly baseTransactionFolderPath = 'C:/EasyData';\n  protected readonly baseTransactionExecutionFolder = 'C:/EasyTrx';\n  private static folderCreationInProgress = false;\n  private static folderCreated = false;\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    protected readonly deviceService: DeviceService,\n    protected ocrService: OCRService,\n  ) {\n    this.logger = new Logger('BaseBankService');\n    BaseBankService.createTransactionFolder(this.baseTransactionFolderPath, this.logger);\n    BaseBankService.createTransactionFolder(this.baseTransactionExecutionFolder, this.logger);\n  }\n\n  /**\n   * Kim tra v to base folder nu cha tn ti\n   * S dng static method  trnh race condition khi nhiu class cng khi to\n   */\n  private static createTransactionFolder(folderPath: string, logger: Logger): void {\n    // Nu  to ri th khng cn lm g\n    if (BaseBankService.folderCreated) {\n      return;\n    }\n\n    // Nu ang c process khc ang to folder, i mt cht ri check li\n    if (BaseBankService.folderCreationInProgress) {\n      // i ti a 100ms, check mi 10ms\n      let attempts = 0;\n      const maxAttempts = 10;\n      while (BaseBankService.folderCreationInProgress && attempts < maxAttempts) {\n        attempts++;\n        // Synchronous wait (ch dng trong constructor, khng block event loop lu)\n        const start = Date.now();\n        while (Date.now() - start < 10) {\n          // Busy wait 10ms\n        }\n      }\n      // Sau khi i, check li xem  to cha\n      if (BaseBankService.folderCreated || existsSync(folderPath)) {\n        BaseBankService.folderCreated = true;\n        return;\n      }\n    }\n\n    try {\n      // nh du ang to folder\n      BaseBankService.folderCreationInProgress = true;\n\n      // Kim tra li mt ln na (double-check pattern)\n      if (!existsSync(folderPath)) {\n        mkdirSync(folderPath, { recursive: true });\n        logger.log(`Created base folder: ${folderPath}`);\n      } else {\n        logger.debug(`Base folder already exists: ${folderPath}`);\n      }\n\n      // nh du  to xong\n      BaseBankService.folderCreated = true;\n    } catch (error) {\n      // Nu li l \"folder already exists\" th khng sao (c th xy ra trong race condition)\n      if ((error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        logger.error(`Failed to create base folder ${folderPath}: ${error.message}`);\n      } else {\n        // Folder  tn ti (c th do process khc  to), nh du l  to\n        BaseBankService.folderCreated = true;\n        logger.debug(`Base folder already exists (created by another process): ${folderPath}`);\n      }\n    } finally {\n      // Lun reset flag\n      BaseBankService.folderCreationInProgress = false;\n    }\n  }\n\n  getBankCode(): string {\n    return this.BANK_CODE;\n  }\n\n  async killApp(deviceId: string): Promise<void> {\n    this.logger.log(`[${deviceId}] Killing ${this.BANK_CODE} app`);\n    await this.wsService.killApp(deviceId, this.BUNDLE_ID);\n  }\n\n  /**\n   * Helper method for clicking with transition time and logging\n   */\n  async clickWithTransition(\n    deviceId: string,\n    x: number,\n    y: number,\n    transitionTime: number,\n    log: string = ''\n  ): Promise<void> {\n    await this.wsService.click(deviceId, x, y, 0.2);\n    if (log) {\n      this.logger.log(log);\n    }\n    // Wait for screen transition\n    await sleep(transitionTime);\n  }\n\n  /**\n   * Verify screen state bng cch capture v check text qua Local OCR\n   * Flow:\n   * 1. Capture screen  lu vo folder tm (unique mi ln chy)\n   * 2. Local OCR c text t file (nhanh, khng cn API)\n   * 3. So snh vi expected/unexpected texts\n   * 4. Xa c folder tm sau khi OCR\n   * 5. Return true nu match, false nu khng\n   */\n  protected async verifyScreenState(\n    deviceId: string,\n    config: ScreenVerificationConfig\n  ): Promise<boolean> {\n    const {\n      expectedTexts = [],\n      unexpectedTexts = [],\n      timeout = 30000,\n      pollInterval = 500,\n      roi,\n      fieldType = 'full',\n      preprocess,\n    } = config;\n\n    const startTime = Date.now();\n    let attemptCount = 0;\n    \n    // To folder tm cho mi ln verifyScreenState (1 device ch lm 1 action nn khng c conflict)\n    const tempDir = join(this.baseTransactionExecutionFolder, `scan_${deviceId}`);\n    \n    // Log vi ROI info nu c\n    const roiInfo = roi \n      ? `ROI: x=${roi.x}, y=${roi.y}, w=${roi.width}, h=${roi.height}` \n      : 'Full screen';\n    \n    this.logger.debug(\n      `[${deviceId}] Starting screen verification. ` +\n      `Expected: [${expectedTexts.join(', ')}], ` +\n      `Unexpected: [${unexpectedTexts.join(', ')}], ` +\n      `${roiInfo}, ` +\n      `Timeout: ${timeout}ms, Poll: ${pollInterval}ms`\n    );\n    \n    // Helper function  cleanup folder\n    const cleanupFolder = async () => {\n      if (existsSync(tempDir)) {\n        try {\n          await rm(tempDir, { recursive: true, force: true });\n          this.logger.debug(`[${deviceId}] Cleaned up temp folder: ${tempDir}`);\n        } catch (cleanupError) {\n          // Ignore cleanup errors\n          this.logger.debug(`[${deviceId}] Failed to cleanup folder: ${cleanupError.message}`);\n        }\n      }\n    };\n    \n    try {\n      // To folder tm 1 ln  u\n      try {\n        await mkdir(tempDir, { recursive: true });\n      } catch (mkdirError) {\n        // Directory might already exist, khng sao\n      }\n      \n      while (Date.now() - startTime < timeout) {\n        attemptCount++;\n        let tempScreenshotPath: string | null = null;\n        \n        try {\n          \n          // Ghi nhn thi im trc khi capture  ch ly file mi\n          const beforeCaptureTime = Date.now();\n          \n          // Capture screen vo folder (file s c gen vi UUID.png)\n          await this.wsService.captureScreen(deviceId, {\n            folderPath: tempDir\n          });\n          \n          // Bc 2: i file c lu y \n          await sleep(800);\n          \n          // Bc 3: Tm file mi nht trong folder\n          let latestFile: string | null = null;\n          let latestMtime = 0;\n          \n          try {\n            const files = await readdir(tempDir);\n            const pngFiles = files.filter(f => f.endsWith('.png'));\n            \n            if (pngFiles.length === 0) {\n              this.logger.debug(`[${deviceId}] No screenshot files found in folder, retrying...`);\n              await sleep(pollInterval);\n              continue;\n            }\n            \n            // Tm file c mtime mi nht (ch ly file c to sau capture)\n            const now = Date.now();\n            for (const file of pngFiles) {\n              const filePath = join(tempDir, file);\n              try {\n                const fileStat = await stat(filePath);\n                if (fileStat.size === 0) {\n                  continue;\n                }\n                \n                // Ch ly file c to sau thi im capture\n                if (fileStat.mtimeMs >= beforeCaptureTime - 1000) {\n                  if (fileStat.mtimeMs > latestMtime) {\n                    latestMtime = fileStat.mtimeMs;\n                    latestFile = filePath;\n                  }\n                }\n              } catch (statError) {\n                continue;\n              }\n            }\n            \n            if (!latestFile) {\n              await sleep(pollInterval);\n              continue;\n            }\n            \n            tempScreenshotPath = latestFile;\n          } catch (readdirError) {\n            this.logger.debug(`[${deviceId}] Cannot read screenshot folder, retrying...`);\n            await sleep(pollInterval);\n            continue;\n          }\n          \n          // Bc 4: Gi OCR Service vi ROI nu c\n          const allSearchTexts = [...expectedTexts, ...unexpectedTexts];\n          const ocrResult = await this.ocrService.fastScreenOCR(\n            tempScreenshotPath,\n            allSearchTexts,\n            {\n              fieldType: roi ? 'singleLine' : fieldType,\n              customROI: roi,\n              preprocess: preprocess,\n            }\n          );\n          \n          // Bc 5: X l kt qu OCR\n          if (!ocrResult || !ocrResult.found) {\n            await sleep(pollInterval);\n            continue;\n          }\n          \n          // Bc 6: So snh vi expected texts - Check if expected texts are in matchedTexts\n          const hasExpectedTexts = expectedTexts.length === 0 || expectedTexts.some(text => \n            ocrResult.matchedTexts.includes(text)\n          );\n          \n          // Bc 7: Check unexpected texts (khng c xut hin)\n          const hasUnexpectedTexts = unexpectedTexts.some(text => \n            ocrResult.matchedTexts.includes(text)\n          );\n          \n          // Bc 8: Verify kt qu\n          if (hasExpectedTexts && !hasUnexpectedTexts) {\n            // Xa folder khi success\n            await cleanupFolder();\n            \n            const elapsed = Date.now() - startTime;\n            const ocrTime = ocrResult.result?.processingTime || 0;\n            const roiStr = roi ? ` (ROI: ${roi.x},${roi.y} ${roi.width}x${roi.height})` : '';\n            this.logger.log(\n              `[${deviceId}] Screen verified successfully after ${elapsed}ms ` +\n              `(${attemptCount} attempts, OCR: ${ocrTime}ms)${roiStr}. ` +\n              `Matched: [${ocrResult.matchedTexts.join(', ')}]`\n            );\n            return true;\n          }\n          \n          // Cha ng mn hnh, log debug\n          if (attemptCount % 5 === 0) {\n            this.logger.debug(\n              `[${deviceId}] Screen not matched yet (attempt ${attemptCount}). ` +\n              `Matched texts: [${ocrResult.matchedTexts.join(', ')}], ` +\n              `Expected: [${expectedTexts.join(', ')}]`\n            );\n          }\n          \n          // i trc khi th li\n          await sleep(pollInterval);\n          \n        } catch (error) {\n          this.logger.debug(\n            `[${deviceId}] Error verifying screen (attempt ${attemptCount}): ${error.message}, retrying...`\n          );\n          await sleep(pollInterval);\n        }\n      }\n      \n      // Timeout - xa folder trc khi return\n      await cleanupFolder();\n      \n      const elapsed = Date.now() - startTime;\n      this.logger.warn(\n        `[${deviceId}] Screen verification timeout after ${elapsed}ms ` +\n        `(${attemptCount} attempts). Expected: [${expectedTexts.join(', ')}]`\n      );\n      return false;\n      \n    } catch (error) {\n      // Cleanup folder nu c li nghim trng\n      await cleanupFolder();\n      throw error;\n    }\n  }\n\n  /**\n   * Click v t ng verify mn hnh  chuyn\n   * Thay th cho clickWithTransition vi screen verification\n   */\n  protected async clickAndWaitForScreen(\n    deviceId: string,\n    x: number,\n    y: number,\n    screenConfig: ScreenVerificationConfig,\n    log?: string\n  ): Promise<boolean> {\n    // Click\n    await this.wsService.click(deviceId, x, y, 0.2);\n    if (log) {\n      this.logger.log(log);\n    }\n    \n    const verified = await this.verifyScreenState(deviceId, screenConfig);\n    \n    // TODO: Uncomment this when debugging\n    // this.logger.debug(`[${deviceId}] Screen verified after click at (${x}, ${y})`);\n    return verified\n  }\n\n  /**\n   * Swipe v t ng verify mn hnh  chuyn\n   * Retry ti a 3 ln nu khng detect c screen, mi ln timeout 1s\n   */\n  protected async swipeAndWaitForScreen(\n    deviceId: string,\n    swipeOptions: IHCSwipeOptions | IPandaSwipeOptions,\n    screenConfig: ScreenVerificationConfig,\n    log?: string\n  ): Promise<boolean> {\n    const maxRetries = 3;\n    const timeoutPerAttempt = 1000; // 1 second\n    \n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      // Swipe\n      await this.wsService.swipe(deviceId, swipeOptions);\n      if (log && attempt === 1) {\n        this.logger.log(log);\n      }\n      \n      // Verify screen vi timeout 1s cho mi attempt\n      const verified = await this.verifyScreenState(deviceId, {\n        ...screenConfig,\n        timeout: timeoutPerAttempt,\n      });\n      \n      if (verified) {\n        if (attempt > 1) {\n          this.logger.log(`[${deviceId}] Screen verified after ${attempt} swipe attempts`);\n        }\n        return true;\n      }\n      \n      // Nu khng detect c v cha ht retry, log v th li\n      if (attempt < maxRetries) {\n        this.logger.debug(`[${deviceId}] Screen not detected after swipe (attempt ${attempt}/${maxRetries}), retrying...`);\n      }\n    }\n    \n    // Tt c attempts u fail\n    this.logger.warn(`[${deviceId}] Failed to detect screen after ${maxRetries} swipe attempts`);\n    return false;\n  }\n\n  async createBillFolder(folderPath: string): Promise<void> {\n    const path = resolve(this.baseTransactionFolderPath, folderPath);\n\n    await mkdir(path, { recursive: true });\n  }\n\n  /**\n   * Capture screen of device\n   */\n  async captureScreen(deviceId: string, options: ICaptureScreenOptions) {\n    this.logger.log(`Capturing screen on device ${deviceId} with folderPath: ${options.folderPath}`);\n\n    const path = resolve(this.baseTransactionFolderPath, options.folderPath);\n\n    await this.wsService.captureScreen(deviceId, {\n      ...options,\n      folderPath: path,\n    });\n\n    await sleep(500);\n  }\n\n  /**\n   * Qut th mc cho n khi timeout v tr v file mi nht\n   * @param folderPath ng dn n folder cha nh\n   * @param timeout Timeout ti a  i file (ms), mc nh 30000ms (30s)\n   * @param pollInterval Khong thi gian gia cc ln qut (ms), mc nh 500ms\n   * @returns ng dn file mi nht hoc null nu khng tm thy\n   */\n  async getBillImagePath(\n    folderPath: string,\n    timeout: number = 10000,\n    pollInterval: number = 500\n  ): Promise<string | null> {\n    if (!folderPath) {\n      this.logger.warn('Folder path is null or empty');\n      return null;\n    }\n\n    const folder = join(this.baseTransactionFolderPath, folderPath);\n    const startTime = Date.now();\n    let attemptCount = 0;\n\n    this.logger.debug(\n      `Scanning folder for bill image: ${folderPath}, timeout: ${timeout}ms, pollInterval: ${pollInterval}ms`\n    );\n\n    while (Date.now() - startTime < timeout) {\n      attemptCount++;\n\n      try {\n        // Kim tra th mc c tn ti khng\n        if (!existsSync(folder)) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`Folder does not exist yet: ${folderPath}, retrying...`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        const files = await readdir(folder);\n\n        if (files.length === 0) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`No files found in folder: ${folderPath}, retrying... (attempt ${attemptCount})`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Ly thng tin tt c cc file\n        const filesWithStat = await Promise.all(\n          files.map(async file => {\n            try {\n              const fullPath = join(folder, file);\n              const s = await stat(fullPath);\n              return { fullPath, mtime: s.mtimeMs, size: s.size };\n            } catch (statError) {\n              // Skip files that can't be stat'd\n              return null;\n            }\n          })\n        );\n\n        // Lc cc file hp l (size > 0)\n        const validFiles = filesWithStat.filter(\n          (f): f is { fullPath: string; mtime: number; size: number } => \n            f !== null && f.size > 0\n        );\n\n        if (validFiles.length === 0) {\n          // TODO: Uncomment this when debugging\n          // this.logger.debug(`No valid files found in folder: ${folderPath}, retrying... (attempt ${attemptCount})`);\n          await sleep(pollInterval);\n          continue;\n        }\n\n        // Sp xp theo thi gian modified mi nht\n        validFiles.sort((a, b) => b.mtime - a.mtime);\n\n        const latestFile = validFiles[0].fullPath;\n        const elapsed = Date.now() - startTime;\n        this.logger.log(\n          `Found latest bill image: ${latestFile} after ${elapsed}ms (${attemptCount} attempts)`\n        );\n\n        return latestFile;\n      } catch (error) {\n        this.logger.debug(\n          `Error scanning folder ${folderPath} (attempt ${attemptCount}): ${error.message}, retrying...`\n        );\n        await sleep(pollInterval);\n      }\n    }\n\n    // Timeout - khng tm thy file\n    const elapsed = Date.now() - startTime;\n    this.logger.warn(\n      `Timeout scanning folder for bill image: ${folderPath} after ${elapsed}ms (${attemptCount} attempts)`\n    );\n    return null;\n  }\n\n  async analyzeTransferBill(bankCode: string, withdrawal: Partial<Withdrawal>): Promise<IAnalyzeTransferBillResult> {\n    const { ROI, expectedTexts } = ANALYZE_BILL_ROI[bankCode];\n    const billImage = await this.getBillImagePath(withdrawal.withdrawalCode);\n\n    try {\n      // No image found\n      if (!billImage) {\n        this.logger.warn(`No bill image path ${withdrawal.withdrawalCode}`);\n\n        return {\n          rawPath: null,\n          analyzedStatus: 'na',\n        };\n      }\n\n      // const ocrResult = await ocrBillPro(billImage);\n      const ocrResult = await this.ocrService.fastScreenOCR(\n        billImage,\n        expectedTexts,\n        {\n          fieldType: 'singleLine',\n          customROI: ROI,\n          preprocess: {\n            // increase constrast for image recognition\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      );\n\n      if (!ocrResult.found) {\n        this.logger.warn(`No OCR result found for ${withdrawal.withdrawalCode}`);\n\n        return {\n          rawPath: billImage,\n          analyzedStatus: 'na'\n        }\n      }\n\n      return {\n        rawPath: billImage,\n        analyzedStatus: ocrResult.found ? 'success' : 'unknown',\n      };\n    } catch (error) {\n      this.logger.error(`Error analyzing transfer bill: ${error.message}`);\n\n      return {\n        rawPath: billImage,\n        analyzedStatus: 'na'\n      }\n    }\n  }\n\n  async createQRCodeAndTransferTo(deviceId: string, withdrawal: Withdrawal) {\n    const folderPath = join(this.baseTransactionExecutionFolder, 'qrcode');\n\n    await mkdir(folderPath, { recursive: true });\n    const fileName = `qr_${withdrawal.withdrawalCode}.png`;\n    const filePath = join(folderPath, fileName);\n\n    await QRCodeToFile(\n      filePath,\n      withdrawal.transferCode,\n      {\n        type: 'png',\n        width: 228,\n        margin: 2\n      }\n    );\n\n    await sleep(500);\n\n    await this.wsService.transferFile(deviceId, filePath, 1);\n\n    await sleep(500);\n\n    this.logger.log(`[${deviceId}] QR code is created and transferred for withdrawal ${withdrawal.withdrawalId}`);\n  } \n\n  /**\n   * Abstract methods - must be implemented by each bank\n   */\n  abstract login(deviceId: string): Promise<void>;\n  abstract launchApp(deviceId: string): Promise<void>;\n  abstract executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void>;\n}\n\n","export const sleep = (ms: number): Promise<void> => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};","module.exports = require(\"fs\");","module.exports = require(\"fs/promises\");","import { Injectable, Logger } from '@nestjs/common';\nimport { readFile } from 'fs/promises';\nimport { OCRWorkerPoolService } from './ocr-worker-pool.service';\nimport { ImagePreprocessingService, ROI, PreprocessOptions } from './image-preprocessing.service';\nimport { normalizeBankAccountName } from '@/common/utils/string';\nimport { config, IConfig } from '@/common/constants/config';\n\n// Re-export types for consumers\nexport { ROI, PreprocessOptions } from './image-preprocessing.service';\n\nexport interface OCRResult {\n  text: string;\n  confidence: number;\n  processingTime: number;\n  timingBreakdown: {\n    decodeImage: number;\n    preprocess: number;\n    ocrRecognize: number;\n    postprocess: number;\n  };\n}\n\nexport type FieldType = 'singleLine' | 'block' | 'full';\n\n// Default ROI config for fallback\nconst DEFAULT_ROI_CONFIG = {\n  crop: { x: 0, y: 0, width: 1, height: 1 },\n  psm: 6,\n  charWhitelist: undefined,\n  maxWidth: 1200,\n};\n\n@Injectable()\nexport class OCRService {\n  private readonly logger = new Logger(OCRService.name);\n  private readonly ocrConfig: Pick<IConfig['ocr'], 'poolSize' | 'lang' | 'rois'>;\n\n  constructor(\n    private readonly workerPoolService: OCRWorkerPoolService,\n    private readonly imagePreprocessingService: ImagePreprocessingService,\n  ) {\n    this.ocrConfig = {\n      poolSize: config.ocr.poolSize,\n      lang: config.ocr.lang,\n      rois: {\n        full: DEFAULT_ROI_CONFIG,\n        singleLine: { ...DEFAULT_ROI_CONFIG, psm: 7 },\n        block: { ...DEFAULT_ROI_CONFIG, psm: 6 },\n      },\n    };\n  }\n\n  /**\n   * Validate and normalize ROI values\n   */\n  private validateROI(roi: ROI): ROI {\n    return {\n      x: Math.max(0, Math.min(1, roi.x || 0)),\n      y: Math.max(0, Math.min(1, roi.y || 0)),\n      width: Math.max(0.01, Math.min(1, roi.width || 1)),\n      height: Math.max(0.01, Math.min(1, roi.height || 1)),\n    };\n  }\n\n  /**\n   * Get ROI config for a field type with proper fallback\n   */\n  private getROIConfig(fieldType: FieldType) {\n    const config = this.ocrConfig.rois?.[fieldType]\n      || this.ocrConfig.rois?.full\n      || DEFAULT_ROI_CONFIG;\n\n    return {\n      crop: config.crop || DEFAULT_ROI_CONFIG.crop,\n      psm: config.psm ?? DEFAULT_ROI_CONFIG.psm,\n      charWhitelist: config.charWhitelist,\n      maxWidth: config.maxWidth ?? DEFAULT_ROI_CONFIG.maxWidth,\n    };\n  }\n\n  /**\n   * Recognize text from image file path\n   */\n  async recognizeFromFile(\n    imagePath: string,\n    options: {\n      fieldType?: FieldType;\n      customROI?: ROI;\n      language?: string;\n      /** Image preprocessing options */\n      preprocess?: PreprocessOptions;\n    } = {},\n  ): Promise<OCRResult | null> {\n    const totalStartTime = Date.now();\n    const timingBreakdown = {\n      decodeImage: 0,\n      preprocess: 0,\n      ocrRecognize: 0,\n      postprocess: 0,\n    };\n\n    try {\n      // Step 1: Decode/Load image\n      const decodeStart = Date.now();\n      const imageBuffer = await readFile(imagePath);\n      timingBreakdown.decodeImage = Date.now() - decodeStart;\n\n      // Step 2: Get ROI config based on field type\n      const fieldType = options.fieldType || 'full';\n      const roiConfig = this.getROIConfig(fieldType);\n      const roi = this.validateROI(options.customROI || roiConfig.crop);\n\n      // Step 3: Crop and preprocess\n      const preprocessStart = Date.now();\n      const preprocessResult = await this.imagePreprocessingService.preprocess(\n        imageBuffer,\n        roi,\n        roiConfig.maxWidth,\n        options.preprocess, // Pass preprocessing options\n      );\n      timingBreakdown.preprocess = Date.now() - preprocessStart;\n\n      // Step 4: OCR recognize\n      const ocrStart = Date.now();\n      const ocrResult = await this.workerPoolService.recognize(\n        preprocessResult.buffer,\n        {\n          psm: roiConfig.psm,\n          charWhitelist: roiConfig.charWhitelist,\n        },\n      );\n      timingBreakdown.ocrRecognize = Date.now() - ocrStart;\n\n      // Step 5: Postprocess (trim and normalize)\n      const postprocessStart = Date.now();\n      const processedText = this.postprocessText(ocrResult.text);\n      timingBreakdown.postprocess = Date.now() - postprocessStart;\n\n      const totalProcessingTime = Date.now() - totalStartTime;\n\n      // Log timing breakdown\n      this.logTimingBreakdown(\n        imagePath,\n        fieldType,\n        totalProcessingTime,\n        timingBreakdown,\n        ocrResult.confidence,\n      );\n\n      return {\n        text: processedText,\n        confidence: ocrResult.confidence,\n        processingTime: totalProcessingTime,\n        timingBreakdown,\n      };\n    } catch (error) {\n      this.logger.error(`OCR error for ${imagePath}: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n  /**\n   * Recognize text from image buffer\n   */\n  async recognizeFromBuffer(\n    imageBuffer: Buffer,\n    options: {\n      fieldType?: FieldType;\n      customROI?: ROI;\n      language?: string;\n      /** Image preprocessing options */\n      preprocess?: PreprocessOptions;\n    } = {},\n  ): Promise<OCRResult | null> {\n    const totalStartTime = Date.now();\n    const timingBreakdown = {\n      decodeImage: 0,\n      preprocess: 0,\n      ocrRecognize: 0,\n      postprocess: 0,\n    };\n\n    try {\n      // Step 1: Image is already decoded (buffer provided)\n      timingBreakdown.decodeImage = 0;\n\n      // Step 2: Get ROI config based on field type\n      const fieldType = options.fieldType || 'full';\n      const roiConfig = this.getROIConfig(fieldType);\n      const roi = this.validateROI(options.customROI || roiConfig.crop);\n\n      // Step 3: Crop and preprocess\n      const preprocessStart = Date.now();\n      const preprocessResult = await this.imagePreprocessingService.preprocess(\n        imageBuffer,\n        roi,\n        roiConfig.maxWidth,\n        options.preprocess, // Pass preprocessing options\n      );\n      timingBreakdown.preprocess = Date.now() - preprocessStart;\n\n      // Step 4: OCR recognize\n      const ocrStart = Date.now();\n      const ocrResult = await this.workerPoolService.recognize(\n        preprocessResult.buffer,\n        {\n          psm: roiConfig.psm,\n          charWhitelist: roiConfig.charWhitelist,\n        },\n      );\n      timingBreakdown.ocrRecognize = Date.now() - ocrStart;\n\n      // Step 5: Postprocess\n      const postprocessStart = Date.now();\n      const processedText = this.postprocessText(ocrResult.text);\n      timingBreakdown.postprocess = Date.now() - postprocessStart;\n\n      const totalProcessingTime = Date.now() - totalStartTime;\n\n      // Log timing breakdown\n      this.logTimingBreakdown(\n        'buffer',\n        fieldType,\n        totalProcessingTime,\n        timingBreakdown,\n        ocrResult.confidence,\n      );\n\n      return {\n        text: processedText,\n        confidence: ocrResult.confidence,\n        processingTime: totalProcessingTime,\n        timingBreakdown,\n      };\n    } catch (error) {\n      this.logger.error(`OCR error from buffer: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n  /**\n   * Fast screen OCR - search for specific texts\n   */\n  async fastScreenOCR(\n    imagePath: string,\n    searchTexts: string[],\n    options: {\n      fieldType?: FieldType;\n      customROI?: ROI;\n      preprocess?: PreprocessOptions;\n    } = {},\n  ): Promise<{\n    found: boolean;\n    matchedTexts: string[];\n    result: OCRResult | null;\n  }> {\n    const result = await this.recognizeFromFile(imagePath, {\n      fieldType: options.fieldType || 'full',\n      customROI: options.customROI,\n      preprocess: options.preprocess,\n    });\n\n    if (!result || !result.text) {\n      return {\n        found: false,\n        matchedTexts: [],\n        result,\n      };\n    }\n\n    const normalizedText = normalizeBankAccountName(result.text);\n    const matchedTexts = searchTexts.filter((searchText) =>\n      normalizedText.includes(normalizeBankAccountName(searchText)),\n    );\n\n    return {\n      found: matchedTexts.length > 0,\n      matchedTexts,\n      result,\n    };\n  }\n\n  /**\n   * Postprocess text: trim, normalize whitespace\n   */\n  private postprocessText(text: string): string {\n    return text\n      .trim()\n      .replace(/\\s+/g, ' ') // Normalize multiple spaces to single space\n      .replace(/\\n{3,}/g, '\\n\\n'); // Normalize multiple newlines\n  }\n\n  /**\n   * Log detailed timing breakdown\n   */\n  private logTimingBreakdown(\n    imageSource: string,\n    fieldType: FieldType,\n    totalTime: number,\n    breakdown: {\n      decodeImage: number;\n      preprocess: number;\n      ocrRecognize: number;\n      postprocess: number;\n    },\n    confidence: number,\n  ): void {\n    const breakdownStr = [\n      `decode=${breakdown.decodeImage}ms`,\n      `preprocess=${breakdown.preprocess}ms`,\n      `ocr=${breakdown.ocrRecognize}ms`,\n      `postprocess=${breakdown.postprocess}ms`,\n    ].join(' | ');\n\n    // TODO: Uncomment this when debugging\n    // this.logger.log(\n    //   `OCR [${fieldType}] ${imageSource}: ` +\n    //   `total=${totalTime}ms (${breakdownStr}) | ` +\n    //   `confidence=${confidence.toFixed(2)}%`,\n    // );\n\n    // Warn if total time exceeds target (1s for p95)\n    if (totalTime > 1000) {\n      this.logger.warn(\n        ` OCR latency exceeded target: ${totalTime}ms > 1000ms (p95 target)`,\n      );\n    }\n  }\n}\n\n","import { Injectable, Logger, OnModuleInit, OnModuleDestroy } from '@nestjs/common';\nimport * as Tesseract from 'tesseract.js';\nimport { config } from '@/common/constants/config';\n\ninterface WorkerInfo {\n  id: number;\n  worker: Tesseract.Worker;\n  inUse: boolean;\n  lastUsed: number;\n}\n\ninterface PendingRequest {\n  resolve: (worker: WorkerInfo) => void;\n  reject: (error: Error) => void;\n  timeout: NodeJS.Timeout;\n}\n\n@Injectable()\nexport class OCRWorkerPoolService implements OnModuleInit, OnModuleDestroy {\n  private readonly logger = new Logger('OCRWorkerPoolService');\n  private readonly pool: WorkerInfo[] = [];\n  private readonly waitingQueue: PendingRequest[] = [];\n  private readonly poolSize: number;\n  private readonly lang: string;\n  private readonly maxWaitTime = 5000; // 5 seconds max wait\n  private readonly maxPoolSize = 10; // Maximum workers to prevent resource exhaustion\n  private isInitializing = false;\n  private isDestroyed = false;\n  private isAcquiring = false; // Mutex flag for atomic acquisition\n  private initializationPromise: Promise<void> | null = null;\n\n  constructor() {\n    // Validate pool size: minimum 1, maximum 10\n    this.poolSize = Math.max(1, Math.min(config.ocr.poolSize, this.maxPoolSize));\n    this.lang = config.ocr.lang;\n\n    if (config.ocr.poolSize > this.maxPoolSize) {\n      this.logger.warn(\n        `OCR_POOL_SIZE (${config.ocr.poolSize}) exceeds maximum (${this.maxPoolSize}). Using ${this.maxPoolSize}.`\n      );\n    }\n  }\n\n  async onModuleInit(): Promise<void> {\n    await this.warmPool();\n  }\n\n  async onModuleDestroy(): Promise<void> {\n    this.isDestroyed = true;\n    // Reject all pending requests\n    this.rejectAllPending(new Error('OCR service is shutting down'));\n    await this.terminateAll();\n  }\n\n  /**\n   * Warm up worker pool during module initialization\n   */\n  private async warmPool(): Promise<void> {\n    if (this.isInitializing) {\n      return this.initializationPromise || Promise.resolve();\n    }\n\n    this.isInitializing = true;\n    this.initializationPromise = this.doWarmPool();\n\n    try {\n      await this.initializationPromise;\n    } finally {\n      this.isInitializing = false;\n    }\n  }\n\n  private async doWarmPool(): Promise<void> {\n    const startTime = Date.now();\n    this.logger.log(`Warming up OCR worker pool (size: ${this.poolSize}, lang: ${this.lang})...`);\n\n    const initPromises = Array.from({ length: this.poolSize }, (_, index) =>\n      this.createWorker(index),\n    );\n\n    try {\n      await Promise.all(initPromises);\n      const warmupTime = Date.now() - startTime;\n      this.logger.log(\n        `OCR worker pool warmed up successfully in ${warmupTime}ms. Pool size: ${this.pool.length}`,\n      );\n    } catch (error) {\n      this.logger.error(`Failed to warm up worker pool: ${error.message}`, error.stack);\n      // Clean up partially initialized workers\n      await this.terminateAll();\n      throw error;\n    }\n  }\n\n  /**\n   * Create and initialize a single worker\n   */\n  private async createWorker(index: number): Promise<void> {\n    try {\n      const worker = await Tesseract.createWorker(\n        this.lang,\n        1,\n        {\n          logger: (m: any) => {\n            // Only log errors\n            if (m.status === 'error') {\n              this.logger.error(`Tesseract worker ${index} error: ${m.message}`);\n            }\n          },\n        },\n      );\n\n      this.pool.push({\n        id: index,\n        worker,\n        inUse: false,\n        lastUsed: Date.now(),\n      });\n\n      this.logger.debug(`Worker ${index} created successfully`);\n    } catch (error) {\n      this.logger.error(`Failed to create worker ${index}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Acquire a worker from the pool with proper queue management\n   */\n  private async acquireWorker(): Promise<WorkerInfo> {\n    if (this.isDestroyed) {\n      throw new Error('OCR service is destroyed');\n    }\n\n    // Wait for pool initialization if still warming up\n    if (this.isInitializing && this.initializationPromise) {\n      await this.initializationPromise;\n    }\n\n    // Try to find an available worker (atomic check and set)\n    const workerInfo = this.tryAcquireFromPool();\n    if (workerInfo) {\n      return workerInfo;\n    }\n\n    // No available worker, add to waiting queue\n    return this.waitForWorker();\n  }\n\n  /**\n   * Try to acquire a worker from pool with mutex lock\n   * This ensures atomic acquisition in concurrent scenarios\n   */\n  private tryAcquireFromPool(): WorkerInfo | null {\n    // Check mutex - if another operation is in progress, return null\n    if (this.isAcquiring) {\n      return null;\n    }\n\n    // Set mutex\n    this.isAcquiring = true;\n\n    try {\n      for (const workerInfo of this.pool) {\n        if (!workerInfo.inUse) {\n          workerInfo.inUse = true;\n          workerInfo.lastUsed = Date.now();\n          return workerInfo;\n        }\n      }\n      return null;\n    } finally {\n      // Release mutex\n      this.isAcquiring = false;\n    }\n  }\n\n  /**\n   * Wait for a worker to become available\n   */\n  private waitForWorker(): Promise<WorkerInfo> {\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        // Remove from queue\n        const index = this.waitingQueue.findIndex(p => p.resolve === resolve);\n        if (index !== -1) {\n          this.waitingQueue.splice(index, 1);\n        }\n\n        // Create temporary worker as fallback\n        this.logger.warn('Timeout waiting for worker, creating temporary worker');\n        this.createTemporaryWorker()\n          .then(resolve)\n          .catch(reject);\n      }, this.maxWaitTime);\n\n      this.waitingQueue.push({ resolve, reject, timeout });\n    });\n  }\n\n  /**\n   * Create a temporary worker (not in pool)\n   */\n  private async createTemporaryWorker(): Promise<WorkerInfo> {\n    const tempWorker = await Tesseract.createWorker(this.lang, 1, {\n      logger: () => { },\n    });\n    return {\n      id: -1, // Negative ID indicates temporary\n      worker: tempWorker,\n      inUse: true,\n      lastUsed: Date.now(),\n    };\n  }\n\n  /**\n   * Release a worker back to the pool\n   */\n  private releaseWorker(workerInfo: WorkerInfo): void {\n    // Check if there are waiting requests\n    if (this.waitingQueue.length > 0) {\n      const pending = this.waitingQueue.shift()!;\n      clearTimeout(pending.timeout);\n      workerInfo.lastUsed = Date.now();\n      // Worker stays inUse, just transfer to next requester\n      pending.resolve(workerInfo);\n    } else {\n      workerInfo.inUse = false;\n      workerInfo.lastUsed = Date.now();\n    }\n  }\n\n  /**\n   * Reject all pending requests\n   */\n  private rejectAllPending(error: Error): void {\n    while (this.waitingQueue.length > 0) {\n      const pending = this.waitingQueue.shift()!;\n      clearTimeout(pending.timeout);\n      pending.reject(error);\n    }\n  }\n\n  /**\n   * Get a worker and execute OCR with automatic cleanup\n   */\n  async recognize(\n    imageBuffer: Buffer,\n    options: {\n      psm?: number;\n      charWhitelist?: string;\n    } = {},\n  ): Promise<{ text: string; confidence: number }> {\n    const workerInfo = await this.acquireWorker();\n    const isTemporary = workerInfo.id < 0;\n\n    const { psm, charWhitelist } = options;\n    const hadCustomParams = psm !== undefined || !!charWhitelist;\n\n    try {\n      // Set parameters in one call if possible\n      const params: Record<string, any> = {};\n      if (psm !== undefined) {\n        params.tessedit_pageseg_mode = psm;\n      }\n      if (charWhitelist) {\n        params.tessedit_char_whitelist = charWhitelist;\n      }\n\n      if (Object.keys(params).length > 0) {\n        await workerInfo.worker.setParameters(params);\n      }\n\n      // Perform OCR\n      const { data } = await workerInfo.worker.recognize(imageBuffer);\n\n      return {\n        text: data.text,\n        confidence: data.confidence,\n      };\n    } finally {\n      if (isTemporary) {\n        // Terminate temporary worker immediately\n        try {\n          await workerInfo.worker.terminate();\n        } catch (error) {\n          this.logger.warn(`Failed to terminate temporary worker: ${error.message}`);\n        }\n      } else {\n        // Reset worker parameters if we changed them\n        if (hadCustomParams) {\n          try {\n            await workerInfo.worker.setParameters({\n              tessedit_pageseg_mode: 6 as any, // Reset to default PSM 6 (SINGLE_BLOCK)\n              tessedit_char_whitelist: '', // Clear whitelist\n            });\n          } catch (error) {\n            this.logger.warn(`Failed to reset worker parameters: ${error.message}`);\n          }\n        }\n        this.releaseWorker(workerInfo);\n      }\n    }\n  }\n\n  /**\n   * Get pool statistics for monitoring\n   */\n  getPoolStats(): { total: number; inUse: number; waiting: number } {\n    return {\n      total: this.pool.length,\n      inUse: this.pool.filter(w => w.inUse).length,\n      waiting: this.waitingQueue.length,\n    };\n  }\n\n  /**\n   * Terminate all workers in the pool\n   */\n  private async terminateAll(): Promise<void> {\n    if (this.pool.length === 0) {\n      return;\n    }\n\n    this.logger.log(`Terminating ${this.pool.length} OCR workers...`);\n\n    const terminatePromises = this.pool.map((workerInfo) =>\n      workerInfo.worker\n        .terminate()\n        .then(() => {\n          this.logger.debug(`Worker ${workerInfo.id} terminated`);\n        })\n        .catch((error) => {\n          this.logger.error(`Error terminating worker ${workerInfo.id}: ${error.message}`);\n        }),\n    );\n\n    await Promise.all(terminatePromises);\n    this.pool.length = 0;\n    this.logger.log('All OCR workers terminated');\n  }\n}\n\n","module.exports = require(\"tesseract.js\");","import { Injectable, Logger } from '@nestjs/common';\nimport * as sharp from 'sharp';\n\nexport interface ROI {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}\n\nexport interface PreprocessResult {\n  buffer: Buffer;\n  metadata: {\n    originalWidth: number;\n    originalHeight: number;\n    processedWidth: number;\n    processedHeight: number;\n    scaleFactor: number;\n  };\n}\n\nexport interface PreprocessOptions {\n  grayscale?: boolean;\n  enhanceContrast?: boolean;\n}\n\n@Injectable()\nexport class ImagePreprocessingService {\n  private readonly logger = new Logger('ImagePreprocessingService');\n  private readonly MIN_DIMENSION = 10; // Minimum pixels for any dimension\n\n  /**\n   * Validate ROI values (should be between 0 and 1)\n   */\n  private validateROI(roi: ROI): void {\n    if (roi.x < 0 || roi.x > 1) {\n      throw new Error(`Invalid ROI x: ${roi.x} (must be 0-1)`);\n    }\n    if (roi.y < 0 || roi.y > 1) {\n      throw new Error(`Invalid ROI y: ${roi.y} (must be 0-1)`);\n    }\n    if (roi.width <= 0 || roi.width > 1) {\n      throw new Error(`Invalid ROI width: ${roi.width} (must be 0-1)`);\n    }\n    if (roi.height <= 0 || roi.height > 1) {\n      throw new Error(`Invalid ROI height: ${roi.height} (must be 0-1)`);\n    }\n    if (roi.x + roi.width > 1.001) { // Small tolerance for floating point\n      throw new Error(`ROI extends beyond image: x(${roi.x}) + width(${roi.width}) > 1`);\n    }\n    if (roi.y + roi.height > 1.001) {\n      throw new Error(`ROI extends beyond image: y(${roi.y}) + height(${roi.height}) > 1`);\n    }\n  }\n\n  /**\n   * Preprocess image: decode, crop ROI, and downscale if needed\n   */\n  async preprocess(\n    imageBuffer: Buffer,\n    roi: ROI,\n    maxWidth?: number,\n    options: PreprocessOptions = {},\n  ): Promise<PreprocessResult> {\n    try {\n      // Validate ROI\n      this.validateROI(roi);\n\n      // Load image and get metadata\n      const image = sharp(imageBuffer);\n      const metadata = await image.metadata();\n      const originalWidth = metadata.width || 0;\n      const originalHeight = metadata.height || 0;\n\n      if (originalWidth === 0 || originalHeight === 0) {\n        throw new Error('Invalid image dimensions: width or height is 0');\n      }\n\n      if (originalWidth < this.MIN_DIMENSION || originalHeight < this.MIN_DIMENSION) {\n        throw new Error(`Image too small: ${originalWidth}x${originalHeight} (min: ${this.MIN_DIMENSION}x${this.MIN_DIMENSION})`);\n      }\n\n      // Calculate absolute crop coordinates\n      const cropX = Math.floor(roi.x * originalWidth);\n      const cropY = Math.floor(roi.y * originalHeight);\n      const cropWidth = Math.floor(roi.width * originalWidth);\n      const cropHeight = Math.floor(roi.height * originalHeight);\n\n      // Ensure crop is within image bounds and has valid dimensions\n      const finalCropX = Math.max(0, Math.min(cropX, originalWidth - 1));\n      const finalCropY = Math.max(0, Math.min(cropY, originalHeight - 1));\n      const finalCropWidth = Math.max(this.MIN_DIMENSION, Math.min(cropWidth, originalWidth - finalCropX));\n      const finalCropHeight = Math.max(this.MIN_DIMENSION, Math.min(cropHeight, originalHeight - finalCropY));\n\n      // Crop ROI\n      let processedImage = image.clone().extract({\n        left: finalCropX,\n        top: finalCropY,\n        width: finalCropWidth,\n        height: finalCropHeight,\n      });\n\n      // Downscale if needed\n      let processedWidth = finalCropWidth;\n      let processedHeight = finalCropHeight;\n      let scaleFactor = 1;\n\n      if (maxWidth && finalCropWidth > maxWidth) {\n        scaleFactor = maxWidth / finalCropWidth;\n        processedWidth = maxWidth;\n        processedHeight = Math.max(this.MIN_DIMENSION, Math.floor(finalCropHeight * scaleFactor));\n        processedImage = processedImage.resize(processedWidth, processedHeight, {\n          kernel: sharp.kernel.lanczos3, // High quality downscale\n          withoutEnlargement: true,\n        });\n      }\n\n      // Optional: convert to grayscale (can improve OCR accuracy)\n      if (options.grayscale) {\n        processedImage = processedImage.grayscale();\n      }\n\n      // Optional: enhance contrast\n      if (options.enhanceContrast) {\n        processedImage = processedImage.normalize();\n      }\n\n      // Convert to PNG buffer for OCR (tesseract works best with PNG)\n      const processedBuffer = await processedImage.png().toBuffer();\n\n      // TODO: Uncomment this when debugging\n      // const processingTime = Date.now() - startTime;\n      // this.logger.debug(\n      //   `Preprocessing: ${processingTime}ms | ` +\n      //   `Original: ${originalWidth}x${originalHeight} | ` +\n      //   `ROI: ${finalCropX},${finalCropY} ${finalCropWidth}x${finalCropHeight} | ` +\n      //   `Processed: ${processedWidth}x${processedHeight} (scale: ${scaleFactor.toFixed(2)})`,\n      // );\n\n      return {\n        buffer: processedBuffer,\n        metadata: {\n          originalWidth,\n          originalHeight,\n          processedWidth,\n          processedHeight,\n          scaleFactor,\n        },\n      };\n    } catch (error) {\n      this.logger.error(`Image preprocessing error: ${error.message}`, error.stack);\n      throw error;\n    }\n  }\n}\n\n","module.exports = require(\"sharp\");","export const removeVietnameseTones = (input: string): string => {\n  if (!input) {\n\t\treturn '';\n\t}\n\n  return input\n    // Normalize to Unicode NFD form\n    .normalize('NFD')\n    // Remove all diacritical marks\n    .replace(/[\\u0300-\\u036f]/g, '')\n    // Handle special Vietnamese characters\n    .replace(//g, 'd')\n    .replace(//g, 'D');\n}\n\nexport const normalizeBankAccountName = (name: string) => {\n\tif (!name) {\n\t\treturn '';\n\t}\n\n\tconst transformed = removeVietnameseTones(name);\n\t\n\treturn transformed.trim().replace(/ /g, '').toLocaleUpperCase();\n}","module.exports = require(\"qrcode\");","import { HD_ROI_EXPECTED } from \"./hd-roi\";\nimport { PG_ROI_EXPECTED } from \"./pg-roi\";\nimport { VCB_ROI_EXPECTED } from \"./vcb-roi\";\n\nexport const ANALYZE_BILL_ROI = {\n  PGBANK: {\n    ROI: PG_ROI_EXPECTED.TRANSACTION_SUCCESS,\n    expectedTexts: ['chuyn tin thnh cng'],\n  },\n  HDBANK: {\n    ROI: HD_ROI_EXPECTED.TRANSACTION_SUCCESS,\n    expectedTexts: ['GIAO DCH THNH CNG'],\n  },\n  VIETCOMBANK: {\n    ROI: VCB_ROI_EXPECTED.TRANSACTION_SUCCESS,\n    expectedTexts: ['Giao dch thnh cng'],\n  },\n};","import { ROI } from \"@/modules/ocr/services/image-preprocessing.service\";\n\nexport const HD_ROI_EXPECTED: Record<string, {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}> = {\n  LAUNCH_APP: {\n    x: 0.1,\n    y: 0.54,\n    width: 0.7,\n    height: 0.1\n  },\n  VERIFY_ACCOUNT_NUMBER: {\n    x: 0.05,\n    y: 0.4,\n    width: 0.9,\n    height: 0.2\n  },\n  VERIFY_ACCOUNT_NAME: {\n    x: 0.05,\n    y: 0.6,\n    width: 0.8,\n    height: 0.2\n  },\n  OTP_ENTER: {\n    x: 0.1,\n    y: 0.25,\n    width: 0.8,\n    height: 0.1\n  },\n  TRANSACTION_VERIFY: {\n    x: 0.1,\n    y: 0.5,\n    width: 0.4,\n    height: 0.1\n  },\n  TRANSACTION_SUCCESS: {\n    x: 0.2,\n    y: 0.3,\n    width: 0.6,\n    height: 0.1\n  },\n  HOME_SCREEN: {\n    x: 0.02,\n    y: 0.7,\n    width: 0.98,\n    height: 0.3\n  },\n  ALBUM_SCREEN: {\n    x: 0.02,\n    y: 0.02,\n    width: 0.98,\n    height: 0.2\n  },\n  SWIPE_UP_SCREEN: {\n    x: 0.1,\n    y: 0.8,\n    width: 0.8,\n    height: 0.1\n  }\n}","export const PG_ROI_EXPECTED: Record<string, {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}> = {\n  LAUNCH_APP: {\n    x: 0.04,\n    y: 0.53,\n    width: 0.73,\n    height: 0.078\n  },\n  VERIFY_ACCOUNT_NAME: {\n    x: 0.04,\n    y: 0.45,\n    width: 0.81,\n    height: 0.18\n  },\n  TRANSACTION_CONFIRM: {\n    x: 0.085,\n    y: 0.023,\n    width: 0.8,\n    height: 0.08\n  },\n  TRANSACTION_VERIFY: {\n    x: 0.085,\n    y: 0.023,\n    width: 0.8,\n    height: 0.08\n  },\n  TRANSACTION_SUCCESS: {\n    x: 0.06,\n    y: 0.212,\n    width: 0.88,\n    height: 0.1\n  },\n  HOME_SCREEN: {\n    x: 0.02,\n    y: 0.7,\n    width: 0.98,\n    height: 0.3\n  }\n}","import { ROI } from \"@/modules/ocr/services/image-preprocessing.service\";\n\nexport const VCB_ROI_EXPECTED: Record<string, {\n  x: number; // ratio 0-1\n  y: number; // ratio 0-1\n  width: number; // ratio 0-1\n  height: number; // ratio 0-1\n}> = {\n  LAUNCH_APP: {\n    x: 0.3,\n    y: 0.5,\n    width: 0.4,\n    height: 0.1\n  },\n  VERIFY_ACCOUNT_NUMBER: {\n    x: 0.05,\n    y: 0.45,\n    width: 0.9,\n    height: 0.2\n  },\n  VERIFY_ACCOUNT_NAME: {\n    x: 0.05,\n    y: 0.55,\n    width: 0.8,\n    height: 0.1\n  },\n  OTP_ENTER: {\n    x: 0.1,\n    y: 0.5,\n    width: 0.4,\n    height: 0.1\n  },\n  OTP_VERIFY: {\n    x: 0.1,\n    y: 0.4,\n    width: 0.5,\n    height: 0.1\n  },\n  TRANSACTION_VERIFY: {\n    x: 0.5,\n    y: 0.1,\n    width: 0.4,\n    height: 0.1\n  },\n  TRANSACTION_SUCCESS: {\n    x: 0.2,\n    y: 0.2,\n    width: 0.6,\n    height: 0.1\n  },\n  HOME_SCREEN: {\n    x: 0.02,\n    y: 0.55,\n    width: 0.5,\n    height: 0.1\n  },\n  ALBUM_SCREEN: {\n    x: 0.02,\n    y: 0.02,\n    width: 0.98,\n    height: 0.2\n  }\n}","import { config } from \"./config\";\n\n/**\n * Converts an object of coordinates to percentage coordinates\n * Converts normalized coordinates (0-1) to percentage coordinates (0-100)\n * @param coordinatesObj - Object containing coordinate objects with x and y properties\n * @returns Object with all coordinate values multiplied by 100\n */\nexport const scaleCoordinates = <\n\tT extends Record<string, { x: number; y: number }>\n>(coordinatesObj: T, factor: number = 100): T => {\n\treturn Object.fromEntries(\n\t\tObject.entries(coordinatesObj).map(([key, value]) => [\n\t\t\tkey,\n\t\t\t{\n\t\t\t\tx: Math.round(value.x * factor),\n\t\t\t\ty: Math.round(value.y * factor),\n\t\t\t},\n\t\t])\n\t) as T;\n}\n\n// iOS Keyboard Layout (normalized 0-1 coordinates)\n// These are approximate coordinates for iOS keyboard - may need adjustment per device\n// Layout: QWERTY keyboard, numbers row at top when in number mode\nconst HC_KEYBOARD_LAYOUT: Record<string, { x: number; y: number }> = {\n\t// Numbers (when keyboard is in number mode)\n\t'0': { x: 0.95, y: 0.68 },\n\t'1': { x: 0.05, y: 0.68 },\n\t'2': { x: 0.15, y: 0.68 },\n\t'3': { x: 0.25, y: 0.68 },\n\t'4': { x: 0.35, y: 0.68 },\n\t'5': { x: 0.45, y: 0.68 },\n\t'6': { x: 0.55, y: 0.68 },\n\t'7': { x: 0.65, y: 0.68 },\n\t'8': { x: 0.75, y: 0.68 },\n\t'9': { x: 0.85, y: 0.68 },\n\t'@': { x: 0.85, y: 0.78 },\n\t'!': { x: 0.65, y: 0.88 },\n\t// Letters (lowercase - iOS keyboard default)\n\t'a': { x: 0.1, y: 0.78 },\n\t'b': { x: 0.6, y: 0.88 },\n\t'c': { x: 0.4, y: 0.88 },\n\t'd': { x: 0.3, y: 0.78 },\n\t'e': { x: 0.25, y: 0.68 },\n\t'f': { x: 0.4, y: 0.78 },\n\t'g': { x: 0.5, y: 0.78 },\n\t'h': { x: 0.6, y: 0.78 },\n\t'i': { x: 0.75, y: 0.68 },\n\t'j': { x: 0.7, y: 0.78 },\n\t'k': { x: 0.8, y: 0.78 },\n\t'l': { x: 0.9, y: 0.78 },\n\t'm': { x: 0.8, y: 0.88 },\n\t'n': { x: 0.7, y: 0.88 },\n\t'o': { x: 0.85, y: 0.68 },\n\t'p': { x: 0.95, y: 0.68 },\n\t'q': { x: 0.05, y: 0.68 },\n\t'r': { x: 0.35, y: 0.68 },\n\t's': { x: 0.2, y: 0.78 },\n\t't': { x: 0.45, y: 0.68 },\n\t'u': { x: 0.65, y: 0.68 },\n\t'v': { x: 0.5, y: 0.88 },\n\t'w': { x: 0.15, y: 0.68 },\n\t'x': { x: 0.3, y: 0.88 },\n\t'y': { x: 0.55, y: 0.68 },\n\t'z': { x: 0.2, y: 0.88 },\n\t// Space key\n\t' ': { x: 0.55, y: 0.95 },\n};\n\n/**\n *  NUMPAD Layout (normalized 0-1 coordinates)\n * The keys are 0-9, and the coordinates are normalized 0-1\n * The keys are arranged in a 3x3 grid\n * */\nconst HC_NUMPAD_LAYOUT: Record<string, { x: number; y: number }> = {\n\t'0': { x: 0.55, y: 0.95 },\n\t'1': { x: 0.25, y: 0.7 },\n\t'2': { x: 0.55, y: 0.7 },\n\t'3': { x: 0.85, y: 0.7 },\n\t'4': { x: 0.25, y: 0.8 },\n\t'5': { x: 0.55, y: 0.8 },\n\t'6': { x: 0.85, y: 0.8 },\n\t'7': { x: 0.25, y: 0.9 },\n\t'8': { x: 0.55, y: 0.9 },\n\t'9': { x: 0.85, y: 0.9 },\n};\n\nconst HC_COMMON_COORDINATES = {\n\t// Keyboard mode switch button - Switch between letter and number keyboard\n\tKEYBOARD_SWITCH: {\n\t\tx: 0.05, // Left side of keyboard\n\t\ty: 0.95, // bottom area of keyboard\n\t},\n\t// Shift key (uppercase) - Press before typing uppercase letter\n\t// After typing one uppercase letter, keyboard automatically returns to lowercase\n\tSHIFT_KEY: {\n\t\tx: 0.05, // Left side of keyboard\n\t\ty: 0.88, // Bottom area of keyboard\n\t},\n\t// Return/Enter key - Sometimes to dismiss keyboard, sometimes to submit/enter\n\tRETURN_KEY: {\n\t\tx: 0.95, // Right side of keyboard\n\t\ty: 0.95, // Bottom area of keyboard\n\t},\n}\n\nconst PANDA_COMMON_COORDINATES = scaleCoordinates(\n\tHC_COMMON_COORDINATES\n);\n\nconst PANDA_NUMPAD_LAYOUT = scaleCoordinates(\n\tHC_NUMPAD_LAYOUT\n);\n\n/**\n * Export Constants\n * @description Export the constants for the keyboard\n * @returns The constants for the keyboard\n */\n\nexport const COMMON_COORDINATES = config.boxType === 'PANDA' ? PANDA_COMMON_COORDINATES : HC_COMMON_COORDINATES;\nexport const KEYBOARD_LAYOUT = HC_KEYBOARD_LAYOUT;\nexport const NUMPAD_LAYOUT = config.boxType === 'PANDA' ? PANDA_NUMPAD_LAYOUT : HC_NUMPAD_LAYOUT;","// ACB UI Element Coordinates (normalized 0-1)\n\nimport { config } from \"@/common/constants/config\";\nimport { scaleCoordinates } from \"@/common/constants/keyboard\";\n\n// These coordinates are estimates based on screen layout and may need adjustment\nconst HC_ACB_UI_COORDINATES = {\n  // Button \"NG NHP\" (Login button) - Large blue button at bottom\n  // Located in lower portion, above smaller buttons (Ly OTP, ng k, M QR)\n  LOGIN_BUTTON: {\n    x: 0.5,  // Center horizontally (button spans almost full width)\n    y: 0.8, // Adjusted based on actual screen - above \"Qun thng tin ng nhp?\" link\n  },\n  LOGIN_BUTTON_API: {\n    x: 0.5,  // Center horizontally (button spans almost full width)\n    y: 0.62, // Adjusted based on actual screen - above \"Qun thng tin ng nhp?\" link\n  },\n  // Password input field \"Mt khu\" - Text input field\n  // Located in the center of the screen, below user name\n  PASSWORD_FIELD: {\n    x: 0.5,  // Center horizontally\n    y: 0.45, // Center of screen (below user name, above login button) \n  },\n};\n\nconst PANDA_ACB_UI_COORDINATES = scaleCoordinates(HC_ACB_UI_COORDINATES);\n\nexport const ACB_UI_COORDINATES = config.boxType === 'PANDA' ? PANDA_ACB_UI_COORDINATES : HC_ACB_UI_COORDINATES;","import { Inject, Injectable } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { sleep } from '@/common/utils/time';\nimport { PG_UI_COORDINATES } from './constants/pgbank';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { PG_ROI_EXPECTED } from './constants/pg-roi';\nimport { BankCodeWithdrawal } from './constants/bank-code';\nimport { TelegramService } from '../notifiction/telegram.service';\n\n@Injectable()\nexport class PgService extends BaseBankService {\n  protected readonly BANK_CODE = 'PGBANK';\n  protected readonly BUNDLE_ID = 'pgbankApp.pgbank.com.vn';\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n    ocrService: OCRService,\n    private readonly telegramService: TelegramService\n  ) {\n    super(wsService, deviceService, ocrService);\n  }\n\n  private async inputPasswordFromConfig(deviceId: string): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.password) {\n      throw new Error(`Password not configured for device ${deviceId}`);\n    }\n    \n    // Click password field and wait for UI to be ready\n    await this.clickWithTransition(deviceId, PG_UI_COORDINATES.PASSWORD_FIELD.x, PG_UI_COORDINATES.PASSWORD_FIELD.y, 1500);\n\n    // Attempt to input password\n    await this.wsService.inputText(deviceId, config.password);\n    await sleep(1000);\n    \n    // Hide keyboard\n    await this.wsService.pressReturnKey(deviceId);\n  }\n\n  private async inputSmartOTPFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.smartOTP) {\n      throw new Error(`SmartOTP not configured for device ${deviceId}`);\n    }\n    \n    await sleep(2000);\n    await this.wsService.inputText(deviceId, config.smartOTP);\n  }\n\n  async launchApp(deviceId: string) {\n    await this.wsService.launchApp(deviceId, this.BUNDLE_ID);\n    const doesLaunchAppSuccess = await this.verifyScreenState(deviceId, {\n      expectedTexts: ['ng nhp'],\n      timeout: 10_000,\n      pollInterval: 500,\n      roi: PG_ROI_EXPECTED.LAUNCH_APP,\n      preprocess: {\n        // increase constrast for image recognition\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesLaunchAppSuccess) {\n      throw new WithdrawalProcessingError('Failed to launch PGBank app', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceId}] - Get login app screen`);\n    }\n  }\n\n  /**\n   * Login to PG bank\n   */\n  async login(deviceId: string): Promise<void> {\n    // Step 0: Kill app\n    await this.killApp(deviceId);\n    await sleep(1000);\n\n    // Step 1: Launch app\n    await this.launchApp(deviceId);\n    await sleep(1000);\n\n    // Step 2: Input password\n    await this.inputPasswordFromConfig(deviceId);\n\n    // Step 3: Click login button\n    const doesLoginSuccess = await this.clickAndWaitForScreen(deviceId,\n      PG_UI_COORDINATES.LOGIN_BTN.x,\n      PG_UI_COORDINATES.LOGIN_BTN.y,\n      {\n        expectedTexts: ['ti khon', 'chuyn tin', 'tit kim'],\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: PG_ROI_EXPECTED.HOME_SCREEN,\n      }\n    );\n\n    if (!doesLoginSuccess) {\n      this.telegramService.sendMessage({\n        text: ' Login Error'\n                 + `\\n\\n<b>Device:</b> ${deviceId}`\n                 + `\\n<b>Error:</b> Khng th ng nhp vo app PGBank.`,\n        options: {\n          parseMode: 'HTML'\n        }\n      });\n \n      throw new WithdrawalProcessingError('Failed to login to PGBank', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceId}] - Login successfully`);\n    }\n  }\n\n  async executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    \n    this.logger.log(`Executing PG transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceConfig.deviceId}`);\n    // Step 1: Click QR code button\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      PG_UI_COORDINATES.QR_CODE_BTN.x,\n      PG_UI_COORDINATES.QR_CODE_BTN.y,\n      5000\n    )\n    \n    // Step 2: Click image library button\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      PG_UI_COORDINATES.IMAGE_LIBRARY_BTN.x,\n      PG_UI_COORDINATES.IMAGE_LIBRARY_BTN.y,\n      3000\n    )\n\n    // Step 3: Click first image\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      PG_UI_COORDINATES.FIRST_IMAGE_BTN.x,\n      PG_UI_COORDINATES.FIRST_IMAGE_BTN.y,\n      2000\n    )\n\n    // Step 4: Verify account name\n    let verifiedAccountName = false;\n    if (withdrawal.bankCode === BankCodeWithdrawal.PGBANK) {\n      verifiedAccountName = await this.clickAndWaitForScreen(\n        deviceConfig.deviceId,\n        PG_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n        PG_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n        {\n          expectedTexts: [withdrawal.beneficiaryName],\n          timeout: 20_000,\n          pollInterval: 500,\n          preprocess: {\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      )\n    } else {\n      verifiedAccountName = await this.clickAndWaitForScreen(\n        deviceConfig.deviceId,\n        PG_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n        PG_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n        {\n          expectedTexts: [withdrawal.beneficiaryName],\n          timeout: 20_000,\n          pollInterval: 500,\n          roi: PG_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n          preprocess: {\n            grayscale: true,\n            enhanceContrast: true\n          }\n        }\n      )\n    }\n\n    if (!verifiedAccountName) {\n      throw new WithdrawalProcessingError('Choose wrong image qrcode', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Verified account name screen`);\n    }\n\n    // Step 4: Continue transaction and expect transaction confirm screen\n    const doesTransactionConfirm = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Xc nhn giao dch'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: PG_ROI_EXPECTED.TRANSACTION_CONFIRM,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    )\n\n    if (!doesTransactionConfirm) {\n      throw new WithdrawalProcessingError('Transaction confirm screen not found', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction confirm screen`);\n    }\n\n    // Step 5: Continue transaction and expect transaction verification\n    const doesTransactionCVerify = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      PG_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['Xc thc giao dch'],\n        timeout: 30_000,\n        pollInterval: 500, \n        roi: PG_ROI_EXPECTED.TRANSACTION_VERIFY,\n        preprocess: {\n          grayscale: true,\n          enhanceContrast: true\n        }\n      }\n    )\n\n    if (!doesTransactionCVerify) {\n      throw new WithdrawalProcessingError('Transaction verification screen not found', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verification screen`);\n    }\n\n    // Step 5: Enter OTP\n    await this.inputSmartOTPFromConfig(deviceConfig.deviceId);\n    const doesTransactionSuccess = await this.verifyScreenState(deviceConfig.deviceId,         {\n      expectedTexts: ['Chuyn tin thnh cng'],\n      timeout: 60_000,\n      pollInterval: 500,\n      roi: PG_ROI_EXPECTED.TRANSACTION_SUCCESS,\n      preprocess: {\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n    \n    if (!doesTransactionSuccess) {\n      throw new WithdrawalProcessingError('Transaction success screen not found', ErrorType.NO_BILL_AFTER_OTP);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction success screen`);\n    }\n    \n    // Step 6: Capture screen\n    await sleep(500);\n    await this.captureScreen(deviceConfig.deviceId, { folderPath: withdrawal.withdrawalCode });\n\n    // Step 7: Back to home\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      PG_UI_COORDINATES.BACK_TO_HOME.x,\n      PG_UI_COORDINATES.BACK_TO_HOME.y,\n      5000,\n      `[${deviceConfig.accountName}] - Get back to home screen`\n    );\n  }\n\n  /**\n   * Extract transaction amount t khung mu   cui mn hnh\n   * ROI da trn screenshot \"Kt qu giao dch\" ca PGBank\n   */\n  async extractTransactionAmount(imagePath: string): Promise<number | null> {\n    try {\n      const result = await this.ocrService.recognizeFromFile(imagePath, {\n        fieldType: 'singleLine',\n        customROI: {\n          x: 0.05,      // 5% from left (c margin nh)\n          y: 0.75,      // 75% from top (khong cui white card)\n          width: 0.9,   // 90% width (full width tr margin)\n          height: 0.12, // 12% height (  cha text + padding)\n        },\n        preprocess: {\n          grayscale: true,        // Chuyn sang grayscale\n          enhanceContrast: true,  // Tng contrast cho text trn nn \n        },\n      });\n\n      if (!result) {\n        this.logger.warn('Failed to extract transaction amount from ROI');\n        return null;\n      }\n\n      // Clean s tin: ch ly s v du phy/chm\n      const amountText = result.text.replace(/[^\\d.,]/g, '').replace(/,/g, '');\n      const amount = parseFloat(amountText);\n\n      if (isNaN(amount)) {\n        this.logger.warn(`Could not parse amount from OCR text: ${result.text}`);\n        return null;\n      }\n\n      this.logger.log(\n        `Extracted transaction amount: ${amount.toLocaleString('vi-VN')} VND ` +\n        `(confidence: ${result.confidence.toFixed(2)}%, time: ${result.processingTime}ms)`\n      );\n\n      return amount;\n    } catch (error) {\n      this.logger.error(`Error extracting transaction amount: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n\n  async onModuleInit() {\n\n// ROI cho khung mu  cha s tin giao dch ( cui mn hnh)\n// const ROIresult = await this.ocrService.recognizeFromFile('C:/temp/test.png', {\n//   fieldType: 'singleLine',\n//   customROI: {\n//     x: 0.05,      // 5% from left (c margin nh)\n//     y: 0.75,      // 75% from top (khong cui white card)\n//     width: 0.9,   // 90% width (full width tr margin)\n//     height: 0.12, // 12% height (  cha text + padding)\n//   },\n//   preprocess: {\n//     grayscale: true,        // Chuyn sang grayscale  tng  chnh xc\n//     enhanceContrast: true,  // Tng contrast cho text mu  trn nn \n//   },\n// });\n\n    \n    // await this.launchApp('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await sleep(5000);\n    // await this.login('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await this.executeExternalTransfer({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   beneficiaryAccountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // }, 'dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // const billImage = await this.analyzeTransferBill({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   accountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // });\n    // console.log(billImage);\n  }\n\n  onModuleDestroy(): void {\n    // this.killApp('590f1f9603f09330cf235485c6e76b10d0759a55');\n  }\n}\n\n","// HC PG UI Element Coordinates (normalized 0-1)\n\nimport { config } from \"@/common/constants/config\";\nimport { scaleCoordinates } from \"@/common/constants/keyboard\";\n\nconst HC_PG_UI_COORDINATES = {\n  LOGIN_BTN: {\n    x: 0.5,\n    y: 0.6,\n  },\n  PASSWORD_FIELD: {\n    x: 0.5,\n    y: 0.435,\n  },\n  TRANSFER_BTN: {\n    x: 0.7,\n    y: 0.7,\n  },\n  TRANSFER_INTERNAL_BTN: {\n    x: 0.2,\n    y: 0.2\n  },\n  TRANSFER_EXTERNAL_BTN: {\n    x: 0.4,\n    y: 0.2,\n  },\n  CLOSE_ALLOW_CONTACT_POPUP_BTN: {\n    x: 0.3,\n    y: 0.6,\n  },\n  ACCOUNT_NUMBER_INPUT: {\n    x: 0.4,\n    y: 0.43,\n  },\n  SELECT_BANK_BTN: {\n    x: 0.4,\n    y: 0.47,\n  },\n  SEARCH_BANK_BTN: {\n    x: 0.4,\n    y: 0.48,\n  },\n  INTERNAL_AMOUNT_INPUT: {\n    x: 0.5,\n    y: 0.6,\n  },\n  HIDE_NUMPAD_BTN: {\n    x: 0.05,\n    y: 0.4,\n  },\n  CONTINUE_TRANSFER_BTN: {\n    x: 0.5,\n    y: 0.9,\n  },\n  BANK_SEARCH_BTN: {\n    x: 0.4,\n    y: 0.45,\n  },\n  BANK_SEARCH_INPUT: {\n    x: 0.4,\n    y: 0.45,\n  },\n  EXTERNAL_AMOUNT_INPUT: {\n    x: 0.3,\n    y: 0.37,\n  },\n  BACK_TO_HOME: {\n    x: 0.2,\n    y: 0.9,\n  },\n  QR_CODE_BTN: {\n    x: 0.2,\n    y: 0.9,\n  },\n  IMAGE_LIBRARY_BTN: {  \n    x: 0.8,\n    y: 0.9,\n  },\n  FIRST_IMAGE_BTN: {  \n    x: 0.3,\n    y: 0.3,\n  },\n  SELECT_IMAGE_QR_CODE_BTN: {  \n    x: 0.95,\n    y: 0.95,\n  },\n  HOME_ICON_HEADER: {  \n    x: 0.95,\n    y: 0.05,\n  },\n};\n\nconst PANDA_PG_UI_COORDINATES = scaleCoordinates(HC_PG_UI_COORDINATES);\n\nexport const PG_UI_COORDINATES = config.boxType === 'PANDA' ? PANDA_PG_UI_COORDINATES : HC_PG_UI_COORDINATES;","/**\n * Error types for withdrawal processing\n */\nexport enum ErrorType {\n  TEMPORARY = 'TEMPORARY',    // C th retry (session, network, device busy)\n  PERMANENT = 'PERMANENT', // Khng nn retry (invalid data, insufficient funds)\n  FORCE_LOGIN = 'FORCE_LOGIN', // Force login again,\n  NO_BILL_AFTER_OTP = 'NO_BILL_AFTER_OTP', // No bill image found after OTP\n}\n\n/**\n * Custom error for withdrawal processing with error type classification\n */\nexport class WithdrawalProcessingError extends Error {\n  constructor(\n    message: string,\n    public readonly errorType: ErrorType\n  ) {\n    super(message);\n    this.name = 'WithdrawalProcessingError';\n\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\n","export enum BankCodeWithdrawal {\n  VIETCOMBANK = 'VIETCOMBANK',\n  AGRIBANK = 'AGRIBANK',\n  BIDV = 'BIDV',\n  SACOMBANK = 'SACOMBANK',\n  TECHCOMBANK = 'TECHCOMBANK',\n  TPBANK = 'TPBANK',\n  HDBank = 'HDBank',\n  VPBANK = 'VPBANK',\n  MBBANK = 'MBBANK',\n  MSB = 'MSB',\n  LPBANK = 'LPBANK',\n  ACB = 'ACB',\n  ABBANK = 'ABBANK',\n  NCB = 'NCB',\n  EXIMBANK = 'EXIMBANK',\n  SEABANK = 'SEABANK',\n  SCB = 'SCB',\n  PVCOMBANK = 'PVCOMBANK',\n  KIENLONGBANK = 'KIENLONGBANK',\n  BVBANK = 'BVBANK', // Vietcapitalbank\n  VIETINBANK = 'VIETINBANK',\n  OCB = 'OCB',\n  VIETBANK = 'VIETBANK',\n  SHB = 'SHB',\n  NAMABANK = 'NAMABANK',\n  SHINHANBANKVIETNAM = 'SHINHANBANKVIETNAM',\n  CIMB = 'CIMB',\n  SAIGONBANK = 'SAIGONBANK',\n  BACABANK = 'BACABANK',\n  VIETABANK = 'VIETABANK',\n  GPBANK = 'GPBANK',\n  HSBC = 'HSBC',\n  VRB = 'VRB',\n  VIB = 'VIB',\n  PGBANK = 'PGBANK',\n}","import { sleep } from '@/common/utils/time';\nimport { Injectable, Logger } from '@nestjs/common';\nimport axios, { AxiosInstance } from 'axios';\nimport FormData from 'form-data';\nimport { createReadStream } from 'fs';\nimport { resolve } from 'path';\n\ntype TelegramChatId = string | number;\n\ninterface TelegramSendMessageOptions {\n  parseMode?: 'Markdown' | 'MarkdownV2' | 'HTML';\n  disableWebPagePreview?: boolean;\n  disableNotification?: boolean;\n  replyToMessageId?: number;\n}\n\ninterface TelegramSendPhotoOptions {\n  caption?: string;\n  parseMode?: 'Markdown' | 'MarkdownV2' | 'HTML';\n  disableNotification?: boolean;\n}\n\n@Injectable()\nexport class TelegramService {\n  private readonly logger = new Logger(TelegramService.name);\n  private readonly http: AxiosInstance;\n\n  private readonly token = '8514906447:AAGFB2Fsl21IeF1tJvt8y6UsuoyNCIVcwCE';\n  private readonly defaultChatId: TelegramChatId = '-5288197652';\n  private readonly baseUrl = 'https://api.telegram.org';\n\n  constructor() {\n    this.http = axios.create({\n      baseURL: `${this.baseUrl}/bot${this.token}`,\n      timeout: 15_000,\n      // validateStatus: () => true, // bt nu bn mun t handle mi status\n    });\n  }\n\n  // ---------- Public API ----------\n\n  async sendMessage(\n    params: {\n      text: string,\n      chatId?: TelegramChatId,\n      options: TelegramSendMessageOptions,\n    }): Promise<void> {\n    const { text, chatId, options = {} } = params;\n    const parsedChatId = chatId ?? this.mustDefaultChatId();\n\n    this.requestWithRetry('/sendMessage', {\n      chat_id: parsedChatId,\n      text,\n      parse_mode: options.parseMode ?? 'HTML',\n      disable_web_page_preview: options.disableWebPagePreview ?? false,\n      disable_notification: options.disableNotification ?? false,\n      reply_to_message_id: options.replyToMessageId ?? undefined,\n    }).catch((error) => {\n      this.logger.error('Error sending telegram message', error.stack);\n    });\n  }\n\n  async sendPhotoByUrl(\n    photoUrl: string,\n    chatId: TelegramChatId = this.mustDefaultChatId(),\n    options: TelegramSendPhotoOptions = {},\n  ): Promise<void> {\n    await this.requestWithRetry('/sendPhoto', {\n      chat_id: chatId,\n      photo: photoUrl,\n      caption: options.caption,\n      parse_mode: options.parseMode,\n      disable_notification: options.disableNotification,\n    });\n  }\n\n  async sendPhotoByFile(\n    filePath: string,\n    chatId: TelegramChatId = this.mustDefaultChatId(),\n    options: TelegramSendPhotoOptions = {},\n  ): Promise<void> {\n    try {\n      const stream = createReadStream(filePath);\n      const form = new FormData();\n      form.append('chat_id', String(chatId));\n      form.append('photo', stream);\n      if (options.caption) form.append('caption', options.caption);\n      if (options.parseMode) form.append('parse_mode', options.parseMode);\n      if (options.disableNotification !== undefined) {\n        form.append('disable_notification', String(options.disableNotification));\n      }\n  \n      await this.requestFormWithRetry('/sendPhoto', form);\n    } catch (error) {\n      this.logger.error(`Error sending photo by file: ${error.message}`);\n    }\n  }\n\n  async sendPhotoByBuffer(\n    buffer: Buffer,\n    filename = 'image.png',\n    mimeType = 'image/png',\n    chatId: TelegramChatId = this.mustDefaultChatId(),\n    options: TelegramSendPhotoOptions = {},\n  ): Promise<void> {\n    const form = new FormData();\n    form.append('chat_id', String(chatId));\n    form.append('photo', buffer, { filename, contentType: mimeType });\n    if (options.caption) form.append('caption', options.caption);\n    if (options.parseMode) form.append('parse_mode', options.parseMode);\n    if (options.disableNotification !== undefined) {\n      form.append('disable_notification', String(options.disableNotification));\n    }\n\n    this.requestFormWithRetry('/sendPhoto', form)\n      .catch((error) => {\n        this.logger.error('Error sending telegram photo', error.stack);\n      });\n  }\n\n  async sendPhotoByBase64(\n    base64: string,\n    filename = 'image.png',\n    mimeType = 'image/png',\n    chatId: TelegramChatId = this.mustDefaultChatId(),\n    options: TelegramSendPhotoOptions = {},\n  ): Promise<void> {\n    const cleaned = this.stripBase64Prefix(base64);\n    const buffer = Buffer.from(cleaned, 'base64');\n    await this.sendPhotoByBuffer(buffer, filename, mimeType, chatId, options);\n  }\n\n  // ---------- Internal helpers ----------\n\n  private mustDefaultChatId(): TelegramChatId {\n    if (!this.defaultChatId) {\n      throw new Error('TELEGRAM_DEFAULT_CHAT_ID is missing and no chatId was provided.');\n    }\n    return this.defaultChatId;\n  }\n\n  private stripBase64Prefix(input: string): string {\n    // Handles \"data:image/png;base64,....\"\n    const idx = input.indexOf('base64,');\n    return idx >= 0 ? input.slice(idx + 'base64,'.length) : input;\n  }\n\n  private async requestWithRetry(path: string, payload: Record<string, any>, retry = 2): Promise<void> {\n    try {\n      const res = await this.http.post(path, payload);\n\n      // Telegram tr ok=false khi li logic\n      if (!res.data?.ok) {\n        const desc = res.data?.description ?? 'Unknown Telegram error';\n        throw new Error(`Telegram API error: ${desc}`);\n      }\n    } catch (err: any) {\n      if (retry > 0 && this.isRetryable(err)) {\n        const waitMs = this.backoffMs(retry);\n        this.logger.warn(`Telegram request failed, retrying in ${waitMs}ms: ${this.safeErr(err)}`);\n        await sleep(waitMs);\n        return this.requestWithRetry(path, payload, retry - 1);\n      }\n\n      this.logger.error(`Telegram request failed: ${this.safeErr(err)}`);\n      throw err;\n    }\n  }\n\n  private async requestFormWithRetry(path: string, form: FormData, retry = 2): Promise<void> {\n    try {\n      const res = await this.http.post(path, form, {\n        headers: form.getHeaders(),\n        maxBodyLength: Infinity,\n        maxContentLength: Infinity,\n      });\n\n      if (!res.data?.ok) {\n        const desc = res.data?.description ?? 'Unknown Telegram error';\n        throw new Error(`Telegram API error: ${desc}`);\n      }\n    } catch (err: any) {\n      if (retry > 0 && this.isRetryable(err)) {\n        const waitMs = this.backoffMs(retry);\n        this.logger.warn(`Telegram form request failed, retrying in ${waitMs}ms: ${this.safeErr(err)}`);\n        await sleep(waitMs);\n        return this.requestFormWithRetry(path, form, retry - 1);\n      }\n\n      this.logger.error(`Telegram form request failed: ${this.safeErr(err)}`);\n    }\n  }\n\n  private isRetryable(err: any): boolean {\n    // network / timeout / 5xx\n    const code = err?.code;\n    const status = err?.response?.status;\n\n    if (code === 'ECONNABORTED') return true; // timeout\n    if (status >= 500 && status <= 599) return true;\n    if (!status && (code === 'ENOTFOUND' || code === 'ECONNRESET' || code === 'EAI_AGAIN')) return true;\n\n    return false;\n  }\n\n  private backoffMs(retryLeft: number): number {\n    // retryLeft: 2 -> 400ms, 1 -> 800ms\n    const step = (2 - retryLeft) + 1;\n    return 400 * step;\n  }\n\n  private safeErr(err: any): string {\n    const status = err?.response?.status;\n    const desc = err?.response?.data?.description;\n    const msg = err?.message;\n    return [status ? `status=${status}` : '', desc ? `desc=${desc}` : '', msg ? `msg=${msg}` : '']\n      .filter(Boolean)\n      .join(' | ');\n  }\n}\n","module.exports = require(\"axios\");","module.exports = require(\"form-data\");","import { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { IPandaSwipeOptions, IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\nimport { Inject, Injectable } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\n\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { BankCodeWithdrawal } from './constants/bank-code';\nimport { HD_UI_COORDINATES } from './constants/hdbank';\nimport { HD_ROI_EXPECTED } from './constants/hd-roi';\nimport { PandaSwipeType, PandaSwipeTypeEnum } from './constants/pandaSwipType';\n\n@Injectable()\nexport class HdBankService extends BaseBankService {\n  protected readonly BANK_CODE = 'HDBANK';\n  protected readonly BUNDLE_ID = 'com.vnpay.HDBank';\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n    ocrService: OCRService\n  ) {\n    super(wsService, deviceService, ocrService);\n  }\n\n  private async inputPasswordFromConfig(deviceId: string): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.password) {\n      throw new Error(`Password not configured for device ${deviceId}`);\n    }\n    \n    // Click password field and wait for UI to be ready\n    await this.clickWithTransition(deviceId, HD_UI_COORDINATES.PASSWORD_FIELD.x, HD_UI_COORDINATES.PASSWORD_FIELD.y, 1500);\n\n    // Attempt to input password\n    await this.wsService.inputText(deviceId, config.password);\n    await sleep(1000);\n\n  }\n\n  private async inputSmartOTPFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.smartOTP) {\n      throw new Error(`SmartOTP not configured for device ${deviceId}`);\n    }\n    \n    await sleep(500);\n    await this.wsService.inputText(deviceId, config.smartOTP);\n  }\n\n  async launchApp(deviceId: string) {\n    await this.wsService.launchApp(deviceId, this.BUNDLE_ID);\n    const doesLaunchAppSuccess = await this.verifyScreenState(deviceId, {\n      expectedTexts: ['ng nhp'],\n      timeout: 10_000,\n      pollInterval: 500,\n      roi: HD_ROI_EXPECTED.LAUNCH_APP,\n      preprocess: {\n        // increase constrast for image recognition\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesLaunchAppSuccess) {\n      throw new WithdrawalProcessingError('Failed to launch PGBank app', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceId}] - Get login app screen`);\n    }\n  }\n\n  /**\n   * Login to PG bank\n   */\n  async login(deviceId: string): Promise<void> {\n    // Step 0: Kill app\n    await this.killApp(deviceId);\n    await sleep(2000);\n\n    // Step 1: Launch app\n    await this.launchApp(deviceId);\n\n    // Step 2: Input password\n    await this.inputPasswordFromConfig(deviceId);\n\n    // Step 3: Click login button\n    const doesLoginSuccess = await this.clickAndWaitForScreen(deviceId,\n      HD_UI_COORDINATES.LOGIN_BTN.x,\n      HD_UI_COORDINATES.LOGIN_BTN.y,\n      {\n        expectedTexts: ['ti khon', 'chuyn khon'],\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.HOME_SCREEN,\n      }\n    );\n\n    if (!doesLoginSuccess) {\n      throw new WithdrawalProcessingError('Failed to login to PGBank', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceId}] - Login successfully`);\n    }\n  }\n\n  async executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    this.logger.log(`Executing HDBank transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceConfig.deviceId}`);\n\n    // Step 1: Click QR code button\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.QR_CODE_BTN.x,\n      HD_UI_COORDINATES.QR_CODE_BTN.y,\n      3000\n    )\n\n    await sleep(2000)\n\n    const doesClickImageLibrarySuccess = await this.clickAndWaitForScreen(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.IMAGE_LIBRARY_BTN.x,\n      HD_UI_COORDINATES.IMAGE_LIBRARY_BTN.y,\n      {\n        expectedTexts: ['nh', 'Album'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: HD_ROI_EXPECTED.ALBUM_SCREEN,\n      }\n    )\n\n    if (!doesClickImageLibrarySuccess) {\n      throw new WithdrawalProcessingError('Failed to click image library button', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get image library screen`);\n    }\n    \n\n    // Step 3: Click first image\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.FIRST_IMAGE_BTN.x,\n      HD_UI_COORDINATES.FIRST_IMAGE_BTN.y,\n      2000\n    )\n\n    // Step 4: Verify account name\n    let verifiedAccount = false;\n    if (withdrawal.bankCode === BankCodeWithdrawal.HDBank) {\n      verifiedAccount = await this.clickAndWaitForScreen(\n        deviceConfig.deviceId,\n        HD_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n        HD_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n        {\n          expectedTexts: [withdrawal.beneficiaryAccountNo],\n          timeout: 30_000,\n          pollInterval: 500,\n          roi: HD_ROI_EXPECTED.VERIFY_ACCOUNT_NUMBER,\n        }\n      )\n    } else {\n      verifiedAccount = await this.clickAndWaitForScreen(\n        deviceConfig.deviceId,\n        HD_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n        HD_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n        {\n          expectedTexts: [withdrawal.beneficiaryName],\n          timeout: 30_000,\n          pollInterval: 500,\n          roi: HD_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n        }\n      )\n    }\n\n    if (!verifiedAccount) {\n      await this.clickWithTransition(deviceConfig.deviceId, HD_UI_COORDINATES.HOME_ICON.x, HD_UI_COORDINATES.HOME_ICON.y, 2000);\n      throw new WithdrawalProcessingError('Choose wrong image qrcode', ErrorType.TEMPORARY);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Verified account name screen`);\n    }\n\n    await sleep(500);\n    const doesSwipeSuccess = await this.swipeAndWaitForScreen(deviceConfig.deviceId, {type: PandaSwipeTypeEnum.SWIPE_UP}, {\n      expectedTexts: ['Tip tc'],\n      timeout: 10_000,\n      pollInterval: 500, \n      roi: HD_ROI_EXPECTED.SWIPE_UP_SCREEN,\n    });\n    if (!doesSwipeSuccess) {\n      throw new WithdrawalProcessingError('Swipe up failed', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Swipe up screen`);\n    }\n\n    // Step 5: Continue transaction and expect transaction verification\n    const doesTransactionOTPEnter = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['nhp m PIN'],\n        timeout: 30_000,\n        pollInterval: 500, \n        roi: HD_ROI_EXPECTED.OTP_ENTER,\n      }\n    )\n\n    if (!doesTransactionOTPEnter) {\n      throw new WithdrawalProcessingError('Transaction verification screen not found', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verification screen`);\n    }\n\n    // Step 5: Enter OTP\n    await this.inputSmartOTPFromConfig(deviceConfig.deviceId);\n\n    const doesTransactionVerifySuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['khu giao dch'],\n        timeout: 30_000,\n        pollInterval: 500, \n        roi: HD_ROI_EXPECTED.TRANSACTION_VERIFY,\n      }\n    )\n    \n    \n    if (!doesTransactionVerifySuccess) {\n      throw new WithdrawalProcessingError('Transaction verify screen not found', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n    }\n\n    const doesTransactionSuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      HD_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['GIAO DCH THNH CNG'],\n        timeout: 30_000,\n        pollInterval: 500, \n        roi: HD_ROI_EXPECTED.TRANSACTION_SUCCESS,\n        preprocess: {\n          // increase constrast for image recognition\n          grayscale: true,\n          enhanceContrast: true\n        }\n\n      }\n    )\n    \n    if (!doesTransactionSuccess) {\n      throw new WithdrawalProcessingError('Transaction verify screen not found', ErrorType.NO_BILL_AFTER_OTP);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n    }\n\n\n    \n    // Step 6: Capture screen\n    await sleep(500);\n    await this.captureScreen(deviceConfig.deviceId, { folderPath: withdrawal.withdrawalCode });\n\n    // Step 7: Back to home\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      HD_UI_COORDINATES.BACK_TO_HOME.x,\n      HD_UI_COORDINATES.BACK_TO_HOME.y,\n      5000,\n      `[${deviceConfig.accountName}] - Get back to home screen`\n    );\n  }\n\n  /**\n   * Extract transaction amount t khung mu   cui mn hnh\n   * ROI da trn screenshot \"Kt qu giao dch\" ca PGBank\n   */\n  async extractTransactionAmount(imagePath: string): Promise<number | null> {\n    try {\n      const result = await this.ocrService.recognizeFromFile(imagePath, {\n        fieldType: 'singleLine',\n        customROI: {\n          x: 0.05,      // 5% from left (c margin nh)\n          y: 0.75,      // 75% from top (khong cui white card)\n          width: 0.9,   // 90% width (full width tr margin)\n          height: 0.12, // 12% height (  cha text + padding)\n        },\n        preprocess: {\n          grayscale: true,        // Chuyn sang grayscale\n          enhanceContrast: true,  // Tng contrast cho text trn nn \n        },\n      });\n\n      if (!result) {\n        this.logger.warn('Failed to extract transaction amount from ROI');\n        return null;\n      }\n\n      // Clean s tin: ch ly s v du phy/chm\n      const amountText = result.text.replace(/[^\\d.,]/g, '').replace(/,/g, '');\n      const amount = parseFloat(amountText);\n\n      if (isNaN(amount)) {\n        this.logger.warn(`Could not parse amount from OCR text: ${result.text}`);\n        return null;\n      }\n\n      this.logger.log(\n        `Extracted transaction amount: ${amount.toLocaleString('vi-VN')} VND ` +\n        `(confidence: ${result.confidence.toFixed(2)}%, time: ${result.processingTime}ms)`\n      );\n\n      return amount;\n    } catch (error) {\n      this.logger.error(`Error extracting transaction amount: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n\n  async onModuleInit() {\n\n// ROI cho khung mu  cha s tin giao dch ( cui mn hnh)\n// const ROIresult = await this.ocrService.recognizeFromFile('C:/temp/test.png', {\n//   fieldType: 'singleLine',\n//   customROI: {\n//     x: 0.05,      // 5% from left (c margin nh)\n//     y: 0.75,      // 75% from top (khong cui white card)\n//     width: 0.9,   // 90% width (full width tr margin)\n//     height: 0.12, // 12% height (  cha text + padding)\n//   },\n//   preprocess: {\n//     grayscale: true,        // Chuyn sang grayscale  tng  chnh xc\n//     enhanceContrast: true,  // Tng contrast cho text mu  trn nn \n//   },\n// });\n\n    \n    // await this.launchApp('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await sleep(5000);\n    // await this.login('dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // await this.executeExternalTransfer({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   beneficiaryAccountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // }, 'dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // const billImage = await this.analyzeTransferBill({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   accountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // });\n    // console.log(billImage);\n  }\n\n  onModuleDestroy(): void {\n    // this.killApp('590f1f9603f09330cf235485c6e76b10d0759a55');\n  }\n}\n\n","// HC PG UI Element Coordinates (normalized 0-1)\n\nimport { config } from \"@/common/constants/config\";\nimport { scaleCoordinates } from \"@/common/constants/keyboard\";\n\nconst HC_HD_UI_COORDINATES = {\n  LOGIN_BTN: {\n    x: 0.5,\n    y: 0.6,\n  },\n  PASSWORD_FIELD: {\n    x: 0.5,\n    y: 0.5,\n  },\n  TRANSFER_BTN: {\n    x: 0.7,\n    y: 0.7,\n  },\n  TRANSFER_INTERNAL_BTN: {\n    x: 0.2,\n    y: 0.2\n  },\n  TRANSFER_EXTERNAL_BTN: {\n    x: 0.4,\n    y: 0.2,\n  },\n  CLOSE_ALLOW_CONTACT_POPUP_BTN: {\n    x: 0.3,\n    y: 0.6,\n  },\n  ACCOUNT_NUMBER_INPUT: {\n    x: 0.4,\n    y: 0.43,\n  },\n  SELECT_BANK_BTN: {\n    x: 0.4,\n    y: 0.47,\n  },\n  SEARCH_BANK_BTN: {\n    x: 0.4,\n    y: 0.48,\n  },\n  INTERNAL_AMOUNT_INPUT: {\n    x: 0.5,\n    y: 0.6,\n  },\n  HIDE_NUMPAD_BTN: {\n    x: 0.05,\n    y: 0.4,\n  },\n  CONTINUE_TRANSFER_BTN: {\n    x: 0.5,\n    y: 0.85,\n  },\n  BANK_SEARCH_BTN: {\n    x: 0.4,\n    y: 0.45,\n  },\n  BANK_SEARCH_INPUT: {\n    x: 0.4,\n    y: 0.45,\n  },\n  EXTERNAL_AMOUNT_INPUT: {\n    x: 0.3,\n    y: 0.37,\n  },\n  BACK_TO_HOME: {\n    x: 0.2,\n    y: 0.9,\n  },\n  QR_CODE_BTN: {\n    x: 0.5,\n    y: 0.95,\n  },\n  IMAGE_LIBRARY_BTN: {  \n    x: 0.5,\n    y: 0.85,\n  },\n  FIRST_IMAGE_BTN: {  \n    x: 0.3,\n    y: 0.3,\n  },\n  SELECT_IMAGE_QR_CODE_BTN: {  \n    x: 0.95,\n    y: 0.95,\n  },\n  HOME_ICON: {  \n    x: 0.11,\n    y: 0.94,\n  },\n};\n\nconst PANDA_HD_UI_COORDINATES = scaleCoordinates(HC_HD_UI_COORDINATES);\n\nexport const HD_UI_COORDINATES = config.boxType === 'PANDA' ? PANDA_HD_UI_COORDINATES : HC_HD_UI_COORDINATES;","export type PandaSwipeType = '0' | '1' | '2' | '4' | '5' | '6' | '7' | '8' | '9' | '10';\nexport enum PandaSwipeTypeEnum {\n  SWIPE_UP = '6',\n  SWIPE_DOWN = '7',\n  SWIPE_LEFT = '8',\n  SWIPE_RIGHT = '9',\n}","import { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\nimport { Inject, Injectable } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { DeviceService } from '../device/device.service';\nimport { BaseBankService } from './base/base-bank.service';\n\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { OCRService } from '../ocr/services/ocr.service';\nimport { ErrorType, WithdrawalProcessingError } from '../withdrawal/withdrawal-errors';\nimport { BankCodeWithdrawal } from './constants/bank-code';\nimport { VCB_ROI_EXPECTED } from './constants/vcb-roi';\nimport { VCB_UI_COORDINATES } from './constants/vietcombank';\nimport { PandaSwipeTypeEnum } from './constants/pandaSwipType';\n\n@Injectable()\nexport class VietcombankService extends BaseBankService {\n  protected readonly BANK_CODE = 'VIETCOMBANK';\n  protected readonly BUNDLE_ID = 'com.vcb.VCB';\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    deviceService: DeviceService,\n    ocrService: OCRService\n  ) {\n    super(wsService, deviceService, ocrService);\n  }\n\n  private async inputPasswordFromConfig(deviceId: string): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.password) {\n      throw new Error(`Password not configured for device ${deviceId}`);\n    }\n    \n    // Click password field and wait for UI to be ready\n    await this.clickWithTransition(deviceId, VCB_UI_COORDINATES.PASSWORD_FIELD.x, VCB_UI_COORDINATES.PASSWORD_FIELD.y, 1500);\n\n    // Attempt to input password\n    await this.wsService.inputText(deviceId, config.password);\n    await sleep(1000);\n    await this.wsService.pressReturnKey(deviceId);\n    await sleep(500);\n  }\n\n  private async inputSmartOTPFromConfig(deviceId: string, maxRetries: number = 3): Promise<void> {\n    const config = await this.deviceService.getDeviceConfig(deviceId);\n    if (!config || !config.smartOTP) {\n      throw new Error(`SmartOTP not configured for device ${deviceId}`);\n    }\n    \n    await sleep(500);\n    await this.wsService.inputText(deviceId, config.smartOTP);\n  }\n\n  async launchApp(deviceId: string) {\n    await this.wsService.launchApp(deviceId, this.BUNDLE_ID);\n    const doesLaunchAppSuccess = await this.verifyScreenState(deviceId, {\n      expectedTexts: ['ng nhp'],\n      timeout: 10_000,\n      pollInterval: 500,\n      roi: VCB_ROI_EXPECTED.LAUNCH_APP,\n      preprocess: {\n        // increase constrast for image recognition\n        grayscale: true,\n        enhanceContrast: true\n      }\n    });\n\n    if (!doesLaunchAppSuccess) {\n      throw new WithdrawalProcessingError('Failed to launch VIETCOMBANK app', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceId}] - Get login app screen`);\n    }\n  }\n\n  /**\n   * Login to PG bank\n   */\n  async login(deviceId: string): Promise<void> {\n    // Step 0: Kill app\n    await this.killApp(deviceId);\n    await sleep(2000);\n\n    // Step 1: Launch app\n    await this.launchApp(deviceId);\n\n    await this.verifyScreenState(deviceId, {\n      expectedTexts: ['ng nhp'],\n      timeout: 20_000,\n      pollInterval: 500,\n      roi: VCB_ROI_EXPECTED.LAUNCH_APP,\n    });\n\n    // Step 2: Input password\n    await this.inputPasswordFromConfig(deviceId);\n\n    // Step 3: Click login button\n    const doesLoginSuccess = await this.clickAndWaitForScreen(deviceId,\n      VCB_UI_COORDINATES.LOGIN_BTN.x,\n      VCB_UI_COORDINATES.LOGIN_BTN.y,\n      {\n        expectedTexts: ['Chc nng a thch'],\n        timeout: 20_000,\n        pollInterval: 500,\n        roi: VCB_ROI_EXPECTED.HOME_SCREEN,\n      }\n    );\n\n    if (!doesLoginSuccess) {\n      throw new WithdrawalProcessingError('Failed to login to VIETCOMBANK', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceId}] - Login successfully`);\n    }\n  }\n\n  async executeTransferWithQRCode(withdrawal: Withdrawal, deviceConfig: DeviceConfig): Promise<void> {\n    this.logger.log(`Executing VIETCOMBANK transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceConfig.deviceId}`);\n\n    // Step 1: Click QR code button\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      VCB_UI_COORDINATES.QR_CODE_BTN.x,\n      VCB_UI_COORDINATES.QR_CODE_BTN.y,\n      3000\n    )\n\n    await sleep(2000)\n\n    const doesClickImageLibrarySuccess = await this.clickAndWaitForScreen(\n      deviceConfig.deviceId,\n      VCB_UI_COORDINATES.IMAGE_LIBRARY_BTN.x,\n      VCB_UI_COORDINATES.IMAGE_LIBRARY_BTN.y,\n      {\n        expectedTexts: ['nh', 'Album'],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: VCB_ROI_EXPECTED.ALBUM_SCREEN,\n      }\n    )\n\n    if (!doesClickImageLibrarySuccess) {\n      throw new WithdrawalProcessingError('Failed to click image library button', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get image library screen`);\n    }\n    \n\n    // Step 3: Click first image\n    const verifiedAccount = await this.clickAndWaitForScreen(\n      deviceConfig.deviceId,\n      VCB_UI_COORDINATES.FIRST_IMAGE_BTN.x,\n      VCB_UI_COORDINATES.FIRST_IMAGE_BTN.y,\n      {\n        expectedTexts: [withdrawal.beneficiaryName],\n        timeout: 30_000,\n        pollInterval: 500,\n        roi: VCB_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n      }\n    )\n\n    // Step 4: Verify account name\n    // let verifiedAccount = false;\n    // if (withdrawal.bankCode === BankCodeWithdrawal.VIETCOMBANK) {\n    //   verifiedAccount = await this.clickAndWaitForScreen(\n    //     deviceConfig.deviceId,\n    //     VCB_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n    //     VCB_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n    //     {\n    //       expectedTexts: [withdrawal.beneficiaryAccountNo],\n    //       timeout: 30_000,\n    //       pollInterval: 500,\n    //       roi: VCB_ROI_EXPECTED.VERIFY_ACCOUNT_NUMBER,\n    //     }\n    //   )\n    // } else {\n    //   verifiedAccount = await this.clickAndWaitForScreen(\n    //     deviceConfig.deviceId,\n    //     VCB_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.x,\n    //     VCB_UI_COORDINATES.SELECT_IMAGE_QR_CODE_BTN.y,\n    //     {\n    //       expectedTexts: [withdrawal.beneficiaryName],\n    //       timeout: 30_000,\n    //       pollInterval: 500,\n    //       roi: VCB_ROI_EXPECTED.VERIFY_ACCOUNT_NAME,\n    //     }\n    //   )\n    // }\n\n    if (!verifiedAccount) {\n      await this.clickWithTransition(deviceConfig.deviceId, VCB_UI_COORDINATES.HOME_ICON.x, VCB_UI_COORDINATES.HOME_ICON.y, 2000);\n      throw new WithdrawalProcessingError('Choose wrong image qrcode', ErrorType.TEMPORARY);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Verified account name screen`);\n    }\n\n    // await this.wsService.swipe(deviceConfig.deviceId, {type: PandaSwipeTypeEnum.SWIPE_UP});\n\n    // Step 5: Continue transaction and expect transaction verification\n    const doesTransactionVerify = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      VCB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      VCB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['kim tra v xc nhn'],\n        timeout: 30_000,\n        pollInterval: 500, \n        roi: VCB_ROI_EXPECTED.TRANSACTION_VERIFY,\n      }\n    )\n\n    if (!doesTransactionVerify) {\n      throw new WithdrawalProcessingError('Transaction verification screen not found', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verification screen`);\n    }\n\n\n    const doesOTPEnterSuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      VCB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.x,\n      VCB_UI_COORDINATES.CONTINUE_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['smart OTP'],\n        timeout: 30_000,\n        pollInterval: 500, \n        roi: VCB_ROI_EXPECTED.OTP_ENTER,\n      }\n    )\n    \n    \n    if (!doesOTPEnterSuccess) {\n      throw new WithdrawalProcessingError('Transaction verify screen not found', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n    }\n        // Step 5: Enter OTP\n    await this.inputSmartOTPFromConfig(deviceConfig.deviceId);\n    await sleep(500);\n\n    const doesOTPVerifySuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      VCB_UI_COORDINATES.OTP_ENTER_TRANSFER_BTN.x,\n      VCB_UI_COORDINATES.OTP_ENTER_TRANSFER_BTN.y,\n      {\n        expectedTexts: ['M xc thc giao dch'],\n        timeout: 30_000,\n        pollInterval: 500, \n        roi: VCB_ROI_EXPECTED.OTP_VERIFY,\n      }\n    )\n    \n    \n    if (!doesOTPVerifySuccess) {\n      throw new WithdrawalProcessingError('Transaction verify screen not found', ErrorType.FORCE_LOGIN);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction verify screen`);\n    }\n\n    const doesTransactionSuccess = await this.clickAndWaitForScreen(deviceConfig.deviceId,\n      VCB_UI_COORDINATES.CONTINUE_OTP_VERIFY_BTN.x,\n      VCB_UI_COORDINATES.CONTINUE_OTP_VERIFY_BTN.y,\n      {\n        expectedTexts: ['Giao dch thnh cng'],\n        timeout: 30_000,\n        pollInterval: 500, \n        roi: VCB_ROI_EXPECTED.TRANSACTION_SUCCESS,\n        preprocess: {\n          // increase constrast for image recognition\n          grayscale: true,\n          enhanceContrast: true\n        }\n\n      }\n    )\n    \n    if (!doesTransactionSuccess) {\n      throw new WithdrawalProcessingError('Transaction success screen not found', ErrorType.NO_BILL_AFTER_OTP);\n    } else {\n      this.logger.log(`[${deviceConfig.accountName}] - Get Transaction success screen`);\n    }\n\n\n    \n    // Step 6: Capture screen\n    await sleep(500);\n    await this.captureScreen(deviceConfig.deviceId, { folderPath: withdrawal.withdrawalCode });\n\n    // Step 7: Back to home\n    await this.clickWithTransition(\n      deviceConfig.deviceId,\n      VCB_UI_COORDINATES.HOME_ICON.x,\n      VCB_UI_COORDINATES.HOME_ICON.y,\n      5000,\n      `[${deviceConfig.accountName}] - Get back to home screen`\n    );\n  }\n\n  /**\n   * Extract transaction amount t khung mu   cui mn hnh\n   * ROI da trn screenshot \"Kt qu giao dch\" ca VIETCOMBANK\n   */\n  async extractTransactionAmount(imagePath: string): Promise<number | null> {\n    try {\n      const result = await this.ocrService.recognizeFromFile(imagePath, {\n        fieldType: 'singleLine',\n        customROI: {\n          x: 0.05,      // 5% from left (c margin nh)\n          y: 0.75,      // 75% from top (khong cui white card)\n          width: 0.9,   // 90% width (full width tr margin)\n          height: 0.12, // 12% height (  cha text + padding)\n        },\n        preprocess: {\n          grayscale: true,        // Chuyn sang grayscale\n          enhanceContrast: true,  // Tng contrast cho text trn nn \n        },\n      });\n\n      if (!result) {\n        this.logger.warn('Failed to extract transaction amount from ROI');\n        return null;\n      }\n\n      // Clean s tin: ch ly s v du phy/chm\n      const amountText = result.text.replace(/[^\\d.,]/g, '').replace(/,/g, '');\n      const amount = parseFloat(amountText);\n\n      if (isNaN(amount)) {\n        this.logger.warn(`Could not parse amount from OCR text: ${result.text}`);\n        return null;\n      }\n\n      this.logger.log(\n        `Extracted transaction amount: ${amount.toLocaleString('vi-VN')} VND ` +\n        `(confidence: ${result.confidence.toFixed(2)}%, time: ${result.processingTime}ms)`\n      );\n\n      return amount;\n    } catch (error) {\n      this.logger.error(`Error extracting transaction amount: ${error.message}`, error.stack);\n      return null;\n    }\n  }\n\n\n  async onModuleInit() {\n    // sleep(5000);\n    // await this.executeTransferWithQRCode({\n    //     _id: '8746238746783264',\n    //     withdrawalId: 'WDR0912368',\n    //     withdrawalCode: 'WDR091236898',\n    //     bankCode: 'VIETCOMBANK',\n    //     beneficiaryAccountNo: '00125412001',\n    //     beneficiaryName: 'Nguyen Huy Phong',\n    //     amount: 2500,\n    //     status: 'pending',\n    //     description: '1',\n    //     transferCode: \"00020101021238550010A000000727012500069704230111001254120010208QRIBFTTA53037045405100005802VN63047B1E\",\n    //     createdAt: new Date().toDateString(),\n    //   }, {\n    //     deviceId: '28be90c4f8da3c9def8d0f4fe3a8efcb70367738',\n    //     availableAmount: 1000000,\n    //     status: 'active',\n    //     password: '123456',\n    //     smartOTP: '123456',\n    //     bankCode: 'VIETCOMBANK',\n    //     accountNo: '00125412001',\n    //     accountName: 'Nguyen Huy Phong',\n    //   }\n    //   )\n   \n    // await this.executeExternalTransfer({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   beneficiaryAccountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // }, 'dfe547d8200f554b5497ed89e2dbb47d57649356');\n    // const billImage = await this.analyzeTransferBill({\n    //   _id: '8746238746783264',\n    //   withdrawalId: 'WDR0912368',\n    //   withdrawalCode: 'WDR091236898',\n    //   bankCode: 'TPBANK',\n    //   accountNo: '00125412001',\n    //   beneficiaryName: 'Nguyen Huy Phong',\n    //   amount: 2500,\n    //   status: 'pending',\n    //   description: '1',\n    //   createdAt: new Date().toDateString(),\n    // });\n    // console.log(billImage);\n  }\n\n  onModuleDestroy(): void {\n    // this.killApp('590f1f9603f09330cf235485c6e76b10d0759a55');\n  }\n}\n\n","// HC PG UI Element Coordinates (normalized 0-1)\n\nimport { config } from \"@/common/constants/config\";\nimport { scaleCoordinates } from \"@/common/constants/keyboard\";\n\nconst HC_VCB_UI_COORDINATES = {\n  LOGIN_BTN: {\n    x: 0.5,\n    y: 0.55,\n  },\n  PASSWORD_FIELD: {\n    x: 0.5,\n    y: 0.45,\n  },\n  TRANSFER_BTN: {\n    x: 0.7,\n    y: 0.7,\n  },\n  TRANSFER_INTERNAL_BTN: {\n    x: 0.2,\n    y: 0.2\n  },\n  TRANSFER_EXTERNAL_BTN: {\n    x: 0.4,\n    y: 0.2,\n  },\n  CLOSE_ALLOW_CONTACT_POPUP_BTN: {\n    x: 0.3,\n    y: 0.6,\n  },\n  ACCOUNT_NUMBER_INPUT: {\n    x: 0.4,\n    y: 0.43,\n  },\n  SELECT_BANK_BTN: {\n    x: 0.4,\n    y: 0.47,\n  },\n  SEARCH_BANK_BTN: {\n    x: 0.4,\n    y: 0.48,\n  },\n  INTERNAL_AMOUNT_INPUT: {\n    x: 0.5,\n    y: 0.6,\n  },\n  HIDE_NUMPAD_BTN: {\n    x: 0.05,\n    y: 0.4,\n  },\n  CONTINUE_TRANSFER_BTN: {\n    x: 0.6,\n    y: 0.92,\n  },\n  CONTINUE_OTP_VERIFY_BTN: {\n    x: 0.5,\n    y: 0.68,\n  },\n  OTP_ENTER_TRANSFER_BTN: {\n    x: 0.5,\n    y: 0.62,\n  },\n  BANK_SEARCH_BTN: {\n    x: 0.4,\n    y: 0.45,\n  },\n  BANK_SEARCH_INPUT: {\n    x: 0.4,\n    y: 0.45,\n  },\n  EXTERNAL_AMOUNT_INPUT: {\n    x: 0.3,\n    y: 0.37,\n  },\n  BACK_TO_HOME: {\n    x: 0.2,\n    y: 0.9,\n  },\n  QR_CODE_BTN: {\n    x: 0.4,\n    y: 0.92,\n  },\n  IMAGE_LIBRARY_BTN: {  \n    x: 0.4,\n    y: 0.92,\n  },\n  FIRST_IMAGE_BTN: {  \n    x: 0.3,\n    y: 0.3,\n  },\n  SELECT_IMAGE_QR_CODE_BTN: {  \n    x: 0.95,\n    y: 0.95,\n  },\n  HOME_ICON: {  \n    x: 0.93,\n    y: 0.07,\n  },\n};\n\nconst PANDA_VCB_UI_COORDINATES = scaleCoordinates(HC_VCB_UI_COORDINATES);\n\nexport const VCB_UI_COORDINATES = config.boxType === 'PANDA' ? PANDA_VCB_UI_COORDINATES : HC_VCB_UI_COORDINATES;","import { Injectable, Logger } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\n\nexport interface BankSessionConfig {\n  bankCode: string;\n  sessionTimeoutMs: number; // Session timeout in milliseconds\n  refreshBeforeMs: number; // Refresh session before this time (e.g., 1 minute before)\n}\n\nexport interface DeviceSession {\n  deviceId: string;\n  bankCode: string;\n  loginTime: number; // Timestamp when logged in\n  expiresAt: number; // Timestamp when session expires\n  status: 'logged_in' | 'logging_in' | 'expired';\n}\n\n@Injectable()\nexport class SessionManagementService {\n  private readonly logger = new Logger('SessionManagementService');\n  private readonly REDIS_SESSION_PREFIX = 'bank:session:';\n  \n  // Session timeout configuration for each bank (in milliseconds)\n  private readonly BANK_SESSION_CONFIGS: Map<string, BankSessionConfig> = new Map([\n    [\n      'ACB',\n      {\n        bankCode: 'ACB',\n        sessionTimeoutMs: 15 * 60 * 1000, // 15 minutes\n        refreshBeforeMs: 1 * 60 * 1000, // Refresh 1 minute before expiry\n      },\n    ],\n    [\n      'PGBANK',\n      {\n        bankCode: 'PGBANK',\n        sessionTimeoutMs: 4.5 * 60 * 1000, // 4.5 minutes\n        refreshBeforeMs: 30 * 1000, // Refresh 30 seconds before expiry\n      },\n    ],\n    [\n      'HDBANK',\n      {\n        bankCode: 'HDBANK',\n        sessionTimeoutMs: 4.5 * 60 * 1000, // 4.5 minutes\n        refreshBeforeMs: 30 * 1000, // Refresh 30 seconds before expiry\n      },\n    ],\n  ]);\n\n  constructor(private readonly redisService: RedisService) {}\n\n  /**\n   * Get session timeout for a bank\n   */\n  getSessionTimeout(bankCode: string): number {\n    const config = this.BANK_SESSION_CONFIGS.get(bankCode.toUpperCase());\n    return config?.sessionTimeoutMs || 4.5 * 60 * 1000; // Default 4.5 minutes\n  }\n\n  /**\n   * Get refresh before time for a bank\n   */\n  getRefreshBeforeTime(bankCode: string): number {\n    const config = this.BANK_SESSION_CONFIGS.get(bankCode.toUpperCase());\n    return config?.refreshBeforeMs || 30 * 1000; // Default 30 seconds\n  }\n\n  /**\n   * Record login session for a device\n   */\n  async recordLogin(deviceId: string, bankCode: string): Promise<void> {\n    const timeout = this.getSessionTimeout(bankCode);\n    const expiresAt = Date.now() + timeout;\n    \n    const session: DeviceSession = {\n      deviceId,\n      bankCode: bankCode.toUpperCase(),\n      loginTime: Date.now(),\n      expiresAt,\n      status: 'logged_in',\n    };\n\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    await this.redisService.set(key, JSON.stringify(session), timeout);\n    \n    this.logger.log(`[${deviceId}] Recorded login session (bank: ${bankCode}, expires at: ${new Date(expiresAt).toISOString()})`);\n  }\n\n  /**\n   * Mark device as logging in\n   */\n  async markLoggingIn(deviceId: string, bankCode: string): Promise<void> {\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    const existing = await this.getSession(deviceId, bankCode);\n    \n    const session: DeviceSession = {\n      deviceId,\n      bankCode: bankCode.toUpperCase(),\n      loginTime: existing?.loginTime || Date.now(),\n      expiresAt: existing?.expiresAt || Date.now() + this.getSessionTimeout(bankCode),\n      status: 'logging_in',\n    };\n\n    await this.redisService.set(key, JSON.stringify(session), 5 * 60 * 1000); // 5 min TTL for login process\n    this.logger.log(`Marked device ${deviceId}, bank ${bankCode} as logging in`);\n  }\n\n  /**\n   * Get current session for a device\n   */\n  async getSession(deviceId: string, bankCode: string): Promise<DeviceSession | null> {\n    try {\n      const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n      const data = await this.redisService.get(key);\n      \n      if (!data) {\n        return null;\n      }\n\n      return JSON.parse(data) as DeviceSession;\n    } catch (error) {\n      this.logger.error(`Error getting session for device ${deviceId}, bank ${bankCode}: ${error.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Check if session is valid (not expired and not logging in)\n   */\n  async isSessionValid(deviceId: string, bankCode: string): Promise<boolean> {\n    const session = await this.getSession(deviceId, bankCode);\n    \n    if (!session) {\n      return false;\n    }\n\n    // Check if session is expired\n    if (session.expiresAt < Date.now()) {\n      return false;\n    }\n\n    // Check if device is currently logging in\n    if (session.status === 'logging_in') {\n      return false;\n    }\n\n    return session.status === 'logged_in';\n  }\n\n  /**\n   * Check if session needs refresh (within refresh window)\n   */\n  async needsRefresh(deviceId: string, bankCode: string): Promise<boolean> {\n    const session = await this.getSession(deviceId, bankCode);\n    \n    if (!session || session.status !== 'logged_in') {\n      return false;\n    }\n\n    const refreshBeforeTime = this.getRefreshBeforeTime(bankCode);\n    const timeUntilExpiry = session.expiresAt - Date.now();\n    \n    return timeUntilExpiry <= refreshBeforeTime;\n  }\n\n  /**\n   * Clear session\n   */\n  async clearSession(deviceId: string, bankCode: string): Promise<void> {\n    const key = `${this.REDIS_SESSION_PREFIX}${deviceId}:${bankCode.toUpperCase()}`;\n    await this.redisService.del(key);\n    this.logger.log(`Cleared session for device ${deviceId}, bank ${bankCode}`);\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { EzpayBeClientService } from './ezpay-be-client.service';\nimport { IAnalyzeTransferBillResult } from '../bank/interfaces/bank-service.interface';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { WithdrawalStatus } from '../withdrawal/constants/withdrawal-status';\n\n@Injectable()\nexport class NotificationService {\n  private readonly logger = new Logger('NotificationService');\n\n  constructor(\n    private readonly ezpayBeClient: EzpayBeClientService,\n  ) {}\n\n  async completeWithdrawal(\n    withdrawal: Withdrawal, \n    analysisResult: IAnalyzeTransferBillResult, \n    deviceConfig: DeviceConfig): Promise<void> \n  {\n    this.ezpayBeClient\n      .completeWithdrawal(withdrawal._id, {\n        analyzedStatus: analysisResult.analyzedStatus,\n        sourceAccountNo: deviceConfig.accountNo,\n        sourceBankCode: deviceConfig.bankCode,\n        sourceAccountName: deviceConfig.accountName,\n      }).catch((error) => {\n        this.logger.error(`[${withdrawal.withdrawalCode}] - Error updating withdrawal status for ${withdrawal._id} - ${error.stack}`);\n      });\n\n    this.ezpayBeClient\n      .uploadReceipt(withdrawal._id, analysisResult.rawPath)\n      .catch((error) => {\n        this.logger.error(`[${withdrawal.withdrawalCode}] - Error uploading receipt for ${withdrawal._id} - ${error.stack}`);\n      });\n  }\n\n  updateWithdrawalStatus(id: string, status: WithdrawalStatus) {\n    return this.ezpayBeClient.updateWithdrawalStatus(id, status);\n  }\n\n  uploadReceipt(id: string, receiptPath: string) {\n    return this.ezpayBeClient.uploadReceipt(id, receiptPath);\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { HttpService } from '@nestjs/axios';\nimport { firstValueFrom } from 'rxjs';\nimport { AxiosError } from 'axios';\nimport * as FormData from 'form-data';\nimport { createReadStream } from 'fs';\nimport { config } from '../../common/constants/config';\nimport { sleep } from '../../common/utils/time';\nimport { BillAnalyzedStatus } from '@/modules/bank/interfaces/bank-service.interface';\nimport { WithdrawalStatus } from '../withdrawal/constants/withdrawal-status';\n\n@Injectable()\nexport class EzpayBeClientService {\n  private readonly logger = new Logger('EzpayBeClientService');\n  private readonly apiUrl: string;\n  private readonly apiKey: string;\n\n  constructor(\n    private readonly httpService: HttpService\n  ) {\n    this.apiUrl = config.ezpayBe.apiUrl ?? 'http://localhost:3001';\n    this.apiKey = config.ezpayBe.apiKey ?? '';\n  }\n\n  async completeWithdrawal(\n    withdrawalId: string,\n    payload: {\n      analyzedStatus: BillAnalyzedStatus,\n      sourceBankCode: string,\n      sourceAccountNo: string,\n      sourceAccountName: string,\n    }\n  ): Promise<boolean> {\n    const maxRetries = 3;\n    const baseDelay = 2000; // 2 seconds\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        const url = `${this.apiUrl}/api/internal/withdrawals/complete/${withdrawalId}`;\n\n        this.logger.log(`Updating withdrawal ${withdrawalId} status to ${payload.analyzedStatus} (attempt ${attempt + 1}/${maxRetries + 1})`);\n\n        const data = {\n          analyzedStatus: payload.analyzedStatus,\n          sourceBankCode: payload.sourceBankCode,\n          sourceAccountNo: payload.sourceAccountNo,\n          sourceAccountName: payload.sourceAccountName\n        };\n\n        const response = await firstValueFrom(\n          this.httpService.patch(url, data, {\n            headers: {\n              'Content-Type': 'application/json',\n              'X-API-Key': this.apiKey,\n              'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n            },\n            timeout: 20000,\n          }),\n        );\n\n        if (response.status === 200 || response.status === 204) {\n          this.logger.log(`Successfully updated withdrawal ${withdrawalId} status to ${payload.analyzedStatus}`);\n\n          return;\n        }\n\n        this.logger.warn(`Unexpected status code ${response.status} when updating withdrawal ${withdrawalId}`);\n      } catch (error) {\n        const axiosError = error as AxiosError;\n        const payload = axiosError.response?.data;\n        const errorMessage = axiosError.message;\n\n        if (attempt < maxRetries) {\n          const delay = baseDelay * Math.pow(2, attempt); // Exponential backoff\n          this.logger.warn(\n            `Failed to update withdrawal ${withdrawalId} (attempt ${attempt + 1}/${maxRetries + 1}): ${errorMessage}. Payload: ${JSON.stringify(payload)}, Retrying in ${delay}ms`,\n          );\n          await sleep(delay);\n        } else {\n          this.logger.error(\n            `Failed to update withdrawal ${withdrawalId} after ${maxRetries + 1} attempts. Payload: ${JSON.stringify(payload)}, Error: ${errorMessage}`,\n          );\n        }\n      }\n    }\n  }\n\n  async uploadReceipt(withdrawalId: string, receiptPath: string) {\n    const maxRetries = 3;\n    const baseDelay = 2000; // 2 seconds\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        const url = `${this.apiUrl}/api/internal/withdrawals/upload-receipt/${withdrawalId}`;\n\n        this.logger.log(`Uploading bill for withdrawal ${withdrawalId} (attempt ${attempt + 1}/${maxRetries + 1})`);\n\n        if (!receiptPath) {\n          this.logger.warn(`No receipt path provided for withdrawal ${withdrawalId}`);\n\n          return;\n        }\n\n        const formdata = new FormData();\n        formdata.append('receipt', createReadStream(receiptPath));\n\n        const response = await firstValueFrom(\n          this.httpService.patch(url, formdata, {\n            headers: {\n              ...formdata.getHeaders(),\n              'X-API-Key': this.apiKey,\n              'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n            },\n            timeout: 20000,\n          }),\n        );\n\n        if (response.status === 200 || response.status === 204) {\n          this.logger.log(`Successfully uploaded bill for withdrawal ${withdrawalId}`);\n\n          return;\n        }\n\n        this.logger.warn(`Unexpected status code ${response.status} when uploading bill for withdrawal ${withdrawalId}`);\n      } catch (error) {\n        const axiosError = error as AxiosError;\n        const response = axiosError.response?.data;\n        const errorMessage = axiosError.message;\n\n        if (attempt < maxRetries) {\n          const delay = baseDelay * Math.pow(2, attempt); // Exponential backoff\n          this.logger.warn(\n            `Failed to upload bill for withdrawal ${withdrawalId} (attempt ${attempt + 1}/${maxRetries + 1}): ${errorMessage}. Response: ${JSON.stringify(response)}, Retrying in ${delay}ms`,\n          );\n          await sleep(delay);\n        } else {\n          this.logger.error(\n            `Failed to upload bill for withdrawal ${withdrawalId} after ${maxRetries + 1} attempts. Response: ${JSON.stringify(response)}, Error: ${errorMessage}`,\n          );\n        }\n      }\n    }\n  }\n\n  async updateWithdrawalStatus(id: string, status: WithdrawalStatus) {\n    this.logger.log(`Updating withdrawal ${id} status to ${status}`);\n\n    const url = `${this.apiUrl}/api/internal/withdrawals/status/${id}`;\n\n\n    await firstValueFrom(\n      this.httpService.patch(url, { status }, {\n        headers: {\n          'x-internal-secret-key': 'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE',\n        },\n      }),\n    );\n  }\n}\n\n","module.exports = require(\"rxjs\");","import { Injectable, Logger, OnModuleInit, Inject } from '@nestjs/common';\nimport { Cron, CronExpression } from '@nestjs/schedule';\nimport { InjectQueue } from '@nestjs/bull';\nimport { Queue, Job } from 'bull';\nimport { WithdrawalService } from './withdrawal.service';\nimport { DeviceService } from '../device/device.service';\nimport { DeviceLockService } from '../device/device-lock.service';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { WithdrawalProcessingError, ErrorType } from './withdrawal-errors';\nimport { cloneDeep } from 'lodash';\nimport { withCronLock } from '@/common/redis/cron-lock';\nimport { BankService } from '../bank/bank.service';\nimport { NotificationService } from '../notifiction/notification.service';\nimport { WithdrawalStatus } from './constants/withdrawal-status';\nimport { WindowsAppGitBashService } from '../window-app/window-app.service';\nimport { RedisLockService } from '../redis-lock/redis-lock.service';\nimport { SYSTEM_LOCK_BOXPHONE, SYSTEM_LOCK_PAUSE_PROCESSING } from './constants/lock';\nimport { TelegramService } from '../notifiction/telegram.service';\nimport { sleep } from '@/common/utils/time';\nimport { DeviceConfig } from '../device/dto/device-config.dto';\nimport { validateObjectResult } from '@/common/utils/object-validation';\n\n@Injectable()\nexport class WithdrawalJobManagerService implements OnModuleInit {\n  private readonly logger = new Logger('WithdrawalJobManagerService');\n  private processingJobs: Set<number | string> = new Set(); // Track job IDs being processed\n  private isInitialized = false;\n  private isRestartingBoxphone = false; // prevent multiple restart boxphone at the same time\n  private cronRestartBoxphoneEnabled = false;\n\n  constructor(\n    @InjectQueue('wda-request') private readonly withdrawalQueue: Queue<Withdrawal>,\n    private readonly withdrawalService: WithdrawalService,\n    private readonly deviceService: DeviceService,\n    private readonly deviceLockService: DeviceLockService,\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    private readonly bankService: BankService,\n    private readonly notificationService: NotificationService,\n    private readonly windowsAppGitBashService: WindowsAppGitBashService,\n    private readonly redisLockService: RedisLockService,\n    private readonly telegramService: TelegramService,\n  ) { }\n\n  async onModuleInit() {\n    this.logger.log('WithdrawalJobManagerService initialized, waiting 5 seconds before starting...');\n    // Wait a bit for other services to initialize\n    this.initializeJobProcessing();\n    this.scheduleCronRestartBoxphone();\n  }\n\n  /**\n   * Initialize job processing - pick jobs equal to number of active devices\n   */\n  private async initializeJobProcessing() {\n    setTimeout(async () => {\n      if (this.isInitialized) {\n        return;\n      }\n  \n      this.logger.log('Starting withdrawal job processing...');\n      await this.pickAndProcessJobs();\n\n      this.isInitialized = true;\n    }, 5000);\n    \n  }\n\n  private scheduleCronRestartBoxphone() {\n    // Nu khng c lp delay th job s chy lun vo giy 0 pht tip theo\n    const now = new Date();\n    const msToNextMinute =\n      (60 - now.getSeconds()) * 1000 - now.getMilliseconds();\n\n    setTimeout(() => {\n      this.cronRestartBoxphoneEnabled = true;\n    }, msToNextMinute);\n  }\n\n  private async restartBoxphone() {\n    const hasTransferGoing = await this.deviceLockService.hasAnyLockKeys();\n\n    if (!hasTransferGoing) {\n      this.telegramService\n        .sendMessage({\n          text: ' <b>Boxphone software...</b>'\n            + `\\n\\n<b>Khi ng li:</b> ${new Date().toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' })}`\n            + '\\n<b>D kin:</b> 3 pht.'\n          ,\n          options: {\n            parseMode: 'HTML'\n          }\n        });\n\n      await this.windowsAppGitBashService.restartApp({\n        processName: 'xiaowei_iphone.exe',\n        exePath: 'C:/Users/Public/Desktop/.lnk',\n        runAsAdmin: true,\n        killAsAdmin: true\n      });\n\n      this.telegramService\n        .sendMessage({\n          text: ' <b>Boxphone software</b>'\n            + `\\n\\n<b>Khi ng li thnh cng:</b> ${new Date().toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' })}`\n            + '\\nLogin tt c thit b sau 1 pht:'\n          ,\n          options: {\n            parseMode: 'HTML'\n          }\n        });\n      \n        try {\n        await sleep(5000); // wait 10 seconds for connecting to socket\n        await this.bankService.loginAllActiveBanks();\n      } catch (error) {\n        this.logger.error(`Error logging in all active banks: ${error.stack}`);\n      } finally {\n        await sleep(1000);\n        await this.redisLockService.releaseLock(SYSTEM_LOCK_BOXPHONE);\n      }\n    }\n  }\n\n  /**\n   * Pick and process jobs from queue\n   * Strategy: Find N available devices -> Pick N jobs -> Assign strictly\n   */\n  async pickAndProcessJobs(count?: number): Promise<void> {\n    try {\n      const isNeedRestartBoxphone = await this.redisLockService.getLock(SYSTEM_LOCK_BOXPHONE);\n      // console.log(\" ~ WithdrawalJobManagerService ~ pickAndProcessJobs ~ isNeedRestartBoxphone:\", isNeedRestartBoxphone)\n\n      if (isNeedRestartBoxphone) {\n        // console.log(\" ~ WithdrawalJobManagerService ~ pickAndProcessJobs ~ isRestartingBoxphone:\", this.isRestartingBoxphone)\n        if (this.isRestartingBoxphone) {\n          return\n        }\n\n        this.isRestartingBoxphone = true;\n        await this.restartBoxphone();\n        this.isRestartingBoxphone = false;\n\n        return;\n      }\n\n      if (!this.wsService.isConnectedStatus()) {\n        this.logger.error(`WebSocket is not connected, cannot pick jobs`);\n\n        return;\n      }\n\n      // Check service status\n      const serviceStatus = await this.deviceService.getServiceStatus();\n      if (serviceStatus !== 'active') {\n        this.logger.debug(`Service is ${serviceStatus}, cannot pick jobs`);\n        return;\n      }\n\n      // 1. Get Available Devices (Active + Unlocked)\n      const availableDevices = await this.deviceService.getAvailableDevices();\n\n      // Filter out devices that are currently assigned to processing jobs (in-memory safeguard)\n      // Note: DeviceLock check above should cover this, but this adds extra layer if lock is acquired later\n      // Actually, since we process async, the lock might not be acquired yet if we just called processJob.\n      // But we don't map job->device in `processingJobs`.\n      // The best way is to rely on `getAvailableDevices` checking the Lock Service.\n\n      // Calculate capacity\n      const capacity = availableDevices.length;\n\n      if (capacity <= 0) {\n        // this.logger.debug(`No available (unlocked) devices. Waiting...`);\n        return;\n      }\n\n      // 2. Pick Jobs\n      // Number of jobs to pick = min(requested_count OR capacity, capacity)\n      // Since each job needs 1 unique device.\n      const jobsToPick = count ? Math.min(count, capacity) : capacity;\n\n      // Get waiting and delayed jobs separately\n      // getJobs(types, start, end): end is inclusive.\n      // If we want N jobs, index is 0 to N-1\n      const waitingJobs = await this.withdrawalQueue.getJobs(['waiting'], 0, jobsToPick - 1);\n\n\n      if (waitingJobs.length === 0) {\n        // this.logger.debug('No waiting jobs available in queue');\n        return;\n      }\n\n      this.logger.log(\n        `Found ${availableDevices.length} available devices. ` +\n        `Picking ${waitingJobs.length} jobs (${(waitingJobs || []).length} waiting).`\n      );\n\n      // 3. Assign Job -> Device\n      // We iterate through picked jobs and assign to available devices index-by-index\n      for (let i = 0; i < waitingJobs.length; i++) {\n        const job = waitingJobs[i];\n        const device = availableDevices[i]; // Guaranteed to exist because jobsToPick <= capacity\n\n        // Skip if already processing (safety check)\n        if (this.processingJobs.has(job.id)) {\n          continue;\n        }\n\n        // CRITICAL: Acquire lock immediately to prevent race condition\n        const operationId = `withdraw:${job.data.withdrawalId}:${device.deviceId}`;\n        const lockAcquired = await this.deviceLockService.acquireLock(\n          device.deviceId,\n          'transfer',\n          operationId,\n          3.68 * 60 * 1000 // 3.68 minutes\n        );\n\n        if (!lockAcquired) {\n          this.logger.warn(`Device ${device.deviceId} was locked after assignment, skipping job ${job.id}`);\n          continue; // Skip this job, it will be picked up later\n        }\n\n        // Lock acquired - process job\n        // Note: processWithdrawal will release the lock in its finally block\n        this.processJob(job, device)\n          .catch(error => {\n            this.logger.error(`Error processing job ${job.id}: ${error.message}`, error.stack);\n          })\n          .finally(() => {\n            // Safety: release lock if processJob fails before processWithdrawal\n            this.deviceLockService.releaseLock(device.deviceId).catch(() => { });\n          });\n      }\n    } catch (error) {\n      this.logger.error(`Error picking jobs: ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Process a single job with assigned device\n   */\n  private async processJob(job: Job<Withdrawal>, deviceConfig: DeviceConfig): Promise<void> {\n    let withdrawal: Withdrawal;\n\n    try {\n      withdrawal = cloneDeep(job.data);\n      await job.remove();\n      const validateJob = await validateObjectResult(Withdrawal, withdrawal);\n      \n      \n      if (!validateJob.ok) {\n        throw new WithdrawalProcessingError(\n          `Invalid withdrawal: missing ${validateJob.errors.map(error => error.property).join(', ')}`,\n          ErrorType.PERMANENT\n        );\n      }\n\n      const { _id, withdrawalId } = withdrawal;\n      \n      this.logger.log(`Successfully picked and removed withdrawal ${withdrawalId} from queue`);\n\n      this.processingJobs.add(job.id);\n\n      const withdrawalDetails = await this.withdrawalService.getWithdrawalDetails(_id);\n\n      if (![WithdrawalStatus.PENDING, WithdrawalStatus.RETRY].includes(withdrawalDetails.status)) {\n        this.logger.warn(`WDA ${withdrawalId} (${withdrawalDetails.status}) is not pending or retry, skipping`);\n  \n        throw new WithdrawalProcessingError(`Withdrawal not pending or retry, skipping (${withdrawalDetails.status})`, ErrorType.PERMANENT);\n      }\n  \n      this.notificationService\n        .updateWithdrawalStatus(_id, WithdrawalStatus.PROCESSING)\n        .catch((error) => {\n          this.logger.error(`Error updating withdrawal status for ${withdrawalId}: ${error.message}`, error.stack);\n        });\n\n      await this.bankService.createQRCodeAndTransferTo(deviceConfig.bankCode, deviceConfig.deviceId, withdrawal);\n      await this.bankService.createBillFolder(deviceConfig.bankCode, withdrawal.withdrawalCode);\n      await this.withdrawalService.processWithdrawal(withdrawal, deviceConfig.deviceId);\n    } catch (error) {\n      // Extract error type t error nu c\n      let errorType: ErrorType;\n      \n      if (error instanceof WithdrawalProcessingError) {\n        errorType = error.errorType;\n        this.logger.error(`Error processing ${withdrawal.withdrawalId}: ${errorType}-${error.message}`, error.stack);\n        await this.handleJobFailure(deviceConfig, withdrawal, error.message, errorType);\n      }\n    } finally {\n      this.processingJobs.delete(job.id as number);\n    }\n  }\n\n  /**\n   * Handle Job Failure: Retry logic with error type classification\n   */\n  private async handleJobFailure(\n    deviceConfig: DeviceConfig,\n    withdrawal: Withdrawal,\n    reason: string,\n    errorType: ErrorType = ErrorType.PERMANENT\n  ) {\n    const maxRetries = 2;\n    const currentRetries = withdrawal.manualRetryCount ?? 1;\n\n    switch (errorType) {\n      case ErrorType.PERMANENT:\n        this.notificationService\n        .updateWithdrawalStatus(withdrawal._id, WithdrawalStatus.FAILED)\n        .catch((error) => {\n          this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n        });\n\n        return;\n\n      case ErrorType.NO_BILL_AFTER_OTP:\n        await this.bankService.captureScreen(deviceConfig.bankCode, deviceConfig.deviceId, withdrawal.withdrawalCode);\n        const billImagePath = await this.bankService.getBillImagePath(deviceConfig.bankCode, withdrawal.withdrawalCode);\n\n        if (billImagePath) {\n          this.logger.log(`Uploading receipt for withdrawal ${withdrawal.withdrawalCode} - ${billImagePath}`);\n\n          await this.notificationService.uploadReceipt(withdrawal._id, billImagePath);\n        }\n\n        await this.notificationService.updateWithdrawalStatus(withdrawal._id, WithdrawalStatus.UNKNOWN);\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n        \n        return;\n\n      case ErrorType.FORCE_LOGIN: // Force Login s cho retry nn khng cn break\n        await this.bankService.login(deviceConfig.bankCode, deviceConfig.deviceId, true);\n      default:\n        this.logger.warn(\n          `Added ${withdrawal.withdrawalId} to queue for retrying. (${currentRetries}/${maxRetries})` +\n          `Reason: ${reason}. ` +\n          `Error Type: ${errorType}.`\n        );\n\n        if (currentRetries < maxRetries) {\n\n          await this.withdrawalQueue.add(\n            'process-withdrawal-request',\n            {\n              ...withdrawal,\n              manualRetryCount: currentRetries + 1,\n              lastErrorType: errorType,\n              lastErrorReason: reason\n            },\n            {\n              attempts: 0,\n              removeOnComplete: false,\n              removeOnFail: false,\n              jobId: `withdrawal-request-${withdrawal.withdrawalId}`,\n              priority: 0,\n              delay: 30000, // 30s\n            }\n          );\n    \n          this.notificationService\n            .updateWithdrawalStatus(withdrawal._id, WithdrawalStatus.RETRY)\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n            });\n    \n        } else {\n          this.logger.warn(`Max retries (${maxRetries}) exceeded for withdrawal ${withdrawal.withdrawalId}: ${errorType} error: ${reason}`);\n    \n          this.notificationService\n            .updateWithdrawalStatus(withdrawal._id, WithdrawalStatus.FAILED)\n            .catch((error) => {\n              this.logger.error(`Error updating withdrawal status for ${withdrawal.withdrawalId}: ${error.message}`, error.stack);\n            });\n        }\n    }\n  }\n\n  private async promoteDelayedJobs() {\n    return withCronLock('cron:promote_delayed:withdrawal', 5000, async () => {\n      const now = Date.now();\n      const BATCH = 100;\n\n      // Ly mt batch job  delayed\n      const delayedJobs: Job[] = await this.withdrawalQueue.getJobs(\n        ['delayed'],\n        0,\n        BATCH - 1,\n      );\n\n      if (!delayedJobs.length) return;\n\n      let promoted = 0;\n\n      for (const job of delayedJobs) {\n        const delayMs = typeof job.opts?.delay === 'number' ? job.opts.delay : 0;\n        const ts = typeof job.timestamp === 'number' ? job.timestamp : 0;\n\n        const dueAt = ts + delayMs;\n\n        // ch promote job n hn\n        if (dueAt <= now) {\n          try {\n            // Bull h tr job.promote()  chuyn delayed -> waiting\n            await job.promote();\n            promoted++;\n          } catch (e) {\n            this.logger.debug(`Promote skipped for job ${job.id}: ${String(e)}`);\n          }\n        }\n      }\n\n      if (promoted > 0) {\n        this.logger.log(`Promoted ${promoted} delayed jobs to waiting`);\n      }\n    });\n  }\n\n  /**\n   * Manually trigger job picking (for testing or manual operations)\n   */\n  async triggerPickJobs(count: number = 1): Promise<void> {\n    await this.pickAndProcessJobs(count);\n  }\n\n  /**\n   * Get queue statistics\n   */\n  async getQueueStats() {\n    // Need to implement new stats logic if needed, but keeping existing is fine for now\n    // availableDevices logic changed slightly\n    const [waiting, delayed, active, completed, failed, availableDevices, serviceStatus] = await Promise.all([\n      this.withdrawalQueue.getWaitingCount(),\n      this.withdrawalQueue.getDelayedCount(),\n      this.withdrawalQueue.getActiveCount(),\n      this.withdrawalQueue.getCompletedCount(),\n      this.withdrawalQueue.getFailedCount(),\n      this.deviceService.getAvailableDevices(),\n      this.deviceService.getServiceStatus(),\n    ]);\n\n    return {\n      serviceStatus,\n      activeDevices: availableDevices.length, // Now explicitly unlocked active devices\n      processingJobs: this.processingJobs.size,\n      isInitialized: this.isInitialized,\n      queue: {\n        waiting,\n        delayed,\n        active,\n        completed,\n        failed,\n        total: waiting + delayed + active,\n      },\n    };\n  }\n\n  /**\n   * Debug method: Get detailed queue information\n   */\n  async debugQueue() {\n    const stats = await this.getQueueStats();\n    const [waitingJobs, delayedJobs] = await Promise.all([\n      this.withdrawalQueue.getJobs(['waiting'], 0, 9), // Get first 10 waiting jobs\n      this.withdrawalQueue.getJobs(['delayed'], 0, 9), // Get first 10 delayed jobs\n    ]);\n\n    return {\n      ...stats,\n      sampleWaitingJobs: waitingJobs.map(job => ({\n        id: job.id,\n        data: job.data,\n        opts: job.opts,\n        manualRetryCount: (job.data as any).manualRetryCount\n      })),\n      sampleDelayedJobs: delayedJobs.map(job => ({\n        id: job.id,\n        data: job.data,\n        opts: job.opts,\n        manualRetryCount: (job.data as any).manualRetryCount\n      })),\n    };\n  }\n\n  /**\n   * Periodically check and pick jobs if there are available slots\n   * Runs every 5 seconds\n   */\n  @Cron(CronExpression.EVERY_5_SECONDS)\n  async periodicJobPicking() {\n    const doesPauseProcessingJob = await this.redisLockService.isLocked(SYSTEM_LOCK_PAUSE_PROCESSING);\n\n    if (doesPauseProcessingJob) {\n      this.logger.warn('Transfer is paused by admin temporarily!');\n      return;\n    }\n\n    await this.pickAndProcessJobs();\n  }\n\n  /**\n   * Promote delayed jobs to waiting jobs\n   * Runs every 5 seconds\n   */\n  @Cron(CronExpression.EVERY_5_SECONDS)\n  async promoteDelayedJobsPeriodically() {\n    await this.promoteDelayedJobs();\n  }\n\n  /**\n   * Promote delayed jobs to waiting jobs\n   * Runs every 59 minutes\n   */\n  @Cron('0 */59 * * * *')\n  async restartPandaBoxPeriodically() {\n    const serviceStatus = await this.deviceService.getServiceStatus();\n\n    if (this.cronRestartBoxphoneEnabled && serviceStatus === 'active') {\n      await this.redisLockService.acquireLock(SYSTEM_LOCK_BOXPHONE, 3 * 60 * 1000); // 3 minutes\n    }\n  }\n}\n","module.exports = require(\"bull\");","import { ErrorType } from \"@/modules/withdrawal/withdrawal-errors\";\nimport { IsNotEmpty, IsOptional } from \"class-validator\";\n\nexport class Withdrawal {\n  @IsNotEmpty()\n  _id: string;\n  \n  @IsNotEmpty()\n  withdrawalId: string;\n\n  @IsNotEmpty()\n  withdrawalCode: string;\n\n  @IsNotEmpty()\n  bankCode: string;\n\n  @IsNotEmpty()\n  beneficiaryAccountNo: string;\n\n  @IsNotEmpty()\n  beneficiaryName: string;\n\n  @IsNotEmpty()\n  amount: number;\n  \n  @IsNotEmpty()\n  transferCode: string;\n\n  @IsNotEmpty()\n  status: string;\n\n  @IsNotEmpty()\n  description: string;\n\n  @IsNotEmpty()\n  createdAt: string;\n\n  @IsOptional()\n  manualRetryCount?: number;\n\n  @IsOptional()\n  lastErrorType?: ErrorType;\n\n  @IsOptional()\n  lastErrorReason?: string;\n}\n\nexport interface WithdrawalRequestJob {\n  withdrawal: Withdrawal; // Required: withdrawal data passed directly in job\n  retryCount?: number;\n}\n\n","module.exports = require(\"class-validator\");","import Redis from 'ioredis';\nimport { config } from '../constants/config';\n\nconst redis = new Redis({\n  host: config.redis.host,\n  port: config.redis.port,\n  password: config.redis.password,\n  db: config.redis.db,\n});\n\nexport const withCronLock = async (key: string, ttlMs: number, fn: () => Promise<void>) => {\n  const lockVal = `${process.pid}:${Date.now()}`;\n  const ok = await redis.set(key, lockVal, 'PX', ttlMs, 'NX');\n  if (!ok) return;\n\n  try {\n    await fn();\n  } finally {\n    // release best-effort: ch xo nu vn l ch lock\n    const lua = `\n      if redis.call(\"GET\", KEYS[1]) == ARGV[1] then\n        return redis.call(\"DEL\", KEYS[1])\n      end\n      return 0\n    `;\n    await redis.eval(lua, 1, key, lockVal);\n  }\n}","export enum WithdrawalStatus {\n  PENDING = 'PENDING',\n  FAILED = 'FAILED',\n  PROCESSING = 'PROCESSING',\n  RETRY = 'RETRY',\n  COMPLETED = 'COMPLETED',\n  UNKNOWN = 'UNKNOWN', // Khi phn tch nh mn hnh khng th xc nh trng thi chuyn thnh cng\n  NA = 'NA', // Khi khng c nh hoc phn tch nh b li\n}","import { Injectable, Logger } from '@nestjs/common';\nimport { exec } from 'child_process';\nimport { promisify } from 'util';\nimport { sleep } from '@/common/utils/time';\n\nconst execAsync = promisify(exec);\n\ntype RestartParams = {\n  processName: string;       // \"notepad.exe\", \"chrome.exe\"\n  exePath?: string;          // \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\"\n  startTarget?: string;      // \"notepad\" | \"calc\" | \"https://...\" | \"C:\\\\folder\"\n  gracefulWaitMs?: number;   // default 1200\n  forceKillWaitMs?: number;  // default 500\n  startDelayMs?: number;     // default 300\n  runAsAdmin?: boolean;      // default false - Chy vi quyn Administrator (s hin UAC prompt)\n  killAsAdmin?: boolean;     // default false - Kill process vi quyn Administrator nu gp \"access denied\"\n};\n\n@Injectable()\nexport class WindowsAppGitBashService {\n  private readonly logger = new Logger(WindowsAppGitBashService.name);\n\n  async restartApp(params: RestartParams): Promise<void> {\n    const {\n      processName,\n      exePath,\n      startTarget,\n      gracefulWaitMs = 1200,\n      forceKillWaitMs = 500,\n      startDelayMs = 300,\n      runAsAdmin = false,\n      killAsAdmin = false,\n    } = params;\n\n    try {\n      // 1) ng ng dng mt cch graceful (best effort)\n      await this.closeMainWindow(processName).catch(() => {});\n\n      // 2) i mt cht, ri kill cng (best effort)\n      await sleep(gracefulWaitMs);\n      await this.forceKill(processName, killAsAdmin).catch(() => {});\n\n      // 3) m bo process  tt hon ton\n      await sleep(forceKillWaitMs);\n      await this.waitUntilNotRunning(processName, 5000).catch(() => {});\n\n      // 4) Khi ng li ng dng\n      await sleep(startDelayMs);\n\n      if (exePath) {\n        await this.startApp({ exePath, runAsAdmin });\n        return;\n      }\n\n      if (startTarget) {\n        await this.startApp({ startTarget, runAsAdmin });\n        return;\n      }\n\n      // fallback: start theo base name\n      const base = processName.replace(/\\.exe$/i, '');\n      await this.startApp({ startTarget: base, runAsAdmin });\n    } catch (error: any) {\n      const errorMsg = error?.message || String(error);\n      this.logger.error(`[restart] Failed to restart app: ${errorMsg}`, error?.stack);\n      throw error;\n    }\n  }\n\n  // -----------------------------\n  // Windows process management\n  // -----------------------------\n\n  /**\n   * ng ca s chnh ca ng dng mt cch graceful\n   */\n  private async closeMainWindow(processName: string): Promise<void> {\n    const base = processName.replace(/\\.exe$/i, '');\n    \n    // S dng PowerShell  ng ca s mt cch graceful\n    const psCommand = `Get-Process -Name \"${this.escapePs(base)}\" -ErrorAction SilentlyContinue | ForEach-Object { $_.CloseMainWindow() | Out-Null }`;\n    const command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${this.escapePs(psCommand)}\"`;\n\n    // TODO: Uncomment when debugging\n    // this.logger.debug(`Graceful close: ${processName}`);\n    \n    try {\n      await execAsync(command, { windowsHide: true });\n    } catch (error: any) {\n      // Ignore errors nu process khng tn ti\n      const errorMsg = error?.message || String(error) || '';\n      if (!errorMsg.includes('Cannot find a process')) {\n        throw error;\n      }\n    }\n  }\n\n  /**\n   * Force kill process bng taskkill hoc PowerShell\n   * @param processName - Tn process cn kill\n   * @param useAdmin - S dng quyn admin  kill (nu gp \"access denied\")\n   */\n  private async forceKill(processName: string, useAdmin: boolean = false): Promise<void> {\n    const base = processName.replace(/\\.exe$/i, '');\n    \n    // TODO: Uncomment when debugging\n    // this.logger.debug(`Force kill: ${processName}${useAdmin ? ' (with admin)' : ''}`);\n\n    try {\n      // Th kill bng PowerShell trc (tt hn vi child processes)\n      await this.forceKillWithPowerShell(base, useAdmin);\n      // Nu thnh cng, return ngay\n      return;\n    } catch (error: any) {\n      const errorMsg = (error?.message || error?.stderr || String(error) || '').toLowerCase();\n      \n      // Ignore nu process khng tn ti (khng cn kill na)\n      if (\n        errorMsg.includes('cannot find a process') ||\n        errorMsg.includes('process not found') ||\n        errorMsg.includes('cannot find process')\n      ) {\n        this.logger.debug(`Process not found (expected): ${processName}`);\n        return;\n      }\n\n      // Nu l \"access denied\" v cha dng admin, th li vi admin\n      if (\n        (errorMsg.includes('access is denied') || errorMsg.includes('access denied')) &&\n        !useAdmin\n      ) {\n        this.logger.warn(`Access denied, retrying with admin privileges: ${processName}`);\n        try {\n          await this.forceKillWithPowerShell(base, true);\n          return;\n        } catch (retryError: any) {\n          const retryMsg = (retryError?.message || retryError?.stderr || String(retryError) || '').toLowerCase();\n          \n          // Nu retry vi admin vn li, fallback sang taskkill\n          if (\n            !retryMsg.includes('cannot find a process') &&\n            !retryMsg.includes('process not found')\n          ) {\n            this.logger.debug(`PowerShell kill with admin failed, trying taskkill: ${processName}`);\n          } else {\n            // Process  khng tn ti\n            return;\n          }\n        }\n      }\n\n      // Fallback: th taskkill nu PowerShell fail\n      try {\n        const shouldUseAdmin = useAdmin || errorMsg.includes('access denied') || errorMsg.includes('access is denied');\n        let command: string;\n        \n        if (shouldUseAdmin) {\n          // S dng PowerShell  chy taskkill vi quyn admin\n          // Escape process name ng cch cho ArgumentList\n          const escapedProcessName = processName.replace(/\"/g, '`\"');\n          // S dng single quotes trong PowerShell  trnh escape phc tp\n          const psCommand = `Start-Process taskkill -ArgumentList '/F','/IM','${escapedProcessName}','/T' -Verb RunAs -Wait -WindowStyle Hidden`;\n          // Escape cho command line\n          command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${psCommand.replace(/\"/g, '`\"').replace(/\\$/g, '`$')}\"`;\n        } else {\n          command = `taskkill /F /IM \"${processName}\" /T`;\n        }\n        \n        await execAsync(command, { windowsHide: true });\n      } catch (taskkillError: any) {\n        const taskkillMsg = (taskkillError?.message || taskkillError?.stderr || String(taskkillError) || '').toLowerCase();\n        \n        // Ignore nu process khng tn ti\n        if (\n          taskkillMsg.includes('not found') ||\n          taskkillMsg.includes('no tasks are running') ||\n          taskkillMsg.includes('the system cannot find')\n        ) {\n          this.logger.debug(`Process not found (expected): ${processName}`);\n          return;\n        }\n\n        // Nu vn l \"access denied\", log warning nhng khng throw (best effort)\n        if (taskkillMsg.includes('access is denied') || taskkillMsg.includes('access denied')) {\n          this.logger.warn(`Cannot kill process (access denied): ${processName}. Process may require administrator privileges to terminate.`);\n          return;\n        }\n\n        // Log warning cho cc li khc nhng khng throw (best effort)\n        this.logger.warn(`Kill process warning: ${taskkillMsg}`);\n      }\n    }\n  }\n\n  /**\n   * Kill process bng PowerShell Stop-Process (x l child processes tt hn)\n   */\n  private async forceKillWithPowerShell(processBaseName: string, useAdmin: boolean = false): Promise<void> {\n    // S dng PowerShell Stop-Process vi -Force  kill tt c child processes\n    // -Force s kill process ngay c khi c child processes\n    const escapedName = processBaseName.replace(/'/g, \"''\");\n    const killCommand = `Get-Process -Name '${escapedName}' -ErrorAction SilentlyContinue | Stop-Process -Force -ErrorAction Stop`;\n    \n    let command: string;\n    \n    if (useAdmin) {\n      // S dng Start-Process vi RunAs  c quyn admin\n      // Escaping: single quotes trong PowerShell argument list\n      const escapedKillCommand = killCommand.replace(/'/g, \"''\").replace(/\"/g, '`\"');\n      // S dng double quotes bn ngoi v escape ng cch\n      const psCommand = `Start-Process powershell -ArgumentList '-NoProfile','-ExecutionPolicy','Bypass','-Command',\\\"${escapedKillCommand}\\\" -Verb RunAs -Wait -WindowStyle Hidden`;\n      command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${psCommand.replace(/\"/g, '`\"').replace(/\\$/g, '`$')}\"`;\n    } else {\n      // Dng single quotes trong PowerShell  trnh escape phc tp\n      command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${killCommand.replace(/\"/g, '`\"').replace(/\\$/g, '`$')}\"`;\n    }\n\n    try {\n      await execAsync(command, { windowsHide: true });\n    } catch (error: any) {\n      const errorMsg = (error?.message || error?.stderr || String(error) || '').toLowerCase();\n      \n      // Ignore nu process khng tn ti\n      if (\n        errorMsg.includes('cannot find a process') ||\n        errorMsg.includes('process not found') ||\n        errorMsg.includes('cannot find process')\n      ) {\n        this.logger.debug(`Process not found (expected): ${processBaseName}`);\n        return;\n      }\n      \n      throw error; // Re-throw  caller x l\n    }\n  }\n\n  /**\n   * Kim tra xem process c ang chy khng\n   */\n  private async isRunning(processName: string): Promise<boolean> {\n    try {\n      const command = `tasklist /FI \"IMAGENAME eq ${processName}\" /FO CSV /NH`;\n      const { stdout } = await execAsync(command, { windowsHide: true });\n      \n      const output = stdout.toLowerCase().trim();\n      if (!output || output.includes('no tasks') || output === 'info:') {\n        return false;\n      }\n      \n      return output.includes(processName.toLowerCase());\n    } catch (error) {\n      // Nu c li khi check, coi nh khng chy\n      return false;\n    }\n  }\n\n  /**\n   * i cho n khi process khng cn chy\n   */\n  private async waitUntilNotRunning(processName: string, timeoutMs: number): Promise<void> {\n    const start = Date.now();\n    \n    while (Date.now() - start < timeoutMs) {\n      const running = await this.isRunning(processName);\n      if (!running) {\n        return;\n      }\n      await sleep(250);\n    }\n    \n    this.logger.warn(`Process still running after ${timeoutMs}ms: ${processName}`);\n  }\n\n  /**\n   * Khi ng ng dng\n   * @param args - Tham s khi ng ng dng\n   * @param args.exePath - ng dn y  n file exe\n   * @param args.startTarget - Target  khi ng (exe name, URL, file path)\n   * @param args.runAsAdmin - Chy vi quyn Administrator (hin UAC prompt)\n   */\n  private async startApp(args: { exePath?: string; startTarget?: string; runAsAdmin?: boolean }): Promise<void> {\n    const target = args.exePath ?? args.startTarget ?? '';\n    const runAsAdmin = args.runAsAdmin ?? false;\n    \n    if (!target) {\n      throw new Error('Start target is empty');\n    }\n\n    // TODO: Uncomment when debugging\n    // const adminText = runAsAdmin ? ' as Administrator' : '';\n    // this.logger.debug(`[restart] Starting app${adminText}: ${target}`);\n\n    try {\n      if (runAsAdmin) {\n        // S dng PowerShell Start-Process vi -Verb RunAs  chy vi quyn admin\n        // S hin th UAC prompt cho ngi dng\n        // S dng single quotes trong PowerShell  trnh phi escape c bit\n        const escapedTarget = target.replace(/'/g, \"''\"); // Escape single quotes trong PowerShell\n        const psCommand = `Start-Process -FilePath '${escapedTarget}' -Verb RunAs`;\n        // Escape double quotes v $ cho command line\n        const escapedCommand = psCommand.replace(/\"/g, '`\"').replace(/\\$/g, '`$');\n        const command = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"${escapedCommand}\"`;\n        \n        await execAsync(command);\n        this.logger.log(`App started with Administrator privileges: ${target}`);\n      } else {\n        // S dng start command ca Windows  m ng dng bnh thng\n        // start \"\"  khng hin th title ca command prompt\n        const command = `start \"\" \"${target}\"`;\n        await execAsync(command, { windowsHide: true });\n\n        this.logger.log(`App started successfully: ${target}`);\n      }\n      \n      // i mt cht  ng dng khi ng\n      await sleep(500);\n      \n    } catch (error: any) {\n      const errorMsg = error?.message || String(error);\n      this.logger.error(`Failed to start app: ${target}`, errorMsg);\n      throw error;\n    }\n  }\n\n  // -----------------------------\n  // Utils\n  // -----------------------------\n\n  private escapePs(value: string): string {\n    // Escape \" v $ trong PowerShell string\n    return value.replace(/\"/g, '`\"').replace(/\\$/g, '`$');\n  }\n}\n","module.exports = require(\"child_process\");","module.exports = require(\"util\");","import { Injectable, Logger } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { randomUUID } from 'crypto';\n\n// Lua script for atomic unlock (only unlock if lockId matches)\nconst UNLOCK_SCRIPT = `\nif redis.call(\"GET\", KEYS[1]) == ARGV[1] then\n  return redis.call(\"DEL\", KEYS[1])\nelse\n  return 0\nend\n`;\n\n@Injectable()\nexport class RedisLockService {\n  private readonly logger = new Logger('RedisLockService');\n  private readonly DEFAULT_LOCK_TTL = 3 * 60 * 1000; // 3 minutes default\n\n  constructor(private readonly redisService: RedisService) {}\n\n  /**\n   * Acquire lock for a device (atomic operation using SET NX EX)\n   */\n  async acquireLock(\n    key: string,\n    ttl: number = this.DEFAULT_LOCK_TTL\n  ): Promise<boolean> {\n    try {\n      const lockId = randomUUID();\n      const ttlSeconds = Math.ceil(ttl / 1000);\n\n      // Use atomic SET NX EX to acquire lock\n      // This ensures only one process can acquire the lock\n      const client = await this.redisService.getClient();\n      const result = await client.set(key, lockId, 'EX', ttlSeconds, 'NX');\n\n      return result === 'OK';\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Release lock for a device (atomic operation using Lua script)\n   */\n  async releaseLock(key: string): Promise<void> {\n    try {\n      const client = await this.redisService.getClient();\n      \n      // Get current lockId before releasing\n      const lockId = await client.get(key);\n      \n      if (!lockId) {\n        return;\n      }\n\n      // Use Lua script to atomically check and delete only if lockId matches\n      // This prevents releasing lock that was acquired by another process\n      const result = await client.eval(\n        UNLOCK_SCRIPT,\n        1, // number of keys\n        key, // KEYS[1] - lock key\n        lockId as string // ARGV[1] - lockId to verify\n      ) as number;\n\n      if (result === 1) {\n        this.logger.log(`Released lock (lockId: ${key}:${lockId})`);\n      } else {\n        // Lock was already released or changed by another process\n        this.logger.warn(`Lock was already released or changed (expected lockId: ${key}:${lockId})`);\n      }\n    } catch (error) {\n      this.logger.error(`Error releasing lock: ${key} ${error.message}`, error.stack);\n    }\n  }\n\n  /**\n   * Get current lock\n   */\n  async getLock(key: string): Promise<string | null> {\n    try {\n      const lockId = await this.redisService.get(key);\n\n      return lockId ?? null;\n    } catch (error) {\n      this.logger.error(`[${key}] Error getting lock: ${error.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Check if lock is acquired\n   */\n  async isLocked(key: string): Promise<boolean> {\n    try {\n      const lockId = await this.getLock(key);\n\n      return !!lockId;\n    } catch (error) {\n      this.logger.error(`[${key}] Error checking lock status: ${error.message}`);\n      // On error, assume not locked (fail open)\n      return false;\n    }\n  }\n}\n\n","export const SYSTEM_LOCK_BOXPHONE = 'system:lock:boxphone';\nexport const SYSTEM_LOCK_PAUSE_PROCESSING = 'system:lock:pauseprocessing';","import { plainToInstance } from 'class-transformer';\nimport { validate } from 'class-validator';\n\nexport const validateObjectResult = async <T extends object>(\n  DtoClass: new () => T,\n  payload: unknown,\n) => {\n  const instance = plainToInstance(DtoClass, payload, {\n    enableImplicitConversion: true,\n  });\n\n  const errors = await validate(instance, {\n    whitelist: true,\n    forbidNonWhitelisted: true,\n    forbidUnknownValues: true,\n    validationError: { target: false, value: false },\n  });\n\n  return { ok: errors.length === 0, instance, errors };\n}","module.exports = require(\"class-transformer\");","import { Controller, Get, Post, Logger } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse } from '@nestjs/swagger';\nimport { WithdrawalJobManagerService } from './withdrawal-job-manager.service';\n\n@ApiTags('withdrawal')\n@Controller('api/withdrawal')\nexport class WithdrawalController {\n  private readonly logger = new Logger('WithdrawalController');\n\n  constructor(\n    private readonly jobManagerService: WithdrawalJobManagerService,\n  ) {}\n\n  @Get('queue/stats')\n  @ApiOperation({ summary: 'Get withdrawal queue statistics' })\n  @ApiResponse({ status: 200, description: 'Queue statistics' })\n  async getQueueStats() {\n    return await this.jobManagerService.getQueueStats();\n  }\n\n  @Get('queue/debug')\n  @ApiOperation({ summary: 'Get detailed queue debug information' })\n  @ApiResponse({ status: 200, description: 'Detailed queue debug info' })\n  async debugQueue() {\n    return await this.jobManagerService.debugQueue();\n  }\n\n  @Post('queue/trigger')\n  @ApiOperation({ summary: 'Manually trigger job picking' })\n  @ApiResponse({ status: 200, description: 'Job picking triggered' })\n  async triggerJobPicking() {\n    this.logger.log('Manually triggering job picking...');\n    await this.jobManagerService.triggerPickJobs(1);\n    const stats = await this.jobManagerService.getQueueStats();\n    return {\n      success: true,\n      message: 'Job picking triggered',\n      stats,\n    };\n  }\n\n  // TODO: remove\n  // @Post('queue/start')\n  // @ApiOperation({ summary: 'Manually start job processing' })\n  // @ApiResponse({ status: 200, description: 'Job processing started' })\n  // async startProcessing() {\n  //   this.logger.log('Manually starting job processing...');\n  //   await this.jobManagerService.startProcessing();\n  //   const stats = await this.jobManagerService.getQueueStats();\n  //   return {\n  //     success: true,\n  //     message: 'Job processing started',\n  //     stats,\n  //   };\n  // }\n}\n\n\n","import { Module } from '@nestjs/common';\nimport { HcBoxService } from './hcbox.service';\n\n@Module({\n  providers: [HcBoxService],\n  exports: [HcBoxService],\n})\nexport class HcBoxModule {}\n\n","import { Inject, Injectable, Logger } from '@nestjs/common';\nimport { Withdrawal } from '../../common/interfaces/withdrawal.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';\nimport { ICaptureScreenOptions, IHCSwipeOptions, IPandaSwipeOptions, IWebSocketService } from '@/common/modules/websocket/interface/websocket.interface';\nimport { sleep } from '@/common/utils/time';\n\n@Injectable()\nexport class HcBoxService {\n  private readonly logger = new Logger('HcBoxService');\n\n  constructor(\n    @Inject(WEBSOCKET_SERVICE)\n    private readonly wsService: IWebSocketService,\n  ) {}\n\n  async listDevices() {\n    try {\n      return await this.wsService.listDevices();\n    } catch (error) {\n      this.logger.error(`Error listing devices: ${error.message}`);\n      throw error;\n    }\n  }\n\n  async executeTransfer(withdrawal: Withdrawal, deviceId: string): Promise<boolean> {\n    try {\n      this.logger.log(`Executing transfer for withdrawal ${withdrawal.withdrawalId} on device ${deviceId}`);\n\n      // Step 1: Launch bank app (example bundle ID for Vietcombank app)\n      // Note: This is a placeholder - actual bundle ID should be configured per bank\n      const bankBundleId = this.getBankBundleId(withdrawal.bankCode);\n      if (bankBundleId) {\n        await this.wsService.launchApp(deviceId, bankBundleId);\n        await sleep(3000); // Wait for app to launch\n      }\n\n      // Step 2: Navigate to transfer screen\n      // This is a simplified flow - actual implementation would need to know the app's UI structure\n      // Click on transfer/money transfer button (example coordinates - should be configured)\n      await this.wsService.click(deviceId, 0.5, 0.3, 0.2); // Example: center-top area\n      await sleep(2000);\n\n      // Step 3: Enter recipient account number\n      // This would require OCR or predefined coordinates based on the app\n      // For now, this is a placeholder that needs to be customized per bank app\n      this.logger.warn('Transfer execution flow needs to be customized per bank app UI');\n\n      // Step 4: Enter amount\n      // Step 5: Enter description\n      // Step 6: Confirm transfer\n\n      // For now, return true as a placeholder\n      // In production, this should verify the transfer was successful\n      this.logger.log(`Transfer execution completed for withdrawal ${withdrawal.withdrawalId}`);\n      return true;\n    } catch (error) {\n      this.logger.error(`Error executing transfer for withdrawal ${withdrawal.withdrawalId}: ${error.message}`);\n      throw error;\n    }\n  }\n\n  private getBankBundleId(bankCode: string): string | null {\n    // Map bank codes to iOS app bundle IDs\n    // These are examples and should be configured properly\n    const bundleIds: Record<string, string> = {\n      VIETCOMBANK: 'com.vietcombank.mobilebanking',\n      TPBANK: 'com.tpbank.mobilebanking',\n      TECHCOMBANK: 'com.techcombank.mobilebanking',\n      // Add more banks as needed\n    };\n\n    return bundleIds[bankCode] || null;\n  }\n\n  // Expose WebSocket service methods for direct use if needed\n  async click(deviceId: string, x: number, y: number, duration = 0.2): Promise<string> {\n    return this.wsService.click(deviceId, x, y, duration);\n  }\n\n  async swipe(deviceId: string, options: IHCSwipeOptions | IPandaSwipeOptions): Promise<string> {\n    return this.wsService.swipe(deviceId, options);\n  }\n\n  async screen(deviceId: string, options: ICaptureScreenOptions): Promise<string> {\n    return this.wsService.captureScreen(deviceId, options);\n  }\n\n  async home(deviceId: string): Promise<string> {\n    return this.wsService.home(deviceId);\n  }\n\n  async inputNumpadNumber(deviceId: string, value: string): Promise<void> {\n    return this.wsService.inputNumpadNumber(deviceId, value);\n  }\n\n  inputText(deviceId: string, text: string): Promise<void> {\n    return this.wsService.inputText(deviceId, text);\n  }\n}\n\n","import { Module, forwardRef } from '@nestjs/common';\nimport { DeviceController } from './device.controller';\nimport { DeviceService } from './device.service';\nimport { DeviceLockService } from './device-lock.service';\nimport { HcBoxModule } from '../hcbox/hcbox.module';\nimport { RedisService } from '../../common/services/redis.service';\nimport { BankModule } from '../bank/bank.module';\n\n@Module({\n  imports: [\n    HcBoxModule,\n    forwardRef(() => BankModule),\n  ],\n  controllers: [DeviceController],\n  providers: [\n    DeviceService,\n    DeviceLockService,\n    RedisService,\n  ],\n  exports: [\n    DeviceService,\n    DeviceLockService,\n  ],\n})\nexport class DeviceModule {}\n\n","import { Controller, Get, Put, Param, Body, Post, Delete, Render, HttpException, HttpStatus, Logger } from '@nestjs/common';\nimport { DeviceService } from './device.service';\nimport { UpdateDeviceConfigDto } from './dto/device-config.dto';\nimport { BankService } from '../bank/bank.service';\nimport { config } from '@/common/constants/config';\n\n@Controller()\nexport class DeviceController {\n  private readonly logger = new Logger('DeviceController');\n\n  constructor(\n    private readonly deviceService: DeviceService,\n    private readonly bankService: BankService,\n  ) { }\n\n  @Get()\n  @Render('devices')\n  async getDevicesPage() {\n    const devices = await this.deviceService.listDevices();\n    const serviceStatus = await this.deviceService.getServiceStatus();\n\n    return {\n      devices,\n      serviceStatus,\n      banks: ['ACB', 'HDBANK', 'PGBANK', 'TECHCOMBANK', 'TPBANK', 'VIETCOMBANK'],\n      boxType: config.boxType,\n    };\n  }\n\n  @Get('api/devices')\n  async getDevices() {\n    const devices = await this.deviceService.listDevices();\n    return {\n      success: true,\n      data: devices,\n    };\n  }\n\n  @Get('api/devices/:deviceId/config')\n  async getDeviceConfig(@Param('deviceId') deviceId: string) {\n    const config = await this.deviceService.getDeviceConfigSafe(deviceId);\n    return {\n      success: true,\n      data: config,\n    };\n  }\n\n  @Post('api/devices/:deviceId/retryLogin')\n  async retryLogin(@Param('deviceId') deviceId: string) {\n    try {\n      this.logger.log(`Retry login requested for device ${deviceId}`);\n\n      // Get device config to check bankCode and status\n      const deviceConfig = await this.deviceService.getDeviceConfig(deviceId);\n\n      if (!deviceConfig) {\n        throw new HttpException(\n          {\n            success: false,\n            error: `Device ${deviceId} not found or not configured`,\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      if (!deviceConfig.bankCode || deviceConfig.bankCode.trim() === '') {\n        throw new HttpException(\n          {\n            success: false,\n            error: `Device ${deviceId} does not have bankCode configured. Please configure bankCode first.`,\n          },\n          HttpStatus.BAD_REQUEST,\n        );\n      }\n\n      // Attempt to login\n      const bankCode = deviceConfig.bankCode.toUpperCase();\n      await this.bankService.login(bankCode, deviceId);\n\n      return {\n        success: true,\n        message: `Successfully logged in to ${bankCode} on device ${deviceId}`,\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error retrying login for device ${deviceId}: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to retry login',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Put('api/devices/:deviceId/config')\n  async updateDeviceConfig(\n    @Param('deviceId') deviceId: string,\n    @Body() dto: UpdateDeviceConfigDto,\n  ) {\n    try {\n      this.logger.log(`Updating device config for ${deviceId}: ${JSON.stringify(dto)}`);\n\n      // Get existing config to check current status if status is not provided\n      const existingConfig = await this.deviceService.getDeviceConfig(deviceId);\n      const finalStatus = dto.status !== undefined ? dto.status : existingConfig?.status || 'deactive';\n\n      // Manual validation: if status is 'active' (either from dto or existing), all fields are required\n      if (finalStatus === 'active') {\n        const errors: string[] = [];\n\n        // Check bankCode: from dto or existing config\n        const bankCode = dto.bankCode !== undefined ? dto.bankCode : existingConfig?.bankCode;\n        if (!bankCode || bankCode.trim() === '') {\n          errors.push('Bank Code l bt buc khi status l active');\n        }\n\n        // Check availableAmount: from dto or existing config\n        const availableAmount = dto.availableAmount !== undefined ? dto.availableAmount : existingConfig?.availableAmount;\n        if (availableAmount === undefined || availableAmount === null || availableAmount < 0) {\n          errors.push('Available Amount l bt buc v phi >= 0 khi status l active');\n        }\n\n        // Check password: from dto or existing config\n        const password = dto.password !== undefined ? dto.password : existingConfig?.password;\n        if (!password || password.trim() === '') {\n          errors.push('Password l bt buc khi status l active');\n        }\n\n        // Check smartOTP: from dto or existing config\n        const smartOTP = dto.smartOTP !== undefined ? dto.smartOTP : existingConfig?.smartOTP;\n        if (!smartOTP || smartOTP.trim() === '') {\n          errors.push('Smart OTP l bt buc khi status l active');\n        }\n\n        if (errors.length > 0) {\n          throw new HttpException(\n            {\n              success: false,\n              error: errors.join(', '),\n            },\n            HttpStatus.BAD_REQUEST,\n          );\n        }\n      }\n\n      const config = await this.deviceService.updateDeviceConfig(deviceId, dto);\n      return {\n        success: true,\n        data: config,\n      };\n    } catch (error) {\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      this.logger.error(`Error updating device config for ${deviceId}: ${error.message}`, error.stack);\n      throw new HttpException(\n        {\n          success: false,\n          error: error.message || 'Failed to update device config',\n        },\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('api/service/status')\n  async getServiceStatus() {\n    const status = await this.deviceService.getServiceStatus();\n    return {\n      success: true,\n      data: { status },\n    };\n  }\n\n  @Post('api/service/start')\n  async startService() {\n    return await this.deviceService.startService();\n  }\n\n  @Post('api/service/stop')\n  async stopService() {\n    await this.deviceService.setServiceStatus('inactive');\n    return {\n      success: true,\n      message: 'Service stopped successfully',\n    };\n  }\n\n  @Delete('api/devices/:deviceId/config')\n  async deleteDeviceConfig(@Param('deviceId') deviceId: string) {\n    await this.deviceService.deleteDeviceConfig(deviceId);\n    return {\n      success: true,\n      message: 'Device config deleted successfully',\n    };\n  }\n}\n\n","import { IsOptional, IsString, IsNumber, IsIn, ValidateIf, IsNotEmpty, Min } from 'class-validator';\n\nexport class UpdateDeviceConfigDto {\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Bank Code is required when status is active' })\n  @IsString()\n  @IsOptional()\n  bankCode?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Available Amount is required when status is active' })\n  @IsNumber()\n  @Min(0, { message: 'Available Amount must be greater than or equal to 0' })\n  @IsOptional()\n  availableAmount?: number;\n\n  @IsOptional()\n  @IsString()\n  @IsIn(['active', 'deactive'])\n  status?: 'active' | 'deactive';\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Password is required when status is active' })\n  @IsString()\n  @IsOptional()\n  password?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Smart OTP is required when status is active' })\n  @IsString()\n  @IsOptional()\n  smartOTP?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Account No is required when status is active' })\n  @IsString()\n  @IsOptional()\n  accountNo?: string;\n\n  @ValidateIf((o) => o.status === 'active')\n  @IsNotEmpty({ message: 'Account Name is required when status is active' })\n  @IsString()\n  @IsOptional()\n  accountName?: string;\n}\n\nexport interface DeviceConfig {\n  deviceId: string;\n  bankCode?: string;\n  availableAmount: number;\n  status: 'active' | 'deactive';\n  password: string;\n  smartOTP: string;\n  accountNo: string;\n  accountName: string;\n}\n\n","import { Module, forwardRef } from '@nestjs/common';\nimport { BankService } from './bank.service';\nimport { AcbService } from './acb.service';\nimport { PgService } from './pg.service';\nimport { HdBankService } from './hdbank.service';\nimport { BankController } from './bank.controller';\nimport { HcBoxModule } from '../hcbox/hcbox.module';\nimport { DeviceModule } from '../device/device.module';\nimport { WebSocketModule } from '../../common/modules/websocket/websocket.module';\nimport { SessionManagementService } from './session-management.service';\nimport { SessionRefreshScheduler } from './session-refresh.scheduler';\nimport { RedisService } from '../../common/services/redis.service';\nimport { OCRModule } from '../ocr/ocr.module';\nimport { NotificationModule } from '../notifiction/notification.module';\nimport { VietcombankService } from './vietcombank.service';\n\n@Module({\n  imports: [\n    HcBoxModule,\n    forwardRef(() => DeviceModule),\n    WebSocketModule,\n    OCRModule,\n    NotificationModule\n  ],\n  controllers: [BankController],\n  providers: [\n    BankService,\n    AcbService,\n    PgService,\n    HdBankService,\n    VietcombankService,\n    SessionManagementService,\n    SessionRefreshScheduler,\n    RedisService,\n  ],\n  exports: [BankService],\n})\nexport class BankModule {}\n\n","import { Controller, Post, Param, Get, Query, Logger, HttpException, HttpStatus, Inject } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiParam, ApiQuery, ApiResponse } from '@nestjs/swagger';\nimport { BankService } from './bank.service';\nimport { IBankService } from './interfaces/bank-service.interface';\nimport { config } from '@/common/constants/config';\nimport { IWebSocketService, PandaSwipeType } from '@/common/modules/websocket/interface/websocket.interface';\nimport { WEBSOCKET_SERVICE } from '@/common/modules/websocket/constants/websocket';;\nimport { mkdir, readFile, writeFile, rm } from 'fs/promises';\nimport { ImagePreprocessingService } from '../ocr/services/image-preprocessing.service';\n\n@ApiTags('bank')\n@Controller('api/bank/:bankCode')\nexport class BankController {\n  private readonly logger = new Logger('BankController');\n\n  constructor(\n    private readonly bankService: BankService,\n    @Inject(WEBSOCKET_SERVICE)\n    protected readonly wsService: IWebSocketService,\n    private readonly imagePreprocessingService: ImagePreprocessingService,\n  ) { }\n\n  /**\n   * Get bank service by bank code\n   */\n  private getBankService(bankCode: string): IBankService {\n    const service = this.bankService.getBankService(bankCode);\n    if (!service) {\n      throw new HttpException(\n        {\n          success: false,\n          error: `Bank service not found for bank code: ${bankCode}. Supported banks: ${this.bankService.getSupportedBanks().join(', ')}`,\n        },\n        HttpStatus.BAD_REQUEST,\n      );\n    }\n    return service;\n  }\n\n  @Get('devices')\n  @ApiOperation({ summary: 'Get list of available devices' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiResponse({ status: 200, description: 'List of devices retrieved successfully' })\n  async getDevices(@Param('bankCode') bankCode: string) {\n    try {\n      const devices = await this.wsService.listDevices();\n      return {\n        success: true,\n        data: devices,\n      };\n    } catch (error) {\n      this.logger.error(`Error getting devices: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/launch-app/:deviceId')\n  @ApiOperation({ summary: 'Test launching bank app on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiResponse({ status: 200, description: 'App launched successfully' })\n  async testLaunchApp(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n  ) {\n    try {\n      const service = this.getBankService(bankCode);\n      this.logger.log(`Testing ${bankCode} app launch on device: ${deviceId}`);\n      \n      await service.launchApp(deviceId);\n\n      return {\n        success: true,\n        message: `${bankCode} app launched successfully on device ${deviceId}`,\n      };\n    } catch (error) {\n      this.logger.error(`Error testing ${bankCode} app launch: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/capture-screen/:deviceId')\n  @ApiOperation({ summary: 'Test screen capture on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'name', description: 'Screen capture name (optional)', required: false })\n  @ApiQuery({ name: 'quality', description: 'Image quality (0-1, default: 0.5)', required: false })\n  @ApiResponse({ status: 200, description: 'Screen captured successfully' })\n  async testCaptureScreen(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('name') name?: string,\n    @Query('quality') quality?: string,\n  ) {\n    try {\n      this.logger.log(`Testing screen capture on device: ${deviceId}`);\n\n      const qualityValue = quality ? parseFloat(quality) : 0.5;\n      const captureName = name || `test-screen-capture-${Date.now()}`;\n\n      const base64Image = await this.wsService.captureScreen(deviceId, {\n        quality: qualityValue,\n        folderPath: `C:/boxscreen/${captureName}.png`,\n      });\n\n      return {\n        success: true,\n        message: `Screen captured successfully on device ${deviceId}`,\n        data: {\n          base64Image,\n          imageLength: base64Image?.length ?? 0,\n        },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing screen capture: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/click/:deviceId')\n  @ApiOperation({ summary: 'Test clicking at specific coordinates on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'x', description: 'X coordinate (HC: 0-1, Panda: 0-100)', required: true })\n  @ApiQuery({ name: 'y', description: 'Y coordinate (Hc: 0-1), Panda: 0-100', required: true })\n  @ApiResponse({ status: 200, description: 'Click completed successfully' })\n  async testClickAtCoordinates(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('x') x: string,\n    @Query('y') y: string,\n  ) {\n    try {\n      const xCoord = parseFloat(x);\n      const yCoord = parseFloat(y);\n\n      if (isNaN(xCoord) || isNaN(yCoord)) {\n        return {\n          success: false,\n          error: 'Invalid coordinates. x and y must be numbers between 0 and 1',\n          example: `/api/bank/${bankCode}/test/click/{deviceId}?x=0.5&y=0.55`,\n        };\n      }\n\n      this.logger.log(`Testing click at coordinates (${xCoord}, ${yCoord}) on device: ${deviceId}`);\n\n      await this.wsService.click(deviceId, xCoord, yCoord);\n\n      return {\n        success: true,\n        message: `Click completed successfully at coordinates (${xCoord}, ${yCoord}) on device ${deviceId}`,\n        coordinates: { x: xCoord, y: yCoord },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing click at coordinates: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/swipe/:deviceId')\n  @ApiOperation({ summary: 'Test swiping on a device. Format is determined by config.boxType (HC or PANDA)' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'x', description: 'X coordinate (HC: 0-1, Panda: 0-100). Required for HC and Panda types 0,1,2,10. Optional for Panda types 4,5,6,7,8,9', required: false })\n  @ApiQuery({ name: 'y', description: 'Y coordinate (HC: 0-1, Panda: 0-100). Required for HC and Panda types 0,1,2,10. Optional for Panda types 4,5,6,7,8,9', required: false })\n  @ApiQuery({ name: 'type', description: 'Panda pointer event type: 0=(press), 1=(lift), 2=(move), 4=(scroll up), 5=(scroll down), 6=(swipe up), 7=(swipe down), 8=(swipe left), 9=(swipe right), 10=(click). Required for Panda format.', required: false })\n  @ApiQuery({ name: 'endX', description: 'End X coordinate for HC (required for HC: 0-1)', required: false })\n  @ApiQuery({ name: 'endY', description: 'End Y coordinate for HC (required for HC: 0-1)', required: false })\n  @ApiQuery({ name: 'duration', description: 'Swipe duration for HC (default: 0.2)', required: false })\n  @ApiResponse({ status: 200, description: 'Swipe completed successfully' })\n  async testSwipe(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('x') x?: string,\n    @Query('y') y?: string,\n    @Query('type') type?: string,\n    @Query('endX') endX?: string,\n    @Query('endY') endY?: string,\n    @Query('duration') duration?: string,\n  ) {\n    try {\n      // Determine format based on config.boxType\n      const isPandaFormat = config.boxType === 'PANDA';\n      const isHCFormat = config.boxType === 'HC';\n\n      if (isPandaFormat) {\n        // Panda format: type is required\n        if (!type) {\n          return {\n            success: false,\n            error: 'For Panda format: type is required',\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?type=0`,\n          };\n        }\n\n        // Validate type: must be one of the valid Panda types\n        const validTypes: PandaSwipeType[] = ['0', '1', '2', '4', '5', '6', '7', '8', '9', '10'];\n        if (!validTypes.includes(type as PandaSwipeType)) {\n          return {\n            success: false,\n            error: `Invalid type. Type must be one of: 0 (/press), 1 (/lift), 2 (/move), 4 (/scroll up), 5 (/scroll down), 6 (/swipe up), 7 (/swipe down), 8 (/swipe left), 9 (/swipe right), 10 (/click)`,\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?type=0`,\n          };\n        }\n\n        // For scroll (4,5) and swipe directions (6,7,8,9), x and y are optional\n        const noCoordinateTypes: PandaSwipeType[] = ['4', '5', '6', '7', '8', '9'];\n        const isNoCoordinateType = noCoordinateTypes.includes(type as PandaSwipeType);\n\n        // For other types (0,1,2,10), x and y are required\n        if (!isNoCoordinateType && (!x || !y)) {\n          return {\n            success: false,\n            error: `For Panda type ${type}: x and y are required`,\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n          };\n        }\n\n        // Build options object\n        const pandaOptions: any = {\n          type: type as PandaSwipeType,\n        };\n\n        // Only add x, y if provided (required for non-swipe-direction types, optional for swipe directions)\n        if (x && y) {\n          const xCoord = parseFloat(x);\n          const yCoord = parseFloat(y);\n\n          if (isNaN(xCoord) || isNaN(yCoord)) {\n            return {\n              success: false,\n              error: 'Invalid coordinates. x and y must be numbers between 0 and 100 for Panda',\n              example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n            };\n          }\n\n          // Validate coordinates for Panda (0-100)\n          if (xCoord < 0 || xCoord > 100 || yCoord < 0 || yCoord > 100) {\n            return {\n              success: false,\n              error: 'Invalid coordinates. x and y must be between 0 and 100 for Panda',\n              example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=50&y=30&type=${type}`,\n            };\n          }\n\n          pandaOptions.x = xCoord.toString();\n          pandaOptions.y = yCoord.toString();\n        }\n\n        this.logger.log(`Testing Panda swipe on device: ${deviceId} with type=${type}${x && y ? `, x=${x}, y=${y}` : ' (swipe direction, no coordinates)'}`);\n\n        await this.wsService.swipe(deviceId, pandaOptions);\n\n        return {\n          success: true,\n          message: `Panda swipe completed successfully on device ${deviceId}`,\n          coordinates: {\n            type: type,\n            ...(x && y ? { x, y } : {}),\n          },\n        };\n      } else if (isHCFormat) {\n        // HC format: x, y, endX, endY, duration (x, y, endX, endY required)\n        if (!x || !y || !endX || !endY) {\n          return {\n            success: false,\n            error: 'For HC format: x, y, endX, and endY are required',\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        const xCoord = parseFloat(x);\n        const yCoord = parseFloat(y);\n        const endXCoord = parseFloat(endX);\n        const endYCoord = parseFloat(endY);\n        const durationValue = duration ? parseFloat(duration) : 0.2;\n\n        if (isNaN(xCoord) || isNaN(yCoord) || isNaN(endXCoord) || isNaN(endYCoord)) {\n          return {\n            success: false,\n            error: 'Invalid coordinates. x, y, endX, and endY must be numbers between 0 and 1 for HC',\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        // Validate coordinates for HC (0-1)\n        if (xCoord < 0 || xCoord > 1 || yCoord < 0 || yCoord > 1 ||\n          endXCoord < 0 || endXCoord > 1 || endYCoord < 0 || endYCoord > 1) {\n          return {\n            success: false,\n            error: 'Invalid coordinates. x, y, endX, and endY must be between 0 and 1 for HC',\n            example: `/api/bank/${bankCode}/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3`,\n          };\n        }\n\n        this.logger.log(`Testing HC swipe from (${xCoord}, ${yCoord}) to (${endXCoord}, ${endYCoord}) on device: ${deviceId}`);\n\n        await this.wsService.swipe(deviceId, {\n          x: xCoord,\n          y: yCoord,\n          endX: endXCoord,\n          endY: endYCoord,\n          duration: durationValue,\n        });\n\n        return {\n          success: true,\n          message: `HC swipe completed successfully from (${xCoord}, ${yCoord}) to (${endXCoord}, ${endYCoord}) on device ${deviceId}`,\n          coordinates: {\n            start: { x: xCoord, y: yCoord },\n            end: { x: endXCoord, y: endYCoord },\n            duration: durationValue,\n          },\n        };\n      } else {\n        return {\n          success: false,\n          error: `Invalid box type configuration: ${config.boxType}. Must be 'HC' or 'PANDA'`,\n        };\n      }\n    } catch (error) {\n      this.logger.error(`Error testing swipe: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/input-numpad/:deviceId')\n  @ApiOperation({ summary: 'Test inputting number using numpad layout on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'number', description: 'Number string to input (e.g., \"123\", \"456789\")', required: true })\n  @ApiResponse({ status: 200, description: 'Numpad number input completed successfully' })\n  async testInputNumpadNumber(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('number') number: string,\n  ) {\n    try {\n\n      if (!number || number.trim().length === 0) {\n        return {\n          success: false,\n          error: 'Number is required and cannot be empty',\n          example: `/api/bank/${bankCode}/test/input-numpad/{deviceId}?number=123456`,\n        };\n      }\n\n      // Validate that number contains only digits\n      if (!/^\\d+$/.test(number)) {\n        return {\n          success: false,\n          error: 'Number must contain only digits (0-9)',\n          example: `/api/bank/${bankCode}/test/input-numpad/{deviceId}?number=123456`,\n        };\n      }\n\n      this.logger.log(`Testing numpad number input \"${number}\" on device: ${deviceId}`);\n\n      await this.wsService.inputNumpadNumber(deviceId, number);\n\n      return {\n        success: true,\n        message: `Numpad number input completed successfully on device ${deviceId}`,\n        data: {\n          number: number,\n          digits: number.split('').map(d => parseInt(d)),\n        },\n      };\n    } catch (error) {\n      this.logger.error(`Error testing numpad number input: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/input-text/:deviceId')\n  @ApiOperation({ summary: 'Test inputting text using keyboard layout on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'text', description: 'Text string to input (e.g., \"abc123\", \"test@email.com\")', required: true })\n  @ApiResponse({ status: 200, description: 'Text input completed successfully' })\n  async testInputText(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n    @Query('text') text: string,\n  ) {\n    try {\n      if (!text || text.trim().length === 0) {\n        return {\n          success: false,\n          error: 'Text is required and cannot be empty',\n          example: `/api/bank/${bankCode}/test/input-text/{deviceId}?text=abc123`,\n        };\n      }\n\n      this.logger.log(`Testing text input \"${text}\" on device: ${deviceId}`);\n\n      await this.wsService.inputText(deviceId, text);\n\n      return {\n        success: true,\n        message: `Text input completed successfully on device ${deviceId}`,\n      };\n    } catch (error) {\n      this.logger.error(`Error testing text input: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/press-return/:deviceId')\n  @ApiOperation({ summary: 'Test pressing return key on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiParam({ name: 'deviceId', description: 'Device ID' })\n  @ApiResponse({ status: 200, description: 'Return key pressed successfully' })\n  async testPressReturn(\n    @Param('bankCode') bankCode: string,\n    @Param('deviceId') deviceId: string,\n  ) {\n    try {\n      this.logger.log(`Testing press return key on device: ${deviceId}`);\n\n      await this.wsService.pressReturnKey(deviceId);\n\n      return {\n        success: true,\n        message: `Return key pressed successfully on device ${deviceId}`,\n        note: 'This key can dismiss keyboard or submit/enter depending on context',\n      };\n    } catch (error) {\n      this.logger.error(`Error testing press return: ${error.message}`);\n      return {\n        success: false,\n        error: error.message,\n      };\n    }\n  }\n\n  @Post('test/roi')\n  @ApiOperation({ summary: 'Test ROI detection on a device' })\n  @ApiParam({ name: 'bankCode', description: 'Bank code (ACB, PGBANK, etc.)' })\n  @ApiQuery({ name: 'deviceId', description: 'Device ID' })\n  @ApiQuery({ name: 'x', description: 'X coordinate', required: true })\n  @ApiQuery({ name: 'y', description: 'Y coordinate', required: true })\n  @ApiQuery({ name: 'width', description: 'Width', required: true })\n  @ApiQuery({ name: 'height', description: 'Height', required: true })\n  async testRoi(\n    @Param('bankCode') bankCode: string,\n    @Query('deviceId') deviceId: string,\n    @Query('x') x: string,\n    @Query('y') y: string,\n    @Query('width') width: string,\n    @Query('height') height: string,\n  ) {\n    const folderPath = 'C:/testroi';\n    \n    // Xa folder v to li (ti u hn xa tng file)\n    try {\n      await rm(folderPath, { recursive: true, force: true });\n      this.logger.log(` xa folder ${folderPath}`);\n    } catch (error) {\n      // Folder c th cha tn ti, khng sao\n      this.logger.debug(`Khng th xa folder: ${error.message}`);\n    }\n    \n    await mkdir(folderPath, { recursive: true });\n\n    await this.wsService.captureScreen(deviceId, {\n      folderPath: folderPath,\n    });\n\n    const imaggePath = await this.bankService.testGetLatestImagePath(folderPath);\n    const imageBuffer = await readFile(imaggePath);\n\n    const processedImage = await this.imagePreprocessingService.preprocess(\n      imageBuffer, \n      {\n        x: parseFloat(x),\n        y: parseFloat(y),\n        width: parseFloat(width),\n        height: parseFloat(height),\n      },  \n      undefined,\n      {\n        grayscale: true,\n        enhanceContrast: true\n      }\n    );\n\n    // Ghi image buffer ra file\n    const outputPath = `${folderPath}/processed-${Date.now()}.png`;\n    await writeFile(outputPath, processedImage.buffer);\n  }\n\n\n}\n\n","import { Global, Module } from '@nestjs/common';\nimport { HCWebSocketService } from './hc-websocket.service';\nimport { PandaWebSocketService } from './panda-websocket.service';\nimport { WEBSOCKET_SERVICE } from './constants/websocket';\nimport { config } from '@/common/constants/config';\n\n@Global()\n@Module({\n  providers: [\n    {\n      provide: WEBSOCKET_SERVICE,\n      useClass: config.boxType === 'PANDA' ? PandaWebSocketService : HCWebSocketService,\n    }\n  ],\n  exports: [WEBSOCKET_SERVICE],\n})\nexport class WebSocketModule {}\n\n","import { Injectable, Logger, OnModuleInit, OnModuleDestroy } from '@nestjs/common';\nimport * as WebSocket from 'ws';\nimport { ICaptureScreenOptions, IHCSwipeOptions, IWebSocketService } from './interface/websocket.interface';\nimport { COMMON_COORDINATES, KEYBOARD_LAYOUT, NUMPAD_LAYOUT } from '@/common/constants/keyboard';\nimport { sleep } from '@/common/utils/time';\nimport { omit } from 'lodash';\n\nexport interface HcBoxRequest {\n\taction: string;\n\tcomm?: any;\n\tsessionID?: string;\n}\n\nexport interface HcBoxResponse {\n\tStatusCode: number;\n\tresult: any;\n}\n\n@Injectable()\nexport class HCWebSocketService implements IWebSocketService, OnModuleInit, OnModuleDestroy {\n\tprivate readonly logger = new Logger('HCWebSocketService');\n\tprivate ws: WebSocket | null = null;\n\tprivate wsUrl: string;\n\tprivate reconnectAttempts = 0;\n\tprivate maxReconnectAttempts = 10;\n\tprivate reconnectDelay = 5000;\n\t// Sequential request queue - all requests are queued and processed one at a time\n\tprivate requestQueue: Array<{ \n\t\trequest: HcBoxRequest; \n\t\tresolve: (value: any) => void; \n\t\treject: (error: any) => void;\n\t\ttimeout: number;\n\t}> = [];\n\tprivate pendingRequests = new Map<string, { resolve: (value: any) => void; reject: (error: any) => void }>();\n\tprivate isConnected = false;\n\tprivate isProcessingRequest = false; // Flag to track if currently processing a request\n\n\tconstructor() {\n\t\tthis.wsUrl = 'ws://127.0.0.1:26608';\n\t}\n\n\tasync onModuleInit() {\n\t\tawait this.connect();\n\t}\n\n\tasync onModuleDestroy() {\n\t\tawait this.disconnect();\n\t}\n\n\tprivate async connect(): Promise<void> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tthis.logger.log(`Connecting to HC BOX WebSocket: ${this.wsUrl}`);\n\t\t\t\tthis.ws = new WebSocket(this.wsUrl);\n\n\t\t\t\tthis.ws.on('open', () => {\n\t\t\t\t\tthis.logger.log('HC BOX WebSocket connected');\n\t\t\t\t\tthis.isConnected = true;\n\t\t\t\t\tthis.reconnectAttempts = 0;\n\t\t\t\t\t// Start processing queue when connected\n\t\t\t\t\tthis.processRequestQueue();\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\n\t\t\t\tthis.ws.on('message', (data: WebSocket.Data) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst response: HcBoxResponse = JSON.parse(data.toString());\n\t\t\t\t\t\tthis.handleMessage(response);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tthis.logger.error(`Error parsing WebSocket message: ${error.message}`);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.ws.on('error', (error) => {\n\t\t\t\t\tthis.logger.error(`WebSocket error: ${error.message}`);\n\t\t\t\t\tthis.isConnected = false;\n\t\t\t\t\tif (this.reconnectAttempts === 0) {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.ws.on('close', () => {\n\t\t\t\t\tthis.logger.warn('HC BOX WebSocket closed');\n\t\t\t\t\tthis.isConnected = false;\n\t\t\t\t\tthis.scheduleReconnect();\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tthis.logger.error(`Error creating WebSocket connection: ${error.message}`);\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate scheduleReconnect(): void {\n\t\tif (this.reconnectAttempts >= this.maxReconnectAttempts) {\n\t\t\tthis.logger.error('Max reconnection attempts reached');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.reconnectAttempts++;\n\t\tconst delay = this.reconnectDelay * this.reconnectAttempts;\n\t\tthis.logger.log(`Scheduling reconnect attempt ${this.reconnectAttempts} in ${delay}ms`);\n\n\t\tsetTimeout(() => {\n\t\t\tthis.connect().catch((error) => {\n\t\t\t\tthis.logger.error(`Reconnection failed: ${error.message}`);\n\t\t\t});\n\t\t}, delay);\n\t}\n\n\tprivate async disconnect(): Promise<void> {\n\t\tif (this.ws) {\n\t\t\tthis.ws.close();\n\t\t\tthis.ws = null;\n\t\t\tthis.isConnected = false;\n\t\t}\n\t}\n\n\tprivate handleMessage(response: HcBoxResponse): void {\n\t\t// Handle responses - use FIFO approach since API doesn't provide request IDs\n\t\tif (this.pendingRequests.size > 0) {\n\t\t\tconst [firstKey, firstHandler] = this.pendingRequests.entries().next().value;\n\t\t\tthis.pendingRequests.delete(firstKey);\n\t\t\tif (response.StatusCode === 200) {\n\t\t\t\tfirstHandler.resolve(response.result);\n\t\t\t} else {\n\t\t\t\tfirstHandler.reject(new Error(`HC BOX error: ${response.StatusCode}`));\n\t\t\t}\n\t\t} else {\n\t\t\tthis.logger.warn(`Received response but no pending requests: ${JSON.stringify(response)}`);\n\t\t}\n\t}\n\n\t/**\n\t * Process requests sequentially from queue\n\t * Only one request is processed at a time to avoid timeout issues\n\t */\n\tprivate async processRequestQueue(): Promise<void> {\n\t\t// If already processing a request or queue is empty, do nothing\n\t\tif (this.isProcessingRequest || this.requestQueue.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If not connected, don't process (will process when connected)\n\t\tif (!this.isConnected || !this.ws) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Mark as processing\n\t\tthis.isProcessingRequest = true;\n\n\t\t// Get first request from queue\n\t\tconst { request, resolve, reject, timeout } = this.requestQueue.shift()!;\n\n\t\ttry {\n\t\t\t// Send request and wait for response\n\t\t\tconst result = await this._sendRequestOnce(request, timeout);\n\t\t\tresolve(result);\n\t\t} catch (error) {\n\t\t\treject(error);\n\t\t} finally {\n\t\t\t// Mark as done processing\n\t\t\tthis.isProcessingRequest = false;\n\t\t\t\n\t\t\t// Process next request if any\n\t\t\tif (this.requestQueue.length > 0) {\n\t\t\t\t// Use setImmediate to avoid stack overflow and allow event loop to process\n\t\t\t\tsetImmediate(() => this.processRequestQueue());\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Send a single WebSocket request (internal use only)\n\t * This method sends the request and waits for response\n\t */\n\tprivate async _sendRequestOnce(request: HcBoxRequest, timeout = 30000): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// Generate unique request ID\n\t\t\tconst requestId = Date.now().toString() + Math.random().toString(36).substr(2, 9);\n\t\t\tthis.pendingRequests.set(requestId, { resolve, reject });\n\n\t\t\tconst timeoutId = setTimeout(() => {\n\t\t\t\tthis.pendingRequests.delete(requestId);\n\t\t\t\treject(new Error('WebSocket request timeout'));\n\t\t\t}, timeout);\n\n\t\t\tconst originalResolve = resolve;\n\t\t\tconst originalReject = reject;\n\n\t\t\tresolve = (value: any) => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\toriginalResolve(value);\n\t\t\t};\n\n\t\t\treject = (error: any) => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\toriginalReject(error);\n\t\t\t};\n\n\t\t\tthis.pendingRequests.set(requestId, { resolve, reject });\n\n\t\t\ttry {\n\t\t\t\tthis.ws!.send(JSON.stringify(request));\n\t\t\t} catch (error) {\n\t\t\t\tthis.pendingRequests.delete(requestId);\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Send WebSocket request - all requests are queued and processed sequentially\n\t * This ensures no concurrent requests that could cause timeout issues\n\t */\n\tprivate async sendRequest(request: HcBoxRequest, timeout = 30000): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// Add request to queue\n\t\t\tthis.requestQueue.push({ request, resolve, reject, timeout });\n\t\t\t\n\t\t\t// Start processing queue (will do nothing if already processing)\n\t\t\tthis.processRequestQueue();\n\t\t});\n\t}\n\n\tasync listDevices(): Promise<any[]> {\n\t\tconst response = await this.sendRequest({ action: 'list' });\n\t\treturn Array.isArray(response) ? response : [];\n\t}\n\n\tasync click(deviceIds: string | string[], x: number, y: number, duration = 0.2): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'click',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t\tduration,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync swipe(\n\t\tdeviceIds: string | string[],\n\t\toptions: IHCSwipeOptions\n\t): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'swipe',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t\t...options\n\t\t\t},\n\t\t});\n\t}\n\n\tasync captureScreen(\n\t\tdeviceId: string,\n\t\toptions: ICaptureScreenOptions\n\t) {\n\t\treturn this.sendRequest({\n\t\t\taction: 'screen',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceId,\n\t\t\t\t...omit(options, 'folderPath'),\n\t\t\t\tfilePath: options.folderPath,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync home(deviceIds: string | string[]): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'home',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync launchApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'launchApp',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t\tcontent: bundleId,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync killApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n\t\tconst deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n\t\treturn this.sendRequest({\n\t\t\taction: 'killApp',\n\t\t\tcomm: {\n\t\t\t\tdeviceIds: deviceIdsStr,\n\t\t\t\tcontent: bundleId,\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t* Check if character is a number\n\t*/\n\tprivate isNumber(char: string): boolean {\n\t\treturn /^[0-9]$/.test(char);\n\t}\n\n\t/**\n\t * Check if character is a letter\n\t */\n\tprivate isLetter(char: string): boolean {\n\t\treturn /^[a-zA-Z]$/.test(char);\n\t}\n\n\t/**\n\t * Check if character is a special character that only appears in number mode\n\t * (e.g., @, !, etc.)\n\t */\n\tprivate isSpecialCharInNumberMode(char: string): boolean {\n\t\t// List of special characters that only appear in number mode\n\t\tconst specialChars = ['@', '!'];\n\t\treturn specialChars.includes(char);\n\t}\n\n\t/**\n\t * Switch keyboard mode (between letter and number)\n\t */\n\tasync switchKeyboardMode(deviceIds: string | string[]): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.KEYBOARD_SWITCH;\n\t\tthis.logger.log(`Switching keyboard mode on device ${deviceIds} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceIds, x, y, 0.2);\n\t\t// Wait for keyboard to switch\n\t\tawait sleep(500);\n\t\tthis.logger.log(`Keyboard mode switched successfully on device ${deviceIds}`);\n\t}\n\n\t/**\n\t * Press shift key for uppercase letter\n\t * Note: After typing one uppercase letter, keyboard automatically returns to lowercase\n\t */\n\tasync pressShiftKey(deviceIds: string | string[]): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.SHIFT_KEY;\n\t\tthis.logger.debug(`Pressing shift key on device ${deviceIds} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceIds, x, y, 0.2);\n\t\t// Small delay after pressing shift\n\t\tawait sleep(200);\n\t\tthis.logger.debug(`Shift key pressed successfully on device ${deviceIds}`);\n\t}\n\n\t/**\n\t * Press return/enter key\n\t * Note: This key can be used to:\n\t * - Dismiss keyboard (exit input mode)\n\t * - Submit/enter (depending on context)\n\t */\n\tasync pressReturnKey(deviceId: string): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.RETURN_KEY;\n\t\tthis.logger.log(`Pressing return key on device ${deviceId} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceId, x, y, 0.2);\n\t\t// Wait for action to complete\n\t\tawait sleep(500);\n\t\tthis.logger.log(`Return key pressed successfully on device ${deviceId}`);\n\t}\n\n\t/**\n\t * Input text value by clicking on keyboard keys\n\t * Automatically switches between number and letter keyboard as needed\n\t */\n\tasync inputText(deviceIds: string | string[], text: string): Promise<void> {\n\t\tif (!text || text.length === 0) {\n\t\t\tthrow new Error('Password cannot be empty');\n\t\t}\n\n\t\t// Track current keyboard mode\n\t\t// Default keyboard mode is 'letter' (bn phm mc nh l ch)\n\t\tlet currentMode: 'number' | 'letter' = 'letter';\n\n\t\t// Input each character\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tconst char = text[i];\n\t\t\tconst charLower = char.toLowerCase();\n\t\t\tconst isUppercase = char !== charLower && this.isLetter(char);\n\n\t\t\t// For special characters (like @, !), use char directly (they don't have lowercase)\n\t\t\t// For other characters, use charLower to find coordinates\n\t\t\tconst keyToLookup = this.isSpecialCharInNumberMode(char) ? char : charLower;\n\t\t\tconst keyCoords = KEYBOARD_LAYOUT[keyToLookup];\n\n\t\t\tif (!keyCoords) {\n\t\t\t\tthis.logger.warn(`Character '${char}' not found in keyboard layout. Skipping...`);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Determine required keyboard mode for this character\n\t\t\t// Special characters (like @, !) only appear in number mode\n\t\t\tlet requiredMode: 'number' | 'letter' | null = null;\n\t\t\tif (this.isNumber(charLower)) {\n\t\t\t\trequiredMode = 'number';\n\t\t\t} else if (this.isLetter(charLower)) {\n\t\t\t\trequiredMode = 'letter';\n\t\t\t} else if (this.isSpecialCharInNumberMode(char)) {\n\t\t\t\t// Special characters only appear in number mode\n\t\t\t\trequiredMode = 'number';\n\t\t\t}\n\n\t\t\t// Switch keyboard mode if needed (letter <-> number)\n\t\t\tif (requiredMode && currentMode !== requiredMode) {\n\t\t\t\tthis.logger.debug(`Switching keyboard to ${requiredMode} mode for character '${char}'`);\n\t\t\t\tawait this.switchKeyboardMode(deviceIds);\n\t\t\t\tcurrentMode = requiredMode;\n\t\t\t}\n\n\t\t\t// If uppercase letter, press shift key first\n\t\t\t// Note: After typing one uppercase letter, keyboard automatically returns to lowercase\n\t\t\tif (isUppercase && currentMode === 'letter') {\n\t\t\t\tthis.logger.debug(`Pressing shift key for uppercase letter '${char}'`);\n\t\t\t\tawait this.pressShiftKey(deviceIds);\n\t\t\t}\n\n\t\t\t// Click the key\n\t\t\t// For special characters, use char directly; for others, use charLower coordinates\n\t\t\tthis.logger.debug(`Clicking key '${keyToLookup}'${isUppercase ? ' (uppercase)' : ''} at (${keyCoords.x}, ${keyCoords.y})`);\n\t\t\tawait this.click(deviceIds, keyCoords.x, keyCoords.y, 0.15);\n\t\t\t// Small delay between key presses\n\t\t\tawait sleep(200);\n\t\t}\n\n\t\tthis.logger.log(`Text input completed on device ${deviceIds}`);\n\t}\n\n\t/**\n\t * Input number using numpad layout\n\t * @param deviceId - Device ID\n\t * @param value - Number string to input (e.g., \"123\", \"456789\")\n\t */\n\tasync inputNumpadNumber(deviceIds: string | string[], value: string) {\n\t\tif (!value || value.length === 0) {\n\t\t\tthrow new Error('value cannot be empty');\n\t\t}\n\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst digit = value[i];\n\n\t\t\tconst coordinates = NUMPAD_LAYOUT[digit];\n\n\t\t\tawait this.click(deviceIds, coordinates.x, coordinates.y, 0.15);\n\t\t\tthis.logger.debug(`Clicking key '${digit}' at (${coordinates.x}, ${coordinates.y})`);\n\t\t\tawait sleep(200);\n\t\t}\n\t}\n\n\tasync transferFile(deviceIds: string | string[], filePath: string, fileType: number = 1): Promise<any> {\n\t// TODO: Implement transfer file\n\treturn Promise.resolve(null);\n\t}\n\n\tisConnectedStatus(): boolean {\n\t\treturn this.isConnected;\n\t}\n}\n\n\n","module.exports = require(\"ws\");","import { Injectable, Logger, OnModuleInit, OnModuleDestroy } from '@nestjs/common';\nimport * as WebSocket from 'ws';\nimport { ICaptureScreenOptions, IPandaSwipeOptions, IWebSocketService } from './interface/websocket.interface';\nimport { toString } from 'lodash';\nimport { sleep } from '@/common/utils/time';\nimport { COMMON_COORDINATES, NUMPAD_LAYOUT } from '@/common/constants/keyboard';\nimport { TelegramService } from '@/modules/notifiction/telegram.service';\n\nexport interface PandaRequest<T> {\n  action: string;\n  /**\n   * \"all\" or \"xxx,xxx,xxx\" multiple devices separated by comma\n  */\n  devices?: string | string[];\n  data?: T;\n}\n\nexport interface PandaResponse<T> {\n  code: number;\n  message: string;\n  data: T;\n}\n\n@Injectable()\nexport class PandaWebSocketService implements IWebSocketService, OnModuleInit, OnModuleDestroy {\n  private readonly logger = new Logger('PandaWebSocketService');\n  private ws: WebSocket | null = null;\n  private wsUrl: string;\n  private reconnectAttempts = 0;\n  private maxReconnectAttempts = 10;\n  private reconnectDelay = 5000;\n  // Sequential request queue - all requests are queued and processed one at a time\n  private requestQueue: Array<{ \n    request: PandaRequest<any>; \n    resolve: (value: any) => void; \n    reject: (error: any) => void;\n    timeout: number;\n  }> = [];\n  private pendingRequests = new Map<string, { resolve: (value: any) => void; reject: (error: any) => void }>();\n  private isConnected = false;\n  private isProcessingRequest = false; // Flag to track if currently processing a request\n\n  constructor(\n    private readonly telegramService: TelegramService,\n  ) {\n    this.wsUrl = 'ws://127.0.0.1:33333';\n  }\n\n  async onModuleInit() {\n    await this.connect();\n  }\n\n  async onModuleDestroy() {\n    await this.disconnect();\n  }\n\n  private async connect(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      try {\n        this.logger.log(`Connecting to Panda BOX WebSocket: ${this.wsUrl}`);\n        this.ws = new WebSocket(this.wsUrl);\n\n        this.ws.on('open', () => {\n          this.logger.log('Panda BOX WebSocket connected');\n          this.isConnected = true;\n          this.reconnectAttempts = 0;\n          // Start processing queue when connected\n          this.processRequestQueue();\n          resolve();\n        });\n\n        this.ws.on('message', (data: WebSocket.Data) => {\n          try {\n            const messageStr = data.toString();\n            const response: PandaResponse<any> = JSON.parse(messageStr);\n            this.handleMessage(response);\n          } catch (error) {\n            this.logger.error(`Error parsing WebSocket message: ${error.message}`, error.stack);\n            this.logger.error(`Raw message was: ${data.toString()}`);\n          }\n        });\n\n        this.ws.on('error', (error) => {\n          this.logger.error(`WebSocket error: ${error.message}`);\n          this.isConnected = false;\n          if (this.reconnectAttempts === 0) {\n            reject(error);\n          }\n        });\n\n        this.ws.on('close', () => {\n          this.logger.warn('Panda BOX WebSocket closed');\n          this.isConnected = false;\n          this.scheduleReconnect();\n        });\n      } catch (error) {\n        this.logger.error(`Error creating WebSocket connection: ${error.message}`);\n        reject(error);\n      }\n    });\n  }\n\n  private scheduleReconnect(): void {\n    if (this.reconnectAttempts >= this.maxReconnectAttempts) {\n      this.logger.error('Max reconnection attempts reached');\n\n      this.telegramService\n        .sendMessage({\n          text: ' Connection Error'\n                + `\\n\\n<b>Kt ni vo boxphone software tht bi.</b>`\n                + `\\n<b>Max retry:</b> ${this.maxReconnectAttempts}`\n                + `\\n<b>Current retry:</b> ${this.reconnectAttempts}`\n                + `\\n<b>Retry delay:</b> ${this.reconnectDelay}ms`,\n          options: {\n            parseMode: 'HTML'\n          }\n        });\n\n      return;\n    }\n\n    this.reconnectAttempts++;\n    const delay = this.reconnectDelay * this.reconnectAttempts;\n    this.logger.log(`Scheduling reconnect attempt ${this.reconnectAttempts} in ${delay}ms`);\n\n    setTimeout(() => {\n      this.connect().catch((error) => {\n        this.logger.error(`Reconnection failed: ${error.message}`);\n      });\n    }, delay);\n  }\n\n  private async disconnect(): Promise<void> {\n    if (this.ws) {\n      this.ws.close();\n      this.ws = null;\n      this.isConnected = false;\n    }\n  }\n\n  private handleMessage<T>(response: PandaResponse<T>): void {\n    // this.logger.debug(`Received WebSocket message: ${JSON.stringify(response)}`);\n\n    // Handle responses - use FIFO approach since API doesn't provide request IDs\n    if (this.pendingRequests.size > 0) {\n      const [firstKey, firstHandler] = this.pendingRequests.entries().next().value;\n      this.pendingRequests.delete(firstKey);\n\n      // Check response code: 10000 = SUCCESS, others = error\n      if (response.code === 10000) {\n        firstHandler.resolve(response.data);\n      } else {\n        const errorMessage = response.message || `Panda BOX error: ${response.code}`;\n        firstHandler.reject(new Error(errorMessage));\n      }\n    } else {\n      // Check if this looks like a device list response (unsolicited update)\n      const isDeviceListResponse = Array.isArray(response.data) && \n        (response.data as any[]).length > 0 && \n        (response.data as any[])[0]?.serial !== undefined;\n      \n      if (isDeviceListResponse && response.code === 10000) {\n        // Likely an unsolicited device list update - log as debug instead of warning\n        const deviceList = response.data as any[];\n        this.logger.debug(`Received unsolicited device list update (no pending requests): ${deviceList.length} device(s)`);\n      } else {\n        // Other unsolicited responses or late responses - log as warning\n        this.logger.warn(`Received response but no pending requests: ${JSON.stringify(response)}`);\n      }\n    }\n  }\n\n  /**\n   * Process requests sequentially from queue\n   * Only one request is processed at a time to avoid timeout issues\n   */\n  private async processRequestQueue(): Promise<void> {\n    // If already processing a request or queue is empty, do nothing\n    if (this.isProcessingRequest || this.requestQueue.length === 0) {\n      return;\n    }\n\n    // If not connected, don't process (will process when connected)\n    if (!this.isConnected || !this.ws) {\n      return;\n    }\n\n    // Mark as processing\n    this.isProcessingRequest = true;\n\n    // Get first request from queue\n    const { request, resolve, reject, timeout } = this.requestQueue.shift()!;\n\n    try {\n      // Send request and wait for response\n      const result = await this._sendRequestOnce(request, timeout);\n      resolve(result);\n    } catch (error) {\n      reject(error);\n    } finally {\n      // Mark as done processing\n      this.isProcessingRequest = false;\n      \n      // Process next request if any\n      if (this.requestQueue.length > 0) {\n        // Use setImmediate to avoid stack overflow and allow event loop to process\n        setImmediate(() => this.processRequestQueue());\n      }\n    }\n  }\n\n  /**\n   * Send a single WebSocket request (internal use only)\n   * This method sends the request and waits for response\n   */\n  private async _sendRequestOnce<T>(request: PandaRequest<T>, timeout = 30000): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // Generate unique request ID\n      const requestId = Date.now().toString() + Math.random().toString(36).substr(2, 9);\n      this.pendingRequests.set(requestId, { resolve, reject });\n\n      const timeoutId = setTimeout(() => {\n        this.pendingRequests.delete(requestId);\n        reject(new Error('WebSocket request timeout'));\n      }, timeout);\n\n      const originalResolve = resolve;\n      const originalReject = reject;\n\n      resolve = (value: any) => {\n        clearTimeout(timeoutId);\n        originalResolve(value);\n      };\n\n      reject = (error: any) => {\n        clearTimeout(timeoutId);\n        originalReject(error);\n      };\n\n      this.pendingRequests.set(requestId, { resolve, reject });\n\n      try {\n        const requestStr = JSON.stringify(request);\n        // this.logger.debug(`Sending WebSocket request: ${requestStr}`);\n        this.ws!.send(requestStr);\n      } catch (error) {\n        this.logger.error(`Error sending WebSocket request: ${error.message}`, error.stack);\n        this.pendingRequests.delete(requestId);\n        clearTimeout(timeoutId);\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Send WebSocket request - all requests are queued and processed sequentially\n   * This ensures no concurrent requests that could cause timeout issues\n   */\n  private async sendRequest<T>(request: PandaRequest<T>, timeout = 30000): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // Add request to queue\n      this.requestQueue.push({ request, resolve, reject, timeout });\n      \n      // Start processing queue (will do nothing if already processing)\n      this.processRequestQueue();\n    });\n  }\n\n  async listDevices(): Promise<any[]> {\n    const response = await this.sendRequest({ action: 'list' });\n    const devices = response.map((device: any) => ({\n      ...device,\n      udid: device.serial,\n    }));\n    // TODO: Ping to telegram group\n    // this.logger.log(`Device list response received: ${JSON.stringify(response)}`);\n    if (devices.length <= 0) {\n      this.logger.error('No devices found!');\n      // TODO: Ping to telegram group\n    }\n    return devices;\n  }\n\n  async click(deviceIds: string | string[], x: number, y: number, duration = 0.2): Promise<string> {\n    return this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds,\n      \"data\": {\n        \"type\": \"10\", // 10: click\n        \"x\": toString(x),\n        \"y\": toString(y),\n      }\n    });\n  }\n\n  async swipe(\n    deviceIds: string | string[],\n    options: IPandaSwipeOptions\n  ): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"pointerEvent\",\n      \"devices\": deviceIdsStr,\n      \"data\": options\n    });\n  }\n\n  async captureScreen(\n    deviceId: string,\n    options: ICaptureScreenOptions\n  ) {\n    return this.sendRequest({\n      \"action\": \"screenFile\",\n      \"devices\": deviceId,\n      \"data\": {\n        savePath: options.folderPath\n      }\n    });\n  }\n\n  async home(deviceIds: string | string[]): Promise<string> {\n    return this.sendRequest({\n      \"action\": \"pushEvent\",\n      \"devices\": deviceIds,\n      \"data\": {\n        \"type\": \"2\"\n      }\n    });\n  }\n\n  async launchApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest(\n      {\n        \"action\": \"startApp\",\n        \"devices\": deviceIdsStr,\n        \"data\": {\n          \"app\": bundleId\n        }\n      }\n    )\n  }\n\n  async killApp(deviceIds: string | string[], bundleId: string): Promise<string> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"stopApp\",\n      \"devices\": deviceIdsStr,\n      \"data\": {\n        \"app\": bundleId\n      }\n    });\n  }\n\n  /**\n\t * Switch keyboard mode (between letter and number)\n\t */\n\tasync switchKeyboardMode(deviceIds: string | string[]): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.KEYBOARD_SWITCH;\n\t\tthis.logger.log(`Switching keyboard mode on device ${deviceIds} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceIds, x, y, 0.2);\n\t\t// Wait for keyboard to switch\n\t\tawait sleep(500);\n\t\tthis.logger.log(`Keyboard mode switched successfully on device ${deviceIds}`);\n\t}\n\n\t/**\n\t * Press shift key for uppercase letter\n\t * Note: After typing one uppercase letter, keyboard automatically returns to lowercase\n\t */\n\tasync pressShiftKey(deviceIds: string | string[]): Promise<void> {\n\t\tconst { x, y } = COMMON_COORDINATES.SHIFT_KEY;\n\t\tthis.logger.debug(`Pressing shift key on device ${deviceIds} at coordinates (${x}, ${y})`);\n\t\tawait this.click(deviceIds, x, y, 0.2);\n\t\t// Small delay after pressing shift\n\t\tawait sleep(200);\n\t\tthis.logger.debug(`Shift key pressed successfully on device ${deviceIds}`);\n\t}\n\n  /**\n   * Press return/enter key\n   * Note: This key can be used to:\n   * - Dismiss keyboard (exit input mode)\n   * - Submit/enter (depending on context)\n   */\n  async pressReturnKey(deviceId: string): Promise<void> {\n    const { x, y } = COMMON_COORDINATES.RETURN_KEY;;\n    await this.click(deviceId, x, y, 0.2);\n    // Wait for action to complete\n    await sleep(500);\n  }\n\n  async inputText(deviceIds: string | string[], text: string): Promise<void> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    return this.sendRequest({\n      \"action\": \"inputText\",\n      \"devices\": deviceIdsStr,\n      \"data\": {\n        \"content\": text\n      }\n    });\n  }\n\n  async inputNumpadNumber(deviceIds: string | string[], value: string) {\n\t\tif (!value || value.length === 0) {\n\t\t\tthrow new Error('value cannot be empty');\n\t\t}\n\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst digit = value[i];\n\n\t\t\tconst coordinates = NUMPAD_LAYOUT[digit];\n\n\t\t\tawait this.click(deviceIds, coordinates.x, coordinates.y);\n\t\t\tthis.logger.debug(`Clicking key '${digit}' at (${coordinates.x}, ${coordinates.y})`);\n\t\t\tawait sleep(200);\n\t\t}\n  }\n\n  async transferFile(deviceIds: string | string[], filePath: string, fileType: number = 1): Promise<any> {\n    const deviceIdsStr = Array.isArray(deviceIds) ? deviceIds.join(',') : deviceIds;\n    this.logger.log(`Transferring file ${filePath} to device(s) ${deviceIdsStr} with fileType ${fileType}`);\n    return this.sendRequest({\n      \"action\": \"uploadFile\",\n      \"devices\": deviceIdsStr,\n      \"data\": {\n        \"filePath\": filePath,\n        \"fileType\": fileType\n      }\n    });\n  }\n\n  isConnectedStatus() {\n    return this.isConnected;\n  }\n}\n\n","import { Injectable, Logger } from '@nestjs/common';\nimport { Cron, CronExpression } from '@nestjs/schedule';\nimport { BankService } from './bank.service';\nimport { DeviceService } from '../device/device.service';\nimport { SessionManagementService } from './session-management.service';\nimport { RedisLockService } from '../redis-lock/redis-lock.service';\nimport { SYSTEM_LOCK_BOXPHONE } from '../withdrawal/constants/lock';\n\n@Injectable()\nexport class SessionRefreshScheduler {\n  private readonly logger = new Logger('SessionRefreshScheduler');\n\n  constructor(\n    private readonly bankService: BankService,\n    private readonly deviceService: DeviceService,\n    private readonly sessionManagement: SessionManagementService,\n    private readonly redisLockService: RedisLockService,\n  ) {}\n\n  /**\n   * Check and refresh sessions every 30 seconds\n   */\n  @Cron(CronExpression.EVERY_30_SECONDS)\n  async refreshSessions() {\n    try {\n\n      const isNeedRestartBoxphone = await this.redisLockService.getLock(SYSTEM_LOCK_BOXPHONE);\n\n      if (isNeedRestartBoxphone) {\n        return;\n      }\n\n      const serviceStatus = await this.deviceService.getServiceStatus();\n      if (serviceStatus !== 'active') {\n        return; // Skip if service is not active\n      }\n\n      const devices = await this.deviceService.listDevices();\n      const activeDevices = devices.filter(device => device.status === 'active' && device.bankCode);\n\n      for (const device of activeDevices) {\n        const bankCode = device.bankCode.toUpperCase();\n        \n        try {\n          await this.bankService.refreshSessionIfNeeded(device.udid, bankCode);\n        } catch (error) {\n          this.logger.error(\n            `Error refreshing session for device ${device.udid}, bank ${bankCode}: ${error.message}`\n          );\n        }\n      }\n    } catch (error) {\n      this.logger.error(`Error in session refresh scheduler: ${error.message}`);\n    }\n  }\n}\n\n","import { Module } from '@nestjs/common';\nimport { OCRWorkerPoolService } from './services/ocr-worker-pool.service';\nimport { ImagePreprocessingService } from './services/image-preprocessing.service';\nimport { OCRService } from './services/ocr.service';\n\n@Module({\n  providers: [\n    OCRWorkerPoolService,\n    ImagePreprocessingService,\n    OCRService,\n  ],\n  exports: [\n    OCRService,\n    OCRWorkerPoolService, // Export for pool stats monitoring\n    ImagePreprocessingService, // Export for advanced use cases\n  ],\n})\nexport class OCRModule { }\n\n","import { Global, Module } from '@nestjs/common';\nimport { NotificationService } from './notification.service';\nimport { EzpayBeClientService } from './ezpay-be-client.service';\nimport { HttpModule } from '@nestjs/axios';\nimport { TelegramService } from './telegram.service';\n\n@Global()\n@Module({\n  imports: [\n    HttpModule,\n  ],\n  providers: [\n    NotificationService,\n    EzpayBeClientService,\n    TelegramService\n  ],\n  exports: [\n    NotificationService,\n    TelegramService\n  ],\n})\nexport class NotificationModule { }\n\n","import { Module } from '@nestjs/common';\nimport { WindowsAppGitBashService } from './window-app.service';\n\n@Module({\n  providers: [\n    WindowsAppGitBashService\n  ],\n  exports: [WindowsAppGitBashService],\n})\nexport class WindowAppModule {}\n\n","import { Global, Module } from '@nestjs/common';\nimport { RedisService } from '../../common/services/redis.service';\nimport { RedisLockService } from './redis-lock.service';\n\n@Global()\n@Module({\n  providers: [\n    RedisService,\n    RedisLockService,\n  ],\n  exports: [\n    RedisLockService\n  ],\n})\nexport class RedisLockModule {}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { NestFactory } from '@nestjs/core';\nimport { ValidationPipe, Logger } from '@nestjs/common';\nimport { NestExpressApplication } from '@nestjs/platform-express';\nimport { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nimport { join } from 'path';\nimport { AppModule } from './app.module';\nimport { config as configEnv } from '@/common/constants/config';\n\nasync function bootstrap() {\n  const app = await NestFactory.create<NestExpressApplication>(AppModule, {\n    // logger: process.env.NODE_ENV === 'production'\n    //   ? ['error', 'warn', 'log']\n    //   : ['error', 'warn', 'log', 'debug', 'verbose'],\n  });\n\n  const logger = new Logger('Bootstrap');\n\n  // Configure view engine (EJS)\n  // In development: src/views, in production: dist/views (after copying)\n  const viewsPath = process.env.NODE_ENV === 'production' \n    ? join(__dirname, 'views')\n    : join(process.cwd(), 'src', 'views');\n  app.setBaseViewsDir(viewsPath);\n  app.setViewEngine('ejs');\n  logger.log(`Views directory: ${viewsPath}`);\n\n  // Global validation pipe\n  app.useGlobalPipes(\n    new ValidationPipe({\n      transform: true,\n      whitelist: true,\n      forbidNonWhitelisted: true,\n    }),\n  );\n\n  // Swagger configuration\n  const config = new DocumentBuilder()\n    .setTitle('EzPay Auto API')\n    .setDescription('Automated withdrawal processing service with HC BOX integration')\n    .setVersion('1.0')\n    .addTag('bank', 'Bank operations')\n    .addTag('withdrawal', 'Withdrawal processing')\n    .addTag('device', 'Device management')\n    .addTag('hcbox', 'HC Box integration')\n    .build();\n  \n  const document = SwaggerModule.createDocument(app, config);\n  SwaggerModule.setup('docs', app, document);\n\n  const port = process.env.PORT || 3002;\n  logger.log(` Swagger documentation available at: http://localhost:${port}/docs`);\n  await app.listen(port);\n\n  logger.log(` EzPay Auto is running on: http://localhost:${port}`);\n  logger.log(` Withdrawal processing started by ${configEnv.boxType} box`);\n  logger.log(` Device management: http://localhost:${port}`);\n}\n\nbootstrap();\n\n"],"sourceRoot":"","file":"main.js"}