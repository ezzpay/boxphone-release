function a0_0x4ec8(){const _0x23840a=['listDevices','WindowAppModule','1205TrWagu','SACOMBANK','ocrConfig','serial','sismember','Bank\x20service\x20not\x20found\x20for\x20bank\x20code:\x20','pressShiftKey','number','SessionManagementService','normalize','mobileapp.acb.com.vn','INTERNAL_SERVER_ERROR','production','completed','VietcombankService','11JQuAsl','\x0a<b>D·ª±\x20ki·∫øn:</b>\x203\x20ph√∫t.','Connecting\x20to\x20Panda\x20BOX\x20WebSocket:\x20','baseUrl','Found\x20','/api/bank/','Test\x20swiping\x20on\x20a\x20device.\x20Format\x20is\x20determined\x20by\x20config.boxType\x20(HC\x20or\x20PANDA)','lastErrorReason','Error\x20processing\x20','TPBANK','\x20when\x20uploading\x20bill\x20for\x20withdrawal\x20','addTag','OCR_ROI_BLOCK_WIDTH','toUpperCase','toFixed','SwaggerModule','BAD_REQUEST','not\x20set','toString','Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20numbers\x20between\x200\x20and\x201','PVCOMBANK','reject','DeviceLockService',',\x20timeout:\x20','PANDA','firstValueFrom','mkdir','env','clone','Error\x20getting\x20available\x20devices:\x20','Controller','chuy·ªÉn\x20ti·ªÅn','\x20|\x20','\x27\x20at\x20(','uploadReceipt','Screen\x20captured\x20successfully','Invalid\x20ROI\x20y:\x20','Post','Executing\x20transfer\x20for\x20withdrawal\x20','WebSocket\x20error:\x20','reconnectAttempts','isProcessingRequest','Ch·ª©c\x20nƒÉng\x20∆∞a\x20th√≠ch','token','OCR_ROI_SINGLE_X','isNumber','Choose\x20wrong\x20image\x20qrcode','requestQueue','withdrawal:processed:','ceil','createQRCodeAndTransferTo','Transaction\x20success\x20screen\x20not\x20found','metadata','TRANSACTION_SUCCESS','test-screen-capture-','devices','decorate','Failed\x20to\x20warm\x20up\x20worker\x20pool:\x20','test/capture-screen/:deviceId','filter','folderPath',']\x20Failed\x20to\x20cleanup\x20folder:\x20','forwardRef','Test\x20inputting\x20number\x20using\x20numpad\x20layout\x20on\x20a\x20device','Failed\x20to\x20start\x20service','clickAndWaitForScreen','hdBankService','localhost','processJob','EEXIST','All\x20OCR\x20workers\x20terminated',']\x20-\x20Get\x20Verified\x20account\x20name\x20screen','RedisLockModule','__metadata','size','OCRModule','eval','Marked\x20withdrawal\x20',']\x20-\x20Get\x20image\x20library\x20screen','inputSmartOTPFromConfig','worker',')\x20on\x20device\x20','login','Successfully\x20updated\x20withdrawal\x20','defineProperty','pickAndProcessJobs','hcbox','deviceLockService','test/launch-app/:deviceId','This\x20key\x20can\x20dismiss\x20keyboard\x20or\x20submit/enter\x20depending\x20on\x20context','pressReturnKey','AcbService','\x0aif\x20redis.call(\x22GET\x22,\x20KEYS[1])\x20==\x20ARGV[1]\x20then\x0a\x20\x20redis.call(\x22DEL\x22,\x20KEYS[2])\x0a\x20\x20return\x20redis.call(\x22DEL\x22,\x20KEYS[1])\x0aelse\x0a\x20\x20return\x200\x0aend\x0a','Refreshing\x20session\x20for\x20device\x20','stack','/4):\x20','isSessionValid','default','boxType','üÜòüÜòüÜò\x20Connection\x20Error\x0a\x0a<b>K·∫øt\x20n·ªëi\x20v√†o\x20boxphone\x20software\x20th·∫•t\x20b·∫°i.</b>\x0a<b>Max\x20retry:</b>\x20','OCRService','Failed\x20to\x20launch\x20VIETCOMBANK\x20app',',\x20w=','postprocess=',']\x20Failed\x20to\x20get\x20image\x20library\x20screen','MIN_DIMENSION','setex','beneficiaryAccountNo','getClient','__param','host','min','initializationPromise','reconnecting','Smart\x20OTP\x20is\x20required\x20when\x20status\x20is\x20active','transferCode','BACK_TO_HOME','join','Put','loginTime','Reconnection\x20failed:\x20','/3\x20-\x20OCR\x20found\x20no\x20text','rejectAllPending','extractTransactionAmount','Detailed\x20queue\x20debug\x20info','\x20after\x204\x20attempts.\x20Payload:\x20','password','265643Wwbqbs','Clicking\x20key\x20\x27','notificationService','WebSocketModule','info:','BACABANK',')\x20on\x20device:\x20','analyzeTransferBill','getSession','msg=','requestWithRetry','ws://127.0.0.1:33333','delete','append','910252mXRPmM','\x20status\x20to\x20','error','restartBoxphone','HD_UI_COORDINATES',']\x20Device\x20does\x20not\x20have\x20valid\x20session\x20for\x20bank\x20','duration','Executing\x20VIETCOMBANK\x20transfer\x20for\x20withdrawal\x20','send','stringify','\x20from\x20queue','processing','Testing\x20press\x20return\x20key\x20on\x20device:\x20','terminate','MSB','withdrawalCode','HdBankService','Device\x20ID','ms.\x20Pool\x20size:\x20','getBankCode','NO_BILL_AFTER_OTP','SELECT_IMAGE_QR_CODE_BTN','BANK_CODE','quality','zrange','lockType','markAsCompleted','name','Bank\x20','logTimingBreakdown','App\x20started\x20successfully:\x20','Error\x20getting\x20devices:\x20','udid','Transaction\x20verify\x20screen\x20not\x20found','WithdrawalController','FIRST_IMAGE_BTN','AppModule','Failed\x20to\x20extract\x20transaction\x20amount\x20from\x20ROI','opts','__esModule','taskkill\x20/F\x20/IM\x20\x22','lang','get','Capturing\x20screen\x20on\x20device\x20','ezpayBeClient','promoteDelayedJobs','pool','createTransactionFolder','getQueueStats','cannot\x20find\x20a\x20process','testPressReturn','Text\x20is\x20required\x20and\x20cannot\x20be\x20empty','Panda\x20swipe\x20completed\x20successfully\x20on\x20device\x20','\x22\x20/FO\x20CSV\x20/NH','\x20as\x20processing','onModuleDestroy','HttpService','Failed\x20to\x20click\x20image\x20library\x20button','ErrorType','RedisService','RETRY','bankCode','registerBankService','Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20numbers\x20between\x200\x20and\x20100\x20for\x20Panda','Manually\x20triggering\x20job\x20picking...','all','debugQueue','inputText','validateROI','Telegram\x20API\x20error:\x20','REDIS_SERVICE_STATUS_KEY','safeErr','api/devices/:deviceId/config','sendPhotoByBase64','transfer','KIENLONGBANK','\x20(swipe\x20direction,\x20no\x20coordinates)','Queue\x20statistics','Test\x20clicking\x20at\x20specific\x20coordinates\x20on\x20a\x20device','Process\x20still\x20running\x20after\x20',']\x20Error\x20getting\x20lock:\x20','HttpException','wsUrl',']\x20Screen\x20verification\x20timeout\x20after\x20','PERMANENT','\x20delayed\x20jobs\x20to\x20waiting','Query','PROCESSING','object','40eqxmDY','20pMSiTd','patch','\x20(uppercase)','Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)','decodeImage','unknown','split',']\x20-\x20Get\x20Confirm\x20after\x20OTP\x20screen','deviceId','ms\x20(','parse','recognizeFromBuffer','Param','getRefreshBeforeTime','isInitialized','HC\x20BOX\x20error:\x20','QR_CODE_BTN','inactive','PgService','Process\x20not\x20found\x20(expected):\x20','design:returntype','BILL_AREA','replace','ACB_UI_COORDINATES','startApp','Full\x20screen','Render','stripBase64Prefix',')...','preprocess',']\x20-\x20Get\x20back\x20to\x20home\x20screen','login:','bankServices','ws://127.0.0.1:26608','found','isConnectedStatus','deductDeviceAmount','releaseLockByType','listDeviceConfigs','Mat\x20khau\x20giao\x20dich\x20OTP\x20se\x20tu\x20dong\x20lam\x20moi','/sendMessage','Number\x20string\x20to\x20input\x20(e.g.,\x20\x22123\x22,\x20\x22456789\x22)','then','createTemporaryWorker','/docs','testLaunchApp','manualRetryCount','redisLockService','api/service/stop',':config','max','acquireLock','includes','inUse','\x20swipe\x20attempts','scheduleCronRestartBoxphone','resolve','EZZPAY_BE','del','code',')\x20is\x20not\x20pending\x20or\x20retry,\x20skipping','Base\x20folder\x20already\x20exists:\x20','disable_notification','processingTime','...</b>\x0a\x0a<b>Withdrawal\x20Code:</b>\x20','Get\x20withdrawal\x20queue\x20statistics','\x20-\x20','workerPoolService','entries','üåê\x20Device\x20management:\x20http://localhost:','.\x20Retrying\x20login...','PG_ROI_EXPECTED','Password\x20field\x20clicked\x20successfully\x20on\x20device\x20','readdir','function','getAvailableDevices','terminateAll','getJob','_sendRequestOnce','\x22\x20on\x20device:\x20','base64,','1200','Click\x20completed\x20successfully\x20at\x20coordinates\x20(',',\x20Required:\x20','NestFactory','COMPLETED','TEMPORARY','design:type','Injectable','verifyScreenState','\x20(ROI:\x20','isDestroyed','stat','SessionRefreshScheduler','Bank\x20Code\x20is\x20required\x20when\x20status\x20is\x20active','now',')\x20to\x20(','withdraw:','withdrawalService','Get','isLetter','receipt','OCR\x20worker\x20pool\x20warmed\x20up\x20successfully\x20in\x20','recognize','Error\x20creating\x20WebSocket\x20connection:\x20','X\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100).\x20Required\x20for\x20HC\x20and\x20Panda\x20types\x200,1,2,10.\x20Optional\x20for\x20Panda\x20types\x204,5,6,7,8,9','IsString','transferFile','ezpayBe','withCronLock','jobManagerService','redisService','Error\x20retrying\x20login\x20for\x20device\x20','):\x20','152AjEDHA','delay','HDBank','endsWith','WithdrawalStatus','Extracted\x20transaction\x20amount:\x20','NUMPAD_LAYOUT','updateWithdrawalStatus','normalizeBankAccountName','FORCE_LOGIN','Failed\x20to\x20login\x20to\x20PGBank','set',',\x20y=','initializeJobProcessing','png','COMMON_COORDINATES','toLocaleString',']\x20Device\x20is\x20already\x20locked,\x20cannot\x20acquire\x20lock','SHINHANBANKVIETNAM','clickWithTransition','sendRequest','find','ocrService','Giao\x20d·ªãch\x20th√†nh\x20c√¥ng','\x0aLogin\x20t·∫•t\x20c·∫£\x20thi·∫øt\x20b·ªã\x20sau\x201\x20ph√∫t:','api/bank/:bankCode','ApiParam','No\x20receipt\x20path\x20provided\x20for\x20withdrawal\x20','status=','\x20attempts,\x20OCR:\x20','onModuleInit','ApiOperation','ImagePreprocessingService','screen','Error\x20extracting\x20transaction\x20amount:\x20','Pressing\x20shift\x20key\x20for\x20uppercase\x20letter\x20\x27',']\x20-\x20Get\x20Swipe\x20up\x20screen','\x20attempts)','Numpad\x20number\x20input\x20completed\x20successfully\x20on\x20device\x20','\x20on\x20device\x20','imagePreprocessingService','Failed\x20to\x20create\x20worker\x20','ACB','vie',']\x20Killing\x20','SHB','isArray','Device\x20management','withdrawalQueue','createReadStream','createWorker','launchApp','Could\x20not\x20parse\x20amount\x20from\x20OCR\x20text:\x20','requestFormWithRetry','warn','catch','isInitializing','For\x20Panda\x20format:\x20type\x20is\x20required',']\x20Error\x20acquiring\x20lock:\x20','expire','\x20with\x20type=','BankModule','status','accountName','\x20(attempt\x20','hgetall','Error\x20sending\x20telegram\x20message','\x20ROI:\x20(','SYSTEM_LOCK_PAUSE_PROCESSING','vietcombankService','registerQueue','windowsAppGitBashService','logger','length','push','HttpModule','X√°c\x20th·ª±c\x20giao\x20d·ªãch','PreprocessOptions',',\x20h=','DeviceService','zrangebyscore','sourceAccountName','updateDeviceConfig','setParameters','text','deactive','Y\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100).\x20Required\x20for\x20HC\x20and\x20Panda\x20types\x200,1,2,10.\x20Optional\x20for\x20Panda\x20types\x204,5,6,7,8,9','313518WZDfwo','forceKill','uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE','/test/click/{deviceId}?x=0.5&y=0.55','1849152HuKFDA','isSpecialCharInNumberMode','poolSize','https://apipro1.ocr.space/parse/image','.png','VERIFY_ACCOUNT_NAME','redisClient','exists','WindowsAppGitBashService','application/json','.\x20Supported\x20banks:\x20','floor','OCRWorkerPoolService','Redis\x20Client\x20Disconnected','analyzedStatus','__decorate','processWithdrawal','preprocess=','üÜò\x20<b>Devices\x20disconnected:\x20','ApiQuery','Manually\x20trigger\x20job\x20picking','Logger','Redis\x20Client\x20Reconnecting...','\x20app\x20launch\x20on\x20device:\x20','ocr','redis','existsSync','isRunning','design:paramtypes','WithdrawalProcessingError','LIMIT','TECHCOMBANK','Session\x20expired\x20or\x20missing\x20for\x20device\x20','1049420pscInc','port','endY','/4)','Executing\x20PG\x20transfer\x20for\x20withdrawal\x20','no\x20tasks','\x0a<b>Retry\x20delay:</b>\x20','EzpayBeClientService','Testing\x20numpad\x20number\x20input\x20\x22','\x0a<b>Current\x20retry:</b>\x20','testRoi','zadd',']\x20-\x20Get\x20login\x20app\x20screen','IsOptional','views','recordLogin','xiaowei_iphone.exe','App\x20launched\x20successfully','Scanning\x20folder\x20for\x20bill\x20image:\x20','Failed\x20to\x20refresh\x20session\x20for\x20device\x20','withdrawalId','TRANSACTION_CONFIRM','PASSWORD_FIELD','isRestartingBoxphone','WithdrawalService','CONTINUE_OTP_VERIFY_BTN','property','VERIFY_ACCOUNT_NUMBER','List\x20of\x20devices\x20retrieved\x20successfully','mtime','REDIS_SESSION_PREFIX','C:/EasyData','ENTER_OTP','SmartOTP\x20not\x20configured\x20for\x20device\x20',')\x20exceeds\x20maximum\x20(','active','powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22','SWIPE_UP','customROI','IWebSocketService','height','cwd','cleanupFolder','getOwnPropertyDescriptor','backoffMs','deviceService','TRANSACTION_VERIFY','next','BankService','killApp','width','PowerShell\x20kill\x20with\x20admin\x20failed,\x20trying\x20taskkill:\x20','mtimeMs','debug',']\x20Screen\x20not\x20matched\x20yet\x20(attempt\x20','writeFile','BUNDLE_ID','ƒêƒÉng\x20nh·∫≠p','clickLoginButton','sleep','fullPath','KEYBOARD_LAYOUT','VCB_ROI_EXPECTED','üöÄüöÄüöÄ\x20<b>Executing\x20Withdrawal\x20','BaseBankService','rois','Registered\x20bank\x20service:\x20','deleteDeviceConfig','testClickAtCoordinates','ApiResponse','isRetryable','apiKey','confidence','UNKNOWN','DocumentBuilder','],\x20Unexpected:\x20[','Tesseract\x20worker\x20',']\x20-\x20Login\x20successfully','X\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100)','VCB_UI_COORDINATES','/sendPhoto',')\x20>\x201','HcBoxModule','REDIS_HOST','scaleCoordinates','\x20VND\x20(confidence:\x20','click','\x20at\x20coordinates\x20(','NotificationModule','Password\x20not\x20configured\x20for\x20device\x20','Found\x20latest\x20bill\x20image:\x20','Withdrawal','restartApp','VIETBANK','response','Withdrawal\x20','com.vnpay.HDBank','Error\x20parsing\x20WebSocket\x20message:\x20','Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20between\x200\x20and\x20100\x20for\x20Panda','\x20as\x20failed:\x20','DEFAULT_LOCK_TTL','delayed','getWaitingCount','list',']\x20-\x20Get\x20Transaction\x20verification\x20screen','HTML','BankController','BankCodeWithdrawal',',\x20bank\x20','psm','exports','message','WithdrawalJobManagerService','extendLock','OCR_MAX_WIDTH_FULL','pushEvent','disableNotification','extract',']\x20Error\x20verifying\x20screen\x20(attempt\x20',').\x20Using\x20','_id','EXIMBANK','retryLogin','Uploading\x20bill\x20for\x20withdrawal\x20','deviceLock','add','·∫¢nh','1059075cdyfqQ','Error\x20testing\x20click\x20at\x20coordinates:\x20','/test/swipe/{deviceId}?x=50&y=30&type=','description','prototype','\x27\x20-ErrorAction\x20SilentlyContinue\x20|\x20Stop-Process\x20-Force\x20-ErrorAction\x20Stop','availableAmount','/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3','ejs','üöÄüöÄüöÄ\x20<b>Boxphone\x20software(local\x20dev)...</b>',',\x20x=','IMAGE_LIBRARY_BTN','handleMessage','fieldType','the\x20system\x20cannot\x20find','isAcquiring','waiting','bankService','matchedTexts','rawPath','NAMABANK','service:status','Test\x20inputting\x20text\x20using\x20keyboard\x20layout\x20on\x20a\x20device','REDIS_DEVICE_CONFIG_SUFFIX','test/roi','BVBANK','checkIfProcessed','REDIS_LOCK_PREFIX','Password\x20is\x20required\x20when\x20status\x20is\x20active','OTP_ENTER_TRANSFER_BTN','amount','http',':meta','pointerEvent','Error\x20updating\x20withdrawal\x20status\x20for\x20','Account\x20Name\x20is\x20required\x20when\x20status\x20is\x20active',':\x20x\x20and\x20y\x20are\x20required','log','forRoot','HD_ROI_EXPECTED','\x20waiting).','OCR_WHITELIST_BLOCK','Error\x20listing\x20devices:\x20','LOGIN_BTN','Testing\x20Panda\x20swipe\x20on\x20device:\x20','ValidateIf','getDeviceConfig','Kh√¥ng\x20th·ªÉ\x20x√≥a\x20folder:\x20','sendMessage','\x20|\x20Expected:\x20[','Scheduling\x20reconnect\x20attempt\x20','.\x20Available:\x20','scan_','/2)Reason:\x20','wsService','access\x20is\x20denied','timestamp','HcBoxService','startTarget','],\x20','LAUNCH_APP','Telegram\x20form\x20request\x20failed,\x20retrying\x20in\x20','ScheduleModule','toLowerCase','Failed\x20to\x20reset\x20worker\x20parameters:\x20','screenFile','sessionManagement','Error\x20getting\x20device\x20config\x20for\x20','Device\x20','üìä\x20Withdrawal\x20processing\x20started\x20by\x20','Cannot\x20refresh\x20session\x20for\x20device\x20','Error\x20picking\x20jobs:\x20','lastUsed','access\x20denied','unlink','Received\x20response\x20but\x20no\x20pending\x20requests:\x20','singleLine','K82766678488957','Failed\x20to\x20terminate\x20temporary\x20worker:\x20','Text\x20input\x20completed\x20on\x20device\x20','swipe','ANALYZE_BILL_ROI','config','getROIConfig','pickFromZSet','Module','/test/input-text/{deviceId}?text=abc123','OCR_PSM_SINGLE','pendingRequests','RedisLockService','\x20is\x20currently\x20locked\x20by\x20','PENDING','buffer','markAsFailed','replyToMessageId',']\x20Acquired\x20','trim','WEBSOCKET_SERVICE','\x0a\x0a<b>Kh·ªüi\x20ƒë·ªông\x20l·∫°i:</b>\x20','AGRIBANK','Updating\x20withdrawal\x20','getBankService','IsNotEmpty','pgService','zrem','Start-Process\x20-FilePath\x20\x27','close','mustDefaultChatId','bull:wda-request:priority','\x22\x20-Verb\x20RunAs\x20-Wait\x20-WindowStyle\x20Hidden','full','getServiceStatus','Error\x20sending\x20WebSocket\x20request:\x20','TelegramService','hasAnyLockKeys','waitingQueue','.env','PG_UI_COORDINATES',']\x20-\x20Get\x20Transaction\x20verify\x20screen','\x20lock','parseMode','getLock','setVersion','indexOf','HCWebSocketService','Failed\x20to\x20login\x20','Image\x20too\x20small:\x20','connect','Body','fastScreenOCR','Asia/Ho_Chi_Minh','recognizeFromFile','6888','baseTransactionFolderPath','validateObjectResult','getWithdrawalDetails',',\x20retrying...','data','Inject','1.0','isConnected','GPBANK','scheduleReconnect','Available\x20Amount\x20l√†\x20b·∫Øt\x20bu·ªôc\x20v√†\x20ph·∫£i\x20>=\x200\x20khi\x20status\x20l√†\x20active','NotificationService','captureScreen','executeInternalTransfer','Test\x20pressing\x20return\x20key\x20on\x20a\x20device','toFile','/bot','Timeout\x20scanning\x20folder\x20for\x20bill\x20image:\x20','getDelayedCount','errors','from','BullModule','inputPasswordFromConfig','caption','processRequestQueue','process\x20not\x20found','Successfully\x20processed\x20withdrawal:\x20','smartOTP','getLatestImagePath','map','home','Method\x20not\x20implemented.','inputNumpadNumber','Queue',',\x20Error:\x20','OCR\x20error\x20from\x20buffer:\x20','folderCreationInProgress','postprocessText','closeMainWindow','value','folderCreated','maxReconnectAttempts','HttpStatus','promote','CONTINUE_TRANSFER_BTN','PandaSwipeTypeEnum','REDIS_PROCESSED_PREFIX','WithdrawalModule','createBillFolder','Failed\x20to\x20upload\x20bill\x20for\x20withdrawal\x20'];a0_0x4ec8=function(){return _0x23840a;};return a0_0x4ec8();}function a0_0x2e92(_0x418c98,_0x3a969d){_0x418c98=_0x418c98-0xda;const _0x4ec891=a0_0x4ec8();let _0x2e9275=_0x4ec891[_0x418c98];return _0x2e9275;}(function(_0x33a283,_0x2df629){const _0x32b103=a0_0x2e92,_0x14c27f=_0x33a283();while(!![]){try{const _0x4097be=-parseInt(_0x32b103(0x369))/0x1*(-parseInt(_0x32b103(0x1b5))/0x2)+parseInt(_0x32b103(0x210))/0x3+-parseInt(_0x32b103(0xe9))/0x4+parseInt(_0x32b103(0x143))/0x5*(-parseInt(_0x32b103(0x20c))/0x6)+parseInt(_0x32b103(0xdb))/0x7*(parseInt(_0x32b103(0x142))/0x8)+parseInt(_0x32b103(0x2b0))/0x9+-parseInt(_0x32b103(0x231))/0xa*(parseInt(_0x32b103(0x378))/0xb);if(_0x4097be===_0x2df629)break;else _0x14c27f['push'](_0x14c27f['shift']());}catch(_0x4ce0d8){_0x14c27f['push'](_0x14c27f['shift']());}}}(a0_0x4ec8,0x73b0b),((()=>{'use strict';var _0x540eef=[,_0x2143a8=>{_0x2143a8['exports']=require('@nestjs/core');},_0x20f02b=>{_0x20f02b['exports']=require('@nestjs/common');},_0x39ec47=>{_0x39ec47['exports']=require('@nestjs/swagger');},_0x5b51af=>{_0x5b51af['exports']=require('path');},function(_0x1ae260,_0x485227,_0x11455c){const _0x59316b=a0_0x2e92;var _0x5baa82=this&&this['__decorate']||function(_0x461dbb,_0x17a86e,_0x32c6b3,_0x1eecae){const _0x36ddb2=a0_0x2e92;var _0x399c91,_0x7cbde5=arguments[_0x36ddb2(0x1fe)],_0x1a822f=_0x7cbde5<0x3?_0x17a86e:null===_0x1eecae?_0x1eecae=Object[_0x36ddb2(0x25c)](_0x17a86e,_0x32c6b3):_0x1eecae;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x1a822f=Reflect['decorate'](_0x461dbb,_0x17a86e,_0x32c6b3,_0x1eecae);else{for(var _0x18d989=_0x461dbb['length']-0x1;_0x18d989>=0x0;_0x18d989--)(_0x399c91=_0x461dbb[_0x18d989])&&(_0x1a822f=(_0x7cbde5<0x3?_0x399c91(_0x1a822f):_0x7cbde5>0x3?_0x399c91(_0x17a86e,_0x32c6b3,_0x1a822f):_0x399c91(_0x17a86e,_0x32c6b3))||_0x1a822f);}return _0x7cbde5>0x3&&_0x1a822f&&Object[_0x36ddb2(0x3cc)](_0x17a86e,_0x32c6b3,_0x1a822f),_0x1a822f;};Object[_0x59316b(0x3cc)](_0x485227,'__esModule',{'value':!0x0}),_0x485227[_0x59316b(0x10d)]=void 0x0;const _0x1c96ee=_0x11455c(0x2),_0x5c68e5=_0x11455c(0x6),_0x293e2d=_0x11455c(0x7),_0xceeccd=_0x11455c(0x8),_0x1a47e9=_0x11455c(0x9),_0x2ee010=_0x11455c(0x47),_0x3e0202=_0x11455c(0x49),_0x26e263=_0x11455c(0xf),_0x22acb3=_0x11455c(0x4e),_0x4f43eb=_0x11455c(0x11),_0x5c5d79=_0x11455c(0x4c),_0x3401e7=_0x11455c(0x53),_0x5ea039=_0x11455c(0x54),_0x307c59=_0x11455c(0x56);let _0x13ae5d=class{};_0x485227['AppModule']=_0x13ae5d,_0x485227['AppModule']=_0x13ae5d=_0x5baa82([(0x0,_0x1c96ee['Module'])({'imports':[_0x5c68e5[_0x59316b(0x34a)]['forRoot']({'redis':{'host':_0x4f43eb[_0x59316b(0x302)]['redis'][_0x59316b(0x3e6)],'port':_0x4f43eb[_0x59316b(0x302)]['redis'][_0x59316b(0x232)],'db':_0x4f43eb[_0x59316b(0x302)][_0x59316b(0x229)]['db'],'password':_0x4f43eb['config'][_0x59316b(0x229)]['password']},'defaultJobOptions':{'removeOnComplete':0xa,'removeOnFail':0x32,'attempts':0x3,'backoff':{'type':'exponential','delay':0x7d0}}}),_0x293e2d['ScheduleModule'][_0x59316b(0x2d6)](),_0xceeccd[_0x59316b(0x200)],_0x1a47e9['WithdrawalModule'],_0x2ee010[_0x59316b(0x283)],_0x3e0202['DeviceModule'],_0x22acb3['WebSocketModule'],_0x5c5d79[_0x59316b(0x1f2)],_0x3401e7['OCRModule'],_0x5ea039['NotificationModule'],_0x307c59[_0x59316b(0x3c0)]],'providers':[_0x26e263['RedisService']],'exports':[_0x26e263['RedisService']]})],_0x13ae5d);},_0x3602f8=>{_0x3602f8['exports']=require('@nestjs/bull');},_0x477dc9=>{_0x477dc9['exports']=require('@nestjs/schedule');},_0x18dac1=>{_0x18dac1['exports']=require('@nestjs/axios');},function(_0x4887d4,_0x2da2a2,_0x3343d7){const _0x13ca63=a0_0x2e92;var _0x39475d=this&&this['__decorate']||function(_0x359c4e,_0x47c016,_0x368ff7,_0x1d6d32){var _0xa6b96b,_0x56fb85=arguments['length'],_0x162b67=_0x56fb85<0x3?_0x47c016:null===_0x1d6d32?_0x1d6d32=Object['getOwnPropertyDescriptor'](_0x47c016,_0x368ff7):_0x1d6d32;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x162b67=Reflect['decorate'](_0x359c4e,_0x47c016,_0x368ff7,_0x1d6d32);else{for(var _0x2e65ae=_0x359c4e['length']-0x1;_0x2e65ae>=0x0;_0x2e65ae--)(_0xa6b96b=_0x359c4e[_0x2e65ae])&&(_0x162b67=(_0x56fb85<0x3?_0xa6b96b(_0x162b67):_0x56fb85>0x3?_0xa6b96b(_0x47c016,_0x368ff7,_0x162b67):_0xa6b96b(_0x47c016,_0x368ff7))||_0x162b67);}return _0x56fb85>0x3&&_0x162b67&&Object['defineProperty'](_0x47c016,_0x368ff7,_0x162b67),_0x162b67;};Object[_0x13ca63(0x3cc)](_0x2da2a2,'__esModule',{'value':!0x0}),_0x2da2a2['WithdrawalModule']=void 0x0;const _0x55dcf0=_0x3343d7(0x2),_0x34b8d5=_0x3343d7(0x6),_0x443a4b=_0x3343d7(0x7),_0xa2850a=_0x3343d7(0xa),_0x1b1bd6=_0x3343d7(0x38),_0xd82e45=_0x3343d7(0x46),_0x52093d=_0x3343d7(0x36),_0xf33a9b=_0x3343d7(0xf),_0x588746=_0x3343d7(0x47),_0x5e6b5a=_0x3343d7(0x49),_0xcaf972=_0x3343d7(0x4c),_0x3910e5=_0x3343d7(0x8),_0x56a119=_0x3343d7(0x55);let _0x309b29=class{};_0x2da2a2[_0x13ca63(0x364)]=_0x309b29,_0x2da2a2['WithdrawalModule']=_0x309b29=_0x39475d([(0x0,_0x55dcf0['Module'])({'imports':[_0x34b8d5['BullModule'][_0x13ca63(0x1fb)]({'name':'wda-request'}),_0x443a4b[_0x13ca63(0x2ee)],_0x588746['HcBoxModule'],(0x0,_0x55dcf0['forwardRef'])(()=>_0x5e6b5a['DeviceModule']),_0xcaf972['BankModule'],_0x3910e5[_0x13ca63(0x200)],_0x56a119['WindowAppModule']],'controllers':[_0xd82e45['WithdrawalController']],'providers':[_0xa2850a['WithdrawalService'],_0x1b1bd6[_0x13ca63(0x2a1)],_0x52093d['EzpayBeClientService'],_0xf33a9b['RedisService']],'exports':[_0xa2850a['WithdrawalService']]})],_0x309b29);},function(_0xb0f954,_0x1a2c63,_0x462fb4){const _0xe8faad=a0_0x2e92;var _0x2c1dea,_0x4199c7,_0x28fef2,_0x8e142f,_0x1cc04a,_0x38a7e7,_0xad0446=this&&this['__decorate']||function(_0x559d2e,_0x1bffac,_0x2024e4,_0xac4a19){const _0x282f7c=a0_0x2e92;var _0x144040,_0x501ce7=arguments['length'],_0x29a746=_0x501ce7<0x3?_0x1bffac:null===_0xac4a19?_0xac4a19=Object[_0x282f7c(0x25c)](_0x1bffac,_0x2024e4):_0xac4a19;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x282f7c(0x3b0)])_0x29a746=Reflect[_0x282f7c(0x3b0)](_0x559d2e,_0x1bffac,_0x2024e4,_0xac4a19);else{for(var _0x5810e4=_0x559d2e['length']-0x1;_0x5810e4>=0x0;_0x5810e4--)(_0x144040=_0x559d2e[_0x5810e4])&&(_0x29a746=(_0x501ce7<0x3?_0x144040(_0x29a746):_0x501ce7>0x3?_0x144040(_0x1bffac,_0x2024e4,_0x29a746):_0x144040(_0x1bffac,_0x2024e4))||_0x29a746);}return _0x501ce7>0x3&&_0x29a746&&Object['defineProperty'](_0x1bffac,_0x2024e4,_0x29a746),_0x29a746;},_0x1035ce=this&&this['__metadata']||function(_0x69ddb,_0x150f8b){const _0x1b7199=a0_0x2e92;if(_0x1b7199(0x141)==typeof Reflect&&_0x1b7199(0x18d)==typeof Reflect[_0x1b7199(0x3ac)])return Reflect['metadata'](_0x69ddb,_0x150f8b);},_0x541f96=this&&this['__param']||function(_0x5df7e9,_0x52a245){return function(_0x570556,_0x3afcfc){_0x52a245(_0x570556,_0x3afcfc,_0x5df7e9);};};Object['defineProperty'](_0x1a2c63,_0xe8faad(0x110),{'value':!0x0}),_0x1a2c63[_0xe8faad(0x249)]=void 0x0;const _0x23fb40=_0x462fb4(0x2),_0x5276c=_0x462fb4(0xb),_0x474d7c=_0x462fb4(0xe),_0x4b9582=_0x462fb4(0xf),_0x92dd76=_0x462fb4(0xd),_0x2ee2fb=_0x462fb4(0x13),_0x5ca524=_0x462fb4(0x2a),_0xa7a2a6=_0x462fb4(0x35),_0x2804f4=_0x462fb4(0x37),_0x3ac929=_0x462fb4(0x11),_0x29d184=_0x462fb4(0x8);let _0x1bdef9=class{constructor(_0x175209,_0x369a66,_0x36129b,_0x18a0d2,_0x4289df,_0x31cd37){const _0x56c114=_0xe8faad;this['wsService']=_0x175209,this['bankService']=_0x369a66,this[_0x56c114(0x25e)]=_0x36129b,this[_0x56c114(0x1b2)]=_0x18a0d2,this['notificationService']=_0x4289df,this['httpService']=_0x31cd37,this[_0x56c114(0x1fd)]=new _0x23fb40['Logger']('WithdrawalService'),this['REDIS_PROCESSED_PREFIX']=_0x56c114(0x3a8),this['PROCESSING_TTL']=0xf731400,this['COMPLETED_TTL']=0xf731400;}async['checkIfProcessed'](_0x2a1df1){const _0x41b60a=_0xe8faad;try{const _0x3fe6d9=''+this['REDIS_PROCESSED_PREFIX']+_0x2a1df1,_0x218ef4=await this['redisService']['get'](_0x3fe6d9);return'completed'===_0x218ef4?(this['logger']['warn']('Withdrawal\x20'+_0x2a1df1+'\x20already\x20completed'),!0x0):'processing'===_0x218ef4&&(this[_0x41b60a(0x1fd)][_0x41b60a(0x1eb)]('Withdrawal\x20'+_0x2a1df1+'\x20is\x20being\x20processed\x20by\x20another\x20instance'),!0x0);}catch(_0x17f965){return this['logger']['error']('Error\x20checking\x20processed\x20status\x20for\x20'+_0x2a1df1+':\x20'+_0x17f965['message']),!0x1;}}async['markAsProcessing'](_0x2563bd){const _0x34ecb5=_0xe8faad;try{const _0x36046f=''+this['REDIS_PROCESSED_PREFIX']+_0x2563bd;return'OK'===await this['redisService']['setnx'](_0x36046f,_0x34ecb5(0xf4),this['PROCESSING_TTL'])?(this['logger'][_0x34ecb5(0x266)]('Marked\x20withdrawal\x20'+_0x2563bd+_0x34ecb5(0x11f)),!0x0):(this['logger']['warn'](_0x34ecb5(0x290)+_0x2563bd+'\x20is\x20already\x20being\x20processed\x20by\x20another\x20instance'),!0x1);}catch(_0x5d275d){return this['logger']['error']('Error\x20marking\x20withdrawal\x20'+_0x2563bd+'\x20as\x20processing:\x20'+_0x5d275d['message']),!0x0;}}async['markAsCompleted'](_0x1332c8){const _0x573475=_0xe8faad;try{const _0x58285e=''+this[_0x573475(0x363)]+_0x1332c8;await this[_0x573475(0x1b2)]['set'](_0x58285e,_0x573475(0x376),this['COMPLETED_TTL']),this['logger']['log']('Marked\x20withdrawal\x20'+_0x1332c8+'\x20as\x20completed');}catch(_0x3161be){this['logger']['error']('Error\x20marking\x20withdrawal\x20'+_0x1332c8+'\x20as\x20completed:\x20'+_0x3161be['message']);}}async[_0xe8faad(0x30d)](_0x537ab0){const _0x5eded3=_0xe8faad;try{const _0x248b67=''+this[_0x5eded3(0x363)]+_0x537ab0;await this['redisService']['del'](_0x248b67),this['logger']['log'](_0x5eded3(0x3c5)+_0x537ab0+'\x20as\x20failed\x20(removed\x20from\x20processed\x20list)');}catch(_0x1ed1c0){this['logger']['error']('Error\x20marking\x20withdrawal\x20'+_0x537ab0+_0x5eded3(0x294)+_0x1ed1c0['message']);}}async['processWithdrawal'](_0x31b8d4,_0x4116c6){const _0x33cd43=_0xe8faad,{withdrawalId:_0x33c9cd,bankCode:_0x5977c9,amount:_0x13a995}=_0x31b8d4;if(await this[_0x33cd43(0x2ca)](_0x33c9cd))this[_0x33cd43(0x1fd)]['warn'](_0x33cd43(0x290)+_0x33c9cd+'\x20already\x20processed\x20or\x20being\x20processed,\x20skipping');else{if(!await this['markAsProcessing'](_0x33c9cd)){const _0x338ba4='Withdrawal\x20'+_0x33c9cd+'\x20is\x20being\x20processed\x20by\x20another\x20instance';throw this[_0x33cd43(0x1fd)][_0x33cd43(0x1eb)](_0x338ba4),new _0x5ca524['WithdrawalProcessingError'](_0x338ba4,_0x5ca524[_0x33cd43(0x123)][_0x33cd43(0x199)]);}try{this[_0x33cd43(0x1fd)][_0x33cd43(0x2d5)]('['+_0x4116c6+']\x20Processing\x20withdrawal:\x20'+_0x33c9cd+'\x20for\x20bank:\x20'+_0x5977c9+',\x20amount:\x20'+_0x13a995);const _0x2b5f6f=await this[_0x33cd43(0x25e)]['getDeviceConfig'](_0x4116c6);if(_0x2b5f6f[_0x33cd43(0x2b6)]<_0x13a995){const _0x2ad46a='['+_0x4116c6+']\x20Assigned\x20device\x20has\x20insufficient\x20amount.\x20Available:\x20'+_0x2b5f6f['availableAmount']+_0x33cd43(0x196)+_0x13a995;throw this[_0x33cd43(0x1fd)]['error'](_0x2ad46a),await this[_0x33cd43(0x30d)](_0x33c9cd),await this['deviceService']['updateDeviceConfig'](_0x4116c6,{'status':_0x33cd43(0x20a)}),new _0x5ca524[(_0x33cd43(0x22d))](_0x2ad46a,_0x5ca524['ErrorType'][_0x33cd43(0x199)]);}await this['bankService']['executeTransferWithQRCode'](_0x31b8d4,_0x2b5f6f,_0x2b5f6f['bankCode']),this['deviceService']['deductDeviceAmount'](_0x4116c6,_0x13a995)['catch'](()=>{});const _0x424f15=await this[_0x33cd43(0x2c1)][_0x33cd43(0xe2)](_0x2b5f6f[_0x33cd43(0x126)],_0x31b8d4);this[_0x33cd43(0xdd)]['completeWithdrawal'](_0x31b8d4,_0x424f15,_0x2b5f6f)['catch'](()=>{}),'unknown'===_0x424f15['analyzedStatus']&&await this['bankService'][_0x33cd43(0x3ca)](_0x2b5f6f['bankCode'],_0x4116c6,!0x0),await this[_0x33cd43(0x103)](_0x33c9cd),this[_0x33cd43(0x1fd)][_0x33cd43(0x2d5)](_0x33cd43(0x34f)+_0x33c9cd);}catch(_0xfe3543){if(await this[_0x33cd43(0x30d)](_0x33c9cd),_0xfe3543 instanceof _0x5ca524['WithdrawalProcessingError'])throw _0xfe3543;throw new _0x5ca524['WithdrawalProcessingError'](_0xfe3543['message']||'Unknown\x20error',_0x5ca524[_0x33cd43(0x123)]['PERMANENT']);}}}async[_0xe8faad(0x337)](_0xd862a7){const _0x1d9672=_0xe8faad,_0x481610=_0x3ac929['config']['ezpayBe']['apiUrl']+'/api/internal/withdrawals/'+_0xd862a7;return(await(0x0,_0x2804f4['firstValueFrom'])(this['httpService'][_0x1d9672(0x113)](_0x481610,{'headers':{'Content-Type':_0x1d9672(0x219),'X-API-Key':_0x3ac929[_0x1d9672(0x302)]['ezpayBe']['apiKey'],'x-internal-secret-key':_0x3ac929['config'][_0x1d9672(0x1af)]['apiKey']},'timeout':0x4e20})))['data']['data'];}};_0x1a2c63[_0xe8faad(0x249)]=_0x1bdef9,_0x1a2c63['WithdrawalService']=_0x1bdef9=_0xad0446([(0x0,_0x23fb40[_0xe8faad(0x19b)])(),_0x541f96(0x0,(0x0,_0x23fb40['Inject'])(_0x92dd76['WEBSOCKET_SERVICE'])),_0x541f96(0x2,(0x0,_0x23fb40[_0xe8faad(0x33a)])((0x0,_0x23fb40[_0xe8faad(0x3b6)])(()=>_0x474d7c['DeviceService']))),_0x1035ce('design:paramtypes',['function'==typeof(_0x2c1dea=void 0x0!==_0x2ee2fb[_0xe8faad(0x258)]&&_0x2ee2fb['IWebSocketService'])?_0x2c1dea:Object,'function'==typeof(_0x4199c7=void 0x0!==_0x5276c['BankService']&&_0x5276c['BankService'])?_0x4199c7:Object,_0xe8faad(0x18d)==typeof(_0x28fef2=void 0x0!==_0x474d7c['DeviceService']&&_0x474d7c['DeviceService'])?_0x28fef2:Object,'function'==typeof(_0x8e142f=void 0x0!==_0x4b9582['RedisService']&&_0x4b9582['RedisService'])?_0x8e142f:Object,'function'==typeof(_0x1cc04a=void 0x0!==_0xa7a2a6['NotificationService']&&_0xa7a2a6['NotificationService'])?_0x1cc04a:Object,_0xe8faad(0x18d)==typeof(_0x38a7e7=void 0x0!==_0x29d184[_0xe8faad(0x121)]&&_0x29d184[_0xe8faad(0x121)])?_0x38a7e7:Object])],_0x1bdef9);},function(_0x1130b3,_0x2c9637,_0x494708){const _0x289b92=a0_0x2e92;var _0x4292db,_0x4e4543,_0x43d293,_0x8a0828,_0x21ca84,_0x5cf261,_0x16994a,_0x267f0e,_0xafdf53=this&&this['__decorate']||function(_0x1f71d4,_0x1ee7fd,_0x82b64e,_0x190dc4){const _0x2c18e8=a0_0x2e92;var _0x2fde7,_0xe763f1=arguments['length'],_0x3ea378=_0xe763f1<0x3?_0x1ee7fd:null===_0x190dc4?_0x190dc4=Object['getOwnPropertyDescriptor'](_0x1ee7fd,_0x82b64e):_0x190dc4;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x3ea378=Reflect[_0x2c18e8(0x3b0)](_0x1f71d4,_0x1ee7fd,_0x82b64e,_0x190dc4);else{for(var _0x4d5409=_0x1f71d4['length']-0x1;_0x4d5409>=0x0;_0x4d5409--)(_0x2fde7=_0x1f71d4[_0x4d5409])&&(_0x3ea378=(_0xe763f1<0x3?_0x2fde7(_0x3ea378):_0xe763f1>0x3?_0x2fde7(_0x1ee7fd,_0x82b64e,_0x3ea378):_0x2fde7(_0x1ee7fd,_0x82b64e))||_0x3ea378);}return _0xe763f1>0x3&&_0x3ea378&&Object['defineProperty'](_0x1ee7fd,_0x82b64e,_0x3ea378),_0x3ea378;},_0x202701=this&&this['__metadata']||function(_0x27f7e7,_0x47d611){const _0x2b9fa3=a0_0x2e92;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x2b9fa3(0x3ac)])return Reflect[_0x2b9fa3(0x3ac)](_0x27f7e7,_0x47d611);};Object['defineProperty'](_0x2c9637,'__esModule',{'value':!0x0}),_0x2c9637[_0x289b92(0x261)]=void 0x0;const _0x32a665=_0x494708(0x2),_0x15def2=_0x494708(0xc),_0x4d1bd7=_0x494708(0x28),_0x49fee6=_0x494708(0x2f),_0x28ea58=_0x494708(0x32),_0x22c8cf=_0x494708(0xe),_0x72fbbd=_0x494708(0x34),_0x33f418=_0x494708(0x14),_0x3fc10c=_0x494708(0x2a),_0x30f609=_0x494708(0x2c),_0x5e0ec7=_0x494708(0x18),_0x47fb22=_0x494708(0x4),_0x13ecf2=_0x494708(0x1a),_0x2cb99f=_0x494708(0x19);let _0x488c34=class{constructor(_0x486443,_0x45d19c,_0x23ce2e,_0x4f2c8a,_0x91ad5d,_0x4a5e1c,_0x1eb7eb,_0x2c6812){const _0x400831=_0x289b92;this['acbService']=_0x486443,this[_0x400831(0x317)]=_0x45d19c,this[_0x400831(0x3ba)]=_0x23ce2e,this['vietcombankService']=_0x4f2c8a,this['deviceService']=_0x91ad5d,this['sessionManagement']=_0x4a5e1c,this['deviceLock']=_0x1eb7eb,this['telegramService']=_0x2c6812,this['logger']=new _0x32a665[(_0x400831(0x225))]('BankService'),this['bankServices']=new Map(),this['registerBankService'](this['acbService']),this['registerBankService'](this['pgService']),this[_0x400831(0x127)](this['hdBankService']),this['registerBankService'](this[_0x400831(0x1fa)]);}['registerBankService'](_0x56bbd0){const _0x326098=_0x289b92,_0x59b44d=_0x56bbd0[_0x326098(0xfc)]()['toUpperCase']();this['bankServices']['set'](_0x59b44d,_0x56bbd0),this['logger']['log'](_0x326098(0x273)+_0x59b44d);}['getBankService'](_0x1ea511){const _0x3c2403=_0x289b92,_0x5f3881=this[_0x3c2403(0x163)]['get'](_0x1ea511['toUpperCase']());if(!_0x5f3881)throw new _0x3fc10c['WithdrawalProcessingError'](_0x3c2403(0x105)+_0x1ea511+'\x20not\x20supported!\x20Cannot\x20find\x20bank\x20service\x20out!',_0x3fc10c['ErrorType']['PERMANENT']);return _0x5f3881;}['getSupportedBanks'](){const _0x48cbdf=_0x289b92;return Array[_0x48cbdf(0x349)](this['bankServices']['keys']());}async[_0x289b92(0x3ca)](_0x34460a,_0x341cd8,_0x26a341=!0x1){const _0x2ff599=_0x289b92;if(_0x26a341&&await this['deviceLock']['releaseLock'](_0x341cd8),await this[_0x2ff599(0x2ad)]['isLocked'](_0x341cd8)){const _0x5c9eb7=await this['deviceLock']['getLock'](_0x341cd8);throw new Error(_0x2ff599(0x2f4)+_0x341cd8+_0x2ff599(0x30a)+_0x5c9eb7?.['lockType']+'\x20('+_0x5c9eb7?.['lockedBy']+').\x20Cannot\x20login.');}const _0x244e40=_0x2ff599(0x162)+_0x34460a+':'+_0x341cd8+':'+Date['now']();if(!await this['deviceLock'][_0x2ff599(0x176)](_0x341cd8,'login',_0x244e40,0x41eb0))throw new Error('Failed\x20to\x20acquire\x20lock\x20for\x20device\x20'+_0x341cd8);try{await this['sessionManagement']['markLoggingIn'](_0x341cd8,_0x34460a);const _0x475aa0=this['getBankService'](_0x34460a);if(!_0x475aa0)throw new Error('Bank\x20service\x20not\x20found\x20for\x20bank\x20code:\x20'+_0x34460a);this[_0x2ff599(0x1fd)]['log']('['+_0x341cd8+']\x20Logging\x20in\x20to\x20'+_0x34460a),await _0x475aa0['login'](_0x341cd8),await this['sessionManagement'][_0x2ff599(0x240)](_0x341cd8,_0x34460a),this['logger']['log']('['+_0x341cd8+']\x20Successfully\x20logged\x20in\x20to\x20'+_0x34460a);}catch(_0xd848f4){throw await this['sessionManagement']['clearSession'](_0x341cd8,_0x34460a),_0xd848f4;}finally{await this['deviceLock']['releaseLock'](_0x341cd8);}}async['loginAllActiveBanks'](){const _0x37db10=_0x289b92;try{const _0x92edf1=0x6,_0xefb166=0x2710;let _0x416c85=[];for(let _0x488fa6=0x0;_0x488fa6<_0x92edf1&&(this['logger']['log']('['+(_0x488fa6+0x1)+'/'+_0x92edf1+']\x20Retrying\x20to\x20list\x20devices\x20on\x20login...'),_0x416c85=await this['deviceService']['listDevices'](),!(_0x416c85['length']>0x0));_0x488fa6++)await(0x0,_0x5e0ec7['sleep'])(_0xefb166);const _0x388600=await this[_0x37db10(0x25e)]['listDeviceConfigs'](),_0x3e5d94=_0x416c85[_0x37db10(0x3b3)](_0x32b069=>'active'===_0x32b069['status']&&_0x32b069[_0x37db10(0x126)]),_0x421d2d=_0x388600['filter'](_0x5e9901=>'active'===_0x5e9901[_0x37db10(0x1f3)]&&_0x5e9901['bankCode']);if(_0x3e5d94['length']<_0x421d2d[_0x37db10(0x1fe)]){const _0x13f1e4=_0x421d2d['filter'](_0x264f51=>!_0x3e5d94['some'](_0x441bb0=>_0x441bb0[_0x37db10(0x109)]===_0x264f51['deviceId'])),_0x3e7c77=_0x13f1e4['map'](_0x2c14d2=>'<b>Bank:</b>\x20'+_0x2c14d2[_0x37db10(0x126)]+'\x0a<b>Account:</b>\x20'+_0x2c14d2['accountName'])[_0x37db10(0x3ed)]('\x0a\x0a');this['telegramService']['sendMessage']({'text':_0x37db10(0x222)+_0x13f1e4[_0x37db10(0x1fe)]+'</b>\x0a\x0a'+_0x3e7c77,'options':{'parseMode':_0x37db10(0x29a)}});}if(0x0===_0x3e5d94[_0x37db10(0x1fe)])return void this['logger'][_0x37db10(0x1eb)]('No\x20active\x20devices\x20found\x20to\x20login');for(const _0x460aa4 of _0x3e5d94){const _0x2dddd1=_0x460aa4['udid'];try{await this[_0x37db10(0x2ad)]['releaseLockByType'](_0x2dddd1,_0x37db10(0x133));}catch(_0x387620){this[_0x37db10(0x1fd)][_0x37db10(0x1eb)]('Failed\x20to\x20release\x20transfer\x20lock\x20for\x20device\x20'+_0x2dddd1+':\x20'+_0x387620['message']);}}const _0x83a15e=[];for(const _0x1730b9 of _0x3e5d94){const _0x4f2568=_0x1730b9['bankCode']['toUpperCase'](),_0x162840=_0x1730b9['udid'];_0x83a15e['push'](this[_0x37db10(0x3ca)](_0x4f2568,_0x162840,!0x0)['catch'](_0x574f9e=>{const _0x1fb1f3=_0x37db10;this['logger']['error'](_0x1fb1f3(0x32d)+_0x4f2568+_0x1fb1f3(0x1dc)+_0x162840+':\x20'+_0x574f9e['message']);}));}await Promise['allSettled'](_0x83a15e),this[_0x37db10(0x1fd)]['log']('Completed\x20login\x20process\x20for\x20all\x20active\x20banks');}catch(_0x5cd856){throw this['logger']['error']('Error\x20logging\x20in\x20all\x20active\x20banks:\x20'+_0x5cd856[_0x37db10(0x2a0)]),_0x5cd856;}}['executeTransferWithQRCode'](_0x54ceda,_0x33e933,_0x1d3f51){return this['getBankService'](_0x1d3f51)['executeTransferWithQRCode'](_0x54ceda,_0x33e933);}async['isSessionValid'](_0x1a1baf,_0x3c7c21){const _0x58a2be=_0x289b92;return await this[_0x58a2be(0x2f2)]['isSessionValid'](_0x1a1baf,_0x3c7c21);}['analyzeTransferBill'](_0xdf82f1,_0x3220ff){const _0x494120=_0x289b92;return this['getBankService'](_0xdf82f1)[_0x494120(0xe2)](_0xdf82f1,_0x3220ff);}async['refreshSessionIfNeeded'](_0x5051a5,_0x458415){const _0x38274f=_0x289b92,_0x3b882d=await this['sessionManagement']['getSession'](_0x5051a5,_0x458415);if('logging_in'===_0x3b882d?.[_0x38274f(0x1f3)])return!0x1;const _0x5bf8fd=await this[_0x38274f(0x2f2)]['needsRefresh'](_0x5051a5,_0x458415),_0x2cadd6=await this['sessionManagement'][_0x38274f(0x3d8)](_0x5051a5,_0x458415);if(!_0x5bf8fd&&_0x2cadd6)return!0x1;if(await this['deviceLock']['isLocked'](_0x5051a5))return this[_0x38274f(0x1fd)]['warn'](_0x38274f(0x2f6)+_0x5051a5+'\x20-\x20device\x20is\x20locked'),!0x1;try{return _0x2cadd6?this[_0x38274f(0x1fd)]['log'](_0x38274f(0x3d5)+_0x5051a5+_0x38274f(0x29d)+_0x458415):this['logger']['log'](_0x38274f(0x230)+_0x5051a5+_0x38274f(0x29d)+_0x458415+_0x38274f(0x189)),await this['login'](_0x458415,_0x5051a5),!0x0;}catch(_0x1d2255){return this['logger'][_0x38274f(0xeb)](_0x38274f(0x244)+_0x5051a5+':\x20'+_0x1d2255['message']),!0x1;}}[_0x289b92(0x3aa)](_0x1cc5ed,_0x19dc64,_0x19402c){const _0x631959=_0x289b92;return this[_0x631959(0x315)](_0x1cc5ed)['createQRCodeAndTransferTo'](_0x19dc64,_0x19402c);}['captureScreen'](_0xd9fda8,_0x62735b,_0x13317b){const _0xaff25a=_0x289b92;return this[_0xaff25a(0x315)](_0xd9fda8)['captureScreen'](_0x62735b,{'folderPath':_0x13317b});}['getBillImagePath'](_0x1d6c6f,_0xcc6318){return this['getBankService'](_0x1d6c6f)['getBillImagePath'](_0xcc6318);}['createBillFolder'](_0x464a6b,_0x1773c4){const _0xaa7d22=_0x289b92;return this[_0xaa7d22(0x315)](_0x464a6b)['createBillFolder'](_0x1773c4);}async[_0x289b92(0x351)](_0x335def,_0x343f19=0x2710,_0x5b7561=0x1f4){const _0x220b21=_0x289b92;if(!_0x335def)return this['logger']['warn']('Folder\x20path\x20is\x20null\x20or\x20empty'),null;const _0x3d427c=Date['now']();let _0x4390ea=0x0;for(this['logger']['debug']('Scanning\x20folder\x20for\x20bill\x20image:\x20'+_0x335def+_0x220b21(0x38f)+_0x343f19+'ms,\x20pollInterval:\x20'+_0x5b7561+'ms');Date[_0x220b21(0x1a2)]()-_0x3d427c<_0x343f19;){_0x4390ea++;try{if(!(0x0,_0x2cb99f[_0x220b21(0x22a)])(_0x335def)){await(0x0,_0x5e0ec7['sleep'])(_0x5b7561);continue;}const _0x54fd7b=await(0x0,_0x13ecf2['readdir'])(_0x335def);if(0x0===_0x54fd7b[_0x220b21(0x1fe)]){await(0x0,_0x5e0ec7[_0x220b21(0x26c)])(_0x5b7561);continue;}const _0x13a9d0=(await Promise['all'](_0x54fd7b['map'](async _0x4d6aa9=>{const _0x3bd772=_0x220b21;try{const _0x32968e=(0x0,_0x47fb22[_0x3bd772(0x3ed)])(_0x335def,_0x4d6aa9),_0x58cba4=await(0x0,_0x13ecf2[_0x3bd772(0x19f)])(_0x32968e);return{'fullPath':_0x32968e,'mtime':_0x58cba4['mtimeMs'],'size':_0x58cba4[_0x3bd772(0x3c2)]};}catch(_0x5b491e){return null;}})))['filter'](_0x2124c7=>null!==_0x2124c7&&_0x2124c7['size']>0x0);if(0x0===_0x13a9d0['length']){await(0x0,_0x5e0ec7['sleep'])(_0x5b7561);continue;}_0x13a9d0['sort']((_0x2a2ea8,_0x5a809a)=>_0x5a809a['mtime']-_0x2a2ea8[_0x220b21(0x24e)]);const _0x11428d=_0x13a9d0[0x0]['fullPath'],_0x34e892=Date['now']()-_0x3d427c;return this['logger']['log'](_0x220b21(0x28b)+_0x11428d+'\x20after\x20'+_0x34e892+'ms\x20('+_0x4390ea+'\x20attempts)'),_0x11428d;}catch(_0x1eaa73){this['logger']['debug']('Error\x20scanning\x20folder\x20'+_0x335def+'\x20(attempt\x20'+_0x4390ea+'):\x20'+_0x1eaa73['message']+_0x220b21(0x338)),await(0x0,_0x5e0ec7[_0x220b21(0x26c)])(_0x5b7561);}}const _0x7f4633=Date[_0x220b21(0x1a2)]()-_0x3d427c;return this['logger'][_0x220b21(0x1eb)]('Timeout\x20scanning\x20folder\x20for\x20bill\x20image:\x20'+_0x335def+'\x20after\x20'+_0x7f4633+'ms\x20('+_0x4390ea+_0x220b21(0x1da)),null;}};_0x2c9637['BankService']=_0x488c34,_0x2c9637['BankService']=_0x488c34=_0xafdf53([(0x0,_0x32a665['Injectable'])(),_0x202701('design:paramtypes',['function'==typeof(_0x4292db=void 0x0!==_0x15def2['AcbService']&&_0x15def2[_0x289b92(0x3d3)])?_0x4292db:Object,_0x289b92(0x18d)==typeof(_0x4e4543=void 0x0!==_0x4d1bd7[_0x289b92(0x155)]&&_0x4d1bd7['PgService'])?_0x4e4543:Object,'function'==typeof(_0x43d293=void 0x0!==_0x49fee6['HdBankService']&&_0x49fee6['HdBankService'])?_0x43d293:Object,_0x289b92(0x18d)==typeof(_0x8a0828=void 0x0!==_0x28ea58['VietcombankService']&&_0x28ea58['VietcombankService'])?_0x8a0828:Object,_0x289b92(0x18d)==typeof(_0x21ca84=void 0x0!==_0x22c8cf['DeviceService']&&_0x22c8cf['DeviceService'])?_0x21ca84:Object,_0x289b92(0x18d)==typeof(_0x5cf261=void 0x0!==_0x72fbbd['SessionManagementService']&&_0x72fbbd['SessionManagementService'])?_0x5cf261:Object,_0x289b92(0x18d)==typeof(_0x16994a=void 0x0!==_0x33f418[_0x289b92(0x38e)]&&_0x33f418['DeviceLockService'])?_0x16994a:Object,_0x289b92(0x18d)==typeof(_0x267f0e=void 0x0!==_0x30f609[_0x289b92(0x321)]&&_0x30f609['TelegramService'])?_0x267f0e:Object])],_0x488c34);},function(_0x36cce4,_0x2a25f,_0x5030c4){const _0xd1566e=a0_0x2e92;var _0x4e8890,_0x51f13a,_0x38dd0f,_0x451283,_0x2b306e=this&&this[_0xd1566e(0x21f)]||function(_0x3814bf,_0x182aff,_0x241837,_0x2e180f){const _0xc6c65c=_0xd1566e;var _0xd4a61,_0x2bd77a=arguments['length'],_0x266f58=_0x2bd77a<0x3?_0x182aff:null===_0x2e180f?_0x2e180f=Object['getOwnPropertyDescriptor'](_0x182aff,_0x241837):_0x2e180f;if(_0xc6c65c(0x141)==typeof Reflect&&'function'==typeof Reflect[_0xc6c65c(0x3b0)])_0x266f58=Reflect['decorate'](_0x3814bf,_0x182aff,_0x241837,_0x2e180f);else{for(var _0x373f90=_0x3814bf[_0xc6c65c(0x1fe)]-0x1;_0x373f90>=0x0;_0x373f90--)(_0xd4a61=_0x3814bf[_0x373f90])&&(_0x266f58=(_0x2bd77a<0x3?_0xd4a61(_0x266f58):_0x2bd77a>0x3?_0xd4a61(_0x182aff,_0x241837,_0x266f58):_0xd4a61(_0x182aff,_0x241837))||_0x266f58);}return _0x2bd77a>0x3&&_0x266f58&&Object['defineProperty'](_0x182aff,_0x241837,_0x266f58),_0x266f58;},_0x3572e5=this&&this['__metadata']||function(_0x289101,_0x25919e){const _0xf60e91=_0xd1566e;if('object'==typeof Reflect&&_0xf60e91(0x18d)==typeof Reflect['metadata'])return Reflect[_0xf60e91(0x3ac)](_0x289101,_0x25919e);},_0x357133=this&&this['__param']||function(_0x1b79fd,_0x568423){return function(_0x18bf8d,_0x23c48d){_0x568423(_0x18bf8d,_0x23c48d,_0x1b79fd);};};Object['defineProperty'](_0x2a25f,'__esModule',{'value':!0x0}),_0x2a25f['AcbService']=void 0x0;const _0x4ca508=_0x5030c4(0x2),_0x42caa6=_0x5030c4(0xd),_0xdaa3e9=_0x5030c4(0xe),_0x209b06=_0x5030c4(0x17),_0x46c262=_0x5030c4(0x13),_0x46c998=_0x5030c4(0x18),_0x2f9255=_0x5030c4(0x26),_0x39bae0=_0x5030c4(0x27),_0x51f6a9=_0x5030c4(0x1b),_0x166516=_0x5030c4(0x1e);let _0x1d488b=class extends _0x209b06[_0xd1566e(0x271)]{constructor(_0x1d01f6,_0x54d8b5,_0x3e0c8d,_0x37ca3d){const _0x408fd8=_0xd1566e;super(_0x1d01f6,_0x54d8b5,_0x3e0c8d,_0x37ca3d),this[_0x408fd8(0x2e6)]=_0x1d01f6,this['BANK_CODE']='ACB',this['BUNDLE_ID']=_0x408fd8(0x373);}['launchApp'](_0x270f95){const _0x246285=_0xd1566e;throw new Error(_0x246285(0x354));}async['captureScreen'](_0x5d247f,_0xf9e98){}async['clickPasswordField'](_0x57a4a0){const _0x39eebd=_0xd1566e;try{const {x:_0x10a39d,y:_0x536c76}=_0x39bae0[_0x39eebd(0x15a)]['PASSWORD_FIELD'];this[_0x39eebd(0x1fd)]['log']('Clicking\x20password\x20field\x20on\x20device\x20'+_0x57a4a0+'\x20at\x20coordinates\x20('+_0x10a39d+',\x20'+_0x536c76+')'),await this[_0x39eebd(0x1c8)](_0x57a4a0,_0x10a39d,_0x536c76,0.2),await(0x0,_0x46c998['sleep'])(0x3e8),this[_0x39eebd(0x1fd)]['log'](_0x39eebd(0x18b)+_0x57a4a0);}catch(_0x2a1db8){throw this['logger']['error']('Error\x20clicking\x20password\x20field\x20on\x20device\x20'+_0x57a4a0+':\x20'+_0x2a1db8['message']),_0x2a1db8;}}async['inputPasswordFromConfig'](_0x53f1a){const _0x2c42de=_0xd1566e;try{const _0x2a5a82=await this['deviceService']['getDeviceConfig'](_0x53f1a);if(!_0x2a5a82||!_0x2a5a82['password'])throw new Error('Password\x20not\x20configured\x20for\x20device\x20'+_0x53f1a);await this['wsService']['inputText'](_0x53f1a,_0x2a5a82[_0x2c42de(0xda)]);}catch(_0x59cfa9){throw this['logger']['error']('Error\x20inputting\x20password\x20from\x20config\x20for\x20device\x20'+_0x53f1a+':\x20'+_0x59cfa9['message']),_0x59cfa9;}}async[_0xd1566e(0x26b)](_0x977e5d){const _0x163fd4=_0xd1566e;try{const {x:_0x4e94cd,y:_0x6c70aa}=_0x39bae0['ACB_UI_COORDINATES']['LOGIN_BUTTON'];this['logger']['log']('Clicking\x20login\x20button\x20on\x20device\x20'+_0x977e5d+'\x20at\x20coordinates\x20('+_0x4e94cd+',\x20'+_0x6c70aa+')'),await this['wsService']['click'](_0x977e5d,_0x4e94cd,_0x6c70aa,0.2),await(0x0,_0x46c998['sleep'])(0x1388),this['logger']['log']('Login\x20button\x20clicked\x20successfully\x20on\x20device\x20'+_0x977e5d);}catch(_0x1806a2){throw this['logger'][_0x163fd4(0xeb)]('Error\x20clicking\x20login\x20button\x20on\x20device\x20'+_0x977e5d+':\x20'+_0x1806a2['message']),_0x1806a2;}}async['login'](_0xe78204){const _0x362df3=_0xd1566e;try{await this['killApp'](_0xe78204),await this['launchApp'](_0xe78204);const {x:_0x54d8b3,y:_0x1e7d52}=_0x39bae0['ACB_UI_COORDINATES']['LOGIN_BUTTON'];this['logger']['log']('Clicking\x20login\x20button\x20on\x20device\x20'+_0xe78204+_0x362df3(0x288)+_0x54d8b3+',\x20'+_0x1e7d52+')'),await this['wsService']['click'](_0xe78204,_0x54d8b3,_0x1e7d52,0.2),await(0x0,_0x46c998['sleep'])(0x7d0),await this['inputPasswordFromConfig'](_0xe78204),await(0x0,_0x46c998[_0x362df3(0x26c)])(0x7d0);const {x:_0x44a3cf,y:_0x4a7607}=_0x2f9255['COMMON_COORDINATES']['RETURN_KEY'];this['logger'][_0x362df3(0x2d5)]('Clicking\x20return\x20key\x20on\x20device\x20'+_0xe78204+_0x362df3(0x288)+_0x44a3cf+',\x20'+_0x4a7607+')'),await this['wsService'][_0x362df3(0x287)](_0xe78204,_0x44a3cf,_0x4a7607,0.2),await(0x0,_0x46c998['sleep'])(0x7d0),await this['wsService']['click'](_0xe78204,0.5,0.62,0.2),await(0x0,_0x46c998['sleep'])(0x1388),await this['wsService'][_0x362df3(0x287)](_0xe78204,0.3,0.55,0.2),await this[_0x362df3(0x2e6)][_0x362df3(0x287)](_0xe78204,0.5,0.65,0.2);}catch(_0x47cf2a){throw this['logger']['error']('Error\x20logging\x20in\x20on\x20device\x20'+_0xe78204+':\x20'+_0x47cf2a[_0x362df3(0x2a0)]),_0x47cf2a;}}async['executeTransfer'](_0x366246,_0x49a30f){}async['executeTransferWithQRCode'](_0x198558,_0x1af294){console['warn']('ACB\x20executeTransferWithQRCode');}async[_0xd1566e(0x342)](_0x37d695,_0x277b7b){return this['executeExternalTransfer'](_0x37d695,_0x277b7b);}async['executeExternalTransfer'](_0x263fa0,_0x225ba2){const _0x3025b5=_0xd1566e;console[_0x3025b5(0x1eb)]('ACB\x20executeExternalTransfer');}};_0x2a25f['AcbService']=_0x1d488b,_0x2a25f['AcbService']=_0x1d488b=_0x2b306e([(0x0,_0x4ca508['Injectable'])(),_0x357133(0x0,(0x0,_0x4ca508[_0xd1566e(0x33a)])(_0x42caa6['WEBSOCKET_SERVICE'])),_0x3572e5('design:paramtypes',['function'==typeof(_0x4e8890=void 0x0!==_0x46c262[_0xd1566e(0x258)]&&_0x46c262['IWebSocketService'])?_0x4e8890:Object,'function'==typeof(_0x51f13a=void 0x0!==_0xdaa3e9[_0xd1566e(0x204)]&&_0xdaa3e9['DeviceService'])?_0x51f13a:Object,'function'==typeof(_0x38dd0f=void 0x0!==_0x51f6a9['OCRService']&&_0x51f6a9['OCRService'])?_0x38dd0f:Object,_0xd1566e(0x18d)==typeof(_0x451283=void 0x0!==_0x166516['ImagePreprocessingService']&&_0x166516['ImagePreprocessingService'])?_0x451283:Object])],_0x1d488b);},(_0x385385,_0x56d19e)=>{const _0x491d84=a0_0x2e92;Object['defineProperty'](_0x56d19e,_0x491d84(0x110),{'value':!0x0}),_0x56d19e['WEBSOCKET_SERVICE']=void 0x0,_0x56d19e['WEBSOCKET_SERVICE']=Symbol(_0x491d84(0x311));},function(_0x4740d8,_0x448b46,_0x55d20d){const _0x2e4eac=a0_0x2e92;var _0x1ff5d5,_0x1835a6,_0x26f58e,_0x9e2a35,_0x2dbc72=this&&this[_0x2e4eac(0x21f)]||function(_0x4fcd7a,_0x55ec39,_0x30dfaf,_0x399097){const _0x4e1ecd=_0x2e4eac;var _0x59cbde,_0x18c36e=arguments['length'],_0x32255b=_0x18c36e<0x3?_0x55ec39:null===_0x399097?_0x399097=Object['getOwnPropertyDescriptor'](_0x55ec39,_0x30dfaf):_0x399097;if(_0x4e1ecd(0x141)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x32255b=Reflect['decorate'](_0x4fcd7a,_0x55ec39,_0x30dfaf,_0x399097);else{for(var _0x3852d2=_0x4fcd7a[_0x4e1ecd(0x1fe)]-0x1;_0x3852d2>=0x0;_0x3852d2--)(_0x59cbde=_0x4fcd7a[_0x3852d2])&&(_0x32255b=(_0x18c36e<0x3?_0x59cbde(_0x32255b):_0x18c36e>0x3?_0x59cbde(_0x55ec39,_0x30dfaf,_0x32255b):_0x59cbde(_0x55ec39,_0x30dfaf))||_0x32255b);}return _0x18c36e>0x3&&_0x32255b&&Object['defineProperty'](_0x55ec39,_0x30dfaf,_0x32255b),_0x32255b;},_0x1db772=this&&this['__metadata']||function(_0x1057d9,_0x5d2a8e){const _0x54be0c=_0x2e4eac;if(_0x54be0c(0x141)==typeof Reflect&&'function'==typeof Reflect[_0x54be0c(0x3ac)])return Reflect['metadata'](_0x1057d9,_0x5d2a8e);},_0x17b017=this&&this[_0x2e4eac(0x3e5)]||function(_0x4195bb,_0x2f05ef){return function(_0x4093e9,_0x26f859){_0x2f05ef(_0x4093e9,_0x26f859,_0x4195bb);};};Object['defineProperty'](_0x448b46,_0x2e4eac(0x110),{'value':!0x0}),_0x448b46['DeviceService']=void 0x0;const _0x2eb4bb=_0x55d20d(0x2),_0x22182e=_0x55d20d(0xf),_0x3e27bb=_0x55d20d(0x13),_0x387043=_0x55d20d(0xd),_0x23023d=_0x55d20d(0x14),_0xcb9974=_0x55d20d(0xb),_0x9efb43=_0x55d20d(0x16);let _0x13cc3b=class{constructor(_0x48d75b,_0x2d863f,_0x296e99,_0x358c99){const _0x502bd6=_0x2e4eac;this['redisService']=_0x48d75b,this['wsService']=_0x2d863f,this[_0x502bd6(0x3cf)]=_0x296e99,this['bankService']=_0x358c99,this['logger']=new _0x2eb4bb['Logger']('DeviceService'),this['REDIS_DEVICE_CONFIG_PREFIX']='device:',this['REDIS_DEVICE_CONFIG_SUFFIX']=_0x502bd6(0x174),this['REDIS_SERVICE_STATUS_KEY']=_0x502bd6(0x2c5);}async[_0x2e4eac(0x1d3)](){const _0x464c6c=_0x2e4eac;try{await this['setServiceStatus']('inactive'),this[_0x464c6c(0x1fd)]['log']('Service\x20status\x20initialized\x20to:\x20inactive');}catch(_0x1f9734){this['logger']['error']('Failed\x20to\x20initialize\x20service\x20status:\x20'+_0x1f9734['message']);}}async[_0x2e4eac(0x169)](){const _0x4acbeb=_0x2e4eac;try{const _0x4c6660=this['REDIS_DEVICE_CONFIG_PREFIX']+'*'+this['REDIS_DEVICE_CONFIG_SUFFIX'],_0x3970fe=await this['redisService']['keys'](_0x4c6660);return 0x0===_0x3970fe['length']?[]:(await Promise[_0x4acbeb(0x12a)](_0x3970fe['map'](async _0xe865c5=>{const _0x48ed50=_0x4acbeb;try{const _0x58e022=await this['redisService']['get'](_0xe865c5);return _0x58e022?JSON['parse'](_0x58e022):null;}catch(_0x265324){return this[_0x48ed50(0x1fd)]['error']('Error\x20parsing\x20config\x20for\x20key\x20'+_0xe865c5+':\x20'+_0x265324['message']),null;}})))['filter'](_0x47ba8b=>!(0x0,_0x9efb43['isNil'])(_0x47ba8b));}catch(_0xfcbe35){return this[_0x4acbeb(0x1fd)]['error']('Error\x20listing\x20device\x20configs:\x20'+_0xfcbe35['message']),[];}}async[_0x2e4eac(0x367)](){const _0x206ebb=_0x2e4eac;try{const _0x10b9fe=await this['wsService']['listDevices']();return await Promise[_0x206ebb(0x12a)](_0x10b9fe['map'](async _0x3267f9=>{const _0x1d5bfa=_0x206ebb,_0x5a4aa4=await this[_0x1d5bfa(0x2de)](_0x3267f9['udid']);return{..._0x3267f9,'bankCode':_0x5a4aa4?.['bankCode']||'','availableAmount':_0x5a4aa4?.['availableAmount']||0x0,'status':_0x5a4aa4?.['status']||_0x1d5bfa(0x20a),'password':_0x5a4aa4?.[_0x1d5bfa(0xda)]||'','smartOTP':_0x5a4aa4?.['smartOTP']||'','accountNo':_0x5a4aa4?.['accountNo']||'','accountName':_0x5a4aa4?.['accountName']||''};}));}catch(_0x517215){return this['logger']['error']('Error\x20listing\x20devices:\x20'+_0x517215['message']),[];}}async[_0x2e4eac(0x2de)](_0x42e8b5){const _0x1c400f=_0x2e4eac;try{const _0x970b54=''+this['REDIS_DEVICE_CONFIG_PREFIX']+_0x42e8b5+this[_0x1c400f(0x2c7)],_0x433ae3=await this['redisService']['get'](_0x970b54);return _0x433ae3?JSON['parse'](_0x433ae3):null;}catch(_0x1e0035){return this[_0x1c400f(0x1fd)]['error'](_0x1c400f(0x2f3)+_0x42e8b5+':\x20'+_0x1e0035['message']),null;}}async['getDeviceConfigSafe'](_0x25266b){const _0x3c629a=_0x2e4eac;try{const _0x2c7ec6=await this['getDeviceConfig'](_0x25266b);return _0x2c7ec6?{..._0x2c7ec6,'password':_0x2c7ec6['password']?'':void 0x0,'smartOTP':_0x2c7ec6[_0x3c629a(0x350)]?'':void 0x0}:null;}catch(_0x2844e6){return this['logger'][_0x3c629a(0xeb)]('Error\x20getting\x20safe\x20device\x20config\x20for\x20'+_0x25266b+':\x20'+_0x2844e6['message']),null;}}async['updateDeviceConfig'](_0x6b040d,_0x1b2e74){const _0x3a4e7b=_0x2e4eac;try{const _0x5d8d76=''+this['REDIS_DEVICE_CONFIG_PREFIX']+_0x6b040d+this[_0x3a4e7b(0x2c7)],_0x296330=await this[_0x3a4e7b(0x2de)](_0x6b040d),_0x2aa228=_0x296330?.[_0x3a4e7b(0xda)]||_0x296330?.['smartOTP'],_0x1e589c=_0x2aa228?_0x296330?.['password']||'':void 0x0!==_0x1b2e74['password']?_0x1b2e74['password']:'',_0xf64eaf=_0x2aa228?_0x296330?.['smartOTP']||'':void 0x0!==_0x1b2e74['smartOTP']?_0x1b2e74['smartOTP']:'',_0x3b47b1={'deviceId':_0x6b040d,'bankCode':void 0x0!==_0x1b2e74['bankCode']?_0x1b2e74[_0x3a4e7b(0x126)]:_0x296330?.['bankCode']||'','availableAmount':void 0x0!==_0x1b2e74['availableAmount']?_0x1b2e74['availableAmount']:_0x296330?.['availableAmount']||0x0,'status':void 0x0!==_0x1b2e74[_0x3a4e7b(0x1f3)]?_0x1b2e74['status']:_0x296330?.['status']||'deactive','password':_0x1e589c,'smartOTP':_0xf64eaf,'accountNo':void 0x0!==_0x1b2e74['accountNo']?_0x1b2e74['accountNo']:_0x296330?.['accountNo']||'','accountName':void 0x0!==_0x1b2e74['accountName']?_0x1b2e74['accountName']:_0x296330?.['accountName']||''};return await this['redisService']['set'](_0x5d8d76,JSON['stringify'](_0x3b47b1)),this['logger']['log']('['+_0x6b040d+']\x20Updated\x20device\x20config\x20(bankCode:\x20'+(_0x3b47b1['bankCode']||_0x3a4e7b(0x389))+'):\x20'+JSON['stringify']((0x0,_0x9efb43['omit'])(_0x3b47b1,['password','smartOTP']))),_0x3b47b1;}catch(_0x5f0c62){throw this['logger'][_0x3a4e7b(0xeb)]('['+_0x6b040d+']\x20Error\x20updating\x20device\x20config:\x20'+_0x5f0c62['message']),_0x5f0c62;}}async[_0x2e4eac(0x274)](_0x42add6){const _0x59ca2d=_0x2e4eac;try{const _0x58e8eb=''+this['REDIS_DEVICE_CONFIG_PREFIX']+_0x42add6+this['REDIS_DEVICE_CONFIG_SUFFIX'];await this[_0x59ca2d(0x1b2)][_0x59ca2d(0x17d)](_0x58e8eb),this['logger'][_0x59ca2d(0x2d5)]('['+_0x42add6+']\x20Deleted\x20device\x20config');}catch(_0x3596fa){throw this['logger']['error']('['+_0x42add6+']\x20Error\x20deleting\x20device\x20config:\x20'+_0x3596fa['message']),_0x3596fa;}}async['getServiceStatus'](){const _0xc8a676=_0x2e4eac;try{return await this['redisService'][_0xc8a676(0x113)](this['REDIS_SERVICE_STATUS_KEY'])||_0xc8a676(0x154);}catch(_0x10d6e5){return this['logger']['error']('Error\x20getting\x20service\x20status:\x20'+_0x10d6e5['message']),'inactive';}}async['setServiceStatus'](_0x473350){const _0x18f4bf=_0x2e4eac;try{await this['redisService']['set'](this[_0x18f4bf(0x12f)],_0x473350),this['logger'][_0x18f4bf(0x2d5)]('Service\x20status\x20set\x20to:\x20'+_0x473350);}catch(_0x3010b8){throw this[_0x18f4bf(0x1fd)]['error']('Error\x20setting\x20service\x20status:\x20'+_0x3010b8['message']),_0x3010b8;}}async['startService'](){const _0x467fcd=_0x2e4eac;try{if(!await this['hasActiveDevice']())throw new _0x2eb4bb['HttpException']({'success':!0x1,'error':'Vui\x20l√≤ng\x20active\x20bank\x20tr∆∞·ªõc\x20khi\x20start'},_0x2eb4bb[_0x467fcd(0x35f)][_0x467fcd(0x388)]);return this[_0x467fcd(0x2c1)]['loginAllActiveBanks']()[_0x467fcd(0x1ec)](_0x1a6bba=>{this['logger']['error']('Error\x20during\x20background\x20login\x20process:\x20'+_0x1a6bba['message']);}),await new Promise(_0x5c89fc=>setTimeout(_0x5c89fc,0x7d0)),await this['setServiceStatus']('active'),{'success':!0x0,'message':'Service\x20started\x20successfully.\x20Devices\x20are\x20logging\x20in\x20and\x20will\x20accept\x20jobs\x20when\x20ready.'};}catch(_0x3caa66){if(_0x3caa66 instanceof _0x2eb4bb['HttpException'])throw _0x3caa66;throw this['logger'][_0x467fcd(0xeb)]('Error\x20starting\x20service:\x20'+_0x3caa66[_0x467fcd(0x2a0)],_0x3caa66['stack']),new _0x2eb4bb['HttpException']({'success':!0x1,'error':_0x3caa66['message']||_0x467fcd(0x3b8)},_0x2eb4bb[_0x467fcd(0x35f)][_0x467fcd(0x374)]);}}async[_0x2e4eac(0x167)](_0x2964b8,_0x103c93){const _0x41ba6d=_0x2e4eac;try{const _0x1924e1=await this['getDeviceConfig'](_0x2964b8);if(!_0x1924e1)return!0x1;const _0x4410fc=_0x1924e1[_0x41ba6d(0x2b6)]-_0x103c93;return _0x4410fc<0x0?(this[_0x41ba6d(0x1fd)][_0x41ba6d(0x1eb)]('Insufficient\x20amount\x20for\x20device\x20'+_0x2964b8+_0x41ba6d(0x2e3)+_0x1924e1[_0x41ba6d(0x2b6)]+',\x20Requested:\x20'+_0x103c93),!0x1):(await this['updateDeviceConfig'](_0x2964b8,{'availableAmount':_0x4410fc}),!0x0);}catch(_0x2fb05c){return this[_0x41ba6d(0x1fd)]['error']('Error\x20deducting\x20amount\x20for\x20device\x20'+_0x2964b8+':\x20'+_0x2fb05c['message']),!0x1;}}async['hasActiveDevice'](){const _0x599fcd=_0x2e4eac;try{return(await this['listDevices']())['some'](_0x5e2017=>'active'===_0x5e2017['status']);}catch(_0x1b8c5e){return this['logger'][_0x599fcd(0xeb)]('Error\x20checking\x20active\x20devices:\x20'+_0x1b8c5e[_0x599fcd(0x2a0)]),!0x1;}}async['getAvailableDevices'](){const _0x32815a=_0x2e4eac;try{const _0x543b5e=await this['wsService']['listDevices'](),_0x533bab=[];for(const _0x279c7b of _0x543b5e){const _0x37a10b=await this['getDeviceConfig'](_0x279c7b['udid']);'active'===_0x37a10b?.['status']&&(await this[_0x32815a(0x3cf)]['isLocked'](_0x279c7b['udid'])||(await this['bankService']['isSessionValid'](_0x279c7b[_0x32815a(0x109)],_0x37a10b['bankCode'])?_0x533bab['push'](_0x37a10b):this[_0x32815a(0x1fd)][_0x32815a(0xeb)]('['+_0x279c7b[_0x32815a(0x109)]+_0x32815a(0xee)+_0x37a10b[_0x32815a(0x126)])));}return _0x533bab;}catch(_0x343de6){return this['logger']['error'](_0x32815a(0x395)+_0x343de6[_0x32815a(0x2a0)]),[];}}};_0x448b46[_0x2e4eac(0x204)]=_0x13cc3b,_0x448b46[_0x2e4eac(0x204)]=_0x13cc3b=_0x2dbc72([(0x0,_0x2eb4bb[_0x2e4eac(0x19b)])(),_0x17b017(0x1,(0x0,_0x2eb4bb['Inject'])(_0x387043['WEBSOCKET_SERVICE'])),_0x17b017(0x3,(0x0,_0x2eb4bb['Inject'])((0x0,_0x2eb4bb['forwardRef'])(()=>_0xcb9974[_0x2e4eac(0x261)]))),_0x1db772('design:paramtypes',['function'==typeof(_0x1ff5d5=void 0x0!==_0x22182e['RedisService']&&_0x22182e['RedisService'])?_0x1ff5d5:Object,_0x2e4eac(0x18d)==typeof(_0x1835a6=void 0x0!==_0x3e27bb[_0x2e4eac(0x258)]&&_0x3e27bb[_0x2e4eac(0x258)])?_0x1835a6:Object,'function'==typeof(_0x26f58e=void 0x0!==_0x23023d['DeviceLockService']&&_0x23023d['DeviceLockService'])?_0x26f58e:Object,'function'==typeof(_0x9e2a35=void 0x0!==_0xcb9974['BankService']&&_0xcb9974['BankService'])?_0x9e2a35:Object])],_0x13cc3b);},function(_0x233b6f,_0x55094c,_0x3f8b5b){const _0x13a2b5=a0_0x2e92;var _0x17046f=this&&this['__decorate']||function(_0xb4c659,_0x20ae22,_0x32c1e2,_0xe483ee){const _0x2404a5=a0_0x2e92;var _0x8a2321,_0x468bec=arguments['length'],_0x1f79c3=_0x468bec<0x3?_0x20ae22:null===_0xe483ee?_0xe483ee=Object['getOwnPropertyDescriptor'](_0x20ae22,_0x32c1e2):_0xe483ee;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x1f79c3=Reflect[_0x2404a5(0x3b0)](_0xb4c659,_0x20ae22,_0x32c1e2,_0xe483ee);else{for(var _0x116095=_0xb4c659['length']-0x1;_0x116095>=0x0;_0x116095--)(_0x8a2321=_0xb4c659[_0x116095])&&(_0x1f79c3=(_0x468bec<0x3?_0x8a2321(_0x1f79c3):_0x468bec>0x3?_0x8a2321(_0x20ae22,_0x32c1e2,_0x1f79c3):_0x8a2321(_0x20ae22,_0x32c1e2))||_0x1f79c3);}return _0x468bec>0x3&&_0x1f79c3&&Object[_0x2404a5(0x3cc)](_0x20ae22,_0x32c1e2,_0x1f79c3),_0x1f79c3;},_0x42ea7d=this&&this['__metadata']||function(_0x564b30,_0x5ae892){const _0x7a1650=a0_0x2e92;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x7a1650(0x3ac)])return Reflect[_0x7a1650(0x3ac)](_0x564b30,_0x5ae892);};Object['defineProperty'](_0x55094c,'__esModule',{'value':!0x0}),_0x55094c[_0x13a2b5(0x124)]=void 0x0;const _0x515452=_0x3f8b5b(0x2),_0x215868=_0x3f8b5b(0x10),_0x315abc=_0x3f8b5b(0x11);let _0x43a19f=class{constructor(){this['logger']=new _0x515452['Logger']('RedisService'),this['redisClient']=null;}async['getClient'](){const _0x349ce0=_0x13a2b5;if(this['redisClient'])return this['redisClient'];const _0xc049ef=_0x315abc['config']['redis'][_0x349ce0(0x3e6)]??_0x349ce0(0x3bb),_0x4c8c7f=_0x315abc['config'][_0x349ce0(0x229)]['port']??0x18eb,_0x5229e7=_0x315abc['config']['redis']['password']??void 0x0,_0x2b6e41=_0x315abc[_0x349ce0(0x302)][_0x349ce0(0x229)]['db']??0x3;return this[_0x349ce0(0x216)]=new _0x215868['default']({'host':_0xc049ef,'port':_0x4c8c7f,'password':_0x5229e7,'db':_0x2b6e41,'enableReadyCheck':!0x1,'maxRetriesPerRequest':null,'lazyConnect':!0x0}),this['redisClient']['on'](_0x349ce0(0xeb),_0x367e10=>{const _0x33f70e=_0x349ce0;this['logger'][_0x33f70e(0xeb)]('Redis\x20Client\x20Error',_0x367e10['stack']||_0x367e10['message']);}),this['redisClient']['on'](_0x349ce0(0x32f),()=>{this['logger']['log']('Redis\x20Client\x20Connected');}),this[_0x349ce0(0x216)]['on']('ready',()=>{this['logger']['log']('Redis\x20Client\x20Ready');}),this['redisClient']['on']('close',()=>{this['logger']['warn']('Redis\x20Client\x20Connection\x20Closed');}),this[_0x349ce0(0x216)]['on'](_0x349ce0(0x3e9),()=>{const _0x50c4c4=_0x349ce0;this['logger']['log'](_0x50c4c4(0x226));}),await this['redisClient'][_0x349ce0(0x32f)](),this['redisClient'];}async['disconnect'](){const _0x3bcbda=_0x13a2b5;this['redisClient']&&(await this['redisClient']['disconnect'](),this['redisClient']=null,this['logger']['log'](_0x3bcbda(0x21d)));}async['onModuleDestroy'](){await this['disconnect']();}async['get'](_0x4b9fc8){return(await this['getClient']())['get'](_0x4b9fc8);}async['set'](_0x13016d,_0x2e7a35,_0x1ef660){const _0x47a484=_0x13a2b5,_0x2adaa5=await this[_0x47a484(0x3e4)]();if(_0x1ef660){const _0x4680d4=Math['ceil'](_0x1ef660/0x3e8);return _0x2adaa5[_0x47a484(0x3e2)](_0x13016d,_0x4680d4,_0x2e7a35);}return _0x2adaa5['set'](_0x13016d,_0x2e7a35);}async['setex'](_0x3542c6,_0x77aab,_0x4570c3){const _0x213856=await this['getClient'](),_0x490160=Math['ceil'](_0x77aab/0x3e8);return _0x213856['setex'](_0x3542c6,_0x490160,_0x4570c3);}async[_0x13a2b5(0x17d)](_0x2057b1){return(await this['getClient']())['del'](_0x2057b1);}async['exists'](_0x4cb1b5){const _0x55c883=_0x13a2b5;return(await this['getClient']())[_0x55c883(0x217)](_0x4cb1b5);}async['zadd'](_0xa59d8,_0x23423e,_0x58c714){const _0xeea017=_0x13a2b5;return(await this['getClient']())[_0xeea017(0x23c)](_0xa59d8,_0x23423e,_0x58c714);}async[_0x13a2b5(0x101)](_0x5b582d,_0x1707fe,_0x38d1e7){const _0x39d8f6=_0x13a2b5;return(await this[_0x39d8f6(0x3e4)]())['zrange'](_0x5b582d,_0x1707fe,_0x38d1e7);}async['zrangebyscore'](_0x2b2cdd,_0x1ae52f,_0x2ab20e,_0x2a1c5b){const _0x24eac0=_0x13a2b5,_0x12c555=await this['getClient']();return _0x2a1c5b?_0x12c555[_0x24eac0(0x205)](_0x2b2cdd,_0x1ae52f,_0x2ab20e,_0x24eac0(0x22e),_0x2a1c5b['offset'],_0x2a1c5b['count']):_0x12c555['zrangebyscore'](_0x2b2cdd,_0x1ae52f,_0x2ab20e);}async[_0x13a2b5(0x318)](_0x304512,..._0x23c123){const _0x5c4cbe=_0x13a2b5;return(await this['getClient']())[_0x5c4cbe(0x318)](_0x304512,..._0x23c123);}async['sadd'](_0x3a79b2,..._0x1042f1){return(await this['getClient']())['sadd'](_0x3a79b2,..._0x1042f1);}async['sismember'](_0xef9143,_0x5441a5){const _0x4b5762=_0x13a2b5;return(await this[_0x4b5762(0x3e4)]())[_0x4b5762(0x36d)](_0xef9143,_0x5441a5);}async['hset'](_0x490180,_0x5d41f6,_0x26c446){return(await this['getClient']())['hset'](_0x490180,_0x5d41f6,_0x26c446);}async['hget'](_0x6eea15,_0x4cde1f){return(await this['getClient']())['hget'](_0x6eea15,_0x4cde1f);}async[_0x13a2b5(0x1f6)](_0x194b64){return(await this['getClient']())['hgetall'](_0x194b64);}async[_0x13a2b5(0x1f0)](_0x4e8688,_0x10e978){return(await this['getClient']())['expire'](_0x4e8688,_0x10e978);}async['keys'](_0x3dfe6e){const _0x55c14b=await this['getClient'](),_0x4338c9=[];let _0x5ce08b='0';do{const _0x3d97ff=await _0x55c14b['scan'](_0x5ce08b,'MATCH',_0x3dfe6e,'COUNT',0x64);_0x5ce08b=_0x3d97ff[0x0],_0x4338c9['push'](..._0x3d97ff[0x1]);}while('0'!==_0x5ce08b);return _0x4338c9;}async['setnx'](_0x5dbf83,_0x7332b8,_0x5ab416){const _0x198c78=_0x13a2b5,_0xe1c75a=await this['getClient']();if(_0x5ab416){const _0x4f4de0=Math['ceil'](_0x5ab416/0x3e8);return await _0xe1c75a['set'](_0x5dbf83,_0x7332b8,'EX',_0x4f4de0,'NX');}return await _0xe1c75a[_0x198c78(0x1c0)](_0x5dbf83,_0x7332b8,'NX');}async[_0x13a2b5(0x304)](_0x45b9b6,_0x1a77bb=0x1){const _0x5545ad=_0x13a2b5,_0x2f87d3=await this['getClient'](),_0xc82754=await _0x2f87d3[_0x5545ad(0x101)](_0x45b9b6,0x0,_0x1a77bb-0x1,'WITHSCORES');if(!_0xc82754||0x0===_0xc82754['length'])return[];const _0x2e4fd7=[];for(let _0x5d107c=0x0;_0x5d107c<_0xc82754[_0x5545ad(0x1fe)];_0x5d107c+=0x2)_0x2e4fd7['push']({'jobId':_0xc82754[_0x5d107c],'score':_0xc82754[_0x5d107c+0x1]});return _0x2e4fd7;}};_0x55094c[_0x13a2b5(0x124)]=_0x43a19f,_0x55094c['RedisService']=_0x43a19f=_0x17046f([(0x0,_0x515452[_0x13a2b5(0x19b)])(),_0x42ea7d('design:paramtypes',[])],_0x43a19f);},_0x565602=>{const _0x6a9ffd=a0_0x2e92;_0x565602[_0x6a9ffd(0x29f)]=require('ioredis');},(_0x3d93f1,_0x5acdf2,_0x43cbaf)=>{const _0xb22245=a0_0x2e92;Object[_0xb22245(0x3cc)](_0x5acdf2,_0xb22245(0x110),{'value':!0x0}),_0x5acdf2['config']=void 0x0;const _0x64ee15=_0x43cbaf(0x12),_0x4d4e1c=_0x43cbaf(0x4);(0x0,_0x64ee15['config'])({'path':(0x0,_0x4d4e1c[_0xb22245(0x3ed)])(process[_0xb22245(0x25a)](),_0xb22245(0x324))}),_0x5acdf2['config']={'NODE_ENV':process['env']['NODE_ENV']||'production','boxType':'PANDA','redis':{'host':process[_0xb22245(0x393)][_0xb22245(0x284)]??'14.225.44.234','port':parseInt(process[_0xb22245(0x393)]['REDIS_PORT']??_0xb22245(0x334)),'db':0x3,'password':process['env']['REDIS_PWD']??'Dcsvnqvmn1'},'ezpayBe':{'apiUrl':process['env'][_0xb22245(0x17c)]??'https://api-hn.botpro.world/payment','apiKey':process['env']['EZZPAY_KEY']??_0xb22245(0x20e)},'ocr':{'poolSize':parseInt(process['env']['OCR_POOL_SIZE']||'4',0xa),'lang':process[_0xb22245(0x393)]['OCR_LANG']||_0xb22245(0x1e0),'rois':{'singleLine':{'crop':{'x':parseFloat(process['env'][_0xb22245(0x3a4)]||'0'),'y':parseFloat(process[_0xb22245(0x393)]['OCR_ROI_SINGLE_Y']||'0'),'width':parseFloat(process['env']['OCR_ROI_SINGLE_WIDTH']||'1'),'height':parseFloat(process['env']['OCR_ROI_SINGLE_HEIGHT']||'1')},'psm':parseInt(process[_0xb22245(0x393)][_0xb22245(0x307)]||'7',0xa),'charWhitelist':process[_0xb22245(0x393)]['OCR_WHITELIST_SINGLE']||'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\x20.-','maxWidth':parseInt(process[_0xb22245(0x393)]['OCR_MAX_WIDTH_SINGLE']||'800',0xa)},'block':{'crop':{'x':parseFloat(process['env']['OCR_ROI_BLOCK_X']||'0'),'y':parseFloat(process['env']['OCR_ROI_BLOCK_Y']||'0'),'width':parseFloat(process['env'][_0xb22245(0x384)]||'1'),'height':parseFloat(process['env']['OCR_ROI_BLOCK_HEIGHT']||'1')},'psm':parseInt(process['env']['OCR_PSM_BLOCK']||'6',0xa),'charWhitelist':process[_0xb22245(0x393)][_0xb22245(0x2d9)]||void 0x0,'maxWidth':parseInt(process['env']['OCR_MAX_WIDTH_BLOCK']||'1200',0xa)},'full':{'crop':{'x':0x0,'y':0x0,'width':0x1,'height':0x1},'psm':parseInt(process['env']['OCR_PSM_FULL']||'6',0xa),'charWhitelist':void 0x0,'maxWidth':parseInt(process[_0xb22245(0x393)][_0xb22245(0x2a3)]||_0xb22245(0x194),0xa)}}},'spaceocr':{'datacenterPrimary':_0xb22245(0x213),'datacenterSecond':'https://apipro2.ocr.space/parse/image','key':'G888CWKP2Y06X','keyFree':_0xb22245(0x2fd)}};},_0x15aab4=>{_0x15aab4['exports']=require('dotenv');},(_0x5c5749,_0xd06de2)=>{const _0x1960fa=a0_0x2e92;Object[_0x1960fa(0x3cc)](_0xd06de2,'__esModule',{'value':!0x0});},function(_0x43117d,_0x52b932,_0x32d19d){const _0x4ec9b4=a0_0x2e92;var _0x3a71f6,_0x2463aa=this&&this['__decorate']||function(_0x867cf2,_0x4b0220,_0x5a051f,_0x2cdbc8){const _0x247748=a0_0x2e92;var _0x454f71,_0x416b37=arguments['length'],_0xfb985b=_0x416b37<0x3?_0x4b0220:null===_0x2cdbc8?_0x2cdbc8=Object['getOwnPropertyDescriptor'](_0x4b0220,_0x5a051f):_0x2cdbc8;if('object'==typeof Reflect&&_0x247748(0x18d)==typeof Reflect['decorate'])_0xfb985b=Reflect['decorate'](_0x867cf2,_0x4b0220,_0x5a051f,_0x2cdbc8);else{for(var _0x22e3bb=_0x867cf2['length']-0x1;_0x22e3bb>=0x0;_0x22e3bb--)(_0x454f71=_0x867cf2[_0x22e3bb])&&(_0xfb985b=(_0x416b37<0x3?_0x454f71(_0xfb985b):_0x416b37>0x3?_0x454f71(_0x4b0220,_0x5a051f,_0xfb985b):_0x454f71(_0x4b0220,_0x5a051f))||_0xfb985b);}return _0x416b37>0x3&&_0xfb985b&&Object['defineProperty'](_0x4b0220,_0x5a051f,_0xfb985b),_0xfb985b;},_0x1ef384=this&&this['__metadata']||function(_0x37d24c,_0x43ebd3){const _0x435446=a0_0x2e92;if(_0x435446(0x141)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x37d24c,_0x43ebd3);};Object[_0x4ec9b4(0x3cc)](_0x52b932,_0x4ec9b4(0x110),{'value':!0x0}),_0x52b932['DeviceLockService']=void 0x0;const _0x4cb99c=_0x32d19d(0x2),_0x2eb498=_0x32d19d(0xf),_0x7ab453=_0x32d19d(0x15);let _0x28c73c=class{constructor(_0x262550){const _0x14e9eb=_0x4ec9b4;this['redisService']=_0x262550,this[_0x14e9eb(0x1fd)]=new _0x4cb99c[(_0x14e9eb(0x225))](_0x14e9eb(0x38e)),this['REDIS_LOCK_PREFIX']='device:lock:',this['DEFAULT_LOCK_TTL']=0x927c0;}async[_0x4ec9b4(0x176)](_0x167d43,_0x410505,_0x6aacb4,_0x137200=this[_0x4ec9b4(0x295)]){const _0x500547=_0x4ec9b4;try{const _0x239269=''+this['REDIS_LOCK_PREFIX']+_0x167d43,_0x25f239=''+this[_0x500547(0x2cb)]+_0x167d43+':meta',_0x3d5dd3=(0x0,_0x7ab453['randomUUID'])(),_0x3ab1e3=Math['ceil'](_0x137200/0x3e8),_0x25bf24=await this[_0x500547(0x1b2)]['getClient']();if('OK'===await _0x25bf24[_0x500547(0x1c0)](_0x239269,_0x3d5dd3,'EX',_0x3ab1e3,'NX')){const _0x59f114={'deviceId':_0x167d43,'lockType':_0x410505,'lockedAt':Date['now'](),'lockedBy':_0x6aacb4,'ttl':_0x137200};return await this[_0x500547(0x1b2)][_0x500547(0x3e2)](_0x25f239,_0x3ab1e3,JSON['stringify'](_0x59f114)),this['logger']['log']('['+_0x167d43+_0x500547(0x30f)+_0x410505+'\x20lock\x20('+_0x6aacb4+')\x20with\x20lockId\x20'+_0x3d5dd3),!0x0;}return this['logger'][_0x500547(0x1eb)]('['+_0x167d43+_0x500547(0x1c6)),!0x1;}catch(_0x271dca){return this['logger']['error']('['+_0x167d43+_0x500547(0x1ef)+_0x271dca['message']),!0x1;}}async['releaseLock'](_0x81cc8c){const _0x4b2189=_0x4ec9b4;try{const _0x576035=''+this[_0x4b2189(0x2cb)]+_0x81cc8c,_0x2ce676=''+this['REDIS_LOCK_PREFIX']+_0x81cc8c+':meta',_0x38c54b=await this[_0x4b2189(0x1b2)]['getClient'](),_0x511f86=await _0x38c54b[_0x4b2189(0x113)](_0x576035);if(!_0x511f86)return await this['redisService']['del'](_0x2ce676),void this[_0x4b2189(0x1fd)]['debug']('['+_0x81cc8c+']\x20Device\x20is\x20not\x20locked,\x20nothing\x20to\x20release');0x1===await _0x38c54b['eval'](_0x4b2189(0x3d4),0x2,_0x576035,_0x2ce676,_0x511f86)?this['logger']['log']('['+_0x81cc8c+']\x20Released\x20lock\x20(lockId:\x20'+_0x511f86+')'):this['logger']['warn']('['+_0x81cc8c+']\x20Lock\x20was\x20already\x20released\x20or\x20changed\x20(expected\x20lockId:\x20'+_0x511f86+')');}catch(_0x2182a8){this['logger']['error']('['+_0x81cc8c+']\x20Error\x20releasing\x20lock:\x20'+_0x2182a8['message'],_0x2182a8[_0x4b2189(0x3d6)]);}}async[_0x4ec9b4(0x329)](_0x5ee1a1){const _0x234b62=_0x4ec9b4;try{const _0x5f4ef2=''+this[_0x234b62(0x2cb)]+_0x5ee1a1,_0x5bcbf2=await this['redisService']['get'](_0x5f4ef2);if(!_0x5bcbf2)return null;const _0x4d24e3=''+this['REDIS_LOCK_PREFIX']+_0x5ee1a1+_0x234b62(0x2d0),_0x48be73=await this['redisService']['get'](_0x4d24e3);return _0x48be73?{...JSON['parse'](_0x48be73),'lockId':_0x5bcbf2}:{'deviceId':_0x5ee1a1,'lockType':'transfer','lockedAt':Date[_0x234b62(0x1a2)](),'lockedBy':_0x234b62(0x148),'ttl':this['DEFAULT_LOCK_TTL'],'lockId':_0x5bcbf2};}catch(_0x2bc96b){return this[_0x234b62(0x1fd)]['error']('['+_0x5ee1a1+_0x234b62(0x139)+_0x2bc96b['message']),null;}}async['isLocked'](_0xf5b135,_0x261250){const _0x58c2ff=_0x4ec9b4;try{const _0x8a73a6=''+this['REDIS_LOCK_PREFIX']+_0xf5b135;if(!await this['redisService']['exists'](_0x8a73a6))return!0x1;const _0x40fd9a=await this[_0x58c2ff(0x329)](_0xf5b135);return!(!_0x40fd9a||_0x261250&&_0x40fd9a['lockType']===_0x261250);}catch(_0x4d4e1f){return this['logger']['error']('['+_0xf5b135+']\x20Error\x20checking\x20lock\x20status:\x20'+_0x4d4e1f['message']),!0x1;}}async[_0x4ec9b4(0x2a2)](_0x175207,_0x1df867){const _0x67dda5=_0x4ec9b4;try{if(!await this['getLock'](_0x175207))return!0x1;const _0x2dac84=''+this['REDIS_LOCK_PREFIX']+_0x175207,_0xd88489=''+this['REDIS_LOCK_PREFIX']+_0x175207+_0x67dda5(0x2d0),_0x42ab8a=await this[_0x67dda5(0x1b2)]['getClient'](),_0x2767f3=await _0x42ab8a['ttl'](_0x2dac84);if(_0x2767f3<=0x0)return!0x1;const _0x128005=Math['ceil']((0x3e8*_0x2767f3+_0x1df867)/0x3e8);return 0x1===await _0x42ab8a['expire'](_0x2dac84,_0x128005)&&(await this['redisService'][_0x67dda5(0x1f0)](_0xd88489,_0x128005),this['logger']['log']('['+_0x175207+']\x20Extended\x20lock\x20by\x20'+_0x1df867+'ms'),!0x0);}catch(_0x306cef){return this[_0x67dda5(0x1fd)]['error']('['+_0x175207+']\x20Error\x20extending\x20lock:\x20'+_0x306cef['message']),!0x1;}}async[_0x4ec9b4(0x168)](_0xcf1c2c,_0x42d126){const _0x3b0581=_0x4ec9b4;try{const _0x3fbf26=await this['getLock'](_0xcf1c2c);if(!_0x3fbf26)return!0x1;if(_0x3fbf26[_0x3b0581(0x102)]!==_0x42d126)return!0x1;const _0x49b1ac=''+this['REDIS_LOCK_PREFIX']+_0xcf1c2c,_0xcb95b4=''+this['REDIS_LOCK_PREFIX']+_0xcf1c2c+':meta';return await this['redisService']['del'](_0x49b1ac),await this[_0x3b0581(0x1b2)]['del'](_0xcb95b4),this['logger'][_0x3b0581(0x2d5)]('['+_0xcf1c2c+']\x20Force\x20released\x20'+_0x42d126+_0x3b0581(0x327)),!0x0;}catch(_0x2bda75){return this['logger']['error']('['+_0xcf1c2c+']\x20Error\x20releasing\x20'+_0x42d126+'\x20lock:\x20'+_0x2bda75['message']),!0x1;}}async[_0x4ec9b4(0x322)](){const _0x3dfb1d=_0x4ec9b4;try{const _0xedbaa7=this[_0x3dfb1d(0x2cb)]+'*';return(await this[_0x3dfb1d(0x1b2)]['keys'](_0xedbaa7))['filter'](_0x2f4554=>!_0x2f4554['endsWith'](':meta'))['length'];}catch(_0x2e5f3d){return this[_0x3dfb1d(0x1fd)]['error']('Error\x20getting\x20all\x20lock\x20keys:\x20'+_0x2e5f3d[_0x3dfb1d(0x2a0)]),0x0;}}};_0x52b932['DeviceLockService']=_0x28c73c,_0x52b932['DeviceLockService']=_0x28c73c=_0x2463aa([(0x0,_0x4cb99c['Injectable'])(),_0x1ef384('design:paramtypes',['function'==typeof(_0x3a71f6=void 0x0!==_0x2eb498[_0x4ec9b4(0x124)]&&_0x2eb498['RedisService'])?_0x3a71f6:Object])],_0x28c73c);},_0x2b75e2=>{_0x2b75e2['exports']=require('crypto');},_0x1f7092=>{_0x1f7092['exports']=require('lodash');},function(_0x3e7ad6,_0x3f056f,_0x4485a2){const _0x16c016=a0_0x2e92;var _0x283458,_0xfab50b,_0x5a449,_0x1c3c25,_0x5e53ca,_0x2c2eba=this&&this['__decorate']||function(_0x2321c3,_0x5bdae0,_0x3b5c91,_0x87fe8f){const _0x5aba67=a0_0x2e92;var _0x3d0254,_0x245c80=arguments['length'],_0x5cf682=_0x245c80<0x3?_0x5bdae0:null===_0x87fe8f?_0x87fe8f=Object[_0x5aba67(0x25c)](_0x5bdae0,_0x3b5c91):_0x87fe8f;if(_0x5aba67(0x141)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x5cf682=Reflect[_0x5aba67(0x3b0)](_0x2321c3,_0x5bdae0,_0x3b5c91,_0x87fe8f);else{for(var _0x3721c7=_0x2321c3['length']-0x1;_0x3721c7>=0x0;_0x3721c7--)(_0x3d0254=_0x2321c3[_0x3721c7])&&(_0x5cf682=(_0x245c80<0x3?_0x3d0254(_0x5cf682):_0x245c80>0x3?_0x3d0254(_0x5bdae0,_0x3b5c91,_0x5cf682):_0x3d0254(_0x5bdae0,_0x3b5c91))||_0x5cf682);}return _0x245c80>0x3&&_0x5cf682&&Object['defineProperty'](_0x5bdae0,_0x3b5c91,_0x5cf682),_0x5cf682;},_0x2d4981=this&&this[_0x16c016(0x3c1)]||function(_0x26c80f,_0x2802bc){const _0x1b60c0=_0x16c016;if(_0x1b60c0(0x141)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x26c80f,_0x2802bc);},_0x29375b=this&&this[_0x16c016(0x3e5)]||function(_0x4ebbe7,_0x65517a){return function(_0x4312c9,_0x1a0078){_0x65517a(_0x4312c9,_0x1a0078,_0x4ebbe7);};};Object[_0x16c016(0x3cc)](_0x3f056f,_0x16c016(0x110),{'value':!0x0}),_0x3f056f['BaseBankService']=void 0x0;const _0x4a57c5=_0x4485a2(0x2),_0x3b5cf7=_0x4485a2(0xe),_0x1ea214=_0x4485a2(0x13),_0x322537=_0x4485a2(0xd),_0x250021=_0x4485a2(0x18),_0x1484dd=_0x4485a2(0x19),_0xaeef0c=_0x4485a2(0x1a),_0x46c716=_0x4485a2(0x4),_0x4dfeda=_0x4485a2(0x1b),_0x36f71f=_0x4485a2(0x1e),_0x23ab2d=_0x4485a2(0x21),_0x230403=_0x4485a2(0x22),_0x3c52b0=_0x4485a2(0x20);let _0x3c45bd=_0x283458=class{constructor(_0x186d43,_0x7d1986,_0x5d823f,_0x37b6a3){const _0x434eef=_0x16c016;this['wsService']=_0x186d43,this['deviceService']=_0x7d1986,this['ocrService']=_0x5d823f,this['imagePreprocessingService']=_0x37b6a3,this['baseTransactionFolderPath']=_0x434eef(0x250),this['baseTransactionExecutionFolder']='C:/EasyTrx',this['cleanupFolder']=async(_0x7b2820,_0x1558fa)=>{const _0x33141d=_0x434eef;if((0x0,_0x1484dd['existsSync'])(_0x7b2820))try{await(0x0,_0xaeef0c['rm'])(_0x7b2820,{'recursive':!0x0,'force':!0x0});}catch(_0x894385){this[_0x33141d(0x1fd)]['debug']('['+_0x1558fa+_0x33141d(0x3b5)+_0x894385[_0x33141d(0x2a0)]);}},this[_0x434eef(0x1fd)]=new _0x4a57c5['Logger']('BaseBankService'),_0x283458[_0x434eef(0x118)](this['baseTransactionFolderPath'],this['logger']),_0x283458['createTransactionFolder'](this['baseTransactionExecutionFolder'],this['logger']);}static['createTransactionFolder'](_0x2e701c,_0x27b449){const _0x1523a2=_0x16c016;if(!_0x283458[_0x1523a2(0x35d)]){if(_0x283458[_0x1523a2(0x359)]){let _0x2f79ca=0x0;const _0x14564c=0xa;for(;_0x283458['folderCreationInProgress']&&_0x2f79ca<_0x14564c;){_0x2f79ca++;const _0x2b9e05=Date['now']();for(;Date[_0x1523a2(0x1a2)]()-_0x2b9e05<0xa;);}if(_0x283458[_0x1523a2(0x35d)]||(0x0,_0x1484dd[_0x1523a2(0x22a)])(_0x2e701c))return void(_0x283458['folderCreated']=!0x0);}try{_0x283458['folderCreationInProgress']=!0x0,(0x0,_0x1484dd['existsSync'])(_0x2e701c)?_0x27b449['debug'](_0x1523a2(0x180)+_0x2e701c):((0x0,_0x1484dd['mkdirSync'])(_0x2e701c,{'recursive':!0x0}),_0x27b449['log']('Created\x20base\x20folder:\x20'+_0x2e701c)),_0x283458['folderCreated']=!0x0;}catch(_0x498c76){_0x1523a2(0x3bd)!==_0x498c76['code']?_0x27b449['error']('Failed\x20to\x20create\x20base\x20folder\x20'+_0x2e701c+':\x20'+_0x498c76['message']):(_0x283458['folderCreated']=!0x0,_0x27b449['debug']('Base\x20folder\x20already\x20exists\x20(created\x20by\x20another\x20process):\x20'+_0x2e701c));}finally{_0x283458[_0x1523a2(0x359)]=!0x1;}}}[_0x16c016(0xfc)](){return this['BANK_CODE'];}async['killApp'](_0x519391){const _0x2829dd=_0x16c016;this['logger']['log']('['+_0x519391+_0x2829dd(0x1e1)+this[_0x2829dd(0xff)]+'\x20app'),await this['wsService'][_0x2829dd(0x262)](_0x519391,this['BUNDLE_ID']);}async[_0x16c016(0x1c8)](_0x335bad,_0x12a425,_0x5b1ee7,_0x5dd471,_0x2cf094=''){await this['wsService']['click'](_0x335bad,_0x12a425,_0x5b1ee7,0.2),_0x2cf094&&this['logger']['log'](_0x2cf094),await(0x0,_0x250021['sleep'])(_0x5dd471);}async['verifyScreenState'](_0x4faccd,_0x504d0d){const _0x584104=_0x16c016,{expectedTexts:_0x555edb=[],unexpectedTexts:_0x20bc4=[],timeout:_0x421a96=0x7530,pollInterval:_0x4cbe71=0x1f4,roi:_0x1efd50,fieldType:_0x519a56='full',preprocess:_0x650e52}=_0x504d0d,_0x32153a=Date['now']();let _0x244c1a=0x0;const _0x239593=(0x0,_0x46c716[_0x584104(0x3ed)])(this['baseTransactionExecutionFolder'],'scan_'+_0x4faccd),_0x117480=_0x1efd50?'ROI:\x20x='+_0x1efd50['x']+_0x584104(0x1c1)+_0x1efd50['y']+_0x584104(0x3de)+_0x1efd50[_0x584104(0x263)]+_0x584104(0x203)+_0x1efd50['height']:_0x584104(0x15c);this['logger']['debug']('['+_0x4faccd+']\x20Starting\x20screen\x20verification.\x20Expected:\x20['+_0x555edb['join'](',\x20')+_0x584104(0x27c)+_0x20bc4['join'](',\x20')+'],\x20'+_0x117480+',\x20Timeout:\x20'+_0x421a96+'ms,\x20Poll:\x20'+_0x4cbe71+'ms');try{for(await this[_0x584104(0x25b)](_0x239593,_0x4faccd),await(0x0,_0xaeef0c['mkdir'])(_0x239593,{'recursive':!0x0});Date['now']()-_0x32153a<_0x421a96;){_0x244c1a++;let _0x3ec10b=null;try{const _0x511da8=Date['now']();await this['wsService']['captureScreen'](_0x4faccd,{'folderPath':_0x239593});let _0xa062e7=null;const _0x429d25=0x5;let _0x5d735=0x0;for(;_0x5d735<_0x429d25&&!_0xa062e7;){_0x5d735++,await(0x0,_0x250021['sleep'])(0x1f4);try{if(!(0x0,_0x1484dd['existsSync'])(_0x239593))continue;const _0x408da2=(await(0x0,_0xaeef0c['readdir'])(_0x239593))[_0x584104(0x3b3)](_0x264bf8=>_0x264bf8['endsWith'](_0x584104(0x214)));if(0x0===_0x408da2[_0x584104(0x1fe)])continue;let _0x264022=0x0;Date[_0x584104(0x1a2)]();for(const _0x658d78 of _0x408da2){const _0x3bc6e5=(0x0,_0x46c716['join'])(_0x239593,_0x658d78);try{const _0xb9a539=await(0x0,_0xaeef0c['stat'])(_0x3bc6e5);if(0x0===_0xb9a539['size'])continue;_0xb9a539['mtimeMs']>=_0x511da8-0x7d0&&_0xb9a539['mtimeMs']>_0x264022&&(_0x264022=_0xb9a539['mtimeMs'],_0xa062e7=_0x3bc6e5);}catch(_0x3853a2){continue;}}}catch(_0x29a667){continue;}}if(!_0xa062e7){await(0x0,_0x250021['sleep'])(_0x4cbe71);continue;}_0x3ec10b=_0xa062e7;const _0x506c7a=[..._0x555edb,..._0x20bc4],_0x4bee0f=await this['ocrService']['fastScreenOCR'](_0x3ec10b,_0x506c7a,{'fieldType':_0x1efd50?_0x584104(0x2fc):_0x519a56,'customROI':_0x1efd50,'preprocess':_0x650e52});if(!_0x4bee0f||!_0x4bee0f[_0x584104(0x165)]){await(0x0,_0x250021[_0x584104(0x26c)])(_0x4cbe71);continue;}const _0x3362a1=0x0===_0x555edb[_0x584104(0x1fe)]||_0x555edb['some'](_0x6d2461=>_0x4bee0f[_0x584104(0x2c2)][_0x584104(0x177)](_0x6d2461)),_0xfbdb9f=_0x20bc4['some'](_0x236edc=>_0x4bee0f['matchedTexts']['includes'](_0x236edc));if(_0x3362a1&&!_0xfbdb9f){await this[_0x584104(0x25b)](_0x239593,_0x4faccd);const _0x558f0f=Date['now']()-_0x32153a,_0x489023=_0x4bee0f['result']?.['processingTime']||0x0,_0x2ebf2a=_0x1efd50?_0x584104(0x19d)+_0x1efd50['x']+','+_0x1efd50['y']+'\x20'+_0x1efd50['width']+'x'+_0x1efd50['height']+')':'';return this[_0x584104(0x1fd)][_0x584104(0x2d5)]('['+_0x4faccd+']\x20Screen\x20verified\x20successfully\x20after\x20'+_0x558f0f+'ms\x20('+_0x244c1a+_0x584104(0x1d2)+_0x489023+'ms)'+_0x2ebf2a+'.\x20Matched:\x20['+_0x4bee0f['matchedTexts']['join'](',\x20')+']'),!0x0;}if(_0x244c1a%0x5==0x0&&this['logger'][_0x584104(0x266)]('['+_0x4faccd+_0x584104(0x267)+_0x244c1a+').\x20Matched\x20texts:\x20['+_0x4bee0f[_0x584104(0x2c2)]['join'](',\x20')+'],\x20Expected:\x20['+_0x555edb['join'](',\x20')+']'),_0x3ec10b)try{await(0x0,_0xaeef0c[_0x584104(0x2fa)])(_0x3ec10b);}catch{}await(0x0,_0x250021['sleep'])(_0x4cbe71);}catch(_0x45b428){this['logger']['debug']('['+_0x4faccd+_0x584104(0x2a7)+_0x244c1a+_0x584104(0x1b4)+_0x45b428['message']+',\x20retrying...'),await(0x0,_0x250021['sleep'])(_0x4cbe71);}}await this[_0x584104(0x25b)](_0x239593,_0x4faccd);const _0x1c0074=Date['now']()-_0x32153a;return this[_0x584104(0x1fd)]['warn']('['+_0x4faccd+']\x20Screen\x20verification\x20timeout\x20after\x20'+_0x1c0074+_0x584104(0x14c)+_0x244c1a+'\x20attempts).\x20Expected:\x20['+_0x555edb['join'](',\x20')+']'),!0x1;}catch(_0x44526d){throw await this['cleanupFolder'](_0x239593,_0x4faccd),_0x44526d;}}async['getLatestImagePath'](_0x475e8c,_0x129197=0x2710,_0x555d88=0x1f4){const _0x235150=_0x16c016;if(!_0x475e8c)return this[_0x235150(0x1fd)][_0x235150(0x1eb)]('Folder\x20path\x20is\x20null\x20or\x20empty'),null;const _0x221c4c=Date[_0x235150(0x1a2)]();let _0x495076=0x0;for(this['logger']['debug'](_0x235150(0x243)+_0x475e8c+',\x20timeout:\x20'+_0x129197+'ms,\x20pollInterval:\x20'+_0x555d88+'ms');Date['now']()-_0x221c4c<_0x129197;){_0x495076++;try{if(!(0x0,_0x1484dd[_0x235150(0x22a)])(_0x475e8c)){await(0x0,_0x250021[_0x235150(0x26c)])(_0x555d88);continue;}const _0x1be93a=await(0x0,_0xaeef0c['readdir'])(_0x475e8c);if(0x0===_0x1be93a['length']){await(0x0,_0x250021['sleep'])(_0x555d88);continue;}const _0x3f3d6b=(await Promise['all'](_0x1be93a['map'](async _0x2ad02e=>{const _0x3fc497=_0x235150;try{const _0x2c7881=(0x0,_0x46c716[_0x3fc497(0x3ed)])(_0x475e8c,_0x2ad02e),_0x1bb866=await(0x0,_0xaeef0c['stat'])(_0x2c7881);return{'fullPath':_0x2c7881,'mtime':_0x1bb866[_0x3fc497(0x265)],'size':_0x1bb866['size']};}catch(_0x5cdf62){return null;}})))['filter'](_0x24a0e2=>null!==_0x24a0e2&&_0x24a0e2['size']>0x0);if(0x0===_0x3f3d6b[_0x235150(0x1fe)]){await(0x0,_0x250021['sleep'])(_0x555d88);continue;}_0x3f3d6b['sort']((_0x3eb8b9,_0x5234df)=>_0x5234df[_0x235150(0x24e)]-_0x3eb8b9['mtime']);const _0x897562=_0x3f3d6b[0x0]['fullPath'],_0xcdb410=Date[_0x235150(0x1a2)]()-_0x221c4c;return this['logger']['log'](_0x235150(0x28b)+_0x897562+'\x20after\x20'+_0xcdb410+'ms\x20('+_0x495076+_0x235150(0x1da)),_0x897562;}catch(_0x37265f){this[_0x235150(0x1fd)]['debug']('Error\x20scanning\x20folder\x20'+_0x475e8c+'\x20(attempt\x20'+_0x495076+'):\x20'+_0x37265f['message']+',\x20retrying...'),await(0x0,_0x250021['sleep'])(_0x555d88);}}const _0x5e5485=Date['now']()-_0x221c4c;return this[_0x235150(0x1fd)][_0x235150(0x1eb)]('Timeout\x20scanning\x20folder\x20for\x20bill\x20image:\x20'+_0x475e8c+'\x20after\x20'+_0x5e5485+'ms\x20('+_0x495076+_0x235150(0x1da)),null;}async['detectScreenByHint'](_0x3f07c9,_0xd41313,_0x26d4d7){const _0x49753f=_0x16c016,_0x48c44b=(0x0,_0x46c716['join'])(this['baseTransactionExecutionFolder'],_0x49753f(0x2e4)+_0x3f07c9),_0x1d6748=_0xd41313[_0x49753f(0x352)](_0x509d84=>({'name':_0x509d84[_0x49753f(0x104)],'hint':(0x0,_0x3c52b0['removeVietnameseTones'])(_0x509d84['hint'])})),_0x3e241d=Date[_0x49753f(0x1a2)]();let _0x5d5bd1=0x0;const {roi:_0x15cdaa,timeout:_0x337677,pollInterval:_0x166d5f}=_0x26d4d7,_0x30bbf7=_0x15cdaa?'ROI:\x20x='+_0x15cdaa['x']+',\x20y='+_0x15cdaa['y']+',\x20w='+_0x15cdaa[_0x49753f(0x263)]+',\x20h='+_0x15cdaa['height']:'Full\x20screen';this['logger']['debug']('['+_0x3f07c9+']\x20Start\x20detecting\x20screen.\x20Screen:\x20['+_0xd41313['map'](_0x5d29ff=>_0x5d29ff['name'])[_0x49753f(0x3ed)]('\x20or\x20')+_0x49753f(0x2eb)+_0x30bbf7+',\x20Timeout:\x20'+_0x337677+'ms,\x20Poll:\x20'+_0x166d5f+'ms');try{for(await this['cleanupFolder'](_0x48c44b,_0x3f07c9),await(0x0,_0xaeef0c['mkdir'])(_0x48c44b,{'recursive':!0x0});Date['now']()-_0x3e241d<_0x337677;){_0x5d5bd1++;let _0x19a561=null;try{const _0x12137f=Date['now']();await this['wsService']['captureScreen'](_0x3f07c9,{'folderPath':_0x48c44b});let _0x2de0f4=null;const _0x1823e9=0x5;let _0x2128d9=0x0;for(;_0x2128d9<_0x1823e9&&!_0x2de0f4;){_0x2128d9++,await(0x0,_0x250021['sleep'])(0x1f4);try{if(!(0x0,_0x1484dd['existsSync'])(_0x48c44b))continue;const _0x242be1=(await(0x0,_0xaeef0c['readdir'])(_0x48c44b))[_0x49753f(0x3b3)](_0x1b4ac7=>_0x1b4ac7[_0x49753f(0x1b8)]('.png'));if(0x0===_0x242be1[_0x49753f(0x1fe)])continue;let _0x346742=0x0;for(const _0x295991 of _0x242be1){const _0xd9446=(0x0,_0x46c716[_0x49753f(0x3ed)])(_0x48c44b,_0x295991);try{const _0x100f68=await(0x0,_0xaeef0c['stat'])(_0xd9446);if(0x0===_0x100f68[_0x49753f(0x3c2)])continue;_0x100f68[_0x49753f(0x265)]>=_0x12137f-0x7d0&&_0x100f68['mtimeMs']>_0x346742&&(_0x346742=_0x100f68[_0x49753f(0x265)],_0x2de0f4=_0xd9446);}catch(_0x3023be){continue;}}}catch(_0x1c2bc9){continue;}}if(!_0x2de0f4){await(0x0,_0x250021[_0x49753f(0x26c)])(_0x166d5f);continue;}const _0x564cf9=await(0x0,_0xaeef0c['readFile'])(_0x2de0f4),_0x2174b8=await this['imagePreprocessingService']['preprocess'](_0x564cf9,_0x26d4d7['roi']?_0x26d4d7['roi']:{'x':0x0,'y':0x0,'width':0x1,'height':0x1},void 0x0,_0x26d4d7[_0x49753f(0x160)]),_0x35b501=await this[_0x49753f(0x1cb)][_0x49753f(0x14e)](_0x2174b8['buffer']);if(!_0x35b501['text']){await(0x0,_0x250021['sleep'])(_0x166d5f);continue;}const _0x9c8ddc=(0x0,_0x3c52b0['removeVietnameseTones'])(_0x35b501[_0x49753f(0x209)]),_0x7e6d93=_0x1d6748[_0x49753f(0x1ca)](_0x3cbf83=>_0x9c8ddc[_0x49753f(0x177)](_0x3cbf83['hint']));if(!_0x7e6d93){await(0x0,_0x250021['sleep'])(_0x166d5f);continue;}if(_0x19a561)try{await(0x0,_0xaeef0c['unlink'])(_0x19a561);}catch{}return _0x7e6d93;}catch(_0x12a534){this[_0x49753f(0x1fd)]['debug']('['+_0x3f07c9+_0x49753f(0x2a7)+_0x5d5bd1+_0x49753f(0x1b4)+_0x12a534['message']+',\x20retrying...'),await(0x0,_0x250021['sleep'])(_0x166d5f);}}await this['cleanupFolder'](_0x48c44b,_0x3f07c9);const _0x5ac3a5=Date['now']()-_0x3e241d;return this['logger']['warn']('['+_0x3f07c9+_0x49753f(0x13c)+_0x5ac3a5+_0x49753f(0x14c)+_0x5d5bd1+'\x20attempts).\x20Expected:\x20Find\x20['+_0xd41313[_0x49753f(0x3ed)]('\x20or\x20')+'],'),null;}catch(_0x828a2b){throw await this['cleanupFolder'](_0x48c44b,_0x3f07c9),_0x828a2b;}}async['clickAndWaitForScreen'](_0x40cfec,_0x839d93,_0x5f5091,_0x2e0565,_0x11f616){const _0x29f598=_0x16c016;return await this[_0x29f598(0x2e6)]['click'](_0x40cfec,_0x839d93,_0x5f5091,0.2),_0x11f616&&this['logger']['log'](_0x11f616),await this['verifyScreenState'](_0x40cfec,_0x2e0565);}async['swipeAndWaitForScreen'](_0x5cee0d,_0x2c340b,_0x2dc356,_0x4d7b65){const _0x4972ce=_0x16c016;for(let _0x61ba4a=0x1;_0x61ba4a<=0x3;_0x61ba4a++){if(await this[_0x4972ce(0x2e6)][_0x4972ce(0x300)](_0x5cee0d,_0x2c340b),await(0x0,_0x250021['sleep'])(0x320),_0x4d7b65&&0x1===_0x61ba4a&&this['logger']['log'](_0x4d7b65),await this['verifyScreenState'](_0x5cee0d,{..._0x2dc356,'timeout':0xbb8}))return _0x61ba4a>0x1&&this[_0x4972ce(0x1fd)][_0x4972ce(0x2d5)]('['+_0x5cee0d+']\x20Screen\x20verified\x20after\x20'+_0x61ba4a+_0x4972ce(0x179)),!0x0;try{const _0x5e9a37=(0x0,_0x46c716[_0x4972ce(0x3ed)])(this['baseTransactionExecutionFolder'],'scan_'+_0x5cee0d+'_debug');if((0x0,_0x1484dd['existsSync'])(_0x5e9a37))try{await(0x0,_0xaeef0c['rm'])(_0x5e9a37,{'recursive':!0x0,'force':!0x0});}catch{}await(0x0,_0xaeef0c[_0x4972ce(0x392)])(_0x5e9a37,{'recursive':!0x0});const _0xbadb16=Date[_0x4972ce(0x1a2)]();await this[_0x4972ce(0x2e6)]['captureScreen'](_0x5cee0d,{'folderPath':_0x5e9a37});let _0x5d9ae8=null;const _0x29fb8d=0x5;let _0x162a98=0x0;for(;_0x162a98<_0x29fb8d&&!_0x5d9ae8;){_0x162a98++,await(0x0,_0x250021['sleep'])(0x1f4);try{if(!(0x0,_0x1484dd[_0x4972ce(0x22a)])(_0x5e9a37))continue;const _0xfcb1ca=(await(0x0,_0xaeef0c[_0x4972ce(0x18c)])(_0x5e9a37))['filter'](_0x389875=>_0x389875[_0x4972ce(0x1b8)](_0x4972ce(0x214)));if(0x0===_0xfcb1ca['length'])continue;let _0x3cd7f5=0x0;for(const _0x52fcbe of _0xfcb1ca){const _0x403289=(0x0,_0x46c716[_0x4972ce(0x3ed)])(_0x5e9a37,_0x52fcbe);try{const _0x357de5=await(0x0,_0xaeef0c['stat'])(_0x403289);_0x357de5['size']>0x0&&_0x357de5['mtimeMs']>=_0xbadb16-0x7d0&&_0x357de5['mtimeMs']>_0x3cd7f5&&(_0x3cd7f5=_0x357de5['mtimeMs'],_0x5d9ae8=_0x403289);}catch{}}}catch{}}if(_0x5d9ae8){const {expectedTexts:_0x5d4be6=[],unexpectedTexts:_0x1d8b37=[],roi:_0x583992,fieldType:_0x4862ac='full',preprocess:_0x4ee559}=_0x2dc356,_0x425cb1=[..._0x5d4be6,..._0x1d8b37];let _0x6989ff='',_0x131b0b=[];if(_0x425cb1[_0x4972ce(0x1fe)]>0x0){const _0xcea646=await this[_0x4972ce(0x1cb)][_0x4972ce(0x331)](_0x5d9ae8,_0x425cb1,{'fieldType':_0x583992?'singleLine':_0x4862ac,'customROI':_0x583992,'preprocess':_0x4ee559});_0x6989ff=_0xcea646?.['result']?.[_0x4972ce(0x209)]||'',_0x131b0b=_0xcea646?.[_0x4972ce(0x2c2)]||[];}else{const _0x7346c9=await this['ocrService']['recognizeFromFile'](_0x5d9ae8,{'fieldType':_0x583992?'singleLine':_0x4862ac,'customROI':_0x583992,'preprocess':_0x4ee559});_0x6989ff=_0x7346c9?.['text']||'';}const _0x2b588e=_0x583992?_0x4972ce(0x1f8)+_0x583992['x']+','+_0x583992['y']+'\x20'+_0x583992['width']+'x'+_0x583992['height']+')':'';_0x6989ff?this[_0x4972ce(0x1fd)]['warn']('['+_0x5cee0d+']\x20Swipe\x20attempt\x20'+_0x61ba4a+'/3\x20-\x20OCR\x20detected\x20text:\x20\x22'+_0x6989ff+'\x22'+(_0x131b0b[_0x4972ce(0x1fe)]>0x0?'\x20|\x20Matched\x20texts:\x20['+_0x131b0b['join'](',\x20')+']':'')+(_0x4972ce(0x2e1)+(_0x5d4be6[_0x4972ce(0x3ed)](',\x20')||'none')+']'+_0x2b588e)):this['logger']['warn']('['+_0x5cee0d+']\x20Swipe\x20attempt\x20'+_0x61ba4a+_0x4972ce(0x3f1)+_0x2b588e);}else this['logger']['warn']('['+_0x5cee0d+']\x20Swipe\x20attempt\x20'+_0x61ba4a+'/3\x20-\x20Could\x20not\x20find\x20screenshot\x20file\x20after\x20'+_0x162a98+'\x20attempts');try{await(0x0,_0xaeef0c['rm'])(_0x5e9a37,{'recursive':!0x0,'force':!0x0});}catch{}}catch(_0xf21d90){this['logger'][_0x4972ce(0x266)]('['+_0x5cee0d+']\x20Failed\x20to\x20debug\x20OCR:\x20'+_0xf21d90[_0x4972ce(0x2a0)]);}_0x61ba4a<0x3&&this['logger']['debug']('['+_0x5cee0d+']\x20Screen\x20not\x20detected\x20after\x20swipe\x20(attempt\x20'+_0x61ba4a+'/3),\x20retrying...');}return this['logger'][_0x4972ce(0x1eb)]('['+_0x5cee0d+']\x20Failed\x20to\x20detect\x20screen\x20after\x203\x20swipe\x20attempts'),!0x1;}async['createBillFolder'](_0x4b6e78){const _0x58d920=_0x16c016,_0x439114=(0x0,_0x46c716['resolve'])(this[_0x58d920(0x335)],_0x4b6e78);await(0x0,_0xaeef0c['mkdir'])(_0x439114,{'recursive':!0x0});}async['captureScreen'](_0x348e07,_0x3f71a6){const _0x5a616d=_0x16c016;this['logger'][_0x5a616d(0x2d5)](_0x5a616d(0x114)+_0x348e07+'\x20with\x20folderPath:\x20'+_0x3f71a6['folderPath']);const _0x1ff066=(0x0,_0x46c716['resolve'])(this['baseTransactionFolderPath'],_0x3f71a6[_0x5a616d(0x3b4)]);await this['wsService'][_0x5a616d(0x341)](_0x348e07,{..._0x3f71a6,'folderPath':_0x1ff066}),await(0x0,_0x250021['sleep'])(0x1f4);}async['getBillImagePath'](_0x3abf82,_0x35080d=0x2710,_0x266d5a=0x1f4){const _0x185a82=_0x16c016;if(!_0x3abf82)return this['logger']['warn']('Folder\x20path\x20is\x20null\x20or\x20empty'),null;const _0x320a3c=(0x0,_0x46c716['join'])(this[_0x185a82(0x335)],_0x3abf82),_0x44d286=Date['now']();let _0x172961=0x0;for(this[_0x185a82(0x1fd)]['debug']('Scanning\x20folder\x20for\x20bill\x20image:\x20'+_0x3abf82+_0x185a82(0x38f)+_0x35080d+'ms,\x20pollInterval:\x20'+_0x266d5a+'ms');Date[_0x185a82(0x1a2)]()-_0x44d286<_0x35080d;){_0x172961++;try{if(!(0x0,_0x1484dd[_0x185a82(0x22a)])(_0x320a3c)){await(0x0,_0x250021[_0x185a82(0x26c)])(_0x266d5a);continue;}const _0xf380f5=await(0x0,_0xaeef0c[_0x185a82(0x18c)])(_0x320a3c);if(0x0===_0xf380f5['length']){await(0x0,_0x250021['sleep'])(_0x266d5a);continue;}const _0x1c574b=(await Promise[_0x185a82(0x12a)](_0xf380f5['map'](async _0x41a984=>{try{const _0x1f6672=(0x0,_0x46c716['join'])(_0x320a3c,_0x41a984),_0x34826c=await(0x0,_0xaeef0c['stat'])(_0x1f6672);return{'fullPath':_0x1f6672,'mtime':_0x34826c['mtimeMs'],'size':_0x34826c['size']};}catch(_0x4c2771){return null;}})))['filter'](_0x13cb00=>null!==_0x13cb00&&_0x13cb00['size']>0x0);if(0x0===_0x1c574b[_0x185a82(0x1fe)]){await(0x0,_0x250021['sleep'])(_0x266d5a);continue;}_0x1c574b['sort']((_0x10bbf1,_0x1c388a)=>_0x1c388a['mtime']-_0x10bbf1['mtime']);const _0x4f1b3f=_0x1c574b[0x0][_0x185a82(0x26d)],_0x354354=Date['now']()-_0x44d286;return this['logger']['log'](_0x185a82(0x28b)+_0x4f1b3f+'\x20after\x20'+_0x354354+_0x185a82(0x14c)+_0x172961+'\x20attempts)'),_0x4f1b3f;}catch(_0x1a9127){this[_0x185a82(0x1fd)]['debug']('Error\x20scanning\x20folder\x20'+_0x3abf82+_0x185a82(0x1f5)+_0x172961+_0x185a82(0x1b4)+_0x1a9127['message']+',\x20retrying...'),await(0x0,_0x250021['sleep'])(_0x266d5a);}}const _0x3f8a80=Date['now']()-_0x44d286;return this[_0x185a82(0x1fd)][_0x185a82(0x1eb)](_0x185a82(0x346)+_0x3abf82+'\x20after\x20'+_0x3f8a80+'ms\x20('+_0x172961+'\x20attempts)'),null;}async[_0x16c016(0xe2)](_0x5d0d74,_0x7178d4){const _0x35193c=_0x16c016,{ROI:_0x223619,expectedTexts:_0x2e9261}=_0x230403['ANALYZE_BILL_ROI'][_0x5d0d74],_0x3bff6e=await this['getBillImagePath'](_0x7178d4['withdrawalCode']);try{if(!_0x3bff6e)return this['logger']['warn']('No\x20bill\x20image\x20path\x20'+_0x7178d4['withdrawalCode']),{'rawPath':null,'analyzedStatus':'na'};const _0x2d9214=await this['ocrService']['fastScreenOCR'](_0x3bff6e,_0x2e9261,{'fieldType':'singleLine','customROI':_0x223619,'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});return _0x2d9214['found']?{'rawPath':_0x3bff6e,'analyzedStatus':_0x2d9214[_0x35193c(0x165)]?'success':_0x35193c(0x148)}:(this['logger']['warn']('No\x20OCR\x20result\x20found\x20for\x20'+_0x7178d4['withdrawalCode']),{'rawPath':_0x3bff6e,'analyzedStatus':'na'});}catch(_0x410372){return this['logger'][_0x35193c(0xeb)]('Error\x20analyzing\x20transfer\x20bill:\x20'+_0x410372['message']),{'rawPath':_0x3bff6e,'analyzedStatus':'na'};}}async[_0x16c016(0x3aa)](_0x3d06ff,_0x2d6e7f){const _0x36d636=_0x16c016,_0x43ce62=(0x0,_0x46c716['join'])(this['baseTransactionExecutionFolder'],'qrcode');await(0x0,_0xaeef0c[_0x36d636(0x392)])(_0x43ce62,{'recursive':!0x0});const _0x39754d='qr_'+_0x2d6e7f['withdrawalCode']+'.png',_0x3f4ae8=(0x0,_0x46c716[_0x36d636(0x3ed)])(_0x43ce62,_0x39754d);await(0x0,_0x23ab2d[_0x36d636(0x344)])(_0x3f4ae8,_0x2d6e7f['transferCode'],{'type':_0x36d636(0x1c3),'width':0xe4,'margin':0x2}),await(0x0,_0x250021[_0x36d636(0x26c)])(0x1f4),await this['wsService']['transferFile'](_0x3d06ff,_0x3f4ae8,0x1),await(0x0,_0x250021['sleep'])(0x1f4),this['logger']['log']('['+_0x3d06ff+']\x20QR\x20code\x20is\x20created\x20and\x20transferred\x20for\x20withdrawal\x20'+_0x2d6e7f['withdrawalId']);}};_0x3f056f[_0x16c016(0x271)]=_0x3c45bd,_0x3c45bd['folderCreationInProgress']=!0x1,_0x3c45bd['folderCreated']=!0x1,_0x3f056f['BaseBankService']=_0x3c45bd=_0x283458=_0x2c2eba([(0x0,_0x4a57c5['Injectable'])(),_0x29375b(0x0,(0x0,_0x4a57c5['Inject'])(_0x322537[_0x16c016(0x311)])),_0x2d4981('design:paramtypes',[_0x16c016(0x18d)==typeof(_0xfab50b=void 0x0!==_0x1ea214['IWebSocketService']&&_0x1ea214['IWebSocketService'])?_0xfab50b:Object,'function'==typeof(_0x5a449=void 0x0!==_0x3b5cf7['DeviceService']&&_0x3b5cf7[_0x16c016(0x204)])?_0x5a449:Object,'function'==typeof(_0x1c3c25=void 0x0!==_0x4dfeda[_0x16c016(0x3dc)]&&_0x4dfeda['OCRService'])?_0x1c3c25:Object,'function'==typeof(_0x5e53ca=void 0x0!==_0x36f71f['ImagePreprocessingService']&&_0x36f71f[_0x16c016(0x1d5)])?_0x5e53ca:Object])],_0x3c45bd);},(_0x4321cf,_0x220dca)=>{const _0x2a8107=a0_0x2e92;Object['defineProperty'](_0x220dca,_0x2a8107(0x110),{'value':!0x0}),_0x220dca[_0x2a8107(0x26c)]=void 0x0,_0x220dca['sleep']=_0x110feb=>new Promise(_0x2560db=>setTimeout(_0x2560db,_0x110feb));},_0xb56fcd=>{_0xb56fcd['exports']=require('fs');},_0x1e444f=>{_0x1e444f['exports']=require('fs/promises');},function(_0x36f4a4,_0x24bef1,_0x1bf432){const _0xf66a33=a0_0x2e92;var _0x115c35,_0x417a8f,_0x328299,_0x31c362=this&&this['__decorate']||function(_0x57980d,_0x3e5d5a,_0x6daa77,_0x4821a7){const _0x5c17b9=a0_0x2e92;var _0x485714,_0x325ae0=arguments['length'],_0x41bc4b=_0x325ae0<0x3?_0x3e5d5a:null===_0x4821a7?_0x4821a7=Object['getOwnPropertyDescriptor'](_0x3e5d5a,_0x6daa77):_0x4821a7;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x5c17b9(0x3b0)])_0x41bc4b=Reflect[_0x5c17b9(0x3b0)](_0x57980d,_0x3e5d5a,_0x6daa77,_0x4821a7);else{for(var _0xea757c=_0x57980d['length']-0x1;_0xea757c>=0x0;_0xea757c--)(_0x485714=_0x57980d[_0xea757c])&&(_0x41bc4b=(_0x325ae0<0x3?_0x485714(_0x41bc4b):_0x325ae0>0x3?_0x485714(_0x3e5d5a,_0x6daa77,_0x41bc4b):_0x485714(_0x3e5d5a,_0x6daa77))||_0x41bc4b);}return _0x325ae0>0x3&&_0x41bc4b&&Object[_0x5c17b9(0x3cc)](_0x3e5d5a,_0x6daa77,_0x41bc4b),_0x41bc4b;},_0x2a3d3f=this&&this[_0xf66a33(0x3c1)]||function(_0x45cf36,_0x3f8c36){const _0x36aaf9=_0xf66a33;if('object'==typeof Reflect&&_0x36aaf9(0x18d)==typeof Reflect['metadata'])return Reflect[_0x36aaf9(0x3ac)](_0x45cf36,_0x3f8c36);};Object[_0xf66a33(0x3cc)](_0x24bef1,'__esModule',{'value':!0x0}),_0x24bef1['OCRService']=_0x24bef1[_0xf66a33(0x202)]=_0x24bef1['ROI']=void 0x0;const _0x69b4f5=_0x1bf432(0x2),_0x1530cd=_0x1bf432(0x1a),_0x329486=_0x1bf432(0x1c),_0x5de70c=_0x1bf432(0x1e),_0x4af922=_0x1bf432(0x20),_0x519858=_0x1bf432(0x11);var _0x54ab5f=_0x1bf432(0x1e);Object['defineProperty'](_0x24bef1,'ROI',{'enumerable':!0x0,'get':function(){return _0x54ab5f['ROI'];}}),Object['defineProperty'](_0x24bef1,'PreprocessOptions',{'enumerable':!0x0,'get':function(){const _0x46517d=_0xf66a33;return _0x54ab5f[_0x46517d(0x202)];}});const _0x8a1f9d={'crop':{'x':0x0,'y':0x0,'width':0x1,'height':0x1},'psm':0x6,'charWhitelist':void 0x0,'maxWidth':0x4b0};let _0x28da24=_0x115c35=class{constructor(_0x1bd400,_0x589ad3){const _0x55c3a1=_0xf66a33;this['workerPoolService']=_0x1bd400,this[_0x55c3a1(0x1dd)]=_0x589ad3,this['logger']=new _0x69b4f5['Logger'](_0x115c35['name']),this['ocrConfig']={'poolSize':_0x519858[_0x55c3a1(0x302)]['ocr']['poolSize'],'lang':_0x519858['config']['ocr'][_0x55c3a1(0x112)],'rois':{'full':_0x8a1f9d,'singleLine':{..._0x8a1f9d,'psm':0x7},'block':{..._0x8a1f9d,'psm':0x6}}};}['validateROI'](_0x55a926){const _0x534722=_0xf66a33;return{'x':Math['max'](0x0,Math['min'](0x1,_0x55a926['x']||0x0)),'y':Math['max'](0x0,Math['min'](0x1,_0x55a926['y']||0x0)),'width':Math['max'](0.01,Math['min'](0x1,_0x55a926['width']||0x1)),'height':Math['max'](0.01,Math[_0x534722(0x3e7)](0x1,_0x55a926[_0x534722(0x259)]||0x1))};}['getROIConfig'](_0x1cc9ac){const _0x2b34b1=_0xf66a33,_0x2f6d13=this[_0x2b34b1(0x36b)][_0x2b34b1(0x272)]?.[_0x1cc9ac]||this[_0x2b34b1(0x36b)][_0x2b34b1(0x272)]?.['full']||_0x8a1f9d;return{'crop':_0x2f6d13['crop']||_0x8a1f9d['crop'],'psm':_0x2f6d13[_0x2b34b1(0x29e)]??_0x8a1f9d['psm'],'charWhitelist':_0x2f6d13['charWhitelist'],'maxWidth':_0x2f6d13['maxWidth']??_0x8a1f9d['maxWidth']};}async['recognizeFromFile'](_0x2f0a4b,_0x3443d6={}){const _0x1f5309=_0xf66a33,_0x155f84=Date[_0x1f5309(0x1a2)](),_0x522819={'decodeImage':0x0,'preprocess':0x0,'ocrRecognize':0x0,'postprocess':0x0};try{const _0x31c8da=Date[_0x1f5309(0x1a2)](),_0x2d0d2e=await(0x0,_0x1530cd['readFile'])(_0x2f0a4b);_0x522819['decodeImage']=Date['now']()-_0x31c8da;const _0xca66cb=_0x3443d6['fieldType']||_0x1f5309(0x31e),_0x23f1fe=this[_0x1f5309(0x303)](_0xca66cb),_0x2239c1=this['validateROI'](_0x3443d6['customROI']||_0x23f1fe['crop']),_0x4d8c0e=Date['now'](),_0x7a1971=await this['imagePreprocessingService']['preprocess'](_0x2d0d2e,_0x2239c1,_0x23f1fe['maxWidth'],_0x3443d6[_0x1f5309(0x160)]);_0x522819['preprocess']=Date[_0x1f5309(0x1a2)]()-_0x4d8c0e;const _0x2575e6=Date[_0x1f5309(0x1a2)](),_0x1a5a94=await this[_0x1f5309(0x186)]['recognize'](_0x7a1971['buffer'],{'psm':_0x23f1fe['psm'],'charWhitelist':_0x23f1fe['charWhitelist']});_0x522819['ocrRecognize']=Date['now']()-_0x2575e6;const _0x58a235=Date[_0x1f5309(0x1a2)](),_0x3acf67=this[_0x1f5309(0x35a)](_0x1a5a94[_0x1f5309(0x209)]);_0x522819['postprocess']=Date['now']()-_0x58a235;const _0x51db96=Date['now']()-_0x155f84;return this[_0x1f5309(0x106)](_0x2f0a4b,_0xca66cb,_0x51db96,_0x522819,_0x1a5a94['confidence']),{'text':_0x3acf67,'confidence':_0x1a5a94[_0x1f5309(0x279)],'processingTime':_0x51db96,'timingBreakdown':_0x522819};}catch(_0x5a688b){return this['logger'][_0x1f5309(0xeb)]('OCR\x20error\x20for\x20'+_0x2f0a4b+':\x20'+_0x5a688b['message'],_0x5a688b[_0x1f5309(0x3d6)]),null;}}async[_0xf66a33(0x14e)](_0x245714,_0x14f1a1={}){const _0x20ec06=_0xf66a33,_0xc37e4b=Date[_0x20ec06(0x1a2)](),_0x4664e3={'decodeImage':0x0,'preprocess':0x0,'ocrRecognize':0x0,'postprocess':0x0};try{_0x4664e3['decodeImage']=0x0;const _0x195f94=_0x14f1a1['fieldType']||_0x20ec06(0x31e),_0x427e2e=this['getROIConfig'](_0x195f94),_0x309dd5=this['validateROI'](_0x14f1a1[_0x20ec06(0x257)]||_0x427e2e['crop']),_0x58240a=Date['now'](),_0x53ed56=await this[_0x20ec06(0x1dd)]['preprocess'](_0x245714,_0x309dd5,_0x427e2e['maxWidth'],_0x14f1a1['preprocess']);_0x4664e3['preprocess']=Date[_0x20ec06(0x1a2)]()-_0x58240a;const _0x4bc521=Date['now'](),_0x238d5f=await this['workerPoolService']['recognize'](_0x53ed56['buffer'],{'psm':_0x427e2e['psm'],'charWhitelist':_0x427e2e['charWhitelist']});_0x4664e3['ocrRecognize']=Date[_0x20ec06(0x1a2)]()-_0x4bc521;const _0x385573=Date['now'](),_0x383de4=this['postprocessText'](_0x238d5f['text']);_0x4664e3['postprocess']=Date[_0x20ec06(0x1a2)]()-_0x385573;const _0x5767b7=Date['now']()-_0xc37e4b;return this[_0x20ec06(0x106)]('buffer',_0x195f94,_0x5767b7,_0x4664e3,_0x238d5f['confidence']),{'text':_0x383de4,'confidence':_0x238d5f['confidence'],'processingTime':_0x5767b7,'timingBreakdown':_0x4664e3};}catch(_0x5980fe){return this['logger']['error'](_0x20ec06(0x358)+_0x5980fe[_0x20ec06(0x2a0)],_0x5980fe[_0x20ec06(0x3d6)]),null;}}async[_0xf66a33(0x331)](_0x2fc73e,_0x501a88,_0x14905f={}){const _0x5b452f=_0xf66a33,_0x308121=await this['recognizeFromFile'](_0x2fc73e,{'fieldType':_0x14905f[_0x5b452f(0x2bd)]||'full','customROI':_0x14905f[_0x5b452f(0x257)],'preprocess':_0x14905f[_0x5b452f(0x160)]});if(!_0x308121||!_0x308121['text'])return{'found':!0x1,'matchedTexts':[],'result':_0x308121};const _0x2c40af=(0x0,_0x4af922['normalizeBankAccountName'])(_0x308121['text']),_0x3b7fec=_0x501a88['filter'](_0x47b21d=>_0x2c40af['includes']((0x0,_0x4af922[_0x5b452f(0x1bd)])(_0x47b21d)));return{'found':_0x3b7fec['length']>0x0,'matchedTexts':_0x3b7fec,'result':_0x308121};}['postprocessText'](_0x32ce47){return _0x32ce47['trim']()['replace'](/\s+/g,'\x20')['replace'](/\n{3,}/g,'\x0a\x0a');}[_0xf66a33(0x106)](_0x44a5c4,_0x13b3a9,_0x3851e8,_0xdb7338,_0x3c2cfe){const _0x48b575=_0xf66a33;['decode='+_0xdb7338[_0x48b575(0x147)]+'ms',_0x48b575(0x221)+_0xdb7338[_0x48b575(0x160)]+'ms','ocr='+_0xdb7338['ocrRecognize']+'ms',_0x48b575(0x3df)+_0xdb7338['postprocess']+'ms']['join'](_0x48b575(0x398)),_0x3851e8>0x3e8&&this['logger']['warn']('‚ö†Ô∏è\x20OCR\x20latency\x20exceeded\x20target:\x20'+_0x3851e8+'ms\x20>\x201000ms\x20(p95\x20target)');}};_0x24bef1[_0xf66a33(0x3dc)]=_0x28da24,_0x24bef1['OCRService']=_0x28da24=_0x115c35=_0x31c362([(0x0,_0x69b4f5[_0xf66a33(0x19b)])(),_0x2a3d3f(_0xf66a33(0x22c),[_0xf66a33(0x18d)==typeof(_0x417a8f=void 0x0!==_0x329486['OCRWorkerPoolService']&&_0x329486['OCRWorkerPoolService'])?_0x417a8f:Object,'function'==typeof(_0x328299=void 0x0!==_0x5de70c['ImagePreprocessingService']&&_0x5de70c['ImagePreprocessingService'])?_0x328299:Object])],_0x28da24);},function(_0x58b5d5,_0x444551,_0x570167){const _0x3cdea8=a0_0x2e92;var _0x2fcb7a=this&&this['__decorate']||function(_0x285c54,_0x3950dd,_0x42e61a,_0x305de2){var _0x361d46,_0x21aae8=arguments['length'],_0x1f458b=_0x21aae8<0x3?_0x3950dd:null===_0x305de2?_0x305de2=Object['getOwnPropertyDescriptor'](_0x3950dd,_0x42e61a):_0x305de2;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x1f458b=Reflect['decorate'](_0x285c54,_0x3950dd,_0x42e61a,_0x305de2);else{for(var _0xa2ffd0=_0x285c54['length']-0x1;_0xa2ffd0>=0x0;_0xa2ffd0--)(_0x361d46=_0x285c54[_0xa2ffd0])&&(_0x1f458b=(_0x21aae8<0x3?_0x361d46(_0x1f458b):_0x21aae8>0x3?_0x361d46(_0x3950dd,_0x42e61a,_0x1f458b):_0x361d46(_0x3950dd,_0x42e61a))||_0x1f458b);}return _0x21aae8>0x3&&_0x1f458b&&Object['defineProperty'](_0x3950dd,_0x42e61a,_0x1f458b),_0x1f458b;},_0x17a239=this&&this['__metadata']||function(_0x19dc4a,_0xced65f){const _0x3c4a37=a0_0x2e92;if(_0x3c4a37(0x141)==typeof Reflect&&'function'==typeof Reflect[_0x3c4a37(0x3ac)])return Reflect['metadata'](_0x19dc4a,_0xced65f);};Object['defineProperty'](_0x444551,'__esModule',{'value':!0x0}),_0x444551['OCRWorkerPoolService']=void 0x0;const _0x55571a=_0x570167(0x2),_0x461685=_0x570167(0x1d),_0x2496d9=_0x570167(0x11);let _0x5daaad=class{constructor(){const _0x4857c4=a0_0x2e92;this['logger']=new _0x55571a['Logger'](_0x4857c4(0x21c)),this['pool']=[],this['waitingQueue']=[],this['maxWaitTime']=0x1388,this['maxPoolSize']=0xa,this['isInitializing']=!0x1,this[_0x4857c4(0x19e)]=!0x1,this[_0x4857c4(0x2bf)]=!0x1,this['initializationPromise']=null,this['poolSize']=Math['max'](0x1,Math['min'](_0x2496d9['config']['ocr']['poolSize'],this['maxPoolSize'])),this['lang']=_0x2496d9[_0x4857c4(0x302)][_0x4857c4(0x228)][_0x4857c4(0x112)],_0x2496d9['config'][_0x4857c4(0x228)]['poolSize']>this['maxPoolSize']&&this['logger'][_0x4857c4(0x1eb)]('OCR_POOL_SIZE\x20('+_0x2496d9['config'][_0x4857c4(0x228)]['poolSize']+_0x4857c4(0x253)+this['maxPoolSize']+_0x4857c4(0x2a8)+this['maxPoolSize']+'.');}async['onModuleInit'](){await this['warmPool']();}async['onModuleDestroy'](){this['isDestroyed']=!0x0,this['rejectAllPending'](new Error('OCR\x20service\x20is\x20shutting\x20down')),await this['terminateAll']();}async['warmPool'](){const _0x53554c=a0_0x2e92;if(this['isInitializing'])return this['initializationPromise']||Promise['resolve']();this['isInitializing']=!0x0,this[_0x53554c(0x3e8)]=this['doWarmPool']();try{await this['initializationPromise'];}finally{this[_0x53554c(0x1ed)]=!0x1;}}async['doWarmPool'](){const _0x24e61e=a0_0x2e92,_0x1ef618=Date[_0x24e61e(0x1a2)]();this['logger']['log']('Warming\x20up\x20OCR\x20worker\x20pool\x20(size:\x20'+this['poolSize']+',\x20lang:\x20'+this['lang']+_0x24e61e(0x15f));const _0x2de4ec=Array[_0x24e61e(0x349)]({'length':this[_0x24e61e(0x212)]},(_0x20fdb8,_0x1975ca)=>this['createWorker'](_0x1975ca));try{await Promise['all'](_0x2de4ec);const _0x2ca305=Date['now']()-_0x1ef618;this['logger'][_0x24e61e(0x2d5)](_0x24e61e(0x1a9)+_0x2ca305+_0x24e61e(0xfb)+this[_0x24e61e(0x117)]['length']);}catch(_0x4532fd){throw this[_0x24e61e(0x1fd)]['error'](_0x24e61e(0x3b1)+_0x4532fd[_0x24e61e(0x2a0)],_0x4532fd['stack']),await this[_0x24e61e(0x18f)](),_0x4532fd;}}async['createWorker'](_0x4d0917){const _0x1381de=a0_0x2e92;try{const _0x5d9fe7=await _0x461685['createWorker'](this['lang'],0x1,{'logger':_0x31939b=>{const _0x47048d=a0_0x2e92;_0x47048d(0xeb)===_0x31939b['status']&&this['logger'][_0x47048d(0xeb)](_0x47048d(0x27d)+_0x4d0917+'\x20error:\x20'+_0x31939b['message']);}});this['pool']['push']({'id':_0x4d0917,'worker':_0x5d9fe7,'inUse':!0x1,'lastUsed':Date['now']()}),this['logger']['debug']('Worker\x20'+_0x4d0917+'\x20created\x20successfully');}catch(_0x2e7f7b){throw this['logger'][_0x1381de(0xeb)](_0x1381de(0x1de)+_0x4d0917+':\x20'+_0x2e7f7b[_0x1381de(0x2a0)]),_0x2e7f7b;}}async['acquireWorker'](){const _0x4c4955=a0_0x2e92;if(this['isDestroyed'])throw new Error('OCR\x20service\x20is\x20destroyed');return this['isInitializing']&&this['initializationPromise']&&await this[_0x4c4955(0x3e8)],this['tryAcquireFromPool']()||this['waitForWorker']();}['tryAcquireFromPool'](){const _0x2b9fc5=a0_0x2e92;if(this['isAcquiring'])return null;this['isAcquiring']=!0x0;try{for(const _0x3c77c4 of this['pool'])if(!_0x3c77c4['inUse'])return _0x3c77c4[_0x2b9fc5(0x178)]=!0x0,_0x3c77c4[_0x2b9fc5(0x2f8)]=Date[_0x2b9fc5(0x1a2)](),_0x3c77c4;return null;}finally{this['isAcquiring']=!0x1;}}['waitForWorker'](){return new Promise((_0x4caece,_0x6913ca)=>{const _0x1ed813=a0_0x2e92,_0x4ea199=setTimeout(()=>{const _0x4f5ad3=a0_0x2e92,_0x1f1de5=this['waitingQueue']['findIndex'](_0x4eaeae=>_0x4eaeae[_0x4f5ad3(0x17b)]===_0x4caece);-0x1!==_0x1f1de5&&this['waitingQueue']['splice'](_0x1f1de5,0x1),this['logger']['warn']('Timeout\x20waiting\x20for\x20worker,\x20creating\x20temporary\x20worker'),this['createTemporaryWorker']()['then'](_0x4caece)['catch'](_0x6913ca);},this['maxWaitTime']);this[_0x1ed813(0x323)]['push']({'resolve':_0x4caece,'reject':_0x6913ca,'timeout':_0x4ea199});});}async[_0x3cdea8(0x16e)](){const _0x61e381=_0x3cdea8;return{'id':-0x1,'worker':await _0x461685[_0x61e381(0x1e7)](this['lang'],0x1,{'logger':()=>{}}),'inUse':!0x0,'lastUsed':Date[_0x61e381(0x1a2)]()};}['releaseWorker'](_0x447f75){const _0x10071f=_0x3cdea8;if(this['waitingQueue'][_0x10071f(0x1fe)]>0x0){const _0x39f5b5=this[_0x10071f(0x323)]['shift']();clearTimeout(_0x39f5b5['timeout']),_0x447f75[_0x10071f(0x2f8)]=Date['now'](),_0x39f5b5['resolve'](_0x447f75);}else _0x447f75['inUse']=!0x1,_0x447f75['lastUsed']=Date['now']();}[_0x3cdea8(0x3f2)](_0xe59044){const _0x41d0de=_0x3cdea8;for(;this[_0x41d0de(0x323)]['length']>0x0;){const _0xe65e8f=this[_0x41d0de(0x323)]['shift']();clearTimeout(_0xe65e8f['timeout']),_0xe65e8f[_0x41d0de(0x38d)](_0xe59044);}}async[_0x3cdea8(0x1aa)](_0x131894,_0xe86ff9={}){const _0x434364=_0x3cdea8,_0x38bfe8=await this['acquireWorker'](),_0x49d608=_0x38bfe8['id']<0x0,{psm:_0x1d6261,charWhitelist:_0x1342a5}=_0xe86ff9,_0x4d24bb=void 0x0!==_0x1d6261||!!_0x1342a5;try{const _0x1c8917={};void 0x0!==_0x1d6261&&(_0x1c8917['tessedit_pageseg_mode']=_0x1d6261),_0x1342a5&&(_0x1c8917['tessedit_char_whitelist']=_0x1342a5),Object['keys'](_0x1c8917)['length']>0x0&&await _0x38bfe8[_0x434364(0x3c8)]['setParameters'](_0x1c8917);const {data:_0x1095a2}=await _0x38bfe8[_0x434364(0x3c8)]['recognize'](_0x131894);return{'text':_0x1095a2['text'],'confidence':_0x1095a2['confidence']};}finally{if(_0x49d608)try{await _0x38bfe8['worker'][_0x434364(0xf6)]();}catch(_0x1b2284){this['logger']['warn'](_0x434364(0x2fe)+_0x1b2284['message']);}else{if(_0x4d24bb)try{await _0x38bfe8['worker'][_0x434364(0x208)]({'tessedit_pageseg_mode':0x6,'tessedit_char_whitelist':''});}catch(_0x400058){this['logger']['warn'](_0x434364(0x2f0)+_0x400058['message']);}this['releaseWorker'](_0x38bfe8);}}}['getPoolStats'](){const _0x3b048b=_0x3cdea8;return{'total':this['pool']['length'],'inUse':this['pool'][_0x3b048b(0x3b3)](_0xb3a8e9=>_0xb3a8e9['inUse'])['length'],'waiting':this['waitingQueue']['length']};}async[_0x3cdea8(0x18f)](){const _0x45eb24=_0x3cdea8;if(0x0===this['pool']['length'])return;this['logger']['log']('Terminating\x20'+this['pool'][_0x45eb24(0x1fe)]+'\x20OCR\x20workers...');const _0x30d4ef=this['pool'][_0x45eb24(0x352)](_0x3bbda0=>_0x3bbda0['worker']['terminate']()[_0x45eb24(0x16d)](()=>{this['logger']['debug']('Worker\x20'+_0x3bbda0['id']+'\x20terminated');})['catch'](_0x5385bb=>{const _0x755579=_0x45eb24;this['logger'][_0x755579(0xeb)]('Error\x20terminating\x20worker\x20'+_0x3bbda0['id']+':\x20'+_0x5385bb['message']);}));await Promise['all'](_0x30d4ef),this[_0x45eb24(0x117)]['length']=0x0,this['logger'][_0x45eb24(0x2d5)](_0x45eb24(0x3be));}};_0x444551['OCRWorkerPoolService']=_0x5daaad,_0x444551['OCRWorkerPoolService']=_0x5daaad=_0x2fcb7a([(0x0,_0x55571a['Injectable'])(),_0x17a239('design:paramtypes',[])],_0x5daaad);},_0x32b67d=>{_0x32b67d['exports']=require('tesseract.js');},function(_0x4a7d37,_0x1d014c,_0x322c58){const _0x2640a6=a0_0x2e92;var _0x36b97b=this&&this[_0x2640a6(0x21f)]||function(_0x58b217,_0x2a6a94,_0x315160,_0x1d73fa){const _0x42cce1=_0x2640a6;var _0x58d6ab,_0x339eeb=arguments['length'],_0x48c3dc=_0x339eeb<0x3?_0x2a6a94:null===_0x1d73fa?_0x1d73fa=Object[_0x42cce1(0x25c)](_0x2a6a94,_0x315160):_0x1d73fa;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x48c3dc=Reflect['decorate'](_0x58b217,_0x2a6a94,_0x315160,_0x1d73fa);else{for(var _0x87bbb5=_0x58b217['length']-0x1;_0x87bbb5>=0x0;_0x87bbb5--)(_0x58d6ab=_0x58b217[_0x87bbb5])&&(_0x48c3dc=(_0x339eeb<0x3?_0x58d6ab(_0x48c3dc):_0x339eeb>0x3?_0x58d6ab(_0x2a6a94,_0x315160,_0x48c3dc):_0x58d6ab(_0x2a6a94,_0x315160))||_0x48c3dc);}return _0x339eeb>0x3&&_0x48c3dc&&Object[_0x42cce1(0x3cc)](_0x2a6a94,_0x315160,_0x48c3dc),_0x48c3dc;};Object[_0x2640a6(0x3cc)](_0x1d014c,_0x2640a6(0x110),{'value':!0x0}),_0x1d014c['ImagePreprocessingService']=void 0x0;const _0x40027e=_0x322c58(0x2),_0x5d1a30=_0x322c58(0x1f);let _0x64f361=class{constructor(){this['logger']=new _0x40027e['Logger']('ImagePreprocessingService'),this['MIN_DIMENSION']=0xa;}[_0x2640a6(0x12d)](_0x5e9506){const _0xa4b388=_0x2640a6;if(_0x5e9506['x']<0x0||_0x5e9506['x']>0x1)throw new Error('Invalid\x20ROI\x20x:\x20'+_0x5e9506['x']+'\x20(must\x20be\x200-1)');if(_0x5e9506['y']<0x0||_0x5e9506['y']>0x1)throw new Error(_0xa4b388(0x39c)+_0x5e9506['y']+'\x20(must\x20be\x200-1)');if(_0x5e9506['width']<=0x0||_0x5e9506['width']>0x1)throw new Error('Invalid\x20ROI\x20width:\x20'+_0x5e9506[_0xa4b388(0x263)]+'\x20(must\x20be\x200-1)');if(_0x5e9506['height']<=0x0||_0x5e9506['height']>0x1)throw new Error('Invalid\x20ROI\x20height:\x20'+_0x5e9506['height']+'\x20(must\x20be\x200-1)');if(_0x5e9506['x']+_0x5e9506[_0xa4b388(0x263)]>1.001)throw new Error('ROI\x20extends\x20beyond\x20image:\x20x('+_0x5e9506['x']+')\x20+\x20width('+_0x5e9506['width']+_0xa4b388(0x282));if(_0x5e9506['y']+_0x5e9506['height']>1.001)throw new Error('ROI\x20extends\x20beyond\x20image:\x20y('+_0x5e9506['y']+')\x20+\x20height('+_0x5e9506['height']+_0xa4b388(0x282));}async['preprocess'](_0x4c4254,_0x5f2702,_0x1806fc,_0x3b57d8={}){const _0x3760b6=_0x2640a6;try{this['validateROI'](_0x5f2702);const _0x1da99f=_0x5d1a30(_0x4c4254),_0x5bca00=await _0x1da99f[_0x3760b6(0x3ac)](),_0x5a796a=_0x5bca00['width']||0x0,_0x38778b=_0x5bca00['height']||0x0;if(0x0===_0x5a796a||0x0===_0x38778b)throw new Error('Invalid\x20image\x20dimensions:\x20width\x20or\x20height\x20is\x200');if(_0x5a796a<this['MIN_DIMENSION']||_0x38778b<this['MIN_DIMENSION'])throw new Error(_0x3760b6(0x32e)+_0x5a796a+'x'+_0x38778b+'\x20(min:\x20'+this[_0x3760b6(0x3e1)]+'x'+this['MIN_DIMENSION']+')');const _0x3efba1=Math['floor'](_0x5f2702['x']*_0x5a796a),_0x299b3a=Math['floor'](_0x5f2702['y']*_0x38778b),_0x1b6149=Math['floor'](_0x5f2702['width']*_0x5a796a),_0x2b3ad3=Math[_0x3760b6(0x21b)](_0x5f2702['height']*_0x38778b),_0x3bb14c=Math[_0x3760b6(0x175)](0x0,Math['min'](_0x3efba1,_0x5a796a-0x1)),_0x5e5cfe=Math['max'](0x0,Math[_0x3760b6(0x3e7)](_0x299b3a,_0x38778b-0x1)),_0x247c85=Math['max'](this['MIN_DIMENSION'],Math['min'](_0x1b6149,_0x5a796a-_0x3bb14c)),_0x453ee0=Math[_0x3760b6(0x175)](this['MIN_DIMENSION'],Math['min'](_0x2b3ad3,_0x38778b-_0x5e5cfe));let _0x2b7466=_0x1da99f[_0x3760b6(0x394)]()[_0x3760b6(0x2a6)]({'left':_0x3bb14c,'top':_0x5e5cfe,'width':_0x247c85,'height':_0x453ee0}),_0x3db043=_0x247c85,_0x3e7df8=_0x453ee0,_0x51cb73=0x1;return _0x1806fc&&_0x247c85>_0x1806fc&&(_0x51cb73=_0x1806fc/_0x247c85,_0x3db043=_0x1806fc,_0x3e7df8=Math['max'](this[_0x3760b6(0x3e1)],Math[_0x3760b6(0x21b)](_0x453ee0*_0x51cb73)),_0x2b7466=_0x2b7466['resize'](_0x3db043,_0x3e7df8,{'kernel':_0x5d1a30['kernel']['lanczos3'],'withoutEnlargement':!0x0})),_0x3b57d8['grayscale']&&(_0x2b7466=_0x2b7466['grayscale']()),_0x3b57d8['enhanceContrast']&&(_0x2b7466=_0x2b7466['normalize']()),{'buffer':await _0x2b7466[_0x3760b6(0x1c3)]()['toBuffer'](),'metadata':{'originalWidth':_0x5a796a,'originalHeight':_0x38778b,'processedWidth':_0x3db043,'processedHeight':_0x3e7df8,'scaleFactor':_0x51cb73}};}catch(_0x39a57f){throw this[_0x3760b6(0x1fd)]['error']('Image\x20preprocessing\x20error:\x20'+_0x39a57f['message'],_0x39a57f['stack']),_0x39a57f;}}};_0x1d014c['ImagePreprocessingService']=_0x64f361,_0x1d014c['ImagePreprocessingService']=_0x64f361=_0x36b97b([(0x0,_0x40027e['Injectable'])()],_0x64f361);},_0x479c84=>{_0x479c84['exports']=require('sharp');},(_0x81ef5,_0x19c336)=>{const _0x1b3b38=a0_0x2e92;Object['defineProperty'](_0x19c336,'__esModule',{'value':!0x0}),_0x19c336[_0x1b3b38(0x1bd)]=_0x19c336['removeVietnameseTones']=void 0x0,_0x19c336['removeVietnameseTones']=_0x58240b=>_0x58240b?_0x58240b[_0x1b3b38(0x372)]('NFD')['replace'](/[\u0300-\u036f]/g,'')['replace'](/ƒë/g,'d')[_0x1b3b38(0x159)](/ƒê/g,'D'):'',_0x19c336['normalizeBankAccountName']=_0xb5f59c=>_0xb5f59c?(0x0,_0x19c336['removeVietnameseTones'])(_0xb5f59c)[_0x1b3b38(0x310)]()[_0x1b3b38(0x159)](/ /g,'')['toLocaleUpperCase']():'';},_0x5ab9bc=>{const _0x5243b1=a0_0x2e92;_0x5ab9bc[_0x5243b1(0x29f)]=require('qrcode');},(_0x28d780,_0x24c232,_0x563528)=>{const _0x4aa5e5=a0_0x2e92;Object['defineProperty'](_0x24c232,'__esModule',{'value':!0x0}),_0x24c232[_0x4aa5e5(0x301)]=void 0x0;const _0x280328=_0x563528(0x23),_0x1f88c1=_0x563528(0x24),_0x5ca223=_0x563528(0x25);_0x24c232['ANALYZE_BILL_ROI']={'PGBANK':{'ROI':_0x1f88c1['PG_ROI_EXPECTED']['TRANSACTION_SUCCESS'],'expectedTexts':['chuy·ªÉn\x20ti·ªÅn\x20th√†nh\x20c√¥ng']},'HDBANK':{'ROI':_0x280328['HD_ROI_EXPECTED'][_0x4aa5e5(0x158)],'expectedTexts':['K·∫øt\x20qu·∫£\x20giao\x20d·ªãch']},'VIETCOMBANK':{'ROI':_0x5ca223['VCB_ROI_EXPECTED'][_0x4aa5e5(0x3ad)],'expectedTexts':['Giao\x20d·ªãch\x20th√†nh\x20c√¥ng']}};},(_0x375411,_0x4b2c2f)=>{const _0x30823e=a0_0x2e92;Object[_0x30823e(0x3cc)](_0x4b2c2f,'__esModule',{'value':!0x0}),_0x4b2c2f[_0x30823e(0x2d7)]=void 0x0,_0x4b2c2f['HD_ROI_EXPECTED']={'LAUNCH_APP':{'x':0.1,'y':0.54,'width':0.7,'height':0.1},'VERIFY_ACCOUNT_NUMBER':{'x':0.05,'y':0.4,'width':0.9,'height':0.2},'VERIFY_ACCOUNT_NAME':{'x':0.05,'y':0.6,'width':0.8,'height':0.2},'OTP_ENTER':{'x':0.1,'y':0.25,'width':0.8,'height':0.1},'TRANSACTION_VERIFY':{'x':0.1,'y':0.5,'width':0.4,'height':0.1},'TRANSACTION_SUCCESS':{'x':0.2,'y':0.3,'width':0.6,'height':0.1},'BILL_AREA':{'x':0.085,'y':0.025,'width':0.6,'height':0.075},'HOME_SCREEN':{'x':0.02,'y':0.7,'width':0.98,'height':0.3},'ALBUM_SCREEN':{'x':0.18,'y':0.02,'width':0.8,'height':0.085},'SWIPE_UP_SCREEN':{'x':0.01,'y':0.5,'width':0.5,'height':0.1},'WARNING_TRANSACTION':{'x':0.14,'y':0.39,'width':0.72,'height':0.2},'OTP_ENTER_OR_CONTINUE_TRANSFER':{'x':0.03,'y':0.1,'width':0.95,'height':0.5},'CONFIRM_AFTER_OTP':{'x':0.03,'y':0.5,'width':0.95,'height':0.2},'BOTTOM_BILL':{'x':0.03,'y':0.8,'width':0.9,'height':0.1}};},(_0x30e17a,_0x1e7d95)=>{const _0x2ffcde=a0_0x2e92;Object['defineProperty'](_0x1e7d95,'__esModule',{'value':!0x0}),_0x1e7d95['PG_ROI_EXPECTED']=void 0x0,_0x1e7d95[_0x2ffcde(0x18a)]={'LAUNCH_APP':{'x':0.04,'y':0.53,'width':0.73,'height':0.078},'VERIFY_ACCOUNT_NAME':{'x':0.04,'y':0.45,'width':0.81,'height':0.18},'TRANSACTION_CONFIRM':{'x':0.085,'y':0.023,'width':0.8,'height':0.08},'TRANSACTION_VERIFY':{'x':0.085,'y':0.023,'width':0.8,'height':0.08},'TRANSACTION_SUCCESS':{'x':0.06,'y':0.212,'width':0.88,'height':0.1},'HOME_SCREEN':{'x':0.02,'y':0.7,'width':0.98,'height':0.3},'ALBUM_SCREEN':{'x':0.18,'y':0.02,'width':0.8,'height':0.085}};},(_0x234042,_0xfc8de6)=>{const _0x2413d0=a0_0x2e92;Object['defineProperty'](_0xfc8de6,'__esModule',{'value':!0x0}),_0xfc8de6[_0x2413d0(0x26f)]=void 0x0,_0xfc8de6['VCB_ROI_EXPECTED']={'LAUNCH_APP':{'x':0.3,'y':0.5,'width':0.4,'height':0.1},'VERIFY_ACCOUNT_NUMBER':{'x':0.05,'y':0.45,'width':0.9,'height':0.2},'VERIFY_ACCOUNT_NAME':{'x':0.05,'y':0.55,'width':0.8,'height':0.1},'OTP_ENTER':{'x':0.1,'y':0.5,'width':0.4,'height':0.1},'OTP_VERIFY':{'x':0.1,'y':0.4,'width':0.5,'height':0.1},'TRANSACTION_VERIFY':{'x':0.5,'y':0.1,'width':0.4,'height':0.1},'TRANSACTION_SUCCESS':{'x':0.2,'y':0.2,'width':0.6,'height':0.1},'HOME_SCREEN':{'x':0.02,'y':0.55,'width':0.5,'height':0.1},'ALBUM_SCREEN':{'x':0.02,'y':0.02,'width':0.98,'height':0.2}};},(_0x5277f7,_0x9df8e2,_0x284c3b)=>{const _0x185058=a0_0x2e92;Object[_0x185058(0x3cc)](_0x9df8e2,'__esModule',{'value':!0x0}),_0x9df8e2['NUMPAD_LAYOUT']=_0x9df8e2[_0x185058(0x26e)]=_0x9df8e2['COMMON_COORDINATES']=_0x9df8e2[_0x185058(0x285)]=void 0x0;const _0x146f11=_0x284c3b(0x11);_0x9df8e2['scaleCoordinates']=(_0x634ad8,_0x4b5763=0x64)=>Object['fromEntries'](Object[_0x185058(0x187)](_0x634ad8)['map'](([_0x4eaba7,_0xcad0c2])=>[_0x4eaba7,{'x':Math['round'](_0xcad0c2['x']*_0x4b5763),'y':Math['round'](_0xcad0c2['y']*_0x4b5763)}]));const _0x380116={0x0:{'x':0.55,'y':0.95},0x1:{'x':0.25,'y':0.7},0x2:{'x':0.55,'y':0.7},0x3:{'x':0.85,'y':0.7},0x4:{'x':0.25,'y':0.8},0x5:{'x':0.55,'y':0.8},0x6:{'x':0.85,'y':0.8},0x7:{'x':0.25,'y':0.9},0x8:{'x':0.55,'y':0.9},0x9:{'x':0.85,'y':0.9}},_0x27e9b9={'KEYBOARD_SWITCH':{'x':0.05,'y':0.95},'SHIFT_KEY':{'x':0.05,'y':0.88},'RETURN_KEY':{'x':0.95,'y':0.95}},_0x5a3693=(0x0,_0x9df8e2[_0x185058(0x285)])(_0x27e9b9),_0x36bd60=(0x0,_0x9df8e2['scaleCoordinates'])(_0x380116);_0x9df8e2[_0x185058(0x1c4)]='PANDA'===_0x146f11['config']['boxType']?_0x5a3693:_0x27e9b9,_0x9df8e2['KEYBOARD_LAYOUT']={0x0:{'x':0.95,'y':0.68},0x1:{'x':0.05,'y':0.68},0x2:{'x':0.15,'y':0.68},0x3:{'x':0.25,'y':0.68},0x4:{'x':0.35,'y':0.68},0x5:{'x':0.45,'y':0.68},0x6:{'x':0.55,'y':0.68},0x7:{'x':0.65,'y':0.68},0x8:{'x':0.75,'y':0.68},0x9:{'x':0.85,'y':0.68},'@':{'x':0.85,'y':0.78},'!':{'x':0.65,'y':0.88},'a':{'x':0.1,'y':0.78},'b':{'x':0.6,'y':0.88},'c':{'x':0.4,'y':0.88},'d':{'x':0.3,'y':0.78},'e':{'x':0.25,'y':0.68},'f':{'x':0.4,'y':0.78},'g':{'x':0.5,'y':0.78},'h':{'x':0.6,'y':0.78},'i':{'x':0.75,'y':0.68},'j':{'x':0.7,'y':0.78},'k':{'x':0.8,'y':0.78},'l':{'x':0.9,'y':0.78},'m':{'x':0.8,'y':0.88},'n':{'x':0.7,'y':0.88},'o':{'x':0.85,'y':0.68},'p':{'x':0.95,'y':0.68},'q':{'x':0.05,'y':0.68},'r':{'x':0.35,'y':0.68},'s':{'x':0.2,'y':0.78},'t':{'x':0.45,'y':0.68},'u':{'x':0.65,'y':0.68},'v':{'x':0.5,'y':0.88},'w':{'x':0.15,'y':0.68},'x':{'x':0.3,'y':0.88},'y':{'x':0.55,'y':0.68},'z':{'x':0.2,'y':0.88},'\x20':{'x':0.55,'y':0.95}},_0x9df8e2['NUMPAD_LAYOUT']='PANDA'===_0x146f11['config']['boxType']?_0x36bd60:_0x380116;},(_0x474c36,_0x4239ea,_0x1715a5)=>{const _0x43fe7d=a0_0x2e92;Object['defineProperty'](_0x4239ea,'__esModule',{'value':!0x0}),_0x4239ea[_0x43fe7d(0x15a)]=void 0x0;const _0x5cab4f=_0x1715a5(0x11),_0x3042aa={'LOGIN_BUTTON':{'x':0.5,'y':0.8},'LOGIN_BUTTON_API':{'x':0.5,'y':0.62},'PASSWORD_FIELD':{'x':0.5,'y':0.45}},_0x14e468=(0x0,_0x1715a5(0x26)[_0x43fe7d(0x285)])(_0x3042aa);_0x4239ea['ACB_UI_COORDINATES']='PANDA'===_0x5cab4f['config']['boxType']?_0x14e468:_0x3042aa;},function(_0x503f82,_0x48edac,_0x2c6eb4){const _0x5aa327=a0_0x2e92;var _0x50e4e0,_0x369000,_0xd47b41,_0x18dcba,_0x46d74d,_0x455077=this&&this['__decorate']||function(_0x4bc0cf,_0x2809ba,_0x644eca,_0x21f91b){const _0x102d50=a0_0x2e92;var _0x4624c7,_0x3ac8ba=arguments[_0x102d50(0x1fe)],_0x47b154=_0x3ac8ba<0x3?_0x2809ba:null===_0x21f91b?_0x21f91b=Object['getOwnPropertyDescriptor'](_0x2809ba,_0x644eca):_0x21f91b;if(_0x102d50(0x141)==typeof Reflect&&'function'==typeof Reflect[_0x102d50(0x3b0)])_0x47b154=Reflect[_0x102d50(0x3b0)](_0x4bc0cf,_0x2809ba,_0x644eca,_0x21f91b);else{for(var _0x4a1756=_0x4bc0cf[_0x102d50(0x1fe)]-0x1;_0x4a1756>=0x0;_0x4a1756--)(_0x4624c7=_0x4bc0cf[_0x4a1756])&&(_0x47b154=(_0x3ac8ba<0x3?_0x4624c7(_0x47b154):_0x3ac8ba>0x3?_0x4624c7(_0x2809ba,_0x644eca,_0x47b154):_0x4624c7(_0x2809ba,_0x644eca))||_0x47b154);}return _0x3ac8ba>0x3&&_0x47b154&&Object['defineProperty'](_0x2809ba,_0x644eca,_0x47b154),_0x47b154;},_0x430aa9=this&&this[_0x5aa327(0x3c1)]||function(_0x2fb111,_0x178530){const _0x46dc99=_0x5aa327;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x46dc99(0x3ac)])return Reflect['metadata'](_0x2fb111,_0x178530);},_0x51f139=this&&this['__param']||function(_0x25b329,_0x513468){return function(_0x39a9fb,_0x15feff){_0x513468(_0x39a9fb,_0x15feff,_0x25b329);};};Object[_0x5aa327(0x3cc)](_0x48edac,_0x5aa327(0x110),{'value':!0x0}),_0x48edac['PgService']=void 0x0;const _0x28c4bd=_0x2c6eb4(0x2),_0x20a246=_0x2c6eb4(0xe),_0x4ac76f=_0x2c6eb4(0x17),_0x2fa501=_0x2c6eb4(0x13),_0x29966f=_0x2c6eb4(0xd),_0x3cca1d=_0x2c6eb4(0x18),_0x523a94=_0x2c6eb4(0x29),_0x3cc1b1=_0x2c6eb4(0x1b),_0x1f6e58=_0x2c6eb4(0x2a),_0x33fa95=_0x2c6eb4(0x24),_0x334da8=_0x2c6eb4(0x2b),_0x39e230=_0x2c6eb4(0x2c),_0x7babb1=_0x2c6eb4(0x1e);let _0xde4aa9=class extends _0x4ac76f[_0x5aa327(0x271)]{constructor(_0x2fb8a3,_0xc14c96,_0x1a82dd,_0x413a1e,_0x42b892){const _0x2061ff=_0x5aa327;super(_0x2fb8a3,_0xc14c96,_0x1a82dd,_0x413a1e),this[_0x2061ff(0x2e6)]=_0x2fb8a3,this['telegramService']=_0x42b892,this[_0x2061ff(0xff)]='PGBANK',this['BUNDLE_ID']='pgbankApp.pgbank.com.vn';}async[_0x5aa327(0x34b)](_0x4540a8){const _0xf3b621=_0x5aa327,_0x3b7e1e=await this[_0xf3b621(0x25e)]['getDeviceConfig'](_0x4540a8);if(!_0x3b7e1e||!_0x3b7e1e['password'])throw new Error(_0xf3b621(0x28a)+_0x4540a8);await this['clickWithTransition'](_0x4540a8,_0x523a94[_0xf3b621(0x325)]['PASSWORD_FIELD']['x'],_0x523a94['PG_UI_COORDINATES'][_0xf3b621(0x247)]['y'],0x5dc),await this['wsService']['inputText'](_0x4540a8,_0x3b7e1e['password']),await(0x0,_0x3cca1d['sleep'])(0x3e8),await this['wsService']['pressReturnKey'](_0x4540a8);}async[_0x5aa327(0x3c7)](_0x318590,_0x152ea4=0x3){const _0x106af5=_0x5aa327,_0x17c117=await this['deviceService']['getDeviceConfig'](_0x318590);if(!_0x17c117||!_0x17c117['smartOTP'])throw new Error(_0x106af5(0x252)+_0x318590);await(0x0,_0x3cca1d[_0x106af5(0x26c)])(0x7d0),await this['wsService']['inputText'](_0x318590,_0x17c117[_0x106af5(0x350)]);}async['launchApp'](_0x5df896){const _0x432233=_0x5aa327;if(await this[_0x432233(0x2e6)]['launchApp'](_0x5df896,this['BUNDLE_ID']),!await this['verifyScreenState'](_0x5df896,{'expectedTexts':['ƒêƒÉng\x20nh·∫≠p'],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x33fa95['PG_ROI_EXPECTED']['LAUNCH_APP'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1f6e58['WithdrawalProcessingError']('Failed\x20to\x20launch\x20PGBank\x20app',_0x1f6e58['ErrorType']['FORCE_LOGIN']);this[_0x432233(0x1fd)]['log']('['+_0x5df896+']\x20-\x20Get\x20login\x20app\x20screen');}async[_0x5aa327(0x3ca)](_0x3ffeb5){const _0x1c7c79=_0x5aa327;if(await this['killApp'](_0x3ffeb5),await(0x0,_0x3cca1d['sleep'])(0x3e8),await this[_0x1c7c79(0x1e8)](_0x3ffeb5),await(0x0,_0x3cca1d[_0x1c7c79(0x26c)])(0x3e8),await this['inputPasswordFromConfig'](_0x3ffeb5),!await this[_0x1c7c79(0x3b9)](_0x3ffeb5,_0x523a94[_0x1c7c79(0x325)]['LOGIN_BTN']['x'],_0x523a94['PG_UI_COORDINATES'][_0x1c7c79(0x2db)]['y'],{'expectedTexts':['t√†i\x20kho·∫£n',_0x1c7c79(0x397),'ti·∫øt\x20ki·ªám'],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x33fa95['PG_ROI_EXPECTED']['HOME_SCREEN']}))throw this['telegramService']['sendMessage']({'text':'‚ùå\x20Login\x20Error\x0a\x0a<b>Device:</b>\x20'+_0x3ffeb5+'\x0a<b>Error:</b>\x20Kh√¥ng\x20th·ªÉ\x20ƒëƒÉng\x20nh·∫≠p\x20v√†o\x20app\x20PGBank.','options':{'parseMode':'HTML'}}),new _0x1f6e58[(_0x1c7c79(0x22d))](_0x1c7c79(0x1bf),_0x1f6e58[_0x1c7c79(0x123)]['FORCE_LOGIN']);this['logger']['log']('['+_0x3ffeb5+']\x20-\x20Login\x20successfully');}async['executeTransferWithQRCode'](_0x245198,_0x17a951){const _0x52538b=_0x5aa327;if(this['logger']['log'](_0x52538b(0x235)+_0x245198['withdrawalId']+'\x20on\x20device\x20'+_0x17a951['deviceId']),await this['clickWithTransition'](_0x17a951[_0x52538b(0x14b)],_0x523a94['PG_UI_COORDINATES']['QR_CODE_BTN']['x'],_0x523a94['PG_UI_COORDINATES'][_0x52538b(0x153)]['y'],0x1388),!await this['clickAndWaitForScreen'](_0x17a951['deviceId'],_0x523a94['PG_UI_COORDINATES'][_0x52538b(0x2bb)]['x'],_0x523a94['PG_UI_COORDINATES']['IMAGE_LIBRARY_BTN']['y'],{'expectedTexts':[_0x52538b(0x2af)],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x33fa95['PG_ROI_EXPECTED']['ALBUM_SCREEN']}))throw new _0x1f6e58['WithdrawalProcessingError']('['+_0x17a951['accountName']+_0x52538b(0x3e0),_0x1f6e58['ErrorType']['FORCE_LOGIN']);this['logger']['log']('['+_0x17a951[_0x52538b(0x1f4)]+_0x52538b(0x3c6)),await this['clickWithTransition'](_0x17a951['deviceId'],_0x523a94['PG_UI_COORDINATES']['FIRST_IMAGE_BTN']['x'],_0x523a94['PG_UI_COORDINATES']['FIRST_IMAGE_BTN']['y'],0x7d0);let _0x385223=!0x1;if(_0x385223=_0x245198['bankCode']===_0x334da8['BankCodeWithdrawal']['PGBANK']?await this['clickAndWaitForScreen'](_0x17a951[_0x52538b(0x14b)],_0x523a94['PG_UI_COORDINATES'][_0x52538b(0xfe)]['x'],_0x523a94['PG_UI_COORDINATES'][_0x52538b(0xfe)]['y'],{'expectedTexts':[_0x245198['beneficiaryName']],'timeout':0x4e20,'pollInterval':0x1f4,'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}):await this[_0x52538b(0x3b9)](_0x17a951['deviceId'],_0x523a94['PG_UI_COORDINATES']['SELECT_IMAGE_QR_CODE_BTN']['x'],_0x523a94['PG_UI_COORDINATES']['SELECT_IMAGE_QR_CODE_BTN']['y'],{'expectedTexts':[_0x245198['beneficiaryName']],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x33fa95['PG_ROI_EXPECTED']['VERIFY_ACCOUNT_NAME'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}),!_0x385223)throw new _0x1f6e58['WithdrawalProcessingError'](_0x52538b(0x3a6),_0x1f6e58['ErrorType']['FORCE_LOGIN']);if(this['logger']['log']('['+_0x17a951['accountName']+_0x52538b(0x3bf)),!await this['clickAndWaitForScreen'](_0x17a951['deviceId'],_0x523a94['PG_UI_COORDINATES'][_0x52538b(0x361)]['x'],_0x523a94[_0x52538b(0x325)]['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['X√°c\x20nh·∫≠n\x20giao\x20d·ªãch'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x33fa95['PG_ROI_EXPECTED'][_0x52538b(0x246)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1f6e58[(_0x52538b(0x22d))]('Transaction\x20confirm\x20screen\x20not\x20found',_0x1f6e58['ErrorType'][_0x52538b(0x1be)]);if(this[_0x52538b(0x1fd)][_0x52538b(0x2d5)]('['+_0x17a951[_0x52538b(0x1f4)]+']\x20-\x20Get\x20Transaction\x20confirm\x20screen'),!await this['clickAndWaitForScreen'](_0x17a951[_0x52538b(0x14b)],_0x523a94[_0x52538b(0x325)]['CONTINUE_TRANSFER_BTN']['x'],_0x523a94['PG_UI_COORDINATES'][_0x52538b(0x361)]['y'],{'expectedTexts':[_0x52538b(0x201)],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x33fa95['PG_ROI_EXPECTED'][_0x52538b(0x25f)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1f6e58[(_0x52538b(0x22d))]('Transaction\x20verification\x20screen\x20not\x20found',_0x1f6e58['ErrorType']['FORCE_LOGIN']);if(this['logger'][_0x52538b(0x2d5)]('['+_0x17a951['accountName']+_0x52538b(0x299)),await this[_0x52538b(0x3c7)](_0x17a951[_0x52538b(0x14b)]),!await this[_0x52538b(0x19c)](_0x17a951['deviceId'],{'expectedTexts':['Chuy·ªÉn\x20ti·ªÅn\x20th√†nh\x20c√¥ng'],'timeout':0xea60,'pollInterval':0x1f4,'roi':_0x33fa95['PG_ROI_EXPECTED']['TRANSACTION_SUCCESS'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1f6e58['WithdrawalProcessingError']('Transaction\x20success\x20screen\x20not\x20found',_0x1f6e58['ErrorType']['NO_BILL_AFTER_OTP']);this['logger'][_0x52538b(0x2d5)]('['+_0x17a951[_0x52538b(0x1f4)]+']\x20-\x20Get\x20Transaction\x20success\x20screen'),await(0x0,_0x3cca1d[_0x52538b(0x26c)])(0x1f4),await this[_0x52538b(0x341)](_0x17a951['deviceId'],{'folderPath':_0x245198[_0x52538b(0xf8)]}),await this['clickWithTransition'](_0x17a951['deviceId'],_0x523a94['PG_UI_COORDINATES'][_0x52538b(0x3ec)]['x'],_0x523a94['PG_UI_COORDINATES']['BACK_TO_HOME']['y'],0x1388,'['+_0x17a951['accountName']+_0x52538b(0x161));}async['extractTransactionAmount'](_0x4ba0cf){const _0x2544ea=_0x5aa327;try{const _0x10f9f2=await this['ocrService']['recognizeFromFile'](_0x4ba0cf,{'fieldType':'singleLine','customROI':{'x':0.05,'y':0.75,'width':0.9,'height':0.12},'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x10f9f2)return this['logger']['warn'](_0x2544ea(0x10e)),null;const _0x25a4e5=_0x10f9f2[_0x2544ea(0x209)][_0x2544ea(0x159)](/[^\d.,]/g,'')['replace'](/,/g,''),_0x187425=parseFloat(_0x25a4e5);return isNaN(_0x187425)?(this[_0x2544ea(0x1fd)]['warn'](_0x2544ea(0x1e9)+_0x10f9f2['text']),null):(this['logger'][_0x2544ea(0x2d5)](_0x2544ea(0x1ba)+_0x187425['toLocaleString']('vi-VN')+_0x2544ea(0x286)+_0x10f9f2['confidence'][_0x2544ea(0x386)](0x2)+'%,\x20time:\x20'+_0x10f9f2[_0x2544ea(0x182)]+'ms)'),_0x187425);}catch(_0x48b68f){return this['logger']['error'](_0x2544ea(0x1d7)+_0x48b68f['message'],_0x48b68f[_0x2544ea(0x3d6)]),null;}}async[_0x5aa327(0x1d3)](){}[_0x5aa327(0x120)](){}};_0x48edac['PgService']=_0xde4aa9,_0x48edac['PgService']=_0xde4aa9=_0x455077([(0x0,_0x28c4bd[_0x5aa327(0x19b)])(),_0x51f139(0x0,(0x0,_0x28c4bd[_0x5aa327(0x33a)])(_0x29966f['WEBSOCKET_SERVICE'])),_0x430aa9(_0x5aa327(0x22c),[_0x5aa327(0x18d)==typeof(_0x50e4e0=void 0x0!==_0x2fa501['IWebSocketService']&&_0x2fa501['IWebSocketService'])?_0x50e4e0:Object,_0x5aa327(0x18d)==typeof(_0x369000=void 0x0!==_0x20a246['DeviceService']&&_0x20a246['DeviceService'])?_0x369000:Object,'function'==typeof(_0xd47b41=void 0x0!==_0x3cc1b1['OCRService']&&_0x3cc1b1['OCRService'])?_0xd47b41:Object,_0x5aa327(0x18d)==typeof(_0x18dcba=void 0x0!==_0x7babb1[_0x5aa327(0x1d5)]&&_0x7babb1['ImagePreprocessingService'])?_0x18dcba:Object,_0x5aa327(0x18d)==typeof(_0x46d74d=void 0x0!==_0x39e230['TelegramService']&&_0x39e230['TelegramService'])?_0x46d74d:Object])],_0xde4aa9);},(_0x4da77d,_0x596fe4,_0x46ffad)=>{const _0x12a563=a0_0x2e92;Object['defineProperty'](_0x596fe4,_0x12a563(0x110),{'value':!0x0}),_0x596fe4['PG_UI_COORDINATES']=void 0x0;const _0xe713c5=_0x46ffad(0x11),_0xd43198={'LOGIN_BTN':{'x':0.5,'y':0.6},'PASSWORD_FIELD':{'x':0.5,'y':0.435},'TRANSFER_BTN':{'x':0.7,'y':0.7},'TRANSFER_INTERNAL_BTN':{'x':0.2,'y':0.2},'TRANSFER_EXTERNAL_BTN':{'x':0.4,'y':0.2},'CLOSE_ALLOW_CONTACT_POPUP_BTN':{'x':0.3,'y':0.6},'ACCOUNT_NUMBER_INPUT':{'x':0.4,'y':0.43},'SELECT_BANK_BTN':{'x':0.4,'y':0.47},'SEARCH_BANK_BTN':{'x':0.4,'y':0.48},'INTERNAL_AMOUNT_INPUT':{'x':0.5,'y':0.6},'HIDE_NUMPAD_BTN':{'x':0.05,'y':0.4},'CONTINUE_TRANSFER_BTN':{'x':0.5,'y':0.9},'BANK_SEARCH_BTN':{'x':0.4,'y':0.45},'BANK_SEARCH_INPUT':{'x':0.4,'y':0.45},'EXTERNAL_AMOUNT_INPUT':{'x':0.3,'y':0.37},'BACK_TO_HOME':{'x':0.2,'y':0.9},'QR_CODE_BTN':{'x':0.2,'y':0.9},'IMAGE_LIBRARY_BTN':{'x':0.8,'y':0.9},'FIRST_IMAGE_BTN':{'x':0.3,'y':0.3},'SELECT_IMAGE_QR_CODE_BTN':{'x':0.95,'y':0.95},'HOME_ICON_HEADER':{'x':0.95,'y':0.05}},_0x4b2c7d=(0x0,_0x46ffad(0x26)['scaleCoordinates'])(_0xd43198);_0x596fe4[_0x12a563(0x325)]='PANDA'===_0xe713c5['config']['boxType']?_0x4b2c7d:_0xd43198;},(_0x558d0c,_0x4cf42a)=>{const _0x313e9b=a0_0x2e92;var _0x4169b1;Object[_0x313e9b(0x3cc)](_0x4cf42a,'__esModule',{'value':!0x0}),_0x4cf42a['WithdrawalProcessingError']=_0x4cf42a['ErrorType']=void 0x0,function(_0x45f7c9){const _0xe95251=_0x313e9b;_0x45f7c9[_0xe95251(0x199)]='TEMPORARY',_0x45f7c9['PERMANENT']='PERMANENT',_0x45f7c9['FORCE_LOGIN']=_0xe95251(0x1be),_0x45f7c9['NO_BILL_AFTER_OTP']='NO_BILL_AFTER_OTP';}(_0x4169b1||(_0x4cf42a[_0x313e9b(0x123)]=_0x4169b1={}));class _0x585019 extends Error{constructor(_0x1e5a22,_0x334bcd){const _0x666361=_0x313e9b;super(_0x1e5a22),this['errorType']=_0x334bcd,this[_0x666361(0x104)]='WithdrawalProcessingError',Error['captureStackTrace'](this,this['constructor']);}}_0x4cf42a[_0x313e9b(0x22d)]=_0x585019;},(_0x3366a4,_0x477864)=>{var _0x13aa3b;Object['defineProperty'](_0x477864,'__esModule',{'value':!0x0}),_0x477864['BankCodeWithdrawal']=void 0x0,function(_0x1ee8b0){const _0x1c505d=a0_0x2e92;_0x1ee8b0['VIETCOMBANK']='VIETCOMBANK',_0x1ee8b0['AGRIBANK']=_0x1c505d(0x313),_0x1ee8b0['BIDV']='BIDV',_0x1ee8b0[_0x1c505d(0x36a)]='SACOMBANK',_0x1ee8b0[_0x1c505d(0x22f)]='TECHCOMBANK',_0x1ee8b0['TPBANK']=_0x1c505d(0x381),_0x1ee8b0['HDBank']='HDBank',_0x1ee8b0['VPBANK']='VPBANK',_0x1ee8b0['MBBANK']='MBBANK',_0x1ee8b0['MSB']=_0x1c505d(0xf7),_0x1ee8b0['LPBANK']='LPBANK',_0x1ee8b0[_0x1c505d(0x1df)]='ACB',_0x1ee8b0['ABBANK']='ABBANK',_0x1ee8b0['NCB']='NCB',_0x1ee8b0[_0x1c505d(0x2aa)]=_0x1c505d(0x2aa),_0x1ee8b0['SEABANK']='SEABANK',_0x1ee8b0['SCB']='SCB',_0x1ee8b0[_0x1c505d(0x38c)]='PVCOMBANK',_0x1ee8b0['KIENLONGBANK']=_0x1c505d(0x134),_0x1ee8b0[_0x1c505d(0x2c9)]='BVBANK',_0x1ee8b0['VIETINBANK']='VIETINBANK',_0x1ee8b0['OCB']='OCB',_0x1ee8b0['VIETBANK']=_0x1c505d(0x28e),_0x1ee8b0['SHB']=_0x1c505d(0x1e2),_0x1ee8b0[_0x1c505d(0x2c4)]=_0x1c505d(0x2c4),_0x1ee8b0[_0x1c505d(0x1c7)]='SHINHANBANKVIETNAM',_0x1ee8b0['CIMB']='CIMB',_0x1ee8b0['SAIGONBANK']='SAIGONBANK',_0x1ee8b0[_0x1c505d(0xe0)]='BACABANK',_0x1ee8b0['VIETABANK']='VIETABANK',_0x1ee8b0['GPBANK']=_0x1c505d(0x33d),_0x1ee8b0['HSBC']='HSBC',_0x1ee8b0['VRB']='VRB',_0x1ee8b0['VIB']='VIB',_0x1ee8b0['PGBANK']='PGBANK';}(_0x13aa3b||(_0x477864['BankCodeWithdrawal']=_0x13aa3b={}));},function(_0x3ef470,_0x7c29f8,_0x5ae275){const _0xac304=a0_0x2e92;var _0x2db434,_0x33d8d6=this&&this['__decorate']||function(_0x3af2bd,_0x106c0c,_0x48976f,_0x5b4693){const _0x3807ba=a0_0x2e92;var _0x446a3a,_0xb96b26=arguments['length'],_0x3a8573=_0xb96b26<0x3?_0x106c0c:null===_0x5b4693?_0x5b4693=Object[_0x3807ba(0x25c)](_0x106c0c,_0x48976f):_0x5b4693;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x3807ba(0x3b0)])_0x3a8573=Reflect['decorate'](_0x3af2bd,_0x106c0c,_0x48976f,_0x5b4693);else{for(var _0x6e656f=_0x3af2bd[_0x3807ba(0x1fe)]-0x1;_0x6e656f>=0x0;_0x6e656f--)(_0x446a3a=_0x3af2bd[_0x6e656f])&&(_0x3a8573=(_0xb96b26<0x3?_0x446a3a(_0x3a8573):_0xb96b26>0x3?_0x446a3a(_0x106c0c,_0x48976f,_0x3a8573):_0x446a3a(_0x106c0c,_0x48976f))||_0x3a8573);}return _0xb96b26>0x3&&_0x3a8573&&Object['defineProperty'](_0x106c0c,_0x48976f,_0x3a8573),_0x3a8573;},_0x495d8d=this&&this['__metadata']||function(_0x4ea2c2,_0x47fd88){const _0xd8e62f=a0_0x2e92;if(_0xd8e62f(0x141)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x4ea2c2,_0x47fd88);};Object['defineProperty'](_0x7c29f8,'__esModule',{'value':!0x0}),_0x7c29f8['TelegramService']=void 0x0;const _0x69cf79=_0x5ae275(0x18),_0x38121d=_0x5ae275(0x2),_0x3e22b3=_0x5ae275(0x2d),_0x29dd99=_0x5ae275(0x2e),_0x2fed4d=_0x5ae275(0x19);let _0x40103f=_0x2db434=class{constructor(){const _0x27ac99=a0_0x2e92;this[_0x27ac99(0x1fd)]=new _0x38121d['Logger'](_0x2db434['name']),this['token']='8514906447:AAGFB2Fsl21IeF1tJvt8y6UsuoyNCIVcwCE',this['defaultChatId']='-5288197652',this[_0x27ac99(0x37b)]='https://api.telegram.org',this['http']=_0x3e22b3['default']['create']({'baseURL':this['baseUrl']+_0x27ac99(0x345)+this[_0x27ac99(0x3a3)],'timeout':0x3a98});}async['sendMessage'](_0x555980){const _0x3c3b8e=a0_0x2e92,{text:_0x1a9cd9,chatId:_0x16ed59,options:_0x3ed8ff={}}=_0x555980,_0xa1c874=_0x16ed59??this['mustDefaultChatId']();this[_0x3c3b8e(0xe5)](_0x3c3b8e(0x16b),{'chat_id':_0xa1c874,'text':_0x1a9cd9,'parse_mode':_0x3ed8ff['parseMode']??'HTML','disable_web_page_preview':_0x3ed8ff['disableWebPagePreview']??!0x1,'disable_notification':_0x3ed8ff['disableNotification']??!0x1,'reply_to_message_id':_0x3ed8ff[_0x3c3b8e(0x30e)]??void 0x0})['catch'](_0x4fc6d8=>{const _0x1878b9=_0x3c3b8e;this['logger'][_0x1878b9(0xeb)](_0x1878b9(0x1f7),_0x4fc6d8['stack']);});}async['sendPhotoByUrl'](_0x450cd4,_0x1f8d7b=this[_0xac304(0x31b)](),_0x265a9a={}){const _0x3306a6=_0xac304;await this[_0x3306a6(0xe5)](_0x3306a6(0x281),{'chat_id':_0x1f8d7b,'photo':_0x450cd4,'caption':_0x265a9a['caption'],'parse_mode':_0x265a9a['parseMode'],'disable_notification':_0x265a9a[_0x3306a6(0x2a5)]});}async['sendPhotoByFile'](_0x49bbbc,_0x3a55dd=this['mustDefaultChatId'](),_0x4cb26b={}){const _0x3822ee=_0xac304;try{const _0x18bdb8=(0x0,_0x2fed4d[_0x3822ee(0x1e6)])(_0x49bbbc),_0x5efca4=new _0x29dd99[(_0x3822ee(0x3d9))]();_0x5efca4['append']('chat_id',String(_0x3a55dd)),_0x5efca4['append']('photo',_0x18bdb8),_0x4cb26b['caption']&&_0x5efca4['append'](_0x3822ee(0x34c),_0x4cb26b['caption']),_0x4cb26b[_0x3822ee(0x328)]&&_0x5efca4['append']('parse_mode',_0x4cb26b['parseMode']),void 0x0!==_0x4cb26b['disableNotification']&&_0x5efca4[_0x3822ee(0xe8)](_0x3822ee(0x181),String(_0x4cb26b['disableNotification'])),await this['requestFormWithRetry']('/sendPhoto',_0x5efca4);}catch(_0x158f7c){this['logger']['error']('Error\x20sending\x20photo\x20by\x20file:\x20'+_0x158f7c[_0x3822ee(0x2a0)]);}}async['sendPhotoByBuffer'](_0x108cad,_0x57989b='image.png',_0x168a8f='image/png',_0x219c19=this['mustDefaultChatId'](),_0x2a2b1b={}){const _0x3fe4a8=_0xac304,_0x246b1f=new _0x29dd99['default']();_0x246b1f['append']('chat_id',String(_0x219c19)),_0x246b1f['append']('photo',_0x108cad,{'filename':_0x57989b,'contentType':_0x168a8f}),_0x2a2b1b[_0x3fe4a8(0x34c)]&&_0x246b1f['append']('caption',_0x2a2b1b['caption']),_0x2a2b1b[_0x3fe4a8(0x328)]&&_0x246b1f['append']('parse_mode',_0x2a2b1b['parseMode']),void 0x0!==_0x2a2b1b['disableNotification']&&_0x246b1f['append'](_0x3fe4a8(0x181),String(_0x2a2b1b['disableNotification'])),this[_0x3fe4a8(0x1ea)]('/sendPhoto',_0x246b1f)['catch'](_0x23942d=>{this['logger']['error']('Error\x20sending\x20telegram\x20photo',_0x23942d['stack']);});}async[_0xac304(0x132)](_0x55a287,_0x48d3e4='image.png',_0x15404a='image/png',_0x2a11f6=this[_0xac304(0x31b)](),_0x5779e1={}){const _0x65fe23=_0xac304,_0x9834a4=this['stripBase64Prefix'](_0x55a287),_0x96485e=Buffer[_0x65fe23(0x349)](_0x9834a4,'base64');await this['sendPhotoByBuffer'](_0x96485e,_0x48d3e4,_0x15404a,_0x2a11f6,_0x5779e1);}[_0xac304(0x31b)](){if(!this['defaultChatId'])throw new Error('TELEGRAM_DEFAULT_CHAT_ID\x20is\x20missing\x20and\x20no\x20chatId\x20was\x20provided.');return this['defaultChatId'];}[_0xac304(0x15e)](_0x20acfd){const _0x4cd75f=_0xac304,_0x2a4ee6=_0x20acfd[_0x4cd75f(0x32b)](_0x4cd75f(0x193));return _0x2a4ee6>=0x0?_0x20acfd['slice'](_0x2a4ee6+0x7):_0x20acfd;}async[_0xac304(0xe5)](_0x13ac4b,_0x46a154,_0x2bbb67=0x2){const _0x1ca864=_0xac304;try{const _0x2a50b3=await this[_0x1ca864(0x2cf)]['post'](_0x13ac4b,_0x46a154);if(!_0x2a50b3['data']?.['ok']){const _0x20cf8e=_0x2a50b3['data']?.[_0x1ca864(0x2b3)]??'Unknown\x20Telegram\x20error';throw new Error('Telegram\x20API\x20error:\x20'+_0x20cf8e);}}catch(_0x25c31d){if(_0x2bbb67>0x0&&this['isRetryable'](_0x25c31d)){const _0x11e741=this[_0x1ca864(0x25d)](_0x2bbb67);return this['logger']['warn']('Telegram\x20request\x20failed,\x20retrying\x20in\x20'+_0x11e741+'ms:\x20'+this['safeErr'](_0x25c31d)),await(0x0,_0x69cf79['sleep'])(_0x11e741),this['requestWithRetry'](_0x13ac4b,_0x46a154,_0x2bbb67-0x1);}throw this[_0x1ca864(0x1fd)][_0x1ca864(0xeb)]('Telegram\x20request\x20failed:\x20'+this[_0x1ca864(0x130)](_0x25c31d)),_0x25c31d;}}async[_0xac304(0x1ea)](_0x4dae2b,_0x55717d,_0x3c0330=0x2){const _0x1cda39=_0xac304;try{const _0x45f7c1=await this[_0x1cda39(0x2cf)]['post'](_0x4dae2b,_0x55717d,{'headers':_0x55717d['getHeaders'](),'maxBodyLength':0x1/0x0,'maxContentLength':0x1/0x0});if(!_0x45f7c1['data']?.['ok']){const _0x1da769=_0x45f7c1['data']?.[_0x1cda39(0x2b3)]??'Unknown\x20Telegram\x20error';throw new Error(_0x1cda39(0x12e)+_0x1da769);}}catch(_0x34e197){if(_0x3c0330>0x0&&this['isRetryable'](_0x34e197)){const _0x5cde1d=this['backoffMs'](_0x3c0330);return this['logger']['warn'](_0x1cda39(0x2ed)+_0x5cde1d+'ms:\x20'+this['safeErr'](_0x34e197)),await(0x0,_0x69cf79['sleep'])(_0x5cde1d),this[_0x1cda39(0x1ea)](_0x4dae2b,_0x55717d,_0x3c0330-0x1);}this['logger']['error']('Telegram\x20form\x20request\x20failed:\x20'+this['safeErr'](_0x34e197));}}[_0xac304(0x277)](_0x4910f9){const _0x390c39=_0xac304,_0xdbf6a8=_0x4910f9?.['code'],_0x59f200=_0x4910f9?.[_0x390c39(0x28f)]?.['status'];return'ECONNABORTED'===_0xdbf6a8||_0x59f200>=0x1f4&&_0x59f200<=0x257||!(_0x59f200||'ENOTFOUND'!==_0xdbf6a8&&'ECONNRESET'!==_0xdbf6a8&&'EAI_AGAIN'!==_0xdbf6a8);}['backoffMs'](_0x460d5d){return 0x190*(0x2-_0x460d5d+0x1);}['safeErr'](_0x1eaf72){const _0x1c4a49=_0xac304,_0x17e88e=_0x1eaf72?.[_0x1c4a49(0x28f)]?.['status'],_0x239bc8=_0x1eaf72?.[_0x1c4a49(0x28f)]?.['data']?.[_0x1c4a49(0x2b3)],_0x55f2cf=_0x1eaf72?.['message'];return[_0x17e88e?_0x1c4a49(0x1d1)+_0x17e88e:'',_0x239bc8?'desc='+_0x239bc8:'',_0x55f2cf?_0x1c4a49(0xe4)+_0x55f2cf:'']['filter'](Boolean)[_0x1c4a49(0x3ed)](_0x1c4a49(0x398));}};_0x7c29f8['TelegramService']=_0x40103f,_0x7c29f8['TelegramService']=_0x40103f=_0x2db434=_0x33d8d6([(0x0,_0x38121d[_0xac304(0x19b)])(),_0x495d8d('design:paramtypes',[])],_0x40103f);},_0x5241a6=>{_0x5241a6['exports']=require('axios');},_0x478dd7=>{const _0x2b7899=a0_0x2e92;_0x478dd7[_0x2b7899(0x29f)]=require('form-data');},function(_0x3366dd,_0x1bb667,_0xbe45b0){const _0x596bc8=a0_0x2e92;var _0x373cb8,_0x593636,_0x43016d,_0x2c4327,_0x490499=this&&this['__decorate']||function(_0x40641b,_0x2ff720,_0xa23f29,_0xa401ab){const _0x548058=a0_0x2e92;var _0x13d25a,_0x5cea4d=arguments['length'],_0x3f8703=_0x5cea4d<0x3?_0x2ff720:null===_0xa401ab?_0xa401ab=Object[_0x548058(0x25c)](_0x2ff720,_0xa23f29):_0xa401ab;if(_0x548058(0x141)==typeof Reflect&&_0x548058(0x18d)==typeof Reflect[_0x548058(0x3b0)])_0x3f8703=Reflect['decorate'](_0x40641b,_0x2ff720,_0xa23f29,_0xa401ab);else{for(var _0x1cac4b=_0x40641b['length']-0x1;_0x1cac4b>=0x0;_0x1cac4b--)(_0x13d25a=_0x40641b[_0x1cac4b])&&(_0x3f8703=(_0x5cea4d<0x3?_0x13d25a(_0x3f8703):_0x5cea4d>0x3?_0x13d25a(_0x2ff720,_0xa23f29,_0x3f8703):_0x13d25a(_0x2ff720,_0xa23f29))||_0x3f8703);}return _0x5cea4d>0x3&&_0x3f8703&&Object['defineProperty'](_0x2ff720,_0xa23f29,_0x3f8703),_0x3f8703;},_0x1026ab=this&&this['__metadata']||function(_0x3d7048,_0x5d3d46){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x3d7048,_0x5d3d46);},_0x575367=this&&this[_0x596bc8(0x3e5)]||function(_0xd7ad29,_0x28ae72){return function(_0x23dd4f,_0x19775d){_0x28ae72(_0x23dd4f,_0x19775d,_0xd7ad29);};};Object['defineProperty'](_0x1bb667,'__esModule',{'value':!0x0}),_0x1bb667['HdBankService']=void 0x0;const _0x3b6513=_0xbe45b0(0xd),_0x41b3e5=_0xbe45b0(0x13),_0x40c407=_0xbe45b0(0x18),_0x2f98e5=_0xbe45b0(0x2),_0x119140=_0xbe45b0(0xe),_0x4332ee=_0xbe45b0(0x17),_0x4c7680=_0xbe45b0(0x1b),_0x3ea64a=_0xbe45b0(0x2a),_0x1068e6=_0xbe45b0(0x2b),_0x3aba3f=_0xbe45b0(0x30),_0x678987=_0xbe45b0(0x23),_0x15d293=_0xbe45b0(0x31),_0xbf3cdf=_0xbe45b0(0x1e);let _0x185d59=class extends _0x4332ee['BaseBankService']{constructor(_0x4de70e,_0x527367,_0x44f2e3,_0x3e184e){const _0x295e01=_0x596bc8;super(_0x4de70e,_0x527367,_0x44f2e3,_0x3e184e),this['wsService']=_0x4de70e,this[_0x295e01(0xff)]='HDBANK',this['BUNDLE_ID']=_0x295e01(0x291);}async['inputPasswordFromConfig'](_0x2694f1){const _0xf21fd=_0x596bc8,_0x52a8f5=await this['deviceService'][_0xf21fd(0x2de)](_0x2694f1);if(!_0x52a8f5||!_0x52a8f5[_0xf21fd(0xda)])throw new Error('Password\x20not\x20configured\x20for\x20device\x20'+_0x2694f1);await this['clickWithTransition'](_0x2694f1,_0x3aba3f['HD_UI_COORDINATES']['PASSWORD_FIELD']['x'],_0x3aba3f['HD_UI_COORDINATES']['PASSWORD_FIELD']['y'],0x5dc),await this['wsService'][_0xf21fd(0x12c)](_0x2694f1,_0x52a8f5['password']),await(0x0,_0x40c407[_0xf21fd(0x26c)])(0x3e8);}async['inputSmartOTPFromConfig'](_0x12afef,_0x23d66b=0x3){const _0x5c1480=_0x596bc8,_0x38f047=await this['deviceService']['getDeviceConfig'](_0x12afef);if(!_0x38f047||!_0x38f047[_0x5c1480(0x350)])throw new Error('SmartOTP\x20not\x20configured\x20for\x20device\x20'+_0x12afef);await(0x0,_0x40c407['sleep'])(0x1f4),await this['wsService']['inputText'](_0x12afef,_0x38f047['smartOTP']);}async[_0x596bc8(0x1e8)](_0x5dd42e){const _0x168e43=_0x596bc8;if(await this['wsService'][_0x168e43(0x1e8)](_0x5dd42e,this[_0x168e43(0x269)]),!await this[_0x168e43(0x19c)](_0x5dd42e,{'expectedTexts':[_0x168e43(0x26a)],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x678987[_0x168e43(0x2d7)]['LAUNCH_APP'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x3ea64a['WithdrawalProcessingError']('Failed\x20to\x20launch\x20PGBank\x20app',_0x3ea64a[_0x168e43(0x123)]['FORCE_LOGIN']);this['logger']['log']('['+_0x5dd42e+_0x168e43(0x23d));}async['login'](_0x44965f){const _0x3ddcd5=_0x596bc8;if(await this[_0x3ddcd5(0x262)](_0x44965f),await(0x0,_0x40c407[_0x3ddcd5(0x26c)])(0x7d0),await this['launchApp'](_0x44965f),await this[_0x3ddcd5(0x34b)](_0x44965f),!await this['clickAndWaitForScreen'](_0x44965f,_0x3aba3f[_0x3ddcd5(0xed)]['LOGIN_BTN']['x'],_0x3aba3f[_0x3ddcd5(0xed)]['LOGIN_BTN']['y'],{'expectedTexts':['t√†i\x20kho·∫£n','chuy·ªÉn\x20kho·∫£n'],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x678987[_0x3ddcd5(0x2d7)]['HOME_SCREEN']}))throw new _0x3ea64a['WithdrawalProcessingError']('Failed\x20to\x20login\x20to\x20PGBank',_0x3ea64a[_0x3ddcd5(0x123)]['FORCE_LOGIN']);this['logger'][_0x3ddcd5(0x2d5)]('['+_0x44965f+']\x20-\x20Login\x20successfully');}async['executeTransferWithQRCode'](_0x86b8ed,_0x167c18){const _0x4fed64=_0x596bc8;if(this[_0x4fed64(0x1fd)]['log']('Executing\x20HDBank\x20transfer\x20for\x20withdrawal\x20'+_0x86b8ed['withdrawalId']+'\x20on\x20device\x20'+_0x167c18[_0x4fed64(0x14b)]),await this[_0x4fed64(0x1c8)](_0x167c18['deviceId'],_0x3aba3f['HD_UI_COORDINATES']['QR_CODE_BTN']['x'],_0x3aba3f['HD_UI_COORDINATES'][_0x4fed64(0x153)]['y'],0xbb8),await(0x0,_0x40c407[_0x4fed64(0x26c)])(0x7d0),!await this['clickAndWaitForScreen'](_0x167c18['deviceId'],_0x3aba3f['HD_UI_COORDINATES'][_0x4fed64(0x2bb)]['x'],_0x3aba3f['HD_UI_COORDINATES']['IMAGE_LIBRARY_BTN']['y'],{'expectedTexts':['·∫¢nh'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x678987[_0x4fed64(0x2d7)]['ALBUM_SCREEN']}))throw new _0x3ea64a['WithdrawalProcessingError'](_0x4fed64(0x122),_0x3ea64a['ErrorType'][_0x4fed64(0x1be)]);this['logger']['log']('['+_0x167c18['accountName']+']\x20-\x20Get\x20image\x20library\x20screen'),await this['clickWithTransition'](_0x167c18[_0x4fed64(0x14b)],_0x3aba3f['HD_UI_COORDINATES']['FIRST_IMAGE_BTN']['x'],_0x3aba3f['HD_UI_COORDINATES']['FIRST_IMAGE_BTN']['y'],0x7d0);let _0x331d40=!0x1;if(_0x331d40=_0x86b8ed[_0x4fed64(0x126)]===_0x1068e6[_0x4fed64(0x29c)][_0x4fed64(0x1b7)]?await this['clickAndWaitForScreen'](_0x167c18['deviceId'],_0x3aba3f['HD_UI_COORDINATES']['SELECT_IMAGE_QR_CODE_BTN']['x'],_0x3aba3f[_0x4fed64(0xed)]['SELECT_IMAGE_QR_CODE_BTN']['y'],{'expectedTexts':[_0x86b8ed['beneficiaryAccountNo']],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x678987['HD_ROI_EXPECTED'][_0x4fed64(0x24c)]}):await this['clickAndWaitForScreen'](_0x167c18['deviceId'],_0x3aba3f[_0x4fed64(0xed)]['SELECT_IMAGE_QR_CODE_BTN']['x'],_0x3aba3f['HD_UI_COORDINATES']['SELECT_IMAGE_QR_CODE_BTN']['y'],{'expectedTexts':[_0x86b8ed['beneficiaryName']],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x678987['HD_ROI_EXPECTED'][_0x4fed64(0x215)]}),!_0x331d40)throw await this['clickWithTransition'](_0x167c18[_0x4fed64(0x14b)],_0x3aba3f[_0x4fed64(0xed)]['HOME_ICON']['x'],_0x3aba3f['HD_UI_COORDINATES']['HOME_ICON']['y'],0x7d0),new _0x3ea64a['WithdrawalProcessingError']('Choose\x20wrong\x20image\x20qrcode',_0x3ea64a[_0x4fed64(0x123)]['TEMPORARY']);if(this[_0x4fed64(0x1fd)]['log']('['+_0x167c18['accountName']+']\x20-\x20Get\x20Verified\x20account\x20name\x20screen'),await(0x0,_0x40c407['sleep'])(0x1f4),!await this['swipeAndWaitForScreen'](_0x167c18[_0x4fed64(0x14b)],{'type':_0x15d293['PandaSwipeTypeEnum'][_0x4fed64(0x256)]},{'expectedTexts':['danh\x20ba\x20th·ª•\x20h∆∞·ªüng'],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x678987[_0x4fed64(0x2d7)]['SWIPE_UP_SCREEN'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x3ea64a[(_0x4fed64(0x22d))]('Swipe\x20up\x20failed',_0x3ea64a['ErrorType'][_0x4fed64(0x1be)]);this['logger']['log']('['+_0x167c18['accountName']+_0x4fed64(0x1d9)),await this['clickWithTransition'](_0x167c18['deviceId'],_0x3aba3f[_0x4fed64(0xed)][_0x4fed64(0x361)]['x'],_0x3aba3f['HD_UI_COORDINATES'][_0x4fed64(0x361)]['y'],0x1f4);const _0x7400e3=await this['detectScreenByHint'](_0x167c18['deviceId'],_0x3aba3f['HD_SCREEN_OTP_HINT'],{'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x678987['HD_ROI_EXPECTED']['OTP_ENTER_OR_CONTINUE_TRANSFER'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x7400e3)throw new _0x3ea64a['WithdrawalProcessingError']('Couldn\x27t\x20get\x20HD\x20Screen\x20state\x20not\x20found',_0x3ea64a['ErrorType']['FORCE_LOGIN']);switch(await(0x0,_0x40c407['sleep'])(0x3e8),_0x7400e3['name']){case _0x3aba3f['HD_SCREEN_HINT_NAME']['ENTER_OTP']:if(await this['inputSmartOTPFromConfig'](_0x167c18['deviceId']),await(0x0,_0x40c407[_0x4fed64(0x26c)])(0x3e8),!await this[_0x4fed64(0x19c)](_0x167c18['deviceId'],{'expectedTexts':['OTP\x20s·∫Ω\x20t·ª±\x20ƒë·ªông\x20l√†m\x20m·ªõi'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x678987['HD_ROI_EXPECTED']['CONFIRM_AFTER_OTP'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x3ea64a['WithdrawalProcessingError']('Confirm\x20after\x20OTP\x20screen\x20not\x20found',_0x3ea64a['ErrorType']['FORCE_LOGIN']);this['logger'][_0x4fed64(0x2d5)]('['+_0x167c18[_0x4fed64(0x1f4)]+_0x4fed64(0x14a));break;case _0x3aba3f['HD_SCREEN_HINT_NAME']['TRANSACTION_VERIFY_NO_INPUT_OTP']:break;default:throw new _0x3ea64a['WithdrawalProcessingError']('Unknown\x20screen\x20state',_0x3ea64a['ErrorType']['FORCE_LOGIN']);}if(!await this['clickAndWaitForScreen'](_0x167c18[_0x4fed64(0x14b)],_0x3aba3f['HD_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['x'],_0x3aba3f['HD_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['GIAO\x20D·ªäCH\x20TH√ÄNH\x20C√îNG'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x678987[_0x4fed64(0x2d7)]['TRANSACTION_SUCCESS'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x3ea64a['WithdrawalProcessingError'](_0x4fed64(0x10a),_0x3ea64a['ErrorType'][_0x4fed64(0xfd)]);this['logger']['log']('['+_0x167c18['accountName']+']\x20-\x20Get\x20Transaction\x20verify\x20screen'),await(0x0,_0x40c407['sleep'])(0x3e8),await this['wsService'][_0x4fed64(0x300)](_0x167c18['deviceId'],{'type':_0x15d293['PandaSwipeTypeEnum']['SCROLL_DOWN']}),await(0x0,_0x40c407[_0x4fed64(0x26c)])(0x3e8),await this['captureScreen'](_0x167c18['deviceId'],{'folderPath':_0x86b8ed['withdrawalCode']}),await(0x0,_0x40c407['sleep'])(0x7d0);}async[_0x596bc8(0x3f3)](_0x19a0b7){const _0x2b23f1=_0x596bc8;try{const _0x1b2baf=await this['ocrService'][_0x2b23f1(0x333)](_0x19a0b7,{'fieldType':'singleLine','customROI':{'x':0.05,'y':0.75,'width':0.9,'height':0.12},'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x1b2baf)return this['logger'][_0x2b23f1(0x1eb)]('Failed\x20to\x20extract\x20transaction\x20amount\x20from\x20ROI'),null;const _0x33180c=_0x1b2baf[_0x2b23f1(0x209)]['replace'](/[^\d.,]/g,'')['replace'](/,/g,''),_0x30f525=parseFloat(_0x33180c);return isNaN(_0x30f525)?(this['logger']['warn'](_0x2b23f1(0x1e9)+_0x1b2baf[_0x2b23f1(0x209)]),null):(this['logger'][_0x2b23f1(0x2d5)]('Extracted\x20transaction\x20amount:\x20'+_0x30f525['toLocaleString']('vi-VN')+_0x2b23f1(0x286)+_0x1b2baf['confidence'][_0x2b23f1(0x386)](0x2)+'%,\x20time:\x20'+_0x1b2baf['processingTime']+'ms)'),_0x30f525);}catch(_0x2e0429){return this['logger']['error']('Error\x20extracting\x20transaction\x20amount:\x20'+_0x2e0429['message'],_0x2e0429['stack']),null;}}async['onModuleInit'](){}['onModuleDestroy'](){}};_0x1bb667[_0x596bc8(0xf9)]=_0x185d59,_0x1bb667[_0x596bc8(0xf9)]=_0x185d59=_0x490499([(0x0,_0x2f98e5['Injectable'])(),_0x575367(0x0,(0x0,_0x2f98e5[_0x596bc8(0x33a)])(_0x3b6513[_0x596bc8(0x311)])),_0x1026ab('design:paramtypes',['function'==typeof(_0x373cb8=void 0x0!==_0x41b3e5['IWebSocketService']&&_0x41b3e5['IWebSocketService'])?_0x373cb8:Object,_0x596bc8(0x18d)==typeof(_0x593636=void 0x0!==_0x119140['DeviceService']&&_0x119140['DeviceService'])?_0x593636:Object,'function'==typeof(_0x43016d=void 0x0!==_0x4c7680['OCRService']&&_0x4c7680['OCRService'])?_0x43016d:Object,_0x596bc8(0x18d)==typeof(_0x2c4327=void 0x0!==_0xbf3cdf['ImagePreprocessingService']&&_0xbf3cdf['ImagePreprocessingService'])?_0x2c4327:Object])],_0x185d59);},(_0x56e887,_0x26f0f3,_0x4c5f5e)=>{const _0x26eaa0=a0_0x2e92;Object['defineProperty'](_0x26f0f3,'__esModule',{'value':!0x0}),_0x26f0f3['HD_SCREEN_OTP_HINT']=_0x26f0f3['HD_SCREEN_HINT_NAME']=_0x26f0f3['HD_UI_COORDINATES']=void 0x0;const _0x4ca1da=_0x4c5f5e(0x11),_0x729fdf={'LOGIN_BTN':{'x':0.5,'y':0.6},'PASSWORD_FIELD':{'x':0.5,'y':0.5},'TRANSFER_BTN':{'x':0.7,'y':0.7},'TRANSFER_INTERNAL_BTN':{'x':0.2,'y':0.2},'TRANSFER_EXTERNAL_BTN':{'x':0.4,'y':0.2},'CLOSE_ALLOW_CONTACT_POPUP_BTN':{'x':0.3,'y':0.6},'ACCOUNT_NUMBER_INPUT':{'x':0.4,'y':0.43},'SELECT_BANK_BTN':{'x':0.4,'y':0.47},'SEARCH_BANK_BTN':{'x':0.4,'y':0.48},'INTERNAL_AMOUNT_INPUT':{'x':0.5,'y':0.6},'HIDE_NUMPAD_BTN':{'x':0.05,'y':0.4},'CONTINUE_TRANSFER_BTN':{'x':0.5,'y':0.85},'BANK_SEARCH_BTN':{'x':0.4,'y':0.45},'BANK_SEARCH_INPUT':{'x':0.4,'y':0.45},'EXTERNAL_AMOUNT_INPUT':{'x':0.3,'y':0.37},'BACK_TO_HOME':{'x':0.2,'y':0.98},'QR_CODE_BTN':{'x':0.5,'y':0.95},'IMAGE_LIBRARY_BTN':{'x':0.5,'y':0.85},'FIRST_IMAGE_BTN':{'x':0.3,'y':0.3},'SELECT_IMAGE_QR_CODE_BTN':{'x':0.95,'y':0.95},'HOME_ICON':{'x':0.11,'y':0.94},'CLOSE_WARNING_TRANSACTION_POPUP':{'x':0.73,'y':0.62}},_0x577357=(0x0,_0x4c5f5e(0x26)['scaleCoordinates'])(_0x729fdf);_0x26f0f3['HD_UI_COORDINATES']='PANDA'===_0x4ca1da['config']['boxType']?_0x577357:_0x729fdf,_0x26f0f3['HD_SCREEN_HINT_NAME']={'ENTER_OTP':'ENTER_OTP','TRANSACTION_VERIFY_NO_INPUT_OTP':'TRANSACTION_VERIFY_NO_INPUT_OTP'},_0x26f0f3['HD_SCREEN_OTP_HINT']=[{'name':_0x26f0f3['HD_SCREEN_HINT_NAME'][_0x26eaa0(0x251)],'hint':'Vui\x20long\x20nhap\x20ma\x20PIN\x20HDBank\x20OTP'},{'name':_0x26f0f3['HD_SCREEN_HINT_NAME']['TRANSACTION_VERIFY_NO_INPUT_OTP'],'hint':_0x26eaa0(0x16a)}];},(_0x479f17,_0x3350cc)=>{const _0x2f2ebd=a0_0x2e92;var _0x24ed74;Object[_0x2f2ebd(0x3cc)](_0x3350cc,'__esModule',{'value':!0x0}),_0x3350cc['PandaSwipeTypeEnum']=void 0x0,function(_0xf06e5a){const _0x2fcb44=_0x2f2ebd;_0xf06e5a['SCROLL_UP']='4',_0xf06e5a['SCROLL_DOWN']='5',_0xf06e5a[_0x2fcb44(0x256)]='6',_0xf06e5a['SWIPE_DOWN']='7',_0xf06e5a['SWIPE_LEFT']='8',_0xf06e5a['SWIPE_RIGHT']='9',_0xf06e5a['CLICK']='0';}(_0x24ed74||(_0x3350cc[_0x2f2ebd(0x362)]=_0x24ed74={}));},function(_0x2a2549,_0x43890b,_0x3f948c){const _0x15842f=a0_0x2e92;var _0x13f33b,_0x530da2,_0x16099f,_0x472130,_0x592f7f=this&&this['__decorate']||function(_0x5b2fd9,_0x361708,_0x29a573,_0x4b12db){const _0x6982d7=a0_0x2e92;var _0x20ed5f,_0xf55dc4=arguments['length'],_0x55feaa=_0xf55dc4<0x3?_0x361708:null===_0x4b12db?_0x4b12db=Object[_0x6982d7(0x25c)](_0x361708,_0x29a573):_0x4b12db;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x55feaa=Reflect[_0x6982d7(0x3b0)](_0x5b2fd9,_0x361708,_0x29a573,_0x4b12db);else{for(var _0x4f0093=_0x5b2fd9['length']-0x1;_0x4f0093>=0x0;_0x4f0093--)(_0x20ed5f=_0x5b2fd9[_0x4f0093])&&(_0x55feaa=(_0xf55dc4<0x3?_0x20ed5f(_0x55feaa):_0xf55dc4>0x3?_0x20ed5f(_0x361708,_0x29a573,_0x55feaa):_0x20ed5f(_0x361708,_0x29a573))||_0x55feaa);}return _0xf55dc4>0x3&&_0x55feaa&&Object[_0x6982d7(0x3cc)](_0x361708,_0x29a573,_0x55feaa),_0x55feaa;},_0x2572cd=this&&this[_0x15842f(0x3c1)]||function(_0xfe53ac,_0x271957){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0xfe53ac,_0x271957);},_0x53a0df=this&&this['__param']||function(_0x36ad95,_0x425131){return function(_0x51ae23,_0x362647){_0x425131(_0x51ae23,_0x362647,_0x36ad95);};};Object['defineProperty'](_0x43890b,'__esModule',{'value':!0x0}),_0x43890b[_0x15842f(0x377)]=void 0x0;const _0x2734ef=_0x3f948c(0xd),_0x16d75f=_0x3f948c(0x13),_0x5617ef=_0x3f948c(0x18),_0x4f732d=_0x3f948c(0x2),_0x3d85c5=_0x3f948c(0xe),_0x5c97bd=_0x3f948c(0x17),_0x489005=_0x3f948c(0x1b),_0x1b1f2a=_0x3f948c(0x2a),_0x5e2e15=_0x3f948c(0x25),_0x1ab517=_0x3f948c(0x33),_0x3d889a=_0x3f948c(0x1e);let _0x8ecdb7=class extends _0x5c97bd['BaseBankService']{constructor(_0x35039e,_0x1d6dfa,_0x1cbfc3,_0x2bede9){super(_0x35039e,_0x1d6dfa,_0x1cbfc3,_0x2bede9),this['wsService']=_0x35039e,this['BANK_CODE']='VIETCOMBANK',this['BUNDLE_ID']='com.vcb.VCB';}async['inputPasswordFromConfig'](_0x1188a9){const _0xdeb121=_0x15842f,_0x5e28a4=await this[_0xdeb121(0x25e)]['getDeviceConfig'](_0x1188a9);if(!_0x5e28a4||!_0x5e28a4['password'])throw new Error(_0xdeb121(0x28a)+_0x1188a9);await this[_0xdeb121(0x1c8)](_0x1188a9,_0x1ab517['VCB_UI_COORDINATES'][_0xdeb121(0x247)]['x'],_0x1ab517['VCB_UI_COORDINATES']['PASSWORD_FIELD']['y'],0x5dc),await this[_0xdeb121(0x2e6)]['inputText'](_0x1188a9,_0x5e28a4[_0xdeb121(0xda)]),await(0x0,_0x5617ef['sleep'])(0x3e8),await this[_0xdeb121(0x2e6)][_0xdeb121(0x3d2)](_0x1188a9),await(0x0,_0x5617ef[_0xdeb121(0x26c)])(0x1f4);}async[_0x15842f(0x3c7)](_0xc4df7b,_0x59486c=0x3){const _0x99261f=_0x15842f,_0x4b4f1c=await this['deviceService'][_0x99261f(0x2de)](_0xc4df7b);if(!_0x4b4f1c||!_0x4b4f1c['smartOTP'])throw new Error('SmartOTP\x20not\x20configured\x20for\x20device\x20'+_0xc4df7b);await(0x0,_0x5617ef['sleep'])(0x1f4),await this['wsService']['inputText'](_0xc4df7b,_0x4b4f1c['smartOTP']);}async['launchApp'](_0xe3dd6){const _0x3ffd68=_0x15842f;if(await this['wsService'][_0x3ffd68(0x1e8)](_0xe3dd6,this['BUNDLE_ID']),!await this['verifyScreenState'](_0xe3dd6,{'expectedTexts':['ƒêƒÉng\x20nh·∫≠p'],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x5e2e15['VCB_ROI_EXPECTED'][_0x3ffd68(0x2ec)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1b1f2a[(_0x3ffd68(0x22d))](_0x3ffd68(0x3dd),_0x1b1f2a['ErrorType']['FORCE_LOGIN']);this['logger']['log']('['+_0xe3dd6+_0x3ffd68(0x23d));}async['login'](_0x13df5e){const _0x2795af=_0x15842f;if(await this['killApp'](_0x13df5e),await(0x0,_0x5617ef['sleep'])(0x7d0),await this[_0x2795af(0x1e8)](_0x13df5e),await this['verifyScreenState'](_0x13df5e,{'expectedTexts':['ƒêƒÉng\x20nh·∫≠p'],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x5e2e15['VCB_ROI_EXPECTED'][_0x2795af(0x2ec)]}),await this[_0x2795af(0x34b)](_0x13df5e),!await this['clickAndWaitForScreen'](_0x13df5e,_0x1ab517[_0x2795af(0x280)]['LOGIN_BTN']['x'],_0x1ab517['VCB_UI_COORDINATES']['LOGIN_BTN']['y'],{'expectedTexts':[_0x2795af(0x3a2)],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x5e2e15['VCB_ROI_EXPECTED']['HOME_SCREEN']}))throw new _0x1b1f2a['WithdrawalProcessingError']('Failed\x20to\x20login\x20to\x20VIETCOMBANK',_0x1b1f2a[_0x2795af(0x123)]['FORCE_LOGIN']);this[_0x2795af(0x1fd)]['log']('['+_0x13df5e+_0x2795af(0x27e));}async['executeTransferWithQRCode'](_0x2699e0,_0x22b251){const _0x38307d=_0x15842f;if(this[_0x38307d(0x1fd)][_0x38307d(0x2d5)](_0x38307d(0xf0)+_0x2699e0['withdrawalId']+'\x20on\x20device\x20'+_0x22b251[_0x38307d(0x14b)]),await this['clickWithTransition'](_0x22b251[_0x38307d(0x14b)],_0x1ab517['VCB_UI_COORDINATES']['QR_CODE_BTN']['x'],_0x1ab517['VCB_UI_COORDINATES']['QR_CODE_BTN']['y'],0xbb8),await(0x0,_0x5617ef['sleep'])(0x7d0),!await this['clickAndWaitForScreen'](_0x22b251['deviceId'],_0x1ab517[_0x38307d(0x280)][_0x38307d(0x2bb)]['x'],_0x1ab517['VCB_UI_COORDINATES']['IMAGE_LIBRARY_BTN']['y'],{'expectedTexts':['·∫¢nh','Album'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x5e2e15[_0x38307d(0x26f)]['ALBUM_SCREEN']}))throw new _0x1b1f2a[(_0x38307d(0x22d))](_0x38307d(0x122),_0x1b1f2a[_0x38307d(0x123)]['FORCE_LOGIN']);if(this[_0x38307d(0x1fd)][_0x38307d(0x2d5)]('['+_0x22b251['accountName']+']\x20-\x20Get\x20image\x20library\x20screen'),!await this[_0x38307d(0x3b9)](_0x22b251['deviceId'],_0x1ab517['VCB_UI_COORDINATES'][_0x38307d(0x10c)]['x'],_0x1ab517[_0x38307d(0x280)]['FIRST_IMAGE_BTN']['y'],{'expectedTexts':[_0x2699e0['beneficiaryName']],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x5e2e15[_0x38307d(0x26f)]['VERIFY_ACCOUNT_NAME']}))throw await this['clickWithTransition'](_0x22b251[_0x38307d(0x14b)],_0x1ab517['VCB_UI_COORDINATES']['HOME_ICON']['x'],_0x1ab517[_0x38307d(0x280)]['HOME_ICON']['y'],0x7d0),new _0x1b1f2a[(_0x38307d(0x22d))]('Choose\x20wrong\x20image\x20qrcode',_0x1b1f2a[_0x38307d(0x123)]['TEMPORARY']);if(this['logger']['log']('['+_0x22b251['accountName']+_0x38307d(0x3bf)),!await this['clickAndWaitForScreen'](_0x22b251[_0x38307d(0x14b)],_0x1ab517['VCB_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['x'],_0x1ab517['VCB_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['ki·ªÉm\x20tra\x20v√†\x20x√°c\x20nh·∫≠n'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x5e2e15['VCB_ROI_EXPECTED']['TRANSACTION_VERIFY']}))throw new _0x1b1f2a['WithdrawalProcessingError']('Transaction\x20verification\x20screen\x20not\x20found',_0x1b1f2a['ErrorType']['FORCE_LOGIN']);if(this['logger']['log']('['+_0x22b251[_0x38307d(0x1f4)]+']\x20-\x20Get\x20Transaction\x20verification\x20screen'),!await this['clickAndWaitForScreen'](_0x22b251[_0x38307d(0x14b)],_0x1ab517['VCB_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['x'],_0x1ab517[_0x38307d(0x280)]['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['smart\x20OTP'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x5e2e15['VCB_ROI_EXPECTED']['OTP_ENTER']}))throw new _0x1b1f2a['WithdrawalProcessingError']('Transaction\x20verify\x20screen\x20not\x20found',_0x1b1f2a['ErrorType']['FORCE_LOGIN']);if(this[_0x38307d(0x1fd)]['log']('['+_0x22b251[_0x38307d(0x1f4)]+']\x20-\x20Get\x20Transaction\x20verify\x20screen'),await this['inputSmartOTPFromConfig'](_0x22b251['deviceId']),await(0x0,_0x5617ef[_0x38307d(0x26c)])(0x1f4),!await this['clickAndWaitForScreen'](_0x22b251['deviceId'],_0x1ab517['VCB_UI_COORDINATES']['OTP_ENTER_TRANSFER_BTN']['x'],_0x1ab517[_0x38307d(0x280)][_0x38307d(0x2cd)]['y'],{'expectedTexts':['M√£\x20x√°c\x20th·ª±c\x20giao\x20d·ªãch'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x5e2e15['VCB_ROI_EXPECTED']['OTP_VERIFY']}))throw new _0x1b1f2a['WithdrawalProcessingError']('Transaction\x20verify\x20screen\x20not\x20found',_0x1b1f2a['ErrorType']['NO_BILL_AFTER_OTP']);if(this['logger']['log']('['+_0x22b251[_0x38307d(0x1f4)]+_0x38307d(0x326)),!await this['clickAndWaitForScreen'](_0x22b251['deviceId'],_0x1ab517['VCB_UI_COORDINATES'][_0x38307d(0x24a)]['x'],_0x1ab517[_0x38307d(0x280)]['CONTINUE_OTP_VERIFY_BTN']['y'],{'expectedTexts':[_0x38307d(0x1cc)],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x5e2e15['VCB_ROI_EXPECTED'][_0x38307d(0x3ad)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1b1f2a[(_0x38307d(0x22d))](_0x38307d(0x3ab),_0x1b1f2a['ErrorType'][_0x38307d(0xfd)]);this['logger'][_0x38307d(0x2d5)]('['+_0x22b251[_0x38307d(0x1f4)]+']\x20-\x20Get\x20Transaction\x20success\x20screen'),await(0x0,_0x5617ef['sleep'])(0x1f4),await this[_0x38307d(0x341)](_0x22b251['deviceId'],{'folderPath':_0x2699e0[_0x38307d(0xf8)]}),await this['clickWithTransition'](_0x22b251['deviceId'],_0x1ab517[_0x38307d(0x280)]['HOME_ICON']['x'],_0x1ab517['VCB_UI_COORDINATES']['HOME_ICON']['y'],0x1388,'['+_0x22b251['accountName']+_0x38307d(0x161));}async['extractTransactionAmount'](_0x3db8eb){const _0x57f3e0=_0x15842f;try{const _0x86cbe2=await this['ocrService']['recognizeFromFile'](_0x3db8eb,{'fieldType':_0x57f3e0(0x2fc),'customROI':{'x':0.05,'y':0.75,'width':0.9,'height':0.12},'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x86cbe2)return this['logger']['warn']('Failed\x20to\x20extract\x20transaction\x20amount\x20from\x20ROI'),null;const _0x16666f=_0x86cbe2[_0x57f3e0(0x209)][_0x57f3e0(0x159)](/[^\d.,]/g,'')['replace'](/,/g,''),_0x2fa2fd=parseFloat(_0x16666f);return isNaN(_0x2fa2fd)?(this[_0x57f3e0(0x1fd)]['warn']('Could\x20not\x20parse\x20amount\x20from\x20OCR\x20text:\x20'+_0x86cbe2['text']),null):(this['logger']['log']('Extracted\x20transaction\x20amount:\x20'+_0x2fa2fd[_0x57f3e0(0x1c5)]('vi-VN')+_0x57f3e0(0x286)+_0x86cbe2[_0x57f3e0(0x279)]['toFixed'](0x2)+'%,\x20time:\x20'+_0x86cbe2[_0x57f3e0(0x182)]+'ms)'),_0x2fa2fd);}catch(_0x345b48){return this[_0x57f3e0(0x1fd)][_0x57f3e0(0xeb)]('Error\x20extracting\x20transaction\x20amount:\x20'+_0x345b48['message'],_0x345b48['stack']),null;}}async['onModuleInit'](){}[_0x15842f(0x120)](){}};_0x43890b['VietcombankService']=_0x8ecdb7,_0x43890b[_0x15842f(0x377)]=_0x8ecdb7=_0x592f7f([(0x0,_0x4f732d['Injectable'])(),_0x53a0df(0x0,(0x0,_0x4f732d[_0x15842f(0x33a)])(_0x2734ef[_0x15842f(0x311)])),_0x2572cd('design:paramtypes',['function'==typeof(_0x13f33b=void 0x0!==_0x16d75f[_0x15842f(0x258)]&&_0x16d75f[_0x15842f(0x258)])?_0x13f33b:Object,_0x15842f(0x18d)==typeof(_0x530da2=void 0x0!==_0x3d85c5['DeviceService']&&_0x3d85c5['DeviceService'])?_0x530da2:Object,'function'==typeof(_0x16099f=void 0x0!==_0x489005[_0x15842f(0x3dc)]&&_0x489005[_0x15842f(0x3dc)])?_0x16099f:Object,'function'==typeof(_0x472130=void 0x0!==_0x3d889a[_0x15842f(0x1d5)]&&_0x3d889a['ImagePreprocessingService'])?_0x472130:Object])],_0x8ecdb7);},(_0x718a41,_0x4c1f75,_0x3da94f)=>{const _0x58039a=a0_0x2e92;Object['defineProperty'](_0x4c1f75,'__esModule',{'value':!0x0}),_0x4c1f75['VCB_UI_COORDINATES']=void 0x0;const _0x1209a4=_0x3da94f(0x11),_0x1e054c={'LOGIN_BTN':{'x':0.5,'y':0.55},'PASSWORD_FIELD':{'x':0.5,'y':0.45},'TRANSFER_BTN':{'x':0.7,'y':0.7},'TRANSFER_INTERNAL_BTN':{'x':0.2,'y':0.2},'TRANSFER_EXTERNAL_BTN':{'x':0.4,'y':0.2},'CLOSE_ALLOW_CONTACT_POPUP_BTN':{'x':0.3,'y':0.6},'ACCOUNT_NUMBER_INPUT':{'x':0.4,'y':0.43},'SELECT_BANK_BTN':{'x':0.4,'y':0.47},'SEARCH_BANK_BTN':{'x':0.4,'y':0.48},'INTERNAL_AMOUNT_INPUT':{'x':0.5,'y':0.6},'HIDE_NUMPAD_BTN':{'x':0.05,'y':0.4},'CONTINUE_TRANSFER_BTN':{'x':0.6,'y':0.92},'CONTINUE_OTP_VERIFY_BTN':{'x':0.5,'y':0.68},'OTP_ENTER_TRANSFER_BTN':{'x':0.5,'y':0.62},'BANK_SEARCH_BTN':{'x':0.4,'y':0.45},'BANK_SEARCH_INPUT':{'x':0.4,'y':0.45},'EXTERNAL_AMOUNT_INPUT':{'x':0.3,'y':0.37},'BACK_TO_HOME':{'x':0.2,'y':0.9},'QR_CODE_BTN':{'x':0.4,'y':0.92},'IMAGE_LIBRARY_BTN':{'x':0.4,'y':0.92},'FIRST_IMAGE_BTN':{'x':0.3,'y':0.3},'SELECT_IMAGE_QR_CODE_BTN':{'x':0.95,'y':0.95},'HOME_ICON':{'x':0.93,'y':0.07}},_0x4c6d7c=(0x0,_0x3da94f(0x26)[_0x58039a(0x285)])(_0x1e054c);_0x4c1f75['VCB_UI_COORDINATES']='PANDA'===_0x1209a4['config']['boxType']?_0x4c6d7c:_0x1e054c;},function(_0x2ba7cf,_0x494d2f,_0x5457ba){const _0x457369=a0_0x2e92;var _0x204fb8,_0x1f7194=this&&this['__decorate']||function(_0x201991,_0x31abd9,_0x20def9,_0xf4357){const _0x35c64a=a0_0x2e92;var _0x16f7cc,_0x4abd78=arguments[_0x35c64a(0x1fe)],_0x2d22a4=_0x4abd78<0x3?_0x31abd9:null===_0xf4357?_0xf4357=Object['getOwnPropertyDescriptor'](_0x31abd9,_0x20def9):_0xf4357;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x2d22a4=Reflect[_0x35c64a(0x3b0)](_0x201991,_0x31abd9,_0x20def9,_0xf4357);else{for(var _0x3ae5c9=_0x201991['length']-0x1;_0x3ae5c9>=0x0;_0x3ae5c9--)(_0x16f7cc=_0x201991[_0x3ae5c9])&&(_0x2d22a4=(_0x4abd78<0x3?_0x16f7cc(_0x2d22a4):_0x4abd78>0x3?_0x16f7cc(_0x31abd9,_0x20def9,_0x2d22a4):_0x16f7cc(_0x31abd9,_0x20def9))||_0x2d22a4);}return _0x4abd78>0x3&&_0x2d22a4&&Object['defineProperty'](_0x31abd9,_0x20def9,_0x2d22a4),_0x2d22a4;},_0x48880e=this&&this['__metadata']||function(_0x5779cf,_0x1c8af9){const _0x2ce2e8=a0_0x2e92;if(_0x2ce2e8(0x141)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x5779cf,_0x1c8af9);};Object[_0x457369(0x3cc)](_0x494d2f,'__esModule',{'value':!0x0}),_0x494d2f['SessionManagementService']=void 0x0;const _0x5e8edf=_0x5457ba(0x2),_0x28a25e=_0x5457ba(0xf);let _0x42a5cf=class{constructor(_0x2ebd7a){const _0x46b4d0=_0x457369;this[_0x46b4d0(0x1b2)]=_0x2ebd7a,this['logger']=new _0x5e8edf[(_0x46b4d0(0x225))]('SessionManagementService'),this['REDIS_SESSION_PREFIX']='bank:session:',this['BANK_SESSION_CONFIGS']=new Map([['ACB',{'bankCode':'ACB','sessionTimeoutMs':0xdbba0,'refreshBeforeMs':0xea60}],['PGBANK',{'bankCode':'PGBANK','sessionTimeoutMs':0x41eb0,'refreshBeforeMs':0x7530}],['HDBANK',{'bankCode':'HDBANK','sessionTimeoutMs':0x41eb0,'refreshBeforeMs':0x7530}]]);}['getSessionTimeout'](_0x26170e){const _0x3ab9c7=_0x457369,_0x45deab=this['BANK_SESSION_CONFIGS']['get'](_0x26170e[_0x3ab9c7(0x385)]());return _0x45deab?.['sessionTimeoutMs']||0x41eb0;}[_0x457369(0x150)](_0x31bd79){const _0x2032a5=this['BANK_SESSION_CONFIGS']['get'](_0x31bd79['toUpperCase']());return _0x2032a5?.['refreshBeforeMs']||0x7530;}async['recordLogin'](_0x5aa96a,_0x426331){const _0x3ab761=_0x457369,_0x31347b=this['getSessionTimeout'](_0x426331),_0x179cef=Date['now']()+_0x31347b,_0x78c822={'deviceId':_0x5aa96a,'bankCode':_0x426331['toUpperCase'](),'loginTime':Date['now'](),'expiresAt':_0x179cef,'status':'logged_in'},_0x5750bc=''+this[_0x3ab761(0x24f)]+_0x5aa96a+':'+_0x426331['toUpperCase']();await this[_0x3ab761(0x1b2)]['set'](_0x5750bc,JSON['stringify'](_0x78c822),_0x31347b),this['logger']['log']('['+_0x5aa96a+']\x20Recorded\x20login\x20session\x20(bank:\x20'+_0x426331+',\x20expires\x20at:\x20'+new Date(_0x179cef)['toISOString']()+')');}async['markLoggingIn'](_0x24ff16,_0x3fd61e){const _0x4598b4=_0x457369,_0x492396=''+this['REDIS_SESSION_PREFIX']+_0x24ff16+':'+_0x3fd61e['toUpperCase'](),_0x5d89e6=await this['getSession'](_0x24ff16,_0x3fd61e),_0x2ca747={'deviceId':_0x24ff16,'bankCode':_0x3fd61e['toUpperCase'](),'loginTime':_0x5d89e6?.[_0x4598b4(0x3ef)]||Date[_0x4598b4(0x1a2)](),'expiresAt':_0x5d89e6?.['expiresAt']||Date[_0x4598b4(0x1a2)]()+this['getSessionTimeout'](_0x3fd61e),'status':'logging_in'};await this['redisService'][_0x4598b4(0x1c0)](_0x492396,JSON['stringify'](_0x2ca747),0x493e0),this['logger'][_0x4598b4(0x2d5)]('Marked\x20device\x20'+_0x24ff16+_0x4598b4(0x29d)+_0x3fd61e+'\x20as\x20logging\x20in');}async['getSession'](_0x2e21fc,_0x304611){const _0x41415d=_0x457369;try{const _0x52bca4=''+this[_0x41415d(0x24f)]+_0x2e21fc+':'+_0x304611['toUpperCase'](),_0x42fdda=await this['redisService'][_0x41415d(0x113)](_0x52bca4);return _0x42fdda?JSON['parse'](_0x42fdda):null;}catch(_0x4b2a4f){return this['logger']['error']('Error\x20getting\x20session\x20for\x20device\x20'+_0x2e21fc+',\x20bank\x20'+_0x304611+':\x20'+_0x4b2a4f['message']),null;}}async['isSessionValid'](_0x87d88d,_0x1e6aff){const _0x20d897=_0x457369,_0x891878=await this[_0x20d897(0xe3)](_0x87d88d,_0x1e6aff);return!(!_0x891878||_0x891878['expiresAt']<Date['now']()||'logging_in'===_0x891878[_0x20d897(0x1f3)]||'logged_in'!==_0x891878['status']);}async['needsRefresh'](_0x31d8da,_0x27865b){const _0x1dc8d9=await this['getSession'](_0x31d8da,_0x27865b);if(!_0x1dc8d9||'logged_in'!==_0x1dc8d9['status'])return!0x1;const _0x4119d4=this['getRefreshBeforeTime'](_0x27865b);return _0x1dc8d9['expiresAt']-Date['now']()<=_0x4119d4;}async['clearSession'](_0x20a6a5,_0x564aa3){const _0x3e72fe=_0x457369,_0x9cfc0f=''+this[_0x3e72fe(0x24f)]+_0x20a6a5+':'+_0x564aa3['toUpperCase']();await this['redisService'][_0x3e72fe(0x17d)](_0x9cfc0f),this[_0x3e72fe(0x1fd)]['log']('Cleared\x20session\x20for\x20device\x20'+_0x20a6a5+',\x20bank\x20'+_0x564aa3);}};_0x494d2f['SessionManagementService']=_0x42a5cf,_0x494d2f[_0x457369(0x371)]=_0x42a5cf=_0x1f7194([(0x0,_0x5e8edf['Injectable'])(),_0x48880e('design:paramtypes',['function'==typeof(_0x204fb8=void 0x0!==_0x28a25e['RedisService']&&_0x28a25e['RedisService'])?_0x204fb8:Object])],_0x42a5cf);},function(_0xd158a1,_0x56277a,_0x1804b1){const _0x3e4cf5=a0_0x2e92;var _0x5edb8b,_0x4c257f=this&&this['__decorate']||function(_0x4625a9,_0x52be9e,_0x25fb76,_0x10b17d){const _0x280cab=a0_0x2e92;var _0x4997ba,_0x109acc=arguments['length'],_0x5d89ee=_0x109acc<0x3?_0x52be9e:null===_0x10b17d?_0x10b17d=Object['getOwnPropertyDescriptor'](_0x52be9e,_0x25fb76):_0x10b17d;if(_0x280cab(0x141)==typeof Reflect&&'function'==typeof Reflect[_0x280cab(0x3b0)])_0x5d89ee=Reflect['decorate'](_0x4625a9,_0x52be9e,_0x25fb76,_0x10b17d);else{for(var _0x251376=_0x4625a9['length']-0x1;_0x251376>=0x0;_0x251376--)(_0x4997ba=_0x4625a9[_0x251376])&&(_0x5d89ee=(_0x109acc<0x3?_0x4997ba(_0x5d89ee):_0x109acc>0x3?_0x4997ba(_0x52be9e,_0x25fb76,_0x5d89ee):_0x4997ba(_0x52be9e,_0x25fb76))||_0x5d89ee);}return _0x109acc>0x3&&_0x5d89ee&&Object['defineProperty'](_0x52be9e,_0x25fb76,_0x5d89ee),_0x5d89ee;},_0x472875=this&&this['__metadata']||function(_0x3597a2,_0x1fd69f){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x3597a2,_0x1fd69f);};Object[_0x3e4cf5(0x3cc)](_0x56277a,_0x3e4cf5(0x110),{'value':!0x0}),_0x56277a['NotificationService']=void 0x0;const _0x4f273e=_0x1804b1(0x2),_0x1c1f36=_0x1804b1(0x36);let _0x2ad204=class{constructor(_0x59e293){const _0xbb35db=_0x3e4cf5;this[_0xbb35db(0x115)]=_0x59e293,this[_0xbb35db(0x1fd)]=new _0x4f273e['Logger'](_0xbb35db(0x340));}async['completeWithdrawal'](_0x28fa7f,_0xf18e2d,_0x540864){const _0x5a2235=_0x3e4cf5;this['ezpayBeClient']['completeWithdrawal'](_0x28fa7f[_0x5a2235(0x2a9)],{'analyzedStatus':_0xf18e2d['analyzedStatus'],'sourceAccountNo':_0x540864['accountNo'],'sourceBankCode':_0x540864['bankCode'],'sourceAccountName':_0x540864['accountName']})['catch'](_0x253ac6=>{const _0x3a8102=_0x5a2235;this['logger']['error']('['+_0x28fa7f[_0x3a8102(0xf8)]+']\x20-\x20Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x28fa7f['_id']+'\x20-\x20'+_0x253ac6['stack']);}),this['ezpayBeClient']['uploadReceipt'](_0x28fa7f['_id'],_0xf18e2d[_0x5a2235(0x2c3)])['catch'](_0x39396d=>{const _0x1e1609=_0x5a2235;this['logger']['error']('['+_0x28fa7f['withdrawalCode']+']\x20-\x20Error\x20uploading\x20receipt\x20for\x20'+_0x28fa7f[_0x1e1609(0x2a9)]+'\x20-\x20'+_0x39396d['stack']);});}['updateWithdrawalStatus'](_0x5e5a05,_0x51c609){return this['ezpayBeClient']['updateWithdrawalStatus'](_0x5e5a05,_0x51c609);}[_0x3e4cf5(0x39a)](_0x47d5e7,_0x4175ef){return this['ezpayBeClient']['uploadReceipt'](_0x47d5e7,_0x4175ef);}};_0x56277a['NotificationService']=_0x2ad204,_0x56277a['NotificationService']=_0x2ad204=_0x4c257f([(0x0,_0x4f273e['Injectable'])(),_0x472875('design:paramtypes',['function'==typeof(_0x5edb8b=void 0x0!==_0x1c1f36['EzpayBeClientService']&&_0x1c1f36['EzpayBeClientService'])?_0x5edb8b:Object])],_0x2ad204);},function(_0x1f4256,_0x111a5f,_0x508729){const _0x173a56=a0_0x2e92;var _0x2f8a1f,_0x5663dd=this&&this['__decorate']||function(_0x53c87a,_0x17bab4,_0x1c7917,_0x29a335){const _0x38eafe=a0_0x2e92;var _0xbe1988,_0x3ae529=arguments['length'],_0x2b616e=_0x3ae529<0x3?_0x17bab4:null===_0x29a335?_0x29a335=Object[_0x38eafe(0x25c)](_0x17bab4,_0x1c7917):_0x29a335;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x2b616e=Reflect['decorate'](_0x53c87a,_0x17bab4,_0x1c7917,_0x29a335);else{for(var _0x2566f7=_0x53c87a['length']-0x1;_0x2566f7>=0x0;_0x2566f7--)(_0xbe1988=_0x53c87a[_0x2566f7])&&(_0x2b616e=(_0x3ae529<0x3?_0xbe1988(_0x2b616e):_0x3ae529>0x3?_0xbe1988(_0x17bab4,_0x1c7917,_0x2b616e):_0xbe1988(_0x17bab4,_0x1c7917))||_0x2b616e);}return _0x3ae529>0x3&&_0x2b616e&&Object['defineProperty'](_0x17bab4,_0x1c7917,_0x2b616e),_0x2b616e;},_0x147c54=this&&this[_0x173a56(0x3c1)]||function(_0x4c86a9,_0x49a8b1){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x4c86a9,_0x49a8b1);};Object['defineProperty'](_0x111a5f,'__esModule',{'value':!0x0}),_0x111a5f[_0x173a56(0x238)]=void 0x0;const _0x504117=_0x508729(0x2),_0x91e9c0=_0x508729(0x8),_0x29f863=_0x508729(0x37),_0x4d07e1=_0x508729(0x2e),_0x559a81=_0x508729(0x19),_0x1d0beb=_0x508729(0x11),_0x3c3298=_0x508729(0x18);let _0x1d07c8=class{constructor(_0x54bfc2){const _0x4a41ff=_0x173a56;this['httpService']=_0x54bfc2,this['logger']=new _0x504117['Logger'](_0x4a41ff(0x238)),this['apiUrl']=_0x1d0beb['config'][_0x4a41ff(0x1af)]['apiUrl']??'http://localhost:3001',this['apiKey']=_0x1d0beb['config']['ezpayBe'][_0x4a41ff(0x278)]??'';}async['completeWithdrawal'](_0x232f3d,_0x2225f8){const _0x31ddbf=_0x173a56;for(let _0x295d9f=0x0;_0x295d9f<=0x3;_0x295d9f++)try{const _0x4d2b74=this['apiUrl']+'/api/internal/withdrawals/complete/'+_0x232f3d;this['logger'][_0x31ddbf(0x2d5)](_0x31ddbf(0x314)+_0x232f3d+'\x20status\x20to\x20'+_0x2225f8[_0x31ddbf(0x21e)]+'\x20(attempt\x20'+(_0x295d9f+0x1)+_0x31ddbf(0x234));const _0xd1317d={'analyzedStatus':_0x2225f8[_0x31ddbf(0x21e)],'sourceBankCode':_0x2225f8['sourceBankCode'],'sourceAccountNo':_0x2225f8['sourceAccountNo'],'sourceAccountName':_0x2225f8[_0x31ddbf(0x206)]},_0x53bc04=await(0x0,_0x29f863[_0x31ddbf(0x391)])(this['httpService']['patch'](_0x4d2b74,_0xd1317d,{'headers':{'Content-Type':'application/json','X-API-Key':this['apiKey'],'x-internal-secret-key':'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE'},'timeout':0x4e20}));if(0xc8===_0x53bc04['status']||0xcc===_0x53bc04[_0x31ddbf(0x1f3)])return void this['logger']['log'](_0x31ddbf(0x3cb)+_0x232f3d+'\x20status\x20to\x20'+_0x2225f8['analyzedStatus']);this[_0x31ddbf(0x1fd)]['warn']('Unexpected\x20status\x20code\x20'+_0x53bc04['status']+'\x20when\x20updating\x20withdrawal\x20'+_0x232f3d);}catch(_0x5182ed){const _0x3c83e4=_0x5182ed,_0x2068f8=_0x3c83e4['response']?.['data'],_0x3a82a4=_0x3c83e4[_0x31ddbf(0x2a0)];if(_0x295d9f<0x3){const _0x2b5c57=0x7d0*Math['pow'](0x2,_0x295d9f);this['logger']['warn']('Failed\x20to\x20update\x20withdrawal\x20'+_0x232f3d+'\x20(attempt\x20'+(_0x295d9f+0x1)+'/4):\x20'+_0x3a82a4+'.\x20Payload:\x20'+JSON['stringify'](_0x2068f8)+',\x20Retrying\x20in\x20'+_0x2b5c57+'ms'),await(0x0,_0x3c3298[_0x31ddbf(0x26c)])(_0x2b5c57);}else this['logger']['error']('Failed\x20to\x20update\x20withdrawal\x20'+_0x232f3d+_0x31ddbf(0x3f5)+JSON[_0x31ddbf(0xf2)](_0x2068f8)+',\x20Error:\x20'+_0x3a82a4);}}async[_0x173a56(0x39a)](_0x2a025a,_0x28c511){const _0x140ae4=_0x173a56;for(let _0x3b713d=0x0;_0x3b713d<=0x3;_0x3b713d++)try{const _0x186fed=this['apiUrl']+'/api/internal/withdrawals/upload-receipt/'+_0x2a025a;if(this['logger']['log'](_0x140ae4(0x2ac)+_0x2a025a+'\x20(attempt\x20'+(_0x3b713d+0x1)+_0x140ae4(0x234)),!_0x28c511)return void this['logger']['warn'](_0x140ae4(0x1d0)+_0x2a025a);const _0x4f0372=new _0x4d07e1();_0x4f0372['append'](_0x140ae4(0x1a8),(0x0,_0x559a81['createReadStream'])(_0x28c511));const _0x5f5679=await(0x0,_0x29f863['firstValueFrom'])(this['httpService'][_0x140ae4(0x144)](_0x186fed,_0x4f0372,{'headers':{..._0x4f0372['getHeaders'](),'X-API-Key':this[_0x140ae4(0x278)],'x-internal-secret-key':_0x140ae4(0x20e)},'timeout':0x4e20}));if(0xc8===_0x5f5679['status']||0xcc===_0x5f5679['status'])return void this[_0x140ae4(0x1fd)][_0x140ae4(0x2d5)]('Successfully\x20uploaded\x20bill\x20for\x20withdrawal\x20'+_0x2a025a);this['logger']['warn']('Unexpected\x20status\x20code\x20'+_0x5f5679['status']+_0x140ae4(0x382)+_0x2a025a);}catch(_0x16cd76){const _0x1c0c48=_0x16cd76,_0x280a93=_0x1c0c48['response']?.['data'],_0x104708=_0x1c0c48['message'];if(_0x3b713d<0x3){const _0x2a8dd1=0x7d0*Math['pow'](0x2,_0x3b713d);this[_0x140ae4(0x1fd)]['warn'](_0x140ae4(0x366)+_0x2a025a+'\x20(attempt\x20'+(_0x3b713d+0x1)+_0x140ae4(0x3d7)+_0x104708+'.\x20Response:\x20'+JSON[_0x140ae4(0xf2)](_0x280a93)+',\x20Retrying\x20in\x20'+_0x2a8dd1+'ms'),await(0x0,_0x3c3298['sleep'])(_0x2a8dd1);}else this['logger'][_0x140ae4(0xeb)]('Failed\x20to\x20upload\x20bill\x20for\x20withdrawal\x20'+_0x2a025a+'\x20after\x204\x20attempts.\x20Response:\x20'+JSON[_0x140ae4(0xf2)](_0x280a93)+_0x140ae4(0x357)+_0x104708);}}async[_0x173a56(0x1bc)](_0x401d98,_0x48c7c8){const _0x38ac58=_0x173a56;this[_0x38ac58(0x1fd)]['log']('Updating\x20withdrawal\x20'+_0x401d98+_0x38ac58(0xea)+_0x48c7c8);const _0x27f600=this['apiUrl']+'/api/internal/withdrawals/status/'+_0x401d98;await(0x0,_0x29f863['firstValueFrom'])(this['httpService']['patch'](_0x27f600,{'status':_0x48c7c8},{'headers':{'x-internal-secret-key':'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE'}}));}};_0x111a5f['EzpayBeClientService']=_0x1d07c8,_0x111a5f['EzpayBeClientService']=_0x1d07c8=_0x5663dd([(0x0,_0x504117['Injectable'])(),_0x147c54('design:paramtypes',[_0x173a56(0x18d)==typeof(_0x2f8a1f=void 0x0!==_0x91e9c0[_0x173a56(0x121)]&&_0x91e9c0[_0x173a56(0x121)])?_0x2f8a1f:Object])],_0x1d07c8);},_0xd1b112=>{_0xd1b112['exports']=require('rxjs');},function(_0x2fee05,_0x3a8d34,_0x286378){const _0x45454b=a0_0x2e92;var _0x4ebdfd,_0x5873df,_0x5457ef,_0x3b38e8,_0x566f7b,_0x4c3db3,_0x2bcef8,_0x24a4f0,_0x35261a,_0x198dfa,_0x53a860,_0x9651a6=this&&this['__decorate']||function(_0x81a2ea,_0x47f1b4,_0x591681,_0x230e85){const _0x2751c6=a0_0x2e92;var _0x5d96f1,_0x2f793a=arguments['length'],_0x1b4134=_0x2f793a<0x3?_0x47f1b4:null===_0x230e85?_0x230e85=Object[_0x2751c6(0x25c)](_0x47f1b4,_0x591681):_0x230e85;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x1b4134=Reflect['decorate'](_0x81a2ea,_0x47f1b4,_0x591681,_0x230e85);else{for(var _0x54b397=_0x81a2ea['length']-0x1;_0x54b397>=0x0;_0x54b397--)(_0x5d96f1=_0x81a2ea[_0x54b397])&&(_0x1b4134=(_0x2f793a<0x3?_0x5d96f1(_0x1b4134):_0x2f793a>0x3?_0x5d96f1(_0x47f1b4,_0x591681,_0x1b4134):_0x5d96f1(_0x47f1b4,_0x591681))||_0x1b4134);}return _0x2f793a>0x3&&_0x1b4134&&Object['defineProperty'](_0x47f1b4,_0x591681,_0x1b4134),_0x1b4134;},_0x2e9462=this&&this['__metadata']||function(_0x338ab3,_0x162f92){const _0x36a0eb=a0_0x2e92;if('object'==typeof Reflect&&_0x36a0eb(0x18d)==typeof Reflect[_0x36a0eb(0x3ac)])return Reflect['metadata'](_0x338ab3,_0x162f92);},_0x58fa5f=this&&this['__param']||function(_0x4f9249,_0x5e1795){return function(_0x34a97e,_0xdecf86){_0x5e1795(_0x34a97e,_0xdecf86,_0x4f9249);};};Object[_0x45454b(0x3cc)](_0x3a8d34,'__esModule',{'value':!0x0}),_0x3a8d34[_0x45454b(0x2a1)]=void 0x0;const _0x25444a=_0x286378(0x2),_0x321860=_0x286378(0x7),_0x1ca04f=_0x286378(0x6),_0x4bb0f8=_0x286378(0x39),_0xa84230=_0x286378(0xa),_0x806bff=_0x286378(0xe),_0x421026=_0x286378(0x14),_0x2a4b94=_0x286378(0xd),_0x56dbdb=_0x286378(0x13),_0x59d81f=_0x286378(0x3a),_0x266b38=_0x286378(0x2a),_0x4d2762=_0x286378(0x16),_0x47e821=_0x286378(0x3c),_0x4960f7=_0x286378(0xb),_0x40df5f=_0x286378(0x35),_0x4b08c3=_0x286378(0x3d),_0x6ba5ea=_0x286378(0x3e),_0x53209b=_0x286378(0x41),_0xb2775a=_0x286378(0x42),_0x22396d=_0x286378(0x2c),_0x1ceac8=_0x286378(0x18),_0xb38a3=_0x286378(0x43),_0x32990a=_0x286378(0xf),_0x2ee65b=_0x286378(0x45),_0x167d81=_0x286378(0x11);let _0x4fbb6d=class{constructor(_0x43c0dd,_0x5ceded,_0x1104c1,_0x4cd8da,_0x14f09d,_0x2bb9e2,_0x3c34dc,_0x4d7474,_0x1555a7,_0x26f961,_0x586515){const _0x8b7336=_0x45454b;this['withdrawalQueue']=_0x43c0dd,this['withdrawalService']=_0x5ceded,this['deviceService']=_0x1104c1,this['deviceLockService']=_0x4cd8da,this[_0x8b7336(0x2e6)]=_0x14f09d,this['bankService']=_0x2bb9e2,this['notificationService']=_0x3c34dc,this['windowsAppGitBashService']=_0x4d7474,this['redisLockService']=_0x1555a7,this['telegramService']=_0x26f961,this[_0x8b7336(0x1b2)]=_0x586515,this['logger']=new _0x25444a['Logger']('WithdrawalJobManagerService'),this['processingJobs']=new Set(),this[_0x8b7336(0x151)]=!0x1,this[_0x8b7336(0x248)]=!0x1,this['cronRestartBoxphoneEnabled']=!0x1;}async['onModuleInit'](){const _0x5d6a73=_0x45454b;this[_0x5d6a73(0x1fd)]['log']('WithdrawalJobManagerService\x20initialized,\x20waiting\x205\x20seconds\x20before\x20starting...'),this['initializeJobProcessing'](),this['scheduleCronRestartBoxphone']();}async[_0x45454b(0x1c2)](){setTimeout(async()=>{this['isInitialized']||(this['logger']['log']('Starting\x20withdrawal\x20job\x20processing...'),await this['pickAndProcessJobs'](),this['isInitialized']=!0x0);},0x1388);}[_0x45454b(0x17a)](){const _0x449e77=new Date(),_0x128475=0x3e8*(0x3c-_0x449e77['getSeconds']())-_0x449e77['getMilliseconds']();setTimeout(()=>{this['cronRestartBoxphoneEnabled']=!0x0;},_0x128475);}async['restartBoxphone'](){const _0x290254=_0x45454b;if(!await this['deviceLockService']['hasAnyLockKeys']()){const _0x3e0b12='development'===_0x167d81['config']['NODE_ENV']?_0x290254(0x2b9):'üöÄüöÄüöÄ\x20<b>Boxphone\x20software...</b>';this['telegramService'][_0x290254(0x2e0)]({'text':_0x3e0b12+(_0x290254(0x312)+new Date()['toLocaleString']('vi-VN',{'timeZone':_0x290254(0x332)})+_0x290254(0x379)),'options':{'parseMode':'HTML'}}),await this[_0x290254(0x1fc)][_0x290254(0x28d)]({'processName':_0x290254(0x241),'exePath':'C:/Users/Public/Desktop/ÊïàÂç´ËãπÊûúÊäïÂ±è.lnk','runAsAdmin':!0x0,'killAsAdmin':!0x0}),this['telegramService']['sendMessage']({'text':'‚úÖ\x20<b>Boxphone\x20software</b>\x0a\x0a<b>Kh·ªüi\x20ƒë·ªông\x20l·∫°i\x20th√†nh\x20c√¥ng:</b>\x20'+new Date()['toLocaleString']('vi-VN',{'timeZone':'Asia/Ho_Chi_Minh'})+_0x290254(0x1cd),'options':{'parseMode':_0x290254(0x29a)}});try{await(0x0,_0x1ceac8['sleep'])(0x1388),await this[_0x290254(0x2c1)]['loginAllActiveBanks']();}catch(_0x3a69ea){this['logger']['error']('Error\x20logging\x20in\x20all\x20active\x20banks:\x20'+_0x3a69ea['stack']);}finally{await(0x0,_0x1ceac8[_0x290254(0x26c)])(0x3e8),await this[_0x290254(0x172)]['releaseLock'](_0xb2775a['SYSTEM_LOCK_BOXPHONE']);}}}async['pickAndProcessJobs'](_0x1608bb){const _0x2c4865=_0x45454b;try{if(await this['redisLockService']['getLock'](_0xb2775a['SYSTEM_LOCK_BOXPHONE'])){if(this['isRestartingBoxphone'])return;return this['isRestartingBoxphone']=!0x0,await this[_0x2c4865(0xec)](),void(this['isRestartingBoxphone']=!0x1);}if(!this['wsService']['isConnectedStatus']())return void this['logger'][_0x2c4865(0xeb)]('WebSocket\x20is\x20not\x20connected,\x20cannot\x20pick\x20jobs');const _0x135bd4=await this['deviceService']['getServiceStatus']();if(_0x2c4865(0x254)!==_0x135bd4)return void this['logger'][_0x2c4865(0x266)]('Service\x20is\x20'+_0x135bd4+',\x20cannot\x20pick\x20jobs');const _0x1af6b1=await this['deviceService'][_0x2c4865(0x18e)](),_0x32a09c=_0x1af6b1['length'];if(_0x32a09c<=0x0)return;const _0x1f6a8f=_0x1608bb?Math['min'](_0x1608bb,_0x32a09c):_0x32a09c,_0x1a1c30=await this[_0x2c4865(0x1b2)]['pickFromZSet'](_0x2ee65b['JOB_PRIORITY_KEY'],_0x1f6a8f);if(0x0===_0x1a1c30['length'])return;this['logger']['log'](_0x2c4865(0x37c)+_0x1af6b1[_0x2c4865(0x1fe)]+'\x20available\x20devices.\x20Picking\x20'+_0x1a1c30['length']+'\x20jobs\x20('+(_0x1a1c30||[])['length']+_0x2c4865(0x2d8));for(let _0x285637=0x0;_0x285637<_0x1a1c30['length'];_0x285637++){const _0x2da2fc=_0x1a1c30[_0x285637]['jobId'],_0x290721=await this['withdrawalQueue'][_0x2c4865(0x190)](_0x2da2fc),_0x3faf60=_0x1af6b1[_0x285637];if(this['processingJobs']['has'](_0x290721['id']))continue;const _0x2f4c4b=_0x2c4865(0x1a4)+_0x290721['data']['withdrawalId']+':'+_0x3faf60['deviceId'];await this[_0x2c4865(0x3cf)]['acquireLock'](_0x3faf60[_0x2c4865(0x14b)],'transfer',_0x2f4c4b,0x35e80)?this['processJob'](_0x290721,_0x3faf60)['catch'](_0x55cc6e=>{const _0xbd00a3=_0x2c4865;this['logger']['error']('Error\x20processing\x20job\x20'+_0x290721['id']+':\x20'+_0x55cc6e[_0xbd00a3(0x2a0)],_0x55cc6e[_0xbd00a3(0x3d6)]);})['finally'](()=>{this['deviceLockService']['releaseLock'](_0x3faf60['deviceId'])['catch'](()=>{});}):this[_0x2c4865(0x1fd)]['warn'](_0x2c4865(0x2f4)+_0x3faf60['deviceId']+'\x20was\x20locked\x20after\x20assignment,\x20skipping\x20job\x20'+_0x290721['id']);}}catch(_0x4ce099){this['logger']['error'](_0x2c4865(0x2f7)+_0x4ce099['message'],_0x4ce099[_0x2c4865(0x3d6)]);}}async[_0x45454b(0x3bc)](_0x111dd3,_0x521f65){const _0x5c78b4=_0x45454b;let _0x267cab;try{_0x267cab=(0x0,_0x4d2762['cloneDeep'])(_0x111dd3['data']),await _0x111dd3['remove']();const _0x5c58ca=await(0x0,_0xb38a3['validateObjectResult'])(_0x59d81f[_0x5c78b4(0x28c)],_0x267cab);if(!_0x5c58ca['ok'])throw new _0x266b38['WithdrawalProcessingError']('Invalid\x20withdrawal:\x20missing\x20'+_0x5c58ca[_0x5c78b4(0x348)]['map'](_0x29464e=>_0x29464e[_0x5c78b4(0x24b)])[_0x5c78b4(0x3ed)](',\x20'),_0x266b38[_0x5c78b4(0x123)]['PERMANENT']);this['telegramService'][_0x5c78b4(0x2e0)]({'text':_0x5c78b4(0x270)+_0x267cab['withdrawalId']+_0x5c78b4(0x183)+_0x267cab['withdrawalCode']+'\x0a<b>From:</b>\x20'+_0x521f65['bankCode']+_0x5c78b4(0x185)+_0x521f65[_0x5c78b4(0x1f4)]+'\x0a<b>To:</b>\x20'+_0x267cab[_0x5c78b4(0x3e3)]+_0x5c78b4(0x185)+_0x267cab['beneficiaryName']+'\x0a<b>Amount:</b>\x20'+_0x267cab[_0x5c78b4(0x2ce)]+'\x0a<b>Description:</b>\x20'+_0x267cab['description'],'options':{'parseMode':'HTML'}})['catch'](_0x2f565a=>{this['logger']['error']('Error\x20sending\x20message\x20for\x20withdrawal\x20'+_0x267cab['withdrawalId']+':\x20'+_0x2f565a['message'],_0x2f565a['stack']);});const {_id:_0x15e26a,withdrawalId:_0x3bf398}=_0x267cab;this['logger'][_0x5c78b4(0x2d5)]('Successfully\x20picked\x20and\x20removed\x20withdrawal\x20'+_0x3bf398+_0x5c78b4(0xf3)),this['processingJobs'][_0x5c78b4(0x2ae)](_0x111dd3['id']);const _0x1e2a4f=await this['withdrawalService']['getWithdrawalDetails'](_0x15e26a);if(![_0x4b08c3[_0x5c78b4(0x1b9)][_0x5c78b4(0x30b)],_0x4b08c3[_0x5c78b4(0x1b9)]['RETRY']]['includes'](_0x1e2a4f[_0x5c78b4(0x1f3)]))throw this['logger']['warn']('WDA\x20'+_0x3bf398+'\x20('+_0x1e2a4f[_0x5c78b4(0x1f3)]+_0x5c78b4(0x17f)),new _0x266b38['WithdrawalProcessingError']('Withdrawal\x20not\x20pending\x20or\x20retry,\x20skipping\x20('+_0x1e2a4f[_0x5c78b4(0x1f3)]+')',_0x266b38['ErrorType']['PERMANENT']);this['notificationService'][_0x5c78b4(0x1bc)](_0x15e26a,_0x4b08c3['WithdrawalStatus'][_0x5c78b4(0x140)])['catch'](_0xedcef9=>{const _0x43db68=_0x5c78b4;this['logger']['error'](_0x43db68(0x2d2)+_0x3bf398+':\x20'+_0xedcef9['message'],_0xedcef9[_0x43db68(0x3d6)]);}),await this['bankService'][_0x5c78b4(0x3aa)](_0x521f65['bankCode'],_0x521f65['deviceId'],_0x267cab),await this['bankService'][_0x5c78b4(0x365)](_0x521f65[_0x5c78b4(0x126)],_0x267cab[_0x5c78b4(0xf8)]),await this[_0x5c78b4(0x1a5)][_0x5c78b4(0x220)](_0x267cab,_0x521f65[_0x5c78b4(0x14b)]);}catch(_0x595ee2){let _0x23871c;_0x595ee2 instanceof _0x266b38[_0x5c78b4(0x22d)]&&(_0x23871c=_0x595ee2['errorType'],this['logger'][_0x5c78b4(0xeb)](_0x5c78b4(0x380)+_0x267cab['withdrawalId']+':\x20'+_0x23871c+'-'+_0x595ee2['message'],_0x595ee2['stack']),await this['handleJobFailure'](_0x521f65,_0x267cab,_0x595ee2['message'],_0x23871c));}finally{this['processingJobs']['delete'](_0x111dd3['id']);}}async['handleJobFailure'](_0x97a26c,_0x2d8246,_0x8b0712,_0x90f0b2=_0x266b38[_0x45454b(0x123)][_0x45454b(0x13d)]){const _0x736fa8=_0x45454b,_0x2bee42=_0x2d8246[_0x736fa8(0x171)]??0x1;switch(_0x90f0b2){case _0x266b38[_0x736fa8(0x123)][_0x736fa8(0x13d)]:return void this['notificationService']['updateWithdrawalStatus'](_0x2d8246['_id'],_0x4b08c3['WithdrawalStatus']['FAILED'])['catch'](_0x11222d=>{const _0x42dc9a=_0x736fa8;this[_0x42dc9a(0x1fd)][_0x42dc9a(0xeb)]('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x2d8246['withdrawalId']+':\x20'+_0x11222d[_0x42dc9a(0x2a0)],_0x11222d[_0x42dc9a(0x3d6)]);});case _0x266b38['ErrorType']['NO_BILL_AFTER_OTP']:await this['bankService'][_0x736fa8(0x341)](_0x97a26c[_0x736fa8(0x126)],_0x97a26c['deviceId'],_0x2d8246['withdrawalCode']);const _0x1a6855=await this['bankService']['getBillImagePath'](_0x97a26c['bankCode'],_0x2d8246[_0x736fa8(0xf8)]);return _0x1a6855&&(this['logger']['log']('Uploading\x20receipt\x20for\x20withdrawal\x20'+_0x2d8246['withdrawalCode']+'\x20-\x20'+_0x1a6855),await this['notificationService']['uploadReceipt'](_0x2d8246['_id'],_0x1a6855)),await this[_0x736fa8(0xdd)]['updateWithdrawalStatus'](_0x2d8246['_id'],_0x4b08c3['WithdrawalStatus']['UNKNOWN']),void await this['bankService']['login'](_0x97a26c['bankCode'],_0x97a26c['deviceId'],!0x0);case _0x266b38['ErrorType']['FORCE_LOGIN']:await this['bankService']['login'](_0x97a26c[_0x736fa8(0x126)],_0x97a26c['deviceId'],!0x0);default:this['logger'][_0x736fa8(0x1eb)]('Added\x20'+_0x2d8246['withdrawalId']+'\x20to\x20queue\x20for\x20retrying.\x20('+_0x2bee42+_0x736fa8(0x2e5)+_0x8b0712+'.\x20Error\x20Type:\x20'+_0x90f0b2+'.'),_0x2bee42<0x2?(await this['withdrawalQueue']['add']('process-withdrawal-request',{..._0x2d8246,'manualRetryCount':_0x2bee42+0x1,'lastErrorType':_0x90f0b2,'lastErrorReason':_0x8b0712},{'attempts':0x0,'removeOnComplete':!0x1,'removeOnFail':!0x1,'jobId':'withdrawal-request-'+_0x2d8246['withdrawalId'],'priority':0x1,'delay':0x7530}),this['notificationService']['updateWithdrawalStatus'](_0x2d8246['_id'],_0x4b08c3['WithdrawalStatus']['RETRY'])[_0x736fa8(0x1ec)](_0x2c520b=>{const _0x3ce50c=_0x736fa8;this['logger']['error']('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x2d8246[_0x3ce50c(0x245)]+':\x20'+_0x2c520b['message'],_0x2c520b[_0x3ce50c(0x3d6)]);})):(this['logger']['warn']('Max\x20retries\x20(2)\x20exceeded\x20for\x20withdrawal\x20'+_0x2d8246[_0x736fa8(0x245)]+':\x20'+_0x90f0b2+'\x20error:\x20'+_0x8b0712),this['notificationService']['updateWithdrawalStatus'](_0x2d8246[_0x736fa8(0x2a9)],_0x4b08c3[_0x736fa8(0x1b9)]['FAILED'])['catch'](_0x342a96=>{const _0x59464c=_0x736fa8;this[_0x59464c(0x1fd)]['error']('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x2d8246[_0x59464c(0x245)]+':\x20'+_0x342a96['message'],_0x342a96['stack']);}));}}async['promoteDelayedJobs'](){const _0x189526=_0x45454b;return(0x0,_0x47e821[_0x189526(0x1b0)])('cron:promote_delayed:withdrawal',0x1388,async()=>{const _0x25c3d4=_0x189526,_0x1014e4=Date['now'](),_0x59ba6c=await this[_0x25c3d4(0x1e5)]['getJobs']([_0x25c3d4(0x296)],0x0,0x63);if(!_0x59ba6c[_0x25c3d4(0x1fe)])return;let _0x7a281c=0x0;for(const _0x4fb7d8 of _0x59ba6c){const _0x219c60=_0x25c3d4(0x370)==typeof _0x4fb7d8[_0x25c3d4(0x10f)]?.[_0x25c3d4(0x1b6)]?_0x4fb7d8['opts']['delay']:0x0;if(('number'==typeof _0x4fb7d8[_0x25c3d4(0x2e8)]?_0x4fb7d8['timestamp']:0x0)+_0x219c60<=_0x1014e4)try{await _0x4fb7d8[_0x25c3d4(0x360)](),_0x7a281c++;}catch(_0x26eeae){this['logger'][_0x25c3d4(0x266)]('Promote\x20skipped\x20for\x20job\x20'+_0x4fb7d8['id']+':\x20'+String(_0x26eeae));}}_0x7a281c>0x0&&this[_0x25c3d4(0x1fd)]['log']('Promoted\x20'+_0x7a281c+_0x25c3d4(0x13e));});}async['triggerPickJobs'](_0x4a0dd0=0x1){const _0x5a5a04=_0x45454b;await this[_0x5a5a04(0x3cd)](_0x4a0dd0);}async[_0x45454b(0x119)](){const _0x7a3a05=_0x45454b,[_0x5956a8,_0x5017ba,_0x3402bd,_0x2d6d3b,_0x4425d6,_0x4d426a,_0x51e42b]=await Promise['all']([this['withdrawalQueue'][_0x7a3a05(0x297)](),this['withdrawalQueue'][_0x7a3a05(0x347)](),this[_0x7a3a05(0x1e5)]['getActiveCount'](),this['withdrawalQueue']['getCompletedCount'](),this['withdrawalQueue']['getFailedCount'](),this['deviceService']['getAvailableDevices'](),this[_0x7a3a05(0x25e)]['getServiceStatus']()]);return{'serviceStatus':_0x51e42b,'activeDevices':_0x4d426a[_0x7a3a05(0x1fe)],'processingJobs':this['processingJobs']['size'],'isInitialized':this['isInitialized'],'queue':{'waiting':_0x5956a8,'delayed':_0x5017ba,'active':_0x3402bd,'completed':_0x2d6d3b,'failed':_0x4425d6,'total':_0x5956a8+_0x5017ba+_0x3402bd}};}async['debugQueue'](){const _0x41cd3b=_0x45454b,_0x18a3c3=await this['getQueueStats'](),[_0x33bba0,_0x106a69]=await Promise['all']([this['withdrawalQueue']['getJobs']([_0x41cd3b(0x2c0)],0x0,0x9),this['withdrawalQueue']['getJobs']([_0x41cd3b(0x296)],0x0,0x9)]);return{..._0x18a3c3,'sampleWaitingJobs':_0x33bba0[_0x41cd3b(0x352)](_0xbad3ca=>({'id':_0xbad3ca['id'],'data':_0xbad3ca[_0x41cd3b(0x339)],'opts':_0xbad3ca['opts'],'manualRetryCount':_0xbad3ca['data']['manualRetryCount']})),'sampleDelayedJobs':_0x106a69['map'](_0x2ae1fb=>({'id':_0x2ae1fb['id'],'data':_0x2ae1fb[_0x41cd3b(0x339)],'opts':_0x2ae1fb[_0x41cd3b(0x10f)],'manualRetryCount':_0x2ae1fb['data'][_0x41cd3b(0x171)]}))};}async['periodicJobPicking'](){const _0x831756=_0x45454b;await this['redisLockService']['isLocked'](_0xb2775a['SYSTEM_LOCK_PAUSE_PROCESSING'])?this['logger']['warn']('Transfer\x20is\x20paused\x20by\x20admin\x20temporarily!'):await this[_0x831756(0x3cd)]();}async['promoteDelayedJobsPeriodically'](){const _0x159154=_0x45454b;await this[_0x159154(0x116)]();}async['restartPandaBoxPeriodically'](){const _0x3e3468=await this['deviceService']['getServiceStatus']();this['cronRestartBoxphoneEnabled']&&'active'===_0x3e3468&&await this['redisLockService']['acquireLock'](_0xb2775a['SYSTEM_LOCK_BOXPHONE'],0x2bf20);}};_0x3a8d34[_0x45454b(0x2a1)]=_0x4fbb6d,_0x9651a6([(0x0,_0x321860['Cron'])(_0x321860['CronExpression']['EVERY_5_SECONDS']),_0x2e9462('design:type',Function),_0x2e9462('design:paramtypes',[]),_0x2e9462('design:returntype',Promise)],_0x4fbb6d['prototype'],'periodicJobPicking',null),_0x9651a6([(0x0,_0x321860['Cron'])(_0x321860['CronExpression']['EVERY_5_SECONDS']),_0x2e9462(_0x45454b(0x19a),Function),_0x2e9462(_0x45454b(0x22c),[]),_0x2e9462('design:returntype',Promise)],_0x4fbb6d[_0x45454b(0x2b4)],'promoteDelayedJobsPeriodically',null),_0x9651a6([(0x0,_0x321860['Cron'])('0\x20*/59\x20*\x20*\x20*\x20*'),_0x2e9462(_0x45454b(0x19a),Function),_0x2e9462('design:paramtypes',[]),_0x2e9462('design:returntype',Promise)],_0x4fbb6d[_0x45454b(0x2b4)],'restartPandaBoxPeriodically',null),_0x3a8d34['WithdrawalJobManagerService']=_0x4fbb6d=_0x9651a6([(0x0,_0x25444a[_0x45454b(0x19b)])(),_0x58fa5f(0x0,(0x0,_0x1ca04f['InjectQueue'])('wda-request')),_0x58fa5f(0x4,(0x0,_0x25444a[_0x45454b(0x33a)])(_0x2a4b94['WEBSOCKET_SERVICE'])),_0x2e9462('design:paramtypes',[_0x45454b(0x18d)==typeof(_0x4ebdfd=void 0x0!==_0x4bb0f8['Queue']&&_0x4bb0f8[_0x45454b(0x356)])?_0x4ebdfd:Object,'function'==typeof(_0x5873df=void 0x0!==_0xa84230[_0x45454b(0x249)]&&_0xa84230['WithdrawalService'])?_0x5873df:Object,'function'==typeof(_0x5457ef=void 0x0!==_0x806bff[_0x45454b(0x204)]&&_0x806bff['DeviceService'])?_0x5457ef:Object,'function'==typeof(_0x3b38e8=void 0x0!==_0x421026[_0x45454b(0x38e)]&&_0x421026['DeviceLockService'])?_0x3b38e8:Object,_0x45454b(0x18d)==typeof(_0x566f7b=void 0x0!==_0x56dbdb['IWebSocketService']&&_0x56dbdb['IWebSocketService'])?_0x566f7b:Object,'function'==typeof(_0x4c3db3=void 0x0!==_0x4960f7[_0x45454b(0x261)]&&_0x4960f7['BankService'])?_0x4c3db3:Object,'function'==typeof(_0x2bcef8=void 0x0!==_0x40df5f['NotificationService']&&_0x40df5f['NotificationService'])?_0x2bcef8:Object,'function'==typeof(_0x24a4f0=void 0x0!==_0x6ba5ea['WindowsAppGitBashService']&&_0x6ba5ea['WindowsAppGitBashService'])?_0x24a4f0:Object,_0x45454b(0x18d)==typeof(_0x35261a=void 0x0!==_0x53209b['RedisLockService']&&_0x53209b[_0x45454b(0x309)])?_0x35261a:Object,'function'==typeof(_0x198dfa=void 0x0!==_0x22396d['TelegramService']&&_0x22396d[_0x45454b(0x321)])?_0x198dfa:Object,'function'==typeof(_0x53a860=void 0x0!==_0x32990a['RedisService']&&_0x32990a['RedisService'])?_0x53a860:Object])],_0x4fbb6d);},_0x466c5b=>{const _0x2deb5e=a0_0x2e92;_0x466c5b[_0x2deb5e(0x29f)]=require('bull');},function(_0x1436c9,_0x55135c,_0x652d30){const _0x266ed3=a0_0x2e92;var _0x1198c7,_0x57075d=this&&this[_0x266ed3(0x21f)]||function(_0x11558e,_0x2a1902,_0x4d8741,_0x47f652){const _0x1cbe3e=_0x266ed3;var _0x117fea,_0x2529db=arguments['length'],_0x1ffe9c=_0x2529db<0x3?_0x2a1902:null===_0x47f652?_0x47f652=Object['getOwnPropertyDescriptor'](_0x2a1902,_0x4d8741):_0x47f652;if(_0x1cbe3e(0x141)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x1ffe9c=Reflect['decorate'](_0x11558e,_0x2a1902,_0x4d8741,_0x47f652);else{for(var _0x120ef2=_0x11558e[_0x1cbe3e(0x1fe)]-0x1;_0x120ef2>=0x0;_0x120ef2--)(_0x117fea=_0x11558e[_0x120ef2])&&(_0x1ffe9c=(_0x2529db<0x3?_0x117fea(_0x1ffe9c):_0x2529db>0x3?_0x117fea(_0x2a1902,_0x4d8741,_0x1ffe9c):_0x117fea(_0x2a1902,_0x4d8741))||_0x1ffe9c);}return _0x2529db>0x3&&_0x1ffe9c&&Object[_0x1cbe3e(0x3cc)](_0x2a1902,_0x4d8741,_0x1ffe9c),_0x1ffe9c;},_0x41d59d=this&&this[_0x266ed3(0x3c1)]||function(_0x46a61b,_0x41f787){const _0x3244a4=_0x266ed3;if('object'==typeof Reflect&&_0x3244a4(0x18d)==typeof Reflect['metadata'])return Reflect[_0x3244a4(0x3ac)](_0x46a61b,_0x41f787);};Object['defineProperty'](_0x55135c,_0x266ed3(0x110),{'value':!0x0}),_0x55135c[_0x266ed3(0x28c)]=void 0x0;const _0x4453d7=_0x652d30(0x2a),_0x22a748=_0x652d30(0x3b);class _0x1df4fe{}_0x55135c[_0x266ed3(0x28c)]=_0x1df4fe,_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d('design:type',String)],_0x1df4fe[_0x266ed3(0x2b4)],'_id',void 0x0),_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d(_0x266ed3(0x19a),String)],_0x1df4fe['prototype'],'withdrawalId',void 0x0),_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d(_0x266ed3(0x19a),String)],_0x1df4fe['prototype'],'withdrawalCode',void 0x0),_0x57075d([(0x0,_0x22a748[_0x266ed3(0x316)])(),_0x41d59d('design:type',String)],_0x1df4fe['prototype'],'bankCode',void 0x0),_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d(_0x266ed3(0x19a),String)],_0x1df4fe[_0x266ed3(0x2b4)],'beneficiaryAccountNo',void 0x0),_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d('design:type',String)],_0x1df4fe['prototype'],'beneficiaryName',void 0x0),_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d(_0x266ed3(0x19a),Number)],_0x1df4fe['prototype'],'amount',void 0x0),_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d(_0x266ed3(0x19a),String)],_0x1df4fe['prototype'],_0x266ed3(0x3eb),void 0x0),_0x57075d([(0x0,_0x22a748[_0x266ed3(0x316)])(),_0x41d59d('design:type',String)],_0x1df4fe[_0x266ed3(0x2b4)],'status',void 0x0),_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d(_0x266ed3(0x19a),String)],_0x1df4fe[_0x266ed3(0x2b4)],'description',void 0x0),_0x57075d([(0x0,_0x22a748['IsNotEmpty'])(),_0x41d59d('design:type',String)],_0x1df4fe['prototype'],'createdAt',void 0x0),_0x57075d([(0x0,_0x22a748[_0x266ed3(0x23e)])(),_0x41d59d('design:type',Number)],_0x1df4fe['prototype'],'manualRetryCount',void 0x0),_0x57075d([(0x0,_0x22a748['IsOptional'])(),_0x41d59d(_0x266ed3(0x19a),'function'==typeof(_0x1198c7=void 0x0!==_0x4453d7[_0x266ed3(0x123)]&&_0x4453d7['ErrorType'])?_0x1198c7:Object)],_0x1df4fe['prototype'],'lastErrorType',void 0x0),_0x57075d([(0x0,_0x22a748['IsOptional'])(),_0x41d59d('design:type',String)],_0x1df4fe['prototype'],_0x266ed3(0x37f),void 0x0);},_0x39b15f=>{_0x39b15f['exports']=require('class-validator');},(_0x412481,_0x14154e,_0x56ab75)=>{const _0x1be530=a0_0x2e92;Object['defineProperty'](_0x14154e,'__esModule',{'value':!0x0}),_0x14154e[_0x1be530(0x1b0)]=void 0x0;const _0x56e4b5=_0x56ab75(0x10),_0x56fd1e=_0x56ab75(0x11),_0x212d5e=new _0x56e4b5['default']({'host':_0x56fd1e['config']['redis']['host'],'port':_0x56fd1e['config'][_0x1be530(0x229)][_0x1be530(0x232)],'password':_0x56fd1e['config']['redis']['password'],'db':_0x56fd1e['config']['redis']['db']});_0x14154e['withCronLock']=async(_0x3a9504,_0x4d8be9,_0x6df66)=>{const _0x1e409b=_0x1be530,_0x303ccf=process['pid']+':'+Date['now']();if(await _0x212d5e[_0x1e409b(0x1c0)](_0x3a9504,_0x303ccf,'PX',_0x4d8be9,'NX'))try{await _0x6df66();}finally{const _0x42f4a9='\x0a\x20\x20\x20\x20\x20\x20if\x20redis.call(\x22GET\x22,\x20KEYS[1])\x20==\x20ARGV[1]\x20then\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20redis.call(\x22DEL\x22,\x20KEYS[1])\x0a\x20\x20\x20\x20\x20\x20end\x0a\x20\x20\x20\x20\x20\x20return\x200\x0a\x20\x20\x20\x20';await _0x212d5e['eval'](_0x42f4a9,0x1,_0x3a9504,_0x303ccf);}};},(_0x228d2d,_0x2f448b)=>{var _0x84d235;Object['defineProperty'](_0x2f448b,'__esModule',{'value':!0x0}),_0x2f448b['WithdrawalStatus']=void 0x0,function(_0x3b9fe0){const _0x247890=a0_0x2e92;_0x3b9fe0['PENDING']='PENDING',_0x3b9fe0['FAILED']='FAILED',_0x3b9fe0[_0x247890(0x140)]=_0x247890(0x140),_0x3b9fe0[_0x247890(0x125)]='RETRY',_0x3b9fe0['COMPLETED']=_0x247890(0x198),_0x3b9fe0['UNKNOWN']=_0x247890(0x27a),_0x3b9fe0['NA']='NA';}(_0x84d235||(_0x2f448b['WithdrawalStatus']=_0x84d235={}));},function(_0x1ec767,_0x14b2bb,_0x4844b1){const _0x5ca8f9=a0_0x2e92;var _0x48305c,_0x2a6afa=this&&this[_0x5ca8f9(0x21f)]||function(_0x3a527b,_0x1d4887,_0xfd3ca7,_0x1caee9){const _0x2d7faf=_0x5ca8f9;var _0x58144e,_0x5e74aa=arguments['length'],_0x590fa7=_0x5e74aa<0x3?_0x1d4887:null===_0x1caee9?_0x1caee9=Object['getOwnPropertyDescriptor'](_0x1d4887,_0xfd3ca7):_0x1caee9;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x590fa7=Reflect[_0x2d7faf(0x3b0)](_0x3a527b,_0x1d4887,_0xfd3ca7,_0x1caee9);else{for(var _0x1df053=_0x3a527b['length']-0x1;_0x1df053>=0x0;_0x1df053--)(_0x58144e=_0x3a527b[_0x1df053])&&(_0x590fa7=(_0x5e74aa<0x3?_0x58144e(_0x590fa7):_0x5e74aa>0x3?_0x58144e(_0x1d4887,_0xfd3ca7,_0x590fa7):_0x58144e(_0x1d4887,_0xfd3ca7))||_0x590fa7);}return _0x5e74aa>0x3&&_0x590fa7&&Object['defineProperty'](_0x1d4887,_0xfd3ca7,_0x590fa7),_0x590fa7;};Object['defineProperty'](_0x14b2bb,'__esModule',{'value':!0x0}),_0x14b2bb['WindowsAppGitBashService']=void 0x0;const _0xa65fd7=_0x4844b1(0x2),_0x2a1cba=_0x4844b1(0x3f),_0x1d8527=_0x4844b1(0x40),_0x58299a=_0x4844b1(0x18),_0x286fcd=(0x0,_0x1d8527['promisify'])(_0x2a1cba['exec']);let _0x46ff99=_0x48305c=class{constructor(){this['logger']=new _0xa65fd7['Logger'](_0x48305c['name']);}async['restartApp'](_0x70e7b){const _0x37fbae=_0x5ca8f9,{processName:_0x523b54,exePath:_0x4db648,startTarget:_0x3559c8,gracefulWaitMs:_0x3db6d7=0x4b0,forceKillWaitMs:_0x47e050=0x1f4,startDelayMs:_0x5e997b=0x12c,runAsAdmin:_0x3a9cf2=!0x1,killAsAdmin:_0x5cdf18=!0x1}=_0x70e7b;try{if(await this['closeMainWindow'](_0x523b54)['catch'](()=>{}),await(0x0,_0x58299a['sleep'])(_0x3db6d7),await this['forceKill'](_0x523b54,_0x5cdf18)[_0x37fbae(0x1ec)](()=>{}),await(0x0,_0x58299a['sleep'])(_0x47e050),await this['waitUntilNotRunning'](_0x523b54,0x1388)['catch'](()=>{}),await(0x0,_0x58299a[_0x37fbae(0x26c)])(_0x5e997b),_0x4db648)return void await this['startApp']({'exePath':_0x4db648,'runAsAdmin':_0x3a9cf2});if(_0x3559c8)return void await this['startApp']({'startTarget':_0x3559c8,'runAsAdmin':_0x3a9cf2});const _0x4ddb3c=_0x523b54['replace'](/\.exe$/i,'');await this['startApp']({'startTarget':_0x4ddb3c,'runAsAdmin':_0x3a9cf2});}catch(_0x3f2de6){const _0x208a0f=_0x3f2de6?.[_0x37fbae(0x2a0)]||String(_0x3f2de6);throw this['logger']['error']('[restart]\x20Failed\x20to\x20restart\x20app:\x20'+_0x208a0f,_0x3f2de6?.['stack']),_0x3f2de6;}}async[_0x5ca8f9(0x35b)](_0x436fc5){const _0x20dd88=_0x436fc5['replace'](/\.exe$/i,''),_0x38d94a='Get-Process\x20-Name\x20\x22'+this['escapePs'](_0x20dd88)+'\x22\x20-ErrorAction\x20SilentlyContinue\x20|\x20ForEach-Object\x20{\x20$_.CloseMainWindow()\x20|\x20Out-Null\x20}',_0x220c30='powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22'+this['escapePs'](_0x38d94a)+'\x22';try{await _0x286fcd(_0x220c30,{'windowsHide':!0x0});}catch(_0x5b1262){if(!(_0x5b1262?.['message']||String(_0x5b1262)||'')['includes']('Cannot\x20find\x20a\x20process'))throw _0x5b1262;}}async[_0x5ca8f9(0x20d)](_0x52f288,_0x15ae34=!0x1){const _0x4aa1bf=_0x5ca8f9,_0x3f7c01=_0x52f288['replace'](/\.exe$/i,'');try{return void await this['forceKillWithPowerShell'](_0x3f7c01,_0x15ae34);}catch(_0x4bb187){const _0x19c653=(_0x4bb187?.['message']||_0x4bb187?.['stderr']||String(_0x4bb187)||'')[_0x4aa1bf(0x2ef)]();if(_0x19c653['includes']('cannot\x20find\x20a\x20process')||_0x19c653['includes'](_0x4aa1bf(0x34e))||_0x19c653['includes']('cannot\x20find\x20process'))return void this['logger'][_0x4aa1bf(0x266)]('Process\x20not\x20found\x20(expected):\x20'+_0x52f288);if((_0x19c653['includes'](_0x4aa1bf(0x2e7))||_0x19c653['includes']('access\x20denied'))&&!_0x15ae34){this['logger']['warn']('Access\x20denied,\x20retrying\x20with\x20admin\x20privileges:\x20'+_0x52f288);try{return void await this['forceKillWithPowerShell'](_0x3f7c01,!0x0);}catch(_0x24fe51){const _0x203240=(_0x24fe51?.[_0x4aa1bf(0x2a0)]||_0x24fe51?.['stderr']||String(_0x24fe51)||'')['toLowerCase']();if(_0x203240[_0x4aa1bf(0x177)](_0x4aa1bf(0x11a))||_0x203240['includes'](_0x4aa1bf(0x34e)))return;this['logger']['debug'](_0x4aa1bf(0x264)+_0x52f288);}}try{let _0x1b23a9;if(_0x15ae34||_0x19c653['includes']('access\x20denied')||_0x19c653['includes']('access\x20is\x20denied'))_0x1b23a9='powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22'+('Start-Process\x20taskkill\x20-ArgumentList\x20\x27/F\x27,\x27/IM\x27,\x27'+_0x52f288['replace'](/"/g,'`\x22')+'\x27,\x27/T\x27\x20-Verb\x20RunAs\x20-Wait\x20-WindowStyle\x20Hidden')['replace'](/"/g,'`\x22')['replace'](/\$/g,'`$')+'\x22';else _0x1b23a9=_0x4aa1bf(0x111)+_0x52f288+'\x22\x20/T';await _0x286fcd(_0x1b23a9,{'windowsHide':!0x0});}catch(_0x565798){const _0x3f673b=(_0x565798?.['message']||_0x565798?.['stderr']||String(_0x565798)||'')['toLowerCase']();if(_0x3f673b['includes']('not\x20found')||_0x3f673b[_0x4aa1bf(0x177)]('no\x20tasks\x20are\x20running')||_0x3f673b['includes'](_0x4aa1bf(0x2be)))return void this['logger']['debug'](_0x4aa1bf(0x156)+_0x52f288);if(_0x3f673b['includes']('access\x20is\x20denied')||_0x3f673b[_0x4aa1bf(0x177)](_0x4aa1bf(0x2f9)))return void this[_0x4aa1bf(0x1fd)]['warn']('Cannot\x20kill\x20process\x20(access\x20denied):\x20'+_0x52f288+'.\x20Process\x20may\x20require\x20administrator\x20privileges\x20to\x20terminate.');this['logger']['warn']('Kill\x20process\x20warning:\x20'+_0x3f673b);}}}async['forceKillWithPowerShell'](_0x545ac3,_0xf38437=!0x1){const _0x38b3bc=_0x5ca8f9,_0x4afd53='Get-Process\x20-Name\x20\x27'+_0x545ac3[_0x38b3bc(0x159)](/'/g,'\x27\x27')+_0x38b3bc(0x2b5);let _0x125050;_0x125050=_0xf38437?'powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22'+('Start-Process\x20powershell\x20-ArgumentList\x20\x27-NoProfile\x27,\x27-ExecutionPolicy\x27,\x27Bypass\x27,\x27-Command\x27,\x22'+_0x4afd53['replace'](/'/g,'\x27\x27')['replace'](/"/g,'`\x22')+_0x38b3bc(0x31d))['replace'](/"/g,'`\x22')['replace'](/\$/g,'`$')+'\x22':'powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22'+_0x4afd53[_0x38b3bc(0x159)](/"/g,'`\x22')['replace'](/\$/g,'`$')+'\x22';try{await _0x286fcd(_0x125050,{'windowsHide':!0x0});}catch(_0x5719d3){const _0x3be273=(_0x5719d3?.['message']||_0x5719d3?.['stderr']||String(_0x5719d3)||'')['toLowerCase']();if(_0x3be273['includes'](_0x38b3bc(0x11a))||_0x3be273['includes']('process\x20not\x20found')||_0x3be273['includes']('cannot\x20find\x20process'))return void this[_0x38b3bc(0x1fd)]['debug']('Process\x20not\x20found\x20(expected):\x20'+_0x545ac3);throw _0x5719d3;}}async[_0x5ca8f9(0x22b)](_0x569942){const _0x357bf9=_0x5ca8f9;try{const _0x457bc3='tasklist\x20/FI\x20\x22IMAGENAME\x20eq\x20'+_0x569942+_0x357bf9(0x11e),{stdout:_0x160f7a}=await _0x286fcd(_0x457bc3,{'windowsHide':!0x0}),_0x574852=_0x160f7a['toLowerCase']()['trim']();return!(!_0x574852||_0x574852['includes'](_0x357bf9(0x236))||_0x357bf9(0xdf)===_0x574852)&&_0x574852['includes'](_0x569942['toLowerCase']());}catch(_0x430b1b){return!0x1;}}async['waitUntilNotRunning'](_0x35d402,_0x4619a1){const _0x18dfed=_0x5ca8f9,_0x382cf7=Date[_0x18dfed(0x1a2)]();for(;Date['now']()-_0x382cf7<_0x4619a1;){if(!await this['isRunning'](_0x35d402))return;await(0x0,_0x58299a['sleep'])(0xfa);}this[_0x18dfed(0x1fd)]['warn'](_0x18dfed(0x138)+_0x4619a1+'ms:\x20'+_0x35d402);}async['startApp'](_0x486181){const _0x1bd4e2=_0x5ca8f9,_0xfa6eb2=_0x486181['exePath']??_0x486181[_0x1bd4e2(0x2ea)]??'',_0xf51453=_0x486181['runAsAdmin']??!0x1;if(!_0xfa6eb2)throw new Error('Start\x20target\x20is\x20empty');try{if(_0xf51453){const _0x2f44c2=_0x1bd4e2(0x255)+(_0x1bd4e2(0x319)+_0xfa6eb2[_0x1bd4e2(0x159)](/'/g,'\x27\x27')+'\x27\x20-Verb\x20RunAs')[_0x1bd4e2(0x159)](/"/g,'`\x22')['replace'](/\$/g,'`$')+'\x22';await _0x286fcd(_0x2f44c2),this['logger']['log']('App\x20started\x20with\x20Administrator\x20privileges:\x20'+_0xfa6eb2);}else{const _0x18ace1='start\x20\x22\x22\x20\x22'+_0xfa6eb2+'\x22';await _0x286fcd(_0x18ace1,{'windowsHide':!0x0}),this[_0x1bd4e2(0x1fd)][_0x1bd4e2(0x2d5)](_0x1bd4e2(0x107)+_0xfa6eb2);}await(0x0,_0x58299a['sleep'])(0x1f4);}catch(_0xba80f7){const _0x4f5b70=_0xba80f7?.['message']||String(_0xba80f7);throw this['logger']['error']('Failed\x20to\x20start\x20app:\x20'+_0xfa6eb2,_0x4f5b70),_0xba80f7;}}['escapePs'](_0x2acf10){return _0x2acf10['replace'](/"/g,'`\x22')['replace'](/\$/g,'`$');}};_0x14b2bb['WindowsAppGitBashService']=_0x46ff99,_0x14b2bb['WindowsAppGitBashService']=_0x46ff99=_0x48305c=_0x2a6afa([(0x0,_0xa65fd7['Injectable'])()],_0x46ff99);},_0xecd8bd=>{_0xecd8bd['exports']=require('child_process');},_0x305470=>{_0x305470['exports']=require('util');},function(_0x115c93,_0xd3d2d8,_0x1d5fa1){const _0x4001f2=a0_0x2e92;var _0x87874b,_0x388e57=this&&this['__decorate']||function(_0x4aa97e,_0x875a94,_0x230b18,_0x438076){const _0x478ce7=a0_0x2e92;var _0x157041,_0x3b4f31=arguments['length'],_0x34fe90=_0x3b4f31<0x3?_0x875a94:null===_0x438076?_0x438076=Object[_0x478ce7(0x25c)](_0x875a94,_0x230b18):_0x438076;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x478ce7(0x3b0)])_0x34fe90=Reflect['decorate'](_0x4aa97e,_0x875a94,_0x230b18,_0x438076);else{for(var _0x4bcd57=_0x4aa97e[_0x478ce7(0x1fe)]-0x1;_0x4bcd57>=0x0;_0x4bcd57--)(_0x157041=_0x4aa97e[_0x4bcd57])&&(_0x34fe90=(_0x3b4f31<0x3?_0x157041(_0x34fe90):_0x3b4f31>0x3?_0x157041(_0x875a94,_0x230b18,_0x34fe90):_0x157041(_0x875a94,_0x230b18))||_0x34fe90);}return _0x3b4f31>0x3&&_0x34fe90&&Object['defineProperty'](_0x875a94,_0x230b18,_0x34fe90),_0x34fe90;},_0x36ee9d=this&&this['__metadata']||function(_0x431791,_0x27392f){const _0x25ec68=a0_0x2e92;if('object'==typeof Reflect&&_0x25ec68(0x18d)==typeof Reflect['metadata'])return Reflect['metadata'](_0x431791,_0x27392f);};Object[_0x4001f2(0x3cc)](_0xd3d2d8,_0x4001f2(0x110),{'value':!0x0}),_0xd3d2d8[_0x4001f2(0x309)]=void 0x0;const _0x298d51=_0x1d5fa1(0x2),_0x56027d=_0x1d5fa1(0xf),_0x4a44cf=_0x1d5fa1(0x15);let _0x486076=class{constructor(_0x48d076){const _0x5a133f=_0x4001f2;this[_0x5a133f(0x1b2)]=_0x48d076,this['logger']=new _0x298d51['Logger']('RedisLockService'),this['DEFAULT_LOCK_TTL']=0x2bf20;}async[_0x4001f2(0x176)](_0x55cbd8,_0x5e01d0=this[_0x4001f2(0x295)]){const _0x3e1c19=_0x4001f2;try{const _0x1be1fe=(0x0,_0x4a44cf['randomUUID'])(),_0x381964=Math[_0x3e1c19(0x3a9)](_0x5e01d0/0x3e8),_0x1b17ac=await this['redisService']['getClient']();return'OK'===await _0x1b17ac[_0x3e1c19(0x1c0)](_0x55cbd8,_0x1be1fe,'EX',_0x381964,'NX');}catch(_0x51de32){return!0x1;}}async['releaseLock'](_0xb0bd3f){const _0x2d2fa4=_0x4001f2;try{const _0x1633ad=await this['redisService']['getClient'](),_0x33a393=await _0x1633ad['get'](_0xb0bd3f);if(!_0x33a393)return;0x1===await _0x1633ad[_0x2d2fa4(0x3c4)]('\x0aif\x20redis.call(\x22GET\x22,\x20KEYS[1])\x20==\x20ARGV[1]\x20then\x0a\x20\x20return\x20redis.call(\x22DEL\x22,\x20KEYS[1])\x0aelse\x0a\x20\x20return\x200\x0aend\x0a',0x1,_0xb0bd3f,_0x33a393)?this[_0x2d2fa4(0x1fd)]['log']('Released\x20lock\x20(lockId:\x20'+_0xb0bd3f+':'+_0x33a393+')'):this[_0x2d2fa4(0x1fd)]['warn']('Lock\x20was\x20already\x20released\x20or\x20changed\x20(expected\x20lockId:\x20'+_0xb0bd3f+':'+_0x33a393+')');}catch(_0x329116){this[_0x2d2fa4(0x1fd)][_0x2d2fa4(0xeb)]('Error\x20releasing\x20lock:\x20'+_0xb0bd3f+'\x20'+_0x329116[_0x2d2fa4(0x2a0)],_0x329116[_0x2d2fa4(0x3d6)]);}}async[_0x4001f2(0x329)](_0x5164fb){const _0x3fc321=_0x4001f2;try{return await this[_0x3fc321(0x1b2)]['get'](_0x5164fb)??null;}catch(_0x1f8608){return this['logger']['error']('['+_0x5164fb+_0x3fc321(0x139)+_0x1f8608[_0x3fc321(0x2a0)]),null;}}async['isLocked'](_0x3edf8f){const _0x4f0f1b=_0x4001f2;try{return!!await this['getLock'](_0x3edf8f);}catch(_0x16a8b5){return this[_0x4f0f1b(0x1fd)]['error']('['+_0x3edf8f+']\x20Error\x20checking\x20lock\x20status:\x20'+_0x16a8b5['message']),!0x1;}}};_0xd3d2d8['RedisLockService']=_0x486076,_0xd3d2d8['RedisLockService']=_0x486076=_0x388e57([(0x0,_0x298d51['Injectable'])(),_0x36ee9d('design:paramtypes',['function'==typeof(_0x87874b=void 0x0!==_0x56027d['RedisService']&&_0x56027d['RedisService'])?_0x87874b:Object])],_0x486076);},(_0x4bbadc,_0x19ebed)=>{const _0x5e33c1=a0_0x2e92;Object['defineProperty'](_0x19ebed,_0x5e33c1(0x110),{'value':!0x0}),_0x19ebed[_0x5e33c1(0x1f9)]=_0x19ebed['SYSTEM_LOCK_BOXPHONE']=void 0x0,_0x19ebed['SYSTEM_LOCK_BOXPHONE']='system:lock:boxphone',_0x19ebed[_0x5e33c1(0x1f9)]='system:lock:pauseprocessing';},(_0x3dccb4,_0x23e00e,_0x40c96d)=>{const _0x3f3232=a0_0x2e92;Object['defineProperty'](_0x23e00e,_0x3f3232(0x110),{'value':!0x0}),_0x23e00e['validateObjectResult']=void 0x0;const _0x4041e5=_0x40c96d(0x44),_0x1b1dcb=_0x40c96d(0x3b);_0x23e00e[_0x3f3232(0x336)]=async(_0x4b48b5,_0x140e6a)=>{const _0x29aaaf=(0x0,_0x4041e5['plainToInstance'])(_0x4b48b5,_0x140e6a,{'enableImplicitConversion':!0x0}),_0x5a6bfd=await(0x0,_0x1b1dcb['validate'])(_0x29aaaf,{'whitelist':!0x0,'forbidNonWhitelisted':!0x0,'forbidUnknownValues':!0x0,'validationError':{'target':!0x1,'value':!0x1}});return{'ok':0x0===_0x5a6bfd['length'],'instance':_0x29aaaf,'errors':_0x5a6bfd};};},_0x2cefd6=>{const _0x3cb00b=a0_0x2e92;_0x2cefd6[_0x3cb00b(0x29f)]=require('class-transformer');},(_0x425041,_0x74bfbd)=>{const _0x5dc143=a0_0x2e92;Object['defineProperty'](_0x74bfbd,'__esModule',{'value':!0x0}),_0x74bfbd['JOB_PRIORITY_KEY']=void 0x0,_0x74bfbd['JOB_PRIORITY_KEY']=_0x5dc143(0x31c);},function(_0x3a7581,_0x16c984,_0x598bf3){const _0x1e5709=a0_0x2e92;var _0x2b2fea,_0x513d65=this&&this[_0x1e5709(0x21f)]||function(_0x19c36f,_0x4dc7d2,_0x23b294,_0x3ac3fc){const _0x2b9396=_0x1e5709;var _0x47dbd9,_0x362930=arguments[_0x2b9396(0x1fe)],_0x3ce618=_0x362930<0x3?_0x4dc7d2:null===_0x3ac3fc?_0x3ac3fc=Object[_0x2b9396(0x25c)](_0x4dc7d2,_0x23b294):_0x3ac3fc;if('object'==typeof Reflect&&_0x2b9396(0x18d)==typeof Reflect['decorate'])_0x3ce618=Reflect[_0x2b9396(0x3b0)](_0x19c36f,_0x4dc7d2,_0x23b294,_0x3ac3fc);else{for(var _0x32709b=_0x19c36f['length']-0x1;_0x32709b>=0x0;_0x32709b--)(_0x47dbd9=_0x19c36f[_0x32709b])&&(_0x3ce618=(_0x362930<0x3?_0x47dbd9(_0x3ce618):_0x362930>0x3?_0x47dbd9(_0x4dc7d2,_0x23b294,_0x3ce618):_0x47dbd9(_0x4dc7d2,_0x23b294))||_0x3ce618);}return _0x362930>0x3&&_0x3ce618&&Object[_0x2b9396(0x3cc)](_0x4dc7d2,_0x23b294,_0x3ce618),_0x3ce618;},_0x271b22=this&&this[_0x1e5709(0x3c1)]||function(_0x4f84e9,_0x30f656){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x4f84e9,_0x30f656);};Object['defineProperty'](_0x16c984,'__esModule',{'value':!0x0}),_0x16c984['WithdrawalController']=void 0x0;const _0x558ec9=_0x598bf3(0x2),_0x1af9d3=_0x598bf3(0x3),_0x3d7562=_0x598bf3(0x38);let _0x2be583=class{constructor(_0x4d1167){const _0x4faccc=_0x1e5709;this[_0x4faccc(0x1b1)]=_0x4d1167,this[_0x4faccc(0x1fd)]=new _0x558ec9[(_0x4faccc(0x225))]('WithdrawalController');}async['getQueueStats'](){const _0x58543c=_0x1e5709;return await this[_0x58543c(0x1b1)]['getQueueStats']();}async[_0x1e5709(0x12b)](){return await this['jobManagerService']['debugQueue']();}async['triggerJobPicking'](){const _0x1a9810=_0x1e5709;return this['logger'][_0x1a9810(0x2d5)](_0x1a9810(0x129)),await this[_0x1a9810(0x1b1)]['triggerPickJobs'](0x1),{'success':!0x0,'message':'Job\x20picking\x20triggered','stats':await this['jobManagerService'][_0x1a9810(0x119)]()};}};_0x16c984[_0x1e5709(0x10b)]=_0x2be583,_0x513d65([(0x0,_0x558ec9[_0x1e5709(0x1a6)])('queue/stats'),(0x0,_0x1af9d3['ApiOperation'])({'summary':_0x1e5709(0x184)}),(0x0,_0x1af9d3['ApiResponse'])({'status':0xc8,'description':_0x1e5709(0x136)}),_0x271b22(_0x1e5709(0x19a),Function),_0x271b22('design:paramtypes',[]),_0x271b22('design:returntype',Promise)],_0x2be583['prototype'],_0x1e5709(0x119),null),_0x513d65([(0x0,_0x558ec9[_0x1e5709(0x1a6)])('queue/debug'),(0x0,_0x1af9d3[_0x1e5709(0x1d4)])({'summary':'Get\x20detailed\x20queue\x20debug\x20information'}),(0x0,_0x1af9d3['ApiResponse'])({'status':0xc8,'description':_0x1e5709(0x3f4)}),_0x271b22('design:type',Function),_0x271b22(_0x1e5709(0x22c),[]),_0x271b22('design:returntype',Promise)],_0x2be583['prototype'],_0x1e5709(0x12b),null),_0x513d65([(0x0,_0x558ec9['Post'])('queue/trigger'),(0x0,_0x1af9d3[_0x1e5709(0x1d4)])({'summary':_0x1e5709(0x224)}),(0x0,_0x1af9d3['ApiResponse'])({'status':0xc8,'description':'Job\x20picking\x20triggered'}),_0x271b22(_0x1e5709(0x19a),Function),_0x271b22('design:paramtypes',[]),_0x271b22('design:returntype',Promise)],_0x2be583['prototype'],'triggerJobPicking',null),_0x16c984['WithdrawalController']=_0x2be583=_0x513d65([(0x0,_0x1af9d3['ApiTags'])('withdrawal'),(0x0,_0x558ec9[_0x1e5709(0x396)])('api/withdrawal'),_0x271b22(_0x1e5709(0x22c),['function'==typeof(_0x2b2fea=void 0x0!==_0x3d7562['WithdrawalJobManagerService']&&_0x3d7562['WithdrawalJobManagerService'])?_0x2b2fea:Object])],_0x2be583);},function(_0x2f90fa,_0x55ac85,_0x43c435){const _0x4ed76f=a0_0x2e92;var _0x5695c0=this&&this['__decorate']||function(_0x1b2cca,_0x2dec8e,_0x38bac6,_0x36fc8d){const _0x13be8d=a0_0x2e92;var _0x276937,_0x21a675=arguments['length'],_0x8b89d=_0x21a675<0x3?_0x2dec8e:null===_0x36fc8d?_0x36fc8d=Object[_0x13be8d(0x25c)](_0x2dec8e,_0x38bac6):_0x36fc8d;if('object'==typeof Reflect&&_0x13be8d(0x18d)==typeof Reflect['decorate'])_0x8b89d=Reflect[_0x13be8d(0x3b0)](_0x1b2cca,_0x2dec8e,_0x38bac6,_0x36fc8d);else{for(var _0x23f3d4=_0x1b2cca['length']-0x1;_0x23f3d4>=0x0;_0x23f3d4--)(_0x276937=_0x1b2cca[_0x23f3d4])&&(_0x8b89d=(_0x21a675<0x3?_0x276937(_0x8b89d):_0x21a675>0x3?_0x276937(_0x2dec8e,_0x38bac6,_0x8b89d):_0x276937(_0x2dec8e,_0x38bac6))||_0x8b89d);}return _0x21a675>0x3&&_0x8b89d&&Object['defineProperty'](_0x2dec8e,_0x38bac6,_0x8b89d),_0x8b89d;};Object['defineProperty'](_0x55ac85,_0x4ed76f(0x110),{'value':!0x0}),_0x55ac85['HcBoxModule']=void 0x0;const _0x2071d4=_0x43c435(0x2),_0x2ab750=_0x43c435(0x48);let _0x402459=class{};_0x55ac85['HcBoxModule']=_0x402459,_0x55ac85[_0x4ed76f(0x283)]=_0x402459=_0x5695c0([(0x0,_0x2071d4[_0x4ed76f(0x305)])({'providers':[_0x2ab750['HcBoxService']],'exports':[_0x2ab750[_0x4ed76f(0x2e9)]]})],_0x402459);},function(_0x61e215,_0x511838,_0x5ed879){const _0x1d664a=a0_0x2e92;var _0x386508,_0x486fe=this&&this['__decorate']||function(_0x1e3264,_0x247529,_0x57a215,_0x2438a3){const _0x1e378a=a0_0x2e92;var _0x21f1ae,_0x4b97b1=arguments['length'],_0x8eed6a=_0x4b97b1<0x3?_0x247529:null===_0x2438a3?_0x2438a3=Object['getOwnPropertyDescriptor'](_0x247529,_0x57a215):_0x2438a3;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x1e378a(0x3b0)])_0x8eed6a=Reflect['decorate'](_0x1e3264,_0x247529,_0x57a215,_0x2438a3);else{for(var _0xddc92e=_0x1e3264['length']-0x1;_0xddc92e>=0x0;_0xddc92e--)(_0x21f1ae=_0x1e3264[_0xddc92e])&&(_0x8eed6a=(_0x4b97b1<0x3?_0x21f1ae(_0x8eed6a):_0x4b97b1>0x3?_0x21f1ae(_0x247529,_0x57a215,_0x8eed6a):_0x21f1ae(_0x247529,_0x57a215))||_0x8eed6a);}return _0x4b97b1>0x3&&_0x8eed6a&&Object[_0x1e378a(0x3cc)](_0x247529,_0x57a215,_0x8eed6a),_0x8eed6a;},_0x2c2528=this&&this[_0x1d664a(0x3c1)]||function(_0x4c895f,_0x4a5232){const _0xc07f17=_0x1d664a;if('object'==typeof Reflect&&'function'==typeof Reflect[_0xc07f17(0x3ac)])return Reflect['metadata'](_0x4c895f,_0x4a5232);},_0x412c41=this&&this['__param']||function(_0x4e6a29,_0x2e763b){return function(_0x4b49d0,_0x46ee79){_0x2e763b(_0x4b49d0,_0x46ee79,_0x4e6a29);};};Object['defineProperty'](_0x511838,'__esModule',{'value':!0x0}),_0x511838['HcBoxService']=void 0x0;const _0x6b755d=_0x5ed879(0x2),_0x52b886=_0x5ed879(0xd),_0x526e52=_0x5ed879(0x13),_0x54aab6=_0x5ed879(0x18);let _0x2a2010=class{constructor(_0x131a8b){const _0x191de9=_0x1d664a;this['wsService']=_0x131a8b,this['logger']=new _0x6b755d[(_0x191de9(0x225))]('HcBoxService');}async[_0x1d664a(0x367)](){const _0xf77698=_0x1d664a;try{return await this[_0xf77698(0x2e6)]['listDevices']();}catch(_0x53250d){throw this['logger']['error'](_0xf77698(0x2da)+_0x53250d['message']),_0x53250d;}}async['executeTransfer'](_0x3792f3,_0x513502){const _0x50ba91=_0x1d664a;try{this['logger']['log'](_0x50ba91(0x39e)+_0x3792f3['withdrawalId']+'\x20on\x20device\x20'+_0x513502);const _0x30e53f=this['getBankBundleId'](_0x3792f3[_0x50ba91(0x126)]);return _0x30e53f&&(await this[_0x50ba91(0x2e6)]['launchApp'](_0x513502,_0x30e53f),await(0x0,_0x54aab6['sleep'])(0xbb8)),await this['wsService'][_0x50ba91(0x287)](_0x513502,0.5,0.3,0.2),await(0x0,_0x54aab6[_0x50ba91(0x26c)])(0x7d0),this['logger']['warn']('Transfer\x20execution\x20flow\x20needs\x20to\x20be\x20customized\x20per\x20bank\x20app\x20UI'),this['logger']['log']('Transfer\x20execution\x20completed\x20for\x20withdrawal\x20'+_0x3792f3[_0x50ba91(0x245)]),!0x0;}catch(_0x3b85b3){throw this['logger'][_0x50ba91(0xeb)]('Error\x20executing\x20transfer\x20for\x20withdrawal\x20'+_0x3792f3['withdrawalId']+':\x20'+_0x3b85b3[_0x50ba91(0x2a0)]),_0x3b85b3;}}['getBankBundleId'](_0x10a2b7){return{'VIETCOMBANK':'com.vietcombank.mobilebanking','TPBANK':'com.tpbank.mobilebanking','TECHCOMBANK':'com.techcombank.mobilebanking'}[_0x10a2b7]||null;}async['click'](_0x5e0075,_0x1c6d0c,_0x44c20b,_0x40579f=0.2){return this['wsService']['click'](_0x5e0075,_0x1c6d0c,_0x44c20b,_0x40579f);}async['swipe'](_0x4d9011,_0x2fa25a){const _0x50b56a=_0x1d664a;return this[_0x50b56a(0x2e6)][_0x50b56a(0x300)](_0x4d9011,_0x2fa25a);}async['screen'](_0x36d9aa,_0x1702fc){return this['wsService']['captureScreen'](_0x36d9aa,_0x1702fc);}async['home'](_0x356947){return this['wsService']['home'](_0x356947);}async['inputNumpadNumber'](_0x2fa74c,_0xd04146){const _0x10a1da=_0x1d664a;return this[_0x10a1da(0x2e6)]['inputNumpadNumber'](_0x2fa74c,_0xd04146);}['inputText'](_0x5ed51e,_0x4efd10){const _0x34b533=_0x1d664a;return this[_0x34b533(0x2e6)]['inputText'](_0x5ed51e,_0x4efd10);}};_0x511838['HcBoxService']=_0x2a2010,_0x511838['HcBoxService']=_0x2a2010=_0x486fe([(0x0,_0x6b755d[_0x1d664a(0x19b)])(),_0x412c41(0x0,(0x0,_0x6b755d['Inject'])(_0x52b886['WEBSOCKET_SERVICE'])),_0x2c2528('design:paramtypes',['function'==typeof(_0x386508=void 0x0!==_0x526e52['IWebSocketService']&&_0x526e52['IWebSocketService'])?_0x386508:Object])],_0x2a2010);},function(_0x3d1f76,_0x52f126,_0x567024){const _0x15a23f=a0_0x2e92;var _0x1b3581=this&&this['__decorate']||function(_0x10fe3,_0x3732a1,_0x227f3f,_0x2ae4fe){const _0x2d8600=a0_0x2e92;var _0x1a0596,_0x149d97=arguments[_0x2d8600(0x1fe)],_0x27c890=_0x149d97<0x3?_0x3732a1:null===_0x2ae4fe?_0x2ae4fe=Object[_0x2d8600(0x25c)](_0x3732a1,_0x227f3f):_0x2ae4fe;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x27c890=Reflect[_0x2d8600(0x3b0)](_0x10fe3,_0x3732a1,_0x227f3f,_0x2ae4fe);else{for(var _0x462629=_0x10fe3[_0x2d8600(0x1fe)]-0x1;_0x462629>=0x0;_0x462629--)(_0x1a0596=_0x10fe3[_0x462629])&&(_0x27c890=(_0x149d97<0x3?_0x1a0596(_0x27c890):_0x149d97>0x3?_0x1a0596(_0x3732a1,_0x227f3f,_0x27c890):_0x1a0596(_0x3732a1,_0x227f3f))||_0x27c890);}return _0x149d97>0x3&&_0x27c890&&Object['defineProperty'](_0x3732a1,_0x227f3f,_0x27c890),_0x27c890;};Object[_0x15a23f(0x3cc)](_0x52f126,'__esModule',{'value':!0x0}),_0x52f126['DeviceModule']=void 0x0;const _0x45c6fa=_0x567024(0x2),_0xe1be29=_0x567024(0x4a),_0x117689=_0x567024(0xe),_0x335a51=_0x567024(0x14),_0x5c0d58=_0x567024(0x47),_0x4b2e55=_0x567024(0xf),_0x470e05=_0x567024(0x4c);let _0x1ce4d5=class{};_0x52f126['DeviceModule']=_0x1ce4d5,_0x52f126['DeviceModule']=_0x1ce4d5=_0x1b3581([(0x0,_0x45c6fa['Module'])({'imports':[_0x5c0d58[_0x15a23f(0x283)],(0x0,_0x45c6fa[_0x15a23f(0x3b6)])(()=>_0x470e05[_0x15a23f(0x1f2)])],'controllers':[_0xe1be29['DeviceController']],'providers':[_0x117689['DeviceService'],_0x335a51[_0x15a23f(0x38e)],_0x4b2e55['RedisService']],'exports':[_0x117689['DeviceService'],_0x335a51['DeviceLockService']]})],_0x1ce4d5);},function(_0x1f82d8,_0x22f536,_0xaa9a8a){const _0x5c5060=a0_0x2e92;var _0x4b4cac,_0x1eec28,_0x1c9a3a,_0x168d0b=this&&this['__decorate']||function(_0x3ae354,_0x3df511,_0x1a87f2,_0x348e2f){const _0x5e2761=a0_0x2e92;var _0x4bafa6,_0x217d2c=arguments['length'],_0x434c55=_0x217d2c<0x3?_0x3df511:null===_0x348e2f?_0x348e2f=Object['getOwnPropertyDescriptor'](_0x3df511,_0x1a87f2):_0x348e2f;if('object'==typeof Reflect&&_0x5e2761(0x18d)==typeof Reflect['decorate'])_0x434c55=Reflect['decorate'](_0x3ae354,_0x3df511,_0x1a87f2,_0x348e2f);else{for(var _0xd4de3c=_0x3ae354['length']-0x1;_0xd4de3c>=0x0;_0xd4de3c--)(_0x4bafa6=_0x3ae354[_0xd4de3c])&&(_0x434c55=(_0x217d2c<0x3?_0x4bafa6(_0x434c55):_0x217d2c>0x3?_0x4bafa6(_0x3df511,_0x1a87f2,_0x434c55):_0x4bafa6(_0x3df511,_0x1a87f2))||_0x434c55);}return _0x217d2c>0x3&&_0x434c55&&Object[_0x5e2761(0x3cc)](_0x3df511,_0x1a87f2,_0x434c55),_0x434c55;},_0x472523=this&&this['__metadata']||function(_0x3b5504,_0x66bb6e){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x3b5504,_0x66bb6e);},_0x296c6d=this&&this['__param']||function(_0x368c07,_0x40bca4){return function(_0x5a69c1,_0x5306b8){_0x40bca4(_0x5a69c1,_0x5306b8,_0x368c07);};};Object[_0x5c5060(0x3cc)](_0x22f536,'__esModule',{'value':!0x0}),_0x22f536['DeviceController']=void 0x0;const _0x5824a6=_0xaa9a8a(0x2),_0x4f4733=_0xaa9a8a(0xe),_0x150008=_0xaa9a8a(0x4b),_0xb983b8=_0xaa9a8a(0xb),_0x17d8ad=_0xaa9a8a(0x11);let _0x408420=class{constructor(_0x39900b,_0x1bd1a1){const _0x4556c9=_0x5c5060;this['deviceService']=_0x39900b,this['bankService']=_0x1bd1a1,this['logger']=new _0x5824a6[(_0x4556c9(0x225))]('DeviceController');}async['getDevicesPage'](){const _0x4052a0=_0x5c5060;return{'devices':await this['deviceService']['listDevices'](),'serviceStatus':await this['deviceService'][_0x4052a0(0x31f)](),'banks':[_0x4052a0(0x1df),'HDBANK','PGBANK','TECHCOMBANK',_0x4052a0(0x381),'VIETCOMBANK'],'boxType':_0x17d8ad['config'][_0x4052a0(0x3da)]};}async['getDevices'](){const _0x5b22ca=_0x5c5060;return{'success':!0x0,'data':await this[_0x5b22ca(0x25e)]['listDevices']()};}async['getDeviceConfig'](_0x3c1a58){return{'success':!0x0,'data':await this['deviceService']['getDeviceConfigSafe'](_0x3c1a58)};}async['retryLogin'](_0x2ca280){const _0x4e8599=_0x5c5060;try{this['logger']['log']('Retry\x20login\x20requested\x20for\x20device\x20'+_0x2ca280);const _0x3a1104=await this['deviceService'][_0x4e8599(0x2de)](_0x2ca280);if(!_0x3a1104)throw new _0x5824a6['HttpException']({'success':!0x1,'error':_0x4e8599(0x2f4)+_0x2ca280+'\x20not\x20found\x20or\x20not\x20configured'},_0x5824a6[_0x4e8599(0x35f)]['BAD_REQUEST']);if(!_0x3a1104['bankCode']||''===_0x3a1104['bankCode'][_0x4e8599(0x310)]())throw new _0x5824a6[(_0x4e8599(0x13a))]({'success':!0x1,'error':'Device\x20'+_0x2ca280+'\x20does\x20not\x20have\x20bankCode\x20configured.\x20Please\x20configure\x20bankCode\x20first.'},_0x5824a6[_0x4e8599(0x35f)]['BAD_REQUEST']);const _0x1ee3c6=_0x3a1104['bankCode']['toUpperCase']();return await this[_0x4e8599(0x2c1)]['login'](_0x1ee3c6,_0x2ca280),{'success':!0x0,'message':'Successfully\x20logged\x20in\x20to\x20'+_0x1ee3c6+_0x4e8599(0x1dc)+_0x2ca280};}catch(_0x5c7e30){if(_0x5c7e30 instanceof _0x5824a6['HttpException'])throw _0x5c7e30;throw this[_0x4e8599(0x1fd)]['error'](_0x4e8599(0x1b3)+_0x2ca280+':\x20'+_0x5c7e30['message'],_0x5c7e30['stack']),new _0x5824a6[(_0x4e8599(0x13a))]({'success':!0x1,'error':_0x5c7e30['message']||'Failed\x20to\x20retry\x20login'},_0x5824a6['HttpStatus'][_0x4e8599(0x374)]);}}async['updateDeviceConfig'](_0x5c52b9,_0x454ed1){const _0x478459=_0x5c5060;try{this['logger']['log']('Updating\x20device\x20config\x20for\x20'+_0x5c52b9+':\x20'+JSON['stringify'](_0x454ed1));const _0x5e9603=await this['deviceService'][_0x478459(0x2de)](_0x5c52b9);if(_0x478459(0x254)===(void 0x0!==_0x454ed1[_0x478459(0x1f3)]?_0x454ed1['status']:_0x5e9603?.['status']||'deactive')){const _0x23e319=[],_0x1df628=void 0x0!==_0x454ed1[_0x478459(0x126)]?_0x454ed1['bankCode']:_0x5e9603?.[_0x478459(0x126)];_0x1df628&&''!==_0x1df628['trim']()||_0x23e319[_0x478459(0x1ff)]('Bank\x20Code\x20l√†\x20b·∫Øt\x20bu·ªôc\x20khi\x20status\x20l√†\x20active');const _0x6ef9ee=void 0x0!==_0x454ed1[_0x478459(0x2b6)]?_0x454ed1['availableAmount']:_0x5e9603?.['availableAmount'];(null==_0x6ef9ee||_0x6ef9ee<0x0)&&_0x23e319['push'](_0x478459(0x33f));const _0x50aa20=void 0x0!==_0x454ed1['password']?_0x454ed1['password']:_0x5e9603?.['password'];_0x50aa20&&''!==_0x50aa20['trim']()||_0x23e319['push']('Password\x20l√†\x20b·∫Øt\x20bu·ªôc\x20khi\x20status\x20l√†\x20active');const _0x5379b3=void 0x0!==_0x454ed1['smartOTP']?_0x454ed1[_0x478459(0x350)]:_0x5e9603?.['smartOTP'];if(_0x5379b3&&''!==_0x5379b3['trim']()||_0x23e319['push']('Smart\x20OTP\x20l√†\x20b·∫Øt\x20bu·ªôc\x20khi\x20status\x20l√†\x20active'),_0x23e319[_0x478459(0x1fe)]>0x0)throw new _0x5824a6['HttpException']({'success':!0x1,'error':_0x23e319[_0x478459(0x3ed)](',\x20')},_0x5824a6['HttpStatus']['BAD_REQUEST']);}return{'success':!0x0,'data':await this['deviceService']['updateDeviceConfig'](_0x5c52b9,_0x454ed1)};}catch(_0x48877b){if(_0x48877b instanceof _0x5824a6['HttpException'])throw _0x48877b;throw this['logger']['error']('Error\x20updating\x20device\x20config\x20for\x20'+_0x5c52b9+':\x20'+_0x48877b['message'],_0x48877b['stack']),new _0x5824a6[(_0x478459(0x13a))]({'success':!0x1,'error':_0x48877b['message']||'Failed\x20to\x20update\x20device\x20config'},_0x5824a6['HttpStatus']['INTERNAL_SERVER_ERROR']);}}async['getServiceStatus'](){return{'success':!0x0,'data':{'status':await this['deviceService']['getServiceStatus']()}};}async['startService'](){const _0x4be2c8=_0x5c5060;return await this[_0x4be2c8(0x25e)]['startService']();}async['stopService'](){return await this['deviceService']['setServiceStatus']('inactive'),{'success':!0x0,'message':'Service\x20stopped\x20successfully'};}async['deleteDeviceConfig'](_0x3af50c){return await this['deviceService']['deleteDeviceConfig'](_0x3af50c),{'success':!0x0,'message':'Device\x20config\x20deleted\x20successfully'};}};_0x22f536['DeviceController']=_0x408420,_0x168d0b([(0x0,_0x5824a6['Get'])(),(0x0,_0x5824a6[_0x5c5060(0x15d)])(_0x5c5060(0x3af)),_0x472523(_0x5c5060(0x19a),Function),_0x472523(_0x5c5060(0x22c),[]),_0x472523(_0x5c5060(0x157),Promise)],_0x408420['prototype'],'getDevicesPage',null),_0x168d0b([(0x0,_0x5824a6['Get'])('api/devices'),_0x472523('design:type',Function),_0x472523(_0x5c5060(0x22c),[]),_0x472523('design:returntype',Promise)],_0x408420['prototype'],'getDevices',null),_0x168d0b([(0x0,_0x5824a6['Get'])('api/devices/:deviceId/config'),_0x296c6d(0x0,(0x0,_0x5824a6['Param'])('deviceId')),_0x472523(_0x5c5060(0x19a),Function),_0x472523('design:paramtypes',[String]),_0x472523('design:returntype',Promise)],_0x408420['prototype'],'getDeviceConfig',null),_0x168d0b([(0x0,_0x5824a6['Post'])('api/devices/:deviceId/retryLogin'),_0x296c6d(0x0,(0x0,_0x5824a6['Param'])('deviceId')),_0x472523(_0x5c5060(0x19a),Function),_0x472523('design:paramtypes',[String]),_0x472523('design:returntype',Promise)],_0x408420[_0x5c5060(0x2b4)],_0x5c5060(0x2ab),null),_0x168d0b([(0x0,_0x5824a6[_0x5c5060(0x3ee)])('api/devices/:deviceId/config'),_0x296c6d(0x0,(0x0,_0x5824a6['Param'])('deviceId')),_0x296c6d(0x1,(0x0,_0x5824a6[_0x5c5060(0x330)])()),_0x472523(_0x5c5060(0x19a),Function),_0x472523(_0x5c5060(0x22c),[String,_0x5c5060(0x18d)==typeof(_0x1c9a3a=void 0x0!==_0x150008['UpdateDeviceConfigDto']&&_0x150008['UpdateDeviceConfigDto'])?_0x1c9a3a:Object]),_0x472523('design:returntype',Promise)],_0x408420['prototype'],_0x5c5060(0x207),null),_0x168d0b([(0x0,_0x5824a6['Get'])('api/service/status'),_0x472523(_0x5c5060(0x19a),Function),_0x472523(_0x5c5060(0x22c),[]),_0x472523('design:returntype',Promise)],_0x408420[_0x5c5060(0x2b4)],'getServiceStatus',null),_0x168d0b([(0x0,_0x5824a6['Post'])('api/service/start'),_0x472523('design:type',Function),_0x472523('design:paramtypes',[]),_0x472523(_0x5c5060(0x157),Promise)],_0x408420[_0x5c5060(0x2b4)],'startService',null),_0x168d0b([(0x0,_0x5824a6['Post'])(_0x5c5060(0x173)),_0x472523('design:type',Function),_0x472523(_0x5c5060(0x22c),[]),_0x472523('design:returntype',Promise)],_0x408420[_0x5c5060(0x2b4)],'stopService',null),_0x168d0b([(0x0,_0x5824a6['Delete'])(_0x5c5060(0x131)),_0x296c6d(0x0,(0x0,_0x5824a6['Param'])(_0x5c5060(0x14b))),_0x472523('design:type',Function),_0x472523('design:paramtypes',[String]),_0x472523('design:returntype',Promise)],_0x408420['prototype'],'deleteDeviceConfig',null),_0x22f536['DeviceController']=_0x408420=_0x168d0b([(0x0,_0x5824a6['Controller'])(),_0x472523('design:paramtypes',['function'==typeof(_0x4b4cac=void 0x0!==_0x4f4733['DeviceService']&&_0x4f4733[_0x5c5060(0x204)])?_0x4b4cac:Object,'function'==typeof(_0x1eec28=void 0x0!==_0xb983b8[_0x5c5060(0x261)]&&_0xb983b8['BankService'])?_0x1eec28:Object])],_0x408420);},function(_0x3185d7,_0x1c7f20,_0xbca55d){const _0x2d6153=a0_0x2e92;var _0x1089ee=this&&this['__decorate']||function(_0x49c546,_0xc46eb4,_0x4e7d06,_0x4d200d){const _0x494210=a0_0x2e92;var _0x4dc6d0,_0x11d65c=arguments['length'],_0x249a4b=_0x11d65c<0x3?_0xc46eb4:null===_0x4d200d?_0x4d200d=Object['getOwnPropertyDescriptor'](_0xc46eb4,_0x4e7d06):_0x4d200d;if('object'==typeof Reflect&&_0x494210(0x18d)==typeof Reflect['decorate'])_0x249a4b=Reflect['decorate'](_0x49c546,_0xc46eb4,_0x4e7d06,_0x4d200d);else{for(var _0x45f1b1=_0x49c546['length']-0x1;_0x45f1b1>=0x0;_0x45f1b1--)(_0x4dc6d0=_0x49c546[_0x45f1b1])&&(_0x249a4b=(_0x11d65c<0x3?_0x4dc6d0(_0x249a4b):_0x11d65c>0x3?_0x4dc6d0(_0xc46eb4,_0x4e7d06,_0x249a4b):_0x4dc6d0(_0xc46eb4,_0x4e7d06))||_0x249a4b);}return _0x11d65c>0x3&&_0x249a4b&&Object['defineProperty'](_0xc46eb4,_0x4e7d06,_0x249a4b),_0x249a4b;},_0x2b5496=this&&this['__metadata']||function(_0x1babad,_0xc5e666){const _0x5a3047=a0_0x2e92;if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x5a3047(0x3ac)](_0x1babad,_0xc5e666);};Object['defineProperty'](_0x1c7f20,'__esModule',{'value':!0x0}),_0x1c7f20['UpdateDeviceConfigDto']=void 0x0;const _0x2b3741=_0xbca55d(0x3b);class _0x49e636{}_0x1c7f20['UpdateDeviceConfigDto']=_0x49e636,_0x1089ee([(0x0,_0x2b3741['ValidateIf'])(_0x283d84=>_0x2d6153(0x254)===_0x283d84['status']),(0x0,_0x2b3741['IsNotEmpty'])({'message':_0x2d6153(0x1a1)}),(0x0,_0x2b3741[_0x2d6153(0x1ad)])(),(0x0,_0x2b3741[_0x2d6153(0x23e)])(),_0x2b5496(_0x2d6153(0x19a),String)],_0x49e636[_0x2d6153(0x2b4)],_0x2d6153(0x126),void 0x0),_0x1089ee([(0x0,_0x2b3741[_0x2d6153(0x2dd)])(_0x3f6d9c=>'active'===_0x3f6d9c['status']),(0x0,_0x2b3741[_0x2d6153(0x316)])({'message':'Available\x20Amount\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x2b3741['IsNumber'])(),(0x0,_0x2b3741['Min'])(0x0,{'message':'Available\x20Amount\x20must\x20be\x20greater\x20than\x20or\x20equal\x20to\x200'}),(0x0,_0x2b3741['IsOptional'])(),_0x2b5496('design:type',Number)],_0x49e636['prototype'],'availableAmount',void 0x0),_0x1089ee([(0x0,_0x2b3741['IsOptional'])(),(0x0,_0x2b3741['IsString'])(),(0x0,_0x2b3741['IsIn'])([_0x2d6153(0x254),'deactive']),_0x2b5496(_0x2d6153(0x19a),String)],_0x49e636[_0x2d6153(0x2b4)],'status',void 0x0),_0x1089ee([(0x0,_0x2b3741['ValidateIf'])(_0x11067b=>'active'===_0x11067b[_0x2d6153(0x1f3)]),(0x0,_0x2b3741['IsNotEmpty'])({'message':_0x2d6153(0x2cc)}),(0x0,_0x2b3741['IsString'])(),(0x0,_0x2b3741['IsOptional'])(),_0x2b5496('design:type',String)],_0x49e636[_0x2d6153(0x2b4)],'password',void 0x0),_0x1089ee([(0x0,_0x2b3741['ValidateIf'])(_0x452cb3=>_0x2d6153(0x254)===_0x452cb3['status']),(0x0,_0x2b3741[_0x2d6153(0x316)])({'message':_0x2d6153(0x3ea)}),(0x0,_0x2b3741[_0x2d6153(0x1ad)])(),(0x0,_0x2b3741['IsOptional'])(),_0x2b5496(_0x2d6153(0x19a),String)],_0x49e636['prototype'],'smartOTP',void 0x0),_0x1089ee([(0x0,_0x2b3741[_0x2d6153(0x2dd)])(_0x280307=>'active'===_0x280307[_0x2d6153(0x1f3)]),(0x0,_0x2b3741['IsNotEmpty'])({'message':'Account\x20No\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x2b3741[_0x2d6153(0x1ad)])(),(0x0,_0x2b3741[_0x2d6153(0x23e)])(),_0x2b5496(_0x2d6153(0x19a),String)],_0x49e636['prototype'],'accountNo',void 0x0),_0x1089ee([(0x0,_0x2b3741['ValidateIf'])(_0x543c56=>'active'===_0x543c56['status']),(0x0,_0x2b3741[_0x2d6153(0x316)])({'message':_0x2d6153(0x2d3)}),(0x0,_0x2b3741['IsString'])(),(0x0,_0x2b3741['IsOptional'])(),_0x2b5496(_0x2d6153(0x19a),String)],_0x49e636['prototype'],'accountName',void 0x0);},function(_0x3f13cc,_0x272fdf,_0x2dbe84){const _0x2f3e4c=a0_0x2e92;var _0x21cbf9=this&&this['__decorate']||function(_0x57b1eb,_0x697e39,_0xca1b18,_0x1342e7){const _0x2cc9c0=a0_0x2e92;var _0x274586,_0x10399b=arguments[_0x2cc9c0(0x1fe)],_0x4f77be=_0x10399b<0x3?_0x697e39:null===_0x1342e7?_0x1342e7=Object[_0x2cc9c0(0x25c)](_0x697e39,_0xca1b18):_0x1342e7;if('object'==typeof Reflect&&_0x2cc9c0(0x18d)==typeof Reflect[_0x2cc9c0(0x3b0)])_0x4f77be=Reflect[_0x2cc9c0(0x3b0)](_0x57b1eb,_0x697e39,_0xca1b18,_0x1342e7);else{for(var _0xb64841=_0x57b1eb[_0x2cc9c0(0x1fe)]-0x1;_0xb64841>=0x0;_0xb64841--)(_0x274586=_0x57b1eb[_0xb64841])&&(_0x4f77be=(_0x10399b<0x3?_0x274586(_0x4f77be):_0x10399b>0x3?_0x274586(_0x697e39,_0xca1b18,_0x4f77be):_0x274586(_0x697e39,_0xca1b18))||_0x4f77be);}return _0x10399b>0x3&&_0x4f77be&&Object['defineProperty'](_0x697e39,_0xca1b18,_0x4f77be),_0x4f77be;};Object['defineProperty'](_0x272fdf,'__esModule',{'value':!0x0}),_0x272fdf['BankModule']=void 0x0;const _0x580b01=_0x2dbe84(0x2),_0x4f6ffa=_0x2dbe84(0xb),_0x417a00=_0x2dbe84(0xc),_0x59cd2b=_0x2dbe84(0x28),_0x120663=_0x2dbe84(0x2f),_0x2847c0=_0x2dbe84(0x4d),_0x442ff0=_0x2dbe84(0x47),_0x55e21f=_0x2dbe84(0x49),_0x48f83f=_0x2dbe84(0x4e),_0xc18bd0=_0x2dbe84(0x34),_0x2d2681=_0x2dbe84(0x52),_0x11c46b=_0x2dbe84(0xf),_0x1b4f16=_0x2dbe84(0x53),_0x46bfd7=_0x2dbe84(0x54),_0x5f0731=_0x2dbe84(0x32);let _0xc2caf4=class{};_0x272fdf['BankModule']=_0xc2caf4,_0x272fdf['BankModule']=_0xc2caf4=_0x21cbf9([(0x0,_0x580b01[_0x2f3e4c(0x305)])({'imports':[_0x442ff0['HcBoxModule'],(0x0,_0x580b01['forwardRef'])(()=>_0x55e21f['DeviceModule']),_0x48f83f['WebSocketModule'],_0x1b4f16['OCRModule'],_0x46bfd7['NotificationModule']],'controllers':[_0x2847c0[_0x2f3e4c(0x29b)]],'providers':[_0x4f6ffa['BankService'],_0x417a00['AcbService'],_0x59cd2b['PgService'],_0x120663['HdBankService'],_0x5f0731[_0x2f3e4c(0x377)],_0xc18bd0[_0x2f3e4c(0x371)],_0x2d2681['SessionRefreshScheduler'],_0x11c46b['RedisService']],'exports':[_0x4f6ffa[_0x2f3e4c(0x261)]]})],_0xc2caf4);},function(_0x1a6e19,_0x4879b0,_0xbfec50){const _0xddadb0=a0_0x2e92;var _0x9e9bd4,_0x25d9f7,_0x6fd2ed,_0xe995f1,_0x56f175=this&&this[_0xddadb0(0x21f)]||function(_0xa083b0,_0x43dc3b,_0x48e454,_0x1acc15){const _0x1725cc=_0xddadb0;var _0x388ea6,_0x114aa1=arguments['length'],_0x1a6b4e=_0x114aa1<0x3?_0x43dc3b:null===_0x1acc15?_0x1acc15=Object['getOwnPropertyDescriptor'](_0x43dc3b,_0x48e454):_0x1acc15;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x1725cc(0x3b0)])_0x1a6b4e=Reflect['decorate'](_0xa083b0,_0x43dc3b,_0x48e454,_0x1acc15);else{for(var _0x24030c=_0xa083b0['length']-0x1;_0x24030c>=0x0;_0x24030c--)(_0x388ea6=_0xa083b0[_0x24030c])&&(_0x1a6b4e=(_0x114aa1<0x3?_0x388ea6(_0x1a6b4e):_0x114aa1>0x3?_0x388ea6(_0x43dc3b,_0x48e454,_0x1a6b4e):_0x388ea6(_0x43dc3b,_0x48e454))||_0x1a6b4e);}return _0x114aa1>0x3&&_0x1a6b4e&&Object['defineProperty'](_0x43dc3b,_0x48e454,_0x1a6b4e),_0x1a6b4e;},_0x327c73=this&&this['__metadata']||function(_0x187c89,_0x35340a){const _0x458f11=_0xddadb0;if(_0x458f11(0x141)==typeof Reflect&&_0x458f11(0x18d)==typeof Reflect['metadata'])return Reflect['metadata'](_0x187c89,_0x35340a);},_0x513e60=this&&this[_0xddadb0(0x3e5)]||function(_0x506f60,_0x2ef0f6){return function(_0x56a494,_0x368710){_0x2ef0f6(_0x56a494,_0x368710,_0x506f60);};};Object[_0xddadb0(0x3cc)](_0x4879b0,_0xddadb0(0x110),{'value':!0x0}),_0x4879b0[_0xddadb0(0x29b)]=void 0x0;const _0x20f85e=_0xbfec50(0x2),_0x267290=_0xbfec50(0x3),_0x468f57=_0xbfec50(0xb),_0x1e833e=_0xbfec50(0x11),_0x23d417=_0xbfec50(0x13),_0x5a63eb=_0xbfec50(0xd),_0x78dba4=_0xbfec50(0x1a),_0x58ef79=_0xbfec50(0x1e),_0x2982b4=_0xbfec50(0x1b),_0x1fecd0=_0xbfec50(0x20);let _0x2d4588=class{constructor(_0x3af69c,_0x443914,_0x35b89a,_0x52ef95){const _0x25ecdb=_0xddadb0;this['bankService']=_0x3af69c,this['wsService']=_0x443914,this[_0x25ecdb(0x1dd)]=_0x35b89a,this['ocrService']=_0x52ef95,this['logger']=new _0x20f85e['Logger']('BankController');}['getBankService'](_0x3a59be){const _0x107a1d=_0xddadb0,_0x50512c=this['bankService'][_0x107a1d(0x315)](_0x3a59be);if(!_0x50512c)throw new _0x20f85e['HttpException']({'success':!0x1,'error':_0x107a1d(0x36e)+_0x3a59be+_0x107a1d(0x21a)+this['bankService']['getSupportedBanks']()['join'](',\x20')},_0x20f85e['HttpStatus']['BAD_REQUEST']);return _0x50512c;}async['getDevices'](_0xd60404){const _0x5cde40=_0xddadb0;try{return{'success':!0x0,'data':await this[_0x5cde40(0x2e6)][_0x5cde40(0x367)]()};}catch(_0x160ad6){return this['logger'][_0x5cde40(0xeb)](_0x5cde40(0x108)+_0x160ad6['message']),{'success':!0x1,'error':_0x160ad6['message']};}}async[_0xddadb0(0x170)](_0x213d53,_0x424919){const _0x239130=_0xddadb0;try{const _0xdc235a=this['getBankService'](_0x213d53);return this[_0x239130(0x1fd)]['log']('Testing\x20'+_0x213d53+_0x239130(0x227)+_0x424919),await _0xdc235a['launchApp'](_0x424919),{'success':!0x0,'message':_0x213d53+'\x20app\x20launched\x20successfully\x20on\x20device\x20'+_0x424919};}catch(_0x5a2df5){return this['logger']['error']('Error\x20testing\x20'+_0x213d53+'\x20app\x20launch:\x20'+_0x5a2df5[_0x239130(0x2a0)]),{'success':!0x1,'error':_0x5a2df5['message']};}}async['testCaptureScreen'](_0x7faf04,_0x5e538c,_0x165186,_0x55cf99){const _0x4ec90c=_0xddadb0;try{this['logger']['log']('Testing\x20screen\x20capture\x20on\x20device:\x20'+_0x5e538c);const _0x1ef56e=_0x55cf99?parseFloat(_0x55cf99):0.5,_0x571abe=_0x165186||_0x4ec90c(0x3ae)+Date[_0x4ec90c(0x1a2)](),_0x520428=await this[_0x4ec90c(0x2e6)]['captureScreen'](_0x5e538c,{'quality':_0x1ef56e,'folderPath':'C:/boxscreen/'+_0x571abe+'.png'});return{'success':!0x0,'message':'Screen\x20captured\x20successfully\x20on\x20device\x20'+_0x5e538c,'data':{'base64Image':_0x520428,'imageLength':_0x520428?.[_0x4ec90c(0x1fe)]??0x0}};}catch(_0x3fb46b){return this['logger']['error']('Error\x20testing\x20screen\x20capture:\x20'+_0x3fb46b[_0x4ec90c(0x2a0)]),{'success':!0x1,'error':_0x3fb46b['message']};}}async[_0xddadb0(0x275)](_0x8e1b9d,_0x4a58b4,_0x347a47,_0x18b18a){const _0x4cc2a7=_0xddadb0;try{const _0x4d6000=parseFloat(_0x347a47),_0x22a2ae=parseFloat(_0x18b18a);return isNaN(_0x4d6000)||isNaN(_0x22a2ae)?{'success':!0x1,'error':_0x4cc2a7(0x38b),'example':'/api/bank/'+_0x8e1b9d+_0x4cc2a7(0x20f)}:(this['logger']['log']('Testing\x20click\x20at\x20coordinates\x20('+_0x4d6000+',\x20'+_0x22a2ae+')\x20on\x20device:\x20'+_0x4a58b4),await this['wsService']['click'](_0x4a58b4,_0x4d6000,_0x22a2ae),{'success':!0x0,'message':_0x4cc2a7(0x195)+_0x4d6000+',\x20'+_0x22a2ae+_0x4cc2a7(0x3c9)+_0x4a58b4,'coordinates':{'x':_0x4d6000,'y':_0x22a2ae}});}catch(_0x1d99f6){return this['logger']['error'](_0x4cc2a7(0x2b1)+_0x1d99f6['message']),{'success':!0x1,'error':_0x1d99f6[_0x4cc2a7(0x2a0)]};}}async['testSwipe'](_0x594c3e,_0x8bd254,_0x576816,_0x976363,_0x45dbda,_0x339531,_0x56d7c1,_0x547c54){const _0x406194=_0xddadb0;try{const _0x2dbac2=_0x406194(0x390)===_0x1e833e['config']['boxType'],_0x2f7606='HC'===_0x1e833e['config']['boxType'];if(_0x2dbac2){if(!_0x45dbda)return{'success':!0x1,'error':_0x406194(0x1ee),'example':_0x406194(0x37d)+_0x594c3e+'/test/swipe/{deviceId}?type=0'};if(!['0','1','2','4','5','6','7','8','9','10'][_0x406194(0x177)](_0x45dbda))return{'success':!0x1,'error':'Invalid\x20type.\x20Type\x20must\x20be\x20one\x20of:\x200\x20(Êåâ‰∏ã/press),\x201\x20(Êä¨Ëµ∑/lift),\x202\x20(ÁßªÂä®/move),\x204\x20(ÊªöËΩÆÂêë‰∏ä/scroll\x20up),\x205\x20(ÊªöËΩÆÂêë‰∏ã/scroll\x20down),\x206\x20(‰∏äÊªë/swipe\x20up),\x207\x20(‰∏ãÊªë/swipe\x20down),\x208\x20(Â∑¶Êªë/swipe\x20left),\x209\x20(Âè≥Êªë/swipe\x20right),\x2010\x20(ÁÇπÂáª/click)','example':'/api/bank/'+_0x594c3e+'/test/swipe/{deviceId}?type=0'};if(!(['4','5','6','7','8','9']['includes'](_0x45dbda)||_0x576816&&_0x976363))return{'success':!0x1,'error':'For\x20Panda\x20type\x20'+_0x45dbda+_0x406194(0x2d4),'example':'/api/bank/'+_0x594c3e+_0x406194(0x2b2)+_0x45dbda};const _0x493451={'type':_0x45dbda};if(_0x576816&&_0x976363){const _0x5bf939=parseFloat(_0x576816),_0x1226b3=parseFloat(_0x976363);if(isNaN(_0x5bf939)||isNaN(_0x1226b3))return{'success':!0x1,'error':_0x406194(0x128),'example':'/api/bank/'+_0x594c3e+_0x406194(0x2b2)+_0x45dbda};if(_0x5bf939<0x0||_0x5bf939>0x64||_0x1226b3<0x0||_0x1226b3>0x64)return{'success':!0x1,'error':_0x406194(0x293),'example':'/api/bank/'+_0x594c3e+'/test/swipe/{deviceId}?x=50&y=30&type='+_0x45dbda};_0x493451['x']=_0x5bf939[_0x406194(0x38a)](),_0x493451['y']=_0x1226b3['toString']();}return this['logger']['log'](_0x406194(0x2dc)+_0x8bd254+_0x406194(0x1f1)+_0x45dbda+(_0x576816&&_0x976363?_0x406194(0x2ba)+_0x576816+_0x406194(0x1c1)+_0x976363:_0x406194(0x135))),await this['wsService']['swipe'](_0x8bd254,_0x493451),{'success':!0x0,'message':_0x406194(0x11d)+_0x8bd254,'coordinates':{'type':_0x45dbda,..._0x576816&&_0x976363?{'x':_0x576816,'y':_0x976363}:{}}};}if(_0x2f7606){if(!(_0x576816&&_0x976363&&_0x339531&&_0x56d7c1))return{'success':!0x1,'error':'For\x20HC\x20format:\x20x,\x20y,\x20endX,\x20and\x20endY\x20are\x20required','example':_0x406194(0x37d)+_0x594c3e+'/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3'};const _0x44119d=parseFloat(_0x576816),_0x5265cf=parseFloat(_0x976363),_0x1a0772=parseFloat(_0x339531),_0x115bf4=parseFloat(_0x56d7c1),_0x1f3a82=_0x547c54?parseFloat(_0x547c54):0.2;return isNaN(_0x44119d)||isNaN(_0x5265cf)||isNaN(_0x1a0772)||isNaN(_0x115bf4)?{'success':!0x1,'error':'Invalid\x20coordinates.\x20x,\x20y,\x20endX,\x20and\x20endY\x20must\x20be\x20numbers\x20between\x200\x20and\x201\x20for\x20HC','example':_0x406194(0x37d)+_0x594c3e+'/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3'}:_0x44119d<0x0||_0x44119d>0x1||_0x5265cf<0x0||_0x5265cf>0x1||_0x1a0772<0x0||_0x1a0772>0x1||_0x115bf4<0x0||_0x115bf4>0x1?{'success':!0x1,'error':'Invalid\x20coordinates.\x20x,\x20y,\x20endX,\x20and\x20endY\x20must\x20be\x20between\x200\x20and\x201\x20for\x20HC','example':_0x406194(0x37d)+_0x594c3e+_0x406194(0x2b7)}:(this['logger'][_0x406194(0x2d5)]('Testing\x20HC\x20swipe\x20from\x20('+_0x44119d+',\x20'+_0x5265cf+')\x20to\x20('+_0x1a0772+',\x20'+_0x115bf4+_0x406194(0xe1)+_0x8bd254),await this[_0x406194(0x2e6)]['swipe'](_0x8bd254,{'x':_0x44119d,'y':_0x5265cf,'endX':_0x1a0772,'endY':_0x115bf4,'duration':_0x1f3a82}),{'success':!0x0,'message':'HC\x20swipe\x20completed\x20successfully\x20from\x20('+_0x44119d+',\x20'+_0x5265cf+_0x406194(0x1a3)+_0x1a0772+',\x20'+_0x115bf4+_0x406194(0x3c9)+_0x8bd254,'coordinates':{'start':{'x':_0x44119d,'y':_0x5265cf},'end':{'x':_0x1a0772,'y':_0x115bf4},'duration':_0x1f3a82}});}return{'success':!0x1,'error':'Invalid\x20box\x20type\x20configuration:\x20'+_0x1e833e[_0x406194(0x302)]['boxType']+'.\x20Must\x20be\x20\x27HC\x27\x20or\x20\x27PANDA\x27'};}catch(_0x2c109f){return this[_0x406194(0x1fd)]['error']('Error\x20testing\x20swipe:\x20'+_0x2c109f['message']),{'success':!0x1,'error':_0x2c109f['message']};}}async['testInputNumpadNumber'](_0x368a47,_0x5a7fba,_0x461952){const _0xad9357=_0xddadb0;try{return _0x461952&&0x0!==_0x461952['trim']()['length']?/^\d+$/['test'](_0x461952)?(this['logger']['log'](_0xad9357(0x239)+_0x461952+_0xad9357(0x192)+_0x5a7fba),await this[_0xad9357(0x2e6)]['inputNumpadNumber'](_0x5a7fba,_0x461952),{'success':!0x0,'message':_0xad9357(0x1db)+_0x5a7fba,'data':{'number':_0x461952,'digits':_0x461952[_0xad9357(0x149)]('')['map'](_0x48e68a=>parseInt(_0x48e68a))}}):{'success':!0x1,'error':'Number\x20must\x20contain\x20only\x20digits\x20(0-9)','example':_0xad9357(0x37d)+_0x368a47+'/test/input-numpad/{deviceId}?number=123456'}:{'success':!0x1,'error':'Number\x20is\x20required\x20and\x20cannot\x20be\x20empty','example':'/api/bank/'+_0x368a47+'/test/input-numpad/{deviceId}?number=123456'};}catch(_0x1a8064){return this['logger']['error']('Error\x20testing\x20numpad\x20number\x20input:\x20'+_0x1a8064[_0xad9357(0x2a0)]),{'success':!0x1,'error':_0x1a8064['message']};}}async['testInputText'](_0x379c3d,_0x24d257,_0x380b94){const _0x1b09d8=_0xddadb0;try{return _0x380b94&&0x0!==_0x380b94['trim']()['length']?(this['logger']['log']('Testing\x20text\x20input\x20\x22'+_0x380b94+_0x1b09d8(0x192)+_0x24d257),await this[_0x1b09d8(0x2e6)]['inputText'](_0x24d257,_0x380b94),{'success':!0x0,'message':'Text\x20input\x20completed\x20successfully\x20on\x20device\x20'+_0x24d257}):{'success':!0x1,'error':_0x1b09d8(0x11c),'example':'/api/bank/'+_0x379c3d+_0x1b09d8(0x306)};}catch(_0x363bfb){return this['logger']['error']('Error\x20testing\x20text\x20input:\x20'+_0x363bfb['message']),{'success':!0x1,'error':_0x363bfb[_0x1b09d8(0x2a0)]};}}async[_0xddadb0(0x11b)](_0x279456,_0x2476e1){const _0x4639d7=_0xddadb0;try{return this['logger']['log'](_0x4639d7(0xf5)+_0x2476e1),await this[_0x4639d7(0x2e6)]['pressReturnKey'](_0x2476e1),{'success':!0x0,'message':'Return\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0x2476e1,'note':_0x4639d7(0x3d1)};}catch(_0x335f87){return this['logger'][_0x4639d7(0xeb)]('Error\x20testing\x20press\x20return:\x20'+_0x335f87['message']),{'success':!0x1,'error':_0x335f87[_0x4639d7(0x2a0)]};}}async[_0xddadb0(0x23b)](_0x935428,_0x1bfd39,_0x21aa54,_0x2e30a6,_0x2c137a,_0x106f62){const _0x37c3f1=_0xddadb0,_0x31d1ba='C:/testroi';try{await(0x0,_0x78dba4['rm'])(_0x31d1ba,{'recursive':!0x0,'force':!0x0}),this['logger'][_0x37c3f1(0x2d5)]('ƒê√£\x20x√≥a\x20folder\x20'+_0x31d1ba);}catch(_0xc7755c){this['logger'][_0x37c3f1(0x266)](_0x37c3f1(0x2df)+_0xc7755c['message']);}await(0x0,_0x78dba4[_0x37c3f1(0x392)])(_0x31d1ba,{'recursive':!0x0}),await this['wsService']['captureScreen'](_0x1bfd39,{'folderPath':_0x31d1ba});const _0x197648=await this['bankService']['getLatestImagePath'](_0x31d1ba),_0x5266d2=await(0x0,_0x78dba4['readFile'])(_0x197648),_0x218dfb=await this[_0x37c3f1(0x1dd)]['preprocess'](_0x5266d2,{'x':parseFloat(_0x21aa54),'y':parseFloat(_0x2e30a6),'width':parseFloat(_0x2c137a),'height':parseFloat(_0x106f62)},void 0x0,{'grayscale':!0x0,'enhanceContrast':!0x0}),_0x15611d=await this['ocrService']['recognizeFromBuffer'](_0x218dfb[_0x37c3f1(0x30c)]),_0x2bac98=_0x31d1ba+'/processed-'+Date['now']()+_0x37c3f1(0x214);return await(0x0,_0x78dba4[_0x37c3f1(0x268)])(_0x2bac98,_0x218dfb[_0x37c3f1(0x30c)]),{..._0x15611d,'normalizedText':(0x0,_0x1fecd0['removeVietnameseTones'])(_0x15611d['text'])};}};_0x4879b0['BankController']=_0x2d4588,_0x56f175([(0x0,_0x20f85e['Get'])('devices'),(0x0,_0x267290['ApiOperation'])({'summary':'Get\x20list\x20of\x20available\x20devices'}),(0x0,_0x267290['ApiParam'])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x267290['ApiResponse'])({'status':0xc8,'description':_0xddadb0(0x24d)}),_0x513e60(0x0,(0x0,_0x20f85e['Param'])('bankCode')),_0x327c73('design:type',Function),_0x327c73('design:paramtypes',[String]),_0x327c73('design:returntype',Promise)],_0x2d4588['prototype'],'getDevices',null),_0x56f175([(0x0,_0x20f85e[_0xddadb0(0x39d)])(_0xddadb0(0x3d0)),(0x0,_0x267290[_0xddadb0(0x1d4)])({'summary':'Test\x20launching\x20bank\x20app\x20on\x20a\x20device'}),(0x0,_0x267290['ApiParam'])({'name':'bankCode','description':_0xddadb0(0x146)}),(0x0,_0x267290['ApiParam'])({'name':'deviceId','description':_0xddadb0(0xfa)}),(0x0,_0x267290[_0xddadb0(0x276)])({'status':0xc8,'description':_0xddadb0(0x242)}),_0x513e60(0x0,(0x0,_0x20f85e['Param'])('bankCode')),_0x513e60(0x1,(0x0,_0x20f85e['Param'])(_0xddadb0(0x14b))),_0x327c73(_0xddadb0(0x19a),Function),_0x327c73('design:paramtypes',[String,String]),_0x327c73('design:returntype',Promise)],_0x2d4588['prototype'],'testLaunchApp',null),_0x56f175([(0x0,_0x20f85e['Post'])(_0xddadb0(0x3b2)),(0x0,_0x267290[_0xddadb0(0x1d4)])({'summary':'Test\x20screen\x20capture\x20on\x20a\x20device'}),(0x0,_0x267290[_0xddadb0(0x1cf)])({'name':_0xddadb0(0x126),'description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x267290[_0xddadb0(0x1cf)])({'name':'deviceId','description':_0xddadb0(0xfa)}),(0x0,_0x267290['ApiQuery'])({'name':_0xddadb0(0x104),'description':'Screen\x20capture\x20name\x20(optional)','required':!0x1}),(0x0,_0x267290['ApiQuery'])({'name':_0xddadb0(0x100),'description':'Image\x20quality\x20(0-1,\x20default:\x200.5)','required':!0x1}),(0x0,_0x267290[_0xddadb0(0x276)])({'status':0xc8,'description':_0xddadb0(0x39b)}),_0x513e60(0x0,(0x0,_0x20f85e['Param'])('bankCode')),_0x513e60(0x1,(0x0,_0x20f85e[_0xddadb0(0x14f)])('deviceId')),_0x513e60(0x2,(0x0,_0x20f85e['Query'])('name')),_0x513e60(0x3,(0x0,_0x20f85e['Query'])('quality')),_0x327c73('design:type',Function),_0x327c73('design:paramtypes',[String,String,String,String]),_0x327c73('design:returntype',Promise)],_0x2d4588[_0xddadb0(0x2b4)],'testCaptureScreen',null),_0x56f175([(0x0,_0x20f85e['Post'])('test/click/:deviceId'),(0x0,_0x267290['ApiOperation'])({'summary':_0xddadb0(0x137)}),(0x0,_0x267290['ApiParam'])({'name':_0xddadb0(0x126),'description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x267290['ApiParam'])({'name':_0xddadb0(0x14b),'description':'Device\x20ID'}),(0x0,_0x267290['ApiQuery'])({'name':'x','description':_0xddadb0(0x27f),'required':!0x0}),(0x0,_0x267290['ApiQuery'])({'name':'y','description':'Y\x20coordinate\x20(Hc:\x200-1),\x20Panda:\x200-100','required':!0x0}),(0x0,_0x267290['ApiResponse'])({'status':0xc8,'description':'Click\x20completed\x20successfully'}),_0x513e60(0x0,(0x0,_0x20f85e['Param'])(_0xddadb0(0x126))),_0x513e60(0x1,(0x0,_0x20f85e['Param'])(_0xddadb0(0x14b))),_0x513e60(0x2,(0x0,_0x20f85e['Query'])('x')),_0x513e60(0x3,(0x0,_0x20f85e['Query'])('y')),_0x327c73('design:type',Function),_0x327c73(_0xddadb0(0x22c),[String,String,String,String]),_0x327c73('design:returntype',Promise)],_0x2d4588['prototype'],'testClickAtCoordinates',null),_0x56f175([(0x0,_0x20f85e['Post'])('test/swipe/:deviceId'),(0x0,_0x267290['ApiOperation'])({'summary':_0xddadb0(0x37e)}),(0x0,_0x267290[_0xddadb0(0x1cf)])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x267290[_0xddadb0(0x1cf)])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x267290['ApiQuery'])({'name':'x','description':_0xddadb0(0x1ac),'required':!0x1}),(0x0,_0x267290['ApiQuery'])({'name':'y','description':_0xddadb0(0x20b),'required':!0x1}),(0x0,_0x267290['ApiQuery'])({'name':'type','description':'Panda\x20pointer\x20event\x20type:\x200=Êåâ‰∏ã(press),\x201=Êä¨Ëµ∑(lift),\x202=ÁßªÂä®(move),\x204=ÊªöËΩÆÂêë‰∏ä(scroll\x20up),\x205=ÊªöËΩÆÂêë‰∏ã(scroll\x20down),\x206=‰∏äÊªë(swipe\x20up),\x207=‰∏ãÊªë(swipe\x20down),\x208=Â∑¶Êªë(swipe\x20left),\x209=Âè≥Êªë(swipe\x20right),\x2010=ÁÇπÂáª(click).\x20Required\x20for\x20Panda\x20format.','required':!0x1}),(0x0,_0x267290['ApiQuery'])({'name':'endX','description':'End\x20X\x20coordinate\x20for\x20HC\x20(required\x20for\x20HC:\x200-1)','required':!0x1}),(0x0,_0x267290['ApiQuery'])({'name':_0xddadb0(0x233),'description':'End\x20Y\x20coordinate\x20for\x20HC\x20(required\x20for\x20HC:\x200-1)','required':!0x1}),(0x0,_0x267290['ApiQuery'])({'name':'duration','description':'Swipe\x20duration\x20for\x20HC\x20(default:\x200.2)','required':!0x1}),(0x0,_0x267290[_0xddadb0(0x276)])({'status':0xc8,'description':'Swipe\x20completed\x20successfully'}),_0x513e60(0x0,(0x0,_0x20f85e['Param'])('bankCode')),_0x513e60(0x1,(0x0,_0x20f85e[_0xddadb0(0x14f)])('deviceId')),_0x513e60(0x2,(0x0,_0x20f85e['Query'])('x')),_0x513e60(0x3,(0x0,_0x20f85e['Query'])('y')),_0x513e60(0x4,(0x0,_0x20f85e[_0xddadb0(0x13f)])('type')),_0x513e60(0x5,(0x0,_0x20f85e['Query'])('endX')),_0x513e60(0x6,(0x0,_0x20f85e['Query'])('endY')),_0x513e60(0x7,(0x0,_0x20f85e['Query'])(_0xddadb0(0xef))),_0x327c73(_0xddadb0(0x19a),Function),_0x327c73('design:paramtypes',[String,String,String,String,String,String,String,String]),_0x327c73(_0xddadb0(0x157),Promise)],_0x2d4588['prototype'],'testSwipe',null),_0x56f175([(0x0,_0x20f85e[_0xddadb0(0x39d)])('test/input-numpad/:deviceId'),(0x0,_0x267290['ApiOperation'])({'summary':_0xddadb0(0x3b7)}),(0x0,_0x267290[_0xddadb0(0x1cf)])({'name':_0xddadb0(0x126),'description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x267290['ApiParam'])({'name':_0xddadb0(0x14b),'description':'Device\x20ID'}),(0x0,_0x267290['ApiQuery'])({'name':_0xddadb0(0x370),'description':_0xddadb0(0x16c),'required':!0x0}),(0x0,_0x267290[_0xddadb0(0x276)])({'status':0xc8,'description':'Numpad\x20number\x20input\x20completed\x20successfully'}),_0x513e60(0x0,(0x0,_0x20f85e[_0xddadb0(0x14f)])('bankCode')),_0x513e60(0x1,(0x0,_0x20f85e['Param'])('deviceId')),_0x513e60(0x2,(0x0,_0x20f85e[_0xddadb0(0x13f)])(_0xddadb0(0x370))),_0x327c73(_0xddadb0(0x19a),Function),_0x327c73('design:paramtypes',[String,String,String]),_0x327c73('design:returntype',Promise)],_0x2d4588['prototype'],'testInputNumpadNumber',null),_0x56f175([(0x0,_0x20f85e['Post'])('test/input-text/:deviceId'),(0x0,_0x267290['ApiOperation'])({'summary':_0xddadb0(0x2c6)}),(0x0,_0x267290['ApiParam'])({'name':_0xddadb0(0x126),'description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x267290['ApiParam'])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x267290['ApiQuery'])({'name':_0xddadb0(0x209),'description':'Text\x20string\x20to\x20input\x20(e.g.,\x20\x22abc123\x22,\x20\x22test@email.com\x22)','required':!0x0}),(0x0,_0x267290['ApiResponse'])({'status':0xc8,'description':'Text\x20input\x20completed\x20successfully'}),_0x513e60(0x0,(0x0,_0x20f85e[_0xddadb0(0x14f)])('bankCode')),_0x513e60(0x1,(0x0,_0x20f85e[_0xddadb0(0x14f)])('deviceId')),_0x513e60(0x2,(0x0,_0x20f85e['Query'])('text')),_0x327c73('design:type',Function),_0x327c73('design:paramtypes',[String,String,String]),_0x327c73(_0xddadb0(0x157),Promise)],_0x2d4588['prototype'],'testInputText',null),_0x56f175([(0x0,_0x20f85e[_0xddadb0(0x39d)])('test/press-return/:deviceId'),(0x0,_0x267290[_0xddadb0(0x1d4)])({'summary':_0xddadb0(0x343)}),(0x0,_0x267290[_0xddadb0(0x1cf)])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x267290[_0xddadb0(0x1cf)])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x267290['ApiResponse'])({'status':0xc8,'description':'Return\x20key\x20pressed\x20successfully'}),_0x513e60(0x0,(0x0,_0x20f85e['Param'])('bankCode')),_0x513e60(0x1,(0x0,_0x20f85e['Param'])(_0xddadb0(0x14b))),_0x327c73('design:type',Function),_0x327c73('design:paramtypes',[String,String]),_0x327c73('design:returntype',Promise)],_0x2d4588['prototype'],'testPressReturn',null),_0x56f175([(0x0,_0x20f85e['Post'])(_0xddadb0(0x2c8)),(0x0,_0x267290['ApiOperation'])({'summary':'Test\x20ROI\x20detection\x20on\x20a\x20device'}),(0x0,_0x267290['ApiParam'])({'name':_0xddadb0(0x126),'description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x267290[_0xddadb0(0x223)])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x267290['ApiQuery'])({'name':'x','description':'X\x20coordinate','required':!0x0}),(0x0,_0x267290['ApiQuery'])({'name':'y','description':'Y\x20coordinate','required':!0x0}),(0x0,_0x267290['ApiQuery'])({'name':'width','description':'Width','required':!0x0}),(0x0,_0x267290['ApiQuery'])({'name':_0xddadb0(0x259),'description':'Height','required':!0x0}),_0x513e60(0x0,(0x0,_0x20f85e['Param'])('bankCode')),_0x513e60(0x1,(0x0,_0x20f85e[_0xddadb0(0x13f)])('deviceId')),_0x513e60(0x2,(0x0,_0x20f85e['Query'])('x')),_0x513e60(0x3,(0x0,_0x20f85e['Query'])('y')),_0x513e60(0x4,(0x0,_0x20f85e['Query'])(_0xddadb0(0x263))),_0x513e60(0x5,(0x0,_0x20f85e['Query'])('height')),_0x327c73('design:type',Function),_0x327c73('design:paramtypes',[String,String,String,String,String,String]),_0x327c73('design:returntype',Promise)],_0x2d4588['prototype'],'testRoi',null),_0x4879b0['BankController']=_0x2d4588=_0x56f175([(0x0,_0x267290['ApiTags'])('bank'),(0x0,_0x20f85e['Controller'])(_0xddadb0(0x1ce)),_0x513e60(0x1,(0x0,_0x20f85e[_0xddadb0(0x33a)])(_0x5a63eb[_0xddadb0(0x311)])),_0x327c73(_0xddadb0(0x22c),[_0xddadb0(0x18d)==typeof(_0x9e9bd4=void 0x0!==_0x468f57['BankService']&&_0x468f57[_0xddadb0(0x261)])?_0x9e9bd4:Object,'function'==typeof(_0x25d9f7=void 0x0!==_0x23d417['IWebSocketService']&&_0x23d417[_0xddadb0(0x258)])?_0x25d9f7:Object,_0xddadb0(0x18d)==typeof(_0x6fd2ed=void 0x0!==_0x58ef79['ImagePreprocessingService']&&_0x58ef79[_0xddadb0(0x1d5)])?_0x6fd2ed:Object,'function'==typeof(_0xe995f1=void 0x0!==_0x2982b4[_0xddadb0(0x3dc)]&&_0x2982b4['OCRService'])?_0xe995f1:Object])],_0x2d4588);},function(_0x439dd8,_0x124dcd,_0x4e4d7e){const _0x332531=a0_0x2e92;var _0xe43ed2=this&&this['__decorate']||function(_0x5c0a75,_0x210ebe,_0x20f4f6,_0x334591){const _0x49f1fa=a0_0x2e92;var _0x18e6ff,_0x291d7a=arguments['length'],_0x3cf569=_0x291d7a<0x3?_0x210ebe:null===_0x334591?_0x334591=Object['getOwnPropertyDescriptor'](_0x210ebe,_0x20f4f6):_0x334591;if(_0x49f1fa(0x141)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x3cf569=Reflect['decorate'](_0x5c0a75,_0x210ebe,_0x20f4f6,_0x334591);else{for(var _0x42cd74=_0x5c0a75[_0x49f1fa(0x1fe)]-0x1;_0x42cd74>=0x0;_0x42cd74--)(_0x18e6ff=_0x5c0a75[_0x42cd74])&&(_0x3cf569=(_0x291d7a<0x3?_0x18e6ff(_0x3cf569):_0x291d7a>0x3?_0x18e6ff(_0x210ebe,_0x20f4f6,_0x3cf569):_0x18e6ff(_0x210ebe,_0x20f4f6))||_0x3cf569);}return _0x291d7a>0x3&&_0x3cf569&&Object[_0x49f1fa(0x3cc)](_0x210ebe,_0x20f4f6,_0x3cf569),_0x3cf569;};Object['defineProperty'](_0x124dcd,'__esModule',{'value':!0x0}),_0x124dcd['WebSocketModule']=void 0x0;const _0x534553=_0x4e4d7e(0x2),_0x3b38da=_0x4e4d7e(0x4f),_0x395ffd=_0x4e4d7e(0x51),_0x556130=_0x4e4d7e(0xd),_0x3037be=_0x4e4d7e(0x11);let _0xf0025d=class{};_0x124dcd[_0x332531(0xde)]=_0xf0025d,_0x124dcd[_0x332531(0xde)]=_0xf0025d=_0xe43ed2([(0x0,_0x534553['Global'])(),(0x0,_0x534553['Module'])({'providers':[{'provide':_0x556130['WEBSOCKET_SERVICE'],'useClass':_0x332531(0x390)===_0x3037be[_0x332531(0x302)][_0x332531(0x3da)]?_0x395ffd['PandaWebSocketService']:_0x3b38da['HCWebSocketService']}],'exports':[_0x556130['WEBSOCKET_SERVICE']]})],_0xf0025d);},function(_0x312eb2,_0x4e50dd,_0x39ee9c){const _0x1f9129=a0_0x2e92;var _0x2807ff=this&&this[_0x1f9129(0x21f)]||function(_0x3cd8bc,_0x52f59e,_0x3e7db5,_0x511d76){const _0x3653bf=_0x1f9129;var _0x1896d7,_0x31f8df=arguments['length'],_0x3f6ce0=_0x31f8df<0x3?_0x52f59e:null===_0x511d76?_0x511d76=Object[_0x3653bf(0x25c)](_0x52f59e,_0x3e7db5):_0x511d76;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x3653bf(0x3b0)])_0x3f6ce0=Reflect['decorate'](_0x3cd8bc,_0x52f59e,_0x3e7db5,_0x511d76);else{for(var _0x3263e9=_0x3cd8bc['length']-0x1;_0x3263e9>=0x0;_0x3263e9--)(_0x1896d7=_0x3cd8bc[_0x3263e9])&&(_0x3f6ce0=(_0x31f8df<0x3?_0x1896d7(_0x3f6ce0):_0x31f8df>0x3?_0x1896d7(_0x52f59e,_0x3e7db5,_0x3f6ce0):_0x1896d7(_0x52f59e,_0x3e7db5))||_0x3f6ce0);}return _0x31f8df>0x3&&_0x3f6ce0&&Object['defineProperty'](_0x52f59e,_0x3e7db5,_0x3f6ce0),_0x3f6ce0;},_0x1a7dc0=this&&this['__metadata']||function(_0x4953d2,_0x4f8e15){const _0x41fa12=_0x1f9129;if(_0x41fa12(0x141)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x41fa12(0x3ac)](_0x4953d2,_0x4f8e15);};Object['defineProperty'](_0x4e50dd,'__esModule',{'value':!0x0}),_0x4e50dd[_0x1f9129(0x32c)]=void 0x0;const _0x5b5cfe=_0x39ee9c(0x2),_0x320bd9=_0x39ee9c(0x50),_0x2d0dc0=_0x39ee9c(0x26),_0x2c7818=_0x39ee9c(0x18),_0x4144ff=_0x39ee9c(0x16);let _0x1a9b38=class{constructor(){const _0x2a1572=_0x1f9129;this[_0x2a1572(0x1fd)]=new _0x5b5cfe['Logger'](_0x2a1572(0x32c)),this['ws']=null,this['reconnectAttempts']=0x0,this['maxReconnectAttempts']=0xa,this['reconnectDelay']=0x1388,this['requestQueue']=[],this[_0x2a1572(0x308)]=new Map(),this[_0x2a1572(0x33c)]=!0x1,this['isProcessingRequest']=!0x1,this[_0x2a1572(0x13b)]=_0x2a1572(0x164);}async['onModuleInit'](){await this['connect']();}async['onModuleDestroy'](){await this['disconnect']();}async[_0x1f9129(0x32f)](){return new Promise((_0xf91bbd,_0x5d3322)=>{const _0x3b2070=a0_0x2e92;try{this['logger']['log']('Connecting\x20to\x20HC\x20BOX\x20WebSocket:\x20'+this['wsUrl']),this['ws']=new _0x320bd9(this['wsUrl']),this['ws']['on']('open',()=>{const _0xd30de=a0_0x2e92;this['logger'][_0xd30de(0x2d5)]('HC\x20BOX\x20WebSocket\x20connected'),this['isConnected']=!0x0,this[_0xd30de(0x3a0)]=0x0,this[_0xd30de(0x34d)](),_0xf91bbd();}),this['ws']['on'](_0x3b2070(0x2a0),_0x486e14=>{try{const _0x5e3aca=JSON['parse'](_0x486e14['toString']());this['handleMessage'](_0x5e3aca);}catch(_0x10e3d3){this['logger']['error']('Error\x20parsing\x20WebSocket\x20message:\x20'+_0x10e3d3['message']);}}),this['ws']['on']('error',_0x5a64b6=>{const _0x3fc426=_0x3b2070;this[_0x3fc426(0x1fd)]['error']('WebSocket\x20error:\x20'+_0x5a64b6['message']),this['isConnected']=!0x1,0x0===this['reconnectAttempts']&&_0x5d3322(_0x5a64b6);}),this['ws']['on'](_0x3b2070(0x31a),()=>{this['logger']['warn']('HC\x20BOX\x20WebSocket\x20closed'),this['isConnected']=!0x1,this['scheduleReconnect']();});}catch(_0x506527){this[_0x3b2070(0x1fd)]['error']('Error\x20creating\x20WebSocket\x20connection:\x20'+_0x506527[_0x3b2070(0x2a0)]),_0x5d3322(_0x506527);}});}[_0x1f9129(0x33e)](){const _0x10cf47=_0x1f9129;if(this['reconnectAttempts']>=this[_0x10cf47(0x35e)])return void this['logger']['error']('Max\x20reconnection\x20attempts\x20reached');this['reconnectAttempts']++;const _0x1077b9=this['reconnectDelay']*this['reconnectAttempts'];this['logger']['log'](_0x10cf47(0x2e2)+this['reconnectAttempts']+'\x20in\x20'+_0x1077b9+'ms'),setTimeout(()=>{this['connect']()['catch'](_0x37c461=>{const _0x495787=a0_0x2e92;this['logger']['error'](_0x495787(0x3f0)+_0x37c461[_0x495787(0x2a0)]);});},_0x1077b9);}async['disconnect'](){const _0x59b46e=_0x1f9129;this['ws']&&(this['ws'][_0x59b46e(0x31a)](),this['ws']=null,this['isConnected']=!0x1);}['handleMessage'](_0x1ce577){const _0x3abe96=_0x1f9129;if(this[_0x3abe96(0x308)]['size']>0x0){const [_0x3c4ef3,_0x4de481]=this['pendingRequests']['entries']()[_0x3abe96(0x260)]()['value'];this['pendingRequests'][_0x3abe96(0xe7)](_0x3c4ef3),0xc8===_0x1ce577['StatusCode']?_0x4de481['resolve'](_0x1ce577['result']):_0x4de481['reject'](new Error(_0x3abe96(0x152)+_0x1ce577['StatusCode']));}else this['logger']['warn']('Received\x20response\x20but\x20no\x20pending\x20requests:\x20'+JSON['stringify'](_0x1ce577));}async['processRequestQueue'](){const _0xb40aac=_0x1f9129;if(this['isProcessingRequest']||0x0===this['requestQueue'][_0xb40aac(0x1fe)])return;if(!this['isConnected']||!this['ws'])return;this[_0xb40aac(0x3a1)]=!0x0;const {request:_0x1c8be3,resolve:_0x43baf4,reject:_0x519669,timeout:_0x2b4868}=this['requestQueue']['shift']();try{_0x43baf4(await this[_0xb40aac(0x191)](_0x1c8be3,_0x2b4868));}catch(_0x383bbe){_0x519669(_0x383bbe);}finally{this[_0xb40aac(0x3a1)]=!0x1,this['requestQueue']['length']>0x0&&setImmediate(()=>this[_0xb40aac(0x34d)]());}}async[_0x1f9129(0x191)](_0x51f021,_0x44b063=0x7530){return new Promise((_0x243446,_0x4abaed)=>{const _0x6ac2b6=a0_0x2e92,_0x1cbb4c=Date['now']()['toString']()+Math['random']()[_0x6ac2b6(0x38a)](0x24)['substr'](0x2,0x9);this[_0x6ac2b6(0x308)]['set'](_0x1cbb4c,{'resolve':_0x243446,'reject':_0x4abaed});const _0x54d5e5=setTimeout(()=>{const _0x54b4bb=_0x6ac2b6;this[_0x54b4bb(0x308)]['delete'](_0x1cbb4c),_0x4abaed(new Error('WebSocket\x20request\x20timeout'));},_0x44b063),_0x3d986b=_0x243446,_0x3d7c14=_0x4abaed;_0x243446=_0x5a2709=>{clearTimeout(_0x54d5e5),_0x3d986b(_0x5a2709);},_0x4abaed=_0x198417=>{clearTimeout(_0x54d5e5),_0x3d7c14(_0x198417);},this['pendingRequests']['set'](_0x1cbb4c,{'resolve':_0x243446,'reject':_0x4abaed});try{this['ws'][_0x6ac2b6(0xf1)](JSON['stringify'](_0x51f021));}catch(_0x53d009){this[_0x6ac2b6(0x308)]['delete'](_0x1cbb4c),clearTimeout(_0x54d5e5),_0x4abaed(_0x53d009);}});}async['sendRequest'](_0x3c8e3c,_0x5d2912=0x7530){return new Promise((_0x150171,_0x1b5975)=>{this['requestQueue']['push']({'request':_0x3c8e3c,'resolve':_0x150171,'reject':_0x1b5975,'timeout':_0x5d2912}),this['processRequestQueue']();});}async['listDevices'](){const _0x48f7e1=_0x1f9129,_0x44309f=await this['sendRequest']({'action':_0x48f7e1(0x298)});return Array['isArray'](_0x44309f)?_0x44309f:[];}async['click'](_0x766b61,_0x51d470,_0xabe58,_0x543c2c=0.2){const _0x864e5d=_0x1f9129,_0x21dd67=Array[_0x864e5d(0x1e3)](_0x766b61)?_0x766b61[_0x864e5d(0x3ed)](','):_0x766b61;return this[_0x864e5d(0x1c9)]({'action':_0x864e5d(0x287),'comm':{'deviceIds':_0x21dd67,'x':_0x51d470,'y':_0xabe58,'duration':_0x543c2c}});}async['swipe'](_0x30b057,_0x27045c){const _0xd480d9=_0x1f9129,_0x30b98f=Array[_0xd480d9(0x1e3)](_0x30b057)?_0x30b057[_0xd480d9(0x3ed)](','):_0x30b057;return this['sendRequest']({'action':'swipe','comm':{'deviceIds':_0x30b98f,..._0x27045c}});}async['captureScreen'](_0x2dec08,_0x35a543){const _0x5ba68f=_0x1f9129;return this['sendRequest']({'action':_0x5ba68f(0x1d6),'comm':{'deviceIds':_0x2dec08,...(0x0,_0x4144ff['omit'])(_0x35a543,'folderPath'),'filePath':_0x35a543['folderPath']}});}async['home'](_0x32b9f4){const _0x3e9888=_0x1f9129,_0x28ae87=Array['isArray'](_0x32b9f4)?_0x32b9f4[_0x3e9888(0x3ed)](','):_0x32b9f4;return this['sendRequest']({'action':_0x3e9888(0x353),'comm':{'deviceIds':_0x28ae87}});}async['launchApp'](_0x36b01c,_0x23d938){const _0x1ab0c9=_0x1f9129,_0x3a98d1=Array['isArray'](_0x36b01c)?_0x36b01c['join'](','):_0x36b01c;return this['sendRequest']({'action':_0x1ab0c9(0x1e8),'comm':{'deviceIds':_0x3a98d1,'content':_0x23d938}});}async['killApp'](_0x4193ba,_0x56c49a){const _0x545068=_0x1f9129,_0x56061c=Array['isArray'](_0x4193ba)?_0x4193ba[_0x545068(0x3ed)](','):_0x4193ba;return this[_0x545068(0x1c9)]({'action':'killApp','comm':{'deviceIds':_0x56061c,'content':_0x56c49a}});}[_0x1f9129(0x3a5)](_0x4d7eae){return/^[0-9]$/['test'](_0x4d7eae);}['isLetter'](_0x2046d9){return/^[a-zA-Z]$/['test'](_0x2046d9);}['isSpecialCharInNumberMode'](_0xea895d){const _0x38b791=_0x1f9129;return['@','!'][_0x38b791(0x177)](_0xea895d);}async['switchKeyboardMode'](_0x189189){const _0x3d814f=_0x1f9129,{x:_0x251701,y:_0x57c372}=_0x2d0dc0[_0x3d814f(0x1c4)]['KEYBOARD_SWITCH'];this['logger']['log']('Switching\x20keyboard\x20mode\x20on\x20device\x20'+_0x189189+'\x20at\x20coordinates\x20('+_0x251701+',\x20'+_0x57c372+')'),await this['click'](_0x189189,_0x251701,_0x57c372,0.2),await(0x0,_0x2c7818[_0x3d814f(0x26c)])(0x1f4),this['logger']['log']('Keyboard\x20mode\x20switched\x20successfully\x20on\x20device\x20'+_0x189189);}async[_0x1f9129(0x36f)](_0x1ad191){const _0x188e71=_0x1f9129,{x:_0x5b6b31,y:_0x4a3d5d}=_0x2d0dc0['COMMON_COORDINATES']['SHIFT_KEY'];this[_0x188e71(0x1fd)]['debug']('Pressing\x20shift\x20key\x20on\x20device\x20'+_0x1ad191+'\x20at\x20coordinates\x20('+_0x5b6b31+',\x20'+_0x4a3d5d+')'),await this['click'](_0x1ad191,_0x5b6b31,_0x4a3d5d,0.2),await(0x0,_0x2c7818[_0x188e71(0x26c)])(0xc8),this['logger']['debug']('Shift\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0x1ad191);}async['pressReturnKey'](_0xb6b121){const _0x98c3dd=_0x1f9129,{x:_0x50e941,y:_0x243ae4}=_0x2d0dc0['COMMON_COORDINATES']['RETURN_KEY'];this['logger']['log']('Pressing\x20return\x20key\x20on\x20device\x20'+_0xb6b121+'\x20at\x20coordinates\x20('+_0x50e941+',\x20'+_0x243ae4+')'),await this['click'](_0xb6b121,_0x50e941,_0x243ae4,0.2),await(0x0,_0x2c7818['sleep'])(0x1f4),this['logger'][_0x98c3dd(0x2d5)]('Return\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0xb6b121);}async[_0x1f9129(0x12c)](_0x27d09b,_0x116d98){const _0x4f93e5=_0x1f9129;if(!_0x116d98||0x0===_0x116d98['length'])throw new Error('Password\x20cannot\x20be\x20empty');let _0xc74f4b='letter';for(let _0x2fd170=0x0;_0x2fd170<_0x116d98['length'];_0x2fd170++){const _0x39ae35=_0x116d98[_0x2fd170],_0x5b1cd7=_0x39ae35['toLowerCase'](),_0x36bef4=_0x39ae35!==_0x5b1cd7&&this['isLetter'](_0x39ae35),_0x5c4f64=this[_0x4f93e5(0x211)](_0x39ae35)?_0x39ae35:_0x5b1cd7,_0x16d97b=_0x2d0dc0[_0x4f93e5(0x26e)][_0x5c4f64];if(!_0x16d97b){this['logger']['warn']('Character\x20\x27'+_0x39ae35+'\x27\x20not\x20found\x20in\x20keyboard\x20layout.\x20Skipping...');continue;}let _0x2a3fd0=null;this['isNumber'](_0x5b1cd7)?_0x2a3fd0='number':this[_0x4f93e5(0x1a7)](_0x5b1cd7)?_0x2a3fd0='letter':this[_0x4f93e5(0x211)](_0x39ae35)&&(_0x2a3fd0=_0x4f93e5(0x370)),_0x2a3fd0&&_0xc74f4b!==_0x2a3fd0&&(this[_0x4f93e5(0x1fd)]['debug']('Switching\x20keyboard\x20to\x20'+_0x2a3fd0+'\x20mode\x20for\x20character\x20\x27'+_0x39ae35+'\x27'),await this['switchKeyboardMode'](_0x27d09b),_0xc74f4b=_0x2a3fd0),_0x36bef4&&'letter'===_0xc74f4b&&(this[_0x4f93e5(0x1fd)]['debug'](_0x4f93e5(0x1d8)+_0x39ae35+'\x27'),await this['pressShiftKey'](_0x27d09b)),this['logger']['debug']('Clicking\x20key\x20\x27'+_0x5c4f64+'\x27'+(_0x36bef4?_0x4f93e5(0x145):'')+'\x20at\x20('+_0x16d97b['x']+',\x20'+_0x16d97b['y']+')'),await this['click'](_0x27d09b,_0x16d97b['x'],_0x16d97b['y'],0.15),await(0x0,_0x2c7818['sleep'])(0xc8);}this['logger']['log'](_0x4f93e5(0x2ff)+_0x27d09b);}async[_0x1f9129(0x355)](_0x249d24,_0x2e7b4e){const _0x4ad920=_0x1f9129;if(!_0x2e7b4e||0x0===_0x2e7b4e['length'])throw new Error('value\x20cannot\x20be\x20empty');for(let _0xbce59f=0x0;_0xbce59f<_0x2e7b4e['length'];_0xbce59f++){const _0x2db9be=_0x2e7b4e[_0xbce59f],_0x2c6d33=_0x2d0dc0[_0x4ad920(0x1bb)][_0x2db9be];await this[_0x4ad920(0x287)](_0x249d24,_0x2c6d33['x'],_0x2c6d33['y'],0.15),this['logger']['debug'](_0x4ad920(0xdc)+_0x2db9be+'\x27\x20at\x20('+_0x2c6d33['x']+',\x20'+_0x2c6d33['y']+')'),await(0x0,_0x2c7818['sleep'])(0xc8);}}async[_0x1f9129(0x1ae)](_0x4ba395,_0x19fafa,_0xfd287a=0x1){const _0x4a48bd=_0x1f9129;return Promise[_0x4a48bd(0x17b)](null);}[_0x1f9129(0x166)](){return this['isConnected'];}};_0x4e50dd[_0x1f9129(0x32c)]=_0x1a9b38,_0x4e50dd[_0x1f9129(0x32c)]=_0x1a9b38=_0x2807ff([(0x0,_0x5b5cfe['Injectable'])(),_0x1a7dc0('design:paramtypes',[])],_0x1a9b38);},_0x501515=>{_0x501515['exports']=require('ws');},function(_0x1bdfd8,_0x7360fe,_0xc0c4a1){const _0x693328=a0_0x2e92;var _0x2b27eb,_0x2b93c9=this&&this[_0x693328(0x21f)]||function(_0x54d6e9,_0x1e8bf3,_0x50c29e,_0x46dea7){const _0x594a5d=_0x693328;var _0xeae727,_0xdd9220=arguments['length'],_0x18ef10=_0xdd9220<0x3?_0x1e8bf3:null===_0x46dea7?_0x46dea7=Object['getOwnPropertyDescriptor'](_0x1e8bf3,_0x50c29e):_0x46dea7;if('object'==typeof Reflect&&_0x594a5d(0x18d)==typeof Reflect[_0x594a5d(0x3b0)])_0x18ef10=Reflect['decorate'](_0x54d6e9,_0x1e8bf3,_0x50c29e,_0x46dea7);else{for(var _0x439a6e=_0x54d6e9[_0x594a5d(0x1fe)]-0x1;_0x439a6e>=0x0;_0x439a6e--)(_0xeae727=_0x54d6e9[_0x439a6e])&&(_0x18ef10=(_0xdd9220<0x3?_0xeae727(_0x18ef10):_0xdd9220>0x3?_0xeae727(_0x1e8bf3,_0x50c29e,_0x18ef10):_0xeae727(_0x1e8bf3,_0x50c29e))||_0x18ef10);}return _0xdd9220>0x3&&_0x18ef10&&Object[_0x594a5d(0x3cc)](_0x1e8bf3,_0x50c29e,_0x18ef10),_0x18ef10;},_0x12686d=this&&this['__metadata']||function(_0x3c00d3,_0x2c917e){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x3c00d3,_0x2c917e);};Object['defineProperty'](_0x7360fe,'__esModule',{'value':!0x0}),_0x7360fe['PandaWebSocketService']=void 0x0;const _0x19a04c=_0xc0c4a1(0x2),_0x472a32=_0xc0c4a1(0x50),_0x51ebb7=_0xc0c4a1(0x16),_0x430403=_0xc0c4a1(0x18),_0x31db7f=_0xc0c4a1(0x26),_0x416c6a=_0xc0c4a1(0x2c);let _0x10ea54=class{constructor(_0xfe6ecd){const _0xff1a43=_0x693328;this['telegramService']=_0xfe6ecd,this[_0xff1a43(0x1fd)]=new _0x19a04c[(_0xff1a43(0x225))]('PandaWebSocketService'),this['ws']=null,this['reconnectAttempts']=0x0,this['maxReconnectAttempts']=0xa,this['reconnectDelay']=0x1388,this['requestQueue']=[],this[_0xff1a43(0x308)]=new Map(),this['isConnected']=!0x1,this[_0xff1a43(0x3a1)]=!0x1,this['wsUrl']=_0xff1a43(0xe6);}async[_0x693328(0x1d3)](){await this['connect']();}async['onModuleDestroy'](){await this['disconnect']();}async['connect'](){return new Promise((_0x274e27,_0x2ef00a)=>{const _0x134817=a0_0x2e92;try{this['logger']['log'](_0x134817(0x37a)+this['wsUrl']),this['ws']=new _0x472a32(this['wsUrl']),this['ws']['on']('open',()=>{const _0xaecb7f=_0x134817;this[_0xaecb7f(0x1fd)]['log']('Panda\x20BOX\x20WebSocket\x20connected'),this[_0xaecb7f(0x33c)]=!0x0,this['reconnectAttempts']=0x0,this['processRequestQueue'](),_0x274e27();}),this['ws']['on']('message',_0x17931c=>{const _0x3f9034=_0x134817;try{const _0x4b4418=_0x17931c['toString'](),_0x2aea18=JSON[_0x3f9034(0x14d)](_0x4b4418);this[_0x3f9034(0x2bc)](_0x2aea18);}catch(_0x54dd31){this[_0x3f9034(0x1fd)][_0x3f9034(0xeb)](_0x3f9034(0x292)+_0x54dd31['message'],_0x54dd31['stack']),this['logger']['error']('Raw\x20message\x20was:\x20'+_0x17931c['toString']());}}),this['ws']['on']('error',_0x2588d4=>{const _0x52458c=_0x134817;this['logger'][_0x52458c(0xeb)](_0x52458c(0x39f)+_0x2588d4['message']),this['isConnected']=!0x1,0x0===this['reconnectAttempts']&&_0x2ef00a(_0x2588d4);}),this['ws']['on'](_0x134817(0x31a),()=>{const _0x176e68=_0x134817;this['logger'][_0x176e68(0x1eb)]('Panda\x20BOX\x20WebSocket\x20closed'),this['isConnected']=!0x1,this[_0x176e68(0x33e)]();});}catch(_0x49df05){this['logger']['error'](_0x134817(0x1ab)+_0x49df05['message']),_0x2ef00a(_0x49df05);}});}[_0x693328(0x33e)](){const _0x13be08=_0x693328;if(this['reconnectAttempts']>=this['maxReconnectAttempts'])return this['logger']['error']('Max\x20reconnection\x20attempts\x20reached'),void this['telegramService']['sendMessage']({'text':_0x13be08(0x3db)+this[_0x13be08(0x35e)]+_0x13be08(0x23a)+this['reconnectAttempts']+_0x13be08(0x237)+this['reconnectDelay']+'ms','options':{'parseMode':_0x13be08(0x29a)}});this['reconnectAttempts']++;const _0x52e9e2=this['reconnectDelay']*this['reconnectAttempts'];this[_0x13be08(0x1fd)]['log']('Scheduling\x20reconnect\x20attempt\x20'+this['reconnectAttempts']+'\x20in\x20'+_0x52e9e2+'ms'),setTimeout(()=>{this['connect']()['catch'](_0x29b58c=>{const _0x6cc44f=a0_0x2e92;this['logger']['error'](_0x6cc44f(0x3f0)+_0x29b58c['message']);});},_0x52e9e2);}async['disconnect'](){const _0x3f8abf=_0x693328;this['ws']&&(this['ws'][_0x3f8abf(0x31a)](),this['ws']=null,this['isConnected']=!0x1);}['handleMessage'](_0x55bf17){const _0x404432=_0x693328;if(this['pendingRequests']['size']>0x0){const [_0x3d55fe,_0x213aa5]=this['pendingRequests']['entries']()['next']()[_0x404432(0x35c)];if(this[_0x404432(0x308)]['delete'](_0x3d55fe),0x2710===_0x55bf17[_0x404432(0x17e)])_0x213aa5[_0x404432(0x17b)](_0x55bf17['data']);else{const _0x35ccd2=_0x55bf17['message']||'Panda\x20BOX\x20error:\x20'+_0x55bf17['code'];_0x213aa5['reject'](new Error(_0x35ccd2));}}else{if(Array['isArray'](_0x55bf17['data'])&&_0x55bf17['data'][_0x404432(0x1fe)]>0x0&&void 0x0!==_0x55bf17['data'][0x0]?.['serial']&&0x2710===_0x55bf17['code']){const _0x1ad828=_0x55bf17[_0x404432(0x339)];this[_0x404432(0x1fd)]['debug']('Received\x20unsolicited\x20device\x20list\x20update\x20(no\x20pending\x20requests):\x20'+_0x1ad828['length']+'\x20device(s)');}else this['logger']['warn'](_0x404432(0x2fb)+JSON['stringify'](_0x55bf17));}}async['processRequestQueue'](){const _0x3aaea4=_0x693328;if(this['isProcessingRequest']||0x0===this['requestQueue']['length'])return;if(!this[_0x3aaea4(0x33c)]||!this['ws'])return;this['isProcessingRequest']=!0x0;const {request:_0x27ebfd,resolve:_0x1a31ac,reject:_0x56cc3f,timeout:_0x5f4ff0}=this['requestQueue']['shift']();try{_0x1a31ac(await this['_sendRequestOnce'](_0x27ebfd,_0x5f4ff0));}catch(_0x4aaf82){_0x56cc3f(_0x4aaf82);}finally{this[_0x3aaea4(0x3a1)]=!0x1,this[_0x3aaea4(0x3a7)]['length']>0x0&&setImmediate(()=>this[_0x3aaea4(0x34d)]());}}async[_0x693328(0x191)](_0x2f71b6,_0x15b0d9=0x7530){return new Promise((_0x12111b,_0x5b979a)=>{const _0x1df43f=a0_0x2e92,_0x26625f=Date['now']()['toString']()+Math['random']()['toString'](0x24)['substr'](0x2,0x9);this['pendingRequests']['set'](_0x26625f,{'resolve':_0x12111b,'reject':_0x5b979a});const _0x5002c0=setTimeout(()=>{const _0x42a53e=a0_0x2e92;this[_0x42a53e(0x308)][_0x42a53e(0xe7)](_0x26625f),_0x5b979a(new Error('WebSocket\x20request\x20timeout'));},_0x15b0d9),_0x4e6692=_0x12111b,_0x581a95=_0x5b979a;_0x12111b=_0x50ec67=>{clearTimeout(_0x5002c0),_0x4e6692(_0x50ec67);},_0x5b979a=_0x477770=>{clearTimeout(_0x5002c0),_0x581a95(_0x477770);},this[_0x1df43f(0x308)]['set'](_0x26625f,{'resolve':_0x12111b,'reject':_0x5b979a});try{const _0x48cd3a=JSON['stringify'](_0x2f71b6);this['ws']['send'](_0x48cd3a);}catch(_0x463f6f){this['logger']['error'](_0x1df43f(0x320)+_0x463f6f['message'],_0x463f6f[_0x1df43f(0x3d6)]),this['pendingRequests'][_0x1df43f(0xe7)](_0x26625f),clearTimeout(_0x5002c0),_0x5b979a(_0x463f6f);}});}async[_0x693328(0x1c9)](_0xcd7c72,_0x558a45=0x7530){return new Promise((_0x86d2ad,_0x280032)=>{this['requestQueue']['push']({'request':_0xcd7c72,'resolve':_0x86d2ad,'reject':_0x280032,'timeout':_0x558a45}),this['processRequestQueue']();});}async['listDevices'](){const _0x52ac3d=_0x693328,_0xaaa28c=(await this['sendRequest']({'action':'list'}))['map'](_0x37cd92=>({..._0x37cd92,'udid':_0x37cd92[_0x52ac3d(0x36c)]}));return _0xaaa28c[_0x52ac3d(0x1fe)]<=0x0&&this['logger'][_0x52ac3d(0xeb)]('No\x20devices\x20found!'),_0xaaa28c;}async[_0x693328(0x287)](_0x375762,_0x48b541,_0x1544be,_0x2f6bfc=0.2){const _0x2095fb=_0x693328;return this['sendRequest']({'action':_0x2095fb(0x2d1),'devices':Array[_0x2095fb(0x1e3)](_0x375762)?_0x375762['join'](','):_0x375762,'data':{'type':'10','x':(0x0,_0x51ebb7[_0x2095fb(0x38a)])(_0x48b541),'y':(0x0,_0x51ebb7['toString'])(_0x1544be)}});}async['swipe'](_0x5a5404,_0x463bd6){const _0x2b80eb=_0x693328,_0x1b12ab=Array['isArray'](_0x5a5404)?_0x5a5404[_0x2b80eb(0x3ed)](','):_0x5a5404;return this[_0x2b80eb(0x1c9)]({'action':_0x2b80eb(0x2d1),'devices':_0x1b12ab,'data':_0x463bd6});}async['captureScreen'](_0x430a70,_0x184c36){const _0x18f034=_0x693328;return this['sendRequest']({'action':_0x18f034(0x2f1),'devices':_0x430a70,'data':{'savePath':_0x184c36['folderPath']}});}async['home'](_0x2785ed){const _0x5d2d0b=_0x693328;return this['sendRequest']({'action':_0x5d2d0b(0x2a4),'devices':_0x2785ed,'data':{'type':'2'}});}async['launchApp'](_0x55e016,_0x3d7f9a){const _0x4f6754=_0x693328,_0x2cf8d3=Array[_0x4f6754(0x1e3)](_0x55e016)?_0x55e016['join'](','):_0x55e016;return this['sendRequest']({'action':_0x4f6754(0x15b),'devices':_0x2cf8d3,'data':{'app':_0x3d7f9a}});}async['killApp'](_0xc1cabd,_0x18356a){const _0x5f168f=_0x693328,_0xc0a2f2=Array['isArray'](_0xc1cabd)?_0xc1cabd[_0x5f168f(0x3ed)](','):_0xc1cabd;return this['sendRequest']({'action':'stopApp','devices':_0xc0a2f2,'data':{'app':_0x18356a}});}async['switchKeyboardMode'](_0x4ea005){const _0x1f90fa=_0x693328,{x:_0x611a69,y:_0x137473}=_0x31db7f['COMMON_COORDINATES']['KEYBOARD_SWITCH'];this[_0x1f90fa(0x1fd)]['log']('Switching\x20keyboard\x20mode\x20on\x20device\x20'+_0x4ea005+'\x20at\x20coordinates\x20('+_0x611a69+',\x20'+_0x137473+')'),await this['click'](_0x4ea005,_0x611a69,_0x137473,0.2),await(0x0,_0x430403['sleep'])(0x1f4),this['logger']['log']('Keyboard\x20mode\x20switched\x20successfully\x20on\x20device\x20'+_0x4ea005);}async['pressShiftKey'](_0x4cef56){const _0x52ec7b=_0x693328,{x:_0x30ae75,y:_0x451a38}=_0x31db7f['COMMON_COORDINATES']['SHIFT_KEY'];this['logger'][_0x52ec7b(0x266)]('Pressing\x20shift\x20key\x20on\x20device\x20'+_0x4cef56+'\x20at\x20coordinates\x20('+_0x30ae75+',\x20'+_0x451a38+')'),await this[_0x52ec7b(0x287)](_0x4cef56,_0x30ae75,_0x451a38,0.2),await(0x0,_0x430403['sleep'])(0xc8),this['logger']['debug']('Shift\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0x4cef56);}async['pressReturnKey'](_0x2ff468){const {x:_0x22722a,y:_0x5c6aa3}=_0x31db7f['COMMON_COORDINATES']['RETURN_KEY'];await this['click'](_0x2ff468,_0x22722a,_0x5c6aa3,0.2),await(0x0,_0x430403['sleep'])(0x1f4);}async[_0x693328(0x12c)](_0x2f9c18,_0x36caef){const _0x24e141=_0x693328,_0x73e7c3=Array['isArray'](_0x2f9c18)?_0x2f9c18[_0x24e141(0x3ed)](','):_0x2f9c18;return this[_0x24e141(0x1c9)]({'action':'inputText','devices':_0x73e7c3,'data':{'content':_0x36caef}});}async[_0x693328(0x355)](_0x392d56,_0x3ea2aa){const _0x37cd42=_0x693328;if(!_0x3ea2aa||0x0===_0x3ea2aa['length'])throw new Error('value\x20cannot\x20be\x20empty');for(let _0x588d45=0x0;_0x588d45<_0x3ea2aa[_0x37cd42(0x1fe)];_0x588d45++){const _0x434ee1=_0x3ea2aa[_0x588d45],_0x4d6ad2=_0x31db7f['NUMPAD_LAYOUT'][_0x434ee1];await this['click'](_0x392d56,_0x4d6ad2['x'],_0x4d6ad2['y']),this['logger']['debug'](_0x37cd42(0xdc)+_0x434ee1+_0x37cd42(0x399)+_0x4d6ad2['x']+',\x20'+_0x4d6ad2['y']+')'),await(0x0,_0x430403['sleep'])(0xc8);}}async['transferFile'](_0x2b305c,_0x38356c,_0x333fdb=0x1){const _0x4cd60e=_0x693328,_0x2977d2=Array['isArray'](_0x2b305c)?_0x2b305c['join'](','):_0x2b305c;return this['logger']['log']('Transferring\x20file\x20'+_0x38356c+'\x20to\x20device(s)\x20'+_0x2977d2+'\x20with\x20fileType\x20'+_0x333fdb),this[_0x4cd60e(0x1c9)]({'action':'uploadFile','devices':_0x2977d2,'data':{'filePath':_0x38356c,'fileType':_0x333fdb}});}['isConnectedStatus'](){const _0x3ff6ce=_0x693328;return this[_0x3ff6ce(0x33c)];}};_0x7360fe['PandaWebSocketService']=_0x10ea54,_0x7360fe['PandaWebSocketService']=_0x10ea54=_0x2b93c9([(0x0,_0x19a04c['Injectable'])(),_0x12686d('design:paramtypes',['function'==typeof(_0x2b27eb=void 0x0!==_0x416c6a['TelegramService']&&_0x416c6a['TelegramService'])?_0x2b27eb:Object])],_0x10ea54);},function(_0x263b03,_0x5ac912,_0x2033af){const _0x1b6c46=a0_0x2e92;var _0x341a4a,_0x221e3c,_0x3addad,_0x1ab5e0,_0x5ae4dd=this&&this[_0x1b6c46(0x21f)]||function(_0x2167e5,_0x206362,_0x4873ce,_0x57c783){const _0x29bf7e=_0x1b6c46;var _0x32e299,_0x3d48d5=arguments[_0x29bf7e(0x1fe)],_0x565df0=_0x3d48d5<0x3?_0x206362:null===_0x57c783?_0x57c783=Object[_0x29bf7e(0x25c)](_0x206362,_0x4873ce):_0x57c783;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x565df0=Reflect['decorate'](_0x2167e5,_0x206362,_0x4873ce,_0x57c783);else{for(var _0x29983a=_0x2167e5[_0x29bf7e(0x1fe)]-0x1;_0x29983a>=0x0;_0x29983a--)(_0x32e299=_0x2167e5[_0x29983a])&&(_0x565df0=(_0x3d48d5<0x3?_0x32e299(_0x565df0):_0x3d48d5>0x3?_0x32e299(_0x206362,_0x4873ce,_0x565df0):_0x32e299(_0x206362,_0x4873ce))||_0x565df0);}return _0x3d48d5>0x3&&_0x565df0&&Object['defineProperty'](_0x206362,_0x4873ce,_0x565df0),_0x565df0;},_0x569a98=this&&this['__metadata']||function(_0x52c565,_0x4ac03a){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x52c565,_0x4ac03a);};Object['defineProperty'](_0x5ac912,'__esModule',{'value':!0x0}),_0x5ac912['SessionRefreshScheduler']=void 0x0;const _0x48c1c3=_0x2033af(0x2),_0x295025=_0x2033af(0x7),_0x2cd1ec=_0x2033af(0xb),_0x22e2b1=_0x2033af(0xe),_0x363a28=_0x2033af(0x34),_0x33f56a=_0x2033af(0x41),_0x9aba9b=_0x2033af(0x42);let _0x2d9491=class{constructor(_0x41df8c,_0x4b9c76,_0x18401c,_0x50a94b){const _0x2113d5=_0x1b6c46;this[_0x2113d5(0x2c1)]=_0x41df8c,this['deviceService']=_0x4b9c76,this['sessionManagement']=_0x18401c,this['redisLockService']=_0x50a94b,this[_0x2113d5(0x1fd)]=new _0x48c1c3['Logger']('SessionRefreshScheduler');}async['refreshSessions'](){const _0x284400=_0x1b6c46;try{if(await this['redisLockService'][_0x284400(0x329)](_0x9aba9b['SYSTEM_LOCK_BOXPHONE']))return;if(_0x284400(0x254)!==await this[_0x284400(0x25e)]['getServiceStatus']())return;const _0x413c5a=(await this['deviceService'][_0x284400(0x367)]())[_0x284400(0x3b3)](_0x321c53=>'active'===_0x321c53['status']&&_0x321c53['bankCode']);for(const _0x3cd57b of _0x413c5a){const _0x471782=_0x3cd57b['bankCode']['toUpperCase']();try{await this['bankService']['refreshSessionIfNeeded'](_0x3cd57b['udid'],_0x471782);}catch(_0x3e0dbb){this['logger']['error']('Error\x20refreshing\x20session\x20for\x20device\x20'+_0x3cd57b['udid']+',\x20bank\x20'+_0x471782+':\x20'+_0x3e0dbb['message']);}}}catch(_0x50a2f7){this['logger'][_0x284400(0xeb)]('Error\x20in\x20session\x20refresh\x20scheduler:\x20'+_0x50a2f7[_0x284400(0x2a0)]);}}};_0x5ac912['SessionRefreshScheduler']=_0x2d9491,_0x5ae4dd([(0x0,_0x295025['Cron'])(_0x295025['CronExpression']['EVERY_30_SECONDS']),_0x569a98('design:type',Function),_0x569a98(_0x1b6c46(0x22c),[]),_0x569a98('design:returntype',Promise)],_0x2d9491['prototype'],'refreshSessions',null),_0x5ac912[_0x1b6c46(0x1a0)]=_0x2d9491=_0x5ae4dd([(0x0,_0x48c1c3['Injectable'])(),_0x569a98('design:paramtypes',['function'==typeof(_0x341a4a=void 0x0!==_0x2cd1ec[_0x1b6c46(0x261)]&&_0x2cd1ec[_0x1b6c46(0x261)])?_0x341a4a:Object,'function'==typeof(_0x221e3c=void 0x0!==_0x22e2b1[_0x1b6c46(0x204)]&&_0x22e2b1[_0x1b6c46(0x204)])?_0x221e3c:Object,_0x1b6c46(0x18d)==typeof(_0x3addad=void 0x0!==_0x363a28[_0x1b6c46(0x371)]&&_0x363a28['SessionManagementService'])?_0x3addad:Object,'function'==typeof(_0x1ab5e0=void 0x0!==_0x33f56a['RedisLockService']&&_0x33f56a['RedisLockService'])?_0x1ab5e0:Object])],_0x2d9491);},function(_0x2f8b4d,_0x6fb6c5,_0x42631e){const _0x40780b=a0_0x2e92;var _0x299b7b=this&&this['__decorate']||function(_0x12307e,_0x35b01e,_0x2c22c9,_0x2d7a74){const _0x14011a=a0_0x2e92;var _0x209665,_0x46e4cd=arguments['length'],_0x3b3717=_0x46e4cd<0x3?_0x35b01e:null===_0x2d7a74?_0x2d7a74=Object['getOwnPropertyDescriptor'](_0x35b01e,_0x2c22c9):_0x2d7a74;if('object'==typeof Reflect&&_0x14011a(0x18d)==typeof Reflect['decorate'])_0x3b3717=Reflect['decorate'](_0x12307e,_0x35b01e,_0x2c22c9,_0x2d7a74);else{for(var _0x5a34e4=_0x12307e['length']-0x1;_0x5a34e4>=0x0;_0x5a34e4--)(_0x209665=_0x12307e[_0x5a34e4])&&(_0x3b3717=(_0x46e4cd<0x3?_0x209665(_0x3b3717):_0x46e4cd>0x3?_0x209665(_0x35b01e,_0x2c22c9,_0x3b3717):_0x209665(_0x35b01e,_0x2c22c9))||_0x3b3717);}return _0x46e4cd>0x3&&_0x3b3717&&Object['defineProperty'](_0x35b01e,_0x2c22c9,_0x3b3717),_0x3b3717;};Object['defineProperty'](_0x6fb6c5,'__esModule',{'value':!0x0}),_0x6fb6c5['OCRModule']=void 0x0;const _0x517158=_0x42631e(0x2),_0x1af63b=_0x42631e(0x1c),_0x212a06=_0x42631e(0x1e),_0x39d9a4=_0x42631e(0x1b);let _0x2600ac=class{};_0x6fb6c5['OCRModule']=_0x2600ac,_0x6fb6c5[_0x40780b(0x3c3)]=_0x2600ac=_0x299b7b([(0x0,_0x517158['Module'])({'providers':[_0x1af63b['OCRWorkerPoolService'],_0x212a06['ImagePreprocessingService'],_0x39d9a4[_0x40780b(0x3dc)]],'exports':[_0x39d9a4['OCRService'],_0x1af63b['OCRWorkerPoolService'],_0x212a06[_0x40780b(0x1d5)]]})],_0x2600ac);},function(_0x3b6582,_0x2f4e90,_0x4101da){const _0x5bfe07=a0_0x2e92;var _0x30c920=this&&this[_0x5bfe07(0x21f)]||function(_0xf30b0a,_0x561ec0,_0x22fee5,_0x2384f3){const _0x23d407=_0x5bfe07;var _0x9ce975,_0x246ef4=arguments['length'],_0x47ef78=_0x246ef4<0x3?_0x561ec0:null===_0x2384f3?_0x2384f3=Object[_0x23d407(0x25c)](_0x561ec0,_0x22fee5):_0x2384f3;if('object'==typeof Reflect&&_0x23d407(0x18d)==typeof Reflect['decorate'])_0x47ef78=Reflect['decorate'](_0xf30b0a,_0x561ec0,_0x22fee5,_0x2384f3);else{for(var _0x49c0db=_0xf30b0a['length']-0x1;_0x49c0db>=0x0;_0x49c0db--)(_0x9ce975=_0xf30b0a[_0x49c0db])&&(_0x47ef78=(_0x246ef4<0x3?_0x9ce975(_0x47ef78):_0x246ef4>0x3?_0x9ce975(_0x561ec0,_0x22fee5,_0x47ef78):_0x9ce975(_0x561ec0,_0x22fee5))||_0x47ef78);}return _0x246ef4>0x3&&_0x47ef78&&Object['defineProperty'](_0x561ec0,_0x22fee5,_0x47ef78),_0x47ef78;};Object[_0x5bfe07(0x3cc)](_0x2f4e90,'__esModule',{'value':!0x0}),_0x2f4e90[_0x5bfe07(0x289)]=void 0x0;const _0x3f20ba=_0x4101da(0x2),_0x22bd30=_0x4101da(0x35),_0x31b93f=_0x4101da(0x36),_0x2c99a3=_0x4101da(0x8),_0x3bc786=_0x4101da(0x2c);let _0x34f478=class{};_0x2f4e90[_0x5bfe07(0x289)]=_0x34f478,_0x2f4e90['NotificationModule']=_0x34f478=_0x30c920([(0x0,_0x3f20ba['Global'])(),(0x0,_0x3f20ba[_0x5bfe07(0x305)])({'imports':[_0x2c99a3[_0x5bfe07(0x200)]],'providers':[_0x22bd30['NotificationService'],_0x31b93f['EzpayBeClientService'],_0x3bc786['TelegramService']],'exports':[_0x22bd30['NotificationService'],_0x3bc786[_0x5bfe07(0x321)]]})],_0x34f478);},function(_0x5e2fad,_0x44ea15,_0x1773f2){const _0x36b7a0=a0_0x2e92;var _0x5805d6=this&&this[_0x36b7a0(0x21f)]||function(_0x510dde,_0xae9142,_0x27d0dd,_0x41ed2c){const _0xf2e154=_0x36b7a0;var _0x3e0241,_0x505055=arguments['length'],_0x3172ef=_0x505055<0x3?_0xae9142:null===_0x41ed2c?_0x41ed2c=Object['getOwnPropertyDescriptor'](_0xae9142,_0x27d0dd):_0x41ed2c;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x3172ef=Reflect['decorate'](_0x510dde,_0xae9142,_0x27d0dd,_0x41ed2c);else{for(var _0x354485=_0x510dde[_0xf2e154(0x1fe)]-0x1;_0x354485>=0x0;_0x354485--)(_0x3e0241=_0x510dde[_0x354485])&&(_0x3172ef=(_0x505055<0x3?_0x3e0241(_0x3172ef):_0x505055>0x3?_0x3e0241(_0xae9142,_0x27d0dd,_0x3172ef):_0x3e0241(_0xae9142,_0x27d0dd))||_0x3172ef);}return _0x505055>0x3&&_0x3172ef&&Object[_0xf2e154(0x3cc)](_0xae9142,_0x27d0dd,_0x3172ef),_0x3172ef;};Object[_0x36b7a0(0x3cc)](_0x44ea15,_0x36b7a0(0x110),{'value':!0x0}),_0x44ea15['WindowAppModule']=void 0x0;const _0x5cb368=_0x1773f2(0x2),_0xdafba3=_0x1773f2(0x3e);let _0x4fc945=class{};_0x44ea15[_0x36b7a0(0x368)]=_0x4fc945,_0x44ea15[_0x36b7a0(0x368)]=_0x4fc945=_0x5805d6([(0x0,_0x5cb368[_0x36b7a0(0x305)])({'providers':[_0xdafba3[_0x36b7a0(0x218)]],'exports':[_0xdafba3[_0x36b7a0(0x218)]]})],_0x4fc945);},function(_0x23e416,_0x136185,_0x4b189e){const _0x3ec8a4=a0_0x2e92;var _0x4baafe=this&&this['__decorate']||function(_0xcd852a,_0x1003b5,_0x1baa33,_0x5e7653){const _0x51541d=a0_0x2e92;var _0x4c845c,_0x3afb81=arguments['length'],_0x122692=_0x3afb81<0x3?_0x1003b5:null===_0x5e7653?_0x5e7653=Object['getOwnPropertyDescriptor'](_0x1003b5,_0x1baa33):_0x5e7653;if('object'==typeof Reflect&&_0x51541d(0x18d)==typeof Reflect['decorate'])_0x122692=Reflect[_0x51541d(0x3b0)](_0xcd852a,_0x1003b5,_0x1baa33,_0x5e7653);else{for(var _0x37834d=_0xcd852a['length']-0x1;_0x37834d>=0x0;_0x37834d--)(_0x4c845c=_0xcd852a[_0x37834d])&&(_0x122692=(_0x3afb81<0x3?_0x4c845c(_0x122692):_0x3afb81>0x3?_0x4c845c(_0x1003b5,_0x1baa33,_0x122692):_0x4c845c(_0x1003b5,_0x1baa33))||_0x122692);}return _0x3afb81>0x3&&_0x122692&&Object['defineProperty'](_0x1003b5,_0x1baa33,_0x122692),_0x122692;};Object['defineProperty'](_0x136185,_0x3ec8a4(0x110),{'value':!0x0}),_0x136185['RedisLockModule']=void 0x0;const _0x202e9d=_0x4b189e(0x2),_0x2ec11c=_0x4b189e(0xf),_0x2a89fe=_0x4b189e(0x41);let _0x47dfdd=class{};_0x136185[_0x3ec8a4(0x3c0)]=_0x47dfdd,_0x136185['RedisLockModule']=_0x47dfdd=_0x4baafe([(0x0,_0x202e9d['Global'])(),(0x0,_0x202e9d[_0x3ec8a4(0x305)])({'providers':[_0x2ec11c['RedisService'],_0x2a89fe['RedisLockService']],'exports':[_0x2a89fe['RedisLockService']]})],_0x47dfdd);}],_0x585066={};function _0x584381(_0x2ce822){const _0x39ccc2=a0_0x2e92;var _0x4c747a=_0x585066[_0x2ce822];if(void 0x0!==_0x4c747a)return _0x4c747a['exports'];var _0x48e3e5=_0x585066[_0x2ce822]={'exports':{}};return _0x540eef[_0x2ce822]['call'](_0x48e3e5['exports'],_0x48e3e5,_0x48e3e5['exports'],_0x584381),_0x48e3e5[_0x39ccc2(0x29f)];}var _0x56664a={};((()=>{var _0x7e8b93=_0x56664a;Object['defineProperty'](_0x7e8b93,'__esModule',{'value':!0x0});const _0x37d926=_0x584381(0x1),_0x243c34=_0x584381(0x2),_0x2128ab=_0x584381(0x3),_0xb8d45a=_0x584381(0x4),_0x1a3177=_0x584381(0x5),_0x121a97=_0x584381(0x11);!(async function(){const _0x12c8b7=a0_0x2e92,_0xe0b77e=await _0x37d926[_0x12c8b7(0x197)]['create'](_0x1a3177['AppModule'],{}),_0xab85a=new _0x243c34[(_0x12c8b7(0x225))]('Bootstrap'),_0x424a5f=_0x12c8b7(0x375)===process[_0x12c8b7(0x393)]['NODE_ENV']?(0x0,_0xb8d45a['join'])(__dirname,_0x12c8b7(0x23f)):(0x0,_0xb8d45a['join'])(process[_0x12c8b7(0x25a)](),'src',_0x12c8b7(0x23f));_0xe0b77e['setBaseViewsDir'](_0x424a5f),_0xe0b77e['setViewEngine'](_0x12c8b7(0x2b8)),_0xab85a[_0x12c8b7(0x2d5)]('Views\x20directory:\x20'+_0x424a5f),_0xe0b77e['useGlobalPipes'](new _0x243c34['ValidationPipe']({'transform':!0x0,'whitelist':!0x0,'forbidNonWhitelisted':!0x0}));const _0x2c0f16=new _0x2128ab[(_0x12c8b7(0x27b))]()['setTitle']('EzPay\x20Auto\x20API')['setDescription']('Automated\x20withdrawal\x20processing\x20service\x20with\x20HC\x20BOX\x20integration')[_0x12c8b7(0x32a)](_0x12c8b7(0x33b))['addTag']('bank','Bank\x20operations')[_0x12c8b7(0x383)]('withdrawal','Withdrawal\x20processing')['addTag']('device',_0x12c8b7(0x1e4))[_0x12c8b7(0x383)](_0x12c8b7(0x3ce),'HC\x20Box\x20integration')['build'](),_0x4ae16f=_0x2128ab[_0x12c8b7(0x387)]['createDocument'](_0xe0b77e,_0x2c0f16);_0x2128ab[_0x12c8b7(0x387)]['setup']('docs',_0xe0b77e,_0x4ae16f);const _0x3f4a2d=process[_0x12c8b7(0x393)]['PORT']||0xbba;_0xab85a['log']('üìö\x20Swagger\x20documentation\x20available\x20at:\x20http://localhost:'+_0x3f4a2d+_0x12c8b7(0x16f)),await _0xe0b77e['listen'](_0x3f4a2d),_0xab85a['log']('üöÄ\x20EzPay\x20Auto\x20is\x20running\x20on:\x20http://localhost:'+_0x3f4a2d),_0xab85a[_0x12c8b7(0x2d5)](_0x12c8b7(0x2f5)+_0x121a97['config'][_0x12c8b7(0x3da)]+'\x20box'),_0xab85a['log'](_0x12c8b7(0x188)+_0x3f4a2d);}());})());})()));
//# sourceMappingURL=main.js.map
//# sourceMappingURL=main.js.map