(function(_0x3461ec,_0x26b98b){const _0x46e479=a0_0x5814,_0xe1da58=_0x3461ec();while(!![]){try{const _0x398a77=-parseInt(_0x46e479(0x35f))/0x1*(parseInt(_0x46e479(0x248))/0x2)+parseInt(_0x46e479(0x291))/0x3+-parseInt(_0x46e479(0x189))/0x4*(parseInt(_0x46e479(0x373))/0x5)+parseInt(_0x46e479(0x3c5))/0x6+parseInt(_0x46e479(0x1b0))/0x7+parseInt(_0x46e479(0x21b))/0x8+parseInt(_0x46e479(0x152))/0x9*(-parseInt(_0x46e479(0x28f))/0xa);if(_0x398a77===_0x26b98b)break;else _0xe1da58['push'](_0xe1da58['shift']());}catch(_0x164258){_0xe1da58['push'](_0xe1da58['shift']());}}}(a0_0x1016,0x41edd),((()=>{'use strict';var _0x38b1b5=[,_0x4ac57c=>{_0x4ac57c['exports']=require('@nestjs/core');},_0x4b6a67=>{_0x4b6a67['exports']=require('@nestjs/common');},_0x25b99c=>{_0x25b99c['exports']=require('@nestjs/swagger');},_0x23accf=>{_0x23accf['exports']=require('path');},function(_0x5c1bc1,_0x341992,_0x23d0da){const _0x22fb23=a0_0x5814;var _0x20d21a=this&&this['__decorate']||function(_0x4a1e1d,_0x2b1eca,_0x3bf2dd,_0x555eb9){const _0x4d0025=a0_0x5814;var _0x5f08ec,_0x1272ef=arguments['length'],_0x5ebf6a=_0x1272ef<0x3?_0x2b1eca:null===_0x555eb9?_0x555eb9=Object[_0x4d0025(0x313)](_0x2b1eca,_0x3bf2dd):_0x555eb9;if(_0x4d0025(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x5ebf6a=Reflect[_0x4d0025(0x1fe)](_0x4a1e1d,_0x2b1eca,_0x3bf2dd,_0x555eb9);else{for(var _0x119ddf=_0x4a1e1d['length']-0x1;_0x119ddf>=0x0;_0x119ddf--)(_0x5f08ec=_0x4a1e1d[_0x119ddf])&&(_0x5ebf6a=(_0x1272ef<0x3?_0x5f08ec(_0x5ebf6a):_0x1272ef>0x3?_0x5f08ec(_0x2b1eca,_0x3bf2dd,_0x5ebf6a):_0x5f08ec(_0x2b1eca,_0x3bf2dd))||_0x5ebf6a);}return _0x1272ef>0x3&&_0x5ebf6a&&Object['defineProperty'](_0x2b1eca,_0x3bf2dd,_0x5ebf6a),_0x5ebf6a;};Object[_0x22fb23(0x2d5)](_0x341992,'__esModule',{'value':!0x0}),_0x341992['AppModule']=void 0x0;const _0x32c179=_0x23d0da(0x2),_0x382a8f=_0x23d0da(0x6),_0x154a13=_0x23d0da(0x7),_0x52e78a=_0x23d0da(0x8),_0x1d362e=_0x23d0da(0x9),_0x26368a=_0x23d0da(0x47),_0x4f9abb=_0x23d0da(0x49),_0x18c72a=_0x23d0da(0xf),_0x5b653e=_0x23d0da(0x4e),_0x38c7f3=_0x23d0da(0x11),_0x3d5d14=_0x23d0da(0x4c),_0x531ed1=_0x23d0da(0x53),_0x4f2f46=_0x23d0da(0x54),_0x14b4d2=_0x23d0da(0x56);let _0x4f4dcf=class{};_0x341992[_0x22fb23(0x282)]=_0x4f4dcf,_0x341992[_0x22fb23(0x282)]=_0x4f4dcf=_0x20d21a([(0x0,_0x32c179['Module'])({'imports':[_0x382a8f['BullModule'][_0x22fb23(0x21e)]({'redis':{'host':_0x38c7f3['config'][_0x22fb23(0x2d6)][_0x22fb23(0x1ba)],'port':_0x38c7f3['config']['redis'][_0x22fb23(0x200)],'db':_0x38c7f3['config']['redis']['db'],'password':_0x38c7f3['config']['redis'][_0x22fb23(0x13f)]},'defaultJobOptions':{'removeOnComplete':0xa,'removeOnFail':0x32,'attempts':0x3,'backoff':{'type':'exponential','delay':0x7d0}}}),_0x154a13['ScheduleModule']['forRoot'](),_0x52e78a[_0x22fb23(0x25a)],_0x1d362e['WithdrawalModule'],_0x26368a['HcBoxModule'],_0x4f9abb[_0x22fb23(0x1ca)],_0x5b653e['WebSocketModule'],_0x3d5d14['BankModule'],_0x531ed1[_0x22fb23(0x3d9)],_0x4f2f46['NotificationModule'],_0x14b4d2['RedisLockModule']],'providers':[_0x18c72a[_0x22fb23(0x310)]],'exports':[_0x18c72a[_0x22fb23(0x310)]]})],_0x4f4dcf);},_0x552c1c=>{_0x552c1c['exports']=require('@nestjs/bull');},_0x3bfb61=>{_0x3bfb61['exports']=require('@nestjs/schedule');},_0x48a8f7=>{const _0x3923ac=a0_0x5814;_0x48a8f7[_0x3923ac(0x255)]=require('@nestjs/axios');},function(_0x4d6d88,_0x250f49,_0x16eae4){const _0x3806e5=a0_0x5814;var _0x2a8c22=this&&this['__decorate']||function(_0x217b2b,_0x2f6744,_0x201776,_0x1a882a){const _0x7ace23=a0_0x5814;var _0x2a84d5,_0xf26076=arguments['length'],_0x338ac8=_0xf26076<0x3?_0x2f6744:null===_0x1a882a?_0x1a882a=Object['getOwnPropertyDescriptor'](_0x2f6744,_0x201776):_0x1a882a;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x7ace23(0x1fe)])_0x338ac8=Reflect['decorate'](_0x217b2b,_0x2f6744,_0x201776,_0x1a882a);else{for(var _0x33f05d=_0x217b2b['length']-0x1;_0x33f05d>=0x0;_0x33f05d--)(_0x2a84d5=_0x217b2b[_0x33f05d])&&(_0x338ac8=(_0xf26076<0x3?_0x2a84d5(_0x338ac8):_0xf26076>0x3?_0x2a84d5(_0x2f6744,_0x201776,_0x338ac8):_0x2a84d5(_0x2f6744,_0x201776))||_0x338ac8);}return _0xf26076>0x3&&_0x338ac8&&Object['defineProperty'](_0x2f6744,_0x201776,_0x338ac8),_0x338ac8;};Object['defineProperty'](_0x250f49,_0x3806e5(0x363),{'value':!0x0}),_0x250f49[_0x3806e5(0x219)]=void 0x0;const _0x252227=_0x16eae4(0x2),_0x2955bf=_0x16eae4(0x6),_0x39a85d=_0x16eae4(0x7),_0xae2de2=_0x16eae4(0xa),_0x11759b=_0x16eae4(0x38),_0x4685b5=_0x16eae4(0x46),_0x55d9b4=_0x16eae4(0x36),_0x5ea639=_0x16eae4(0xf),_0x3b48ae=_0x16eae4(0x47),_0x3f1d72=_0x16eae4(0x49),_0x54e652=_0x16eae4(0x4c),_0x50cada=_0x16eae4(0x8),_0x4cb47b=_0x16eae4(0x55);let _0x43d6de=class{};_0x250f49[_0x3806e5(0x219)]=_0x43d6de,_0x250f49[_0x3806e5(0x219)]=_0x43d6de=_0x2a8c22([(0x0,_0x252227['Module'])({'imports':[_0x2955bf[_0x3806e5(0x380)]['registerQueue']({'name':'wda-request'}),_0x39a85d[_0x3806e5(0x3a6)],_0x3b48ae['HcBoxModule'],(0x0,_0x252227['forwardRef'])(()=>_0x3f1d72[_0x3806e5(0x1ca)]),_0x54e652[_0x3806e5(0x25c)],_0x50cada['HttpModule'],_0x4cb47b[_0x3806e5(0x249)]],'controllers':[_0x4685b5['WithdrawalController']],'providers':[_0xae2de2['WithdrawalService'],_0x11759b['WithdrawalJobManagerService'],_0x55d9b4[_0x3806e5(0x3af)],_0x5ea639['RedisService']],'exports':[_0xae2de2[_0x3806e5(0x151)]]})],_0x43d6de);},function(_0x5de749,_0x31e575,_0x4b160e){const _0x188463=a0_0x5814;var _0x52f851,_0x4277e4,_0x3edc35,_0x5c42d8,_0x57cffa,_0x18d39a,_0x17ffa0=this&&this['__decorate']||function(_0x385761,_0x94cbeb,_0x333cde,_0x5ae228){const _0x44a986=a0_0x5814;var _0x387d72,_0x2e9f36=arguments['length'],_0x26e9c9=_0x2e9f36<0x3?_0x94cbeb:null===_0x5ae228?_0x5ae228=Object['getOwnPropertyDescriptor'](_0x94cbeb,_0x333cde):_0x5ae228;if('object'==typeof Reflect&&_0x44a986(0x379)==typeof Reflect['decorate'])_0x26e9c9=Reflect['decorate'](_0x385761,_0x94cbeb,_0x333cde,_0x5ae228);else{for(var _0x52b383=_0x385761['length']-0x1;_0x52b383>=0x0;_0x52b383--)(_0x387d72=_0x385761[_0x52b383])&&(_0x26e9c9=(_0x2e9f36<0x3?_0x387d72(_0x26e9c9):_0x2e9f36>0x3?_0x387d72(_0x94cbeb,_0x333cde,_0x26e9c9):_0x387d72(_0x94cbeb,_0x333cde))||_0x26e9c9);}return _0x2e9f36>0x3&&_0x26e9c9&&Object[_0x44a986(0x2d5)](_0x94cbeb,_0x333cde,_0x26e9c9),_0x26e9c9;},_0x8ceb25=this&&this['__metadata']||function(_0x32ee7c,_0x3a72ff){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x32ee7c,_0x3a72ff);},_0x1604a0=this&&this[_0x188463(0x3e3)]||function(_0x230d50,_0x17776e){return function(_0x2bdc36,_0x227244){_0x17776e(_0x2bdc36,_0x227244,_0x230d50);};};Object['defineProperty'](_0x31e575,_0x188463(0x363),{'value':!0x0}),_0x31e575['WithdrawalService']=void 0x0;const _0x2e6b26=_0x4b160e(0x2),_0x13f2e6=_0x4b160e(0xb),_0x3e8583=_0x4b160e(0xe),_0x556fba=_0x4b160e(0xf),_0x38293f=_0x4b160e(0xd),_0x5a99f8=_0x4b160e(0x13),_0xb4f572=_0x4b160e(0x2a),_0xbe3912=_0x4b160e(0x35),_0x1518a8=_0x4b160e(0x37),_0x25bbd3=_0x4b160e(0x11),_0x1484f6=_0x4b160e(0x8);let _0x3a68a7=class{constructor(_0xf14c41,_0xc5f17d,_0x4c2a43,_0x24d44d,_0x139a7f,_0x4be10e){const _0xbe9e10=_0x188463;this['wsService']=_0xf14c41,this['bankService']=_0xc5f17d,this['deviceService']=_0x4c2a43,this[_0xbe9e10(0x3e1)]=_0x24d44d,this['notificationService']=_0x139a7f,this['httpService']=_0x4be10e,this[_0xbe9e10(0x22a)]=new _0x2e6b26['Logger']('WithdrawalService'),this[_0xbe9e10(0x145)]='withdrawal:processed:',this['PROCESSING_TTL']=0xf731400,this['COMPLETED_TTL']=0xf731400;}async['checkIfProcessed'](_0x36e48e){const _0x4fb457=_0x188463;try{const _0x4168e1=''+this[_0x4fb457(0x145)]+_0x36e48e,_0x2b98a9=await this['redisService'][_0x4fb457(0x3ca)](_0x4168e1);return _0x4fb457(0x3fd)===_0x2b98a9?(this['logger']['warn']('Withdrawal\x20'+_0x36e48e+_0x4fb457(0x2f1)),!0x0):'processing'===_0x2b98a9&&(this['logger'][_0x4fb457(0x375)]('Withdrawal\x20'+_0x36e48e+'\x20is\x20being\x20processed\x20by\x20another\x20instance'),!0x0);}catch(_0x250dc0){return this['logger']['error']('Error\x20checking\x20processed\x20status\x20for\x20'+_0x36e48e+':\x20'+_0x250dc0['message']),!0x1;}}async['markAsProcessing'](_0x5614de){const _0x609921=_0x188463;try{const _0x35d591=''+this['REDIS_PROCESSED_PREFIX']+_0x5614de;return'OK'===await this['redisService'][_0x609921(0x112)](_0x35d591,'processing',this[_0x609921(0x16f)])?(this['logger']['debug']('Marked\x20withdrawal\x20'+_0x5614de+'\x20as\x20processing'),!0x0):(this['logger'][_0x609921(0x375)](_0x609921(0x3ab)+_0x5614de+'\x20is\x20already\x20being\x20processed\x20by\x20another\x20instance'),!0x1);}catch(_0x100635){return this['logger']['error']('Error\x20marking\x20withdrawal\x20'+_0x5614de+'\x20as\x20processing:\x20'+_0x100635['message']),!0x0;}}async['markAsCompleted'](_0x36530f){const _0x3f3408=_0x188463;try{const _0x489f64=''+this['REDIS_PROCESSED_PREFIX']+_0x36530f;await this['redisService']['set'](_0x489f64,'completed',this['COMPLETED_TTL']),this['logger'][_0x3f3408(0x19e)]('Marked\x20withdrawal\x20'+_0x36530f+'\x20as\x20completed');}catch(_0x4ff5e0){this[_0x3f3408(0x22a)]['error']('Error\x20marking\x20withdrawal\x20'+_0x36530f+'\x20as\x20completed:\x20'+_0x4ff5e0['message']);}}async['markAsFailed'](_0x4879d9){const _0x45d96a=_0x188463;try{const _0x5b51ba=''+this['REDIS_PROCESSED_PREFIX']+_0x4879d9;await this['redisService']['del'](_0x5b51ba),this['logger'][_0x45d96a(0x19e)](_0x45d96a(0x39b)+_0x4879d9+'\x20as\x20failed\x20(removed\x20from\x20processed\x20list)');}catch(_0x5aa44c){this['logger']['error']('Error\x20marking\x20withdrawal\x20'+_0x4879d9+_0x45d96a(0x122)+_0x5aa44c[_0x45d96a(0x36b)]);}}async[_0x188463(0x28a)](_0x16a07c,_0x11d6fe){const _0x561805=_0x188463,{withdrawalId:_0x468f16,bankCode:_0x212db1,amount:_0x15d6b0}=_0x16a07c;if(await this['checkIfProcessed'](_0x468f16))this[_0x561805(0x22a)]['warn']('Withdrawal\x20'+_0x468f16+'\x20already\x20processed\x20or\x20being\x20processed,\x20skipping');else{if(!await this[_0x561805(0x243)](_0x468f16)){const _0xda17e6='Withdrawal\x20'+_0x468f16+'\x20is\x20being\x20processed\x20by\x20another\x20instance';throw this['logger']['warn'](_0xda17e6),new _0xb4f572['WithdrawalProcessingError'](_0xda17e6,_0xb4f572[_0x561805(0x2d8)]['TEMPORARY'],'Failed:\x20Mark\x20as\x20processing');}try{if(this['logger'][_0x561805(0x19e)]('['+_0x11d6fe[_0x561805(0x153)]+']\x20Processing\x20withdrawal:\x20'+_0x468f16+'\x20for\x20bank:\x20'+_0x212db1+',\x20amount:\x20'+_0x15d6b0),_0x11d6fe['availableAmount']<_0x15d6b0){const _0x36ac70='['+_0x11d6fe['accountName']+']\x20Assigned\x20device\x20has\x20insufficient\x20amount.\x20Available:\x20'+_0x11d6fe['availableAmount']+_0x561805(0x272)+_0x15d6b0;throw this[_0x561805(0x22a)]['error'](_0x36ac70),await this['markAsFailed'](_0x468f16),await this['deviceService'][_0x561805(0x322)](_0x11d6fe['deviceId'],{'status':'deactive'}),new _0xb4f572['WithdrawalProcessingError'](_0x36ac70,_0xb4f572['ErrorType']['TEMPORARY'],'Failed:\x20Source\x20account\x20is\x20insufficient');}await this['bankService']['executeTransferWithQRCode'](_0x16a07c,_0x11d6fe,_0x11d6fe['bankCode']),this['deviceService']['deductDeviceAmount'](_0x11d6fe[_0x561805(0x364)],_0x15d6b0)[_0x561805(0x381)](()=>{});const _0xe12efe=await this[_0x561805(0x19d)]['analyzeTransferBill'](_0x11d6fe['bankCode'],_0x16a07c);this['notificationService']['completeWithdrawal'](_0x16a07c,_0xe12efe,_0x11d6fe)[_0x561805(0x381)](()=>{}),'unknown'===_0xe12efe['analyzedStatus']&&await this['bankService']['login'](_0x11d6fe['bankCode'],_0x11d6fe['deviceId'],!0x0),await this['bankService']['goToHomeScreenFromBill'](_0x11d6fe),await this['markAsCompleted'](_0x468f16),this[_0x561805(0x22a)]['log'](_0x561805(0x232)+_0x468f16);}catch(_0x617b26){throw await this['markAsFailed'](_0x468f16),_0x617b26;}}}async['getWithdrawalDetails'](_0x316d7e){const _0x36e544=_0x188463,_0x55c111=_0x25bbd3[_0x36e544(0x3ba)]['ezpayBe'][_0x36e544(0x34f)]+'/api/internal/withdrawals/'+_0x316d7e;return(await(0x0,_0x1518a8['firstValueFrom'])(this['httpService'][_0x36e544(0x3ca)](_0x55c111,{'headers':{'Content-Type':'application/json','X-API-Key':_0x25bbd3['config']['ezpayBe'][_0x36e544(0x15e)],'x-internal-secret-key':_0x25bbd3['config']['ezpayBe'][_0x36e544(0x15e)]},'timeout':0x4e20})))[_0x36e544(0x2b2)][_0x36e544(0x2b2)];}};_0x31e575[_0x188463(0x151)]=_0x3a68a7,_0x31e575['WithdrawalService']=_0x3a68a7=_0x17ffa0([(0x0,_0x2e6b26['Injectable'])(),_0x1604a0(0x0,(0x0,_0x2e6b26[_0x188463(0x1c5)])(_0x38293f[_0x188463(0x1c0)])),_0x1604a0(0x2,(0x0,_0x2e6b26['Inject'])((0x0,_0x2e6b26['forwardRef'])(()=>_0x3e8583['DeviceService']))),_0x8ceb25('design:paramtypes',['function'==typeof(_0x52f851=void 0x0!==_0x5a99f8['IWebSocketService']&&_0x5a99f8['IWebSocketService'])?_0x52f851:Object,'function'==typeof(_0x4277e4=void 0x0!==_0x13f2e6['BankService']&&_0x13f2e6[_0x188463(0x20a)])?_0x4277e4:Object,'function'==typeof(_0x3edc35=void 0x0!==_0x3e8583['DeviceService']&&_0x3e8583['DeviceService'])?_0x3edc35:Object,'function'==typeof(_0x5c42d8=void 0x0!==_0x556fba['RedisService']&&_0x556fba['RedisService'])?_0x5c42d8:Object,'function'==typeof(_0x57cffa=void 0x0!==_0xbe3912['NotificationService']&&_0xbe3912[_0x188463(0x1a2)])?_0x57cffa:Object,'function'==typeof(_0x18d39a=void 0x0!==_0x1484f6['HttpService']&&_0x1484f6['HttpService'])?_0x18d39a:Object])],_0x3a68a7);},function(_0x209eec,_0x43cd75,_0x4bde70){const _0x42cfd7=a0_0x5814;var _0x2c5758,_0x409c6c,_0x21c94d,_0x3936fc,_0x31d203,_0x16a19f,_0x135336,_0x577859,_0x18e9a9=this&&this['__decorate']||function(_0x5e3cf3,_0x1fb51c,_0x420816,_0x4a329e){const _0x16902f=a0_0x5814;var _0x46f6a4,_0x1451de=arguments[_0x16902f(0x2be)],_0x484b3e=_0x1451de<0x3?_0x1fb51c:null===_0x4a329e?_0x4a329e=Object[_0x16902f(0x313)](_0x1fb51c,_0x420816):_0x4a329e;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x16902f(0x1fe)])_0x484b3e=Reflect['decorate'](_0x5e3cf3,_0x1fb51c,_0x420816,_0x4a329e);else{for(var _0xb4d732=_0x5e3cf3[_0x16902f(0x2be)]-0x1;_0xb4d732>=0x0;_0xb4d732--)(_0x46f6a4=_0x5e3cf3[_0xb4d732])&&(_0x484b3e=(_0x1451de<0x3?_0x46f6a4(_0x484b3e):_0x1451de>0x3?_0x46f6a4(_0x1fb51c,_0x420816,_0x484b3e):_0x46f6a4(_0x1fb51c,_0x420816))||_0x484b3e);}return _0x1451de>0x3&&_0x484b3e&&Object['defineProperty'](_0x1fb51c,_0x420816,_0x484b3e),_0x484b3e;},_0x3f777c=this&&this[_0x42cfd7(0x16e)]||function(_0xb8d3de,_0x3a2a4e){const _0x543760=_0x42cfd7;if(_0x543760(0x1bb)==typeof Reflect&&_0x543760(0x379)==typeof Reflect['metadata'])return Reflect['metadata'](_0xb8d3de,_0x3a2a4e);};Object['defineProperty'](_0x43cd75,_0x42cfd7(0x363),{'value':!0x0}),_0x43cd75['BankService']=void 0x0;const _0x4efc8f=_0x4bde70(0x2),_0x1d055d=_0x4bde70(0xc),_0x39e596=_0x4bde70(0x28),_0x27c8d6=_0x4bde70(0x2f),_0x56899d=_0x4bde70(0x32),_0x1b2fc5=_0x4bde70(0xe),_0x143840=_0x4bde70(0x34),_0x38a1fe=_0x4bde70(0x14),_0x1c559f=_0x4bde70(0x2a),_0x3b2e48=_0x4bde70(0x2c),_0xa30dd8=_0x4bde70(0x18),_0xd4ec15=_0x4bde70(0x4),_0x43c7cf=_0x4bde70(0x1a),_0x4d20c0=_0x4bde70(0x19);let _0x35d98e=class{constructor(_0x249b76,_0x398db6,_0x3b2b96,_0x3bcfef,_0x5cfa6b,_0x9641f5,_0x4ffffd,_0x58cbca){const _0x283bc6=_0x42cfd7;this[_0x283bc6(0x1ac)]=_0x249b76,this['pgService']=_0x398db6,this['hdBankService']=_0x3b2b96,this['vietcombankService']=_0x3bcfef,this[_0x283bc6(0x20d)]=_0x5cfa6b,this[_0x283bc6(0x292)]=_0x9641f5,this['deviceLock']=_0x4ffffd,this['telegramService']=_0x58cbca,this['logger']=new _0x4efc8f['Logger']('BankService'),this['bankServices']=new Map(),this['registerBankService'](this[_0x283bc6(0x1ac)]),this[_0x283bc6(0x20f)](this[_0x283bc6(0x24a)]),this[_0x283bc6(0x20f)](this['hdBankService']),this['registerBankService'](this['vietcombankService']);}[_0x42cfd7(0x20f)](_0x5b06aa){const _0x2a2a31=_0x42cfd7,_0x445822=_0x5b06aa[_0x2a2a31(0x2bf)]()[_0x2a2a31(0x2c9)]();this['bankServices'][_0x2a2a31(0x12e)](_0x445822,_0x5b06aa),this[_0x2a2a31(0x22a)]['log']('Registered\x20bank\x20service:\x20'+_0x445822);}[_0x42cfd7(0x237)](_0x1967e6){const _0x3b24da=_0x42cfd7,_0x1776df=this['bankServices']['get'](_0x1967e6['toUpperCase']());if(!_0x1776df)throw new _0x1c559f['WithdrawalProcessingError']('Bank\x20'+_0x1967e6+'\x20not\x20supported!\x20Cannot\x20find\x20bank\x20service\x20out!',_0x1c559f['ErrorType'][_0x3b24da(0x1d3)]);return _0x1776df;}['getSupportedBanks'](){const _0x42a0da=_0x42cfd7;return Array['from'](this['bankServices'][_0x42a0da(0x1d5)]());}async['login'](_0x50046b,_0x536116,_0x2b14c4=!0x1){const _0xf8b980=_0x42cfd7;if(_0x2b14c4&&await this['deviceLock']['releaseLock'](_0x536116),await this[_0xf8b980(0x120)][_0xf8b980(0x3bf)](_0x536116)){const _0x28ae13=await this[_0xf8b980(0x120)]['getLock'](_0x536116);throw new Error(_0xf8b980(0x3d3)+_0x536116+'\x20is\x20currently\x20locked\x20by\x20'+_0x28ae13?.['lockType']+'\x20('+_0x28ae13?.['lockedBy']+').\x20Cannot\x20login.');}const _0x41e181=_0xf8b980(0x211)+_0x50046b+':'+_0x536116+':'+Date['now']();if(!await this['deviceLock'][_0xf8b980(0x167)](_0x536116,'login',_0x41e181,0x41eb0))throw new Error('Failed\x20to\x20acquire\x20lock\x20for\x20device\x20'+_0x536116);try{await this[_0xf8b980(0x292)][_0xf8b980(0x344)](_0x536116,_0x50046b);const _0x5be7e4=this[_0xf8b980(0x237)](_0x50046b);if(!_0x5be7e4)throw new Error(_0xf8b980(0x3f6)+_0x50046b);this['logger'][_0xf8b980(0x19e)]('['+_0x536116+']\x20Logging\x20in\x20to\x20'+_0x50046b),await _0x5be7e4[_0xf8b980(0x3f2)](_0x536116),await this['sessionManagement']['recordLogin'](_0x536116,_0x50046b),this[_0xf8b980(0x22a)]['log']('['+_0x536116+_0xf8b980(0x40e)+_0x50046b);}catch(_0x5e5f56){throw await this['sessionManagement']['clearSession'](_0x536116,_0x50046b),_0x5e5f56;}finally{await this[_0xf8b980(0x120)]['releaseLock'](_0x536116);}}async[_0x42cfd7(0x10c)](){const _0x36a35a=_0x42cfd7;try{const _0x234f65=0x6,_0x1ac057=0x2710;let _0x10917d=[];for(let _0x564949=0x0;_0x564949<_0x234f65&&(this[_0x36a35a(0x22a)][_0x36a35a(0x19e)]('['+(_0x564949+0x1)+'/'+_0x234f65+']\x20Retrying\x20to\x20list\x20devices\x20on\x20login...'),_0x10917d=await this['deviceService']['listDevices'](),!(_0x10917d['length']>0x0));_0x564949++)await(0x0,_0xa30dd8[_0x36a35a(0x404)])(_0x1ac057);const _0x58d5f4=await this['deviceService']['listDeviceConfigs'](),_0x239e70=_0x10917d[_0x36a35a(0x3a9)](_0x4e47b9=>'active'===_0x4e47b9['status']&&_0x4e47b9['bankCode']),_0x7414f5=_0x58d5f4['filter'](_0x238e78=>_0x36a35a(0x2db)===_0x238e78[_0x36a35a(0x2a8)]&&_0x238e78[_0x36a35a(0x358)]);if(_0x239e70[_0x36a35a(0x2be)]<_0x7414f5['length']){const _0x30a639=_0x7414f5['filter'](_0x1096f6=>!_0x239e70[_0x36a35a(0x1cf)](_0x48383a=>_0x48383a['udid']===_0x1096f6['deviceId'])),_0x1a71cd=_0x30a639['map'](_0x493a64=>'<b>Bank:</b>\x20'+_0x493a64['bankCode']+'\x0a<b>Account:</b>\x20'+_0x493a64['accountName'])[_0x36a35a(0x19c)]('\x0a\x0a');this[_0x36a35a(0x226)][_0x36a35a(0x246)]({'text':_0x36a35a(0x1c4)+_0x30a639['length']+_0x36a35a(0x147)+_0x1a71cd,'options':{'parseMode':'HTML'}});}if(0x0===_0x239e70['length'])return void this['logger']['warn']('No\x20active\x20devices\x20found\x20to\x20login');for(const _0x30787c of _0x239e70){const _0xe946d6=_0x30787c['udid'];try{await this['deviceLock'][_0x36a35a(0x266)](_0xe946d6,_0x36a35a(0x154));}catch(_0x13bcdd){this['logger']['warn']('Failed\x20to\x20release\x20transfer\x20lock\x20for\x20device\x20'+_0xe946d6+':\x20'+_0x13bcdd[_0x36a35a(0x36b)]);}}const _0x59c856=[];for(const _0x3d7d29 of _0x239e70){const _0x2b39e3=_0x3d7d29['bankCode'][_0x36a35a(0x2c9)](),_0x556d3d=_0x3d7d29[_0x36a35a(0x33a)];_0x59c856[_0x36a35a(0x235)](this['login'](_0x2b39e3,_0x556d3d,!0x0)['catch'](_0xdafaaa=>{const _0xddf5e9=_0x36a35a;this[_0xddf5e9(0x22a)]['error'](_0xddf5e9(0x29e)+_0x2b39e3+'\x20on\x20device\x20'+_0x556d3d+':\x20'+_0xdafaaa['message']);}));}await Promise['allSettled'](_0x59c856),this['logger']['log']('Completed\x20login\x20process\x20for\x20all\x20active\x20banks');}catch(_0x248b6c){throw this['logger']['error']('Error\x20logging\x20in\x20all\x20active\x20banks:\x20'+_0x248b6c['message']),_0x248b6c;}}['executeTransferWithQRCode'](_0x21edbd,_0x555ec9,_0x20c734){return this['getBankService'](_0x20c734)['executeTransferWithQRCode'](_0x21edbd,_0x555ec9);}async['isSessionValid'](_0x46dced,_0x134994){const _0x3333b8=_0x42cfd7;return await this[_0x3333b8(0x292)]['isSessionValid'](_0x46dced,_0x134994);}['analyzeTransferBill'](_0x2f5fc2,_0x457d9e){return this['getBankService'](_0x2f5fc2)['analyzeTransferBill'](_0x2f5fc2,_0x457d9e);}async['refreshSessionIfNeeded'](_0x248d78,_0x1860a0){const _0x4fd7bb=_0x42cfd7,_0x43583e=await this['sessionManagement']['getSession'](_0x248d78,_0x1860a0);if('logging_in'===_0x43583e?.['status'])return!0x1;const _0x1a8bda=await this['sessionManagement']['needsRefresh'](_0x248d78,_0x1860a0),_0x35805e=await this['sessionManagement']['isSessionValid'](_0x248d78,_0x1860a0);if(!_0x1a8bda&&_0x35805e)return!0x1;if(await this[_0x4fd7bb(0x120)][_0x4fd7bb(0x3bf)](_0x248d78))return this['logger']['warn']('Cannot\x20refresh\x20session\x20for\x20device\x20'+_0x248d78+'\x20-\x20device\x20is\x20locked'),!0x1;try{return _0x35805e?this[_0x4fd7bb(0x22a)][_0x4fd7bb(0x19e)]('Refreshing\x20session\x20for\x20device\x20'+_0x248d78+',\x20bank\x20'+_0x1860a0):this['logger'][_0x4fd7bb(0x19e)]('Session\x20expired\x20or\x20missing\x20for\x20device\x20'+_0x248d78+',\x20bank\x20'+_0x1860a0+'.\x20Retrying\x20login...'),await this[_0x4fd7bb(0x3f2)](_0x1860a0,_0x248d78),!0x0;}catch(_0x2c5a41){return this['logger']['error']('Failed\x20to\x20refresh\x20session\x20for\x20device\x20'+_0x248d78+':\x20'+_0x2c5a41[_0x4fd7bb(0x36b)]),!0x1;}}['createQRCodeAndTransferTo'](_0x813794,_0x420342,_0x168562){const _0x214468=_0x42cfd7;return this[_0x214468(0x237)](_0x813794)['createQRCodeAndTransferTo'](_0x420342,_0x168562);}['captureScreen'](_0x497600,_0x65741a,_0x22eac6){return this['getBankService'](_0x497600)['captureScreen'](_0x65741a,{'folderPath':_0x22eac6});}['getBillImagePath'](_0x448faf,_0x520631){const _0x104785=_0x42cfd7;return this['getBankService'](_0x448faf)[_0x104785(0x290)](_0x520631);}[_0x42cfd7(0x15c)](_0x43cd10,_0x634627){const _0x12a48d=_0x42cfd7;return this['getBankService'](_0x43cd10)[_0x12a48d(0x15c)](_0x634627);}['goToHomeScreenFromBill'](_0x227a8f){return this['getBankService'](_0x227a8f['bankCode'])['goToHomeScreenFromBill'](_0x227a8f);}async['getLatestImagePath'](_0x34d810,_0x12e0b8=0x2710,_0x456131=0x1f4){const _0x1c1aa8=_0x42cfd7;if(!_0x34d810)return this['logger'][_0x1c1aa8(0x375)]('Folder\x20path\x20is\x20null\x20or\x20empty'),null;const _0xe9d327=Date[_0x1c1aa8(0x114)]();let _0x3cae81=0x0;for(this[_0x1c1aa8(0x22a)]['debug'](_0x1c1aa8(0x3b4)+_0x34d810+',\x20timeout:\x20'+_0x12e0b8+'ms,\x20pollInterval:\x20'+_0x456131+'ms');Date['now']()-_0xe9d327<_0x12e0b8;){_0x3cae81++;try{if(!(0x0,_0x4d20c0[_0x1c1aa8(0x1a0)])(_0x34d810)){await(0x0,_0xa30dd8['sleep'])(_0x456131);continue;}const _0x22dfe7=await(0x0,_0x43c7cf['readdir'])(_0x34d810);if(0x0===_0x22dfe7['length']){await(0x0,_0xa30dd8['sleep'])(_0x456131);continue;}const _0x7171d=(await Promise[_0x1c1aa8(0x37c)](_0x22dfe7['map'](async _0x4b7337=>{const _0x4d4921=_0x1c1aa8;try{const _0x1185ff=(0x0,_0xd4ec15[_0x4d4921(0x19c)])(_0x34d810,_0x4b7337),_0x35ce89=await(0x0,_0x43c7cf['stat'])(_0x1185ff);return{'fullPath':_0x1185ff,'mtime':_0x35ce89['mtimeMs'],'size':_0x35ce89[_0x4d4921(0x22e)]};}catch(_0x2ac270){return null;}})))['filter'](_0x1ac9e3=>null!==_0x1ac9e3&&_0x1ac9e3[_0x1c1aa8(0x22e)]>0x0);if(0x0===_0x7171d['length']){await(0x0,_0xa30dd8[_0x1c1aa8(0x404)])(_0x456131);continue;}_0x7171d['sort']((_0x3fc679,_0x5967a1)=>_0x5967a1['mtime']-_0x3fc679['mtime']);const _0x5e6672=_0x7171d[0x0][_0x1c1aa8(0x175)],_0x49c536=Date['now']()-_0xe9d327;return this['logger']['log'](_0x1c1aa8(0x3f8)+_0x5e6672+_0x1c1aa8(0x163)+_0x49c536+'ms\x20('+_0x3cae81+'\x20attempts)'),_0x5e6672;}catch(_0x25d2f6){this['logger']['debug']('Error\x20scanning\x20folder\x20'+_0x34d810+_0x1c1aa8(0x1f0)+_0x3cae81+'):\x20'+_0x25d2f6[_0x1c1aa8(0x36b)]+',\x20retrying...'),await(0x0,_0xa30dd8[_0x1c1aa8(0x404)])(_0x456131);}}const _0x41d887=Date['now']()-_0xe9d327;return this[_0x1c1aa8(0x22a)]['warn'](_0x1c1aa8(0x1b3)+_0x34d810+_0x1c1aa8(0x163)+_0x41d887+_0x1c1aa8(0x240)+_0x3cae81+'\x20attempts)'),null;}};_0x43cd75[_0x42cfd7(0x20a)]=_0x35d98e,_0x43cd75['BankService']=_0x35d98e=_0x18e9a9([(0x0,_0x4efc8f['Injectable'])(),_0x3f777c('design:paramtypes',['function'==typeof(_0x2c5758=void 0x0!==_0x1d055d['AcbService']&&_0x1d055d['AcbService'])?_0x2c5758:Object,_0x42cfd7(0x379)==typeof(_0x409c6c=void 0x0!==_0x39e596['PgService']&&_0x39e596['PgService'])?_0x409c6c:Object,'function'==typeof(_0x21c94d=void 0x0!==_0x27c8d6['HdBankService']&&_0x27c8d6['HdBankService'])?_0x21c94d:Object,_0x42cfd7(0x379)==typeof(_0x3936fc=void 0x0!==_0x56899d['VietcombankService']&&_0x56899d['VietcombankService'])?_0x3936fc:Object,'function'==typeof(_0x31d203=void 0x0!==_0x1b2fc5['DeviceService']&&_0x1b2fc5['DeviceService'])?_0x31d203:Object,'function'==typeof(_0x16a19f=void 0x0!==_0x143840[_0x42cfd7(0x1e9)]&&_0x143840[_0x42cfd7(0x1e9)])?_0x16a19f:Object,_0x42cfd7(0x379)==typeof(_0x135336=void 0x0!==_0x38a1fe['DeviceLockService']&&_0x38a1fe['DeviceLockService'])?_0x135336:Object,_0x42cfd7(0x379)==typeof(_0x577859=void 0x0!==_0x3b2e48[_0x42cfd7(0x1d7)]&&_0x3b2e48['TelegramService'])?_0x577859:Object])],_0x35d98e);},function(_0x363b5b,_0x354764,_0x361e35){const _0x46ed0b=a0_0x5814;var _0x5a1066,_0x32e6c3,_0x329936,_0x31f16e,_0x51df1b=this&&this[_0x46ed0b(0x21a)]||function(_0x1e1f66,_0x41fbe1,_0x7f2c6a,_0x4cbee3){const _0x5146ef=_0x46ed0b;var _0x488de8,_0x102cbe=arguments['length'],_0x4fceb2=_0x102cbe<0x3?_0x41fbe1:null===_0x4cbee3?_0x4cbee3=Object['getOwnPropertyDescriptor'](_0x41fbe1,_0x7f2c6a):_0x4cbee3;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x5146ef(0x1fe)])_0x4fceb2=Reflect['decorate'](_0x1e1f66,_0x41fbe1,_0x7f2c6a,_0x4cbee3);else{for(var _0x235ce2=_0x1e1f66['length']-0x1;_0x235ce2>=0x0;_0x235ce2--)(_0x488de8=_0x1e1f66[_0x235ce2])&&(_0x4fceb2=(_0x102cbe<0x3?_0x488de8(_0x4fceb2):_0x102cbe>0x3?_0x488de8(_0x41fbe1,_0x7f2c6a,_0x4fceb2):_0x488de8(_0x41fbe1,_0x7f2c6a))||_0x4fceb2);}return _0x102cbe>0x3&&_0x4fceb2&&Object['defineProperty'](_0x41fbe1,_0x7f2c6a,_0x4fceb2),_0x4fceb2;},_0x117fab=this&&this[_0x46ed0b(0x16e)]||function(_0x26f30b,_0x147e48){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x26f30b,_0x147e48);},_0x2ec67e=this&&this['__param']||function(_0x4dc415,_0x5b9d2b){return function(_0x879e1c,_0x4d2e3c){_0x5b9d2b(_0x879e1c,_0x4d2e3c,_0x4dc415);};};Object['defineProperty'](_0x354764,'__esModule',{'value':!0x0}),_0x354764['AcbService']=void 0x0;const _0x3630fe=_0x361e35(0x2),_0x3b6649=_0x361e35(0xd),_0x5c33fd=_0x361e35(0xe),_0x5660ee=_0x361e35(0x17),_0x4acbbb=_0x361e35(0x13),_0x2ec788=_0x361e35(0x18),_0x12ca43=_0x361e35(0x26),_0x5c275a=_0x361e35(0x27),_0xa87322=_0x361e35(0x1b),_0x5305bb=_0x361e35(0x1e);let _0x2ae908=class extends _0x5660ee['BaseBankService']{constructor(_0x2651cc,_0x2fa365,_0x556e3a,_0x5a723b){const _0x3d5399=_0x46ed0b;super(_0x2651cc,_0x2fa365,_0x556e3a,_0x5a723b),this[_0x3d5399(0x250)]=_0x2651cc,this['BANK_CODE']=_0x3d5399(0x3be),this['BUNDLE_ID']='mobileapp.acb.com.vn';}['launchApp'](_0x5ce93f){throw new Error('Method\x20not\x20implemented.');}async['captureScreen'](_0x580300,_0x1b4e2d){}async[_0x46ed0b(0x405)](_0x16a5c3){const _0x554cc0=_0x46ed0b;try{const {x:_0x235865,y:_0x142839}=_0x5c275a['ACB_UI_COORDINATES']['PASSWORD_FIELD'];this[_0x554cc0(0x22a)][_0x554cc0(0x19e)](_0x554cc0(0x35a)+_0x16a5c3+_0x554cc0(0x35b)+_0x235865+',\x20'+_0x142839+')'),await this['clickWithTransition'](_0x16a5c3,_0x235865,_0x142839,0.2),await(0x0,_0x2ec788['sleep'])(0x3e8),this[_0x554cc0(0x22a)]['log'](_0x554cc0(0x236)+_0x16a5c3);}catch(_0xae44b6){throw this['logger']['error']('Error\x20clicking\x20password\x20field\x20on\x20device\x20'+_0x16a5c3+':\x20'+_0xae44b6[_0x554cc0(0x36b)]),_0xae44b6;}}async[_0x46ed0b(0x2d9)](_0x1d0ac3){const _0x50db62=_0x46ed0b;try{const _0x57d1cd=await this[_0x50db62(0x20d)]['getDeviceConfig'](_0x1d0ac3);if(!_0x57d1cd||!_0x57d1cd['password'])throw new Error('Password\x20not\x20configured\x20for\x20device\x20'+_0x1d0ac3);await this[_0x50db62(0x250)]['inputText'](_0x1d0ac3,_0x57d1cd['password']);}catch(_0x1455fb){throw this[_0x50db62(0x22a)]['error']('Error\x20inputting\x20password\x20from\x20config\x20for\x20device\x20'+_0x1d0ac3+':\x20'+_0x1455fb['message']),_0x1455fb;}}async[_0x46ed0b(0x1a4)](_0x19b3c5){const _0xfb136f=_0x46ed0b;try{const {x:_0x3ae802,y:_0x5c4af6}=_0x5c275a['ACB_UI_COORDINATES']['LOGIN_BUTTON'];this['logger']['log'](_0xfb136f(0x185)+_0x19b3c5+'\x20at\x20coordinates\x20('+_0x3ae802+',\x20'+_0x5c4af6+')'),await this['wsService']['click'](_0x19b3c5,_0x3ae802,_0x5c4af6,0.2),await(0x0,_0x2ec788['sleep'])(0x1388),this['logger']['log']('Login\x20button\x20clicked\x20successfully\x20on\x20device\x20'+_0x19b3c5);}catch(_0x3be49c){throw this[_0xfb136f(0x22a)]['error'](_0xfb136f(0x2ad)+_0x19b3c5+':\x20'+_0x3be49c[_0xfb136f(0x36b)]),_0x3be49c;}}async['login'](_0xaece38){const _0x5c06be=_0x46ed0b;try{await this['killApp'](_0xaece38),await this['launchApp'](_0xaece38);const {x:_0x305df4,y:_0x1eb754}=_0x5c275a['ACB_UI_COORDINATES']['LOGIN_BUTTON'];this['logger']['log']('Clicking\x20login\x20button\x20on\x20device\x20'+_0xaece38+'\x20at\x20coordinates\x20('+_0x305df4+',\x20'+_0x1eb754+')'),await this[_0x5c06be(0x250)]['click'](_0xaece38,_0x305df4,_0x1eb754,0.2),await(0x0,_0x2ec788['sleep'])(0x7d0),await this['inputPasswordFromConfig'](_0xaece38),await(0x0,_0x2ec788['sleep'])(0x7d0);const {x:_0x1283b3,y:_0x24872a}=_0x12ca43[_0x5c06be(0x3ff)][_0x5c06be(0x2dd)];this['logger'][_0x5c06be(0x19e)]('Clicking\x20return\x20key\x20on\x20device\x20'+_0xaece38+'\x20at\x20coordinates\x20('+_0x1283b3+',\x20'+_0x24872a+')'),await this[_0x5c06be(0x250)]['click'](_0xaece38,_0x1283b3,_0x24872a,0.2),await(0x0,_0x2ec788[_0x5c06be(0x404)])(0x7d0),await this['wsService']['click'](_0xaece38,0.5,0.62,0.2),await(0x0,_0x2ec788['sleep'])(0x1388),await this['wsService']['click'](_0xaece38,0.3,0.55,0.2),await this['wsService']['click'](_0xaece38,0.5,0.65,0.2);}catch(_0x33cbee){throw this['logger']['error']('Error\x20logging\x20in\x20on\x20device\x20'+_0xaece38+':\x20'+_0x33cbee['message']),_0x33cbee;}}async['executeTransfer'](_0x262872,_0x2deb3d){}async['executeTransferWithQRCode'](_0x1730d1,_0x19b03a){const _0x139fda=_0x46ed0b;console['warn'](_0x139fda(0x2e8));}async[_0x46ed0b(0x38a)](_0x27fd88,_0x411d43){return this['executeExternalTransfer'](_0x27fd88,_0x411d43);}async['executeExternalTransfer'](_0x5ac949,_0x1684eb){const _0x13de88=_0x46ed0b;console[_0x13de88(0x375)](_0x13de88(0x1db));}async[_0x46ed0b(0x18f)](){const _0x5eb334=_0x46ed0b;console['warn'](_0x5eb334(0x1b7));}};_0x354764['AcbService']=_0x2ae908,_0x354764['AcbService']=_0x2ae908=_0x51df1b([(0x0,_0x3630fe[_0x46ed0b(0x1e6)])(),_0x2ec67e(0x0,(0x0,_0x3630fe['Inject'])(_0x3b6649['WEBSOCKET_SERVICE'])),_0x117fab(_0x46ed0b(0x17c),[_0x46ed0b(0x379)==typeof(_0x5a1066=void 0x0!==_0x4acbbb['IWebSocketService']&&_0x4acbbb[_0x46ed0b(0x11d)])?_0x5a1066:Object,'function'==typeof(_0x32e6c3=void 0x0!==_0x5c33fd['DeviceService']&&_0x5c33fd['DeviceService'])?_0x32e6c3:Object,_0x46ed0b(0x379)==typeof(_0x329936=void 0x0!==_0xa87322['OCRService']&&_0xa87322['OCRService'])?_0x329936:Object,'function'==typeof(_0x31f16e=void 0x0!==_0x5305bb['ImagePreprocessingService']&&_0x5305bb[_0x46ed0b(0x1a6)])?_0x31f16e:Object])],_0x2ae908);},(_0x47f2a1,_0x425972)=>{Object['defineProperty'](_0x425972,'__esModule',{'value':!0x0}),_0x425972['WEBSOCKET_SERVICE']=void 0x0,_0x425972['WEBSOCKET_SERVICE']=Symbol('WEBSOCKET_SERVICE');},function(_0x2f1a55,_0x493b35,_0x16f11a){const _0x355e27=a0_0x5814;var _0x5afdf9,_0x5146f7,_0x45a1e1,_0x774d36,_0x5b44fc=this&&this[_0x355e27(0x21a)]||function(_0x495606,_0x1a7b98,_0x5024ba,_0x691382){const _0x128f8a=_0x355e27;var _0xcee988,_0x1d1901=arguments[_0x128f8a(0x2be)],_0x571d5f=_0x1d1901<0x3?_0x1a7b98:null===_0x691382?_0x691382=Object['getOwnPropertyDescriptor'](_0x1a7b98,_0x5024ba):_0x691382;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x571d5f=Reflect['decorate'](_0x495606,_0x1a7b98,_0x5024ba,_0x691382);else{for(var _0x5ada8d=_0x495606['length']-0x1;_0x5ada8d>=0x0;_0x5ada8d--)(_0xcee988=_0x495606[_0x5ada8d])&&(_0x571d5f=(_0x1d1901<0x3?_0xcee988(_0x571d5f):_0x1d1901>0x3?_0xcee988(_0x1a7b98,_0x5024ba,_0x571d5f):_0xcee988(_0x1a7b98,_0x5024ba))||_0x571d5f);}return _0x1d1901>0x3&&_0x571d5f&&Object[_0x128f8a(0x2d5)](_0x1a7b98,_0x5024ba,_0x571d5f),_0x571d5f;},_0x1a3802=this&&this['__metadata']||function(_0xf01e48,_0x1e693b){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0xf01e48,_0x1e693b);},_0x33b8cb=this&&this['__param']||function(_0x21377e,_0x5e8f3a){return function(_0x92c402,_0x50ade9){_0x5e8f3a(_0x92c402,_0x50ade9,_0x21377e);};};Object['defineProperty'](_0x493b35,'__esModule',{'value':!0x0}),_0x493b35['DeviceService']=void 0x0;const _0x2e3186=_0x16f11a(0x2),_0x3d1582=_0x16f11a(0xf),_0x18c11c=_0x16f11a(0x13),_0x285e05=_0x16f11a(0xd),_0x3bc1dd=_0x16f11a(0x14),_0x369032=_0x16f11a(0xb),_0x178355=_0x16f11a(0x16);let _0x36eb3e=class{constructor(_0x3a02de,_0x373a92,_0x5265a8,_0x21bac9){const _0x28ee1f=_0x355e27;this['redisService']=_0x3a02de,this['wsService']=_0x373a92,this['deviceLockService']=_0x5265a8,this[_0x28ee1f(0x19d)]=_0x21bac9,this['logger']=new _0x2e3186[(_0x28ee1f(0x3c7))]('DeviceService'),this[_0x28ee1f(0x135)]=_0x28ee1f(0x394),this['REDIS_DEVICE_CONFIG_SUFFIX']=':config',this['REDIS_SERVICE_STATUS_KEY']='service:status';}async[_0x355e27(0x302)](){const _0x39fdf8=_0x355e27;try{await this['setServiceStatus']('inactive'),this['logger']['log']('Service\x20status\x20initialized\x20to:\x20inactive');}catch(_0x3698c1){this['logger'][_0x39fdf8(0x3e9)]('Failed\x20to\x20initialize\x20service\x20status:\x20'+_0x3698c1[_0x39fdf8(0x36b)]);}}async['listDeviceConfigs'](){const _0x4ae8e3=_0x355e27;try{const _0x2948b8=this['REDIS_DEVICE_CONFIG_PREFIX']+'*'+this['REDIS_DEVICE_CONFIG_SUFFIX'],_0x4625ca=await this['redisService'][_0x4ae8e3(0x1d5)](_0x2948b8);return 0x0===_0x4625ca['length']?[]:(await Promise[_0x4ae8e3(0x37c)](_0x4625ca['map'](async _0x5004ad=>{const _0x1deeb6=_0x4ae8e3;try{const _0x5cf795=await this['redisService'][_0x1deeb6(0x3ca)](_0x5004ad);return _0x5cf795?JSON[_0x1deeb6(0x37d)](_0x5cf795):null;}catch(_0x1c6a24){return this['logger']['error']('Error\x20parsing\x20config\x20for\x20key\x20'+_0x5004ad+':\x20'+_0x1c6a24['message']),null;}})))['filter'](_0x46d696=>!(0x0,_0x178355[_0x4ae8e3(0x261)])(_0x46d696));}catch(_0x1161da){return this['logger']['error']('Error\x20listing\x20device\x20configs:\x20'+_0x1161da['message']),[];}}async['listDevices'](){const _0x4c0447=_0x355e27;try{const _0x2d2786=await this['wsService'][_0x4c0447(0x106)]();return await Promise['all'](_0x2d2786['map'](async _0x555459=>{const _0x3b770b=_0x4c0447,_0x28a832=await this[_0x3b770b(0x24f)](_0x555459['udid']);return{..._0x555459,'bankCode':_0x28a832?.['bankCode']||'','availableAmount':_0x28a832?.[_0x3b770b(0x117)]||0x0,'status':_0x28a832?.['status']||'deactive','password':_0x28a832?.[_0x3b770b(0x13f)]||'','smartOTP':_0x28a832?.[_0x3b770b(0x377)]||'','accountNo':_0x28a832?.['accountNo']||'','accountName':_0x28a832?.['accountName']||''};}));}catch(_0x516c20){return this['logger']['error']('Error\x20listing\x20devices:\x20'+_0x516c20['message']),[];}}async['getDeviceConfig'](_0x12fdfe){const _0x2422f9=_0x355e27;try{const _0x431104=''+this[_0x2422f9(0x135)]+_0x12fdfe+this['REDIS_DEVICE_CONFIG_SUFFIX'],_0x27c6a7=await this['redisService']['get'](_0x431104);return _0x27c6a7?JSON['parse'](_0x27c6a7):null;}catch(_0x562bbe){return this['logger']['error'](_0x2422f9(0x2c8)+_0x12fdfe+':\x20'+_0x562bbe['message']),null;}}async[_0x355e27(0x1e3)](_0x1ff9b2){const _0x56fe3c=_0x355e27;try{const _0x9b1899=await this['getDeviceConfig'](_0x1ff9b2);return _0x9b1899?{..._0x9b1899,'password':_0x9b1899['password']?'':void 0x0,'smartOTP':_0x9b1899['smartOTP']?'':void 0x0}:null;}catch(_0x509d9f){return this['logger'][_0x56fe3c(0x3e9)]('Error\x20getting\x20safe\x20device\x20config\x20for\x20'+_0x1ff9b2+':\x20'+_0x509d9f['message']),null;}}async['updateDeviceConfig'](_0x5192ab,_0x5518b7){const _0x5ace11=_0x355e27;try{const _0x20e6fb=''+this['REDIS_DEVICE_CONFIG_PREFIX']+_0x5192ab+this[_0x5ace11(0x388)],_0x1ec285=await this['getDeviceConfig'](_0x5192ab),_0x234359=_0x1ec285?.['password']||_0x1ec285?.[_0x5ace11(0x377)],_0x1aed15=_0x234359?_0x1ec285?.[_0x5ace11(0x13f)]||'':void 0x0!==_0x5518b7[_0x5ace11(0x13f)]?_0x5518b7['password']:'',_0x11e337=_0x234359?_0x1ec285?.[_0x5ace11(0x377)]||'':void 0x0!==_0x5518b7['smartOTP']?_0x5518b7['smartOTP']:'',_0x545447={'deviceId':_0x5192ab,'bankCode':void 0x0!==_0x5518b7[_0x5ace11(0x358)]?_0x5518b7['bankCode']:_0x1ec285?.[_0x5ace11(0x358)]||'','availableAmount':void 0x0!==_0x5518b7['availableAmount']?_0x5518b7['availableAmount']:_0x1ec285?.[_0x5ace11(0x117)]||0x0,'status':void 0x0!==_0x5518b7[_0x5ace11(0x2a8)]?_0x5518b7['status']:_0x1ec285?.['status']||_0x5ace11(0x337),'password':_0x1aed15,'smartOTP':_0x11e337,'accountNo':void 0x0!==_0x5518b7['accountNo']?_0x5518b7['accountNo']:_0x1ec285?.['accountNo']||'','accountName':void 0x0!==_0x5518b7['accountName']?_0x5518b7['accountName']:_0x1ec285?.['accountName']||''};return await this['redisService']['set'](_0x20e6fb,JSON[_0x5ace11(0x186)](_0x545447)),this['logger']['log']('['+_0x5192ab+']\x20Updated\x20device\x20config\x20(bankCode:\x20'+(_0x545447['bankCode']||'not\x20set')+'):\x20'+JSON['stringify']((0x0,_0x178355['omit'])(_0x545447,['password',_0x5ace11(0x377)]))),_0x545447;}catch(_0x464404){throw this['logger']['error']('['+_0x5192ab+']\x20Error\x20updating\x20device\x20config:\x20'+_0x464404['message']),_0x464404;}}async['deleteDeviceConfig'](_0x5b6791){const _0x2dcab4=_0x355e27;try{const _0x6aed75=''+this['REDIS_DEVICE_CONFIG_PREFIX']+_0x5b6791+this['REDIS_DEVICE_CONFIG_SUFFIX'];await this[_0x2dcab4(0x3e1)]['del'](_0x6aed75),this[_0x2dcab4(0x22a)][_0x2dcab4(0x19e)]('['+_0x5b6791+_0x2dcab4(0x2e2));}catch(_0x3d0e02){throw this['logger']['error']('['+_0x5b6791+']\x20Error\x20deleting\x20device\x20config:\x20'+_0x3d0e02['message']),_0x3d0e02;}}async[_0x355e27(0x1eb)](){const _0x5e014c=_0x355e27;try{return await this[_0x5e014c(0x3e1)]['get'](this[_0x5e014c(0x13e)])||'inactive';}catch(_0x419aab){return this['logger'][_0x5e014c(0x3e9)]('Error\x20getting\x20service\x20status:\x20'+_0x419aab['message']),'inactive';}}async['setServiceStatus'](_0x54fc1a){try{await this['redisService']['set'](this['REDIS_SERVICE_STATUS_KEY'],_0x54fc1a),this['logger']['log']('Service\x20status\x20set\x20to:\x20'+_0x54fc1a);}catch(_0xbbfac1){throw this['logger']['error']('Error\x20setting\x20service\x20status:\x20'+_0xbbfac1['message']),_0xbbfac1;}}async['startService'](){const _0x22df7b=_0x355e27;try{if(!await this[_0x22df7b(0x36f)]())throw new _0x2e3186['HttpException']({'success':!0x1,'error':'Vui\x20lòng\x20active\x20bank\x20trước\x20khi\x20start'},_0x2e3186['HttpStatus']['BAD_REQUEST']);return this['bankService'][_0x22df7b(0x10c)]()[_0x22df7b(0x381)](_0x124865=>{const _0x3c58db=_0x22df7b;this[_0x3c58db(0x22a)]['error']('Error\x20during\x20background\x20login\x20process:\x20'+_0x124865[_0x3c58db(0x36b)]);}),await new Promise(_0x136a8c=>setTimeout(_0x136a8c,0x7d0)),await this['setServiceStatus']('active'),{'success':!0x0,'message':_0x22df7b(0x20e)};}catch(_0x139e85){if(_0x139e85 instanceof _0x2e3186['HttpException'])throw _0x139e85;throw this['logger']['error'](_0x22df7b(0x2e0)+_0x139e85['message'],_0x139e85[_0x22df7b(0x1f2)]),new _0x2e3186['HttpException']({'success':!0x1,'error':_0x139e85['message']||'Failed\x20to\x20start\x20service'},_0x2e3186['HttpStatus']['INTERNAL_SERVER_ERROR']);}}async['deductDeviceAmount'](_0x15fac5,_0x3e0249){const _0x36b3de=_0x355e27;try{const _0x1f8c54=await this[_0x36b3de(0x24f)](_0x15fac5);if(!_0x1f8c54)return!0x1;const _0xa1984f=_0x1f8c54['availableAmount']-_0x3e0249;return _0xa1984f<0x0?(this[_0x36b3de(0x22a)]['warn']('Insufficient\x20amount\x20for\x20device\x20'+_0x15fac5+'.\x20Available:\x20'+_0x1f8c54['availableAmount']+',\x20Requested:\x20'+_0x3e0249),!0x1):(await this[_0x36b3de(0x322)](_0x15fac5,{'availableAmount':_0xa1984f}),!0x0);}catch(_0x4428ff){return this[_0x36b3de(0x22a)][_0x36b3de(0x3e9)]('Error\x20deducting\x20amount\x20for\x20device\x20'+_0x15fac5+':\x20'+_0x4428ff['message']),!0x1;}}async['hasActiveDevice'](){const _0x1ed44d=_0x355e27;try{return(await this['listDevices']())['some'](_0x4c401e=>'active'===_0x4c401e[_0x1ed44d(0x2a8)]);}catch(_0x54cf30){return this['logger']['error']('Error\x20checking\x20active\x20devices:\x20'+_0x54cf30[_0x1ed44d(0x36b)]),!0x1;}}async[_0x355e27(0x3db)](){const _0x4dc6a4=_0x355e27;try{const _0xda7640=await this['wsService']['listDevices'](),_0x22513c=[];for(const _0x19d9a4 of _0xda7640){const _0x162cd7=await this['getDeviceConfig'](_0x19d9a4[_0x4dc6a4(0x33a)]);'active'===_0x162cd7?.[_0x4dc6a4(0x2a8)]&&(await this['deviceLockService']['isLocked'](_0x19d9a4['udid'])||(await this['bankService']['isSessionValid'](_0x19d9a4[_0x4dc6a4(0x33a)],_0x162cd7[_0x4dc6a4(0x358)])?_0x22513c[_0x4dc6a4(0x235)](_0x162cd7):this['logger'][_0x4dc6a4(0x3e9)]('['+_0x19d9a4['udid']+']\x20Device\x20does\x20not\x20have\x20valid\x20session\x20for\x20bank\x20'+_0x162cd7['bankCode'])));}return _0x22513c;}catch(_0x51d379){return this['logger']['error']('Error\x20getting\x20available\x20devices:\x20'+_0x51d379['message']),[];}}};_0x493b35['DeviceService']=_0x36eb3e,_0x493b35['DeviceService']=_0x36eb3e=_0x5b44fc([(0x0,_0x2e3186[_0x355e27(0x1e6)])(),_0x33b8cb(0x1,(0x0,_0x2e3186[_0x355e27(0x1c5)])(_0x285e05[_0x355e27(0x1c0)])),_0x33b8cb(0x3,(0x0,_0x2e3186['Inject'])((0x0,_0x2e3186['forwardRef'])(()=>_0x369032['BankService']))),_0x1a3802('design:paramtypes',['function'==typeof(_0x5afdf9=void 0x0!==_0x3d1582[_0x355e27(0x310)]&&_0x3d1582['RedisService'])?_0x5afdf9:Object,_0x355e27(0x379)==typeof(_0x5146f7=void 0x0!==_0x18c11c['IWebSocketService']&&_0x18c11c['IWebSocketService'])?_0x5146f7:Object,'function'==typeof(_0x45a1e1=void 0x0!==_0x3bc1dd[_0x355e27(0x2bd)]&&_0x3bc1dd[_0x355e27(0x2bd)])?_0x45a1e1:Object,'function'==typeof(_0x774d36=void 0x0!==_0x369032['BankService']&&_0x369032[_0x355e27(0x20a)])?_0x774d36:Object])],_0x36eb3e);},function(_0x17947e,_0x5abc3c,_0x2d0350){const _0x40f56b=a0_0x5814;var _0x2c3b5b=this&&this[_0x40f56b(0x21a)]||function(_0x20e265,_0x1f4da2,_0x379319,_0xba936c){const _0x35536f=_0x40f56b;var _0xc11db4,_0x37694a=arguments['length'],_0x96c4d3=_0x37694a<0x3?_0x1f4da2:null===_0xba936c?_0xba936c=Object['getOwnPropertyDescriptor'](_0x1f4da2,_0x379319):_0xba936c;if('object'==typeof Reflect&&_0x35536f(0x379)==typeof Reflect['decorate'])_0x96c4d3=Reflect[_0x35536f(0x1fe)](_0x20e265,_0x1f4da2,_0x379319,_0xba936c);else{for(var _0x33eec5=_0x20e265['length']-0x1;_0x33eec5>=0x0;_0x33eec5--)(_0xc11db4=_0x20e265[_0x33eec5])&&(_0x96c4d3=(_0x37694a<0x3?_0xc11db4(_0x96c4d3):_0x37694a>0x3?_0xc11db4(_0x1f4da2,_0x379319,_0x96c4d3):_0xc11db4(_0x1f4da2,_0x379319))||_0x96c4d3);}return _0x37694a>0x3&&_0x96c4d3&&Object[_0x35536f(0x2d5)](_0x1f4da2,_0x379319,_0x96c4d3),_0x96c4d3;},_0x128ec3=this&&this['__metadata']||function(_0x449d02,_0x426540){const _0x15e89d=_0x40f56b;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x15e89d(0x168)])return Reflect['metadata'](_0x449d02,_0x426540);};Object[_0x40f56b(0x2d5)](_0x5abc3c,_0x40f56b(0x363),{'value':!0x0}),_0x5abc3c['RedisService']=void 0x0;const _0x9d21b5=_0x2d0350(0x2),_0x296682=_0x2d0350(0x10),_0x24a76c=_0x2d0350(0x11);let _0x2c91f2=class{constructor(){const _0x14f39e=_0x40f56b;this[_0x14f39e(0x22a)]=new _0x9d21b5['Logger']('RedisService'),this[_0x14f39e(0x338)]=null;}async['getClient'](){const _0x5bd985=_0x40f56b;if(this['redisClient'])return this['redisClient'];const _0x52e6fa=_0x24a76c['config']['redis']['host']??'localhost',_0x27a742=_0x24a76c['config']['redis'][_0x5bd985(0x200)]??0x18eb,_0x29568b=_0x24a76c['config']['redis']['password']??void 0x0,_0x59f5ad=_0x24a76c['config']['redis']['db']??0x3;return this['redisClient']=new _0x296682['default']({'host':_0x52e6fa,'port':_0x27a742,'password':_0x29568b,'db':_0x59f5ad,'enableReadyCheck':!0x1,'maxRetriesPerRequest':null,'lazyConnect':!0x0}),this['redisClient']['on']('error',_0x4a9b9a=>{const _0x50c7ab=_0x5bd985;this[_0x50c7ab(0x22a)]['error']('Redis\x20Client\x20Error',_0x4a9b9a['stack']||_0x4a9b9a['message']);}),this[_0x5bd985(0x338)]['on']('connect',()=>{const _0x3fefc9=_0x5bd985;this[_0x3fefc9(0x22a)]['log']('Redis\x20Client\x20Connected');}),this['redisClient']['on']('ready',()=>{const _0x10ca7d=_0x5bd985;this[_0x10ca7d(0x22a)]['log']('Redis\x20Client\x20Ready');}),this['redisClient']['on']('close',()=>{this['logger']['warn']('Redis\x20Client\x20Connection\x20Closed');}),this['redisClient']['on']('reconnecting',()=>{const _0x6ad367=_0x5bd985;this['logger'][_0x6ad367(0x19e)](_0x6ad367(0x224));}),await this[_0x5bd985(0x338)][_0x5bd985(0x40c)](),this[_0x5bd985(0x338)];}async[_0x40f56b(0x1ce)](){const _0x40c79e=_0x40f56b;this['redisClient']&&(await this[_0x40c79e(0x338)][_0x40c79e(0x1ce)](),this['redisClient']=null,this['logger'][_0x40c79e(0x19e)]('Redis\x20Client\x20Disconnected'));}async['onModuleDestroy'](){await this['disconnect']();}async[_0x40f56b(0x3ca)](_0x25e75d){return(await this['getClient']())['get'](_0x25e75d);}async[_0x40f56b(0x12e)](_0x5d8928,_0x30f369,_0x6d728b){const _0xc2f3fd=await this['getClient']();if(_0x6d728b){const _0x3e2950=Math['ceil'](_0x6d728b/0x3e8);return _0xc2f3fd['setex'](_0x5d8928,_0x3e2950,_0x30f369);}return _0xc2f3fd['set'](_0x5d8928,_0x30f369);}async['setex'](_0x1bb639,_0x1bdeb1,_0x4b26ae){const _0x12cee2=_0x40f56b,_0x1c3bf4=await this[_0x12cee2(0x251)](),_0x5bedc5=Math[_0x12cee2(0x3a3)](_0x1bdeb1/0x3e8);return _0x1c3bf4['setex'](_0x1bb639,_0x5bedc5,_0x4b26ae);}async['del'](_0x92109e){const _0x1049f7=_0x40f56b;return(await this['getClient']())[_0x1049f7(0x36e)](_0x92109e);}async['exists'](_0x1bb23a){return(await this['getClient']())['exists'](_0x1bb23a);}async['zadd'](_0x229887,_0x4e1191,_0x3c2bfb){return(await this['getClient']())['zadd'](_0x229887,_0x4e1191,_0x3c2bfb);}async['zrange'](_0x1c0a9f,_0x354f6d,_0x22ba9d){const _0xb11916=_0x40f56b;return(await this[_0xb11916(0x251)]())['zrange'](_0x1c0a9f,_0x354f6d,_0x22ba9d);}async['zrangebyscore'](_0x1a4935,_0x5362d8,_0x415169,_0x4130d9){const _0x2fb0aa=_0x40f56b,_0x5803df=await this[_0x2fb0aa(0x251)]();return _0x4130d9?_0x5803df['zrangebyscore'](_0x1a4935,_0x5362d8,_0x415169,_0x2fb0aa(0x2c1),_0x4130d9['offset'],_0x4130d9['count']):_0x5803df['zrangebyscore'](_0x1a4935,_0x5362d8,_0x415169);}async['zrem'](_0x2ed5b7,..._0x39e1f4){return(await this['getClient']())['zrem'](_0x2ed5b7,..._0x39e1f4);}async[_0x40f56b(0x15b)](_0x51b046,..._0x5a2d90){return(await this['getClient']())['sadd'](_0x51b046,..._0x5a2d90);}async['sismember'](_0x6ef959,_0x2efb89){return(await this['getClient']())['sismember'](_0x6ef959,_0x2efb89);}async['hset'](_0xbd187b,_0x4ae77e,_0x519501){return(await this['getClient']())['hset'](_0xbd187b,_0x4ae77e,_0x519501);}async['hget'](_0x2d7a7f,_0xa52409){const _0x531de6=_0x40f56b;return(await this['getClient']())[_0x531de6(0x3a2)](_0x2d7a7f,_0xa52409);}async[_0x40f56b(0x300)](_0x1c589f){return(await this['getClient']())['hgetall'](_0x1c589f);}async['expire'](_0x3b87ac,_0x5a521c){const _0x439038=_0x40f56b;return(await this['getClient']())[_0x439038(0x360)](_0x3b87ac,_0x5a521c);}async['keys'](_0x5ae895){const _0x399f75=await this['getClient'](),_0x1b61b1=[];let _0x26901e='0';do{const _0x48c93c=await _0x399f75['scan'](_0x26901e,'MATCH',_0x5ae895,'COUNT',0x64);_0x26901e=_0x48c93c[0x0],_0x1b61b1['push'](..._0x48c93c[0x1]);}while('0'!==_0x26901e);return _0x1b61b1;}async['setnx'](_0x5e0df1,_0x4c5b45,_0xec7e63){const _0x50bc8f=_0x40f56b,_0x14f3b6=await this['getClient']();if(_0xec7e63){const _0x4297c0=Math[_0x50bc8f(0x3a3)](_0xec7e63/0x3e8);return await _0x14f3b6['set'](_0x5e0df1,_0x4c5b45,'EX',_0x4297c0,'NX');}return await _0x14f3b6['set'](_0x5e0df1,_0x4c5b45,'NX');}async['pickFromZSet'](_0x5dbb5c,_0x21420a=0x1){const _0x19eab3=await this['getClient'](),_0x481027=await _0x19eab3['zrange'](_0x5dbb5c,0x0,_0x21420a-0x1,'WITHSCORES');if(!_0x481027||0x0===_0x481027['length'])return[];const _0xd45422=[];for(let _0x6b8a55=0x0;_0x6b8a55<_0x481027['length'];_0x6b8a55+=0x2)_0xd45422['push']({'jobId':_0x481027[_0x6b8a55],'score':_0x481027[_0x6b8a55+0x1]});return _0xd45422;}};_0x5abc3c['RedisService']=_0x2c91f2,_0x5abc3c[_0x40f56b(0x310)]=_0x2c91f2=_0x2c3b5b([(0x0,_0x9d21b5[_0x40f56b(0x1e6)])(),_0x128ec3(_0x40f56b(0x17c),[])],_0x2c91f2);},_0x2f9c6e=>{const _0x28caef=a0_0x5814;_0x2f9c6e[_0x28caef(0x255)]=require('ioredis');},(_0xf6c878,_0x5dfdb2,_0x15a3e5)=>{const _0x300dd7=a0_0x5814;Object['defineProperty'](_0x5dfdb2,_0x300dd7(0x363),{'value':!0x0}),_0x5dfdb2['config']=void 0x0;const _0x44f8c8=_0x15a3e5(0x12),_0x20c0ce=_0x15a3e5(0x4);(0x0,_0x44f8c8['config'])({'path':(0x0,_0x20c0ce[_0x300dd7(0x19c)])(process['cwd'](),'.env')}),_0x5dfdb2[_0x300dd7(0x3ba)]={'NODE_ENV':process['env']['NODE_ENV']||_0x300dd7(0x3f9),'boxType':_0x300dd7(0x3d4),'redis':{'host':process[_0x300dd7(0x31b)]['REDIS_HOST']??_0x300dd7(0x3dc),'port':parseInt(process['env']['REDIS_PORT']??'6888'),'db':0x3,'password':process['env'][_0x300dd7(0x1bd)]??'Dcsvnqvmn1'},'ezpayBe':{'apiUrl':process['env']['EZZPAY_BE']??_0x300dd7(0x409),'apiKey':process[_0x300dd7(0x31b)]['EZZPAY_KEY']??_0x300dd7(0x1b4)},'ocr':{'poolSize':parseInt(process[_0x300dd7(0x31b)]['OCR_POOL_SIZE']||'4',0xa),'lang':process['env']['OCR_LANG']||_0x300dd7(0x3b9),'rois':{'singleLine':{'crop':{'x':parseFloat(process[_0x300dd7(0x31b)]['OCR_ROI_SINGLE_X']||'0'),'y':parseFloat(process['env']['OCR_ROI_SINGLE_Y']||'0'),'width':parseFloat(process['env']['OCR_ROI_SINGLE_WIDTH']||'1'),'height':parseFloat(process[_0x300dd7(0x31b)][_0x300dd7(0x2a9)]||'1')},'psm':parseInt(process['env'][_0x300dd7(0x37b)]||'7',0xa),'charWhitelist':process['env']['OCR_WHITELIST_SINGLE']||'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\x20.-','maxWidth':parseInt(process['env']['OCR_MAX_WIDTH_SINGLE']||'800',0xa)},'block':{'crop':{'x':parseFloat(process['env']['OCR_ROI_BLOCK_X']||'0'),'y':parseFloat(process['env']['OCR_ROI_BLOCK_Y']||'0'),'width':parseFloat(process[_0x300dd7(0x31b)]['OCR_ROI_BLOCK_WIDTH']||'1'),'height':parseFloat(process[_0x300dd7(0x31b)]['OCR_ROI_BLOCK_HEIGHT']||'1')},'psm':parseInt(process['env']['OCR_PSM_BLOCK']||'6',0xa),'charWhitelist':process['env']['OCR_WHITELIST_BLOCK']||void 0x0,'maxWidth':parseInt(process[_0x300dd7(0x31b)]['OCR_MAX_WIDTH_BLOCK']||'1200',0xa)},'full':{'crop':{'x':0x0,'y':0x0,'width':0x1,'height':0x1},'psm':parseInt(process[_0x300dd7(0x31b)][_0x300dd7(0x3ac)]||'6',0xa),'charWhitelist':void 0x0,'maxWidth':parseInt(process['env'][_0x300dd7(0x18e)]||'1200',0xa)}}},'spaceocr':{'datacenterPrimary':_0x300dd7(0x1ef),'datacenterSecond':_0x300dd7(0x125),'key':'G888CWKP2Y06X','keyFree':_0x300dd7(0x111)}};},_0x194cc1=>{const _0x12b478=a0_0x5814;_0x194cc1[_0x12b478(0x255)]=require('dotenv');},(_0x571c20,_0x201d6f)=>{Object['defineProperty'](_0x201d6f,'__esModule',{'value':!0x0});},function(_0x4682a6,_0x4af114,_0x45cea8){const _0x3c5466=a0_0x5814;var _0x56cdfa,_0xfa40db=this&&this['__decorate']||function(_0x18180e,_0x3ba1d7,_0x3f1d01,_0x7613a4){const _0x2dacec=a0_0x5814;var _0xa03a79,_0xe5f717=arguments['length'],_0x3804b6=_0xe5f717<0x3?_0x3ba1d7:null===_0x7613a4?_0x7613a4=Object['getOwnPropertyDescriptor'](_0x3ba1d7,_0x3f1d01):_0x7613a4;if(_0x2dacec(0x1bb)==typeof Reflect&&_0x2dacec(0x379)==typeof Reflect['decorate'])_0x3804b6=Reflect['decorate'](_0x18180e,_0x3ba1d7,_0x3f1d01,_0x7613a4);else{for(var _0x30d215=_0x18180e['length']-0x1;_0x30d215>=0x0;_0x30d215--)(_0xa03a79=_0x18180e[_0x30d215])&&(_0x3804b6=(_0xe5f717<0x3?_0xa03a79(_0x3804b6):_0xe5f717>0x3?_0xa03a79(_0x3ba1d7,_0x3f1d01,_0x3804b6):_0xa03a79(_0x3ba1d7,_0x3f1d01))||_0x3804b6);}return _0xe5f717>0x3&&_0x3804b6&&Object['defineProperty'](_0x3ba1d7,_0x3f1d01,_0x3804b6),_0x3804b6;},_0xfdd22e=this&&this['__metadata']||function(_0x4ae22f,_0x142d58){const _0x315b29=a0_0x5814;if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x315b29(0x168)](_0x4ae22f,_0x142d58);};Object['defineProperty'](_0x4af114,'__esModule',{'value':!0x0}),_0x4af114[_0x3c5466(0x2bd)]=void 0x0;const _0x3e8421=_0x45cea8(0x2),_0x4ebf34=_0x45cea8(0xf),_0x18a120=_0x45cea8(0x15);let _0x16e0d8=class{constructor(_0x59f529){const _0x3754a0=_0x3c5466;this['redisService']=_0x59f529,this['logger']=new _0x3e8421[(_0x3754a0(0x3c7))]('DeviceLockService'),this['REDIS_LOCK_PREFIX']='device:lock:',this['DEFAULT_LOCK_TTL']=0x927c0;}async['acquireLock'](_0x349fb6,_0x53bb26,_0x39832d,_0x334a9e=this['DEFAULT_LOCK_TTL']){const _0x2e8851=_0x3c5466;try{const _0x66e85a=''+this['REDIS_LOCK_PREFIX']+_0x349fb6,_0xa6c9bc=''+this[_0x2e8851(0x3b8)]+_0x349fb6+_0x2e8851(0x279),_0x747913=(0x0,_0x18a120['randomUUID'])(),_0x3de724=Math['ceil'](_0x334a9e/0x3e8),_0x5e3e1c=await this['redisService']['getClient']();if('OK'===await _0x5e3e1c['set'](_0x66e85a,_0x747913,'EX',_0x3de724,'NX')){const _0x307bd3={'deviceId':_0x349fb6,'lockType':_0x53bb26,'lockedAt':Date[_0x2e8851(0x114)](),'lockedBy':_0x39832d,'ttl':_0x334a9e};return await this[_0x2e8851(0x3e1)]['setex'](_0xa6c9bc,_0x3de724,JSON['stringify'](_0x307bd3)),this['logger']['log']('['+_0x349fb6+_0x2e8851(0x244)+_0x53bb26+'\x20lock\x20('+_0x39832d+')\x20with\x20lockId\x20'+_0x747913),!0x0;}return this['logger']['warn']('['+_0x349fb6+']\x20Device\x20is\x20already\x20locked,\x20cannot\x20acquire\x20lock'),!0x1;}catch(_0x230dc0){return this['logger']['error']('['+_0x349fb6+']\x20Error\x20acquiring\x20lock:\x20'+_0x230dc0['message']),!0x1;}}async[_0x3c5466(0x23b)](_0x4483e7){const _0x640092=_0x3c5466;try{const _0x25dfb6=''+this['REDIS_LOCK_PREFIX']+_0x4483e7,_0x3d207b=''+this['REDIS_LOCK_PREFIX']+_0x4483e7+':meta',_0x2a31b2=await this['redisService']['getClient'](),_0x590f98=await _0x2a31b2['get'](_0x25dfb6);if(!_0x590f98)return await this['redisService']['del'](_0x3d207b),void this['logger'][_0x640092(0x181)]('['+_0x4483e7+_0x640092(0x11c));0x1===await _0x2a31b2[_0x640092(0x180)]('\x0aif\x20redis.call(\x22GET\x22,\x20KEYS[1])\x20==\x20ARGV[1]\x20then\x0a\x20\x20redis.call(\x22DEL\x22,\x20KEYS[2])\x0a\x20\x20return\x20redis.call(\x22DEL\x22,\x20KEYS[1])\x0aelse\x0a\x20\x20return\x200\x0aend\x0a',0x2,_0x25dfb6,_0x3d207b,_0x590f98)?this[_0x640092(0x22a)]['log']('['+_0x4483e7+_0x640092(0x3d1)+_0x590f98+')'):this['logger']['warn']('['+_0x4483e7+_0x640092(0x3d2)+_0x590f98+')');}catch(_0x344d83){this['logger']['error']('['+_0x4483e7+']\x20Error\x20releasing\x20lock:\x20'+_0x344d83[_0x640092(0x36b)],_0x344d83['stack']);}}async[_0x3c5466(0x277)](_0x5bbb72){const _0x17d7c9=_0x3c5466;try{const _0x58e49a=''+this[_0x17d7c9(0x3b8)]+_0x5bbb72,_0x19a172=await this['redisService']['get'](_0x58e49a);if(!_0x19a172)return null;const _0x59b6d3=''+this['REDIS_LOCK_PREFIX']+_0x5bbb72+_0x17d7c9(0x279),_0x17adc0=await this[_0x17d7c9(0x3e1)][_0x17d7c9(0x3ca)](_0x59b6d3);return _0x17adc0?{...JSON['parse'](_0x17adc0),'lockId':_0x19a172}:{'deviceId':_0x5bbb72,'lockType':'transfer','lockedAt':Date['now'](),'lockedBy':'unknown','ttl':this['DEFAULT_LOCK_TTL'],'lockId':_0x19a172};}catch(_0x2e7d1a){return this['logger']['error']('['+_0x5bbb72+']\x20Error\x20getting\x20lock:\x20'+_0x2e7d1a['message']),null;}}async['isLocked'](_0x5b3179,_0x1b66a2){const _0xf6b8fd=_0x3c5466;try{const _0x13dea2=''+this[_0xf6b8fd(0x3b8)]+_0x5b3179;if(!await this['redisService'][_0xf6b8fd(0x406)](_0x13dea2))return!0x1;const _0xa30d3a=await this[_0xf6b8fd(0x277)](_0x5b3179);return!(!_0xa30d3a||_0x1b66a2&&_0xa30d3a['lockType']===_0x1b66a2);}catch(_0x45a18d){return this['logger']['error']('['+_0x5b3179+_0xf6b8fd(0x209)+_0x45a18d['message']),!0x1;}}async['extendLock'](_0x2a30cd,_0x2af556){const _0x32b822=_0x3c5466;try{if(!await this['getLock'](_0x2a30cd))return!0x1;const _0x1bd3fd=''+this[_0x32b822(0x3b8)]+_0x2a30cd,_0x43cdff=''+this['REDIS_LOCK_PREFIX']+_0x2a30cd+_0x32b822(0x279),_0x4e63c6=await this['redisService']['getClient'](),_0x209f41=await _0x4e63c6['ttl'](_0x1bd3fd);if(_0x209f41<=0x0)return!0x1;const _0x5ea8ae=Math[_0x32b822(0x3a3)]((0x3e8*_0x209f41+_0x2af556)/0x3e8);return 0x1===await _0x4e63c6['expire'](_0x1bd3fd,_0x5ea8ae)&&(await this['redisService'][_0x32b822(0x360)](_0x43cdff,_0x5ea8ae),this['logger']['log']('['+_0x2a30cd+']\x20Extended\x20lock\x20by\x20'+_0x2af556+'ms'),!0x0);}catch(_0x3fc499){return this[_0x32b822(0x22a)][_0x32b822(0x3e9)]('['+_0x2a30cd+']\x20Error\x20extending\x20lock:\x20'+_0x3fc499['message']),!0x1;}}async['releaseLockByType'](_0x4b67ee,_0x12c80d){const _0x411edb=_0x3c5466;try{const _0x54f917=await this['getLock'](_0x4b67ee);if(!_0x54f917)return!0x1;if(_0x54f917['lockType']!==_0x12c80d)return!0x1;const _0x2c037a=''+this['REDIS_LOCK_PREFIX']+_0x4b67ee,_0x3d3f53=''+this['REDIS_LOCK_PREFIX']+_0x4b67ee+':meta';return await this['redisService']['del'](_0x2c037a),await this['redisService']['del'](_0x3d3f53),this[_0x411edb(0x22a)][_0x411edb(0x19e)]('['+_0x4b67ee+']\x20Force\x20released\x20'+_0x12c80d+'\x20lock'),!0x0;}catch(_0x2c571a){return this['logger']['error']('['+_0x4b67ee+_0x411edb(0x1c8)+_0x12c80d+'\x20lock:\x20'+_0x2c571a['message']),!0x1;}}async['hasAnyLockKeys'](){try{const _0x3d0169=this['REDIS_LOCK_PREFIX']+'*';return(await this['redisService']['keys'](_0x3d0169))['filter'](_0x1e9ef1=>!_0x1e9ef1['endsWith'](':meta'))['length'];}catch(_0x57805b){return this['logger']['error']('Error\x20getting\x20all\x20lock\x20keys:\x20'+_0x57805b['message']),0x0;}}};_0x4af114['DeviceLockService']=_0x16e0d8,_0x4af114['DeviceLockService']=_0x16e0d8=_0xfa40db([(0x0,_0x3e8421['Injectable'])(),_0xfdd22e('design:paramtypes',[_0x3c5466(0x379)==typeof(_0x56cdfa=void 0x0!==_0x4ebf34['RedisService']&&_0x4ebf34[_0x3c5466(0x310)])?_0x56cdfa:Object])],_0x16e0d8);},_0x416311=>{_0x416311['exports']=require('crypto');},_0x5a7d55=>{_0x5a7d55['exports']=require('lodash');},function(_0x3db28c,_0x4d189d,_0x851af9){const _0x5dea5e=a0_0x5814;var _0x34c4ff,_0xfe3df7,_0x40d19d,_0x2663b3,_0x310b8c,_0x376bbc=this&&this[_0x5dea5e(0x21a)]||function(_0x515b70,_0x22831a,_0x38ca78,_0x31a85a){var _0x39069f,_0x3a7751=arguments['length'],_0x3ff6cf=_0x3a7751<0x3?_0x22831a:null===_0x31a85a?_0x31a85a=Object['getOwnPropertyDescriptor'](_0x22831a,_0x38ca78):_0x31a85a;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x3ff6cf=Reflect['decorate'](_0x515b70,_0x22831a,_0x38ca78,_0x31a85a);else{for(var _0x63eb63=_0x515b70['length']-0x1;_0x63eb63>=0x0;_0x63eb63--)(_0x39069f=_0x515b70[_0x63eb63])&&(_0x3ff6cf=(_0x3a7751<0x3?_0x39069f(_0x3ff6cf):_0x3a7751>0x3?_0x39069f(_0x22831a,_0x38ca78,_0x3ff6cf):_0x39069f(_0x22831a,_0x38ca78))||_0x3ff6cf);}return _0x3a7751>0x3&&_0x3ff6cf&&Object['defineProperty'](_0x22831a,_0x38ca78,_0x3ff6cf),_0x3ff6cf;},_0x33839a=this&&this[_0x5dea5e(0x16e)]||function(_0x46b2e6,_0xd85edf){const _0xd9ac84=_0x5dea5e;if('object'==typeof Reflect&&_0xd9ac84(0x379)==typeof Reflect['metadata'])return Reflect['metadata'](_0x46b2e6,_0xd85edf);},_0x47542f=this&&this['__param']||function(_0x34698e,_0x57b29b){return function(_0x21fde1,_0xe1924a){_0x57b29b(_0x21fde1,_0xe1924a,_0x34698e);};};Object['defineProperty'](_0x4d189d,'__esModule',{'value':!0x0}),_0x4d189d['BaseBankService']=void 0x0;const _0x21e0fa=_0x851af9(0x2),_0x1a4da2=_0x851af9(0xe),_0x49a08a=_0x851af9(0x13),_0x2ed0b2=_0x851af9(0xd),_0x32eac3=_0x851af9(0x18),_0x17176f=_0x851af9(0x19),_0x39fbe2=_0x851af9(0x1a),_0x1cc1e8=_0x851af9(0x4),_0x5d16ea=_0x851af9(0x1b),_0x4fed63=_0x851af9(0x1e),_0x3c7e61=_0x851af9(0x21),_0x4f7f20=_0x851af9(0x22),_0x4d8b29=_0x851af9(0x20);let _0x5b48db=_0x34c4ff=class{constructor(_0x1bfa24,_0x394ef4,_0x5edd44,_0x1b96eb){const _0x46923f=_0x5dea5e;this['wsService']=_0x1bfa24,this['deviceService']=_0x394ef4,this['ocrService']=_0x5edd44,this['imagePreprocessingService']=_0x1b96eb,this[_0x46923f(0x1c1)]='C:/EasyData',this['baseTransactionExecutionFolder']='C:/EasyTrx',this['cleanupFolder']=async(_0x4a2af8,_0x54f59f)=>{const _0x15001f=_0x46923f;if((0x0,_0x17176f['existsSync'])(_0x4a2af8))try{await(0x0,_0x39fbe2['rm'])(_0x4a2af8,{'recursive':!0x0,'force':!0x0});}catch(_0x263b1c){this['logger'][_0x15001f(0x181)]('['+_0x54f59f+_0x15001f(0x166)+_0x263b1c['message']);}},this['logger']=new _0x21e0fa['Logger']('BaseBankService'),_0x34c4ff[_0x46923f(0x2dc)](this['baseTransactionFolderPath'],this['logger']),_0x34c4ff['createTransactionFolder'](this['baseTransactionExecutionFolder'],this['logger']);}static['createTransactionFolder'](_0x36346f,_0x2926bf){const _0x39f781=_0x5dea5e;if(!_0x34c4ff[_0x39f781(0x335)]){if(_0x34c4ff['folderCreationInProgress']){let _0x10bc64=0x0;const _0x5c60e1=0xa;for(;_0x34c4ff['folderCreationInProgress']&&_0x10bc64<_0x5c60e1;){_0x10bc64++;const _0x11bc65=Date['now']();for(;Date[_0x39f781(0x114)]()-_0x11bc65<0xa;);}if(_0x34c4ff['folderCreated']||(0x0,_0x17176f['existsSync'])(_0x36346f))return void(_0x34c4ff[_0x39f781(0x335)]=!0x0);}try{_0x34c4ff['folderCreationInProgress']=!0x0,(0x0,_0x17176f[_0x39f781(0x1a0)])(_0x36346f)?_0x2926bf[_0x39f781(0x181)]('Base\x20folder\x20already\x20exists:\x20'+_0x36346f):((0x0,_0x17176f['mkdirSync'])(_0x36346f,{'recursive':!0x0}),_0x2926bf['log'](_0x39f781(0x3aa)+_0x36346f)),_0x34c4ff['folderCreated']=!0x0;}catch(_0x5a4049){'EEXIST'!==_0x5a4049['code']?_0x2926bf[_0x39f781(0x3e9)]('Failed\x20to\x20create\x20base\x20folder\x20'+_0x36346f+':\x20'+_0x5a4049['message']):(_0x34c4ff['folderCreated']=!0x0,_0x2926bf[_0x39f781(0x181)]('Base\x20folder\x20already\x20exists\x20(created\x20by\x20another\x20process):\x20'+_0x36346f));}finally{_0x34c4ff['folderCreationInProgress']=!0x1;}}}[_0x5dea5e(0x2bf)](){const _0x3625eb=_0x5dea5e;return this[_0x3625eb(0x308)];}async['killApp'](_0x5a9eda){const _0x24c0d6=_0x5dea5e;this[_0x24c0d6(0x22a)][_0x24c0d6(0x19e)]('['+_0x5a9eda+']\x20Killing\x20'+this['BANK_CODE']+'\x20app'),await this['wsService']['killApp'](_0x5a9eda,this['BUNDLE_ID']);}async['clickWithTransition'](_0x39294b,_0x562a7a,_0x1a4701,_0x466e3a,_0x5da33e=''){const _0x4b6528=_0x5dea5e;await this['wsService']['click'](_0x39294b,_0x562a7a,_0x1a4701,0.2),_0x5da33e&&this['logger'][_0x4b6528(0x19e)](_0x5da33e),await(0x0,_0x32eac3['sleep'])(_0x466e3a);}async['verifyScreenState'](_0x13dc52,_0x277ccf){const _0x178a46=_0x5dea5e,{expectedTexts:_0x406a3e=[],unexpectedTexts:_0x34e44a=[],timeout:_0x15412a=0x7530,pollInterval:_0x5b4e28=0x1f4,roi:_0x5e84bb,fieldType:_0x38e23a='full',preprocess:_0x2083de}=_0x277ccf,_0x58b96e=Date['now']();let _0x5a9072=0x0;const _0x1e5395=(0x0,_0x1cc1e8[_0x178a46(0x19c)])(this['baseTransactionExecutionFolder'],_0x178a46(0x201)+_0x13dc52),_0x1f5ab9=_0x5e84bb?'ROI:\x20x='+_0x5e84bb['x']+_0x178a46(0x259)+_0x5e84bb['y']+',\x20w='+_0x5e84bb['width']+_0x178a46(0x348)+_0x5e84bb['height']:'Full\x20screen';this['logger'][_0x178a46(0x181)]('['+_0x13dc52+']\x20Starting\x20screen\x20verification.\x20Expected:\x20['+_0x406a3e['join'](',\x20')+'],\x20Unexpected:\x20['+_0x34e44a[_0x178a46(0x19c)](',\x20')+'],\x20'+_0x1f5ab9+',\x20Timeout:\x20'+_0x15412a+'ms,\x20Poll:\x20'+_0x5b4e28+'ms');try{for(await this['cleanupFolder'](_0x1e5395,_0x13dc52),await(0x0,_0x39fbe2['mkdir'])(_0x1e5395,{'recursive':!0x0});Date['now']()-_0x58b96e<_0x15412a;){_0x5a9072++;let _0x1f1855=null;try{const _0x20b8ec=Date['now']();await this['wsService']['captureScreen'](_0x13dc52,{'folderPath':_0x1e5395});let _0x5905ea=null;const _0x3ae774=0x5;let _0x44150b=0x0;for(;_0x44150b<_0x3ae774&&!_0x5905ea;){_0x44150b++,await(0x0,_0x32eac3['sleep'])(0x1f4);try{if(!(0x0,_0x17176f['existsSync'])(_0x1e5395))continue;const _0x27cacf=(await(0x0,_0x39fbe2[_0x178a46(0x113)])(_0x1e5395))['filter'](_0x332c14=>_0x332c14[_0x178a46(0x206)](_0x178a46(0x13b)));if(0x0===_0x27cacf['length'])continue;let _0x3dde7d=0x0;Date['now']();for(const _0xeac141 of _0x27cacf){const _0x2dd5c5=(0x0,_0x1cc1e8['join'])(_0x1e5395,_0xeac141);try{const _0x5d22b7=await(0x0,_0x39fbe2['stat'])(_0x2dd5c5);if(0x0===_0x5d22b7['size'])continue;_0x5d22b7['mtimeMs']>=_0x20b8ec-0x7d0&&_0x5d22b7['mtimeMs']>_0x3dde7d&&(_0x3dde7d=_0x5d22b7[_0x178a46(0x254)],_0x5905ea=_0x2dd5c5);}catch(_0x237f23){continue;}}}catch(_0x47eec0){continue;}}if(!_0x5905ea){await(0x0,_0x32eac3[_0x178a46(0x404)])(_0x5b4e28);continue;}_0x1f1855=_0x5905ea;const _0x2a8156=[..._0x406a3e,..._0x34e44a],_0x3884ba=await this['ocrService']['fastScreenOCR'](_0x1f1855,_0x2a8156,{'fieldType':_0x5e84bb?'singleLine':_0x38e23a,'customROI':_0x5e84bb,'preprocess':_0x2083de});if(!_0x3884ba||!_0x3884ba['found']){await(0x0,_0x32eac3[_0x178a46(0x404)])(_0x5b4e28);continue;}const _0x286885=0x0===_0x406a3e['length']||_0x406a3e['some'](_0x236e83=>_0x3884ba['matchedTexts']['includes'](_0x236e83)),_0x1af57c=_0x34e44a['some'](_0x2ca46c=>_0x3884ba['matchedTexts']['includes'](_0x2ca46c));if(_0x286885&&!_0x1af57c){await this['cleanupFolder'](_0x1e5395,_0x13dc52);const _0x27c092=Date['now']()-_0x58b96e,_0x3b6ddc=_0x3884ba[_0x178a46(0x285)]?.[_0x178a46(0x38f)]||0x0,_0x36796d=_0x5e84bb?_0x178a46(0x2cd)+_0x5e84bb['x']+','+_0x5e84bb['y']+'\x20'+_0x5e84bb['width']+'x'+_0x5e84bb[_0x178a46(0x177)]+')':'';return this['logger']['log']('['+_0x13dc52+']\x20Screen\x20verified\x20successfully\x20after\x20'+_0x27c092+'ms\x20('+_0x5a9072+_0x178a46(0x188)+_0x3b6ddc+'ms)'+_0x36796d+'.\x20Matched:\x20['+_0x3884ba['matchedTexts']['join'](',\x20')+']'),!0x0;}if(_0x5a9072%0x5==0x0&&this['logger']['debug']('['+_0x13dc52+']\x20Screen\x20not\x20matched\x20yet\x20(attempt\x20'+_0x5a9072+').\x20Matched\x20texts:\x20['+_0x3884ba[_0x178a46(0x23a)]['join'](',\x20')+'],\x20Expected:\x20['+_0x406a3e['join'](',\x20')+']'),_0x1f1855)try{await(0x0,_0x39fbe2[_0x178a46(0x34c)])(_0x1f1855);}catch{}await(0x0,_0x32eac3['sleep'])(_0x5b4e28);}catch(_0x54aa4a){this['logger']['debug']('['+_0x13dc52+']\x20Error\x20verifying\x20screen\x20(attempt\x20'+_0x5a9072+'):\x20'+_0x54aa4a['message']+',\x20retrying...'),await(0x0,_0x32eac3[_0x178a46(0x404)])(_0x5b4e28);}}await this[_0x178a46(0x33c)](_0x1e5395,_0x13dc52);const _0x2507a9=Date[_0x178a46(0x114)]()-_0x58b96e;return this['logger']['warn']('['+_0x13dc52+']\x20Screen\x20verification\x20timeout\x20after\x20'+_0x2507a9+'ms\x20('+_0x5a9072+'\x20attempts).\x20Expected:\x20['+_0x406a3e['join'](',\x20')+']'),!0x1;}catch(_0x5a41df){throw await this['cleanupFolder'](_0x1e5395,_0x13dc52),_0x5a41df;}}async['getLatestImagePath'](_0x3e8c61,_0x10ac38=0x2710,_0x5d05c6=0x1f4){const _0xd92625=_0x5dea5e;if(!_0x3e8c61)return this['logger']['warn'](_0xd92625(0x2fe)),null;const _0x5c9cc3=Date['now']();let _0x31b0e8=0x0;for(this['logger']['debug']('Scanning\x20folder\x20for\x20bill\x20image:\x20'+_0x3e8c61+',\x20timeout:\x20'+_0x10ac38+_0xd92625(0x1ab)+_0x5d05c6+'ms');Date['now']()-_0x5c9cc3<_0x10ac38;){_0x31b0e8++;try{if(!(0x0,_0x17176f['existsSync'])(_0x3e8c61)){await(0x0,_0x32eac3['sleep'])(_0x5d05c6);continue;}const _0x44777d=await(0x0,_0x39fbe2['readdir'])(_0x3e8c61);if(0x0===_0x44777d[_0xd92625(0x2be)]){await(0x0,_0x32eac3['sleep'])(_0x5d05c6);continue;}const _0x4c9218=(await Promise['all'](_0x44777d['map'](async _0x2588a1=>{try{const _0x140b62=(0x0,_0x1cc1e8['join'])(_0x3e8c61,_0x2588a1),_0x1a00f1=await(0x0,_0x39fbe2['stat'])(_0x140b62);return{'fullPath':_0x140b62,'mtime':_0x1a00f1['mtimeMs'],'size':_0x1a00f1['size']};}catch(_0x42f318){return null;}})))['filter'](_0x3f1e79=>null!==_0x3f1e79&&_0x3f1e79['size']>0x0);if(0x0===_0x4c9218['length']){await(0x0,_0x32eac3[_0xd92625(0x404)])(_0x5d05c6);continue;}_0x4c9218['sort']((_0x1ced61,_0x51e2bc)=>_0x51e2bc['mtime']-_0x1ced61['mtime']);const _0x597559=_0x4c9218[0x0]['fullPath'],_0x5a25fd=Date[_0xd92625(0x114)]()-_0x5c9cc3;return this['logger']['log'](_0xd92625(0x3f8)+_0x597559+_0xd92625(0x163)+_0x5a25fd+_0xd92625(0x240)+_0x31b0e8+'\x20attempts)'),_0x597559;}catch(_0x24136f){this['logger']['debug']('Error\x20scanning\x20folder\x20'+_0x3e8c61+'\x20(attempt\x20'+_0x31b0e8+'):\x20'+_0x24136f['message']+',\x20retrying...'),await(0x0,_0x32eac3[_0xd92625(0x404)])(_0x5d05c6);}}const _0x1a743a=Date[_0xd92625(0x114)]()-_0x5c9cc3;return this[_0xd92625(0x22a)][_0xd92625(0x375)](_0xd92625(0x1b3)+_0x3e8c61+'\x20after\x20'+_0x1a743a+_0xd92625(0x240)+_0x31b0e8+_0xd92625(0x3e7)),null;}async['detectScreenByHint'](_0x479bc7,_0x4519fc,_0xf0260e){const _0x1c29af=_0x5dea5e,_0x306d7e=(0x0,_0x1cc1e8[_0x1c29af(0x19c)])(this['baseTransactionExecutionFolder'],'scan_'+_0x479bc7),_0x3695da=_0x4519fc['map'](_0x5ebec2=>({'name':_0x5ebec2[_0x1c29af(0x22f)],'hint':(0x0,_0x4d8b29[_0x1c29af(0x210)])(_0x5ebec2[_0x1c29af(0x1e4)])})),_0x5f2a1d=Date['now']();let _0x2a977a=0x0;const {roi:_0x377e1e,timeout:_0x1cefc4,pollInterval:_0x2478a6}=_0xf0260e,_0x50d9b9=_0x377e1e?_0x1c29af(0x329)+_0x377e1e['x']+',\x20y='+_0x377e1e['y']+',\x20w='+_0x377e1e['width']+',\x20h='+_0x377e1e['height']:'Full\x20screen';this['logger']['debug']('['+_0x479bc7+']\x20Start\x20detecting\x20screen.\x20Screen:\x20['+_0x4519fc['map'](_0x14cd7f=>_0x14cd7f['name'])['join'](_0x1c29af(0x3bc))+'],\x20'+_0x50d9b9+',\x20Timeout:\x20'+_0x1cefc4+'ms,\x20Poll:\x20'+_0x2478a6+'ms');try{for(await this['cleanupFolder'](_0x306d7e,_0x479bc7),await(0x0,_0x39fbe2['mkdir'])(_0x306d7e,{'recursive':!0x0});Date['now']()-_0x5f2a1d<_0x1cefc4;){_0x2a977a++;let _0x50821c=null;try{const _0xa66dee=Date['now']();await this['wsService'][_0x1c29af(0x1bf)](_0x479bc7,{'folderPath':_0x306d7e});let _0x4e9b08=null;const _0x405930=0x5;let _0x462606=0x0;for(;_0x462606<_0x405930&&!_0x4e9b08;){_0x462606++,await(0x0,_0x32eac3['sleep'])(0x1f4);try{if(!(0x0,_0x17176f[_0x1c29af(0x1a0)])(_0x306d7e))continue;const _0x400ca4=(await(0x0,_0x39fbe2[_0x1c29af(0x113)])(_0x306d7e))['filter'](_0x2b3087=>_0x2b3087['endsWith'](_0x1c29af(0x13b)));if(0x0===_0x400ca4['length'])continue;let _0x58d4b1=0x0;for(const _0x4f1613 of _0x400ca4){const _0x19bdf7=(0x0,_0x1cc1e8['join'])(_0x306d7e,_0x4f1613);try{const _0x5847dc=await(0x0,_0x39fbe2[_0x1c29af(0x301)])(_0x19bdf7);if(0x0===_0x5847dc['size'])continue;_0x5847dc['mtimeMs']>=_0xa66dee-0x7d0&&_0x5847dc['mtimeMs']>_0x58d4b1&&(_0x58d4b1=_0x5847dc[_0x1c29af(0x254)],_0x4e9b08=_0x19bdf7);}catch(_0x20d0b1){continue;}}}catch(_0xda5c33){continue;}}if(!_0x4e9b08){await(0x0,_0x32eac3['sleep'])(_0x2478a6);continue;}const _0xb3364e=await(0x0,_0x39fbe2[_0x1c29af(0x314)])(_0x4e9b08),_0x2ca7af=await this['imagePreprocessingService'][_0x1c29af(0x265)](_0xb3364e,_0xf0260e[_0x1c29af(0x32c)]?_0xf0260e['roi']:{'x':0x0,'y':0x0,'width':0x1,'height':0x1},void 0x0,_0xf0260e['preprocess']),_0x428429=await this['ocrService']['recognizeFromBuffer'](_0x2ca7af['buffer']);if(!_0x428429[_0x1c29af(0x3c4)]){await(0x0,_0x32eac3['sleep'])(_0x2478a6);continue;}const _0x31daf4=(0x0,_0x4d8b29['removeVietnameseTones'])(_0x428429[_0x1c29af(0x3c4)]),_0x3a2159=_0x3695da['find'](_0x19dbe7=>_0x31daf4['includes'](_0x19dbe7['hint']));if(!_0x3a2159){await(0x0,_0x32eac3['sleep'])(_0x2478a6);continue;}if(_0x50821c)try{await(0x0,_0x39fbe2['unlink'])(_0x50821c);}catch{}return _0x3a2159;}catch(_0x23ebd8){this[_0x1c29af(0x22a)]['debug']('['+_0x479bc7+']\x20Error\x20verifying\x20screen\x20(attempt\x20'+_0x2a977a+_0x1c29af(0x2c0)+_0x23ebd8['message']+',\x20retrying...'),await(0x0,_0x32eac3['sleep'])(_0x2478a6);}}await this['cleanupFolder'](_0x306d7e,_0x479bc7);const _0x1253d1=Date[_0x1c29af(0x114)]()-_0x5f2a1d;return this['logger'][_0x1c29af(0x375)]('['+_0x479bc7+']\x20Screen\x20verification\x20timeout\x20after\x20'+_0x1253d1+'ms\x20('+_0x2a977a+_0x1c29af(0x2e1)+_0x4519fc['join'](_0x1c29af(0x3bc))+'],'),null;}catch(_0x2c0eef){throw await this['cleanupFolder'](_0x306d7e,_0x479bc7),_0x2c0eef;}}async['clickAndWaitForScreen'](_0x59cbad,_0x40994d,_0x4c89fd,_0x1d33f9,_0x42fdd9){return await this['wsService']['click'](_0x59cbad,_0x40994d,_0x4c89fd,0.2),_0x42fdd9&&this['logger']['log'](_0x42fdd9),await this['verifyScreenState'](_0x59cbad,_0x1d33f9);}async['swipeAndWaitForScreen'](_0x4ebc02,_0x136be9,_0x254935,_0x424841){const _0x1f0483=_0x5dea5e;for(let _0xd4e6ab=0x1;_0xd4e6ab<=0x3;_0xd4e6ab++){if(await this['wsService'][_0x1f0483(0x3eb)](_0x4ebc02,_0x136be9),await(0x0,_0x32eac3['sleep'])(0x320),_0x424841&&0x1===_0xd4e6ab&&this[_0x1f0483(0x22a)]['log'](_0x424841),await this['verifyScreenState'](_0x4ebc02,{..._0x254935,'timeout':0xbb8}))return _0xd4e6ab>0x1&&this[_0x1f0483(0x22a)][_0x1f0483(0x19e)]('['+_0x4ebc02+']\x20Screen\x20verified\x20after\x20'+_0xd4e6ab+_0x1f0483(0x18d)),!0x0;try{const _0x5df4cd=(0x0,_0x1cc1e8['join'])(this['baseTransactionExecutionFolder'],'scan_'+_0x4ebc02+'_debug');if((0x0,_0x17176f['existsSync'])(_0x5df4cd))try{await(0x0,_0x39fbe2['rm'])(_0x5df4cd,{'recursive':!0x0,'force':!0x0});}catch{}await(0x0,_0x39fbe2[_0x1f0483(0x192)])(_0x5df4cd,{'recursive':!0x0});const _0x4610b6=Date['now']();await this['wsService']['captureScreen'](_0x4ebc02,{'folderPath':_0x5df4cd});let _0x3adb1b=null;const _0x4e1435=0x5;let _0x524c7c=0x0;for(;_0x524c7c<_0x4e1435&&!_0x3adb1b;){_0x524c7c++,await(0x0,_0x32eac3['sleep'])(0x1f4);try{if(!(0x0,_0x17176f[_0x1f0483(0x1a0)])(_0x5df4cd))continue;const _0x9c965f=(await(0x0,_0x39fbe2[_0x1f0483(0x113)])(_0x5df4cd))[_0x1f0483(0x3a9)](_0x3c5ce3=>_0x3c5ce3['endsWith'](_0x1f0483(0x13b)));if(0x0===_0x9c965f['length'])continue;let _0x1a980a=0x0;for(const _0x4b0c3b of _0x9c965f){const _0x3e440e=(0x0,_0x1cc1e8['join'])(_0x5df4cd,_0x4b0c3b);try{const _0x131fde=await(0x0,_0x39fbe2['stat'])(_0x3e440e);_0x131fde[_0x1f0483(0x22e)]>0x0&&_0x131fde['mtimeMs']>=_0x4610b6-0x7d0&&_0x131fde['mtimeMs']>_0x1a980a&&(_0x1a980a=_0x131fde['mtimeMs'],_0x3adb1b=_0x3e440e);}catch{}}}catch{}}if(_0x3adb1b){const {expectedTexts:_0x332b85=[],unexpectedTexts:_0x2f44e5=[],roi:_0x278022,fieldType:_0x39da22='full',preprocess:_0x4fe0e7}=_0x254935,_0x2ae1ab=[..._0x332b85,..._0x2f44e5];let _0x5147ba='',_0x178e8a=[];if(_0x2ae1ab[_0x1f0483(0x2be)]>0x0){const _0x7f5c6=await this[_0x1f0483(0x411)]['fastScreenOCR'](_0x3adb1b,_0x2ae1ab,{'fieldType':_0x278022?'singleLine':_0x39da22,'customROI':_0x278022,'preprocess':_0x4fe0e7});_0x5147ba=_0x7f5c6?.['result']?.['text']||'',_0x178e8a=_0x7f5c6?.['matchedTexts']||[];}else{const _0x13b76f=await this[_0x1f0483(0x411)]['recognizeFromFile'](_0x3adb1b,{'fieldType':_0x278022?'singleLine':_0x39da22,'customROI':_0x278022,'preprocess':_0x4fe0e7});_0x5147ba=_0x13b76f?.['text']||'';}const _0x32c8ed=_0x278022?'\x20ROI:\x20('+_0x278022['x']+','+_0x278022['y']+'\x20'+_0x278022['width']+'x'+_0x278022['height']+')':'';_0x5147ba?this[_0x1f0483(0x22a)]['warn']('['+_0x4ebc02+']\x20Swipe\x20attempt\x20'+_0xd4e6ab+_0x1f0483(0x2cf)+_0x5147ba+'\x22'+(_0x178e8a['length']>0x0?_0x1f0483(0x3ea)+_0x178e8a['join'](',\x20')+']':'')+('\x20|\x20Expected:\x20['+(_0x332b85['join'](',\x20')||_0x1f0483(0x3f5))+']'+_0x32c8ed)):this['logger'][_0x1f0483(0x375)]('['+_0x4ebc02+']\x20Swipe\x20attempt\x20'+_0xd4e6ab+'/3\x20-\x20OCR\x20found\x20no\x20text'+_0x32c8ed);}else this['logger']['warn']('['+_0x4ebc02+']\x20Swipe\x20attempt\x20'+_0xd4e6ab+'/3\x20-\x20Could\x20not\x20find\x20screenshot\x20file\x20after\x20'+_0x524c7c+_0x1f0483(0x143));try{await(0x0,_0x39fbe2['rm'])(_0x5df4cd,{'recursive':!0x0,'force':!0x0});}catch{}}catch(_0x301202){this[_0x1f0483(0x22a)]['debug']('['+_0x4ebc02+']\x20Failed\x20to\x20debug\x20OCR:\x20'+_0x301202['message']);}_0xd4e6ab<0x3&&this[_0x1f0483(0x22a)]['debug']('['+_0x4ebc02+']\x20Screen\x20not\x20detected\x20after\x20swipe\x20(attempt\x20'+_0xd4e6ab+'/3),\x20retrying...');}return this['logger']['warn']('['+_0x4ebc02+_0x1f0483(0x331)),!0x1;}async['createBillFolder'](_0x4e5f8c){const _0x1062ea=_0x5dea5e,_0x24d177=(0x0,_0x1cc1e8['resolve'])(this[_0x1062ea(0x1c1)],_0x4e5f8c);await(0x0,_0x39fbe2['mkdir'])(_0x24d177,{'recursive':!0x0});}async[_0x5dea5e(0x1bf)](_0x1c50b7,_0x3e363f){const _0x4d5573=_0x5dea5e;this['logger']['log']('Capturing\x20screen\x20on\x20device\x20'+_0x1c50b7+_0x4d5573(0x208)+_0x3e363f['folderPath']);const _0x5997ab=(0x0,_0x1cc1e8['resolve'])(this['baseTransactionFolderPath'],_0x3e363f['folderPath']);await this['wsService'][_0x4d5573(0x1bf)](_0x1c50b7,{..._0x3e363f,'folderPath':_0x5997ab}),await(0x0,_0x32eac3['sleep'])(0x1f4);}async[_0x5dea5e(0x290)](_0x2fa926,_0xb1f792=0x2710,_0x41c7d7=0x1f4){const _0x408ea6=_0x5dea5e;if(!_0x2fa926)return this[_0x408ea6(0x22a)]['warn']('Folder\x20path\x20is\x20null\x20or\x20empty'),null;const _0x4310ac=(0x0,_0x1cc1e8['join'])(this['baseTransactionFolderPath'],_0x2fa926),_0x37ad59=Date['now']();let _0xc44183=0x0;for(this['logger']['debug']('Scanning\x20folder\x20for\x20bill\x20image:\x20'+_0x2fa926+_0x408ea6(0x1c9)+_0xb1f792+'ms,\x20pollInterval:\x20'+_0x41c7d7+'ms');Date['now']()-_0x37ad59<_0xb1f792;){_0xc44183++;try{if(!(0x0,_0x17176f['existsSync'])(_0x4310ac)){await(0x0,_0x32eac3['sleep'])(_0x41c7d7);continue;}const _0x47651f=await(0x0,_0x39fbe2['readdir'])(_0x4310ac);if(0x0===_0x47651f[_0x408ea6(0x2be)]){await(0x0,_0x32eac3[_0x408ea6(0x404)])(_0x41c7d7);continue;}const _0x4d8e12=(await Promise[_0x408ea6(0x37c)](_0x47651f['map'](async _0x3f8d79=>{const _0x2a8738=_0x408ea6;try{const _0x5f4deb=(0x0,_0x1cc1e8[_0x2a8738(0x19c)])(_0x4310ac,_0x3f8d79),_0x3dcf2b=await(0x0,_0x39fbe2[_0x2a8738(0x301)])(_0x5f4deb);return{'fullPath':_0x5f4deb,'mtime':_0x3dcf2b['mtimeMs'],'size':_0x3dcf2b['size']};}catch(_0x5177f5){return null;}})))[_0x408ea6(0x3a9)](_0x34a781=>null!==_0x34a781&&_0x34a781['size']>0x0);if(0x0===_0x4d8e12[_0x408ea6(0x2be)]){await(0x0,_0x32eac3[_0x408ea6(0x404)])(_0x41c7d7);continue;}_0x4d8e12['sort']((_0x1bca6d,_0x450c41)=>_0x450c41['mtime']-_0x1bca6d['mtime']);const _0x53cbdc=_0x4d8e12[0x0]['fullPath'],_0x497128=Date['now']()-_0x37ad59;return this['logger']['log']('Found\x20latest\x20bill\x20image:\x20'+_0x53cbdc+_0x408ea6(0x163)+_0x497128+'ms\x20('+_0xc44183+'\x20attempts)'),_0x53cbdc;}catch(_0x3d94ef){this['logger']['debug']('Error\x20scanning\x20folder\x20'+_0x2fa926+_0x408ea6(0x1f0)+_0xc44183+'):\x20'+_0x3d94ef['message']+',\x20retrying...'),await(0x0,_0x32eac3['sleep'])(_0x41c7d7);}}const _0x493ce5=Date['now']()-_0x37ad59;return this[_0x408ea6(0x22a)]['warn'](_0x408ea6(0x1b3)+_0x2fa926+'\x20after\x20'+_0x493ce5+_0x408ea6(0x240)+_0xc44183+'\x20attempts)'),null;}async['analyzeTransferBill'](_0x39f833,_0x345f36){const _0x474c4f=_0x5dea5e,{ROI:_0x417548,expectedTexts:_0x215f42}=_0x4f7f20['ANALYZE_BILL_ROI'][_0x39f833],_0x35d8be=await this['getBillImagePath'](_0x345f36['withdrawalCode']);try{if(!_0x35d8be)return this[_0x474c4f(0x22a)]['warn']('No\x20bill\x20image\x20path\x20'+_0x345f36['withdrawalCode']),{'rawPath':null,'analyzedStatus':'na'};const _0x3500ad=await this['ocrService']['fastScreenOCR'](_0x35d8be,_0x215f42,{'fieldType':'singleLine','customROI':_0x417548,'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});return _0x3500ad[_0x474c4f(0x110)]?{'rawPath':_0x35d8be,'analyzedStatus':_0x3500ad['found']?_0x474c4f(0x1e1):_0x474c4f(0x2ab)}:(this['logger']['warn']('No\x20OCR\x20result\x20found\x20for\x20'+_0x345f36['withdrawalCode']),{'rawPath':_0x35d8be,'analyzedStatus':'na'});}catch(_0x1f7b42){return this['logger']['error']('Error\x20analyzing\x20transfer\x20bill:\x20'+_0x1f7b42['message']),{'rawPath':_0x35d8be,'analyzedStatus':'na'};}}async[_0x5dea5e(0x14c)](_0x54873f,_0x11c6ca){const _0x18c20e=_0x5dea5e,_0x17cd92=(0x0,_0x1cc1e8['join'])(this['baseTransactionExecutionFolder'],_0x18c20e(0x1d2));await(0x0,_0x39fbe2[_0x18c20e(0x192)])(_0x17cd92,{'recursive':!0x0});const _0x1a9a58=_0x18c20e(0x162)+_0x11c6ca['withdrawalCode']+'.png',_0x481eea=(0x0,_0x1cc1e8['join'])(_0x17cd92,_0x1a9a58);await(0x0,_0x3c7e61['toFile'])(_0x481eea,_0x11c6ca['transferCode'],{'type':'png','width':0xe4,'margin':0x2}),await(0x0,_0x32eac3['sleep'])(0x1f4),await this['wsService'][_0x18c20e(0x40a)](_0x54873f,_0x481eea,0x1),await(0x0,_0x32eac3['sleep'])(0x1f4),this['logger']['log']('['+_0x54873f+_0x18c20e(0x102)+_0x11c6ca[_0x18c20e(0x34a)]);}};_0x4d189d['BaseBankService']=_0x5b48db,_0x5b48db[_0x5dea5e(0x1d1)]=!0x1,_0x5b48db[_0x5dea5e(0x335)]=!0x1,_0x4d189d['BaseBankService']=_0x5b48db=_0x34c4ff=_0x376bbc([(0x0,_0x21e0fa['Injectable'])(),_0x47542f(0x0,(0x0,_0x21e0fa['Inject'])(_0x2ed0b2['WEBSOCKET_SERVICE'])),_0x33839a('design:paramtypes',[_0x5dea5e(0x379)==typeof(_0xfe3df7=void 0x0!==_0x49a08a['IWebSocketService']&&_0x49a08a['IWebSocketService'])?_0xfe3df7:Object,'function'==typeof(_0x40d19d=void 0x0!==_0x1a4da2['DeviceService']&&_0x1a4da2[_0x5dea5e(0x1f4)])?_0x40d19d:Object,_0x5dea5e(0x379)==typeof(_0x2663b3=void 0x0!==_0x5d16ea[_0x5dea5e(0x123)]&&_0x5d16ea['OCRService'])?_0x2663b3:Object,'function'==typeof(_0x310b8c=void 0x0!==_0x4fed63['ImagePreprocessingService']&&_0x4fed63[_0x5dea5e(0x1a6)])?_0x310b8c:Object])],_0x5b48db);},(_0x3cf6ac,_0x45be6e)=>{const _0x3d6183=a0_0x5814;Object['defineProperty'](_0x45be6e,'__esModule',{'value':!0x0}),_0x45be6e['sleep']=void 0x0,_0x45be6e[_0x3d6183(0x404)]=_0x4a1140=>new Promise(_0x3630eb=>setTimeout(_0x3630eb,_0x4a1140));},_0x2f35c6=>{const _0x570e9c=a0_0x5814;_0x2f35c6[_0x570e9c(0x255)]=require('fs');},_0x5ee798=>{const _0x4d65c0=a0_0x5814;_0x5ee798[_0x4d65c0(0x255)]=require('fs/promises');},function(_0x7ca09c,_0x1d3095,_0x426919){const _0x194772=a0_0x5814;var _0x69154a,_0x37edaf,_0x966157,_0x5e4ecb=this&&this['__decorate']||function(_0x74834b,_0x13cd5b,_0x43a60c,_0x5949b7){const _0x28ce42=a0_0x5814;var _0x2ab5be,_0x1fb6d0=arguments['length'],_0x5e0433=_0x1fb6d0<0x3?_0x13cd5b:null===_0x5949b7?_0x5949b7=Object[_0x28ce42(0x313)](_0x13cd5b,_0x43a60c):_0x5949b7;if(_0x28ce42(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x5e0433=Reflect['decorate'](_0x74834b,_0x13cd5b,_0x43a60c,_0x5949b7);else{for(var _0x5632c3=_0x74834b['length']-0x1;_0x5632c3>=0x0;_0x5632c3--)(_0x2ab5be=_0x74834b[_0x5632c3])&&(_0x5e0433=(_0x1fb6d0<0x3?_0x2ab5be(_0x5e0433):_0x1fb6d0>0x3?_0x2ab5be(_0x13cd5b,_0x43a60c,_0x5e0433):_0x2ab5be(_0x13cd5b,_0x43a60c))||_0x5e0433);}return _0x1fb6d0>0x3&&_0x5e0433&&Object[_0x28ce42(0x2d5)](_0x13cd5b,_0x43a60c,_0x5e0433),_0x5e0433;},_0x44223b=this&&this['__metadata']||function(_0x3b01b6,_0x2ad6bd){const _0x3c5409=a0_0x5814;if(_0x3c5409(0x1bb)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x3c5409(0x168)](_0x3b01b6,_0x2ad6bd);};Object[_0x194772(0x2d5)](_0x1d3095,'__esModule',{'value':!0x0}),_0x1d3095[_0x194772(0x123)]=_0x1d3095[_0x194772(0x136)]=_0x1d3095['ROI']=void 0x0;const _0x5d619f=_0x426919(0x2),_0x288538=_0x426919(0x1a),_0xe07681=_0x426919(0x1c),_0xcf99a1=_0x426919(0x1e),_0x2c0be0=_0x426919(0x20),_0x10b030=_0x426919(0x11);var _0x3337d6=_0x426919(0x1e);Object['defineProperty'](_0x1d3095,'ROI',{'enumerable':!0x0,'get':function(){const _0x3cddaf=_0x194772;return _0x3337d6[_0x3cddaf(0x3d6)];}}),Object[_0x194772(0x2d5)](_0x1d3095,_0x194772(0x136),{'enumerable':!0x0,'get':function(){return _0x3337d6['PreprocessOptions'];}});const _0x2e436d={'crop':{'x':0x0,'y':0x0,'width':0x1,'height':0x1},'psm':0x6,'charWhitelist':void 0x0,'maxWidth':0x4b0};let _0x4da67a=_0x69154a=class{constructor(_0x47892e,_0x151fbe){const _0x11b041=_0x194772;this['workerPoolService']=_0x47892e,this['imagePreprocessingService']=_0x151fbe,this['logger']=new _0x5d619f['Logger'](_0x69154a['name']),this[_0x11b041(0x11a)]={'poolSize':_0x10b030['config']['ocr']['poolSize'],'lang':_0x10b030['config']['ocr']['lang'],'rois':{'full':_0x2e436d,'singleLine':{..._0x2e436d,'psm':0x7},'block':{..._0x2e436d,'psm':0x6}}};}['validateROI'](_0x5949e5){const _0x4f4ce8=_0x194772;return{'x':Math['max'](0x0,Math[_0x4f4ce8(0x17a)](0x1,_0x5949e5['x']||0x0)),'y':Math[_0x4f4ce8(0x343)](0x0,Math['min'](0x1,_0x5949e5['y']||0x0)),'width':Math['max'](0.01,Math['min'](0x1,_0x5949e5[_0x4f4ce8(0x1d4)]||0x1)),'height':Math['max'](0.01,Math[_0x4f4ce8(0x17a)](0x1,_0x5949e5['height']||0x1))};}['getROIConfig'](_0x4525a4){const _0x4cb4a0=_0x194772,_0x5b9a43=this['ocrConfig'][_0x4cb4a0(0x19f)]?.[_0x4525a4]||this[_0x4cb4a0(0x11a)]['rois']?.[_0x4cb4a0(0x2b1)]||_0x2e436d;return{'crop':_0x5b9a43[_0x4cb4a0(0x203)]||_0x2e436d['crop'],'psm':_0x5b9a43[_0x4cb4a0(0x376)]??_0x2e436d['psm'],'charWhitelist':_0x5b9a43[_0x4cb4a0(0x2e5)],'maxWidth':_0x5b9a43[_0x4cb4a0(0x229)]??_0x2e436d[_0x4cb4a0(0x229)]};}async['recognizeFromFile'](_0x38ed1b,_0x38d218={}){const _0x21f041=_0x194772,_0x886224=Date[_0x21f041(0x114)](),_0x5d3105={'decodeImage':0x0,'preprocess':0x0,'ocrRecognize':0x0,'postprocess':0x0};try{const _0x5c1013=Date['now'](),_0x449c36=await(0x0,_0x288538['readFile'])(_0x38ed1b);_0x5d3105['decodeImage']=Date[_0x21f041(0x114)]()-_0x5c1013;const _0x207618=_0x38d218['fieldType']||'full',_0x114345=this['getROIConfig'](_0x207618),_0x5030c0=this['validateROI'](_0x38d218[_0x21f041(0x33f)]||_0x114345['crop']),_0x375e84=Date['now'](),_0x3a7dd7=await this[_0x21f041(0x25e)][_0x21f041(0x265)](_0x449c36,_0x5030c0,_0x114345['maxWidth'],_0x38d218[_0x21f041(0x265)]);_0x5d3105[_0x21f041(0x265)]=Date[_0x21f041(0x114)]()-_0x375e84;const _0x25fddc=Date['now'](),_0x3916fe=await this['workerPoolService']['recognize'](_0x3a7dd7['buffer'],{'psm':_0x114345['psm'],'charWhitelist':_0x114345[_0x21f041(0x2e5)]});_0x5d3105['ocrRecognize']=Date['now']()-_0x25fddc;const _0x1ada58=Date['now'](),_0x2016e8=this['postprocessText'](_0x3916fe[_0x21f041(0x3c4)]);_0x5d3105['postprocess']=Date['now']()-_0x1ada58;const _0x5d3ea6=Date['now']()-_0x886224;return this[_0x21f041(0x356)](_0x38ed1b,_0x207618,_0x5d3ea6,_0x5d3105,_0x3916fe[_0x21f041(0x164)]),{'text':_0x2016e8,'confidence':_0x3916fe['confidence'],'processingTime':_0x5d3ea6,'timingBreakdown':_0x5d3105};}catch(_0x57e4e7){return this['logger'][_0x21f041(0x3e9)]('OCR\x20error\x20for\x20'+_0x38ed1b+':\x20'+_0x57e4e7['message'],_0x57e4e7['stack']),null;}}async['recognizeFromBuffer'](_0x12655f,_0x26e664={}){const _0xe58d5=_0x194772,_0x25e231=Date[_0xe58d5(0x114)](),_0x207442={'decodeImage':0x0,'preprocess':0x0,'ocrRecognize':0x0,'postprocess':0x0};try{_0x207442['decodeImage']=0x0;const _0x21414d=_0x26e664[_0xe58d5(0x10f)]||'full',_0x128515=this['getROIConfig'](_0x21414d),_0x451d0c=this['validateROI'](_0x26e664['customROI']||_0x128515['crop']),_0x392a85=Date[_0xe58d5(0x114)](),_0x31490e=await this['imagePreprocessingService']['preprocess'](_0x12655f,_0x451d0c,_0x128515['maxWidth'],_0x26e664['preprocess']);_0x207442['preprocess']=Date['now']()-_0x392a85;const _0x4ecaee=Date[_0xe58d5(0x114)](),_0x287674=await this[_0xe58d5(0x170)]['recognize'](_0x31490e['buffer'],{'psm':_0x128515[_0xe58d5(0x376)],'charWhitelist':_0x128515[_0xe58d5(0x2e5)]});_0x207442[_0xe58d5(0x316)]=Date['now']()-_0x4ecaee;const _0x2cb971=Date[_0xe58d5(0x114)](),_0x95ff58=this['postprocessText'](_0x287674['text']);_0x207442['postprocess']=Date[_0xe58d5(0x114)]()-_0x2cb971;const _0x5370bc=Date[_0xe58d5(0x114)]()-_0x25e231;return this[_0xe58d5(0x356)]('buffer',_0x21414d,_0x5370bc,_0x207442,_0x287674['confidence']),{'text':_0x95ff58,'confidence':_0x287674[_0xe58d5(0x164)],'processingTime':_0x5370bc,'timingBreakdown':_0x207442};}catch(_0xdb495b){return this[_0xe58d5(0x22a)]['error']('OCR\x20error\x20from\x20buffer:\x20'+_0xdb495b['message'],_0xdb495b['stack']),null;}}async['fastScreenOCR'](_0x53c943,_0x37c6f2,_0xc79fff={}){const _0x3683ed=_0x194772,_0x57f53d=await this['recognizeFromFile'](_0x53c943,{'fieldType':_0xc79fff[_0x3683ed(0x10f)]||'full','customROI':_0xc79fff[_0x3683ed(0x33f)],'preprocess':_0xc79fff['preprocess']});if(!_0x57f53d||!_0x57f53d['text'])return{'found':!0x1,'matchedTexts':[],'result':_0x57f53d};const _0x4b42ce=(0x0,_0x2c0be0['normalizeBankAccountName'])(_0x57f53d['text']),_0x37b636=_0x37c6f2['filter'](_0x1d0549=>_0x4b42ce['includes']((0x0,_0x2c0be0[_0x3683ed(0x271)])(_0x1d0549)));return{'found':_0x37b636['length']>0x0,'matchedTexts':_0x37b636,'result':_0x57f53d};}['postprocessText'](_0x50c001){return _0x50c001['trim']()['replace'](/\s+/g,'\x20')['replace'](/\n{3,}/g,'\x0a\x0a');}['logTimingBreakdown'](_0x590706,_0x4b07c1,_0x3c650d,_0x496eb3,_0x144998){const _0x26fd77=_0x194772;['decode='+_0x496eb3[_0x26fd77(0x304)]+'ms','preprocess='+_0x496eb3[_0x26fd77(0x265)]+'ms','ocr='+_0x496eb3['ocrRecognize']+'ms','postprocess='+_0x496eb3['postprocess']+'ms']['join'](_0x26fd77(0x402)),_0x3c650d>0x3e8&&this[_0x26fd77(0x22a)]['warn']('⚠️\x20OCR\x20latency\x20exceeded\x20target:\x20'+_0x3c650d+'ms\x20>\x201000ms\x20(p95\x20target)');}};_0x1d3095['OCRService']=_0x4da67a,_0x1d3095[_0x194772(0x123)]=_0x4da67a=_0x69154a=_0x5e4ecb([(0x0,_0x5d619f['Injectable'])(),_0x44223b(_0x194772(0x17c),['function'==typeof(_0x37edaf=void 0x0!==_0xe07681['OCRWorkerPoolService']&&_0xe07681['OCRWorkerPoolService'])?_0x37edaf:Object,_0x194772(0x379)==typeof(_0x966157=void 0x0!==_0xcf99a1[_0x194772(0x1a6)]&&_0xcf99a1[_0x194772(0x1a6)])?_0x966157:Object])],_0x4da67a);},function(_0x5578aa,_0x236f2a,_0x4e9fd9){const _0x400665=a0_0x5814;var _0x1b17e4=this&&this[_0x400665(0x21a)]||function(_0x37f3f3,_0x5ee113,_0x3c17e9,_0x2d5f40){const _0x42461e=_0x400665;var _0x5775bf,_0x59297c=arguments[_0x42461e(0x2be)],_0x2a1802=_0x59297c<0x3?_0x5ee113:null===_0x2d5f40?_0x2d5f40=Object['getOwnPropertyDescriptor'](_0x5ee113,_0x3c17e9):_0x2d5f40;if(_0x42461e(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x2a1802=Reflect['decorate'](_0x37f3f3,_0x5ee113,_0x3c17e9,_0x2d5f40);else{for(var _0x59e7c7=_0x37f3f3['length']-0x1;_0x59e7c7>=0x0;_0x59e7c7--)(_0x5775bf=_0x37f3f3[_0x59e7c7])&&(_0x2a1802=(_0x59297c<0x3?_0x5775bf(_0x2a1802):_0x59297c>0x3?_0x5775bf(_0x5ee113,_0x3c17e9,_0x2a1802):_0x5775bf(_0x5ee113,_0x3c17e9))||_0x2a1802);}return _0x59297c>0x3&&_0x2a1802&&Object[_0x42461e(0x2d5)](_0x5ee113,_0x3c17e9,_0x2a1802),_0x2a1802;},_0x2e13e8=this&&this['__metadata']||function(_0x11f3ad,_0x5c184c){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x11f3ad,_0x5c184c);};Object['defineProperty'](_0x236f2a,'__esModule',{'value':!0x0}),_0x236f2a['OCRWorkerPoolService']=void 0x0;const _0x1113c8=_0x4e9fd9(0x2),_0x2cd685=_0x4e9fd9(0x1d),_0x32bb6d=_0x4e9fd9(0x11);let _0x168a76=class{constructor(){const _0x4edb97=_0x400665;this['logger']=new _0x1113c8['Logger']('OCRWorkerPoolService'),this['pool']=[],this[_0x4edb97(0x2e9)]=[],this['maxWaitTime']=0x1388,this['maxPoolSize']=0xa,this['isInitializing']=!0x1,this['isDestroyed']=!0x1,this['isAcquiring']=!0x1,this['initializationPromise']=null,this['poolSize']=Math[_0x4edb97(0x343)](0x1,Math['min'](_0x32bb6d['config']['ocr']['poolSize'],this[_0x4edb97(0x258)])),this[_0x4edb97(0x18a)]=_0x32bb6d['config']['ocr'][_0x4edb97(0x18a)],_0x32bb6d[_0x4edb97(0x3ba)]['ocr']['poolSize']>this[_0x4edb97(0x258)]&&this['logger']['warn']('OCR_POOL_SIZE\x20('+_0x32bb6d['config'][_0x4edb97(0x368)][_0x4edb97(0x3f4)]+')\x20exceeds\x20maximum\x20('+this['maxPoolSize']+').\x20Using\x20'+this[_0x4edb97(0x258)]+'.');}async[_0x400665(0x302)](){await this['warmPool']();}async['onModuleDestroy'](){const _0x3bdf85=_0x400665;this['isDestroyed']=!0x0,this['rejectAllPending'](new Error(_0x3bdf85(0x1f8))),await this['terminateAll']();}async['warmPool'](){const _0x5b09b0=_0x400665;if(this['isInitializing'])return this['initializationPromise']||Promise['resolve']();this[_0x5b09b0(0x222)]=!0x0,this[_0x5b09b0(0x212)]=this['doWarmPool']();try{await this[_0x5b09b0(0x212)];}finally{this[_0x5b09b0(0x222)]=!0x1;}}async['doWarmPool'](){const _0x5520fa=_0x400665,_0x31b867=Date['now']();this[_0x5520fa(0x22a)]['log']('Warming\x20up\x20OCR\x20worker\x20pool\x20(size:\x20'+this[_0x5520fa(0x3f4)]+_0x5520fa(0x15a)+this['lang']+_0x5520fa(0x262));const _0x1e6e69=Array['from']({'length':this[_0x5520fa(0x3f4)]},(_0x372de7,_0x5be2cb)=>this['createWorker'](_0x5be2cb));try{await Promise['all'](_0x1e6e69);const _0x55279d=Date['now']()-_0x31b867;this[_0x5520fa(0x22a)]['log'](_0x5520fa(0x36a)+_0x55279d+_0x5520fa(0x17b)+this[_0x5520fa(0x28d)]['length']);}catch(_0x1cdc4e){throw this['logger']['error']('Failed\x20to\x20warm\x20up\x20worker\x20pool:\x20'+_0x1cdc4e['message'],_0x1cdc4e[_0x5520fa(0x1f2)]),await this['terminateAll'](),_0x1cdc4e;}}async[_0x400665(0x1c2)](_0x51b6a1){const _0x3844c4=_0x400665;try{const _0x5647c9=await _0x2cd685['createWorker'](this[_0x3844c4(0x18a)],0x1,{'logger':_0x326c42=>{const _0x50e5b8=_0x3844c4;'error'===_0x326c42['status']&&this['logger']['error'](_0x50e5b8(0x401)+_0x51b6a1+_0x50e5b8(0x2a4)+_0x326c42['message']);}});this[_0x3844c4(0x28d)][_0x3844c4(0x235)]({'id':_0x51b6a1,'worker':_0x5647c9,'inUse':!0x1,'lastUsed':Date['now']()}),this['logger']['debug']('Worker\x20'+_0x51b6a1+'\x20created\x20successfully');}catch(_0x536c2e){throw this['logger']['error']('Failed\x20to\x20create\x20worker\x20'+_0x51b6a1+':\x20'+_0x536c2e['message']),_0x536c2e;}}async['acquireWorker'](){const _0x3d6b6c=_0x400665;if(this['isDestroyed'])throw new Error('OCR\x20service\x20is\x20destroyed');return this[_0x3d6b6c(0x222)]&&this[_0x3d6b6c(0x212)]&&await this['initializationPromise'],this['tryAcquireFromPool']()||this['waitForWorker']();}[_0x400665(0x194)](){const _0x121d4b=_0x400665;if(this['isAcquiring'])return null;this['isAcquiring']=!0x0;try{for(const _0xb83ed9 of this[_0x121d4b(0x28d)])if(!_0xb83ed9['inUse'])return _0xb83ed9['inUse']=!0x0,_0xb83ed9[_0x121d4b(0x2a2)]=Date['now'](),_0xb83ed9;return null;}finally{this[_0x121d4b(0x2de)]=!0x1;}}[_0x400665(0x19b)](){return new Promise((_0x382b6b,_0x212de8)=>{const _0x359dfc=setTimeout(()=>{const _0x4ec6af=a0_0x5814,_0x5e64d7=this['waitingQueue'][_0x4ec6af(0x233)](_0x7f8273=>_0x7f8273['resolve']===_0x382b6b);-0x1!==_0x5e64d7&&this['waitingQueue'][_0x4ec6af(0x3e5)](_0x5e64d7,0x1),this[_0x4ec6af(0x22a)]['warn']('Timeout\x20waiting\x20for\x20worker,\x20creating\x20temporary\x20worker'),this['createTemporaryWorker']()[_0x4ec6af(0x25b)](_0x382b6b)['catch'](_0x212de8);},this['maxWaitTime']);this['waitingQueue']['push']({'resolve':_0x382b6b,'reject':_0x212de8,'timeout':_0x359dfc});});}async['createTemporaryWorker'](){const _0x38cea6=_0x400665;return{'id':-0x1,'worker':await _0x2cd685['createWorker'](this['lang'],0x1,{'logger':()=>{}}),'inUse':!0x0,'lastUsed':Date[_0x38cea6(0x114)]()};}['releaseWorker'](_0x23f336){const _0x3913f2=_0x400665;if(this['waitingQueue']['length']>0x0){const _0x2c8ba3=this['waitingQueue']['shift']();clearTimeout(_0x2c8ba3[_0x3913f2(0x1ff)]),_0x23f336[_0x3913f2(0x2a2)]=Date['now'](),_0x2c8ba3['resolve'](_0x23f336);}else _0x23f336['inUse']=!0x1,_0x23f336['lastUsed']=Date['now']();}[_0x400665(0x2c5)](_0x5f2898){const _0x304ab0=_0x400665;for(;this['waitingQueue']['length']>0x0;){const _0x2cf9b1=this['waitingQueue'][_0x304ab0(0x318)]();clearTimeout(_0x2cf9b1['timeout']),_0x2cf9b1[_0x304ab0(0x3b3)](_0x5f2898);}}async['recognize'](_0x56bb1c,_0x57e878={}){const _0x34e932=_0x400665,_0x2a9e59=await this['acquireWorker'](),_0xdef505=_0x2a9e59['id']<0x0,{psm:_0x21fc08,charWhitelist:_0x1700ed}=_0x57e878,_0x332e4c=void 0x0!==_0x21fc08||!!_0x1700ed;try{const _0x5c3319={};void 0x0!==_0x21fc08&&(_0x5c3319['tessedit_pageseg_mode']=_0x21fc08),_0x1700ed&&(_0x5c3319[_0x34e932(0x24e)]=_0x1700ed),Object['keys'](_0x5c3319)[_0x34e932(0x2be)]>0x0&&await _0x2a9e59['worker'][_0x34e932(0x2c2)](_0x5c3319);const {data:_0x295ca0}=await _0x2a9e59[_0x34e932(0x2ef)]['recognize'](_0x56bb1c);return{'text':_0x295ca0['text'],'confidence':_0x295ca0['confidence']};}finally{if(_0xdef505)try{await _0x2a9e59['worker']['terminate']();}catch(_0x24ac61){this['logger'][_0x34e932(0x375)]('Failed\x20to\x20terminate\x20temporary\x20worker:\x20'+_0x24ac61['message']);}else{if(_0x332e4c)try{await _0x2a9e59['worker']['setParameters']({'tessedit_pageseg_mode':0x6,'tessedit_char_whitelist':''});}catch(_0x3e23ae){this['logger'][_0x34e932(0x375)](_0x34e932(0x257)+_0x3e23ae['message']);}this[_0x34e932(0x1e8)](_0x2a9e59);}}}['getPoolStats'](){const _0xedcd05=_0x400665;return{'total':this['pool']['length'],'inUse':this[_0xedcd05(0x28d)]['filter'](_0x48c7f3=>_0x48c7f3['inUse'])['length'],'waiting':this[_0xedcd05(0x2e9)]['length']};}async['terminateAll'](){const _0x5904b2=_0x400665;if(0x0===this['pool'][_0x5904b2(0x2be)])return;this['logger'][_0x5904b2(0x19e)](_0x5904b2(0x315)+this['pool'][_0x5904b2(0x2be)]+'\x20OCR\x20workers...');const _0x4c7944=this['pool']['map'](_0x45709b=>_0x45709b['worker']['terminate']()['then'](()=>{const _0x25669c=_0x5904b2;this['logger'][_0x25669c(0x181)]('Worker\x20'+_0x45709b['id']+'\x20terminated');})['catch'](_0x3c042d=>{const _0x271a93=_0x5904b2;this[_0x271a93(0x22a)]['error']('Error\x20terminating\x20worker\x20'+_0x45709b['id']+':\x20'+_0x3c042d['message']);}));await Promise[_0x5904b2(0x37c)](_0x4c7944),this[_0x5904b2(0x28d)]['length']=0x0,this['logger']['log']('All\x20OCR\x20workers\x20terminated');}};_0x236f2a[_0x400665(0x124)]=_0x168a76,_0x236f2a['OCRWorkerPoolService']=_0x168a76=_0x1b17e4([(0x0,_0x1113c8[_0x400665(0x1e6)])(),_0x2e13e8('design:paramtypes',[])],_0x168a76);},_0x3fdb04=>{_0x3fdb04['exports']=require('tesseract.js');},function(_0x28246b,_0x19f011,_0x373d74){const _0x43858b=a0_0x5814;var _0x23ea4b=this&&this['__decorate']||function(_0x57955f,_0x55094e,_0x4edabe,_0x821bff){const _0x4816e9=a0_0x5814;var _0x1b40f3,_0x4f078b=arguments['length'],_0x4b3d92=_0x4f078b<0x3?_0x55094e:null===_0x821bff?_0x821bff=Object['getOwnPropertyDescriptor'](_0x55094e,_0x4edabe):_0x821bff;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x4b3d92=Reflect[_0x4816e9(0x1fe)](_0x57955f,_0x55094e,_0x4edabe,_0x821bff);else{for(var _0x3a317c=_0x57955f[_0x4816e9(0x2be)]-0x1;_0x3a317c>=0x0;_0x3a317c--)(_0x1b40f3=_0x57955f[_0x3a317c])&&(_0x4b3d92=(_0x4f078b<0x3?_0x1b40f3(_0x4b3d92):_0x4f078b>0x3?_0x1b40f3(_0x55094e,_0x4edabe,_0x4b3d92):_0x1b40f3(_0x55094e,_0x4edabe))||_0x4b3d92);}return _0x4f078b>0x3&&_0x4b3d92&&Object[_0x4816e9(0x2d5)](_0x55094e,_0x4edabe,_0x4b3d92),_0x4b3d92;};Object[_0x43858b(0x2d5)](_0x19f011,'__esModule',{'value':!0x0}),_0x19f011['ImagePreprocessingService']=void 0x0;const _0x37b765=_0x373d74(0x2),_0x3b917f=_0x373d74(0x1f);let _0x4c000c=class{constructor(){const _0xa0a9b9=_0x43858b;this['logger']=new _0x37b765[(_0xa0a9b9(0x3c7))](_0xa0a9b9(0x1a6)),this['MIN_DIMENSION']=0xa;}['validateROI'](_0x27d376){const _0x3f3b04=_0x43858b;if(_0x27d376['x']<0x0||_0x27d376['x']>0x1)throw new Error('Invalid\x20ROI\x20x:\x20'+_0x27d376['x']+'\x20(must\x20be\x200-1)');if(_0x27d376['y']<0x0||_0x27d376['y']>0x1)throw new Error('Invalid\x20ROI\x20y:\x20'+_0x27d376['y']+'\x20(must\x20be\x200-1)');if(_0x27d376['width']<=0x0||_0x27d376[_0x3f3b04(0x1d4)]>0x1)throw new Error('Invalid\x20ROI\x20width:\x20'+_0x27d376[_0x3f3b04(0x1d4)]+'\x20(must\x20be\x200-1)');if(_0x27d376['height']<=0x0||_0x27d376[_0x3f3b04(0x177)]>0x1)throw new Error('Invalid\x20ROI\x20height:\x20'+_0x27d376['height']+'\x20(must\x20be\x200-1)');if(_0x27d376['x']+_0x27d376[_0x3f3b04(0x1d4)]>1.001)throw new Error(_0x3f3b04(0x2b4)+_0x27d376['x']+_0x3f3b04(0x207)+_0x27d376[_0x3f3b04(0x1d4)]+')\x20>\x201');if(_0x27d376['y']+_0x27d376[_0x3f3b04(0x177)]>1.001)throw new Error('ROI\x20extends\x20beyond\x20image:\x20y('+_0x27d376['y']+')\x20+\x20height('+_0x27d376['height']+')\x20>\x201');}async[_0x43858b(0x265)](_0x7ff9dd,_0x191490,_0x3485de,_0x2e50cd={}){const _0x2fae89=_0x43858b;try{this[_0x2fae89(0x372)](_0x191490);const _0x2828b5=_0x3b917f(_0x7ff9dd),_0x5e0500=await _0x2828b5[_0x2fae89(0x168)](),_0x55ce51=_0x5e0500[_0x2fae89(0x1d4)]||0x0,_0x5bec53=_0x5e0500['height']||0x0;if(0x0===_0x55ce51||0x0===_0x5bec53)throw new Error(_0x2fae89(0x3ae));if(_0x55ce51<this['MIN_DIMENSION']||_0x5bec53<this['MIN_DIMENSION'])throw new Error(_0x2fae89(0x18c)+_0x55ce51+'x'+_0x5bec53+'\x20(min:\x20'+this[_0x2fae89(0x296)]+'x'+this['MIN_DIMENSION']+')');const _0x1ddc32=Math['floor'](_0x191490['x']*_0x55ce51),_0x475107=Math[_0x2fae89(0x231)](_0x191490['y']*_0x5bec53),_0x4133b4=Math['floor'](_0x191490['width']*_0x55ce51),_0x1b137c=Math['floor'](_0x191490['height']*_0x5bec53),_0x2c0ff5=Math[_0x2fae89(0x343)](0x0,Math[_0x2fae89(0x17a)](_0x1ddc32,_0x55ce51-0x1)),_0xdd4336=Math['max'](0x0,Math['min'](_0x475107,_0x5bec53-0x1)),_0x158479=Math['max'](this['MIN_DIMENSION'],Math[_0x2fae89(0x17a)](_0x4133b4,_0x55ce51-_0x2c0ff5)),_0x1d2dc0=Math[_0x2fae89(0x343)](this['MIN_DIMENSION'],Math['min'](_0x1b137c,_0x5bec53-_0xdd4336));let _0x5af7e6=_0x2828b5['clone']()['extract']({'left':_0x2c0ff5,'top':_0xdd4336,'width':_0x158479,'height':_0x1d2dc0}),_0x314563=_0x158479,_0x2d9883=_0x1d2dc0,_0x4e365c=0x1;return _0x3485de&&_0x158479>_0x3485de&&(_0x4e365c=_0x3485de/_0x158479,_0x314563=_0x3485de,_0x2d9883=Math[_0x2fae89(0x343)](this['MIN_DIMENSION'],Math['floor'](_0x1d2dc0*_0x4e365c)),_0x5af7e6=_0x5af7e6['resize'](_0x314563,_0x2d9883,{'kernel':_0x3b917f[_0x2fae89(0x31f)]['lanczos3'],'withoutEnlargement':!0x0})),_0x2e50cd['grayscale']&&(_0x5af7e6=_0x5af7e6['grayscale']()),_0x2e50cd['enhanceContrast']&&(_0x5af7e6=_0x5af7e6['normalize']()),{'buffer':await _0x5af7e6['png']()[_0x2fae89(0x16a)](),'metadata':{'originalWidth':_0x55ce51,'originalHeight':_0x5bec53,'processedWidth':_0x314563,'processedHeight':_0x2d9883,'scaleFactor':_0x4e365c}};}catch(_0x1eeb38){throw this['logger'][_0x2fae89(0x3e9)]('Image\x20preprocessing\x20error:\x20'+_0x1eeb38['message'],_0x1eeb38['stack']),_0x1eeb38;}}};_0x19f011[_0x43858b(0x1a6)]=_0x4c000c,_0x19f011['ImagePreprocessingService']=_0x4c000c=_0x23ea4b([(0x0,_0x37b765['Injectable'])()],_0x4c000c);},_0x3e4df4=>{_0x3e4df4['exports']=require('sharp');},(_0xddf470,_0x5c3562)=>{const _0x1968e4=a0_0x5814;Object['defineProperty'](_0x5c3562,'__esModule',{'value':!0x0}),_0x5c3562[_0x1968e4(0x271)]=_0x5c3562['removeVietnameseTones']=void 0x0,_0x5c3562[_0x1968e4(0x210)]=_0x3de501=>_0x3de501?_0x3de501['normalize']('NFD')[_0x1968e4(0x26c)](/[\u0300-\u036f]/g,'')['replace'](/đ/g,'d')['replace'](/Đ/g,'D'):'',_0x5c3562[_0x1968e4(0x271)]=_0x1d9d8a=>_0x1d9d8a?(0x0,_0x5c3562['removeVietnameseTones'])(_0x1d9d8a)['trim']()['replace'](/ /g,'')['toLocaleUpperCase']():'';},_0x4298b1=>{_0x4298b1['exports']=require('qrcode');},(_0x2f548d,_0xd48413,_0x27777b)=>{const _0x56a080=a0_0x5814;Object['defineProperty'](_0xd48413,'__esModule',{'value':!0x0}),_0xd48413[_0x56a080(0x234)]=void 0x0;const _0x3f8538=_0x27777b(0x23),_0x1230b0=_0x27777b(0x24),_0x47dfaa=_0x27777b(0x25);_0xd48413[_0x56a080(0x234)]={'PGBANK':{'ROI':_0x1230b0[_0x56a080(0x2d2)]['TRANSACTION_SUCCESS'],'expectedTexts':[_0x56a080(0x105)]},'HDBANK':{'ROI':_0x3f8538[_0x56a080(0x38d)]['BILL_AREA'],'expectedTexts':['Kết\x20quả\x20giao\x20dịch']},'VIETCOMBANK':{'ROI':_0x47dfaa[_0x56a080(0x2d7)]['TRANSACTION_SUCCESS'],'expectedTexts':['Giao\x20dịch\x20thành\x20công']}};},(_0x14a2d2,_0x240cf9)=>{const _0x4e1128=a0_0x5814;Object[_0x4e1128(0x2d5)](_0x240cf9,'__esModule',{'value':!0x0}),_0x240cf9['HD_ROI_EXPECTED']=void 0x0,_0x240cf9[_0x4e1128(0x38d)]={'LAUNCH_APP':{'x':0.1,'y':0.54,'width':0.7,'height':0.1},'VERIFY_ACCOUNT_NUMBER':{'x':0.05,'y':0.4,'width':0.9,'height':0.2},'VERIFY_ACCOUNT_NAME':{'x':0.045,'y':0.4,'width':0.83,'height':0.35},'VERIFY_ACCOUNT_NAME_INTERNAL':{'x':0.4,'y':0.26,'width':0.6,'height':0.25},'OTP_ENTER':{'x':0.1,'y':0.25,'width':0.8,'height':0.1},'TRANSACTION_VERIFY':{'x':0.1,'y':0.5,'width':0.4,'height':0.1},'TRANSACTION_SUCCESS':{'x':0.2,'y':0.3,'width':0.6,'height':0.1},'BILL_AREA':{'x':0.085,'y':0.025,'width':0.6,'height':0.075},'HOME_SCREEN':{'x':0.02,'y':0.7,'width':0.98,'height':0.3},'ALBUM_SCREEN':{'x':0.18,'y':0.02,'width':0.8,'height':0.085},'SWIPE_UP_SCREEN':{'x':0.01,'y':0.5,'width':0.5,'height':0.1},'INTERNAL_SWIPE_UP_SCREEN':{'x':0.01,'y':0.65,'width':0.5,'height':0.1},'WARNING_TRANSACTION':{'x':0.14,'y':0.39,'width':0.72,'height':0.2},'OTP_ENTER_OR_CONTINUE_TRANSFER':{'x':0.03,'y':0.1,'width':0.95,'height':0.6},'CONFIRM_AFTER_OTP':{'x':0.03,'y':0.5,'width':0.95,'height':0.2},'BOTTOM_BILL':{'x':0.03,'y':0.8,'width':0.9,'height':0.1}};},(_0x1300a3,_0x8c3b02)=>{const _0x577ffb=a0_0x5814;Object['defineProperty'](_0x8c3b02,'__esModule',{'value':!0x0}),_0x8c3b02['PG_ROI_EXPECTED']=void 0x0,_0x8c3b02[_0x577ffb(0x2d2)]={'LAUNCH_APP':{'x':0.04,'y':0.53,'width':0.73,'height':0.078},'VERIFY_ACCOUNT_NAME':{'x':0.04,'y':0.36,'width':0.81,'height':0.28},'TRANSACTION_CONFIRM':{'x':0.085,'y':0.023,'width':0.8,'height':0.08},'TRANSACTION_VERIFY':{'x':0.085,'y':0.023,'width':0.8,'height':0.08},'TRANSACTION_SUCCESS':{'x':0.06,'y':0.212,'width':0.88,'height':0.1},'HOME_SCREEN':{'x':0.02,'y':0.7,'width':0.98,'height':0.3},'ALBUM_SCREEN':{'x':0.18,'y':0.02,'width':0.8,'height':0.085}};},(_0x3cc6d0,_0x6e4282)=>{const _0x5acf2c=a0_0x5814;Object['defineProperty'](_0x6e4282,_0x5acf2c(0x363),{'value':!0x0}),_0x6e4282[_0x5acf2c(0x2d7)]=void 0x0,_0x6e4282['VCB_ROI_EXPECTED']={'LAUNCH_APP':{'x':0.3,'y':0.5,'width':0.4,'height':0.1},'VERIFY_ACCOUNT_NUMBER':{'x':0.05,'y':0.45,'width':0.9,'height':0.2},'VERIFY_ACCOUNT_NAME':{'x':0.05,'y':0.55,'width':0.8,'height':0.1},'OTP_ENTER':{'x':0.1,'y':0.5,'width':0.4,'height':0.1},'OTP_VERIFY':{'x':0.1,'y':0.4,'width':0.5,'height':0.1},'TRANSACTION_VERIFY':{'x':0.5,'y':0.1,'width':0.4,'height':0.1},'TRANSACTION_SUCCESS':{'x':0.2,'y':0.2,'width':0.6,'height':0.1},'HOME_SCREEN':{'x':0.02,'y':0.55,'width':0.5,'height':0.1},'ALBUM_SCREEN':{'x':0.02,'y':0.02,'width':0.98,'height':0.2}};},(_0x4d7bb4,_0x36dca9,_0x2165b7)=>{const _0x5ca341=a0_0x5814;Object['defineProperty'](_0x36dca9,'__esModule',{'value':!0x0}),_0x36dca9['NUMPAD_LAYOUT']=_0x36dca9['KEYBOARD_LAYOUT']=_0x36dca9['COMMON_COORDINATES']=_0x36dca9['scaleCoordinates']=void 0x0;const _0x3ac5fe=_0x2165b7(0x11);_0x36dca9[_0x5ca341(0x369)]=(_0x2c997f,_0x146ea4=0x64)=>Object['fromEntries'](Object['entries'](_0x2c997f)['map'](([_0x2e64fa,_0x3599ff])=>[_0x2e64fa,{'x':Math['round'](_0x3599ff['x']*_0x146ea4),'y':Math['round'](_0x3599ff['y']*_0x146ea4)}]));const _0x45a08c={0x0:{'x':0.55,'y':0.95},0x1:{'x':0.25,'y':0.7},0x2:{'x':0.55,'y':0.7},0x3:{'x':0.85,'y':0.7},0x4:{'x':0.25,'y':0.8},0x5:{'x':0.55,'y':0.8},0x6:{'x':0.85,'y':0.8},0x7:{'x':0.25,'y':0.9},0x8:{'x':0.55,'y':0.9},0x9:{'x':0.85,'y':0.9}},_0x3bec5e={'KEYBOARD_SWITCH':{'x':0.05,'y':0.95},'SHIFT_KEY':{'x':0.05,'y':0.88},'RETURN_KEY':{'x':0.95,'y':0.95}},_0x11221a=(0x0,_0x36dca9[_0x5ca341(0x369)])(_0x3bec5e),_0x1a7892=(0x0,_0x36dca9['scaleCoordinates'])(_0x45a08c);_0x36dca9['COMMON_COORDINATES']=_0x5ca341(0x3d4)===_0x3ac5fe['config']['boxType']?_0x11221a:_0x3bec5e,_0x36dca9['KEYBOARD_LAYOUT']={0x0:{'x':0.95,'y':0.68},0x1:{'x':0.05,'y':0.68},0x2:{'x':0.15,'y':0.68},0x3:{'x':0.25,'y':0.68},0x4:{'x':0.35,'y':0.68},0x5:{'x':0.45,'y':0.68},0x6:{'x':0.55,'y':0.68},0x7:{'x':0.65,'y':0.68},0x8:{'x':0.75,'y':0.68},0x9:{'x':0.85,'y':0.68},'@':{'x':0.85,'y':0.78},'!':{'x':0.65,'y':0.88},'a':{'x':0.1,'y':0.78},'b':{'x':0.6,'y':0.88},'c':{'x':0.4,'y':0.88},'d':{'x':0.3,'y':0.78},'e':{'x':0.25,'y':0.68},'f':{'x':0.4,'y':0.78},'g':{'x':0.5,'y':0.78},'h':{'x':0.6,'y':0.78},'i':{'x':0.75,'y':0.68},'j':{'x':0.7,'y':0.78},'k':{'x':0.8,'y':0.78},'l':{'x':0.9,'y':0.78},'m':{'x':0.8,'y':0.88},'n':{'x':0.7,'y':0.88},'o':{'x':0.85,'y':0.68},'p':{'x':0.95,'y':0.68},'q':{'x':0.05,'y':0.68},'r':{'x':0.35,'y':0.68},'s':{'x':0.2,'y':0.78},'t':{'x':0.45,'y':0.68},'u':{'x':0.65,'y':0.68},'v':{'x':0.5,'y':0.88},'w':{'x':0.15,'y':0.68},'x':{'x':0.3,'y':0.88},'y':{'x':0.55,'y':0.68},'z':{'x':0.2,'y':0.88},'\x20':{'x':0.55,'y':0.95}},_0x36dca9['NUMPAD_LAYOUT']=_0x5ca341(0x3d4)===_0x3ac5fe[_0x5ca341(0x3ba)]['boxType']?_0x1a7892:_0x45a08c;},(_0x3e90fa,_0x2e4d74,_0x490d11)=>{const _0x2e0777=a0_0x5814;Object[_0x2e0777(0x2d5)](_0x2e4d74,'__esModule',{'value':!0x0}),_0x2e4d74[_0x2e0777(0x260)]=void 0x0;const _0x4e45af=_0x490d11(0x11),_0x3b7473={'LOGIN_BUTTON':{'x':0.5,'y':0.8},'LOGIN_BUTTON_API':{'x':0.5,'y':0.62},'PASSWORD_FIELD':{'x':0.5,'y':0.45}},_0x2044d3=(0x0,_0x490d11(0x26)[_0x2e0777(0x369)])(_0x3b7473);_0x2e4d74[_0x2e0777(0x260)]='PANDA'===_0x4e45af['config']['boxType']?_0x2044d3:_0x3b7473;},function(_0x43fc88,_0x2df425,_0x2d0ccd){const _0x482796=a0_0x5814;var _0x823f62,_0x45d0b1,_0x382fce,_0x6fe46c,_0x573850,_0x5a662f=this&&this[_0x482796(0x21a)]||function(_0x35d16b,_0x1ff198,_0x503c70,_0x215814){const _0x1a20a2=_0x482796;var _0x1c808e,_0x2feeda=arguments['length'],_0xa53911=_0x2feeda<0x3?_0x1ff198:null===_0x215814?_0x215814=Object[_0x1a20a2(0x313)](_0x1ff198,_0x503c70):_0x215814;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x1a20a2(0x1fe)])_0xa53911=Reflect[_0x1a20a2(0x1fe)](_0x35d16b,_0x1ff198,_0x503c70,_0x215814);else{for(var _0x526ce3=_0x35d16b['length']-0x1;_0x526ce3>=0x0;_0x526ce3--)(_0x1c808e=_0x35d16b[_0x526ce3])&&(_0xa53911=(_0x2feeda<0x3?_0x1c808e(_0xa53911):_0x2feeda>0x3?_0x1c808e(_0x1ff198,_0x503c70,_0xa53911):_0x1c808e(_0x1ff198,_0x503c70))||_0xa53911);}return _0x2feeda>0x3&&_0xa53911&&Object['defineProperty'](_0x1ff198,_0x503c70,_0xa53911),_0xa53911;},_0x2e6d9d=this&&this['__metadata']||function(_0x182e5f,_0x2b69ed){const _0x459264=_0x482796;if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x459264(0x168)](_0x182e5f,_0x2b69ed);},_0x3a17db=this&&this['__param']||function(_0x2d8f40,_0x2445d6){return function(_0x48e07c,_0x8cb2e1){_0x2445d6(_0x48e07c,_0x8cb2e1,_0x2d8f40);};};Object['defineProperty'](_0x2df425,'__esModule',{'value':!0x0}),_0x2df425['PgService']=void 0x0;const _0x5125cc=_0x2d0ccd(0x2),_0x5956ea=_0x2d0ccd(0xe),_0x1f7a45=_0x2d0ccd(0x17),_0x246372=_0x2d0ccd(0x13),_0x578f96=_0x2d0ccd(0xd),_0x4ee24d=_0x2d0ccd(0x18),_0x1df3c6=_0x2d0ccd(0x29),_0x5eebed=_0x2d0ccd(0x1b),_0x1ba8ed=_0x2d0ccd(0x2a),_0x54ab5e=_0x2d0ccd(0x24),_0x58026b=_0x2d0ccd(0x2b),_0x35eb2c=_0x2d0ccd(0x2c),_0x10c091=_0x2d0ccd(0x1e);let _0x5b835f=class extends _0x1f7a45[_0x482796(0x31d)]{constructor(_0x191b73,_0x3a1a61,_0x1720d3,_0x1cb29c,_0x458d4f){const _0x527cbb=_0x482796;super(_0x191b73,_0x3a1a61,_0x1720d3,_0x1cb29c),this['wsService']=_0x191b73,this['telegramService']=_0x458d4f,this['BANK_CODE']=_0x527cbb(0x32b),this[_0x527cbb(0x21f)]=_0x527cbb(0x1e5);}async['inputPasswordFromConfig'](_0x4b420a){const _0x1bae9d=_0x482796,_0x179be3=await this['deviceService']['getDeviceConfig'](_0x4b420a);if(!_0x179be3||!_0x179be3['password'])throw new Error('Password\x20not\x20configured\x20for\x20device\x20'+_0x4b420a);await this['clickWithTransition'](_0x4b420a,_0x1df3c6['PG_UI_COORDINATES']['PASSWORD_FIELD']['x'],_0x1df3c6[_0x1bae9d(0x1de)]['PASSWORD_FIELD']['y'],0x5dc),await this['wsService'][_0x1bae9d(0x3fe)](_0x4b420a,_0x179be3['password']),await(0x0,_0x4ee24d['sleep'])(0x3e8),await this[_0x1bae9d(0x250)]['pressReturnKey'](_0x4b420a);}async['inputSmartOTPFromConfig'](_0x5a05c3,_0xf869b7=0x3){const _0x448310=_0x482796,_0x47f232=await this['deviceService'][_0x448310(0x24f)](_0x5a05c3);if(!_0x47f232||!_0x47f232['smartOTP'])throw new Error(_0x448310(0x1ed)+_0x5a05c3);await(0x0,_0x4ee24d['sleep'])(0x7d0),await this['wsService'][_0x448310(0x3fe)](_0x5a05c3,_0x47f232[_0x448310(0x377)]);}async[_0x482796(0x3dd)](_0x4bf2fd){const _0x120e52=_0x482796;if(await this[_0x120e52(0x250)][_0x120e52(0x3dd)](_0x4bf2fd,this['BUNDLE_ID']),!await this[_0x120e52(0x116)](_0x4bf2fd,{'expectedTexts':['Đăng\x20nhập'],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x54ab5e[_0x120e52(0x2d2)]['LAUNCH_APP'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new Error(_0x120e52(0x252));this['logger']['log']('['+_0x4bf2fd+']\x20-\x20Get\x20login\x20app\x20screen');}async['login'](_0x28e566){const _0x32b4ed=_0x482796;if(await this['killApp'](_0x28e566),await(0x0,_0x4ee24d['sleep'])(0x3e8),await this[_0x32b4ed(0x3dd)](_0x28e566),await(0x0,_0x4ee24d['sleep'])(0x3e8),await this['inputPasswordFromConfig'](_0x28e566),!await this['clickAndWaitForScreen'](_0x28e566,_0x1df3c6['PG_UI_COORDINATES']['LOGIN_BTN']['x'],_0x1df3c6['PG_UI_COORDINATES']['LOGIN_BTN']['y'],{'expectedTexts':['tài\x20khoản','chuyển\x20tiền','tiết\x20kiệm'],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x54ab5e['PG_ROI_EXPECTED']['HOME_SCREEN']}))throw this['telegramService'][_0x32b4ed(0x246)]({'text':'❌\x20Login\x20Error\x0a\x0a<b>Device:</b>\x20'+_0x28e566+'\x0a<b>Error:</b>\x20Không\x20thể\x20đăng\x20nhập\x20vào\x20app\x20PGBank.','options':{'parseMode':'HTML'}}),new Error('Failed\x20to\x20login\x20to\x20PGBank');this[_0x32b4ed(0x22a)]['log']('['+_0x28e566+']\x20-\x20Login\x20successfully');}async['executeTransferWithQRCode'](_0x637dce,_0x49d9d5){const _0x57aa4c=_0x482796;if(this['logger'][_0x57aa4c(0x19e)]('Executing\x20PG\x20transfer\x20for\x20withdrawal\x20'+_0x637dce[_0x57aa4c(0x34a)]+'\x20on\x20device\x20'+_0x49d9d5['deviceId']),await this['clickWithTransition'](_0x49d9d5['deviceId'],_0x1df3c6[_0x57aa4c(0x1de)][_0x57aa4c(0x298)]['x'],_0x1df3c6['PG_UI_COORDINATES'][_0x57aa4c(0x298)]['y'],0x1388),!await this[_0x57aa4c(0x1b1)](_0x49d9d5[_0x57aa4c(0x364)],_0x1df3c6['PG_UI_COORDINATES'][_0x57aa4c(0x3e0)]['x'],_0x1df3c6[_0x57aa4c(0x1de)]['IMAGE_LIBRARY_BTN']['y'],{'expectedTexts':['Ảnh'],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x54ab5e['PG_ROI_EXPECTED']['ALBUM_SCREEN']}))throw new _0x1ba8ed['WithdrawalProcessingError']('['+_0x49d9d5['accountName']+']\x20Failed\x20to\x20get\x20image\x20library\x20screen',_0x1ba8ed['ErrorType']['FORCE_LOGIN_AND_REQUEUE'],'Failed:\x20MH\x20mở\x20thư\x20viện\x20ảnh');this[_0x57aa4c(0x22a)]['log']('['+_0x49d9d5['accountName']+']\x20-\x20Get\x20image\x20library\x20screen'),await this['clickWithTransition'](_0x49d9d5['deviceId'],_0x1df3c6[_0x57aa4c(0x1de)]['FIRST_IMAGE_BTN']['x'],_0x1df3c6['PG_UI_COORDINATES'][_0x57aa4c(0x1ea)]['y'],0x7d0);let _0x309f3b=!0x1;if(_0x309f3b=_0x637dce[_0x57aa4c(0x358)]===_0x58026b['BankCodeWithdrawal']['PGBANK']?await this['clickAndWaitForScreen'](_0x49d9d5['deviceId'],_0x1df3c6['PG_UI_COORDINATES']['SELECT_IMAGE_QR_CODE_BTN']['x'],_0x1df3c6['PG_UI_COORDINATES']['SELECT_IMAGE_QR_CODE_BTN']['y'],{'expectedTexts':[_0x637dce['beneficiaryName']],'timeout':0x4e20,'pollInterval':0x1f4,'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}):await this['clickAndWaitForScreen'](_0x49d9d5[_0x57aa4c(0x364)],_0x1df3c6['PG_UI_COORDINATES'][_0x57aa4c(0x27e)]['x'],_0x1df3c6[_0x57aa4c(0x1de)]['SELECT_IMAGE_QR_CODE_BTN']['y'],{'expectedTexts':[_0x637dce['beneficiaryName']],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x54ab5e[_0x57aa4c(0x2d2)]['VERIFY_ACCOUNT_NAME'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}),!_0x309f3b)throw new _0x1ba8ed['WithdrawalProcessingError']('Choose\x20wrong\x20image\x20qrcode',_0x1ba8ed['ErrorType'][_0x57aa4c(0x1d6)],'Failed:\x20MH\x20tra\x20tên\x20tài\x20khoản');if(this['logger']['log']('['+_0x49d9d5['accountName']+']\x20-\x20Get\x20Verified\x20account\x20name\x20screen'),!await this['clickAndWaitForScreen'](_0x49d9d5['deviceId'],_0x1df3c6['PG_UI_COORDINATES'][_0x57aa4c(0x289)]['x'],_0x1df3c6[_0x57aa4c(0x1de)][_0x57aa4c(0x289)]['y'],{'expectedTexts':[_0x57aa4c(0x2af)],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x54ab5e['PG_ROI_EXPECTED'][_0x57aa4c(0x121)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1ba8ed['WithdrawalProcessingError'](_0x57aa4c(0x305),_0x1ba8ed['ErrorType']['FORCE_LOGIN_AND_REQUEUE'],_0x57aa4c(0x347));if(this['logger']['log']('['+_0x49d9d5['accountName']+']\x20-\x20Get\x20Transaction\x20confirm\x20screen'),!await this['clickAndWaitForScreen'](_0x49d9d5['deviceId'],_0x1df3c6['PG_UI_COORDINATES'][_0x57aa4c(0x289)]['x'],_0x1df3c6[_0x57aa4c(0x1de)]['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['Xác\x20thực\x20giao\x20dịch'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x54ab5e['PG_ROI_EXPECTED'][_0x57aa4c(0x387)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1ba8ed['WithdrawalProcessingError']('Transaction\x20verification\x20screen\x20not\x20found',_0x1ba8ed['ErrorType']['FORCE_LOGIN_AND_REQUEUE'],_0x57aa4c(0x1d9));if(this['logger']['log']('['+_0x49d9d5[_0x57aa4c(0x153)]+']\x20-\x20Get\x20Transaction\x20verification\x20screen'),await this['inputSmartOTPFromConfig'](_0x49d9d5['deviceId']),!await this[_0x57aa4c(0x116)](_0x49d9d5[_0x57aa4c(0x364)],{'expectedTexts':['Chuyển\x20tiền\x20thành\x20công'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x54ab5e[_0x57aa4c(0x2d2)]['TRANSACTION_SUCCESS'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x1ba8ed['WithdrawalProcessingError'](_0x57aa4c(0x10d),_0x1ba8ed['ErrorType']['NO_BILL_AFTER_OTP'],'Failed:\x20MH\x20Chuyển\x20tiền\x20thành\x20công');this['logger'][_0x57aa4c(0x19e)]('['+_0x49d9d5['accountName']+_0x57aa4c(0x269)),await(0x0,_0x4ee24d['sleep'])(0x1f4),await this['captureScreen'](_0x49d9d5['deviceId'],{'folderPath':_0x637dce['withdrawalCode']});}async['goToHomeScreenFromBill'](_0x277a1f){const _0x36afc5=_0x482796;if(!await this['clickAndWaitForScreen'](_0x277a1f[_0x36afc5(0x364)],_0x1df3c6['PG_UI_COORDINATES']['BACK_TO_HOME']['x'],_0x1df3c6['PG_UI_COORDINATES'][_0x36afc5(0x30e)]['y'],{'expectedTexts':['tài\x20khoản','chuyển\x20tiền','tiết\x20kiệm'],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x54ab5e['PG_ROI_EXPECTED']['HOME_SCREEN']}))throw new _0x1ba8ed['WithdrawalProcessingError']('Failed\x20to\x20login\x20to\x20PGBank',_0x1ba8ed['ErrorType'][_0x36afc5(0x33d)]);this[_0x36afc5(0x22a)]['log']('['+_0x277a1f['deviceId']+']\x20-\x20Get\x20to\x20home\x20screen');}async[_0x482796(0x1a1)](_0x3c7013){const _0x43d405=_0x482796;try{const _0x1ecd72=await this[_0x43d405(0x411)][_0x43d405(0x410)](_0x3c7013,{'fieldType':'singleLine','customROI':{'x':0.05,'y':0.75,'width':0.9,'height':0.12},'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x1ecd72)return this[_0x43d405(0x22a)]['warn']('Failed\x20to\x20extract\x20transaction\x20amount\x20from\x20ROI'),null;const _0x409171=_0x1ecd72['text']['replace'](/[^\d.,]/g,'')[_0x43d405(0x26c)](/,/g,''),_0x48c205=parseFloat(_0x409171);return isNaN(_0x48c205)?(this[_0x43d405(0x22a)][_0x43d405(0x375)]('Could\x20not\x20parse\x20amount\x20from\x20OCR\x20text:\x20'+_0x1ecd72[_0x43d405(0x3c4)]),null):(this['logger']['log']('Extracted\x20transaction\x20amount:\x20'+_0x48c205['toLocaleString']('vi-VN')+_0x43d405(0x3c9)+_0x1ecd72[_0x43d405(0x164)][_0x43d405(0x2cc)](0x2)+'%,\x20time:\x20'+_0x1ecd72[_0x43d405(0x38f)]+'ms)'),_0x48c205);}catch(_0x28661f){return this[_0x43d405(0x22a)]['error'](_0x43d405(0x2f8)+_0x28661f[_0x43d405(0x36b)],_0x28661f['stack']),null;}}async['onModuleInit'](){}['onModuleDestroy'](){}};_0x2df425['PgService']=_0x5b835f,_0x2df425['PgService']=_0x5b835f=_0x5a662f([(0x0,_0x5125cc['Injectable'])(),_0x3a17db(0x0,(0x0,_0x5125cc[_0x482796(0x1c5)])(_0x578f96[_0x482796(0x1c0)])),_0x2e6d9d('design:paramtypes',['function'==typeof(_0x823f62=void 0x0!==_0x246372['IWebSocketService']&&_0x246372['IWebSocketService'])?_0x823f62:Object,'function'==typeof(_0x45d0b1=void 0x0!==_0x5956ea[_0x482796(0x1f4)]&&_0x5956ea['DeviceService'])?_0x45d0b1:Object,_0x482796(0x379)==typeof(_0x382fce=void 0x0!==_0x5eebed['OCRService']&&_0x5eebed['OCRService'])?_0x382fce:Object,'function'==typeof(_0x6fe46c=void 0x0!==_0x10c091['ImagePreprocessingService']&&_0x10c091['ImagePreprocessingService'])?_0x6fe46c:Object,'function'==typeof(_0x573850=void 0x0!==_0x35eb2c['TelegramService']&&_0x35eb2c[_0x482796(0x1d7)])?_0x573850:Object])],_0x5b835f);},(_0x4c6344,_0x5418b7,_0x265739)=>{const _0x1b6886=a0_0x5814;Object['defineProperty'](_0x5418b7,'__esModule',{'value':!0x0}),_0x5418b7['PG_UI_COORDINATES']=void 0x0;const _0x3c3836=_0x265739(0x11),_0x252f95={'LOGIN_BTN':{'x':0.5,'y':0.6},'PASSWORD_FIELD':{'x':0.5,'y':0.435},'TRANSFER_BTN':{'x':0.7,'y':0.7},'TRANSFER_INTERNAL_BTN':{'x':0.2,'y':0.2},'TRANSFER_EXTERNAL_BTN':{'x':0.4,'y':0.2},'CLOSE_ALLOW_CONTACT_POPUP_BTN':{'x':0.3,'y':0.6},'ACCOUNT_NUMBER_INPUT':{'x':0.4,'y':0.43},'SELECT_BANK_BTN':{'x':0.4,'y':0.47},'SEARCH_BANK_BTN':{'x':0.4,'y':0.48},'INTERNAL_AMOUNT_INPUT':{'x':0.5,'y':0.6},'HIDE_NUMPAD_BTN':{'x':0.05,'y':0.4},'CONTINUE_TRANSFER_BTN':{'x':0.5,'y':0.9},'BANK_SEARCH_BTN':{'x':0.4,'y':0.45},'BANK_SEARCH_INPUT':{'x':0.4,'y':0.45},'EXTERNAL_AMOUNT_INPUT':{'x':0.3,'y':0.37},'BACK_TO_HOME':{'x':0.2,'y':0.9},'QR_CODE_BTN':{'x':0.2,'y':0.9},'IMAGE_LIBRARY_BTN':{'x':0.8,'y':0.9},'FIRST_IMAGE_BTN':{'x':0.3,'y':0.3},'SELECT_IMAGE_QR_CODE_BTN':{'x':0.95,'y':0.95},'HOME_ICON_HEADER':{'x':0.95,'y':0.05}},_0x542534=(0x0,_0x265739(0x26)['scaleCoordinates'])(_0x252f95);_0x5418b7['PG_UI_COORDINATES']=_0x1b6886(0x3d4)===_0x3c3836['config']['boxType']?_0x542534:_0x252f95;},(_0xa8181c,_0x4250fb)=>{const _0x58af5e=a0_0x5814;var _0x42c5d9;Object['defineProperty'](_0x4250fb,_0x58af5e(0x363),{'value':!0x0}),_0x4250fb['WithdrawalProcessingError']=_0x4250fb['ErrorType']=void 0x0,function(_0x152ecd){const _0x4101f1=_0x58af5e;_0x152ecd['TEMPORARY']='TEMPORARY',_0x152ecd['PERMANENT']='PERMANENT',_0x152ecd['FORCE_LOGIN_AND_REQUEUE']='FORCE_LOGIN_AND_REQUEUE',_0x152ecd['FORCE_LOGIN_NO_REQUEUE']=_0x4101f1(0x33d),_0x152ecd[_0x4101f1(0x29a)]='NO_BILL_AFTER_OTP';}(_0x42c5d9||(_0x4250fb['ErrorType']=_0x42c5d9={}));class _0x35eec5 extends Error{constructor(_0x404e58,_0x4dcd05,_0x57f606=''){super(_0x404e58),this['errorType']=_0x4dcd05,this['context']=_0x57f606,this['name']='WithdrawalProcessingError',Error['captureStackTrace'](this,this['constructor']);}}_0x4250fb['WithdrawalProcessingError']=_0x35eec5;},(_0x55e669,_0x414112)=>{var _0xc9e6dd;Object['defineProperty'](_0x414112,'__esModule',{'value':!0x0}),_0x414112['BankCodeWithdrawal']=void 0x0,function(_0x38b705){const _0x4616ba=a0_0x5814;_0x38b705['VIETCOMBANK']=_0x4616ba(0x323),_0x38b705[_0x4616ba(0x365)]='AGRIBANK',_0x38b705['BIDV']='BIDV',_0x38b705['SACOMBANK']='SACOMBANK',_0x38b705['TECHCOMBANK']='TECHCOMBANK',_0x38b705['TPBANK']=_0x4616ba(0x39a),_0x38b705['HDBank']=_0x4616ba(0x264),_0x38b705[_0x4616ba(0x319)]='VPBANK',_0x38b705['MBBANK']='MBBANK',_0x38b705['MSB']='MSB',_0x38b705['LPBANK']='LPBANK',_0x38b705[_0x4616ba(0x3be)]=_0x4616ba(0x3be),_0x38b705['ABBANK']='ABBANK',_0x38b705['NCB']=_0x4616ba(0x1fc),_0x38b705[_0x4616ba(0x395)]=_0x4616ba(0x395),_0x38b705['SEABANK']='SEABANK',_0x38b705['SCB']='SCB',_0x38b705['PVCOMBANK']='PVCOMBANK',_0x38b705['KIENLONGBANK']='KIENLONGBANK',_0x38b705['BVBANK']='BVBANK',_0x38b705['VIETINBANK']='VIETINBANK',_0x38b705['OCB']='OCB',_0x38b705[_0x4616ba(0x29d)]='VIETBANK',_0x38b705['SHB']=_0x4616ba(0x28e),_0x38b705['NAMABANK']=_0x4616ba(0x28c),_0x38b705['SHINHANBANKVIETNAM']=_0x4616ba(0x15d),_0x38b705['CIMB']='CIMB',_0x38b705['SAIGONBANK']='SAIGONBANK',_0x38b705['BACABANK']='BACABANK',_0x38b705[_0x4616ba(0x32f)]=_0x4616ba(0x32f),_0x38b705['GPBANK']=_0x4616ba(0x3a0),_0x38b705[_0x4616ba(0x187)]='HSBC',_0x38b705[_0x4616ba(0x3e4)]='VRB',_0x38b705[_0x4616ba(0x142)]='VIB',_0x38b705['PGBANK']='PGBANK';}(_0xc9e6dd||(_0x414112['BankCodeWithdrawal']=_0xc9e6dd={}));},function(_0x3f1498,_0x596023,_0x4df74f){const _0x111e19=a0_0x5814;var _0x5f584d,_0x64696a=this&&this['__decorate']||function(_0xb44236,_0x5a3b79,_0x3090fb,_0x373a56){const _0x321788=a0_0x5814;var _0x55aa00,_0x4fb896=arguments['length'],_0x3f0964=_0x4fb896<0x3?_0x5a3b79:null===_0x373a56?_0x373a56=Object['getOwnPropertyDescriptor'](_0x5a3b79,_0x3090fb):_0x373a56;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x3f0964=Reflect['decorate'](_0xb44236,_0x5a3b79,_0x3090fb,_0x373a56);else{for(var _0x11d9f9=_0xb44236[_0x321788(0x2be)]-0x1;_0x11d9f9>=0x0;_0x11d9f9--)(_0x55aa00=_0xb44236[_0x11d9f9])&&(_0x3f0964=(_0x4fb896<0x3?_0x55aa00(_0x3f0964):_0x4fb896>0x3?_0x55aa00(_0x5a3b79,_0x3090fb,_0x3f0964):_0x55aa00(_0x5a3b79,_0x3090fb))||_0x3f0964);}return _0x4fb896>0x3&&_0x3f0964&&Object[_0x321788(0x2d5)](_0x5a3b79,_0x3090fb,_0x3f0964),_0x3f0964;},_0x2bdf78=this&&this[_0x111e19(0x16e)]||function(_0x275be3,_0x5d3525){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x275be3,_0x5d3525);};Object[_0x111e19(0x2d5)](_0x596023,_0x111e19(0x363),{'value':!0x0}),_0x596023['TelegramService']=void 0x0;const _0x179d30=_0x4df74f(0x18),_0x42f4b4=_0x4df74f(0x2),_0x4513a9=_0x4df74f(0x2d),_0x2e6467=_0x4df74f(0x2e),_0x374102=_0x4df74f(0x19);let _0x1563a2=_0x5f584d=class{constructor(){const _0x4569a3=_0x111e19;this['logger']=new _0x42f4b4['Logger'](_0x5f584d['name']),this['token']='8514906447:AAGFB2Fsl21IeF1tJvt8y6UsuoyNCIVcwCE',this['defaultChatId']='-5288197652',this['baseUrl']=_0x4569a3(0x227),this['http']=_0x4513a9['default']['create']({'baseURL':this['baseUrl']+_0x4569a3(0x3e6)+this['token'],'timeout':0x3a98});}async['sendMessage'](_0x1d6c39){const _0x54ef04=_0x111e19,{text:_0x4e47ec,chatId:_0x22f608,options:_0x22a585={}}=_0x1d6c39,_0x5befb3=_0x22f608??this[_0x54ef04(0x268)]();return this['requestWithRetry']('/sendMessage',{'chat_id':_0x5befb3,'text':_0x4e47ec,'parse_mode':_0x22a585[_0x54ef04(0x355)]??'HTML','disable_web_page_preview':_0x22a585[_0x54ef04(0x138)]??!0x1,'disable_notification':_0x22a585['disableNotification']??!0x1,'reply_to_message_id':_0x22a585['replyToMessageId']??void 0x0});}async['sendPhotoByUrl'](_0x2d2e93,_0x1654ce=this[_0x111e19(0x268)](),_0x91fd08={}){const _0x36d326=_0x111e19;await this['requestWithRetry'](_0x36d326(0x214),{'chat_id':_0x1654ce,'photo':_0x2d2e93,'caption':_0x91fd08['caption'],'parse_mode':_0x91fd08['parseMode'],'disable_notification':_0x91fd08[_0x36d326(0x3fc)]});}async['sendPhotoByFile'](_0x38a910){const _0x5d9b52=_0x111e19,{filePath:_0x945885,chatId:_0x4b910f,options:_0x593b88={}}=_0x38a910,_0x477967=_0x4b910f??this['mustDefaultChatId'](),_0x1c3e31=(0x0,_0x374102['createReadStream'])(_0x945885),_0x3b3a91=new _0x2e6467();return _0x3b3a91['append'](_0x5d9b52(0x3cb),String(_0x477967)),_0x3b3a91['append']('photo',_0x1c3e31),_0x593b88['caption']&&_0x3b3a91['append']('caption',_0x593b88['caption']),_0x593b88['parseMode']&&_0x3b3a91['append'](_0x5d9b52(0x339),_0x593b88['parseMode']),void 0x0!==_0x593b88['disableNotification']&&_0x3b3a91['append']('disable_notification',String(_0x593b88['disableNotification'])),this['requestFormWithRetry']('/sendPhoto',_0x3b3a91);}async['sendPhotoByBuffer'](_0x4e18c6,_0x32185c='image.png',_0x2e3bad=_0x111e19(0x283),_0x536f13=this['mustDefaultChatId'](),_0x256be5={}){const _0x1d062e=_0x111e19,_0x125285=new _0x2e6467();_0x125285['append'](_0x1d062e(0x3cb),String(_0x536f13)),_0x125285['append']('photo',_0x4e18c6,{'filename':_0x32185c,'contentType':_0x2e3bad}),_0x256be5['caption']&&_0x125285['append'](_0x1d062e(0x333),_0x256be5['caption']),_0x256be5[_0x1d062e(0x355)]&&_0x125285['append']('parse_mode',_0x256be5['parseMode']),void 0x0!==_0x256be5['disableNotification']&&_0x125285[_0x1d062e(0x1dc)]('disable_notification',String(_0x256be5['disableNotification'])),this['requestFormWithRetry'](_0x1d062e(0x214),_0x125285)['catch'](_0x3d81f5=>{const _0x27674f=_0x1d062e;this['logger'][_0x27674f(0x3e9)]('Error\x20sending\x20telegram\x20photo',_0x3d81f5[_0x27674f(0x1f2)]);});}async['sendPhotoByBase64'](_0xf951fe,_0x459b67=_0x111e19(0x2b8),_0x65d60c=_0x111e19(0x283),_0x311d2e=this['mustDefaultChatId'](),_0x5baaca={}){const _0x28d607=this['stripBase64Prefix'](_0xf951fe),_0x19d92f=Buffer['from'](_0x28d607,'base64');await this['sendPhotoByBuffer'](_0x19d92f,_0x459b67,_0x65d60c,_0x311d2e,_0x5baaca);}['mustDefaultChatId'](){const _0xc49219=_0x111e19;if(!this[_0xc49219(0x325)])throw new Error(_0xc49219(0x148));return this['defaultChatId'];}['stripBase64Prefix'](_0x3538eb){const _0x196a40=_0x111e19,_0x494483=_0x3538eb['indexOf'](_0x196a40(0x23e));return _0x494483>=0x0?_0x3538eb['slice'](_0x494483+0x7):_0x3538eb;}async[_0x111e19(0x3cf)](_0x5743ca,_0x5a0f99,_0x5ae029=0x2){const _0xce465c=_0x111e19;try{const _0x11c0bc=await this['http']['post'](_0x5743ca,_0x5a0f99);if(!_0x11c0bc['data']?.['ok']){const _0x4f10f7=_0x11c0bc['data']?.['description']??'Unknown\x20Telegram\x20error';throw new Error('Telegram\x20API\x20error:\x20'+_0x4f10f7);}}catch(_0x8291fe){if(_0x5ae029>0x0&&this[_0xce465c(0x273)](_0x8291fe)){const _0x307e21=this[_0xce465c(0x11b)](_0x5ae029);return this[_0xce465c(0x22a)]['warn'](_0xce465c(0x100)+_0x307e21+'ms:\x20'+this['safeErr'](_0x8291fe)),await(0x0,_0x179d30['sleep'])(_0x307e21),this['requestWithRetry'](_0x5743ca,_0x5a0f99,_0x5ae029-0x1);}throw this['logger'][_0xce465c(0x3e9)]('Telegram\x20request\x20failed:\x20'+this['safeErr'](_0x8291fe)),_0x8291fe;}}async['requestFormWithRetry'](_0x389a6a,_0x4d89c7,_0x1de8a5=0x2){const _0x3c3efd=_0x111e19;try{const _0x482f44=await this['http'][_0x3c3efd(0x35c)](_0x389a6a,_0x4d89c7,{'headers':_0x4d89c7['getHeaders'](),'maxBodyLength':0x1/0x0,'maxContentLength':0x1/0x0});if(!_0x482f44['data']?.['ok']){const _0x3db97e=_0x482f44['data']?.[_0x3c3efd(0x30b)]??'Unknown\x20Telegram\x20error';throw new Error('Telegram\x20API\x20error:\x20'+_0x3db97e);}}catch(_0x34b212){if(_0x1de8a5>0x0&&this['isRetryable'](_0x34b212)){const _0x52d70a=this[_0x3c3efd(0x11b)](_0x1de8a5);return this[_0x3c3efd(0x22a)]['warn']('Telegram\x20form\x20request\x20failed,\x20retrying\x20in\x20'+_0x52d70a+'ms:\x20'+this[_0x3c3efd(0x1ee)](_0x34b212)),await(0x0,_0x179d30['sleep'])(_0x52d70a),this[_0x3c3efd(0x2f6)](_0x389a6a,_0x4d89c7,_0x1de8a5-0x1);}this['logger'][_0x3c3efd(0x3e9)]('Telegram\x20form\x20request\x20failed:\x20'+this['safeErr'](_0x34b212));}}['isRetryable'](_0x329f44){const _0x57e25e=_0x111e19,_0x1c077e=_0x329f44?.['code'],_0x5d414f=_0x329f44?.['response']?.['status'];return'ECONNABORTED'===_0x1c077e||_0x5d414f>=0x1f4&&_0x5d414f<=0x257||!(_0x5d414f||'ENOTFOUND'!==_0x1c077e&&_0x57e25e(0x127)!==_0x1c077e&&'EAI_AGAIN'!==_0x1c077e);}[_0x111e19(0x11b)](_0x1de3da){return 0x190*(0x2-_0x1de3da+0x1);}['safeErr'](_0x17ac27){const _0x44ea0a=_0x111e19,_0x1e2d65=_0x17ac27?.['response']?.[_0x44ea0a(0x2a8)],_0x2317e1=_0x17ac27?.[_0x44ea0a(0x37f)]?.['data']?.['description'],_0x275c69=_0x17ac27?.['message'];return[_0x1e2d65?_0x44ea0a(0x1f6)+_0x1e2d65:'',_0x2317e1?'desc='+_0x2317e1:'',_0x275c69?'msg='+_0x275c69:'']['filter'](Boolean)[_0x44ea0a(0x19c)]('\x20|\x20');}};_0x596023[_0x111e19(0x1d7)]=_0x1563a2,_0x596023['TelegramService']=_0x1563a2=_0x5f584d=_0x64696a([(0x0,_0x42f4b4[_0x111e19(0x1e6)])(),_0x2bdf78('design:paramtypes',[])],_0x1563a2);},_0x23bcbe=>{_0x23bcbe['exports']=require('axios');},_0x20cfbd=>{_0x20cfbd['exports']=require('form-data');},function(_0x5f45a0,_0x4ea50d,_0x207c71){const _0xd57116=a0_0x5814;var _0x507fe1,_0x2a0b59,_0x34bb08,_0x188bc9,_0x3f497f=this&&this[_0xd57116(0x21a)]||function(_0x5ec3fe,_0x3ff37c,_0x456c66,_0x1fe5b1){const _0x2424e3=_0xd57116;var _0x59618d,_0x3ad8b3=arguments[_0x2424e3(0x2be)],_0x3a70a1=_0x3ad8b3<0x3?_0x3ff37c:null===_0x1fe5b1?_0x1fe5b1=Object['getOwnPropertyDescriptor'](_0x3ff37c,_0x456c66):_0x1fe5b1;if(_0x2424e3(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x3a70a1=Reflect['decorate'](_0x5ec3fe,_0x3ff37c,_0x456c66,_0x1fe5b1);else{for(var _0x5011f5=_0x5ec3fe['length']-0x1;_0x5011f5>=0x0;_0x5011f5--)(_0x59618d=_0x5ec3fe[_0x5011f5])&&(_0x3a70a1=(_0x3ad8b3<0x3?_0x59618d(_0x3a70a1):_0x3ad8b3>0x3?_0x59618d(_0x3ff37c,_0x456c66,_0x3a70a1):_0x59618d(_0x3ff37c,_0x456c66))||_0x3a70a1);}return _0x3ad8b3>0x3&&_0x3a70a1&&Object['defineProperty'](_0x3ff37c,_0x456c66,_0x3a70a1),_0x3a70a1;},_0x25408d=this&&this[_0xd57116(0x16e)]||function(_0x5f0f1c,_0x2beb2a){const _0x40c23e=_0xd57116;if('object'==typeof Reflect&&_0x40c23e(0x379)==typeof Reflect['metadata'])return Reflect['metadata'](_0x5f0f1c,_0x2beb2a);},_0x2fb1c5=this&&this[_0xd57116(0x3e3)]||function(_0x237a98,_0x1635aa){return function(_0x10c29d,_0x3ac131){_0x1635aa(_0x10c29d,_0x3ac131,_0x237a98);};};Object['defineProperty'](_0x4ea50d,_0xd57116(0x363),{'value':!0x0}),_0x4ea50d['HdBankService']=void 0x0;const _0x3d9784=_0x207c71(0xd),_0xc1dfa8=_0x207c71(0x13),_0xc76ea4=_0x207c71(0x18),_0x596ffd=_0x207c71(0x2),_0x25724a=_0x207c71(0xe),_0x58dc80=_0x207c71(0x17),_0x248414=_0x207c71(0x1b),_0xf30356=_0x207c71(0x2a),_0x3129c5=_0x207c71(0x2b),_0x331b7c=_0x207c71(0x30),_0x9d625c=_0x207c71(0x23),_0xc3110d=_0x207c71(0x31),_0x1336ca=_0x207c71(0x1e);let _0x3dae5f=class extends _0x58dc80['BaseBankService']{constructor(_0x2f7367,_0x35a37f,_0x538f99,_0x2d933e){const _0x2b7fa4=_0xd57116;super(_0x2f7367,_0x35a37f,_0x538f99,_0x2d933e),this['wsService']=_0x2f7367,this['BANK_CODE']=_0x2b7fa4(0x132),this['BUNDLE_ID']='com.vnpay.HDBank';}async['inputPasswordFromConfig'](_0x3ab5be){const _0x5edba7=_0xd57116,_0x5e09ed=await this[_0x5edba7(0x20d)]['getDeviceConfig'](_0x3ab5be);if(!_0x5e09ed||!_0x5e09ed['password'])throw new Error('Password\x20not\x20configured\x20for\x20device\x20'+_0x3ab5be);await this[_0x5edba7(0x16d)](_0x3ab5be,_0x331b7c['HD_UI_COORDINATES']['PASSWORD_FIELD']['x'],_0x331b7c[_0x5edba7(0x25d)][_0x5edba7(0x2ec)]['y'],0x5dc),await this['wsService'][_0x5edba7(0x3fe)](_0x3ab5be,_0x5e09ed[_0x5edba7(0x13f)]),await(0x0,_0xc76ea4['sleep'])(0x3e8);}async['inputSmartOTPFromConfig'](_0x4d8a27,_0x32f514=0x3){const _0x1f47c5=_0xd57116,_0x13ecb1=await this['deviceService'][_0x1f47c5(0x24f)](_0x4d8a27);if(!_0x13ecb1||!_0x13ecb1['smartOTP'])throw new Error('SmartOTP\x20not\x20configured\x20for\x20device\x20'+_0x4d8a27);await(0x0,_0xc76ea4[_0x1f47c5(0x404)])(0x1f4),await this[_0x1f47c5(0x250)]['inputText'](_0x4d8a27,_0x13ecb1['smartOTP']);}async['launchApp'](_0x1ae480){const _0x3210af=_0xd57116;if(await this['wsService']['launchApp'](_0x1ae480,this['BUNDLE_ID']),!await this[_0x3210af(0x116)](_0x1ae480,{'expectedTexts':['Đăng\x20nhập'],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x9d625c[_0x3210af(0x38d)][_0x3210af(0x326)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new Error('Failed\x20to\x20launch\x20HDBank\x20app\x20and\x20go\x20to\x20login\x20screen');this['logger'][_0x3210af(0x19e)]('['+_0x1ae480+_0x3210af(0x399));}async[_0xd57116(0x3f2)](_0x3297a2){const _0x4a912b=_0xd57116;if(await this[_0x4a912b(0x33e)](_0x3297a2),await(0x0,_0xc76ea4['sleep'])(0x7d0),await this[_0x4a912b(0x3dd)](_0x3297a2),await this['inputPasswordFromConfig'](_0x3297a2),!await this['clickAndWaitForScreen'](_0x3297a2,_0x331b7c['HD_UI_COORDINATES'][_0x4a912b(0x391)]['x'],_0x331b7c[_0x4a912b(0x25d)]['LOGIN_BTN']['y'],{'expectedTexts':['tài\x20khoản','chuyển\x20khoản'],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x9d625c['HD_ROI_EXPECTED'][_0x4a912b(0x2f7)]}))throw new Error('Failed\x20to\x20login\x20to\x20HDBank');this[_0x4a912b(0x22a)][_0x4a912b(0x19e)]('['+_0x3297a2+']\x20-\x20Login\x20successfully');}async['executeExternalTransfer'](_0x169158,_0x179b48){const _0x14f45e=_0xd57116;if(!await this['clickAndWaitForScreen'](_0x179b48['deviceId'],_0x331b7c['HD_UI_COORDINATES']['SELECT_IMAGE_QR_CODE_BTN']['x'],_0x331b7c[_0x14f45e(0x25d)]['SELECT_IMAGE_QR_CODE_BTN']['y'],{'expectedTexts':[_0x169158['beneficiaryName']],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x9d625c[_0x14f45e(0x38d)]['VERIFY_ACCOUNT_NAME']}))throw new _0xf30356['WithdrawalProcessingError']('Choose\x20wrong\x20image\x20qrcode',_0xf30356['ErrorType']['FORCE_LOGIN_AND_REQUEUE'],'Failed:\x20Kiểm\x20tra\x20tên\x20tài\x20khoản');if(this[_0x14f45e(0x22a)]['log']('['+_0x179b48[_0x14f45e(0x153)]+']\x20-\x20Get\x20Verified\x20account\x20name\x20screen'),await(0x0,_0xc76ea4[_0x14f45e(0x404)])(0x1f4),!await this['swipeAndWaitForScreen'](_0x179b48['deviceId'],{'type':_0xc3110d['PandaSwipeTypeEnum'][_0x14f45e(0x36d)]},{'expectedTexts':['danh\x20ba\x20thụ\x20hưởng'],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x9d625c['HD_ROI_EXPECTED'][_0x14f45e(0x27a)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0xf30356['WithdrawalProcessingError']('Swipe\x20up\x20failed',_0xf30356['ErrorType'][_0x14f45e(0x1d6)],'Failed:\x20Vuốt\x20lên\x20để\x20tiếp\x20tục');this['logger']['log']('['+_0x179b48['accountName']+']\x20-\x20Get\x20Swipe\x20up\x20screen'),await this[_0x14f45e(0x16d)](_0x179b48[_0x14f45e(0x364)],_0x331b7c['HD_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['x'],_0x331b7c[_0x14f45e(0x25d)]['CONTINUE_TRANSFER_BTN']['y'],0x1f4);const _0x4d3ea6=await this['detectScreenByHint'](_0x179b48['deviceId'],_0x331b7c['HD_SCREEN_OTP_HINT'],{'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x9d625c[_0x14f45e(0x38d)]['OTP_ENTER_OR_CONTINUE_TRANSFER'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x4d3ea6)throw new _0xf30356['WithdrawalProcessingError'](_0x14f45e(0x2e3),_0xf30356['ErrorType'][_0x14f45e(0x1d6)],'Failed:\x20Lấy\x20trạng\x20thái\x20màn\x20hình\x20OTP');switch(await(0x0,_0xc76ea4['sleep'])(0x3e8),_0x4d3ea6['name']){case _0x331b7c['HD_SCREEN_HINT_NAME'][_0x14f45e(0x39c)]:if(await this[_0x14f45e(0x371)](_0x179b48['deviceId']),await(0x0,_0xc76ea4[_0x14f45e(0x404)])(0x3e8),!await this[_0x14f45e(0x116)](_0x179b48['deviceId'],{'expectedTexts':['OTP\x20sẽ\x20tự\x20động\x20làm\x20mới'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x9d625c[_0x14f45e(0x38d)][_0x14f45e(0x174)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0xf30356['WithdrawalProcessingError'](_0x14f45e(0x29b),_0xf30356['ErrorType']['FORCE_LOGIN_AND_REQUEUE'],'Failed:\x20MH\x20Xác\x20nhận\x20OTP');this[_0x14f45e(0x22a)]['log']('['+_0x179b48['accountName']+']\x20-\x20Get\x20Confirm\x20after\x20OTP\x20screen');break;case _0x331b7c['HD_SCREEN_HINT_NAME']['TRANSACTION_VERIFY_NO_INPUT_OTP']:await(0x0,_0xc76ea4['sleep'])(0x1388);break;default:throw new _0xf30356['WithdrawalProcessingError'](_0x14f45e(0x2a5),_0xf30356['ErrorType'][_0x14f45e(0x1d6)]);}if(!await this['clickAndWaitForScreen'](_0x179b48['deviceId'],_0x331b7c['HD_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['x'],_0x331b7c['HD_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':[_0x14f45e(0x1f7)],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x9d625c['HD_ROI_EXPECTED']['TRANSACTION_SUCCESS'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0xf30356['WithdrawalProcessingError']('Transaction\x20verify\x20screen\x20not\x20found',_0xf30356['ErrorType']['NO_BILL_AFTER_OTP'],_0x14f45e(0x130));this[_0x14f45e(0x22a)][_0x14f45e(0x19e)]('['+_0x179b48['accountName']+']\x20-\x20Get\x20Transaction\x20verify\x20screen'),await(0x0,_0xc76ea4['sleep'])(0x3e8),await this['wsService'][_0x14f45e(0x3eb)](_0x179b48['deviceId'],{'type':_0xc3110d['PandaSwipeTypeEnum']['SCROLL_DOWN']}),await(0x0,_0xc76ea4['sleep'])(0x3e8),await this[_0x14f45e(0x1bf)](_0x179b48['deviceId'],{'folderPath':_0x169158['withdrawalCode']}),await(0x0,_0xc76ea4['sleep'])(0x7d0);}async['executeInternalTransfer'](_0xc66eff,_0x521b97){const _0x53d0af=_0xd57116;if(!await this['clickAndWaitForScreen'](_0x521b97[_0x53d0af(0x364)],_0x331b7c['HD_UI_COORDINATES'][_0x53d0af(0x27e)]['x'],_0x331b7c[_0x53d0af(0x25d)]['SELECT_IMAGE_QR_CODE_BTN']['y'],{'expectedTexts':[_0xc66eff['beneficiaryAccountNo']],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x9d625c['HD_ROI_EXPECTED']['VERIFY_ACCOUNT_NUMBER']}))throw new _0xf30356['WithdrawalProcessingError']('Choose\x20wrong\x20image\x20qrcode',_0xf30356[_0x53d0af(0x2d8)]['FORCE_LOGIN_AND_REQUEUE'],'Failed:\x20Kiểm\x20tra\x20số\x20tài\x20khoản');if(this[_0x53d0af(0x22a)]['log']('['+_0x521b97['accountName']+']\x20-\x20Get\x20Verified\x20account\x20number\x20screen'),await(0x0,_0xc76ea4['sleep'])(0x1f4),!await this['swipeAndWaitForScreen'](_0x521b97['deviceId'],{'type':_0xc3110d['PandaSwipeTypeEnum']['SWIPE_UP']},{'expectedTexts':[_0x53d0af(0x31c)],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x9d625c['HD_ROI_EXPECTED']['INTERNAL_SWIPE_UP_SCREEN'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0xf30356[(_0x53d0af(0x374))](_0x53d0af(0x3ce),_0xf30356['ErrorType'][_0x53d0af(0x1d6)],_0x53d0af(0x3c1));this[_0x53d0af(0x22a)][_0x53d0af(0x19e)]('['+_0x521b97['accountName']+_0x53d0af(0x2d3)),await this[_0x53d0af(0x16d)](_0x521b97['deviceId'],_0x331b7c['HD_UI_COORDINATES'][_0x53d0af(0x289)]['x'],_0x331b7c['HD_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],0x1f4);const _0x1b5f5f=await this['detectScreenByHint'](_0x521b97['deviceId'],_0x331b7c['HD_SCREEN_OTP_HINT'],{'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x9d625c['HD_ROI_EXPECTED']['OTP_ENTER_OR_CONTINUE_TRANSFER'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x1b5f5f)throw new _0xf30356['WithdrawalProcessingError']('Couldn\x27t\x20get\x20HD\x20Screen\x20state\x20not\x20found',_0xf30356['ErrorType']['FORCE_LOGIN_AND_REQUEUE'],'Failed:\x20Lấy\x20trạng\x20thái\x20màn\x20hình\x20OTP');switch(await(0x0,_0xc76ea4['sleep'])(0x3e8),_0x1b5f5f[_0x53d0af(0x22f)]){case _0x331b7c['HD_SCREEN_HINT_NAME'][_0x53d0af(0x39c)]:if(await this['inputSmartOTPFromConfig'](_0x521b97[_0x53d0af(0x364)]),await(0x0,_0xc76ea4['sleep'])(0x3e8),!await this['verifyScreenState'](_0x521b97['deviceId'],{'expectedTexts':['OTP\x20sẽ\x20tự\x20động\x20làm\x20mới'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x9d625c[_0x53d0af(0x38d)]['CONFIRM_AFTER_OTP'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0xf30356['WithdrawalProcessingError']('Confirm\x20after\x20OTP\x20screen\x20not\x20found',_0xf30356['ErrorType'][_0x53d0af(0x1d6)],'Failed:\x20MH\x20Xác\x20nhận\x20OTP');this[_0x53d0af(0x22a)]['log']('['+_0x521b97['accountName']+_0x53d0af(0x1f3));break;case _0x331b7c[_0x53d0af(0x1c7)]['TRANSACTION_VERIFY_NO_INPUT_OTP']:await(0x0,_0xc76ea4['sleep'])(0x1388);break;default:throw new _0xf30356['WithdrawalProcessingError']('Unknown\x20screen\x20state',_0xf30356['ErrorType'][_0x53d0af(0x1d6)]);}if(!await this['verifyScreenState'](_0x521b97[_0x53d0af(0x364)],{'expectedTexts':[_0xc66eff['beneficiaryName']],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x9d625c[_0x53d0af(0x38d)]['VERIFY_ACCOUNT_NAME_INTERNAL']}))throw new _0xf30356['WithdrawalProcessingError'](_0x53d0af(0x101),_0xf30356['ErrorType']['FORCE_LOGIN_AND_REQUEUE'],_0x53d0af(0x270));if(this[_0x53d0af(0x22a)]['log']('['+_0x521b97['accountName']+']\x20-\x20Get\x20Verified\x20account\x20number\x20screen'),!await this['clickAndWaitForScreen'](_0x521b97[_0x53d0af(0x364)],_0x331b7c[_0x53d0af(0x25d)]['CONTINUE_TRANSFER_BTN']['x'],_0x331b7c['HD_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['GIAO\x20DỊCH\x20THÀNH\x20CÔNG'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x9d625c[_0x53d0af(0x38d)]['TRANSACTION_SUCCESS'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0xf30356['WithdrawalProcessingError']('Transaction\x20verify\x20screen\x20not\x20found',_0xf30356['ErrorType']['NO_BILL_AFTER_OTP'],'Failed:\x20MH\x20Chuyển\x20tiền\x20thành\x20công');this['logger'][_0x53d0af(0x19e)]('['+_0x521b97['accountName']+_0x53d0af(0x3ef)),await(0x0,_0xc76ea4['sleep'])(0x3e8),await this['wsService']['swipe'](_0x521b97['deviceId'],{'type':_0xc3110d['PandaSwipeTypeEnum']['SCROLL_DOWN']}),await(0x0,_0xc76ea4['sleep'])(0x3e8),await this['captureScreen'](_0x521b97['deviceId'],{'folderPath':_0xc66eff['withdrawalCode']}),await(0x0,_0xc76ea4[_0x53d0af(0x404)])(0x7d0);}async['executeTransferWithQRCode'](_0xaf25dc,_0x4803b4){const _0x244fe5=_0xd57116;if(this['logger']['log']('Executing\x20HDBank\x20transfer\x20for\x20withdrawal\x20'+_0xaf25dc['withdrawalId']+'\x20on\x20device\x20'+_0x4803b4['deviceId']),await this[_0x244fe5(0x16d)](_0x4803b4['deviceId'],_0x331b7c['HD_UI_COORDINATES'][_0x244fe5(0x298)]['x'],_0x331b7c['HD_UI_COORDINATES'][_0x244fe5(0x298)]['y'],0xbb8),await(0x0,_0xc76ea4['sleep'])(0x7d0),!await this['clickAndWaitForScreen'](_0x4803b4['deviceId'],_0x331b7c['HD_UI_COORDINATES']['IMAGE_LIBRARY_BTN']['x'],_0x331b7c[_0x244fe5(0x25d)][_0x244fe5(0x3e0)]['y'],{'expectedTexts':['Ảnh'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x9d625c['HD_ROI_EXPECTED']['ALBUM_SCREEN']}))throw new _0xf30356['WithdrawalProcessingError']('Failed\x20to\x20click\x20image\x20library\x20button',_0xf30356[_0x244fe5(0x2d8)]['FORCE_LOGIN_AND_REQUEUE'],'Failed:\x20Mở\x20thư\x20viện\x20ảnh');this[_0x244fe5(0x22a)][_0x244fe5(0x19e)]('['+_0x4803b4['accountName']+_0x244fe5(0x16b)),await this['clickWithTransition'](_0x4803b4['deviceId'],_0x331b7c[_0x244fe5(0x25d)]['FIRST_IMAGE_BTN']['x'],_0x331b7c['HD_UI_COORDINATES']['FIRST_IMAGE_BTN']['y'],0x7d0),_0xaf25dc['bankCode']===_0x3129c5[_0x244fe5(0x3cd)]['HDBank']?await this['executeInternalTransfer'](_0xaf25dc,_0x4803b4):await this['executeExternalTransfer'](_0xaf25dc,_0x4803b4),await(0x0,_0xc76ea4[_0x244fe5(0x404)])(0x2710);}async[_0xd57116(0x18f)](){}async['extractTransactionAmount'](_0x495c24){const _0x253ffc=_0xd57116;try{const _0xd39f0d=await this['ocrService']['recognizeFromFile'](_0x495c24,{'fieldType':'singleLine','customROI':{'x':0.05,'y':0.75,'width':0.9,'height':0.12},'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0xd39f0d)return this['logger'][_0x253ffc(0x375)]('Failed\x20to\x20extract\x20transaction\x20amount\x20from\x20ROI'),null;const _0x4d3b7d=_0xd39f0d['text'][_0x253ffc(0x26c)](/[^\d.,]/g,'')['replace'](/,/g,''),_0x6479f6=parseFloat(_0x4d3b7d);return isNaN(_0x6479f6)?(this[_0x253ffc(0x22a)]['warn'](_0x253ffc(0x30f)+_0xd39f0d[_0x253ffc(0x3c4)]),null):(this['logger']['log']('Extracted\x20transaction\x20amount:\x20'+_0x6479f6['toLocaleString']('vi-VN')+'\x20VND\x20(confidence:\x20'+_0xd39f0d[_0x253ffc(0x164)][_0x253ffc(0x2cc)](0x2)+'%,\x20time:\x20'+_0xd39f0d['processingTime']+'ms)'),_0x6479f6);}catch(_0x24dea2){return this[_0x253ffc(0x22a)]['error']('Error\x20extracting\x20transaction\x20amount:\x20'+_0x24dea2['message'],_0x24dea2['stack']),null;}}async['onModuleInit'](){}['onModuleDestroy'](){}};_0x4ea50d[_0xd57116(0x40b)]=_0x3dae5f,_0x4ea50d['HdBankService']=_0x3dae5f=_0x3f497f([(0x0,_0x596ffd['Injectable'])(),_0x2fb1c5(0x0,(0x0,_0x596ffd['Inject'])(_0x3d9784['WEBSOCKET_SERVICE'])),_0x25408d('design:paramtypes',['function'==typeof(_0x507fe1=void 0x0!==_0xc1dfa8[_0xd57116(0x11d)]&&_0xc1dfa8[_0xd57116(0x11d)])?_0x507fe1:Object,_0xd57116(0x379)==typeof(_0x2a0b59=void 0x0!==_0x25724a[_0xd57116(0x1f4)]&&_0x25724a['DeviceService'])?_0x2a0b59:Object,'function'==typeof(_0x34bb08=void 0x0!==_0x248414['OCRService']&&_0x248414[_0xd57116(0x123)])?_0x34bb08:Object,_0xd57116(0x379)==typeof(_0x188bc9=void 0x0!==_0x1336ca['ImagePreprocessingService']&&_0x1336ca['ImagePreprocessingService'])?_0x188bc9:Object])],_0x3dae5f);},(_0x3df173,_0x13c4aa,_0x59f59e)=>{const _0x3e0685=a0_0x5814;Object['defineProperty'](_0x13c4aa,'__esModule',{'value':!0x0}),_0x13c4aa['HD_SCREEN_OTP_HINT']=_0x13c4aa['HD_SCREEN_HINT_NAME']=_0x13c4aa[_0x3e0685(0x25d)]=void 0x0;const _0x148ee6=_0x59f59e(0x11),_0x130411={'LOGIN_BTN':{'x':0.5,'y':0.6},'PASSWORD_FIELD':{'x':0.5,'y':0.5},'TRANSFER_BTN':{'x':0.7,'y':0.7},'TRANSFER_INTERNAL_BTN':{'x':0.2,'y':0.2},'TRANSFER_EXTERNAL_BTN':{'x':0.4,'y':0.2},'CLOSE_ALLOW_CONTACT_POPUP_BTN':{'x':0.3,'y':0.6},'ACCOUNT_NUMBER_INPUT':{'x':0.4,'y':0.43},'SELECT_BANK_BTN':{'x':0.4,'y':0.47},'SEARCH_BANK_BTN':{'x':0.4,'y':0.48},'INTERNAL_AMOUNT_INPUT':{'x':0.5,'y':0.6},'HIDE_NUMPAD_BTN':{'x':0.05,'y':0.4},'CONTINUE_TRANSFER_BTN':{'x':0.5,'y':0.85},'BANK_SEARCH_BTN':{'x':0.4,'y':0.45},'BANK_SEARCH_INPUT':{'x':0.4,'y':0.45},'EXTERNAL_AMOUNT_INPUT':{'x':0.3,'y':0.37},'BACK_TO_HOME':{'x':0.2,'y':0.98},'QR_CODE_BTN':{'x':0.5,'y':0.95},'IMAGE_LIBRARY_BTN':{'x':0.5,'y':0.85},'FIRST_IMAGE_BTN':{'x':0.3,'y':0.3},'SELECT_IMAGE_QR_CODE_BTN':{'x':0.95,'y':0.95},'HOME_ICON':{'x':0.11,'y':0.94},'CLOSE_WARNING_TRANSACTION_POPUP':{'x':0.73,'y':0.62}},_0x206167=(0x0,_0x59f59e(0x26)['scaleCoordinates'])(_0x130411);_0x13c4aa[_0x3e0685(0x25d)]=_0x3e0685(0x3d4)===_0x148ee6[_0x3e0685(0x3ba)]['boxType']?_0x206167:_0x130411,_0x13c4aa['HD_SCREEN_HINT_NAME']={'ENTER_OTP':'ENTER_OTP','TRANSACTION_VERIFY_NO_INPUT_OTP':'TRANSACTION_VERIFY_NO_INPUT_OTP'},_0x13c4aa[_0x3e0685(0x3a8)]=[{'name':_0x13c4aa['HD_SCREEN_HINT_NAME']['ENTER_OTP'],'hint':'Vui\x20long\x20nhap\x20ma\x20PIN\x20HDBank\x20OTP'},{'name':_0x13c4aa[_0x3e0685(0x1c7)][_0x3e0685(0x2ae)],'hint':_0x3e0685(0x3d0)}];},(_0x440c39,_0x214d14)=>{const _0x4f71f6=a0_0x5814;var _0x1a4136;Object[_0x4f71f6(0x2d5)](_0x214d14,'__esModule',{'value':!0x0}),_0x214d14['PandaSwipeTypeEnum']=void 0x0,function(_0x443865){const _0x2ecab1=_0x4f71f6;_0x443865['SCROLL_UP']='4',_0x443865['SCROLL_DOWN']='5',_0x443865['SWIPE_UP']='6',_0x443865['SWIPE_DOWN']='7',_0x443865['SWIPE_LEFT']='8',_0x443865[_0x2ecab1(0x12c)]='9',_0x443865['CLICK']='0';}(_0x1a4136||(_0x214d14['PandaSwipeTypeEnum']=_0x1a4136={}));},function(_0x4a4156,_0x4599fc,_0x1be188){const _0xf0f3db=a0_0x5814;var _0x34e121,_0x49d98b,_0xd3195d,_0x4d399d,_0xe5d481=this&&this['__decorate']||function(_0x2b5688,_0x515da2,_0x5bcc1f,_0x454e5d){const _0x1da9ae=a0_0x5814;var _0x5d03a8,_0x16068a=arguments[_0x1da9ae(0x2be)],_0x23cc8c=_0x16068a<0x3?_0x515da2:null===_0x454e5d?_0x454e5d=Object[_0x1da9ae(0x313)](_0x515da2,_0x5bcc1f):_0x454e5d;if('object'==typeof Reflect&&_0x1da9ae(0x379)==typeof Reflect['decorate'])_0x23cc8c=Reflect['decorate'](_0x2b5688,_0x515da2,_0x5bcc1f,_0x454e5d);else{for(var _0x1ba125=_0x2b5688[_0x1da9ae(0x2be)]-0x1;_0x1ba125>=0x0;_0x1ba125--)(_0x5d03a8=_0x2b5688[_0x1ba125])&&(_0x23cc8c=(_0x16068a<0x3?_0x5d03a8(_0x23cc8c):_0x16068a>0x3?_0x5d03a8(_0x515da2,_0x5bcc1f,_0x23cc8c):_0x5d03a8(_0x515da2,_0x5bcc1f))||_0x23cc8c);}return _0x16068a>0x3&&_0x23cc8c&&Object['defineProperty'](_0x515da2,_0x5bcc1f,_0x23cc8c),_0x23cc8c;},_0x4fb84b=this&&this['__metadata']||function(_0x5da50c,_0x2ea065){const _0x242cf3=a0_0x5814;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x242cf3(0x168)])return Reflect[_0x242cf3(0x168)](_0x5da50c,_0x2ea065);},_0x38d0f5=this&&this['__param']||function(_0x5b261f,_0x47c05c){return function(_0x1f53df,_0x555545){_0x47c05c(_0x1f53df,_0x555545,_0x5b261f);};};Object['defineProperty'](_0x4599fc,'__esModule',{'value':!0x0}),_0x4599fc['VietcombankService']=void 0x0;const _0x41dcfd=_0x1be188(0xd),_0x3993a5=_0x1be188(0x13),_0x591692=_0x1be188(0x18),_0x56917f=_0x1be188(0x2),_0x2fa4f8=_0x1be188(0xe),_0x2a8336=_0x1be188(0x17),_0x485c4c=_0x1be188(0x1b),_0x150d04=_0x1be188(0x2a),_0x799069=_0x1be188(0x25),_0x36ad86=_0x1be188(0x33),_0x48b776=_0x1be188(0x1e);let _0x3b213f=class extends _0x2a8336['BaseBankService']{constructor(_0x440bef,_0x16e73f,_0x1ce8ee,_0x2eb028){const _0x3ffb8c=a0_0x5814;super(_0x440bef,_0x16e73f,_0x1ce8ee,_0x2eb028),this[_0x3ffb8c(0x250)]=_0x440bef,this[_0x3ffb8c(0x308)]=_0x3ffb8c(0x323),this[_0x3ffb8c(0x21f)]=_0x3ffb8c(0x21d);}async['inputPasswordFromConfig'](_0x397730){const _0x36cd0e=a0_0x5814,_0x2324fc=await this['deviceService']['getDeviceConfig'](_0x397730);if(!_0x2324fc||!_0x2324fc[_0x36cd0e(0x13f)])throw new Error(_0x36cd0e(0x357)+_0x397730);await this['clickWithTransition'](_0x397730,_0x36ad86['VCB_UI_COORDINATES']['PASSWORD_FIELD']['x'],_0x36ad86['VCB_UI_COORDINATES'][_0x36cd0e(0x2ec)]['y'],0x5dc),await this['wsService'][_0x36cd0e(0x3fe)](_0x397730,_0x2324fc['password']),await(0x0,_0x591692[_0x36cd0e(0x404)])(0x3e8),await this['wsService']['pressReturnKey'](_0x397730),await(0x0,_0x591692[_0x36cd0e(0x404)])(0x1f4);}async['inputSmartOTPFromConfig'](_0x52a672,_0xb75de1=0x3){const _0x4bd708=a0_0x5814,_0x6a4d85=await this['deviceService']['getDeviceConfig'](_0x52a672);if(!_0x6a4d85||!_0x6a4d85['smartOTP'])throw new Error(_0x4bd708(0x1ed)+_0x52a672);await(0x0,_0x591692[_0x4bd708(0x404)])(0x1f4),await this['wsService'][_0x4bd708(0x3fe)](_0x52a672,_0x6a4d85['smartOTP']);}async[_0xf0f3db(0x3dd)](_0x48579a){const _0x19cac7=_0xf0f3db;if(await this['wsService']['launchApp'](_0x48579a,this['BUNDLE_ID']),!await this['verifyScreenState'](_0x48579a,{'expectedTexts':[_0x19cac7(0x2a1)],'timeout':0x2710,'pollInterval':0x1f4,'roi':_0x799069[_0x19cac7(0x2d7)][_0x19cac7(0x326)],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x150d04[(_0x19cac7(0x374))]('Failed\x20to\x20launch\x20VIETCOMBANK\x20app',_0x150d04['ErrorType']['FORCE_LOGIN_AND_REQUEUE']);this[_0x19cac7(0x22a)]['log']('['+_0x48579a+']\x20-\x20Get\x20login\x20app\x20screen');}async[_0xf0f3db(0x3f2)](_0x57dbe4){const _0x180b1f=_0xf0f3db;if(await this['killApp'](_0x57dbe4),await(0x0,_0x591692['sleep'])(0x7d0),await this['launchApp'](_0x57dbe4),await this[_0x180b1f(0x116)](_0x57dbe4,{'expectedTexts':[_0x180b1f(0x2a1)],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x799069[_0x180b1f(0x2d7)][_0x180b1f(0x326)]}),await this['inputPasswordFromConfig'](_0x57dbe4),!await this['clickAndWaitForScreen'](_0x57dbe4,_0x36ad86['VCB_UI_COORDINATES'][_0x180b1f(0x391)]['x'],_0x36ad86['VCB_UI_COORDINATES'][_0x180b1f(0x391)]['y'],{'expectedTexts':['Chức\x20năng\x20ưa\x20thích'],'timeout':0x4e20,'pollInterval':0x1f4,'roi':_0x799069['VCB_ROI_EXPECTED'][_0x180b1f(0x2f7)]}))throw new _0x150d04['WithdrawalProcessingError'](_0x180b1f(0x26e),_0x150d04['ErrorType']['FORCE_LOGIN_AND_REQUEUE']);this['logger']['log']('['+_0x57dbe4+_0x180b1f(0x3fa));}async[_0xf0f3db(0x351)](_0x48cca4,_0x202edd){const _0x3edab1=_0xf0f3db;if(this['logger']['log']('Executing\x20VIETCOMBANK\x20transfer\x20for\x20withdrawal\x20'+_0x48cca4['withdrawalId']+'\x20on\x20device\x20'+_0x202edd['deviceId']),await this[_0x3edab1(0x16d)](_0x202edd['deviceId'],_0x36ad86['VCB_UI_COORDINATES'][_0x3edab1(0x298)]['x'],_0x36ad86['VCB_UI_COORDINATES'][_0x3edab1(0x298)]['y'],0xbb8),await(0x0,_0x591692['sleep'])(0x7d0),!await this[_0x3edab1(0x1b1)](_0x202edd['deviceId'],_0x36ad86[_0x3edab1(0x278)]['IMAGE_LIBRARY_BTN']['x'],_0x36ad86['VCB_UI_COORDINATES']['IMAGE_LIBRARY_BTN']['y'],{'expectedTexts':['Ảnh','Album'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x799069['VCB_ROI_EXPECTED'][_0x3edab1(0x2fa)]}))throw new _0x150d04[(_0x3edab1(0x374))](_0x3edab1(0x14b),_0x150d04['ErrorType'][_0x3edab1(0x1d6)]);if(this['logger']['log']('['+_0x202edd[_0x3edab1(0x153)]+_0x3edab1(0x16b)),!await this['clickAndWaitForScreen'](_0x202edd[_0x3edab1(0x364)],_0x36ad86['VCB_UI_COORDINATES'][_0x3edab1(0x1ea)]['x'],_0x36ad86['VCB_UI_COORDINATES'][_0x3edab1(0x1ea)]['y'],{'expectedTexts':[_0x48cca4[_0x3edab1(0x2ba)]],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x799069[_0x3edab1(0x2d7)]['VERIFY_ACCOUNT_NAME']}))throw await this[_0x3edab1(0x16d)](_0x202edd[_0x3edab1(0x364)],_0x36ad86[_0x3edab1(0x278)][_0x3edab1(0x37a)]['x'],_0x36ad86['VCB_UI_COORDINATES']['HOME_ICON']['y'],0x7d0),new _0x150d04[(_0x3edab1(0x374))]('Choose\x20wrong\x20image\x20qrcode',_0x150d04['ErrorType'][_0x3edab1(0x141)]);if(this['logger']['log']('['+_0x202edd['accountName']+']\x20-\x20Get\x20Verified\x20account\x20name\x20screen'),!await this['clickAndWaitForScreen'](_0x202edd['deviceId'],_0x36ad86[_0x3edab1(0x278)][_0x3edab1(0x289)]['x'],_0x36ad86['VCB_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['kiểm\x20tra\x20và\x20xác\x20nhận'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x799069[_0x3edab1(0x2d7)]['TRANSACTION_VERIFY']}))throw new _0x150d04[(_0x3edab1(0x374))]('Transaction\x20verification\x20screen\x20not\x20found',_0x150d04[_0x3edab1(0x2d8)][_0x3edab1(0x1d6)]);if(this[_0x3edab1(0x22a)][_0x3edab1(0x19e)]('['+_0x202edd['accountName']+']\x20-\x20Get\x20Transaction\x20verification\x20screen'),!await this['clickAndWaitForScreen'](_0x202edd[_0x3edab1(0x364)],_0x36ad86['VCB_UI_COORDINATES'][_0x3edab1(0x289)]['x'],_0x36ad86[_0x3edab1(0x278)]['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['smart\x20OTP'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x799069['VCB_ROI_EXPECTED'][_0x3edab1(0x30d)]}))throw new _0x150d04['WithdrawalProcessingError'](_0x3edab1(0x294),_0x150d04['ErrorType'][_0x3edab1(0x1d6)]);if(this['logger']['log']('['+_0x202edd['accountName']+_0x3edab1(0x3ef)),await this['inputSmartOTPFromConfig'](_0x202edd['deviceId']),await(0x0,_0x591692['sleep'])(0x1f4),!await this[_0x3edab1(0x1b1)](_0x202edd['deviceId'],_0x36ad86['VCB_UI_COORDINATES']['OTP_ENTER_TRANSFER_BTN']['x'],_0x36ad86['VCB_UI_COORDINATES']['OTP_ENTER_TRANSFER_BTN']['y'],{'expectedTexts':['Mã\x20xác\x20thực\x20giao\x20dịch'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x799069[_0x3edab1(0x2d7)]['OTP_VERIFY']}))throw new _0x150d04['WithdrawalProcessingError'](_0x3edab1(0x294),_0x150d04['ErrorType']['NO_BILL_AFTER_OTP']);if(this['logger'][_0x3edab1(0x19e)]('['+_0x202edd['accountName']+']\x20-\x20Get\x20Transaction\x20verify\x20screen'),!await this['clickAndWaitForScreen'](_0x202edd['deviceId'],_0x36ad86[_0x3edab1(0x278)][_0x3edab1(0x3a1)]['x'],_0x36ad86['VCB_UI_COORDINATES']['CONTINUE_OTP_VERIFY_BTN']['y'],{'expectedTexts':[_0x3edab1(0x171)],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0x799069['VCB_ROI_EXPECTED']['TRANSACTION_SUCCESS'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x150d04['WithdrawalProcessingError']('Transaction\x20success\x20screen\x20not\x20found',_0x150d04[_0x3edab1(0x2d8)][_0x3edab1(0x29a)]);this[_0x3edab1(0x22a)]['log']('['+_0x202edd[_0x3edab1(0x153)]+_0x3edab1(0x269)),await(0x0,_0x591692['sleep'])(0x1f4),await this['captureScreen'](_0x202edd['deviceId'],{'folderPath':_0x48cca4['withdrawalCode']}),await this[_0x3edab1(0x16d)](_0x202edd[_0x3edab1(0x364)],_0x36ad86['VCB_UI_COORDINATES']['HOME_ICON']['x'],_0x36ad86[_0x3edab1(0x278)]['HOME_ICON']['y'],0x1388,'['+_0x202edd['accountName']+_0x3edab1(0x3da));}async['goToHomeScreenFromBill'](){console['warn']('VCB\x20not\x20implement');}async['extractTransactionAmount'](_0x47edf1){const _0x284b16=_0xf0f3db;try{const _0x278b99=await this['ocrService']['recognizeFromFile'](_0x47edf1,{'fieldType':_0x284b16(0x183),'customROI':{'x':0.05,'y':0.75,'width':0.9,'height':0.12},'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x278b99)return this['logger'][_0x284b16(0x375)]('Failed\x20to\x20extract\x20transaction\x20amount\x20from\x20ROI'),null;const _0x3db38f=_0x278b99[_0x284b16(0x3c4)][_0x284b16(0x26c)](/[^\d.,]/g,'')['replace'](/,/g,''),_0x58a349=parseFloat(_0x3db38f);return isNaN(_0x58a349)?(this[_0x284b16(0x22a)]['warn'](_0x284b16(0x30f)+_0x278b99[_0x284b16(0x3c4)]),null):(this['logger']['log']('Extracted\x20transaction\x20amount:\x20'+_0x58a349['toLocaleString']('vi-VN')+_0x284b16(0x3c9)+_0x278b99['confidence']['toFixed'](0x2)+'%,\x20time:\x20'+_0x278b99[_0x284b16(0x38f)]+_0x284b16(0x31a)),_0x58a349);}catch(_0x2874a7){return this[_0x284b16(0x22a)]['error'](_0x284b16(0x2f8)+_0x2874a7['message'],_0x2874a7[_0x284b16(0x1f2)]),null;}}async['onModuleInit'](){}[_0xf0f3db(0x362)](){}};_0x4599fc['VietcombankService']=_0x3b213f,_0x4599fc['VietcombankService']=_0x3b213f=_0xe5d481([(0x0,_0x56917f['Injectable'])(),_0x38d0f5(0x0,(0x0,_0x56917f['Inject'])(_0x41dcfd['WEBSOCKET_SERVICE'])),_0x4fb84b(_0xf0f3db(0x17c),[_0xf0f3db(0x379)==typeof(_0x34e121=void 0x0!==_0x3993a5[_0xf0f3db(0x11d)]&&_0x3993a5['IWebSocketService'])?_0x34e121:Object,'function'==typeof(_0x49d98b=void 0x0!==_0x2fa4f8['DeviceService']&&_0x2fa4f8['DeviceService'])?_0x49d98b:Object,'function'==typeof(_0xd3195d=void 0x0!==_0x485c4c['OCRService']&&_0x485c4c[_0xf0f3db(0x123)])?_0xd3195d:Object,'function'==typeof(_0x4d399d=void 0x0!==_0x48b776[_0xf0f3db(0x1a6)]&&_0x48b776['ImagePreprocessingService'])?_0x4d399d:Object])],_0x3b213f);},(_0x45ba66,_0x49b093,_0x377b00)=>{const _0x2bb6e4=a0_0x5814;Object['defineProperty'](_0x49b093,'__esModule',{'value':!0x0}),_0x49b093['VCB_UI_COORDINATES']=void 0x0;const _0x3d6c96=_0x377b00(0x11),_0x1702d9={'LOGIN_BTN':{'x':0.5,'y':0.55},'PASSWORD_FIELD':{'x':0.5,'y':0.45},'TRANSFER_BTN':{'x':0.7,'y':0.7},'TRANSFER_INTERNAL_BTN':{'x':0.2,'y':0.2},'TRANSFER_EXTERNAL_BTN':{'x':0.4,'y':0.2},'CLOSE_ALLOW_CONTACT_POPUP_BTN':{'x':0.3,'y':0.6},'ACCOUNT_NUMBER_INPUT':{'x':0.4,'y':0.43},'SELECT_BANK_BTN':{'x':0.4,'y':0.47},'SEARCH_BANK_BTN':{'x':0.4,'y':0.48},'INTERNAL_AMOUNT_INPUT':{'x':0.5,'y':0.6},'HIDE_NUMPAD_BTN':{'x':0.05,'y':0.4},'CONTINUE_TRANSFER_BTN':{'x':0.6,'y':0.92},'CONTINUE_OTP_VERIFY_BTN':{'x':0.5,'y':0.68},'OTP_ENTER_TRANSFER_BTN':{'x':0.5,'y':0.62},'BANK_SEARCH_BTN':{'x':0.4,'y':0.45},'BANK_SEARCH_INPUT':{'x':0.4,'y':0.45},'EXTERNAL_AMOUNT_INPUT':{'x':0.3,'y':0.37},'BACK_TO_HOME':{'x':0.2,'y':0.9},'QR_CODE_BTN':{'x':0.4,'y':0.92},'IMAGE_LIBRARY_BTN':{'x':0.4,'y':0.92},'FIRST_IMAGE_BTN':{'x':0.3,'y':0.3},'SELECT_IMAGE_QR_CODE_BTN':{'x':0.95,'y':0.95},'HOME_ICON':{'x':0.93,'y':0.07}},_0x18191c=(0x0,_0x377b00(0x26)['scaleCoordinates'])(_0x1702d9);_0x49b093['VCB_UI_COORDINATES']='PANDA'===_0x3d6c96['config'][_0x2bb6e4(0x195)]?_0x18191c:_0x1702d9;},function(_0x12768a,_0x9cc154,_0x1148ac){const _0x43dea3=a0_0x5814;var _0x416bbe,_0x348d28=this&&this[_0x43dea3(0x21a)]||function(_0x4f2e01,_0x5beee3,_0x1b2081,_0x281ae1){const _0x2c6052=_0x43dea3;var _0x148afd,_0x248786=arguments['length'],_0x134ade=_0x248786<0x3?_0x5beee3:null===_0x281ae1?_0x281ae1=Object['getOwnPropertyDescriptor'](_0x5beee3,_0x1b2081):_0x281ae1;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x2c6052(0x1fe)])_0x134ade=Reflect[_0x2c6052(0x1fe)](_0x4f2e01,_0x5beee3,_0x1b2081,_0x281ae1);else{for(var _0x13cc83=_0x4f2e01[_0x2c6052(0x2be)]-0x1;_0x13cc83>=0x0;_0x13cc83--)(_0x148afd=_0x4f2e01[_0x13cc83])&&(_0x134ade=(_0x248786<0x3?_0x148afd(_0x134ade):_0x248786>0x3?_0x148afd(_0x5beee3,_0x1b2081,_0x134ade):_0x148afd(_0x5beee3,_0x1b2081))||_0x134ade);}return _0x248786>0x3&&_0x134ade&&Object[_0x2c6052(0x2d5)](_0x5beee3,_0x1b2081,_0x134ade),_0x134ade;},_0x1e40e9=this&&this['__metadata']||function(_0x2ce555,_0x41e2d6){const _0x57b98f=_0x43dea3;if('object'==typeof Reflect&&_0x57b98f(0x379)==typeof Reflect['metadata'])return Reflect['metadata'](_0x2ce555,_0x41e2d6);};Object['defineProperty'](_0x9cc154,_0x43dea3(0x363),{'value':!0x0}),_0x9cc154['SessionManagementService']=void 0x0;const _0x4c7073=_0x1148ac(0x2),_0x50d834=_0x1148ac(0xf);let _0x504cde=class{constructor(_0x1d0708){const _0x20916e=_0x43dea3;this['redisService']=_0x1d0708,this['logger']=new _0x4c7073['Logger']('SessionManagementService'),this['REDIS_SESSION_PREFIX']=_0x20916e(0x215),this[_0x20916e(0x1cd)]=new Map([['ACB',{'bankCode':_0x20916e(0x3be),'sessionTimeoutMs':0xdbba0,'refreshBeforeMs':0xea60}],[_0x20916e(0x32b),{'bankCode':'PGBANK','sessionTimeoutMs':0x41eb0,'refreshBeforeMs':0x7530}],[_0x20916e(0x132),{'bankCode':'HDBANK','sessionTimeoutMs':0x6ddd0,'refreshBeforeMs':0x7530}]]);}['getSessionTimeout'](_0x40aa7f){const _0x5c5a3d=this['BANK_SESSION_CONFIGS']['get'](_0x40aa7f['toUpperCase']());return _0x5c5a3d?.['sessionTimeoutMs']||0x41eb0;}[_0x43dea3(0x128)](_0x52962c){const _0x505d52=_0x43dea3,_0x1d1fa2=this['BANK_SESSION_CONFIGS']['get'](_0x52962c['toUpperCase']());return _0x1d1fa2?.[_0x505d52(0x173)]||0x7530;}async['recordLogin'](_0x41737f,_0x1754f2){const _0x49844d=_0x43dea3,_0x70be04=this['getSessionTimeout'](_0x1754f2),_0x143e6c=Date['now']()+_0x70be04,_0xce0594={'deviceId':_0x41737f,'bankCode':_0x1754f2['toUpperCase'](),'loginTime':Date[_0x49844d(0x114)](),'expiresAt':_0x143e6c,'status':'logged_in'},_0x40f31b=''+this['REDIS_SESSION_PREFIX']+_0x41737f+':'+_0x1754f2['toUpperCase']();await this['redisService']['set'](_0x40f31b,JSON['stringify'](_0xce0594),_0x70be04),this['logger']['log']('['+_0x41737f+']\x20Recorded\x20login\x20session\x20(bank:\x20'+_0x1754f2+',\x20expires\x20at:\x20'+new Date(_0x143e6c)['toISOString']()+')');}async['markLoggingIn'](_0x19c94b,_0x4fab37){const _0x186b20=_0x43dea3,_0x285702=''+this['REDIS_SESSION_PREFIX']+_0x19c94b+':'+_0x4fab37['toUpperCase'](),_0x43231f=await this[_0x186b20(0x2e4)](_0x19c94b,_0x4fab37),_0xfea897={'deviceId':_0x19c94b,'bankCode':_0x4fab37['toUpperCase'](),'loginTime':_0x43231f?.[_0x186b20(0x38c)]||Date['now'](),'expiresAt':_0x43231f?.['expiresAt']||Date['now']()+this['getSessionTimeout'](_0x4fab37),'status':'logging_in'};await this['redisService']['set'](_0x285702,JSON['stringify'](_0xfea897),0x493e0),this['logger']['log']('Marked\x20device\x20'+_0x19c94b+',\x20bank\x20'+_0x4fab37+_0x186b20(0x1a3));}async['getSession'](_0x35cb08,_0xdb3e17){const _0x331a7c=_0x43dea3;try{const _0x56359f=''+this['REDIS_SESSION_PREFIX']+_0x35cb08+':'+_0xdb3e17[_0x331a7c(0x2c9)](),_0x53120e=await this[_0x331a7c(0x3e1)]['get'](_0x56359f);return _0x53120e?JSON[_0x331a7c(0x37d)](_0x53120e):null;}catch(_0x2964d8){return this['logger'][_0x331a7c(0x3e9)](_0x331a7c(0x129)+_0x35cb08+',\x20bank\x20'+_0xdb3e17+':\x20'+_0x2964d8['message']),null;}}async[_0x43dea3(0x1be)](_0x127482,_0x436263){const _0x510b1b=_0x43dea3,_0x4b684d=await this[_0x510b1b(0x2e4)](_0x127482,_0x436263);return!(!_0x4b684d||_0x4b684d[_0x510b1b(0x12a)]<Date['now']()||'logging_in'===_0x4b684d['status']||'logged_in'!==_0x4b684d['status']);}async['needsRefresh'](_0x112d84,_0x2c38f4){const _0x13bffd=_0x43dea3,_0x5c94df=await this[_0x13bffd(0x2e4)](_0x112d84,_0x2c38f4);if(!_0x5c94df||'logged_in'!==_0x5c94df[_0x13bffd(0x2a8)])return!0x1;const _0xdd1ee1=this[_0x13bffd(0x128)](_0x2c38f4);return _0x5c94df['expiresAt']-Date['now']()<=_0xdd1ee1;}async[_0x43dea3(0x1f1)](_0x4c5b41,_0x20e563){const _0x1469df=_0x43dea3,_0x288c2c=''+this[_0x1469df(0x1fb)]+_0x4c5b41+':'+_0x20e563[_0x1469df(0x2c9)]();await this['redisService']['del'](_0x288c2c),this['logger']['log']('Cleared\x20session\x20for\x20device\x20'+_0x4c5b41+_0x1469df(0x2bc)+_0x20e563);}};_0x9cc154['SessionManagementService']=_0x504cde,_0x9cc154['SessionManagementService']=_0x504cde=_0x348d28([(0x0,_0x4c7073['Injectable'])(),_0x1e40e9('design:paramtypes',['function'==typeof(_0x416bbe=void 0x0!==_0x50d834['RedisService']&&_0x50d834['RedisService'])?_0x416bbe:Object])],_0x504cde);},function(_0xfd4dc2,_0x1957be,_0x2251fc){const _0x208f05=a0_0x5814;var _0xd22cac,_0x31367f=this&&this['__decorate']||function(_0x543d8d,_0x1cf78f,_0x545149,_0x1daed9){const _0x3040dc=a0_0x5814;var _0x3eac7f,_0x423c67=arguments['length'],_0x57f990=_0x423c67<0x3?_0x1cf78f:null===_0x1daed9?_0x1daed9=Object[_0x3040dc(0x313)](_0x1cf78f,_0x545149):_0x1daed9;if('object'==typeof Reflect&&_0x3040dc(0x379)==typeof Reflect['decorate'])_0x57f990=Reflect['decorate'](_0x543d8d,_0x1cf78f,_0x545149,_0x1daed9);else{for(var _0x385cca=_0x543d8d['length']-0x1;_0x385cca>=0x0;_0x385cca--)(_0x3eac7f=_0x543d8d[_0x385cca])&&(_0x57f990=(_0x423c67<0x3?_0x3eac7f(_0x57f990):_0x423c67>0x3?_0x3eac7f(_0x1cf78f,_0x545149,_0x57f990):_0x3eac7f(_0x1cf78f,_0x545149))||_0x57f990);}return _0x423c67>0x3&&_0x57f990&&Object[_0x3040dc(0x2d5)](_0x1cf78f,_0x545149,_0x57f990),_0x57f990;},_0x17ab9a=this&&this['__metadata']||function(_0x103dc1,_0x41c9c0){const _0x199e10=a0_0x5814;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x199e10(0x168)])return Reflect[_0x199e10(0x168)](_0x103dc1,_0x41c9c0);};Object['defineProperty'](_0x1957be,'__esModule',{'value':!0x0}),_0x1957be['NotificationService']=void 0x0;const _0x3882e2=_0x2251fc(0x2),_0x38dcfc=_0x2251fc(0x36);let _0x2813dc=class{constructor(_0x57ca26){const _0x376c34=a0_0x5814;this[_0x376c34(0x32d)]=_0x57ca26,this['logger']=new _0x3882e2['Logger']('NotificationService');}async['completeWithdrawal'](_0x22f632,_0x4d2981,_0x5d4242){const _0x40f315=a0_0x5814;this['ezpayBeClient']['completeWithdrawal'](_0x22f632[_0x40f315(0x1b6)],{'analyzedStatus':_0x4d2981['analyzedStatus'],'sourceAccountNo':_0x5d4242[_0x40f315(0x345)],'sourceBankCode':_0x5d4242['bankCode'],'sourceAccountName':_0x5d4242['accountName']})[_0x40f315(0x381)](_0xcacd9e=>{const _0xcf47e0=_0x40f315;this['logger']['error']('['+_0x22f632[_0xcf47e0(0x3c3)]+']\x20-\x20Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x22f632['_id']+'\x20-\x20'+_0xcacd9e['stack']);}),this['ezpayBeClient']['uploadReceipt'](_0x22f632['_id'],_0x4d2981[_0x40f315(0x3c2)])[_0x40f315(0x381)](_0x306e2d=>{const _0x1edc67=_0x40f315;this['logger']['error']('['+_0x22f632['withdrawalCode']+_0x1edc67(0x30a)+_0x22f632['_id']+'\x20-\x20'+_0x306e2d['stack']);});}[_0x208f05(0x39d)](_0x10050a,_0x583232){return this['ezpayBeClient']['updateWithdrawal'](_0x10050a,_0x583232);}['uploadReceipt'](_0x391c9c,_0x3ce90c){const _0x3f7965=_0x208f05;return this['ezpayBeClient'][_0x3f7965(0x1a9)](_0x391c9c,_0x3ce90c);}};_0x1957be['NotificationService']=_0x2813dc,_0x1957be['NotificationService']=_0x2813dc=_0x31367f([(0x0,_0x3882e2[_0x208f05(0x1e6)])(),_0x17ab9a('design:paramtypes',['function'==typeof(_0xd22cac=void 0x0!==_0x38dcfc[_0x208f05(0x3af)]&&_0x38dcfc['EzpayBeClientService'])?_0xd22cac:Object])],_0x2813dc);},function(_0x3978f7,_0x2740df,_0x51ee12){const _0x2ce3af=a0_0x5814;var _0x3395ea,_0x3bdce9=this&&this[_0x2ce3af(0x21a)]||function(_0x8fd568,_0x5ca9ee,_0x13b431,_0x321120){const _0x457bba=_0x2ce3af;var _0x58f7fb,_0x15c614=arguments['length'],_0x217fe6=_0x15c614<0x3?_0x5ca9ee:null===_0x321120?_0x321120=Object['getOwnPropertyDescriptor'](_0x5ca9ee,_0x13b431):_0x321120;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x217fe6=Reflect['decorate'](_0x8fd568,_0x5ca9ee,_0x13b431,_0x321120);else{for(var _0x2373c=_0x8fd568[_0x457bba(0x2be)]-0x1;_0x2373c>=0x0;_0x2373c--)(_0x58f7fb=_0x8fd568[_0x2373c])&&(_0x217fe6=(_0x15c614<0x3?_0x58f7fb(_0x217fe6):_0x15c614>0x3?_0x58f7fb(_0x5ca9ee,_0x13b431,_0x217fe6):_0x58f7fb(_0x5ca9ee,_0x13b431))||_0x217fe6);}return _0x15c614>0x3&&_0x217fe6&&Object['defineProperty'](_0x5ca9ee,_0x13b431,_0x217fe6),_0x217fe6;},_0x4bdcf6=this&&this['__metadata']||function(_0x34c9d3,_0x42acca){const _0x5b806a=_0x2ce3af;if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x5b806a(0x168)](_0x34c9d3,_0x42acca);};Object['defineProperty'](_0x2740df,'__esModule',{'value':!0x0}),_0x2740df['EzpayBeClientService']=void 0x0;const _0x277532=_0x51ee12(0x2),_0x4ea705=_0x51ee12(0x8),_0x49d786=_0x51ee12(0x37),_0xa2b22e=_0x51ee12(0x2e),_0x206134=_0x51ee12(0x19),_0x185ffd=_0x51ee12(0x11),_0x1c2e09=_0x51ee12(0x18);let _0x4e2309=class{constructor(_0x5ee696){const _0x1b5c91=_0x2ce3af;this['httpService']=_0x5ee696,this['logger']=new _0x277532[(_0x1b5c91(0x3c7))]('EzpayBeClientService'),this['apiUrl']=_0x185ffd['config']['ezpayBe'][_0x1b5c91(0x34f)]??'http://localhost:3001',this['apiKey']=_0x185ffd['config']['ezpayBe']['apiKey']??'';}async['completeWithdrawal'](_0x595984,_0x214e81){const _0x650306=_0x2ce3af;for(let _0xba1b65=0x0;_0xba1b65<=0x3;_0xba1b65++)try{const _0x4773e1=this['apiUrl']+_0x650306(0x108)+_0x595984;this['logger']['log'](_0x650306(0x2b6)+_0x595984+'\x20status\x20to\x20'+_0x214e81['analyzedStatus']+_0x650306(0x1f0)+(_0xba1b65+0x1)+'/4)');const _0x547415={'analyzedStatus':_0x214e81[_0x650306(0x32e)],'sourceBankCode':_0x214e81[_0x650306(0x158)],'sourceAccountNo':_0x214e81['sourceAccountNo'],'sourceAccountName':_0x214e81[_0x650306(0x20b)]},_0x36371b=await(0x0,_0x49d786['firstValueFrom'])(this[_0x650306(0x17f)]['patch'](_0x4773e1,_0x547415,{'headers':{'Content-Type':'application/json','X-API-Key':this[_0x650306(0x15e)],'x-internal-secret-key':_0x650306(0x1b4)},'timeout':0x4e20}));if(0xc8===_0x36371b['status']||0xcc===_0x36371b[_0x650306(0x2a8)])return void this[_0x650306(0x22a)]['log'](_0x650306(0x288)+_0x595984+'\x20status\x20to\x20'+_0x214e81['analyzedStatus']);this['logger'][_0x650306(0x375)]('Unexpected\x20status\x20code\x20'+_0x36371b['status']+'\x20when\x20updating\x20withdrawal\x20'+_0x595984);}catch(_0xaf7b09){const _0x396d0a=_0xaf7b09,_0x425f9d=_0x396d0a['response']?.[_0x650306(0x2b2)],_0x46d107=_0x396d0a['message'];if(_0xba1b65<0x3){const _0x5abf99=0x7d0*Math['pow'](0x2,_0xba1b65);this['logger'][_0x650306(0x375)]('Failed\x20to\x20update\x20withdrawal\x20'+_0x595984+_0x650306(0x1f0)+(_0xba1b65+0x1)+'/4):\x20'+_0x46d107+'.\x20Payload:\x20'+JSON['stringify'](_0x425f9d)+',\x20Retrying\x20in\x20'+_0x5abf99+'ms'),await(0x0,_0x1c2e09['sleep'])(_0x5abf99);}else this['logger']['error'](_0x650306(0x23f)+_0x595984+'\x20after\x204\x20attempts.\x20Payload:\x20'+JSON['stringify'](_0x425f9d)+_0x650306(0x29c)+_0x46d107);}}async['uploadReceipt'](_0x307ae4,_0x52f606){const _0x1b6818=_0x2ce3af;for(let _0x5c5bfe=0x0;_0x5c5bfe<=0x3;_0x5c5bfe++)try{const _0x2ffe6e=this[_0x1b6818(0x34f)]+'/api/internal/withdrawals/upload-receipt/'+_0x307ae4;if(this['logger'][_0x1b6818(0x19e)](_0x1b6818(0x23d)+_0x307ae4+_0x1b6818(0x1f0)+(_0x5c5bfe+0x1)+'/4)'),!_0x52f606)return void this['logger']['warn']('No\x20receipt\x20path\x20provided\x20for\x20withdrawal\x20'+_0x307ae4);const _0x581e79=new _0xa2b22e();_0x581e79[_0x1b6818(0x1dc)]('receipt',(0x0,_0x206134['createReadStream'])(_0x52f606));const _0xaed3ee=await(0x0,_0x49d786['firstValueFrom'])(this['httpService'][_0x1b6818(0x1ae)](_0x2ffe6e,_0x581e79,{'headers':{..._0x581e79['getHeaders'](),'X-API-Key':this['apiKey'],'x-internal-secret-key':_0x1b6818(0x1b4)},'timeout':0x4e20}));if(0xc8===_0xaed3ee[_0x1b6818(0x2a8)]||0xcc===_0xaed3ee[_0x1b6818(0x2a8)])return void this['logger']['log'](_0x1b6818(0x353)+_0x307ae4);this['logger']['warn']('Unexpected\x20status\x20code\x20'+_0xaed3ee[_0x1b6818(0x2a8)]+_0x1b6818(0x10b)+_0x307ae4);}catch(_0x40f6d2){const _0x26d4f1=_0x40f6d2,_0x4de3=_0x26d4f1['response']?.['data'],_0x3cb5a7=_0x26d4f1['message'];if(_0x5c5bfe<0x3){const _0x18f509=0x7d0*Math['pow'](0x2,_0x5c5bfe);this[_0x1b6818(0x22a)]['warn'](_0x1b6818(0x1a7)+_0x307ae4+'\x20(attempt\x20'+(_0x5c5bfe+0x1)+'/4):\x20'+_0x3cb5a7+'.\x20Response:\x20'+JSON['stringify'](_0x4de3)+',\x20Retrying\x20in\x20'+_0x18f509+'ms'),await(0x0,_0x1c2e09[_0x1b6818(0x404)])(_0x18f509);}else this[_0x1b6818(0x22a)]['error']('Failed\x20to\x20upload\x20bill\x20for\x20withdrawal\x20'+_0x307ae4+'\x20after\x204\x20attempts.\x20Response:\x20'+JSON['stringify'](_0x4de3)+',\x20Error:\x20'+_0x3cb5a7);}}['updateWithdrawal'](_0x1d5acc,_0x262987){const _0x26e506=_0x2ce3af;this['logger']['log'](_0x26e506(0x2b6)+_0x1d5acc+'\x20data\x20'+JSON['stringify'](_0x262987));const _0x111a7a=this['apiUrl']+'/api/internal/withdrawals/'+_0x1d5acc;return(0x0,_0x49d786['firstValueFrom'])(this['httpService']['patch'](_0x111a7a,_0x262987,{'headers':{'x-internal-secret-key':'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE'}}));}};_0x2740df[_0x2ce3af(0x3af)]=_0x4e2309,_0x2740df['EzpayBeClientService']=_0x4e2309=_0x3bdce9([(0x0,_0x277532['Injectable'])(),_0x4bdcf6('design:paramtypes',['function'==typeof(_0x3395ea=void 0x0!==_0x4ea705['HttpService']&&_0x4ea705['HttpService'])?_0x3395ea:Object])],_0x4e2309);},_0x29b63a=>{_0x29b63a['exports']=require('rxjs');},function(_0x512bd9,_0x556b79,_0x1e8416){const _0x224060=a0_0x5814;var _0x4782f9,_0x723d14,_0x552090,_0x3cd1ba,_0x14cb99,_0x5b0025,_0x40c6d7,_0x561f9d,_0x67731d,_0x1f5b83,_0x3f91ef,_0x3c9578=this&&this['__decorate']||function(_0x18b382,_0x288d91,_0xdc36c,_0x5d18b0){const _0x4518a2=a0_0x5814;var _0x294334,_0x10f977=arguments['length'],_0x1c979b=_0x10f977<0x3?_0x288d91:null===_0x5d18b0?_0x5d18b0=Object['getOwnPropertyDescriptor'](_0x288d91,_0xdc36c):_0x5d18b0;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x1c979b=Reflect[_0x4518a2(0x1fe)](_0x18b382,_0x288d91,_0xdc36c,_0x5d18b0);else{for(var _0x34efa3=_0x18b382['length']-0x1;_0x34efa3>=0x0;_0x34efa3--)(_0x294334=_0x18b382[_0x34efa3])&&(_0x1c979b=(_0x10f977<0x3?_0x294334(_0x1c979b):_0x10f977>0x3?_0x294334(_0x288d91,_0xdc36c,_0x1c979b):_0x294334(_0x288d91,_0xdc36c))||_0x1c979b);}return _0x10f977>0x3&&_0x1c979b&&Object['defineProperty'](_0x288d91,_0xdc36c,_0x1c979b),_0x1c979b;},_0x37df71=this&&this['__metadata']||function(_0xb8c357,_0x37f1b5){const _0x5da6da=a0_0x5814;if('object'==typeof Reflect&&_0x5da6da(0x379)==typeof Reflect[_0x5da6da(0x168)])return Reflect[_0x5da6da(0x168)](_0xb8c357,_0x37f1b5);},_0x7071bd=this&&this[_0x224060(0x3e3)]||function(_0x5f324d,_0x1a12e2){return function(_0x542a3a,_0x1676f9){_0x1a12e2(_0x542a3a,_0x1676f9,_0x5f324d);};};Object['defineProperty'](_0x556b79,'__esModule',{'value':!0x0}),_0x556b79['WithdrawalJobManagerService']=void 0x0;const _0x3fb04e=_0x1e8416(0x2),_0x56676d=_0x1e8416(0x7),_0x4e25be=_0x1e8416(0x6),_0x20d155=_0x1e8416(0x39),_0x37e3ae=_0x1e8416(0xa),_0x596da3=_0x1e8416(0xe),_0xed5fc5=_0x1e8416(0x14),_0x22ee13=_0x1e8416(0xd),_0x4f30bd=_0x1e8416(0x13),_0x4e224a=_0x1e8416(0x3a),_0x2b6ed8=_0x1e8416(0x2a),_0x432090=_0x1e8416(0x16),_0x11f901=_0x1e8416(0x3c),_0x47ca=_0x1e8416(0xb),_0x9e2ff7=_0x1e8416(0x35),_0x106372=_0x1e8416(0x3d),_0x74653a=_0x1e8416(0x40),_0x560c3a=_0x1e8416(0x41),_0x229fe7=_0x1e8416(0x2c),_0x532f68=_0x1e8416(0x18),_0xb56f23=_0x1e8416(0x42),_0x2e107a=_0x1e8416(0xf),_0x36cbb8=_0x1e8416(0x44),_0x3f5b1d=_0x1e8416(0x11),_0x366c74=_0x1e8416(0x45);let _0x458eb0=class{constructor(_0xed5263,_0x55534f,_0x55a93a,_0x1cc67a,_0x5e51cb,_0x1eb11b,_0x503576,_0x39c0b0,_0xab80be,_0x26359e,_0x47a8aa){const _0x219c24=_0x224060;this['withdrawalQueue']=_0xed5263,this['withdrawalService']=_0x55534f,this['deviceService']=_0x55a93a,this['deviceLockService']=_0x1cc67a,this[_0x219c24(0x250)]=_0x5e51cb,this['bankService']=_0x1eb11b,this['notificationService']=_0x503576,this[_0x219c24(0x2d0)]=_0x39c0b0,this['redisLockService']=_0xab80be,this['telegramService']=_0x26359e,this[_0x219c24(0x3e1)]=_0x47a8aa,this['logger']=new _0x3fb04e['Logger'](_0x219c24(0x220)),this[_0x219c24(0x280)]=new Set(),this['isInitialized']=!0x1,this['isRestartingBoxphone']=!0x1,this[_0x219c24(0x27c)]=!0x1;}async['onModuleInit'](){this['logger']['log']('WithdrawalJobManagerService\x20initialized,\x20waiting\x205\x20seconds\x20before\x20starting...'),this['initializeJobProcessing'](),this['scheduleCronRestartBoxphone']();}async['initializeJobProcessing'](){setTimeout(async()=>{const _0x52c4b4=a0_0x5814;this['isInitialized']||(this['logger'][_0x52c4b4(0x19e)]('Starting\x20withdrawal\x20job\x20processing...'),await this['pickAndProcessJobs'](),this[_0x52c4b4(0x384)]=!0x0);},0x1388);}['scheduleCronRestartBoxphone'](){const _0x4908b0=_0x224060,_0x34759a=new Date(),_0x2444e6=0x3e8*(0x3c-_0x34759a['getSeconds']())-_0x34759a[_0x4908b0(0x24d)]();setTimeout(()=>{this['cronRestartBoxphoneEnabled']=!0x0;},_0x2444e6);}async['restartBoxphone'](){const _0x24ad6c=_0x224060;if(!await this['deviceLockService']['hasAnyLockKeys']()){const _0x5e9348='development'===_0x3f5b1d[_0x24ad6c(0x3ba)]['NODE_ENV']?_0x24ad6c(0x27d):_0x24ad6c(0x1b9);this['telegramService']['sendMessage']({'text':_0x5e9348+('\x0a\x0a<b>Khởi\x20động\x20lại:</b>\x20'+new Date()['toLocaleString']('vi-VN',{'timeZone':'Asia/Ho_Chi_Minh'})+'\x0a<b>Dự\x20kiến:</b>\x203\x20phút.'),'options':{'parseMode':'HTML'}}),await this['windowsAppGitBashService'][_0x24ad6c(0x267)]({'processName':'xiaowei_iphone.exe','exePath':'C:/Users/Public/Desktop/效卫苹果投屏.lnk','runAsAdmin':!0x0,'killAsAdmin':!0x0}),this['telegramService']['sendMessage']({'text':'✅\x20<b>Boxphone\x20software</b>\x0a\x0a<b>Khởi\x20động\x20lại\x20thành\x20công:</b>\x20'+new Date()['toLocaleString']('vi-VN',{'timeZone':'Asia/Ho_Chi_Minh'})+'\x0aLogin\x20tất\x20cả\x20thiết\x20bị\x20sau\x201\x20phút:','options':{'parseMode':'HTML'}});try{await(0x0,_0x532f68[_0x24ad6c(0x404)])(0x1388),await this[_0x24ad6c(0x19d)]['loginAllActiveBanks']();}catch(_0x59f160){this['logger']['error']('Error\x20logging\x20in\x20all\x20active\x20banks:\x20'+_0x59f160['stack']);}finally{await(0x0,_0x532f68['sleep'])(0x3e8),await this['redisLockService']['releaseLock'](_0x560c3a[_0x24ad6c(0x14d)]);}}}async['pickAndProcessJobs'](_0x369ba8){const _0x12f2b0=_0x224060;try{if(await this[_0x12f2b0(0x390)]['getLock'](_0x560c3a['SYSTEM_LOCK_BOXPHONE'])){if(this['isRestartingBoxphone'])return;return this['isRestartingBoxphone']=!0x0,await this['restartBoxphone'](),void(this[_0x12f2b0(0x281)]=!0x1);}if(!this[_0x12f2b0(0x250)]['isConnectedStatus']())return void this['logger'][_0x12f2b0(0x3e9)]('WebSocket\x20is\x20not\x20connected,\x20cannot\x20pick\x20jobs');const _0xfcd44e=await this['deviceService']['getServiceStatus']();if('active'!==_0xfcd44e)return void this[_0x12f2b0(0x22a)][_0x12f2b0(0x181)](_0x12f2b0(0x2a0)+_0xfcd44e+',\x20cannot\x20pick\x20jobs');const _0x423d47=await this['deviceService']['getAvailableDevices'](),_0x5dc455=_0x423d47['length'];if(_0x5dc455<=0x0)return;const _0x4e29bd=_0x369ba8?Math['min'](_0x369ba8,_0x5dc455):_0x5dc455,_0x332512=await this['redisService']['pickFromZSet'](_0x36cbb8['JOB_PRIORITY_KEY'],_0x4e29bd);if(0x0===_0x332512['length'])return;this[_0x12f2b0(0x22a)]['log']('Found\x20'+_0x423d47['length']+_0x12f2b0(0x1a5)+_0x332512['length']+'\x20jobs\x20('+(_0x332512||[])['length']+'\x20waiting).');for(let _0xc3b807=0x0;_0xc3b807<_0x332512['length'];_0xc3b807++){const _0x41284d=_0x332512[_0xc3b807][_0x12f2b0(0x320)],_0x332a98=await this['withdrawalQueue']['getJob'](_0x41284d),_0x3f20ac=_0x423d47[_0xc3b807];if(this['processingJobs']['has'](_0x332a98['id']))continue;const _0x59a69c=_0x12f2b0(0x216)+_0x332a98[_0x12f2b0(0x2b2)][_0x12f2b0(0x34a)]+':'+_0x3f20ac['deviceId'];await this['deviceLockService']['acquireLock'](_0x3f20ac['deviceId'],'transfer',_0x59a69c,0x35e80)?this['processJob'](_0x332a98,_0x3f20ac)['catch'](_0x203d77=>{const _0x1f6d66=_0x12f2b0;this['logger']['error'](_0x1f6d66(0x230)+_0x332a98['id']+':\x20'+_0x203d77['message'],_0x203d77['stack']);})['finally'](()=>{const _0xda11dd=_0x12f2b0;this[_0xda11dd(0x2fb)]['releaseLock'](_0x3f20ac['deviceId'])[_0xda11dd(0x381)](()=>{});}):this[_0x12f2b0(0x22a)][_0x12f2b0(0x375)](_0x12f2b0(0x3d3)+_0x3f20ac['deviceId']+'\x20was\x20locked\x20after\x20assignment,\x20skipping\x20job\x20'+_0x332a98['id']);}}catch(_0x2f2798){this['logger'][_0x12f2b0(0x3e9)]('Error\x20picking\x20jobs:\x20'+_0x2f2798['message'],_0x2f2798['stack']);}}async['processJob'](_0x29e773,_0x5468f9){const _0x5949ea=_0x224060;let _0x42e8f3;try{_0x42e8f3=(0x0,_0x432090['cloneDeep'])(_0x29e773[_0x5949ea(0x2b2)]),await _0x29e773['remove']();const _0x4550c3=await(0x0,_0xb56f23['validateObjectResult'])(_0x4e224a['Withdrawal'],_0x42e8f3);if(!_0x4550c3['ok'])throw new _0x2b6ed8['WithdrawalProcessingError']('Invalid\x20withdrawal:\x20missing\x20'+_0x4550c3[_0x5949ea(0x241)][_0x5949ea(0x354)](_0x41f99a=>_0x41f99a['property'])['join'](',\x20'),_0x2b6ed8['ErrorType']['PERMANENT']);const {_id:_0x234b37,withdrawalId:_0x311c12}=_0x42e8f3;this[_0x5949ea(0x22a)]['log'](_0x5949ea(0x13c)+_0x311c12+'\x20from\x20queue'),this['processingJobs']['add'](_0x29e773['id']);const _0x370de4=await this['withdrawalService'][_0x5949ea(0x169)](_0x234b37);if(![_0x366c74['WithdrawalStatus'][_0x5949ea(0x182)],_0x366c74['WithdrawalStatus']['RETRY']]['includes'](_0x370de4['status']))throw this[_0x5949ea(0x22a)][_0x5949ea(0x375)](_0x5949ea(0x2ac)+_0x311c12+'\x20('+_0x370de4['status']+')\x20is\x20not\x20pending\x20or\x20retry,\x20skipping'),new _0x2b6ed8[(_0x5949ea(0x374))](_0x5949ea(0x3f7)+_0x370de4[_0x5949ea(0x2a8)]+')',_0x2b6ed8[_0x5949ea(0x2d8)]['PERMANENT']);_0x370de4['status']===_0x366c74[_0x5949ea(0x2eb)]['RETRY']&&this[_0x5949ea(0x226)]['sendMessage']({'text':'🚀🚀🚀\x20<b>Retrying\x20Withdrawal...</b>\x0a'+_0x42e8f3[_0x5949ea(0x34a)]+'\x20-\x20'+_0x42e8f3['withdrawalCode']+'\x0a\x0a<b>From:</b>\x20\x20'+_0x5468f9[_0x5949ea(0x358)]+_0x5949ea(0x1bc)+_0x5468f9['accountName']+'\x0a<b>To:</b>\x20'+_0x42e8f3['bankCode']+_0x5949ea(0x1bc)+_0x42e8f3['beneficiaryAccountNo']+'\x20-\x20'+_0x42e8f3['beneficiaryName']+'\x0a<b>Amount:</b>\x20\x20'+_0x42e8f3[_0x5949ea(0x29f)]+'\x0a<b>Description:</b>\x20\x20'+_0x42e8f3['description'],'options':{'parseMode':_0x5949ea(0x2f0)}})[_0x5949ea(0x381)](_0x167deb=>{const _0x4e666f=_0x5949ea;this['logger']['error']('Error\x20sending\x20message\x20for\x20withdrawal\x20'+_0x42e8f3['withdrawalId']+':\x20'+_0x167deb[_0x4e666f(0x36b)],_0x167deb['stack']);}),this[_0x5949ea(0x15f)]['updateWithdrawal'](_0x234b37,{'status':_0x366c74['WithdrawalStatus']['PROCESSING'],'sourceBankCode':_0x5468f9['bankCode'],'sourceAccountNo':_0x5468f9['accountNo'],'sourceAccountName':_0x5468f9['accountName']})['catch'](_0x15dd6d=>{const _0x4a6420=_0x5949ea;this['logger']['error']('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x311c12+':\x20'+_0x15dd6d['message'],_0x15dd6d[_0x4a6420(0x1f2)]);}),await this[_0x5949ea(0x19d)]['createQRCodeAndTransferTo'](_0x5468f9['bankCode'],_0x5468f9['deviceId'],_0x42e8f3),await this[_0x5949ea(0x19d)]['createBillFolder'](_0x5468f9[_0x5949ea(0x358)],_0x42e8f3['withdrawalCode']),await this['withdrawalService']['processWithdrawal'](_0x42e8f3,_0x5468f9);}catch(_0x2e00c7){let _0x32d036,_0x105c1b;if(_0x2e00c7 instanceof _0x2b6ed8['WithdrawalProcessingError'])_0x32d036=_0x2e00c7['errorType'],_0x105c1b=_0x2e00c7['context'],this['logger']['error']('Controlled\x20Error\x20'+_0x42e8f3['withdrawalId']+':\x20'+_0x32d036+'-'+_0x2e00c7[_0x5949ea(0x36b)],_0x2e00c7[_0x5949ea(0x1f2)]),await this['handleJobFailure'](_0x5468f9,_0x42e8f3,_0x2e00c7['message'],_0x32d036,_0x105c1b);else{this['logger']['error']('Uncontrolled\x20Error\x20'+_0x42e8f3['withdrawalId']+':\x20'+_0x32d036+'-'+_0x2e00c7['message'],_0x2e00c7['stack']),await this['bankService']['createBillFolder'](_0x5468f9['bankCode'],_0x42e8f3[_0x5949ea(0x3c3)]),await(0x0,_0x532f68['sleep'])(0x3e8),await this['bankService']['captureScreen'](_0x5468f9['bankCode'],_0x5468f9['deviceId'],_0x42e8f3[_0x5949ea(0x3c3)]);const _0x4c32b2=await this['bankService']['getBillImagePath'](_0x5468f9['bankCode'],_0x42e8f3['withdrawalCode']);_0x4c32b2&&(this['logger']['log'](_0x5949ea(0x1b2)+_0x42e8f3[_0x5949ea(0x3c3)]+'\x20-\x20'+_0x4c32b2),await this[_0x5949ea(0x15f)]['uploadReceipt'](_0x42e8f3[_0x5949ea(0x1b6)],_0x4c32b2)),await this['notificationService']['updateWithdrawal'](_0x42e8f3[_0x5949ea(0x1b6)],{'status':_0x366c74['WithdrawalStatus']['UNKNOWN']}),this['telegramService']['sendMessage']({'text':'❌\x20<b>Failed\x20Withdraw.</b>\x0a'+_0x42e8f3[_0x5949ea(0x34a)]+'\x0a'+_0x42e8f3['withdrawalCode']+'\x0a'+_0x2e00c7['message']+_0x5949ea(0x36c)+_0x5468f9['bankCode']+'\x20-\x20'+_0x5468f9['accountName']+'\x0a<b>To:</b>\x20'+_0x42e8f3['bankCode']+'\x20-\x20'+_0x42e8f3['beneficiaryAccountNo']+'\x20-\x20'+_0x42e8f3['beneficiaryName']+_0x5949ea(0x1b8)+_0x42e8f3['amount']+_0x5949ea(0x312)+_0x42e8f3[_0x5949ea(0x30b)],'options':{'parseMode':'HTML'}})['catch'](_0x1f4c15=>{const _0x51ed4f=_0x5949ea;this['logger']['error']('Error\x20sending\x20message\x20for\x20withdrawal\x20'+_0x42e8f3['withdrawalId']+':\x20'+_0x1f4c15['message'],_0x1f4c15[_0x51ed4f(0x1f2)]);}),await this['bankService'][_0x5949ea(0x3f2)](_0x5468f9['bankCode'],_0x5468f9['deviceId'],!0x0);}}finally{this['processingJobs']['delete'](_0x29e773['id']);}}async[_0x224060(0x299)](_0x1e4540,_0x5d2071,_0x3d8df2,_0x4bfecb=_0x2b6ed8[_0x224060(0x2d8)][_0x224060(0x1d3)],_0x515af2=''){const _0x24152b=_0x224060,_0x2201b5=_0x5d2071['manualRetryCount']??0x1;switch(_0x4bfecb){case _0x2b6ed8[_0x24152b(0x2d8)]['PERMANENT']:return this[_0x24152b(0x15f)]['updateWithdrawal'](_0x5d2071[_0x24152b(0x1b6)],{'status':_0x366c74['WithdrawalStatus'][_0x24152b(0x26f)]})['catch'](_0x33629d=>{this['logger']['error']('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x5d2071['withdrawalId']+':\x20'+_0x33629d['message'],_0x33629d['stack']);}),void await this['bankService']['login'](_0x1e4540['bankCode'],_0x1e4540[_0x24152b(0x364)],!0x0);case _0x2b6ed8['ErrorType']['FORCE_LOGIN_NO_REQUEUE']:return void await this['bankService'][_0x24152b(0x3f2)](_0x1e4540['bankCode'],_0x1e4540['deviceId'],!0x0);case _0x2b6ed8[_0x24152b(0x2d8)]['NO_BILL_AFTER_OTP']:await this[_0x24152b(0x19d)]['captureScreen'](_0x1e4540[_0x24152b(0x358)],_0x1e4540['deviceId'],_0x5d2071[_0x24152b(0x3c3)]);const _0x5c0d3e=await this['bankService']['getBillImagePath'](_0x1e4540['bankCode'],_0x5d2071[_0x24152b(0x3c3)]);return _0x5c0d3e&&(this['logger']['log']('Uploading\x20receipt\x20for\x20withdrawal\x20'+_0x5d2071[_0x24152b(0x3c3)]+_0x24152b(0x1bc)+_0x5c0d3e),await this['notificationService'][_0x24152b(0x1a9)](_0x5d2071['_id'],_0x5c0d3e)),await this['notificationService']['updateWithdrawal'](_0x5d2071['_id'],{'status':_0x366c74[_0x24152b(0x2eb)]['UNKNOWN']}),void await this[_0x24152b(0x19d)]['login'](_0x1e4540['bankCode'],_0x1e4540[_0x24152b(0x364)],!0x0);case _0x2b6ed8[_0x24152b(0x2d8)]['FORCE_LOGIN_AND_REQUEUE']:if(this[_0x24152b(0x22a)]['warn']('Added\x20'+_0x5d2071['withdrawalId']+_0x24152b(0x2f4)+_0x2201b5+'/2)Reason:\x20'+_0x3d8df2+'.\x20Error\x20Type:\x20'+_0x4bfecb+'.'),_0x2201b5<0x2)await this['withdrawalQueue']['add'](_0x24152b(0x39e),{..._0x5d2071,'manualRetryCount':_0x2201b5+0x1,'lastErrorType':_0x4bfecb,'lastErrorReason':_0x3d8df2},{'attempts':0x0,'removeOnComplete':!0x1,'removeOnFail':!0x1,'jobId':'wda-'+_0x5d2071['withdrawalId'],'priority':0x1,'delay':0x7530}),this[_0x24152b(0x15f)][_0x24152b(0x39d)](_0x5d2071['_id'],{'status':_0x366c74['WithdrawalStatus'][_0x24152b(0x157)]})['catch'](_0x27c8cc=>{const _0x422f59=_0x24152b;this['logger']['error']('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x5d2071[_0x422f59(0x34a)]+':\x20'+_0x27c8cc['message'],_0x27c8cc['stack']);}),this['telegramService']['sendMessage']({'text':'❌\x20<b>Failed\x20Withdraw.\x20Retrying...</b>\x0a'+_0x5d2071['withdrawalId']+'\x0a'+_0x5d2071[_0x24152b(0x3c3)]+'\x0a'+_0x515af2+'\x0a\x0a<b>From:</b>\x20\x20'+_0x1e4540['bankCode']+'\x20-\x20'+_0x1e4540['accountName']+'\x0a<b>To:</b>\x20'+_0x5d2071[_0x24152b(0x358)]+_0x24152b(0x1bc)+_0x5d2071['beneficiaryAccountNo']+'\x20-\x20'+_0x5d2071[_0x24152b(0x2ba)]+'\x0a<b>Amount:</b>\x20\x20'+_0x5d2071['amount']+'\x0a<b>Description:</b>\x20\x20'+_0x5d2071['description'],'options':{'parseMode':'HTML'}})[_0x24152b(0x381)](_0x18a39f=>{this['logger']['error']('Error\x20sending\x20message\x20for\x20withdrawal\x20'+_0x5d2071['withdrawalId']+':\x20'+_0x18a39f['message'],_0x18a39f['stack']);});else{this['logger']['warn']('Max\x20retries\x20(2)\x20exceeded\x20for\x20withdrawal\x20'+_0x5d2071[_0x24152b(0x34a)]+':\x20'+_0x4bfecb+_0x24152b(0x2a4)+_0x3d8df2),this['notificationService']['updateWithdrawal'](_0x5d2071['_id'],{'status':_0x366c74['WithdrawalStatus']['FAILED']})['catch'](_0x180f02=>{const _0x4ae248=_0x24152b;this['logger']['error']('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x5d2071['withdrawalId']+':\x20'+_0x180f02['message'],_0x180f02[_0x4ae248(0x1f2)]);}),await this[_0x24152b(0x19d)][_0x24152b(0x1bf)](_0x1e4540[_0x24152b(0x358)],_0x1e4540['deviceId'],_0x5d2071['withdrawalCode']);const _0x318d67=await this[_0x24152b(0x19d)][_0x24152b(0x290)](_0x1e4540['bankCode'],_0x5d2071['withdrawalCode']),_0x288ba5='❌\x20<b>Failed\x20Withdraw.\x20Max\x20retries\x20exceeded...</b>\x0a'+_0x5d2071['withdrawalId']+'\x0a'+_0x5d2071[_0x24152b(0x3c3)]+'\x0a'+_0x515af2+'\x0a\x0a<b>From:</b>\x20\x20'+_0x1e4540['bankCode']+'\x20-\x20'+_0x1e4540['accountName']+_0x24152b(0x3ed)+_0x5d2071[_0x24152b(0x358)]+'\x20-\x20'+_0x5d2071[_0x24152b(0x115)]+_0x24152b(0x1bc)+_0x5d2071['beneficiaryName']+'\x0a<b>Amount:</b>\x20\x20'+_0x5d2071['amount']+_0x24152b(0x312)+_0x5d2071['description'];await this['telegramService']['sendPhotoByFile']({'filePath':_0x318d67,'options':{'parseMode':'HTML','caption':_0x288ba5}});}await this[_0x24152b(0x19d)]['login'](_0x1e4540[_0x24152b(0x358)],_0x1e4540['deviceId'],!0x0);break;case _0x2b6ed8['ErrorType'][_0x24152b(0x141)]:if(this['logger']['warn']('Added\x20'+_0x5d2071['withdrawalId']+'\x20to\x20queue\x20for\x20retrying.\x20('+_0x2201b5+'/2)Reason:\x20'+_0x3d8df2+'.\x20Error\x20Type:\x20'+_0x4bfecb+'.'),_0x2201b5<0x2)await this['withdrawalQueue']['add']('process-withdrawal-request',{..._0x5d2071,'manualRetryCount':_0x2201b5+0x1,'lastErrorType':_0x4bfecb,'lastErrorReason':_0x3d8df2},{'attempts':0x0,'removeOnComplete':!0x1,'removeOnFail':!0x1,'jobId':_0x24152b(0x349)+_0x5d2071['withdrawalId'],'priority':0x1,'delay':0x7530}),this['notificationService']['updateWithdrawal'](_0x5d2071['_id'],{'status':_0x366c74[_0x24152b(0x2eb)]['RETRY']})[_0x24152b(0x381)](_0x1eb54a=>{const _0x15d8d3=_0x24152b;this['logger'][_0x15d8d3(0x3e9)]('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x5d2071['withdrawalId']+':\x20'+_0x1eb54a['message'],_0x1eb54a['stack']);}),this['telegramService']['sendMessage']({'text':_0x24152b(0x104)+_0x5d2071[_0x24152b(0x34a)]+'\x0a'+_0x5d2071[_0x24152b(0x3c3)]+'\x0a'+_0x515af2+_0x24152b(0x36c)+_0x1e4540['bankCode']+'\x20-\x20'+_0x1e4540['accountName']+'\x0a<b>To:</b>\x20'+_0x5d2071[_0x24152b(0x358)]+'\x20-\x20'+_0x5d2071['beneficiaryAccountNo']+'\x20-\x20'+_0x5d2071['beneficiaryName']+'\x0a<b>Amount:</b>\x20\x20'+_0x5d2071['amount']+_0x24152b(0x312)+_0x5d2071['description'],'options':{'parseMode':_0x24152b(0x2f0)}})['catch'](_0xf5eb91=>{const _0x209851=_0x24152b;this[_0x209851(0x22a)][_0x209851(0x3e9)]('Error\x20sending\x20message\x20for\x20withdrawal\x20'+_0x5d2071['withdrawalId']+':\x20'+_0xf5eb91['message'],_0xf5eb91['stack']);});else{this['logger']['warn']('Max\x20retries\x20(2)\x20exceeded\x20for\x20withdrawal\x20'+_0x5d2071['withdrawalId']+':\x20'+_0x4bfecb+'\x20error:\x20'+_0x3d8df2),this[_0x24152b(0x15f)]['updateWithdrawal'](_0x5d2071['_id'],{'status':_0x366c74['WithdrawalStatus']['FAILED']})[_0x24152b(0x381)](_0x135b44=>{const _0x326e29=_0x24152b;this['logger']['error']('Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x5d2071['withdrawalId']+':\x20'+_0x135b44['message'],_0x135b44[_0x326e29(0x1f2)]);}),await this['bankService']['captureScreen'](_0x1e4540['bankCode'],_0x1e4540['deviceId'],_0x5d2071['withdrawalCode']);const _0x5816d9=await this[_0x24152b(0x19d)]['getBillImagePath'](_0x1e4540[_0x24152b(0x358)],_0x5d2071[_0x24152b(0x3c3)]),_0x4badec=_0x24152b(0x3a7)+_0x5d2071['withdrawalId']+'\x0a'+_0x5d2071['withdrawalCode']+'\x0a'+_0x515af2+_0x24152b(0x36c)+_0x1e4540['bankCode']+'\x20-\x20'+_0x1e4540['accountName']+'\x0a<b>To:</b>\x20'+_0x5d2071[_0x24152b(0x358)]+'\x20-\x20'+_0x5d2071['beneficiaryAccountNo']+'\x20-\x20'+_0x5d2071['beneficiaryName']+'\x0a<b>Amount:</b>\x20\x20'+_0x5d2071['amount']+'\x0a<b>Description:</b>\x20\x20'+_0x5d2071['description'];await this['telegramService']['sendPhotoByFile']({'filePath':_0x5816d9,'options':{'parseMode':'HTML','caption':_0x4badec}});}}}async['promoteDelayedJobs'](){const _0x176656=_0x224060;return(0x0,_0x11f901[_0x176656(0x26b)])(_0x176656(0x393),0x1388,async()=>{const _0x3fb91e=_0x176656,_0x406f1c=Date['now'](),_0x26a736=await this[_0x3fb91e(0x3fb)][_0x3fb91e(0x2f9)](['delayed'],0x0,0x63);if(!_0x26a736['length'])return;let _0x223d21=0x0;for(const _0x486a1f of _0x26a736){const _0x710859='number'==typeof _0x486a1f['opts']?.['delay']?_0x486a1f['opts']['delay']:0x0;if((_0x3fb91e(0x140)==typeof _0x486a1f['timestamp']?_0x486a1f['timestamp']:0x0)+_0x710859<=_0x406f1c)try{await _0x486a1f[_0x3fb91e(0x228)](),_0x223d21++;}catch(_0x15d683){this['logger']['debug'](_0x3fb91e(0x31e)+_0x486a1f['id']+':\x20'+String(_0x15d683));}}_0x223d21>0x0&&this['logger']['log']('Promoted\x20'+_0x223d21+'\x20delayed\x20jobs\x20to\x20waiting');});}async['triggerPickJobs'](_0x4d71ee=0x1){const _0x4568f4=_0x224060;await this[_0x4568f4(0x352)](_0x4d71ee);}async['getQueueStats'](){const _0xd40b1e=_0x224060,[_0x32b448,_0x4881af,_0x25490b,_0x3c482a,_0x1328f1,_0x6bb79e,_0x126762]=await Promise[_0xd40b1e(0x37c)]([this['withdrawalQueue']['getWaitingCount'](),this['withdrawalQueue']['getDelayedCount'](),this['withdrawalQueue']['getActiveCount'](),this['withdrawalQueue']['getCompletedCount'](),this['withdrawalQueue']['getFailedCount'](),this[_0xd40b1e(0x20d)][_0xd40b1e(0x3db)](),this['deviceService']['getServiceStatus']()]);return{'serviceStatus':_0x126762,'activeDevices':_0x6bb79e['length'],'processingJobs':this['processingJobs']['size'],'isInitialized':this['isInitialized'],'queue':{'waiting':_0x32b448,'delayed':_0x4881af,'active':_0x25490b,'completed':_0x3c482a,'failed':_0x1328f1,'total':_0x32b448+_0x4881af+_0x25490b}};}async['debugQueue'](){const _0x48b9f0=_0x224060,_0x42ae69=await this['getQueueStats'](),[_0xe302c,_0x181c27]=await Promise[_0x48b9f0(0x37c)]([this['withdrawalQueue'][_0x48b9f0(0x2f9)]([_0x48b9f0(0x159)],0x0,0x9),this['withdrawalQueue'][_0x48b9f0(0x2f9)](['delayed'],0x0,0x9)]);return{..._0x42ae69,'sampleWaitingJobs':_0xe302c['map'](_0x3e6a0a=>({'id':_0x3e6a0a['id'],'data':_0x3e6a0a['data'],'opts':_0x3e6a0a['opts'],'manualRetryCount':_0x3e6a0a['data']['manualRetryCount']})),'sampleDelayedJobs':_0x181c27['map'](_0x400fb7=>({'id':_0x400fb7['id'],'data':_0x400fb7[_0x48b9f0(0x2b2)],'opts':_0x400fb7['opts'],'manualRetryCount':_0x400fb7['data'][_0x48b9f0(0x14a)]}))};}async['periodicJobPicking'](){await this['redisLockService']['isLocked'](_0x560c3a['SYSTEM_LOCK_PAUSE_PROCESSING'])?this['logger']['warn']('Transfer\x20is\x20paused\x20by\x20admin\x20temporarily!'):await this['pickAndProcessJobs']();}async[_0x224060(0x221)](){await this['promoteDelayedJobs']();}async['restartPandaBoxPeriodically'](){const _0x3796f7=_0x224060,_0x24c384=await this[_0x3796f7(0x20d)][_0x3796f7(0x1eb)]();this['cronRestartBoxphoneEnabled']&&_0x3796f7(0x2db)===_0x24c384&&await this['redisLockService']['acquireLock'](_0x560c3a['SYSTEM_LOCK_BOXPHONE'],0x2bf20);}};_0x556b79['WithdrawalJobManagerService']=_0x458eb0,_0x3c9578([(0x0,_0x56676d[_0x224060(0x3b1)])(_0x56676d[_0x224060(0x2fd)][_0x224060(0x1c3)]),_0x37df71(_0x224060(0x3c0),Function),_0x37df71('design:paramtypes',[]),_0x37df71(_0x224060(0x2ee),Promise)],_0x458eb0[_0x224060(0x3b2)],'periodicJobPicking',null),_0x3c9578([(0x0,_0x56676d['Cron'])(_0x56676d[_0x224060(0x2fd)][_0x224060(0x1c3)]),_0x37df71('design:type',Function),_0x37df71('design:paramtypes',[]),_0x37df71('design:returntype',Promise)],_0x458eb0['prototype'],'promoteDelayedJobsPeriodically',null),_0x3c9578([(0x0,_0x56676d[_0x224060(0x3b1)])(_0x56676d['CronExpression']['EVERY_30_MINUTES']),_0x37df71('design:type',Function),_0x37df71('design:paramtypes',[]),_0x37df71(_0x224060(0x2ee),Promise)],_0x458eb0[_0x224060(0x3b2)],_0x224060(0x2fc),null),_0x556b79['WithdrawalJobManagerService']=_0x458eb0=_0x3c9578([(0x0,_0x3fb04e[_0x224060(0x1e6)])(),_0x7071bd(0x0,(0x0,_0x4e25be[_0x224060(0x205)])(_0x224060(0x286))),_0x7071bd(0x4,(0x0,_0x3fb04e[_0x224060(0x1c5)])(_0x22ee13['WEBSOCKET_SERVICE'])),_0x37df71(_0x224060(0x17c),['function'==typeof(_0x4782f9=void 0x0!==_0x20d155[_0x224060(0x14e)]&&_0x20d155['Queue'])?_0x4782f9:Object,'function'==typeof(_0x723d14=void 0x0!==_0x37e3ae['WithdrawalService']&&_0x37e3ae[_0x224060(0x151)])?_0x723d14:Object,_0x224060(0x379)==typeof(_0x552090=void 0x0!==_0x596da3['DeviceService']&&_0x596da3['DeviceService'])?_0x552090:Object,'function'==typeof(_0x3cd1ba=void 0x0!==_0xed5fc5['DeviceLockService']&&_0xed5fc5['DeviceLockService'])?_0x3cd1ba:Object,'function'==typeof(_0x14cb99=void 0x0!==_0x4f30bd['IWebSocketService']&&_0x4f30bd['IWebSocketService'])?_0x14cb99:Object,'function'==typeof(_0x5b0025=void 0x0!==_0x47ca['BankService']&&_0x47ca[_0x224060(0x20a)])?_0x5b0025:Object,'function'==typeof(_0x40c6d7=void 0x0!==_0x9e2ff7['NotificationService']&&_0x9e2ff7[_0x224060(0x1a2)])?_0x40c6d7:Object,_0x224060(0x379)==typeof(_0x561f9d=void 0x0!==_0x106372['WindowsAppGitBashService']&&_0x106372['WindowsAppGitBashService'])?_0x561f9d:Object,'function'==typeof(_0x67731d=void 0x0!==_0x74653a['RedisLockService']&&_0x74653a[_0x224060(0x1da)])?_0x67731d:Object,'function'==typeof(_0x1f5b83=void 0x0!==_0x229fe7[_0x224060(0x1d7)]&&_0x229fe7['TelegramService'])?_0x1f5b83:Object,'function'==typeof(_0x3f91ef=void 0x0!==_0x2e107a['RedisService']&&_0x2e107a['RedisService'])?_0x3f91ef:Object])],_0x458eb0);},_0x20eb1a=>{const _0x1a3195=a0_0x5814;_0x20eb1a[_0x1a3195(0x255)]=require('bull');},function(_0xdc7744,_0x342d98,_0x1b02c1){const _0x447533=a0_0x5814;var _0x1df7d7,_0x1694d9=this&&this['__decorate']||function(_0x334e64,_0x3f5bcd,_0x3f0c2c,_0x590d19){const _0x2aae98=a0_0x5814;var _0x11f56e,_0x31d005=arguments[_0x2aae98(0x2be)],_0xc9eac2=_0x31d005<0x3?_0x3f5bcd:null===_0x590d19?_0x590d19=Object['getOwnPropertyDescriptor'](_0x3f5bcd,_0x3f0c2c):_0x590d19;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0xc9eac2=Reflect['decorate'](_0x334e64,_0x3f5bcd,_0x3f0c2c,_0x590d19);else{for(var _0x5ca2a0=_0x334e64['length']-0x1;_0x5ca2a0>=0x0;_0x5ca2a0--)(_0x11f56e=_0x334e64[_0x5ca2a0])&&(_0xc9eac2=(_0x31d005<0x3?_0x11f56e(_0xc9eac2):_0x31d005>0x3?_0x11f56e(_0x3f5bcd,_0x3f0c2c,_0xc9eac2):_0x11f56e(_0x3f5bcd,_0x3f0c2c))||_0xc9eac2);}return _0x31d005>0x3&&_0xc9eac2&&Object[_0x2aae98(0x2d5)](_0x3f5bcd,_0x3f0c2c,_0xc9eac2),_0xc9eac2;},_0x7f051=this&&this[_0x447533(0x16e)]||function(_0x214ecc,_0x17289c){const _0x52fd8b=_0x447533;if(_0x52fd8b(0x1bb)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x214ecc,_0x17289c);};Object[_0x447533(0x2d5)](_0x342d98,'__esModule',{'value':!0x0}),_0x342d98[_0x447533(0x22d)]=void 0x0;const _0x589957=_0x1b02c1(0x2a),_0x10e379=_0x1b02c1(0x3b);class _0x196547{}_0x342d98[_0x447533(0x22d)]=_0x196547,_0x1694d9([(0x0,_0x10e379['IsNotEmpty'])(),_0x7f051('design:type',String)],_0x196547[_0x447533(0x3b2)],'_id',void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x378)])(),_0x7f051('design:type',String)],_0x196547[_0x447533(0x3b2)],'withdrawalId',void 0x0),_0x1694d9([(0x0,_0x10e379['IsNotEmpty'])(),_0x7f051('design:type',String)],_0x196547['prototype'],_0x447533(0x3c3),void 0x0),_0x1694d9([(0x0,_0x10e379['IsNotEmpty'])(),_0x7f051(_0x447533(0x3c0),String)],_0x196547['prototype'],_0x447533(0x358),void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x378)])(),_0x7f051('design:type',String)],_0x196547['prototype'],'beneficiaryAccountNo',void 0x0),_0x1694d9([(0x0,_0x10e379['IsNotEmpty'])(),_0x7f051('design:type',String)],_0x196547['prototype'],'beneficiaryName',void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x378)])(),_0x7f051(_0x447533(0x3c0),Number)],_0x196547['prototype'],_0x447533(0x29f),void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x378)])(),_0x7f051('design:type',String)],_0x196547['prototype'],'transferCode',void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x378)])(),_0x7f051('design:type',String)],_0x196547['prototype'],'status',void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x378)])(),_0x7f051(_0x447533(0x3c0),String)],_0x196547[_0x447533(0x3b2)],_0x447533(0x30b),void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x378)])(),_0x7f051('design:type',String)],_0x196547[_0x447533(0x3b2)],'createdAt',void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x134)])(),_0x7f051('design:type',Number)],_0x196547['prototype'],'manualRetryCount',void 0x0),_0x1694d9([(0x0,_0x10e379[_0x447533(0x134)])(),_0x7f051(_0x447533(0x3c0),'function'==typeof(_0x1df7d7=void 0x0!==_0x589957['ErrorType']&&_0x589957[_0x447533(0x2d8)])?_0x1df7d7:Object)],_0x196547['prototype'],'lastErrorType',void 0x0),_0x1694d9([(0x0,_0x10e379['IsOptional'])(),_0x7f051('design:type',String)],_0x196547['prototype'],'lastErrorReason',void 0x0);},_0x4c0495=>{_0x4c0495['exports']=require('class-validator');},(_0x552294,_0x15de55,_0x568be9)=>{const _0x4dc6a6=a0_0x5814;Object['defineProperty'](_0x15de55,'__esModule',{'value':!0x0}),_0x15de55[_0x4dc6a6(0x26b)]=void 0x0;const _0x341f26=_0x568be9(0x10),_0x5c2b6c=_0x568be9(0x11),_0x25a6ef=new _0x341f26['default']({'host':_0x5c2b6c['config']['redis']['host'],'port':_0x5c2b6c['config']['redis']['port'],'password':_0x5c2b6c['config']['redis']['password'],'db':_0x5c2b6c['config']['redis']['db']});_0x15de55['withCronLock']=async(_0x21b518,_0x332e0b,_0x43f9f7)=>{const _0x3332cb=_0x4dc6a6,_0x45e530=process['pid']+':'+Date['now']();if(await _0x25a6ef['set'](_0x21b518,_0x45e530,'PX',_0x332e0b,'NX'))try{await _0x43f9f7();}finally{const _0x59b2c8=_0x3332cb(0x367);await _0x25a6ef['eval'](_0x59b2c8,0x1,_0x21b518,_0x45e530);}};},function(_0x599189,_0x15c722,_0x93afc1){const _0x4f3e8a=a0_0x5814;var _0x2974eb,_0x403994=this&&this['__decorate']||function(_0x1da6c3,_0x4e421b,_0x531ebf,_0x2b10eb){const _0x4012e1=a0_0x5814;var _0x1273be,_0xd4e058=arguments[_0x4012e1(0x2be)],_0x2636d0=_0xd4e058<0x3?_0x4e421b:null===_0x2b10eb?_0x2b10eb=Object['getOwnPropertyDescriptor'](_0x4e421b,_0x531ebf):_0x2b10eb;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x2636d0=Reflect['decorate'](_0x1da6c3,_0x4e421b,_0x531ebf,_0x2b10eb);else{for(var _0x13f162=_0x1da6c3['length']-0x1;_0x13f162>=0x0;_0x13f162--)(_0x1273be=_0x1da6c3[_0x13f162])&&(_0x2636d0=(_0xd4e058<0x3?_0x1273be(_0x2636d0):_0xd4e058>0x3?_0x1273be(_0x4e421b,_0x531ebf,_0x2636d0):_0x1273be(_0x4e421b,_0x531ebf))||_0x2636d0);}return _0xd4e058>0x3&&_0x2636d0&&Object['defineProperty'](_0x4e421b,_0x531ebf,_0x2636d0),_0x2636d0;};Object['defineProperty'](_0x15c722,'__esModule',{'value':!0x0}),_0x15c722['WindowsAppGitBashService']=void 0x0;const _0x419539=_0x93afc1(0x2),_0x34347b=_0x93afc1(0x3e),_0x28a781=_0x93afc1(0x3f),_0x28dfd7=_0x93afc1(0x18),_0x43ea67=(0x0,_0x28a781['promisify'])(_0x34347b['exec']);let _0x1c5861=_0x2974eb=class{constructor(){this['logger']=new _0x419539['Logger'](_0x2974eb['name']);}async['restartApp'](_0x28cf7e){const _0x52e9ba=a0_0x5814,{processName:_0x4228a6,exePath:_0x5aaa57,startTarget:_0x19ebed,gracefulWaitMs:_0xdc20fe=0x4b0,forceKillWaitMs:_0x29d293=0x1f4,startDelayMs:_0x34d25d=0x12c,runAsAdmin:_0x2048db=!0x1,killAsAdmin:_0x14d3b4=!0x1}=_0x28cf7e;try{if(await this['closeMainWindow'](_0x4228a6)['catch'](()=>{}),await(0x0,_0x28dfd7['sleep'])(_0xdc20fe),await this[_0x52e9ba(0x12b)](_0x4228a6,_0x14d3b4)['catch'](()=>{}),await(0x0,_0x28dfd7['sleep'])(_0x29d293),await this['waitUntilNotRunning'](_0x4228a6,0x1388)[_0x52e9ba(0x381)](()=>{}),await(0x0,_0x28dfd7['sleep'])(_0x34d25d),_0x5aaa57)return void await this['startApp']({'exePath':_0x5aaa57,'runAsAdmin':_0x2048db});if(_0x19ebed)return void await this['startApp']({'startTarget':_0x19ebed,'runAsAdmin':_0x2048db});const _0x378bee=_0x4228a6[_0x52e9ba(0x26c)](/\.exe$/i,'');await this['startApp']({'startTarget':_0x378bee,'runAsAdmin':_0x2048db});}catch(_0x5635fe){const _0x2e4663=_0x5635fe?.[_0x52e9ba(0x36b)]||String(_0x5635fe);throw this['logger'][_0x52e9ba(0x3e9)]('[restart]\x20Failed\x20to\x20restart\x20app:\x20'+_0x2e4663,_0x5635fe?.['stack']),_0x5635fe;}}async['closeMainWindow'](_0x583b99){const _0x5508ef=a0_0x5814,_0x713268=_0x583b99[_0x5508ef(0x26c)](/\.exe$/i,''),_0x26381d='Get-Process\x20-Name\x20\x22'+this['escapePs'](_0x713268)+_0x5508ef(0x403),_0x47621d='powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22'+this[_0x5508ef(0x2d1)](_0x26381d)+'\x22';try{await _0x43ea67(_0x47621d,{'windowsHide':!0x0});}catch(_0x3eed1b){if(!(_0x3eed1b?.[_0x5508ef(0x36b)]||String(_0x3eed1b)||'')['includes']('Cannot\x20find\x20a\x20process'))throw _0x3eed1b;}}async[_0x4f3e8a(0x12b)](_0x17f8e5,_0x4156e9=!0x1){const _0x3b2da0=_0x4f3e8a,_0x25093e=_0x17f8e5[_0x3b2da0(0x26c)](/\.exe$/i,'');try{return void await this[_0x3b2da0(0x239)](_0x25093e,_0x4156e9);}catch(_0x30d6f2){const _0x182dc7=(_0x30d6f2?.[_0x3b2da0(0x36b)]||_0x30d6f2?.['stderr']||String(_0x30d6f2)||'')['toLowerCase']();if(_0x182dc7[_0x3b2da0(0x2b5)](_0x3b2da0(0x330))||_0x182dc7['includes'](_0x3b2da0(0x27b))||_0x182dc7[_0x3b2da0(0x2b5)]('cannot\x20find\x20process'))return void this['logger']['debug'](_0x3b2da0(0x389)+_0x17f8e5);if((_0x182dc7[_0x3b2da0(0x2b5)]('access\x20is\x20denied')||_0x182dc7[_0x3b2da0(0x2b5)]('access\x20denied'))&&!_0x4156e9){this['logger']['warn']('Access\x20denied,\x20retrying\x20with\x20admin\x20privileges:\x20'+_0x17f8e5);try{return void await this['forceKillWithPowerShell'](_0x25093e,!0x0);}catch(_0x57d7ca){const _0x2eac5a=(_0x57d7ca?.[_0x3b2da0(0x36b)]||_0x57d7ca?.['stderr']||String(_0x57d7ca)||'')[_0x3b2da0(0x184)]();if(_0x2eac5a['includes']('cannot\x20find\x20a\x20process')||_0x2eac5a[_0x3b2da0(0x2b5)]('process\x20not\x20found'))return;this[_0x3b2da0(0x22a)]['debug']('PowerShell\x20kill\x20with\x20admin\x20failed,\x20trying\x20taskkill:\x20'+_0x17f8e5);}}try{let _0x14d413;if(_0x4156e9||_0x182dc7['includes']('access\x20denied')||_0x182dc7['includes']('access\x20is\x20denied'))_0x14d413=_0x3b2da0(0x3a5)+('Start-Process\x20taskkill\x20-ArgumentList\x20\x27/F\x27,\x27/IM\x27,\x27'+_0x17f8e5['replace'](/"/g,'`\x22')+_0x3b2da0(0x1f5))['replace'](/"/g,'`\x22')['replace'](/\$/g,'`$')+'\x22';else _0x14d413='taskkill\x20/F\x20/IM\x20\x22'+_0x17f8e5+_0x3b2da0(0x197);await _0x43ea67(_0x14d413,{'windowsHide':!0x0});}catch(_0x22f400){const _0x5ca9aa=(_0x22f400?.[_0x3b2da0(0x36b)]||_0x22f400?.[_0x3b2da0(0x1dd)]||String(_0x22f400)||'')[_0x3b2da0(0x184)]();if(_0x5ca9aa['includes'](_0x3b2da0(0x107))||_0x5ca9aa['includes']('no\x20tasks\x20are\x20running')||_0x5ca9aa['includes'](_0x3b2da0(0x1fd)))return void this['logger']['debug']('Process\x20not\x20found\x20(expected):\x20'+_0x17f8e5);if(_0x5ca9aa[_0x3b2da0(0x2b5)]('access\x20is\x20denied')||_0x5ca9aa['includes']('access\x20denied'))return void this['logger'][_0x3b2da0(0x375)](_0x3b2da0(0x383)+_0x17f8e5+_0x3b2da0(0x2f5));this['logger'][_0x3b2da0(0x375)](_0x3b2da0(0x2c3)+_0x5ca9aa);}}}async[_0x4f3e8a(0x239)](_0x4f31ab,_0x5f4344=!0x1){const _0x57d074=_0x4f3e8a,_0x4a073f='Get-Process\x20-Name\x20\x27'+_0x4f31ab['replace'](/'/g,'\x27\x27')+'\x27\x20-ErrorAction\x20SilentlyContinue\x20|\x20Stop-Process\x20-Force\x20-ErrorAction\x20Stop';let _0xb3b509;_0xb3b509=_0x5f4344?'powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22'+('Start-Process\x20powershell\x20-ArgumentList\x20\x27-NoProfile\x27,\x27-ExecutionPolicy\x27,\x27Bypass\x27,\x27-Command\x27,\x22'+_0x4a073f['replace'](/'/g,'\x27\x27')['replace'](/"/g,'`\x22')+'\x22\x20-Verb\x20RunAs\x20-Wait\x20-WindowStyle\x20Hidden')['replace'](/"/g,'`\x22')['replace'](/\$/g,'`$')+'\x22':'powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22'+_0x4a073f['replace'](/"/g,'`\x22')['replace'](/\$/g,'`$')+'\x22';try{await _0x43ea67(_0xb3b509,{'windowsHide':!0x0});}catch(_0x2d0da2){const _0xc190c8=(_0x2d0da2?.['message']||_0x2d0da2?.['stderr']||String(_0x2d0da2)||'')[_0x57d074(0x184)]();if(_0xc190c8['includes']('cannot\x20find\x20a\x20process')||_0xc190c8['includes']('process\x20not\x20found')||_0xc190c8['includes']('cannot\x20find\x20process'))return void this[_0x57d074(0x22a)]['debug']('Process\x20not\x20found\x20(expected):\x20'+_0x4f31ab);throw _0x2d0da2;}}async['isRunning'](_0x25b6a8){const _0x4c94dd=_0x4f3e8a;try{const _0x5bd78a='tasklist\x20/FI\x20\x22IMAGENAME\x20eq\x20'+_0x25b6a8+_0x4c94dd(0x3f0),{stdout:_0x236c01}=await _0x43ea67(_0x5bd78a,{'windowsHide':!0x0}),_0x302fb6=_0x236c01[_0x4c94dd(0x184)]()[_0x4c94dd(0x396)]();return!(!_0x302fb6||_0x302fb6['includes']('no\x20tasks')||'info:'===_0x302fb6)&&_0x302fb6['includes'](_0x25b6a8['toLowerCase']());}catch(_0x33f98d){return!0x1;}}async[_0x4f3e8a(0x12f)](_0x2398a8,_0x17c7f6){const _0x536886=_0x4f3e8a,_0x3752ef=Date['now']();for(;Date['now']()-_0x3752ef<_0x17c7f6;){if(!await this['isRunning'](_0x2398a8))return;await(0x0,_0x28dfd7['sleep'])(0xfa);}this['logger'][_0x536886(0x375)]('Process\x20still\x20running\x20after\x20'+_0x17c7f6+_0x536886(0x118)+_0x2398a8);}async[_0x4f3e8a(0x309)](_0x5e10b4){const _0x3a007d=_0x4f3e8a,_0x5fac51=_0x5e10b4['exePath']??_0x5e10b4['startTarget']??'',_0x56b5eb=_0x5e10b4['runAsAdmin']??!0x1;if(!_0x5fac51)throw new Error('Start\x20target\x20is\x20empty');try{if(_0x56b5eb){const _0x4699e8='powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22'+('Start-Process\x20-FilePath\x20\x27'+_0x5fac51[_0x3a007d(0x26c)](/'/g,'\x27\x27')+'\x27\x20-Verb\x20RunAs')['replace'](/"/g,'`\x22')['replace'](/\$/g,'`$')+'\x22';await _0x43ea67(_0x4699e8),this[_0x3a007d(0x22a)][_0x3a007d(0x19e)](_0x3a007d(0x199)+_0x5fac51);}else{const _0x192491='start\x20\x22\x22\x20\x22'+_0x5fac51+'\x22';await _0x43ea67(_0x192491,{'windowsHide':!0x0}),this['logger'][_0x3a007d(0x19e)](_0x3a007d(0x190)+_0x5fac51);}await(0x0,_0x28dfd7[_0x3a007d(0x404)])(0x1f4);}catch(_0x463f68){const _0x1db68f=_0x463f68?.['message']||String(_0x463f68);throw this[_0x3a007d(0x22a)]['error']('Failed\x20to\x20start\x20app:\x20'+_0x5fac51,_0x1db68f),_0x463f68;}}['escapePs'](_0x430c83){const _0x44c017=_0x4f3e8a;return _0x430c83[_0x44c017(0x26c)](/"/g,'`\x22')[_0x44c017(0x26c)](/\$/g,'`$');}};_0x15c722['WindowsAppGitBashService']=_0x1c5861,_0x15c722[_0x4f3e8a(0x35e)]=_0x1c5861=_0x2974eb=_0x403994([(0x0,_0x419539['Injectable'])()],_0x1c5861);},_0x4cec0f=>{_0x4cec0f['exports']=require('child_process');},_0x20f04f=>{_0x20f04f['exports']=require('util');},function(_0x16ccd7,_0x162967,_0x37b1b9){const _0xcbcb=a0_0x5814;var _0x22ed27,_0x1f8641=this&&this['__decorate']||function(_0x40d0ff,_0x1ea5c4,_0x57b724,_0x4327a5){const _0x2e76aa=a0_0x5814;var _0x46cb66,_0x4548e9=arguments['length'],_0x7d1041=_0x4548e9<0x3?_0x1ea5c4:null===_0x4327a5?_0x4327a5=Object['getOwnPropertyDescriptor'](_0x1ea5c4,_0x57b724):_0x4327a5;if(_0x2e76aa(0x1bb)==typeof Reflect&&_0x2e76aa(0x379)==typeof Reflect['decorate'])_0x7d1041=Reflect['decorate'](_0x40d0ff,_0x1ea5c4,_0x57b724,_0x4327a5);else{for(var _0x4167cf=_0x40d0ff['length']-0x1;_0x4167cf>=0x0;_0x4167cf--)(_0x46cb66=_0x40d0ff[_0x4167cf])&&(_0x7d1041=(_0x4548e9<0x3?_0x46cb66(_0x7d1041):_0x4548e9>0x3?_0x46cb66(_0x1ea5c4,_0x57b724,_0x7d1041):_0x46cb66(_0x1ea5c4,_0x57b724))||_0x7d1041);}return _0x4548e9>0x3&&_0x7d1041&&Object['defineProperty'](_0x1ea5c4,_0x57b724,_0x7d1041),_0x7d1041;},_0x3bbea9=this&&this[_0xcbcb(0x16e)]||function(_0xa0e010,_0x17df90){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0xa0e010,_0x17df90);};Object['defineProperty'](_0x162967,'__esModule',{'value':!0x0}),_0x162967['RedisLockService']=void 0x0;const _0xfb71ab=_0x37b1b9(0x2),_0x329d72=_0x37b1b9(0xf),_0x5604d6=_0x37b1b9(0x15);let _0x323282=class{constructor(_0x4a6206){const _0xc744dd=_0xcbcb;this[_0xc744dd(0x3e1)]=_0x4a6206,this[_0xc744dd(0x22a)]=new _0xfb71ab['Logger'](_0xc744dd(0x1da)),this['DEFAULT_LOCK_TTL']=0x2bf20;}async['acquireLock'](_0x32e295,_0x5bdc75=this[_0xcbcb(0x161)]){const _0x1e4dea=_0xcbcb;try{const _0x202d11=(0x0,_0x5604d6['randomUUID'])(),_0x39a0f1=Math['ceil'](_0x5bdc75/0x3e8),_0x5f142b=await this[_0x1e4dea(0x3e1)]['getClient']();return'OK'===await _0x5f142b['set'](_0x32e295,_0x202d11,'EX',_0x39a0f1,'NX');}catch(_0x1dacfd){return!0x1;}}async['releaseLock'](_0xa4ce05){const _0x20cec9=_0xcbcb;try{const _0x265bf1=await this[_0x20cec9(0x3e1)]['getClient'](),_0x500fae=await _0x265bf1['get'](_0xa4ce05);if(!_0x500fae)return;0x1===await _0x265bf1['eval'](_0x20cec9(0x103),0x1,_0xa4ce05,_0x500fae)?this['logger']['log'](_0x20cec9(0x1af)+_0xa4ce05+':'+_0x500fae+')'):this['logger'][_0x20cec9(0x375)](_0x20cec9(0x139)+_0xa4ce05+':'+_0x500fae+')');}catch(_0x2f7a49){this['logger']['error']('Error\x20releasing\x20lock:\x20'+_0xa4ce05+'\x20'+_0x2f7a49[_0x20cec9(0x36b)],_0x2f7a49['stack']);}}async[_0xcbcb(0x277)](_0x47f35d){const _0x55668f=_0xcbcb;try{return await this['redisService']['get'](_0x47f35d)??null;}catch(_0xc9b9b0){return this['logger']['error']('['+_0x47f35d+_0x55668f(0x2ea)+_0xc9b9b0['message']),null;}}async['isLocked'](_0x5baace){const _0x555f83=_0xcbcb;try{return!!await this[_0x555f83(0x277)](_0x5baace);}catch(_0xc6f368){return this['logger'][_0x555f83(0x3e9)]('['+_0x5baace+_0x555f83(0x209)+_0xc6f368['message']),!0x1;}}};_0x162967['RedisLockService']=_0x323282,_0x162967[_0xcbcb(0x1da)]=_0x323282=_0x1f8641([(0x0,_0xfb71ab[_0xcbcb(0x1e6)])(),_0x3bbea9('design:paramtypes',['function'==typeof(_0x22ed27=void 0x0!==_0x329d72['RedisService']&&_0x329d72['RedisService'])?_0x22ed27:Object])],_0x323282);},(_0x3347d5,_0x39cf19)=>{const _0x97810=a0_0x5814;Object[_0x97810(0x2d5)](_0x39cf19,_0x97810(0x363),{'value':!0x0}),_0x39cf19['SYSTEM_LOCK_PAUSE_PROCESSING']=_0x39cf19['SYSTEM_LOCK_BOXPHONE']=void 0x0,_0x39cf19['SYSTEM_LOCK_BOXPHONE']='system:lock:boxphone',_0x39cf19['SYSTEM_LOCK_PAUSE_PROCESSING']=_0x97810(0x263);},(_0x4d5850,_0xfe7fb8,_0x3bc3c4)=>{Object['defineProperty'](_0xfe7fb8,'__esModule',{'value':!0x0}),_0xfe7fb8['validateObjectResult']=void 0x0;const _0x1bebea=_0x3bc3c4(0x43),_0x41a98e=_0x3bc3c4(0x3b);_0xfe7fb8['validateObjectResult']=async(_0x467379,_0x51866c)=>{const _0x2f5490=a0_0x5814,_0xd4e26a=(0x0,_0x1bebea['plainToInstance'])(_0x467379,_0x51866c,{'enableImplicitConversion':!0x0}),_0x1ad1cd=await(0x0,_0x41a98e['validate'])(_0xd4e26a,{'whitelist':!0x0,'forbidNonWhitelisted':!0x0,'forbidUnknownValues':!0x0,'validationError':{'target':!0x1,'value':!0x1}});return{'ok':0x0===_0x1ad1cd[_0x2f5490(0x2be)],'instance':_0xd4e26a,'errors':_0x1ad1cd};};},_0x3f7379=>{_0x3f7379['exports']=require('class-transformer');},(_0x41ca7f,_0x444881)=>{const _0x11a5ad=a0_0x5814;Object[_0x11a5ad(0x2d5)](_0x444881,'__esModule',{'value':!0x0}),_0x444881['JOB_PRIORITY_KEY']=void 0x0,_0x444881['JOB_PRIORITY_KEY']='bull:wda-request:priority';},(_0x1ee97e,_0x5b9413)=>{const _0x28fe90=a0_0x5814;var _0xca685e;Object[_0x28fe90(0x2d5)](_0x5b9413,'__esModule',{'value':!0x0}),_0x5b9413['WithdrawalStatus']=void 0x0,function(_0x4a43bb){const _0x3e9c31=_0x28fe90;_0x4a43bb[_0x3e9c31(0x182)]=_0x3e9c31(0x182),_0x4a43bb['FAILED']='FAILED',_0x4a43bb[_0x3e9c31(0x247)]=_0x3e9c31(0x247),_0x4a43bb['RETRY']=_0x3e9c31(0x157),_0x4a43bb[_0x3e9c31(0x3ad)]=_0x3e9c31(0x3ad),_0x4a43bb['UNKNOWN']=_0x3e9c31(0x155),_0x4a43bb['NA']='NA';}(_0xca685e||(_0x5b9413['WithdrawalStatus']=_0xca685e={}));},function(_0xf3e4b8,_0x372250,_0x1ad727){const _0x208b80=a0_0x5814;var _0x368baa,_0x5e720f=this&&this['__decorate']||function(_0x1d30a0,_0x38e9dd,_0x26fe52,_0x21032a){const _0x2155d5=a0_0x5814;var _0x2993c9,_0x22615a=arguments['length'],_0x294de4=_0x22615a<0x3?_0x38e9dd:null===_0x21032a?_0x21032a=Object[_0x2155d5(0x313)](_0x38e9dd,_0x26fe52):_0x21032a;if(_0x2155d5(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x294de4=Reflect[_0x2155d5(0x1fe)](_0x1d30a0,_0x38e9dd,_0x26fe52,_0x21032a);else{for(var _0x324433=_0x1d30a0['length']-0x1;_0x324433>=0x0;_0x324433--)(_0x2993c9=_0x1d30a0[_0x324433])&&(_0x294de4=(_0x22615a<0x3?_0x2993c9(_0x294de4):_0x22615a>0x3?_0x2993c9(_0x38e9dd,_0x26fe52,_0x294de4):_0x2993c9(_0x38e9dd,_0x26fe52))||_0x294de4);}return _0x22615a>0x3&&_0x294de4&&Object['defineProperty'](_0x38e9dd,_0x26fe52,_0x294de4),_0x294de4;},_0x3c5e02=this&&this['__metadata']||function(_0x331819,_0x263cc0){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x331819,_0x263cc0);};Object[_0x208b80(0x2d5)](_0x372250,'__esModule',{'value':!0x0}),_0x372250['WithdrawalController']=void 0x0;const _0x277b2a=_0x1ad727(0x2),_0x584a48=_0x1ad727(0x3),_0x42018b=_0x1ad727(0x38);let _0xd26660=class{constructor(_0x1d0bea){const _0x94a2a5=_0x208b80;this['jobManagerService']=_0x1d0bea,this[_0x94a2a5(0x22a)]=new _0x277b2a['Logger']('WithdrawalController');}async['getQueueStats'](){const _0x135708=_0x208b80;return await this['jobManagerService'][_0x135708(0x2a7)]();}async[_0x208b80(0x191)](){return await this['jobManagerService']['debugQueue']();}async['triggerJobPicking'](){const _0x269a38=_0x208b80;return this['logger'][_0x269a38(0x19e)]('Manually\x20triggering\x20job\x20picking...'),await this['jobManagerService']['triggerPickJobs'](0x1),{'success':!0x0,'message':'Job\x20picking\x20triggered','stats':await this[_0x269a38(0x321)]['getQueueStats']()};}};_0x372250['WithdrawalController']=_0xd26660,_0x5e720f([(0x0,_0x277b2a['Get'])('queue/stats'),(0x0,_0x584a48[_0x208b80(0x361)])({'summary':_0x208b80(0x3f3)}),(0x0,_0x584a48['ApiResponse'])({'status':0xc8,'description':_0x208b80(0x245)}),_0x3c5e02('design:type',Function),_0x3c5e02(_0x208b80(0x17c),[]),_0x3c5e02('design:returntype',Promise)],_0xd26660['prototype'],'getQueueStats',null),_0x5e720f([(0x0,_0x277b2a['Get'])('queue/debug'),(0x0,_0x584a48['ApiOperation'])({'summary':'Get\x20detailed\x20queue\x20debug\x20information'}),(0x0,_0x584a48[_0x208b80(0x370)])({'status':0xc8,'description':_0x208b80(0x400)}),_0x3c5e02(_0x208b80(0x3c0),Function),_0x3c5e02('design:paramtypes',[]),_0x3c5e02('design:returntype',Promise)],_0xd26660['prototype'],'debugQueue',null),_0x5e720f([(0x0,_0x277b2a['Post'])(_0x208b80(0x16c)),(0x0,_0x584a48['ApiOperation'])({'summary':_0x208b80(0x10a)}),(0x0,_0x584a48['ApiResponse'])({'status':0xc8,'description':'Job\x20picking\x20triggered'}),_0x3c5e02(_0x208b80(0x3c0),Function),_0x3c5e02(_0x208b80(0x17c),[]),_0x3c5e02('design:returntype',Promise)],_0xd26660['prototype'],'triggerJobPicking',null),_0x372250['WithdrawalController']=_0xd26660=_0x5e720f([(0x0,_0x584a48[_0x208b80(0x350)])('withdrawal'),(0x0,_0x277b2a[_0x208b80(0x397)])(_0x208b80(0x2c6)),_0x3c5e02('design:paramtypes',[_0x208b80(0x379)==typeof(_0x368baa=void 0x0!==_0x42018b[_0x208b80(0x220)]&&_0x42018b[_0x208b80(0x220)])?_0x368baa:Object])],_0xd26660);},function(_0x5a1ed1,_0x4c0f5b,_0x14fbb6){var _0x198adf=this&&this['__decorate']||function(_0x59ad03,_0x5e94e9,_0x533354,_0x564a02){const _0x3739c6=a0_0x5814;var _0x44dfee,_0x15ffe6=arguments['length'],_0x1624e6=_0x15ffe6<0x3?_0x5e94e9:null===_0x564a02?_0x564a02=Object[_0x3739c6(0x313)](_0x5e94e9,_0x533354):_0x564a02;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x1624e6=Reflect['decorate'](_0x59ad03,_0x5e94e9,_0x533354,_0x564a02);else{for(var _0x2eb41f=_0x59ad03[_0x3739c6(0x2be)]-0x1;_0x2eb41f>=0x0;_0x2eb41f--)(_0x44dfee=_0x59ad03[_0x2eb41f])&&(_0x1624e6=(_0x15ffe6<0x3?_0x44dfee(_0x1624e6):_0x15ffe6>0x3?_0x44dfee(_0x5e94e9,_0x533354,_0x1624e6):_0x44dfee(_0x5e94e9,_0x533354))||_0x1624e6);}return _0x15ffe6>0x3&&_0x1624e6&&Object['defineProperty'](_0x5e94e9,_0x533354,_0x1624e6),_0x1624e6;};Object['defineProperty'](_0x4c0f5b,'__esModule',{'value':!0x0}),_0x4c0f5b['HcBoxModule']=void 0x0;const _0x3e5161=_0x14fbb6(0x2),_0x478e20=_0x14fbb6(0x48);let _0x2b7adb=class{};_0x4c0f5b['HcBoxModule']=_0x2b7adb,_0x4c0f5b['HcBoxModule']=_0x2b7adb=_0x198adf([(0x0,_0x3e5161['Module'])({'providers':[_0x478e20['HcBoxService']],'exports':[_0x478e20['HcBoxService']]})],_0x2b7adb);},function(_0x2c167b,_0x30567d,_0x4f1660){const _0x279097=a0_0x5814;var _0x363293,_0xea5cd9=this&&this['__decorate']||function(_0xaaa2f4,_0x40993e,_0x32ccfa,_0x48ee9e){const _0x425e00=a0_0x5814;var _0x45e268,_0x4d6557=arguments['length'],_0x3b4fc9=_0x4d6557<0x3?_0x40993e:null===_0x48ee9e?_0x48ee9e=Object['getOwnPropertyDescriptor'](_0x40993e,_0x32ccfa):_0x48ee9e;if(_0x425e00(0x1bb)==typeof Reflect&&'function'==typeof Reflect[_0x425e00(0x1fe)])_0x3b4fc9=Reflect[_0x425e00(0x1fe)](_0xaaa2f4,_0x40993e,_0x32ccfa,_0x48ee9e);else{for(var _0x3cbcf8=_0xaaa2f4['length']-0x1;_0x3cbcf8>=0x0;_0x3cbcf8--)(_0x45e268=_0xaaa2f4[_0x3cbcf8])&&(_0x3b4fc9=(_0x4d6557<0x3?_0x45e268(_0x3b4fc9):_0x4d6557>0x3?_0x45e268(_0x40993e,_0x32ccfa,_0x3b4fc9):_0x45e268(_0x40993e,_0x32ccfa))||_0x3b4fc9);}return _0x4d6557>0x3&&_0x3b4fc9&&Object['defineProperty'](_0x40993e,_0x32ccfa,_0x3b4fc9),_0x3b4fc9;},_0x57f524=this&&this['__metadata']||function(_0x47b0bf,_0x13cbbd){const _0x5f538b=a0_0x5814;if('object'==typeof Reflect&&_0x5f538b(0x379)==typeof Reflect['metadata'])return Reflect['metadata'](_0x47b0bf,_0x13cbbd);},_0x2b5073=this&&this['__param']||function(_0xc45af8,_0x309fa3){return function(_0x38a68e,_0x20813e){_0x309fa3(_0x38a68e,_0x20813e,_0xc45af8);};};Object[_0x279097(0x2d5)](_0x30567d,'__esModule',{'value':!0x0}),_0x30567d['HcBoxService']=void 0x0;const _0x314101=_0x4f1660(0x2),_0x291079=_0x4f1660(0xd),_0xe8c2c6=_0x4f1660(0x13),_0x408637=_0x4f1660(0x18);let _0xb9b90f=class{constructor(_0x299c98){const _0x274dda=_0x279097;this['wsService']=_0x299c98,this['logger']=new _0x314101[(_0x274dda(0x3c7))]('HcBoxService');}async[_0x279097(0x106)](){try{return await this['wsService']['listDevices']();}catch(_0x47e87d){throw this['logger']['error']('Error\x20listing\x20devices:\x20'+_0x47e87d['message']),_0x47e87d;}}async[_0x279097(0x3ec)](_0x2a3eb5,_0x6276a6){const _0x2c00cf=_0x279097;try{this['logger']['log'](_0x2c00cf(0x198)+_0x2a3eb5['withdrawalId']+_0x2c00cf(0x2e6)+_0x6276a6);const _0x2159c0=this[_0x2c00cf(0x3bb)](_0x2a3eb5['bankCode']);return _0x2159c0&&(await this['wsService']['launchApp'](_0x6276a6,_0x2159c0),await(0x0,_0x408637[_0x2c00cf(0x404)])(0xbb8)),await this['wsService']['click'](_0x6276a6,0.5,0.3,0.2),await(0x0,_0x408637['sleep'])(0x7d0),this['logger']['warn'](_0x2c00cf(0x332)),this['logger']['log']('Transfer\x20execution\x20completed\x20for\x20withdrawal\x20'+_0x2a3eb5['withdrawalId']),!0x0;}catch(_0x56fb11){throw this['logger']['error'](_0x2c00cf(0x225)+_0x2a3eb5[_0x2c00cf(0x34a)]+':\x20'+_0x56fb11['message']),_0x56fb11;}}['getBankBundleId'](_0x941780){return{'VIETCOMBANK':'com.vietcombank.mobilebanking','TPBANK':'com.tpbank.mobilebanking','TECHCOMBANK':'com.techcombank.mobilebanking'}[_0x941780]||null;}async['click'](_0x2b2b13,_0x2ab2f3,_0x3e5318,_0x30b636=0.2){return this['wsService']['click'](_0x2b2b13,_0x2ab2f3,_0x3e5318,_0x30b636);}async['swipe'](_0x594eca,_0x1e8cbd){const _0x19993d=_0x279097;return this[_0x19993d(0x250)]['swipe'](_0x594eca,_0x1e8cbd);}async[_0x279097(0x39f)](_0x1574ea,_0xabb0e1){return this['wsService']['captureScreen'](_0x1574ea,_0xabb0e1);}async['home'](_0x52d807){const _0x177a39=_0x279097;return this[_0x177a39(0x250)]['home'](_0x52d807);}async[_0x279097(0x126)](_0x177123,_0x415965){const _0x426835=_0x279097;return this['wsService'][_0x426835(0x126)](_0x177123,_0x415965);}['inputText'](_0x2d0a9a,_0x2d80d0){const _0x3e3715=_0x279097;return this[_0x3e3715(0x250)]['inputText'](_0x2d0a9a,_0x2d80d0);}};_0x30567d[_0x279097(0x3b0)]=_0xb9b90f,_0x30567d['HcBoxService']=_0xb9b90f=_0xea5cd9([(0x0,_0x314101[_0x279097(0x1e6)])(),_0x2b5073(0x0,(0x0,_0x314101['Inject'])(_0x291079[_0x279097(0x1c0)])),_0x57f524(_0x279097(0x17c),['function'==typeof(_0x363293=void 0x0!==_0xe8c2c6['IWebSocketService']&&_0xe8c2c6[_0x279097(0x11d)])?_0x363293:Object])],_0xb9b90f);},function(_0x2d5445,_0xfb2060,_0x2e6592){const _0xc98bf8=a0_0x5814;var _0x31cf2f=this&&this['__decorate']||function(_0x367893,_0x4136d9,_0x105aca,_0x2c87f6){const _0xbd1c9f=a0_0x5814;var _0x23df47,_0x1a5ce4=arguments['length'],_0x501cc0=_0x1a5ce4<0x3?_0x4136d9:null===_0x2c87f6?_0x2c87f6=Object[_0xbd1c9f(0x313)](_0x4136d9,_0x105aca):_0x2c87f6;if(_0xbd1c9f(0x1bb)==typeof Reflect&&_0xbd1c9f(0x379)==typeof Reflect['decorate'])_0x501cc0=Reflect[_0xbd1c9f(0x1fe)](_0x367893,_0x4136d9,_0x105aca,_0x2c87f6);else{for(var _0x570741=_0x367893['length']-0x1;_0x570741>=0x0;_0x570741--)(_0x23df47=_0x367893[_0x570741])&&(_0x501cc0=(_0x1a5ce4<0x3?_0x23df47(_0x501cc0):_0x1a5ce4>0x3?_0x23df47(_0x4136d9,_0x105aca,_0x501cc0):_0x23df47(_0x4136d9,_0x105aca))||_0x501cc0);}return _0x1a5ce4>0x3&&_0x501cc0&&Object['defineProperty'](_0x4136d9,_0x105aca,_0x501cc0),_0x501cc0;};Object['defineProperty'](_0xfb2060,'__esModule',{'value':!0x0}),_0xfb2060['DeviceModule']=void 0x0;const _0x17427b=_0x2e6592(0x2),_0x4d9fcb=_0x2e6592(0x4a),_0x1393b6=_0x2e6592(0xe),_0x4fc8d2=_0x2e6592(0x14),_0x56a316=_0x2e6592(0x47),_0x4c195e=_0x2e6592(0xf),_0x137ce2=_0x2e6592(0x4c);let _0x169beb=class{};_0xfb2060[_0xc98bf8(0x1ca)]=_0x169beb,_0xfb2060['DeviceModule']=_0x169beb=_0x31cf2f([(0x0,_0x17427b[_0xc98bf8(0x1f9)])({'imports':[_0x56a316['HcBoxModule'],(0x0,_0x17427b['forwardRef'])(()=>_0x137ce2['BankModule'])],'controllers':[_0x4d9fcb[_0xc98bf8(0x412)]],'providers':[_0x1393b6['DeviceService'],_0x4fc8d2['DeviceLockService'],_0x4c195e[_0xc98bf8(0x310)]],'exports':[_0x1393b6['DeviceService'],_0x4fc8d2['DeviceLockService']]})],_0x169beb);},function(_0x82f913,_0x484745,_0x3efa7f){const _0x1ba781=a0_0x5814;var _0x2c042c,_0x3e9631,_0x5591ec,_0x524182=this&&this[_0x1ba781(0x21a)]||function(_0x411dc0,_0x34261c,_0xad9dde,_0x39796f){const _0x29d917=_0x1ba781;var _0x4bbbc2,_0x5b7f1f=arguments['length'],_0x18a830=_0x5b7f1f<0x3?_0x34261c:null===_0x39796f?_0x39796f=Object['getOwnPropertyDescriptor'](_0x34261c,_0xad9dde):_0x39796f;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x18a830=Reflect['decorate'](_0x411dc0,_0x34261c,_0xad9dde,_0x39796f);else{for(var _0x5f3a0b=_0x411dc0[_0x29d917(0x2be)]-0x1;_0x5f3a0b>=0x0;_0x5f3a0b--)(_0x4bbbc2=_0x411dc0[_0x5f3a0b])&&(_0x18a830=(_0x5b7f1f<0x3?_0x4bbbc2(_0x18a830):_0x5b7f1f>0x3?_0x4bbbc2(_0x34261c,_0xad9dde,_0x18a830):_0x4bbbc2(_0x34261c,_0xad9dde))||_0x18a830);}return _0x5b7f1f>0x3&&_0x18a830&&Object['defineProperty'](_0x34261c,_0xad9dde,_0x18a830),_0x18a830;},_0x26fca8=this&&this['__metadata']||function(_0x27d1bf,_0x1a87b5){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x27d1bf,_0x1a87b5);},_0x2c27c3=this&&this['__param']||function(_0x1aa41b,_0x41f926){return function(_0x5e2273,_0x5e3b7d){_0x41f926(_0x5e2273,_0x5e3b7d,_0x1aa41b);};};Object[_0x1ba781(0x2d5)](_0x484745,_0x1ba781(0x363),{'value':!0x0}),_0x484745['DeviceController']=void 0x0;const _0xd42693=_0x3efa7f(0x2),_0x2cd8d4=_0x3efa7f(0xe),_0xc8551e=_0x3efa7f(0x4b),_0x4b96d8=_0x3efa7f(0xb),_0x19d43f=_0x3efa7f(0x11);let _0x287271=class{constructor(_0x366c61,_0x125302){this['deviceService']=_0x366c61,this['bankService']=_0x125302,this['logger']=new _0xd42693['Logger']('DeviceController');}async['getDevicesPage'](){const _0x378fe2=_0x1ba781;return{'devices':await this[_0x378fe2(0x20d)]['listDevices'](),'serviceStatus':await this['deviceService']['getServiceStatus'](),'banks':['ACB','HDBANK',_0x378fe2(0x32b),_0x378fe2(0x10e),'TPBANK','VIETCOMBANK'],'boxType':_0x19d43f['config']['boxType']};}async['getDevices'](){const _0x2d8cbd=_0x1ba781;return{'success':!0x0,'data':await this[_0x2d8cbd(0x20d)][_0x2d8cbd(0x106)]()};}async['getDeviceConfig'](_0x10cfe7){return{'success':!0x0,'data':await this['deviceService']['getDeviceConfigSafe'](_0x10cfe7)};}async['retryLogin'](_0x15ab6b){const _0x556357=_0x1ba781;try{this[_0x556357(0x22a)]['log']('Retry\x20login\x20requested\x20for\x20device\x20'+_0x15ab6b);const _0x106348=await this['deviceService']['getDeviceConfig'](_0x15ab6b);if(!_0x106348)throw new _0xd42693['HttpException']({'success':!0x1,'error':_0x556357(0x3d3)+_0x15ab6b+'\x20not\x20found\x20or\x20not\x20configured'},_0xd42693['HttpStatus']['BAD_REQUEST']);if(!_0x106348['bankCode']||''===_0x106348['bankCode'][_0x556357(0x396)]())throw new _0xd42693[(_0x556357(0x317))]({'success':!0x1,'error':_0x556357(0x3d3)+_0x15ab6b+'\x20does\x20not\x20have\x20bankCode\x20configured.\x20Please\x20configure\x20bankCode\x20first.'},_0xd42693['HttpStatus']['BAD_REQUEST']);const _0x586c4d=_0x106348['bankCode']['toUpperCase']();return await this['bankService'][_0x556357(0x3f2)](_0x586c4d,_0x15ab6b),{'success':!0x0,'message':'Successfully\x20logged\x20in\x20to\x20'+_0x586c4d+'\x20on\x20device\x20'+_0x15ab6b};}catch(_0x597410){if(_0x597410 instanceof _0xd42693[_0x556357(0x317)])throw _0x597410;throw this['logger']['error']('Error\x20retrying\x20login\x20for\x20device\x20'+_0x15ab6b+':\x20'+_0x597410['message'],_0x597410[_0x556357(0x1f2)]),new _0xd42693[(_0x556357(0x317))]({'success':!0x1,'error':_0x597410['message']||'Failed\x20to\x20retry\x20login'},_0xd42693['HttpStatus'][_0x556357(0x328)]);}}async['updateDeviceConfig'](_0x5c848d,_0x115ebf){const _0x3c0d34=_0x1ba781;try{this['logger']['log']('Updating\x20device\x20config\x20for\x20'+_0x5c848d+':\x20'+JSON['stringify'](_0x115ebf));const _0x3cb912=await this['deviceService'][_0x3c0d34(0x24f)](_0x5c848d);if('active'===(void 0x0!==_0x115ebf['status']?_0x115ebf[_0x3c0d34(0x2a8)]:_0x3cb912?.['status']||'deactive')){const _0x4a2c99=[],_0x36973c=void 0x0!==_0x115ebf[_0x3c0d34(0x358)]?_0x115ebf['bankCode']:_0x3cb912?.['bankCode'];_0x36973c&&''!==_0x36973c['trim']()||_0x4a2c99[_0x3c0d34(0x235)]('Bank\x20Code\x20là\x20bắt\x20buộc\x20khi\x20status\x20là\x20active');const _0xa048d3=void 0x0!==_0x115ebf['availableAmount']?_0x115ebf['availableAmount']:_0x3cb912?.[_0x3c0d34(0x117)];(null==_0xa048d3||_0xa048d3<0x0)&&_0x4a2c99[_0x3c0d34(0x235)](_0x3c0d34(0x2ed));const _0x2bbc89=void 0x0!==_0x115ebf['password']?_0x115ebf['password']:_0x3cb912?.['password'];_0x2bbc89&&''!==_0x2bbc89[_0x3c0d34(0x396)]()||_0x4a2c99[_0x3c0d34(0x235)]('Password\x20là\x20bắt\x20buộc\x20khi\x20status\x20là\x20active');const _0x8700fa=void 0x0!==_0x115ebf['smartOTP']?_0x115ebf['smartOTP']:_0x3cb912?.['smartOTP'];if(_0x8700fa&&''!==_0x8700fa['trim']()||_0x4a2c99['push']('Smart\x20OTP\x20là\x20bắt\x20buộc\x20khi\x20status\x20là\x20active'),_0x4a2c99['length']>0x0)throw new _0xd42693['HttpException']({'success':!0x1,'error':_0x4a2c99[_0x3c0d34(0x19c)](',\x20')},_0xd42693['HttpStatus']['BAD_REQUEST']);}return{'success':!0x0,'data':await this['deviceService'][_0x3c0d34(0x322)](_0x5c848d,_0x115ebf)};}catch(_0x344fec){if(_0x344fec instanceof _0xd42693['HttpException'])throw _0x344fec;throw this['logger']['error'](_0x3c0d34(0x144)+_0x5c848d+':\x20'+_0x344fec[_0x3c0d34(0x36b)],_0x344fec[_0x3c0d34(0x1f2)]),new _0xd42693['HttpException']({'success':!0x1,'error':_0x344fec['message']||'Failed\x20to\x20update\x20device\x20config'},_0xd42693['HttpStatus'][_0x3c0d34(0x328)]);}}async['getServiceStatus'](){return{'success':!0x0,'data':{'status':await this['deviceService']['getServiceStatus']()}};}async['startService'](){const _0x212ef0=_0x1ba781;return await this['deviceService'][_0x212ef0(0x1d0)]();}async['stopService'](){return await this['deviceService']['setServiceStatus']('inactive'),{'success':!0x0,'message':'Service\x20stopped\x20successfully'};}async['deleteDeviceConfig'](_0x47a751){const _0x250cad=_0x1ba781;return await this[_0x250cad(0x20d)]['deleteDeviceConfig'](_0x47a751),{'success':!0x0,'message':'Device\x20config\x20deleted\x20successfully'};}};_0x484745['DeviceController']=_0x287271,_0x524182([(0x0,_0xd42693['Get'])(),(0x0,_0xd42693['Render'])('devices'),_0x26fca8(_0x1ba781(0x3c0),Function),_0x26fca8(_0x1ba781(0x17c),[]),_0x26fca8('design:returntype',Promise)],_0x287271['prototype'],'getDevicesPage',null),_0x524182([(0x0,_0xd42693['Get'])('api/devices'),_0x26fca8('design:type',Function),_0x26fca8('design:paramtypes',[]),_0x26fca8('design:returntype',Promise)],_0x287271['prototype'],'getDevices',null),_0x524182([(0x0,_0xd42693['Get'])(_0x1ba781(0x2f3)),_0x2c27c3(0x0,(0x0,_0xd42693['Param'])('deviceId')),_0x26fca8(_0x1ba781(0x3c0),Function),_0x26fca8('design:paramtypes',[String]),_0x26fca8(_0x1ba781(0x2ee),Promise)],_0x287271['prototype'],'getDeviceConfig',null),_0x524182([(0x0,_0xd42693['Post'])('api/devices/:deviceId/retryLogin'),_0x2c27c3(0x0,(0x0,_0xd42693['Param'])(_0x1ba781(0x364))),_0x26fca8(_0x1ba781(0x3c0),Function),_0x26fca8(_0x1ba781(0x17c),[String]),_0x26fca8('design:returntype',Promise)],_0x287271[_0x1ba781(0x3b2)],'retryLogin',null),_0x524182([(0x0,_0xd42693['Put'])('api/devices/:deviceId/config'),_0x2c27c3(0x0,(0x0,_0xd42693['Param'])(_0x1ba781(0x364))),_0x2c27c3(0x1,(0x0,_0xd42693[_0x1ba781(0x11f)])()),_0x26fca8('design:type',Function),_0x26fca8(_0x1ba781(0x17c),[String,'function'==typeof(_0x5591ec=void 0x0!==_0xc8551e['UpdateDeviceConfigDto']&&_0xc8551e['UpdateDeviceConfigDto'])?_0x5591ec:Object]),_0x26fca8(_0x1ba781(0x2ee),Promise)],_0x287271[_0x1ba781(0x3b2)],_0x1ba781(0x322),null),_0x524182([(0x0,_0xd42693['Get'])(_0x1ba781(0x28b)),_0x26fca8(_0x1ba781(0x3c0),Function),_0x26fca8('design:paramtypes',[]),_0x26fca8('design:returntype',Promise)],_0x287271['prototype'],'getServiceStatus',null),_0x524182([(0x0,_0xd42693[_0x1ba781(0x1e2)])(_0x1ba781(0x382)),_0x26fca8(_0x1ba781(0x3c0),Function),_0x26fca8('design:paramtypes',[]),_0x26fca8(_0x1ba781(0x2ee),Promise)],_0x287271[_0x1ba781(0x3b2)],'startService',null),_0x524182([(0x0,_0xd42693['Post'])('api/service/stop'),_0x26fca8(_0x1ba781(0x3c0),Function),_0x26fca8(_0x1ba781(0x17c),[]),_0x26fca8('design:returntype',Promise)],_0x287271[_0x1ba781(0x3b2)],_0x1ba781(0x3d5),null),_0x524182([(0x0,_0xd42693['Delete'])(_0x1ba781(0x2f3)),_0x2c27c3(0x0,(0x0,_0xd42693['Param'])('deviceId')),_0x26fca8(_0x1ba781(0x3c0),Function),_0x26fca8(_0x1ba781(0x17c),[String]),_0x26fca8('design:returntype',Promise)],_0x287271['prototype'],'deleteDeviceConfig',null),_0x484745['DeviceController']=_0x287271=_0x524182([(0x0,_0xd42693['Controller'])(),_0x26fca8('design:paramtypes',[_0x1ba781(0x379)==typeof(_0x2c042c=void 0x0!==_0x2cd8d4['DeviceService']&&_0x2cd8d4[_0x1ba781(0x1f4)])?_0x2c042c:Object,_0x1ba781(0x379)==typeof(_0x3e9631=void 0x0!==_0x4b96d8[_0x1ba781(0x20a)]&&_0x4b96d8['BankService'])?_0x3e9631:Object])],_0x287271);},function(_0x56b737,_0x17189f,_0x513909){const _0x4e1d83=a0_0x5814;var _0xc6795c=this&&this['__decorate']||function(_0x52f1e9,_0x43aa36,_0x4bf1b4,_0x540e82){const _0x2be422=a0_0x5814;var _0xc2ea0e,_0x3f4ed1=arguments['length'],_0x19224e=_0x3f4ed1<0x3?_0x43aa36:null===_0x540e82?_0x540e82=Object['getOwnPropertyDescriptor'](_0x43aa36,_0x4bf1b4):_0x540e82;if(_0x2be422(0x1bb)==typeof Reflect&&'function'==typeof Reflect[_0x2be422(0x1fe)])_0x19224e=Reflect['decorate'](_0x52f1e9,_0x43aa36,_0x4bf1b4,_0x540e82);else{for(var _0x5ef219=_0x52f1e9['length']-0x1;_0x5ef219>=0x0;_0x5ef219--)(_0xc2ea0e=_0x52f1e9[_0x5ef219])&&(_0x19224e=(_0x3f4ed1<0x3?_0xc2ea0e(_0x19224e):_0x3f4ed1>0x3?_0xc2ea0e(_0x43aa36,_0x4bf1b4,_0x19224e):_0xc2ea0e(_0x43aa36,_0x4bf1b4))||_0x19224e);}return _0x3f4ed1>0x3&&_0x19224e&&Object['defineProperty'](_0x43aa36,_0x4bf1b4,_0x19224e),_0x19224e;},_0x154356=this&&this[_0x4e1d83(0x16e)]||function(_0x1f2760,_0x85fce2){const _0x4d3661=_0x4e1d83;if('object'==typeof Reflect&&_0x4d3661(0x379)==typeof Reflect[_0x4d3661(0x168)])return Reflect['metadata'](_0x1f2760,_0x85fce2);};Object['defineProperty'](_0x17189f,'__esModule',{'value':!0x0}),_0x17189f['DeviceBankCode']=_0x17189f['UpdateDeviceConfigDto']=void 0x0;const _0x8e900b=_0x513909(0x3b);class _0x19a28a{}var _0x5e69b4;_0x17189f['UpdateDeviceConfigDto']=_0x19a28a,_0xc6795c([(0x0,_0x8e900b[_0x4e1d83(0x179)])(_0x1b2526=>'active'===_0x1b2526[_0x4e1d83(0x2a8)]),(0x0,_0x8e900b['IsNotEmpty'])({'message':'Bank\x20Code\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x8e900b[_0x4e1d83(0x293)])(),(0x0,_0x8e900b['IsOptional'])(),_0x154356('design:type',String)],_0x19a28a['prototype'],_0x4e1d83(0x358),void 0x0),_0xc6795c([(0x0,_0x8e900b['ValidateIf'])(_0x8e31fd=>'active'===_0x8e31fd['status']),(0x0,_0x8e900b[_0x4e1d83(0x378)])({'message':'Available\x20Amount\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x8e900b['IsNumber'])(),(0x0,_0x8e900b['Min'])(0x0,{'message':_0x4e1d83(0x137)}),(0x0,_0x8e900b['IsOptional'])(),_0x154356('design:type',Number)],_0x19a28a[_0x4e1d83(0x3b2)],_0x4e1d83(0x117),void 0x0),_0xc6795c([(0x0,_0x8e900b['IsOptional'])(),(0x0,_0x8e900b['IsString'])(),(0x0,_0x8e900b['IsIn'])([_0x4e1d83(0x2db),'deactive']),_0x154356('design:type',String)],_0x19a28a['prototype'],'status',void 0x0),_0xc6795c([(0x0,_0x8e900b['ValidateIf'])(_0x334ff1=>'active'===_0x334ff1['status']),(0x0,_0x8e900b[_0x4e1d83(0x378)])({'message':_0x4e1d83(0x2bb)}),(0x0,_0x8e900b['IsString'])(),(0x0,_0x8e900b['IsOptional'])(),_0x154356('design:type',String)],_0x19a28a['prototype'],_0x4e1d83(0x13f),void 0x0),_0xc6795c([(0x0,_0x8e900b['ValidateIf'])(_0x32f324=>'active'===_0x32f324['status']),(0x0,_0x8e900b['IsNotEmpty'])({'message':'Smart\x20OTP\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x8e900b['IsString'])(),(0x0,_0x8e900b['IsOptional'])(),_0x154356('design:type',String)],_0x19a28a['prototype'],'smartOTP',void 0x0),_0xc6795c([(0x0,_0x8e900b['ValidateIf'])(_0x467920=>'active'===_0x467920['status']),(0x0,_0x8e900b['IsNotEmpty'])({'message':_0x4e1d83(0x1c6)}),(0x0,_0x8e900b['IsString'])(),(0x0,_0x8e900b['IsOptional'])(),_0x154356('design:type',String)],_0x19a28a[_0x4e1d83(0x3b2)],_0x4e1d83(0x345),void 0x0),_0xc6795c([(0x0,_0x8e900b['ValidateIf'])(_0x434ffc=>'active'===_0x434ffc['status']),(0x0,_0x8e900b[_0x4e1d83(0x378)])({'message':'Account\x20Name\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x8e900b[_0x4e1d83(0x293)])(),(0x0,_0x8e900b['IsOptional'])(),_0x154356('design:type',String)],_0x19a28a['prototype'],'accountName',void 0x0),function(_0x4327f4){const _0x1f77e0=_0x4e1d83;_0x4327f4['ACB']='ACB',_0x4327f4['PGBANK']=_0x1f77e0(0x32b),_0x4327f4['HDBANK']=_0x1f77e0(0x132),_0x4327f4['VIETCOMBANK']='VIETCOMBANK';}(_0x5e69b4||(_0x17189f['DeviceBankCode']=_0x5e69b4={}));},function(_0x41ce98,_0x4ad259,_0x4de247){const _0x3bfed3=a0_0x5814;var _0x2d91c2=this&&this[_0x3bfed3(0x21a)]||function(_0x42dc28,_0x37d63f,_0x38d841,_0x473e48){const _0x4ff142=_0x3bfed3;var _0x5416a2,_0x171e9b=arguments['length'],_0x189cfe=_0x171e9b<0x3?_0x37d63f:null===_0x473e48?_0x473e48=Object['getOwnPropertyDescriptor'](_0x37d63f,_0x38d841):_0x473e48;if('object'==typeof Reflect&&_0x4ff142(0x379)==typeof Reflect['decorate'])_0x189cfe=Reflect['decorate'](_0x42dc28,_0x37d63f,_0x38d841,_0x473e48);else{for(var _0x251950=_0x42dc28['length']-0x1;_0x251950>=0x0;_0x251950--)(_0x5416a2=_0x42dc28[_0x251950])&&(_0x189cfe=(_0x171e9b<0x3?_0x5416a2(_0x189cfe):_0x171e9b>0x3?_0x5416a2(_0x37d63f,_0x38d841,_0x189cfe):_0x5416a2(_0x37d63f,_0x38d841))||_0x189cfe);}return _0x171e9b>0x3&&_0x189cfe&&Object['defineProperty'](_0x37d63f,_0x38d841,_0x189cfe),_0x189cfe;};Object['defineProperty'](_0x4ad259,'__esModule',{'value':!0x0}),_0x4ad259['BankModule']=void 0x0;const _0xa19cc9=_0x4de247(0x2),_0x3e9d34=_0x4de247(0xb),_0x393073=_0x4de247(0xc),_0x5e6138=_0x4de247(0x28),_0x275ef7=_0x4de247(0x2f),_0x47a5e9=_0x4de247(0x4d),_0xa3f8c1=_0x4de247(0x47),_0x572753=_0x4de247(0x49),_0x5a9446=_0x4de247(0x4e),_0x2a5967=_0x4de247(0x34),_0x2a9b29=_0x4de247(0x52),_0x589ed2=_0x4de247(0xf),_0x155acb=_0x4de247(0x53),_0x5b3168=_0x4de247(0x54),_0x53ce72=_0x4de247(0x32);let _0x3670da=class{};_0x4ad259[_0x3bfed3(0x25c)]=_0x3670da,_0x4ad259['BankModule']=_0x3670da=_0x2d91c2([(0x0,_0xa19cc9[_0x3bfed3(0x1f9)])({'imports':[_0xa3f8c1['HcBoxModule'],(0x0,_0xa19cc9[_0x3bfed3(0x19a)])(()=>_0x572753['DeviceModule']),_0x5a9446['WebSocketModule'],_0x155acb['OCRModule'],_0x5b3168['NotificationModule']],'controllers':[_0x47a5e9['BankController']],'providers':[_0x3e9d34['BankService'],_0x393073['AcbService'],_0x5e6138[_0x3bfed3(0x196)],_0x275ef7['HdBankService'],_0x53ce72['VietcombankService'],_0x2a5967['SessionManagementService'],_0x2a9b29['SessionRefreshScheduler'],_0x589ed2['RedisService']],'exports':[_0x3e9d34['BankService']]})],_0x3670da);},function(_0x44d4b2,_0x2f245e,_0xd79f93){const _0x383fa7=a0_0x5814;var _0x4ba4a7,_0xce5753,_0x53ee68,_0x1877e3,_0x3d2aae=this&&this['__decorate']||function(_0x12f947,_0x41b03b,_0x49dc4f,_0x16d774){const _0x9997ac=a0_0x5814;var _0x579628,_0x22528=arguments['length'],_0x497d75=_0x22528<0x3?_0x41b03b:null===_0x16d774?_0x16d774=Object['getOwnPropertyDescriptor'](_0x41b03b,_0x49dc4f):_0x16d774;if(_0x9997ac(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x497d75=Reflect[_0x9997ac(0x1fe)](_0x12f947,_0x41b03b,_0x49dc4f,_0x16d774);else{for(var _0xf2e198=_0x12f947['length']-0x1;_0xf2e198>=0x0;_0xf2e198--)(_0x579628=_0x12f947[_0xf2e198])&&(_0x497d75=(_0x22528<0x3?_0x579628(_0x497d75):_0x22528>0x3?_0x579628(_0x41b03b,_0x49dc4f,_0x497d75):_0x579628(_0x41b03b,_0x49dc4f))||_0x497d75);}return _0x22528>0x3&&_0x497d75&&Object['defineProperty'](_0x41b03b,_0x49dc4f,_0x497d75),_0x497d75;},_0x375591=this&&this[_0x383fa7(0x16e)]||function(_0x35d828,_0x46fbaf){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x35d828,_0x46fbaf);},_0x57216f=this&&this['__param']||function(_0x347aa1,_0x4e1c04){return function(_0x1e1b83,_0x4d2d67){_0x4e1c04(_0x1e1b83,_0x4d2d67,_0x347aa1);};};Object['defineProperty'](_0x2f245e,'__esModule',{'value':!0x0}),_0x2f245e[_0x383fa7(0x336)]=void 0x0;const _0x3f96a3=_0xd79f93(0x2),_0x32420e=_0xd79f93(0x3),_0x468ef=_0xd79f93(0xb),_0x1b5863=_0xd79f93(0x11),_0x5069c5=_0xd79f93(0x13),_0x312e37=_0xd79f93(0xd),_0x5cfc37=_0xd79f93(0x1a),_0x1d6a3e=_0xd79f93(0x1e),_0x39ba7d=_0xd79f93(0x1b),_0x2acfd3=_0xd79f93(0x20);let _0x1eb2bb=class{constructor(_0x3c9977,_0x29df04,_0x19b381,_0x5717c0){const _0x3eef07=_0x383fa7;this['bankService']=_0x3c9977,this['wsService']=_0x29df04,this['imagePreprocessingService']=_0x19b381,this[_0x3eef07(0x411)]=_0x5717c0,this['logger']=new _0x3f96a3['Logger']('BankController');}['getBankService'](_0x481510){const _0x53fffb=_0x383fa7,_0x45b1b9=this['bankService']['getBankService'](_0x481510);if(!_0x45b1b9)throw new _0x3f96a3['HttpException']({'success':!0x1,'error':'Bank\x20service\x20not\x20found\x20for\x20bank\x20code:\x20'+_0x481510+_0x53fffb(0x2d4)+this['bankService']['getSupportedBanks']()['join'](',\x20')},_0x3f96a3[_0x53fffb(0x133)]['BAD_REQUEST']);return _0x45b1b9;}async['getDevices'](_0x5e17f9){const _0x3c26bd=_0x383fa7;try{return{'success':!0x0,'data':await this['wsService'][_0x3c26bd(0x106)]()};}catch(_0x4780ae){return this['logger']['error']('Error\x20getting\x20devices:\x20'+_0x4780ae['message']),{'success':!0x1,'error':_0x4780ae['message']};}}async['testLaunchApp'](_0x4fc5e2,_0x2f1253){const _0x10761c=_0x383fa7;try{const _0x75aedc=this[_0x10761c(0x237)](_0x4fc5e2);return this['logger'][_0x10761c(0x19e)]('Testing\x20'+_0x4fc5e2+'\x20app\x20launch\x20on\x20device:\x20'+_0x2f1253),await _0x75aedc[_0x10761c(0x3dd)](_0x2f1253),{'success':!0x0,'message':_0x4fc5e2+'\x20app\x20launched\x20successfully\x20on\x20device\x20'+_0x2f1253};}catch(_0x54d4ea){return this['logger']['error'](_0x10761c(0x30c)+_0x4fc5e2+_0x10761c(0x2ca)+_0x54d4ea[_0x10761c(0x36b)]),{'success':!0x1,'error':_0x54d4ea[_0x10761c(0x36b)]};}}async['testCaptureScreen'](_0x385764,_0x142b70,_0xfa97bc,_0x386d97){const _0x59c887=_0x383fa7;try{this[_0x59c887(0x22a)][_0x59c887(0x19e)](_0x59c887(0x275)+_0x142b70);const _0x374eba=_0x386d97?parseFloat(_0x386d97):0.5,_0x59b0b3=_0xfa97bc||'test-screen-capture-'+Date['now'](),_0x176716=await this[_0x59c887(0x250)][_0x59c887(0x1bf)](_0x142b70,{'quality':_0x374eba,'folderPath':_0x59c887(0x2f2)+_0x59b0b3+'.png'});return{'success':!0x0,'message':'Screen\x20captured\x20successfully\x20on\x20device\x20'+_0x142b70,'data':{'base64Image':_0x176716,'imageLength':_0x176716?.[_0x59c887(0x2be)]??0x0}};}catch(_0xabe959){return this['logger']['error']('Error\x20testing\x20screen\x20capture:\x20'+_0xabe959['message']),{'success':!0x1,'error':_0xabe959['message']};}}async['testClickAtCoordinates'](_0x37d575,_0x2234f8,_0x10aa2d,_0x3a0749){const _0x134b8d=_0x383fa7;try{const _0x35ea41=parseFloat(_0x10aa2d),_0x3f9a9e=parseFloat(_0x3a0749);return isNaN(_0x35ea41)||isNaN(_0x3f9a9e)?{'success':!0x1,'error':_0x134b8d(0x1a8),'example':'/api/bank/'+_0x37d575+_0x134b8d(0x14f)}:(this['logger'][_0x134b8d(0x19e)]('Testing\x20click\x20at\x20coordinates\x20('+_0x35ea41+',\x20'+_0x3f9a9e+')\x20on\x20device:\x20'+_0x2234f8),await this['wsService']['click'](_0x2234f8,_0x35ea41,_0x3f9a9e),{'success':!0x0,'message':_0x134b8d(0x303)+_0x35ea41+',\x20'+_0x3f9a9e+')\x20on\x20device\x20'+_0x2234f8,'coordinates':{'x':_0x35ea41,'y':_0x3f9a9e}});}catch(_0x13d28b){return this[_0x134b8d(0x22a)]['error']('Error\x20testing\x20click\x20at\x20coordinates:\x20'+_0x13d28b['message']),{'success':!0x1,'error':_0x13d28b['message']};}}async['testSwipe'](_0x334d1c,_0x1ebe5a,_0x1ea77a,_0xc3e717,_0x2f175a,_0x289e56,_0x30297f,_0x37da47){const _0x2b932f=_0x383fa7;try{const _0x24b909=_0x2b932f(0x3d4)===_0x1b5863[_0x2b932f(0x3ba)]['boxType'],_0x2d3530='HC'===_0x1b5863['config']['boxType'];if(_0x24b909){if(!_0x2f175a)return{'success':!0x1,'error':'For\x20Panda\x20format:\x20type\x20is\x20required','example':'/api/bank/'+_0x334d1c+'/test/swipe/{deviceId}?type=0'};if(!['0','1','2','4','5','6','7','8','9','10']['includes'](_0x2f175a))return{'success':!0x1,'error':'Invalid\x20type.\x20Type\x20must\x20be\x20one\x20of:\x200\x20(按下/press),\x201\x20(抬起/lift),\x202\x20(移动/move),\x204\x20(滚轮向上/scroll\x20up),\x205\x20(滚轮向下/scroll\x20down),\x206\x20(上滑/swipe\x20up),\x207\x20(下滑/swipe\x20down),\x208\x20(左滑/swipe\x20left),\x209\x20(右滑/swipe\x20right),\x2010\x20(点击/click)','example':_0x2b932f(0x3e8)+_0x334d1c+_0x2b932f(0x408)};if(!(['4','5','6','7','8','9']['includes'](_0x2f175a)||_0x1ea77a&&_0xc3e717))return{'success':!0x1,'error':_0x2b932f(0x202)+_0x2f175a+':\x20x\x20and\x20y\x20are\x20required','example':'/api/bank/'+_0x334d1c+'/test/swipe/{deviceId}?x=50&y=30&type='+_0x2f175a};const _0x472920={'type':_0x2f175a};if(_0x1ea77a&&_0xc3e717){const _0x475d0d=parseFloat(_0x1ea77a),_0x1e5cf7=parseFloat(_0xc3e717);if(isNaN(_0x475d0d)||isNaN(_0x1e5cf7))return{'success':!0x1,'error':'Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20numbers\x20between\x200\x20and\x20100\x20for\x20Panda','example':'/api/bank/'+_0x334d1c+'/test/swipe/{deviceId}?x=50&y=30&type='+_0x2f175a};if(_0x475d0d<0x0||_0x475d0d>0x64||_0x1e5cf7<0x0||_0x1e5cf7>0x64)return{'success':!0x1,'error':'Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20between\x200\x20and\x20100\x20for\x20Panda','example':_0x2b932f(0x3e8)+_0x334d1c+_0x2b932f(0x2b0)+_0x2f175a};_0x472920['x']=_0x475d0d[_0x2b932f(0x238)](),_0x472920['y']=_0x1e5cf7['toString']();}return this['logger']['log']('Testing\x20Panda\x20swipe\x20on\x20device:\x20'+_0x1ebe5a+'\x20with\x20type='+_0x2f175a+(_0x1ea77a&&_0xc3e717?',\x20x='+_0x1ea77a+_0x2b932f(0x259)+_0xc3e717:_0x2b932f(0x3bd))),await this['wsService']['swipe'](_0x1ebe5a,_0x472920),{'success':!0x0,'message':'Panda\x20swipe\x20completed\x20successfully\x20on\x20device\x20'+_0x1ebe5a,'coordinates':{'type':_0x2f175a,..._0x1ea77a&&_0xc3e717?{'x':_0x1ea77a,'y':_0xc3e717}:{}}};}if(_0x2d3530){if(!(_0x1ea77a&&_0xc3e717&&_0x289e56&&_0x30297f))return{'success':!0x1,'error':'For\x20HC\x20format:\x20x,\x20y,\x20endX,\x20and\x20endY\x20are\x20required','example':'/api/bank/'+_0x334d1c+'/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3'};const _0x2f220f=parseFloat(_0x1ea77a),_0x1a9006=parseFloat(_0xc3e717),_0x3c55c0=parseFloat(_0x289e56),_0x389ca4=parseFloat(_0x30297f),_0x5e7cb9=_0x37da47?parseFloat(_0x37da47):0.2;return isNaN(_0x2f220f)||isNaN(_0x1a9006)||isNaN(_0x3c55c0)||isNaN(_0x389ca4)?{'success':!0x1,'error':'Invalid\x20coordinates.\x20x,\x20y,\x20endX,\x20and\x20endY\x20must\x20be\x20numbers\x20between\x200\x20and\x201\x20for\x20HC','example':'/api/bank/'+_0x334d1c+'/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3'}:_0x2f220f<0x0||_0x2f220f>0x1||_0x1a9006<0x0||_0x1a9006>0x1||_0x3c55c0<0x0||_0x3c55c0>0x1||_0x389ca4<0x0||_0x389ca4>0x1?{'success':!0x1,'error':'Invalid\x20coordinates.\x20x,\x20y,\x20endX,\x20and\x20endY\x20must\x20be\x20between\x200\x20and\x201\x20for\x20HC','example':'/api/bank/'+_0x334d1c+'/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3'}:(this['logger']['log']('Testing\x20HC\x20swipe\x20from\x20('+_0x2f220f+',\x20'+_0x1a9006+_0x2b932f(0x284)+_0x3c55c0+',\x20'+_0x389ca4+')\x20on\x20device:\x20'+_0x1ebe5a),await this[_0x2b932f(0x250)][_0x2b932f(0x3eb)](_0x1ebe5a,{'x':_0x2f220f,'y':_0x1a9006,'endX':_0x3c55c0,'endY':_0x389ca4,'duration':_0x5e7cb9}),{'success':!0x0,'message':'HC\x20swipe\x20completed\x20successfully\x20from\x20('+_0x2f220f+',\x20'+_0x1a9006+_0x2b932f(0x284)+_0x3c55c0+',\x20'+_0x389ca4+')\x20on\x20device\x20'+_0x1ebe5a,'coordinates':{'start':{'x':_0x2f220f,'y':_0x1a9006},'end':{'x':_0x3c55c0,'y':_0x389ca4},'duration':_0x5e7cb9}});}return{'success':!0x1,'error':_0x2b932f(0x119)+_0x1b5863['config'][_0x2b932f(0x195)]+_0x2b932f(0x178)};}catch(_0x3ff336){return this['logger']['error']('Error\x20testing\x20swipe:\x20'+_0x3ff336['message']),{'success':!0x1,'error':_0x3ff336['message']};}}async['testInputNumpadNumber'](_0x435127,_0x2febca,_0x3f22cf){const _0x15dc41=_0x383fa7;try{return _0x3f22cf&&0x0!==_0x3f22cf[_0x15dc41(0x396)]()[_0x15dc41(0x2be)]?/^\d+$/['test'](_0x3f22cf)?(this['logger']['log']('Testing\x20numpad\x20number\x20input\x20\x22'+_0x3f22cf+'\x22\x20on\x20device:\x20'+_0x2febca),await this['wsService'][_0x15dc41(0x126)](_0x2febca,_0x3f22cf),{'success':!0x0,'message':'Numpad\x20number\x20input\x20completed\x20successfully\x20on\x20device\x20'+_0x2febca,'data':{'number':_0x3f22cf,'digits':_0x3f22cf[_0x15dc41(0x165)]('')['map'](_0x13f928=>parseInt(_0x13f928))}}):{'success':!0x1,'error':'Number\x20must\x20contain\x20only\x20digits\x20(0-9)','example':'/api/bank/'+_0x435127+'/test/input-numpad/{deviceId}?number=123456'}:{'success':!0x1,'error':_0x15dc41(0x21c),'example':'/api/bank/'+_0x435127+'/test/input-numpad/{deviceId}?number=123456'};}catch(_0x318984){return this['logger'][_0x15dc41(0x3e9)](_0x15dc41(0x1df)+_0x318984['message']),{'success':!0x1,'error':_0x318984[_0x15dc41(0x36b)]};}}async['testInputText'](_0x23b4f5,_0x38eb6b,_0x172fda){const _0x33e5cc=_0x383fa7;try{return _0x172fda&&0x0!==_0x172fda[_0x33e5cc(0x396)]()['length']?(this['logger']['log']('Testing\x20text\x20input\x20\x22'+_0x172fda+_0x33e5cc(0x3d8)+_0x38eb6b),await this['wsService']['inputText'](_0x38eb6b,_0x172fda),{'success':!0x0,'message':_0x33e5cc(0x34e)+_0x38eb6b}):{'success':!0x1,'error':_0x33e5cc(0x274),'example':'/api/bank/'+_0x23b4f5+'/test/input-text/{deviceId}?text=abc123'};}catch(_0x549c53){return this['logger']['error']('Error\x20testing\x20text\x20input:\x20'+_0x549c53['message']),{'success':!0x1,'error':_0x549c53['message']};}}async['testPressReturn'](_0x1c38da,_0x55bcfb){const _0x24d092=_0x383fa7;try{return this['logger']['log'](_0x24d092(0x392)+_0x55bcfb),await this[_0x24d092(0x250)]['pressReturnKey'](_0x55bcfb),{'success':!0x0,'message':'Return\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0x55bcfb,'note':_0x24d092(0x38e)};}catch(_0x28197d){return this[_0x24d092(0x22a)]['error'](_0x24d092(0x341)+_0x28197d[_0x24d092(0x36b)]),{'success':!0x1,'error':_0x28197d['message']};}}async['testRoi'](_0x5f54e5,_0x43ecbe,_0x46baed,_0x427c6f,_0x587e1d,_0x32dc30){const _0x4cfd7d=_0x383fa7,_0x2ba616='C:/testroi';try{await(0x0,_0x5cfc37['rm'])(_0x2ba616,{'recursive':!0x0,'force':!0x0}),this['logger']['log']('Đã\x20xóa\x20folder\x20'+_0x2ba616);}catch(_0x3a3d15){this['logger'][_0x4cfd7d(0x181)]('Không\x20thể\x20xóa\x20folder:\x20'+_0x3a3d15['message']);}await(0x0,_0x5cfc37[_0x4cfd7d(0x192)])(_0x2ba616,{'recursive':!0x0}),await this['wsService']['captureScreen'](_0x43ecbe,{'folderPath':_0x2ba616});const _0x52d14d=await this['bankService']['getLatestImagePath'](_0x2ba616),_0x5c9022=await(0x0,_0x5cfc37['readFile'])(_0x52d14d),_0x447c87=await this['imagePreprocessingService']['preprocess'](_0x5c9022,{'x':parseFloat(_0x46baed),'y':parseFloat(_0x427c6f),'width':parseFloat(_0x587e1d),'height':parseFloat(_0x32dc30)},void 0x0,{'grayscale':!0x0,'enhanceContrast':!0x0}),_0x7ba2c0=await this['ocrService']['recognizeFromBuffer'](_0x447c87['buffer']),_0x34edbf=_0x2ba616+'/processed-'+Date['now']()+'.png';return await(0x0,_0x5cfc37['writeFile'])(_0x34edbf,_0x447c87['buffer']),{..._0x7ba2c0,'normalizedText':(0x0,_0x2acfd3['removeVietnameseTones'])(_0x7ba2c0['text'])};}};_0x2f245e['BankController']=_0x1eb2bb,_0x3d2aae([(0x0,_0x3f96a3['Get'])(_0x383fa7(0x1fa)),(0x0,_0x32420e[_0x383fa7(0x361)])({'summary':'Get\x20list\x20of\x20available\x20devices'}),(0x0,_0x32420e[_0x383fa7(0x213)])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x32420e[_0x383fa7(0x370)])({'status':0xc8,'description':'List\x20of\x20devices\x20retrieved\x20successfully'}),_0x57216f(0x0,(0x0,_0x3f96a3['Param'])('bankCode')),_0x375591('design:type',Function),_0x375591('design:paramtypes',[String]),_0x375591('design:returntype',Promise)],_0x1eb2bb['prototype'],'getDevices',null),_0x3d2aae([(0x0,_0x3f96a3[_0x383fa7(0x1e2)])('test/launch-app/:deviceId'),(0x0,_0x32420e['ApiOperation'])({'summary':'Test\x20launching\x20bank\x20app\x20on\x20a\x20device'}),(0x0,_0x32420e['ApiParam'])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x32420e['ApiParam'])({'name':'deviceId','description':_0x383fa7(0x34b)}),(0x0,_0x32420e['ApiResponse'])({'status':0xc8,'description':'App\x20launched\x20successfully'}),_0x57216f(0x0,(0x0,_0x3f96a3['Param'])(_0x383fa7(0x358))),_0x57216f(0x1,(0x0,_0x3f96a3[_0x383fa7(0x27f)])('deviceId')),_0x375591(_0x383fa7(0x3c0),Function),_0x375591(_0x383fa7(0x17c),[String,String]),_0x375591('design:returntype',Promise)],_0x1eb2bb['prototype'],'testLaunchApp',null),_0x3d2aae([(0x0,_0x3f96a3['Post'])('test/capture-screen/:deviceId'),(0x0,_0x32420e[_0x383fa7(0x361)])({'summary':'Test\x20screen\x20capture\x20on\x20a\x20device'}),(0x0,_0x32420e[_0x383fa7(0x213)])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x32420e['ApiParam'])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x32420e['ApiQuery'])({'name':'name','description':'Screen\x20capture\x20name\x20(optional)','required':!0x1}),(0x0,_0x32420e[_0x383fa7(0x13d)])({'name':_0x383fa7(0x3b7),'description':'Image\x20quality\x20(0-1,\x20default:\x200.5)','required':!0x1}),(0x0,_0x32420e['ApiResponse'])({'status':0xc8,'description':'Screen\x20captured\x20successfully'}),_0x57216f(0x0,(0x0,_0x3f96a3['Param'])(_0x383fa7(0x358))),_0x57216f(0x1,(0x0,_0x3f96a3['Param'])('deviceId')),_0x57216f(0x2,(0x0,_0x3f96a3['Query'])('name')),_0x57216f(0x3,(0x0,_0x3f96a3['Query'])('quality')),_0x375591('design:type',Function),_0x375591('design:paramtypes',[String,String,String,String]),_0x375591(_0x383fa7(0x2ee),Promise)],_0x1eb2bb['prototype'],'testCaptureScreen',null),_0x3d2aae([(0x0,_0x3f96a3['Post'])(_0x383fa7(0x26d)),(0x0,_0x32420e['ApiOperation'])({'summary':'Test\x20clicking\x20at\x20specific\x20coordinates\x20on\x20a\x20device'}),(0x0,_0x32420e[_0x383fa7(0x213)])({'name':_0x383fa7(0x358),'description':_0x383fa7(0x3de)}),(0x0,_0x32420e['ApiParam'])({'name':'deviceId','description':_0x383fa7(0x34b)}),(0x0,_0x32420e['ApiQuery'])({'name':'x','description':_0x383fa7(0x22c),'required':!0x0}),(0x0,_0x32420e[_0x383fa7(0x13d)])({'name':'y','description':_0x383fa7(0x398),'required':!0x0}),(0x0,_0x32420e['ApiResponse'])({'status':0xc8,'description':'Click\x20completed\x20successfully'}),_0x57216f(0x0,(0x0,_0x3f96a3['Param'])(_0x383fa7(0x358))),_0x57216f(0x1,(0x0,_0x3f96a3['Param'])('deviceId')),_0x57216f(0x2,(0x0,_0x3f96a3['Query'])('x')),_0x57216f(0x3,(0x0,_0x3f96a3[_0x383fa7(0x3c6)])('y')),_0x375591('design:type',Function),_0x375591(_0x383fa7(0x17c),[String,String,String,String]),_0x375591('design:returntype',Promise)],_0x1eb2bb['prototype'],_0x383fa7(0x3a4),null),_0x3d2aae([(0x0,_0x3f96a3['Post'])('test/swipe/:deviceId'),(0x0,_0x32420e['ApiOperation'])({'summary':'Test\x20swiping\x20on\x20a\x20device.\x20Format\x20is\x20determined\x20by\x20config.boxType\x20(HC\x20or\x20PANDA)'}),(0x0,_0x32420e[_0x383fa7(0x213)])({'name':_0x383fa7(0x358),'description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x32420e['ApiParam'])({'name':_0x383fa7(0x364),'description':'Device\x20ID'}),(0x0,_0x32420e[_0x383fa7(0x13d)])({'name':'x','description':_0x383fa7(0x327),'required':!0x1}),(0x0,_0x32420e['ApiQuery'])({'name':'y','description':'Y\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100).\x20Required\x20for\x20HC\x20and\x20Panda\x20types\x200,1,2,10.\x20Optional\x20for\x20Panda\x20types\x204,5,6,7,8,9','required':!0x1}),(0x0,_0x32420e['ApiQuery'])({'name':'type','description':'Panda\x20pointer\x20event\x20type:\x200=按下(press),\x201=抬起(lift),\x202=移动(move),\x204=滚轮向上(scroll\x20up),\x205=滚轮向下(scroll\x20down),\x206=上滑(swipe\x20up),\x207=下滑(swipe\x20down),\x208=左滑(swipe\x20left),\x209=右滑(swipe\x20right),\x2010=点击(click).\x20Required\x20for\x20Panda\x20format.','required':!0x1}),(0x0,_0x32420e['ApiQuery'])({'name':_0x383fa7(0x3c8),'description':_0x383fa7(0x23c),'required':!0x1}),(0x0,_0x32420e['ApiQuery'])({'name':'endY','description':'End\x20Y\x20coordinate\x20for\x20HC\x20(required\x20for\x20HC:\x200-1)','required':!0x1}),(0x0,_0x32420e['ApiQuery'])({'name':_0x383fa7(0x3b6),'description':'Swipe\x20duration\x20for\x20HC\x20(default:\x200.2)','required':!0x1}),(0x0,_0x32420e['ApiResponse'])({'status':0xc8,'description':'Swipe\x20completed\x20successfully'}),_0x57216f(0x0,(0x0,_0x3f96a3['Param'])('bankCode')),_0x57216f(0x1,(0x0,_0x3f96a3['Param'])('deviceId')),_0x57216f(0x2,(0x0,_0x3f96a3['Query'])('x')),_0x57216f(0x3,(0x0,_0x3f96a3['Query'])('y')),_0x57216f(0x4,(0x0,_0x3f96a3['Query'])(_0x383fa7(0x2c7))),_0x57216f(0x5,(0x0,_0x3f96a3['Query'])('endX')),_0x57216f(0x6,(0x0,_0x3f96a3['Query'])(_0x383fa7(0x324))),_0x57216f(0x7,(0x0,_0x3f96a3['Query'])('duration')),_0x375591('design:type',Function),_0x375591(_0x383fa7(0x17c),[String,String,String,String,String,String,String,String]),_0x375591('design:returntype',Promise)],_0x1eb2bb[_0x383fa7(0x3b2)],'testSwipe',null),_0x3d2aae([(0x0,_0x3f96a3['Post'])(_0x383fa7(0x24b)),(0x0,_0x32420e[_0x383fa7(0x361)])({'summary':'Test\x20inputting\x20number\x20using\x20numpad\x20layout\x20on\x20a\x20device'}),(0x0,_0x32420e['ApiParam'])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x32420e[_0x383fa7(0x213)])({'name':_0x383fa7(0x364),'description':_0x383fa7(0x34b)}),(0x0,_0x32420e['ApiQuery'])({'name':'number','description':_0x383fa7(0x3e2),'required':!0x0}),(0x0,_0x32420e['ApiResponse'])({'status':0xc8,'description':'Numpad\x20number\x20input\x20completed\x20successfully'}),_0x57216f(0x0,(0x0,_0x3f96a3[_0x383fa7(0x27f)])('bankCode')),_0x57216f(0x1,(0x0,_0x3f96a3[_0x383fa7(0x27f)])('deviceId')),_0x57216f(0x2,(0x0,_0x3f96a3['Query'])('number')),_0x375591(_0x383fa7(0x3c0),Function),_0x375591('design:paramtypes',[String,String,String]),_0x375591(_0x383fa7(0x2ee),Promise)],_0x1eb2bb[_0x383fa7(0x3b2)],'testInputNumpadNumber',null),_0x3d2aae([(0x0,_0x3f96a3[_0x383fa7(0x1e2)])(_0x383fa7(0x150)),(0x0,_0x32420e['ApiOperation'])({'summary':'Test\x20inputting\x20text\x20using\x20keyboard\x20layout\x20on\x20a\x20device'}),(0x0,_0x32420e['ApiParam'])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x32420e['ApiParam'])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x32420e['ApiQuery'])({'name':_0x383fa7(0x3c4),'description':_0x383fa7(0x2ff),'required':!0x0}),(0x0,_0x32420e['ApiResponse'])({'status':0xc8,'description':'Text\x20input\x20completed\x20successfully'}),_0x57216f(0x0,(0x0,_0x3f96a3['Param'])('bankCode')),_0x57216f(0x1,(0x0,_0x3f96a3['Param'])('deviceId')),_0x57216f(0x2,(0x0,_0x3f96a3['Query'])(_0x383fa7(0x3c4))),_0x375591(_0x383fa7(0x3c0),Function),_0x375591('design:paramtypes',[String,String,String]),_0x375591('design:returntype',Promise)],_0x1eb2bb['prototype'],_0x383fa7(0x334),null),_0x3d2aae([(0x0,_0x3f96a3['Post'])('test/press-return/:deviceId'),(0x0,_0x32420e[_0x383fa7(0x361)])({'summary':_0x383fa7(0x32a)}),(0x0,_0x32420e['ApiParam'])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x32420e['ApiParam'])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x32420e[_0x383fa7(0x370)])({'status':0xc8,'description':'Return\x20key\x20pressed\x20successfully'}),_0x57216f(0x0,(0x0,_0x3f96a3[_0x383fa7(0x27f)])('bankCode')),_0x57216f(0x1,(0x0,_0x3f96a3['Param'])('deviceId')),_0x375591(_0x383fa7(0x3c0),Function),_0x375591('design:paramtypes',[String,String]),_0x375591('design:returntype',Promise)],_0x1eb2bb['prototype'],'testPressReturn',null),_0x3d2aae([(0x0,_0x3f96a3[_0x383fa7(0x1e2)])('test/roi'),(0x0,_0x32420e[_0x383fa7(0x361)])({'summary':'Test\x20ROI\x20detection\x20on\x20a\x20device'}),(0x0,_0x32420e['ApiParam'])({'name':'bankCode','description':_0x383fa7(0x3de)}),(0x0,_0x32420e['ApiQuery'])({'name':_0x383fa7(0x364),'description':'Device\x20ID'}),(0x0,_0x32420e[_0x383fa7(0x13d)])({'name':'x','description':'X\x20coordinate','required':!0x0}),(0x0,_0x32420e['ApiQuery'])({'name':'y','description':'Y\x20coordinate','required':!0x0}),(0x0,_0x32420e[_0x383fa7(0x13d)])({'name':'width','description':'Width','required':!0x0}),(0x0,_0x32420e['ApiQuery'])({'name':'height','description':_0x383fa7(0x256),'required':!0x0}),_0x57216f(0x0,(0x0,_0x3f96a3[_0x383fa7(0x27f)])(_0x383fa7(0x358))),_0x57216f(0x1,(0x0,_0x3f96a3[_0x383fa7(0x3c6)])('deviceId')),_0x57216f(0x2,(0x0,_0x3f96a3['Query'])('x')),_0x57216f(0x3,(0x0,_0x3f96a3['Query'])('y')),_0x57216f(0x4,(0x0,_0x3f96a3[_0x383fa7(0x3c6)])(_0x383fa7(0x1d4))),_0x57216f(0x5,(0x0,_0x3f96a3['Query'])('height')),_0x375591('design:type',Function),_0x375591('design:paramtypes',[String,String,String,String,String,String]),_0x375591('design:returntype',Promise)],_0x1eb2bb['prototype'],'testRoi',null),_0x2f245e['BankController']=_0x1eb2bb=_0x3d2aae([(0x0,_0x32420e['ApiTags'])('bank'),(0x0,_0x3f96a3[_0x383fa7(0x397)])(_0x383fa7(0x35d)),_0x57216f(0x1,(0x0,_0x3f96a3['Inject'])(_0x312e37['WEBSOCKET_SERVICE'])),_0x375591('design:paramtypes',[_0x383fa7(0x379)==typeof(_0x4ba4a7=void 0x0!==_0x468ef['BankService']&&_0x468ef['BankService'])?_0x4ba4a7:Object,'function'==typeof(_0xce5753=void 0x0!==_0x5069c5['IWebSocketService']&&_0x5069c5['IWebSocketService'])?_0xce5753:Object,'function'==typeof(_0x53ee68=void 0x0!==_0x1d6a3e['ImagePreprocessingService']&&_0x1d6a3e[_0x383fa7(0x1a6)])?_0x53ee68:Object,'function'==typeof(_0x1877e3=void 0x0!==_0x39ba7d['OCRService']&&_0x39ba7d['OCRService'])?_0x1877e3:Object])],_0x1eb2bb);},function(_0x57dbe8,_0x41315e,_0x31424c){const _0xcfa24=a0_0x5814;var _0x5a005c=this&&this['__decorate']||function(_0x1b94bb,_0x4a66f4,_0x4e285e,_0x27e383){const _0x153e01=a0_0x5814;var _0x35d352,_0x33e099=arguments[_0x153e01(0x2be)],_0x4f1888=_0x33e099<0x3?_0x4a66f4:null===_0x27e383?_0x27e383=Object['getOwnPropertyDescriptor'](_0x4a66f4,_0x4e285e):_0x27e383;if(_0x153e01(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x4f1888=Reflect[_0x153e01(0x1fe)](_0x1b94bb,_0x4a66f4,_0x4e285e,_0x27e383);else{for(var _0x12c5fa=_0x1b94bb['length']-0x1;_0x12c5fa>=0x0;_0x12c5fa--)(_0x35d352=_0x1b94bb[_0x12c5fa])&&(_0x4f1888=(_0x33e099<0x3?_0x35d352(_0x4f1888):_0x33e099>0x3?_0x35d352(_0x4a66f4,_0x4e285e,_0x4f1888):_0x35d352(_0x4a66f4,_0x4e285e))||_0x4f1888);}return _0x33e099>0x3&&_0x4f1888&&Object['defineProperty'](_0x4a66f4,_0x4e285e,_0x4f1888),_0x4f1888;};Object['defineProperty'](_0x41315e,'__esModule',{'value':!0x0}),_0x41315e[_0xcfa24(0x156)]=void 0x0;const _0xc6aedf=_0x31424c(0x2),_0x3649c1=_0x31424c(0x4f),_0x1b2f1b=_0x31424c(0x51),_0x59fe09=_0x31424c(0xd),_0x5d3de2=_0x31424c(0x11);let _0x578744=class{};_0x41315e['WebSocketModule']=_0x578744,_0x41315e['WebSocketModule']=_0x578744=_0x5a005c([(0x0,_0xc6aedf['Global'])(),(0x0,_0xc6aedf['Module'])({'providers':[{'provide':_0x59fe09[_0xcfa24(0x1c0)],'useClass':_0xcfa24(0x3d4)===_0x5d3de2[_0xcfa24(0x3ba)]['boxType']?_0x1b2f1b[_0xcfa24(0x1cb)]:_0x3649c1['HCWebSocketService']}],'exports':[_0x59fe09[_0xcfa24(0x1c0)]]})],_0x578744);},function(_0x1a4883,_0xa5d79d,_0x330f7e){const _0x427ac9=a0_0x5814;var _0x3654bb=this&&this['__decorate']||function(_0x6ecac5,_0x463061,_0x1a96bf,_0x4b1ed5){const _0x281787=a0_0x5814;var _0x9d82ca,_0x2e8328=arguments[_0x281787(0x2be)],_0x32d48b=_0x2e8328<0x3?_0x463061:null===_0x4b1ed5?_0x4b1ed5=Object['getOwnPropertyDescriptor'](_0x463061,_0x1a96bf):_0x4b1ed5;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x32d48b=Reflect['decorate'](_0x6ecac5,_0x463061,_0x1a96bf,_0x4b1ed5);else{for(var _0xfeeffa=_0x6ecac5[_0x281787(0x2be)]-0x1;_0xfeeffa>=0x0;_0xfeeffa--)(_0x9d82ca=_0x6ecac5[_0xfeeffa])&&(_0x32d48b=(_0x2e8328<0x3?_0x9d82ca(_0x32d48b):_0x2e8328>0x3?_0x9d82ca(_0x463061,_0x1a96bf,_0x32d48b):_0x9d82ca(_0x463061,_0x1a96bf))||_0x32d48b);}return _0x2e8328>0x3&&_0x32d48b&&Object[_0x281787(0x2d5)](_0x463061,_0x1a96bf,_0x32d48b),_0x32d48b;},_0x1da7cb=this&&this['__metadata']||function(_0x429420,_0x23c565){const _0x38915a=a0_0x5814;if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x38915a(0x168)](_0x429420,_0x23c565);};Object['defineProperty'](_0xa5d79d,'__esModule',{'value':!0x0}),_0xa5d79d['HCWebSocketService']=void 0x0;const _0x4cae41=_0x330f7e(0x2),_0x53bd27=_0x330f7e(0x50),_0x4f3c2e=_0x330f7e(0x26),_0x5b4fcf=_0x330f7e(0x18),_0x2e3b44=_0x330f7e(0x16);let _0x59c8de=class{constructor(){const _0x552bde=a0_0x5814;this['logger']=new _0x4cae41['Logger']('HCWebSocketService'),this['ws']=null,this['reconnectAttempts']=0x0,this[_0x552bde(0x13a)]=0xa,this['reconnectDelay']=0x1388,this[_0x552bde(0x223)]=[],this['pendingRequests']=new Map(),this['isConnected']=!0x1,this['isProcessingRequest']=!0x1,this['wsUrl']=_0x552bde(0x1d8);}async['onModuleInit'](){await this['connect']();}async[_0x427ac9(0x362)](){const _0xc1c960=_0x427ac9;await this[_0xc1c960(0x1ce)]();}async['connect'](){return new Promise((_0x132c28,_0x4df419)=>{const _0x3e0020=a0_0x5814;try{this['logger']['log']('Connecting\x20to\x20HC\x20BOX\x20WebSocket:\x20'+this['wsUrl']),this['ws']=new _0x53bd27(this['wsUrl']),this['ws']['on']('open',()=>{const _0x542431=a0_0x5814;this['logger']['log']('HC\x20BOX\x20WebSocket\x20connected'),this['isConnected']=!0x0,this['reconnectAttempts']=0x0,this[_0x542431(0x1e0)](),_0x132c28();}),this['ws']['on']('message',_0x50db03=>{const _0x21a9f0=a0_0x5814;try{const _0x2d859a=JSON['parse'](_0x50db03['toString']());this[_0x21a9f0(0x2b3)](_0x2d859a);}catch(_0x59c06a){this[_0x21a9f0(0x22a)]['error'](_0x21a9f0(0x3df)+_0x59c06a[_0x21a9f0(0x36b)]);}}),this['ws']['on']('error',_0xe3688f=>{const _0x5d3d06=a0_0x5814;this[_0x5d3d06(0x22a)][_0x5d3d06(0x3e9)]('WebSocket\x20error:\x20'+_0xe3688f['message']),this[_0x5d3d06(0x17e)]=!0x1,0x0===this['reconnectAttempts']&&_0x4df419(_0xe3688f);}),this['ws']['on']('close',()=>{const _0x1fbfd1=a0_0x5814;this['logger']['warn']('HC\x20BOX\x20WebSocket\x20closed'),this[_0x1fbfd1(0x17e)]=!0x1,this['scheduleReconnect']();});}catch(_0x2f41c7){this['logger'][_0x3e0020(0x3e9)](_0x3e0020(0x407)+_0x2f41c7[_0x3e0020(0x36b)]),_0x4df419(_0x2f41c7);}});}[_0x427ac9(0x2aa)](){const _0x471cfa=_0x427ac9;if(this['reconnectAttempts']>=this[_0x471cfa(0x13a)])return void this['logger']['error']('Max\x20reconnection\x20attempts\x20reached');this['reconnectAttempts']++;const _0x4c1a11=this[_0x471cfa(0x34d)]*this[_0x471cfa(0x342)];this['logger'][_0x471cfa(0x19e)]('Scheduling\x20reconnect\x20attempt\x20'+this[_0x471cfa(0x342)]+'\x20in\x20'+_0x4c1a11+'ms'),setTimeout(()=>{const _0x47d8e6=_0x471cfa;this['connect']()[_0x47d8e6(0x381)](_0x370420=>{const _0x5e4b6b=_0x47d8e6;this[_0x5e4b6b(0x22a)]['error']('Reconnection\x20failed:\x20'+_0x370420['message']);});},_0x4c1a11);}async[_0x427ac9(0x1ce)](){this['ws']&&(this['ws']['close'](),this['ws']=null,this['isConnected']=!0x1);}[_0x427ac9(0x2b3)](_0x1efc2c){const _0x3bc51c=_0x427ac9;if(this['pendingRequests']['size']>0x0){const [_0x5f122e,_0x4872d2]=this[_0x3bc51c(0x40f)][_0x3bc51c(0x22b)]()['next']()['value'];this[_0x3bc51c(0x40f)][_0x3bc51c(0x11e)](_0x5f122e),0xc8===_0x1efc2c['StatusCode']?_0x4872d2[_0x3bc51c(0x1aa)](_0x1efc2c['result']):_0x4872d2['reject'](new Error('HC\x20BOX\x20error:\x20'+_0x1efc2c['StatusCode']));}else this['logger']['warn'](_0x3bc51c(0x366)+JSON['stringify'](_0x1efc2c));}async[_0x427ac9(0x1e0)](){const _0x249c35=_0x427ac9;if(this[_0x249c35(0x253)]||0x0===this[_0x249c35(0x223)][_0x249c35(0x2be)])return;if(!this['isConnected']||!this['ws'])return;this['isProcessingRequest']=!0x0;const {request:_0x4ac7df,resolve:_0x3427f1,reject:_0x2cb637,timeout:_0x3041d1}=this[_0x249c35(0x223)]['shift']();try{_0x3427f1(await this[_0x249c35(0x40d)](_0x4ac7df,_0x3041d1));}catch(_0x1d9fb7){_0x2cb637(_0x1d9fb7);}finally{this['isProcessingRequest']=!0x1,this['requestQueue']['length']>0x0&&setImmediate(()=>this['processRequestQueue']());}}async['_sendRequestOnce'](_0xbda53b,_0x2edbad=0x7530){return new Promise((_0x3bfc59,_0x1b9a64)=>{const _0x14999f=a0_0x5814,_0x3bbe71=Date['now']()[_0x14999f(0x238)]()+Math['random']()['toString'](0x24)['substr'](0x2,0x9);this['pendingRequests']['set'](_0x3bbe71,{'resolve':_0x3bfc59,'reject':_0x1b9a64});const _0x3b35bd=setTimeout(()=>{this['pendingRequests']['delete'](_0x3bbe71),_0x1b9a64(new Error('WebSocket\x20request\x20timeout'));},_0x2edbad),_0x496dca=_0x3bfc59,_0x573724=_0x1b9a64;_0x3bfc59=_0x171e21=>{clearTimeout(_0x3b35bd),_0x496dca(_0x171e21);},_0x1b9a64=_0x2f1dd6=>{clearTimeout(_0x3b35bd),_0x573724(_0x2f1dd6);},this['pendingRequests']['set'](_0x3bbe71,{'resolve':_0x3bfc59,'reject':_0x1b9a64});try{this['ws']['send'](JSON['stringify'](_0xbda53b));}catch(_0xa4afa5){this['pendingRequests'][_0x14999f(0x11e)](_0x3bbe71),clearTimeout(_0x3b35bd),_0x1b9a64(_0xa4afa5);}});}async[_0x427ac9(0x311)](_0x47d860,_0x5e6d9d=0x7530){return new Promise((_0x32c97f,_0x434777)=>{const _0x352a1d=a0_0x5814;this['requestQueue'][_0x352a1d(0x235)]({'request':_0x47d860,'resolve':_0x32c97f,'reject':_0x434777,'timeout':_0x5e6d9d}),this['processRequestQueue']();});}async[_0x427ac9(0x106)](){const _0x43c890=_0x427ac9,_0x17f1aa=await this['sendRequest']({'action':_0x43c890(0x24c)});return Array[_0x43c890(0x176)](_0x17f1aa)?_0x17f1aa:[];}async['click'](_0x287477,_0x88c900,_0x5f0fc7,_0x32d2a7=0.2){const _0x7330ab=_0x427ac9,_0x278b80=Array[_0x7330ab(0x176)](_0x287477)?_0x287477['join'](','):_0x287477;return this['sendRequest']({'action':'click','comm':{'deviceIds':_0x278b80,'x':_0x88c900,'y':_0x5f0fc7,'duration':_0x32d2a7}});}async[_0x427ac9(0x3eb)](_0x34ba33,_0x247730){const _0x48658d=Array['isArray'](_0x34ba33)?_0x34ba33['join'](','):_0x34ba33;return this['sendRequest']({'action':'swipe','comm':{'deviceIds':_0x48658d,..._0x247730}});}async['captureScreen'](_0x1e6084,_0x45ce25){const _0x1610d9=_0x427ac9;return this['sendRequest']({'action':_0x1610d9(0x39f),'comm':{'deviceIds':_0x1e6084,...(0x0,_0x2e3b44['omit'])(_0x45ce25,'folderPath'),'filePath':_0x45ce25['folderPath']}});}async['home'](_0x1c3680){const _0x5f5c3a=_0x427ac9,_0x2c516b=Array[_0x5f5c3a(0x176)](_0x1c3680)?_0x1c3680['join'](','):_0x1c3680;return this['sendRequest']({'action':_0x5f5c3a(0x242),'comm':{'deviceIds':_0x2c516b}});}async[_0x427ac9(0x3dd)](_0x117eca,_0x4a0f1f){const _0xdaed57=_0x427ac9,_0x3ac30f=Array['isArray'](_0x117eca)?_0x117eca['join'](','):_0x117eca;return this['sendRequest']({'action':_0xdaed57(0x3dd),'comm':{'deviceIds':_0x3ac30f,'content':_0x4a0f1f}});}async['killApp'](_0x2292d8,_0xe3c464){const _0x36af44=_0x427ac9,_0x1a7fae=Array['isArray'](_0x2292d8)?_0x2292d8[_0x36af44(0x19c)](','):_0x2292d8;return this['sendRequest']({'action':'killApp','comm':{'deviceIds':_0x1a7fae,'content':_0xe3c464}});}[_0x427ac9(0x1e7)](_0x4f9e58){return/^[0-9]$/['test'](_0x4f9e58);}[_0x427ac9(0x3d7)](_0x163ea0){return/^[a-zA-Z]$/['test'](_0x163ea0);}[_0x427ac9(0x38b)](_0x4a8360){return['@','!']['includes'](_0x4a8360);}async['switchKeyboardMode'](_0x429533){const _0x3d17e9=_0x427ac9,{x:_0x20d9c5,y:_0x7fec05}=_0x4f3c2e['COMMON_COORDINATES']['KEYBOARD_SWITCH'];this[_0x3d17e9(0x22a)]['log']('Switching\x20keyboard\x20mode\x20on\x20device\x20'+_0x429533+_0x3d17e9(0x35b)+_0x20d9c5+',\x20'+_0x7fec05+')'),await this[_0x3d17e9(0x3cc)](_0x429533,_0x20d9c5,_0x7fec05,0.2),await(0x0,_0x5b4fcf[_0x3d17e9(0x404)])(0x1f4),this['logger'][_0x3d17e9(0x19e)](_0x3d17e9(0x2ce)+_0x429533);}async['pressShiftKey'](_0x43d461){const _0xc471f0=_0x427ac9,{x:_0x3d3afa,y:_0x50f724}=_0x4f3c2e['COMMON_COORDINATES']['SHIFT_KEY'];this['logger'][_0xc471f0(0x181)](_0xc471f0(0x1ad)+_0x43d461+'\x20at\x20coordinates\x20('+_0x3d3afa+',\x20'+_0x50f724+')'),await this['click'](_0x43d461,_0x3d3afa,_0x50f724,0.2),await(0x0,_0x5b4fcf['sleep'])(0xc8),this['logger']['debug']('Shift\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0x43d461);}async[_0x427ac9(0x20c)](_0x28a1cc){const _0x94118=_0x427ac9,{x:_0xbf5b1a,y:_0x27d44c}=_0x4f3c2e['COMMON_COORDINATES'][_0x94118(0x2dd)];this['logger']['log']('Pressing\x20return\x20key\x20on\x20device\x20'+_0x28a1cc+'\x20at\x20coordinates\x20('+_0xbf5b1a+',\x20'+_0x27d44c+')'),await this[_0x94118(0x3cc)](_0x28a1cc,_0xbf5b1a,_0x27d44c,0.2),await(0x0,_0x5b4fcf[_0x94118(0x404)])(0x1f4),this['logger'][_0x94118(0x19e)]('Return\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0x28a1cc);}async['inputText'](_0x37c6ac,_0x132a1d){const _0xcbd810=_0x427ac9;if(!_0x132a1d||0x0===_0x132a1d['length'])throw new Error('Password\x20cannot\x20be\x20empty');let _0x45a2b7=_0xcbd810(0x1ec);for(let _0x37a1e8=0x0;_0x37a1e8<_0x132a1d['length'];_0x37a1e8++){const _0x41f258=_0x132a1d[_0x37a1e8],_0x3da647=_0x41f258['toLowerCase'](),_0x4506c8=_0x41f258!==_0x3da647&&this['isLetter'](_0x41f258),_0x33a707=this['isSpecialCharInNumberMode'](_0x41f258)?_0x41f258:_0x3da647,_0x950dcd=_0x4f3c2e['KEYBOARD_LAYOUT'][_0x33a707];if(!_0x950dcd){this['logger']['warn']('Character\x20\x27'+_0x41f258+_0xcbd810(0x2a6));continue;}let _0x281cdd=null;this['isNumber'](_0x3da647)?_0x281cdd=_0xcbd810(0x140):this['isLetter'](_0x3da647)?_0x281cdd='letter':this['isSpecialCharInNumberMode'](_0x41f258)&&(_0x281cdd=_0xcbd810(0x140)),_0x281cdd&&_0x45a2b7!==_0x281cdd&&(this['logger']['debug']('Switching\x20keyboard\x20to\x20'+_0x281cdd+'\x20mode\x20for\x20character\x20\x27'+_0x41f258+'\x27'),await this['switchKeyboardMode'](_0x37c6ac),_0x45a2b7=_0x281cdd),_0x4506c8&&'letter'===_0x45a2b7&&(this['logger']['debug']('Pressing\x20shift\x20key\x20for\x20uppercase\x20letter\x20\x27'+_0x41f258+'\x27'),await this[_0xcbd810(0x193)](_0x37c6ac)),this['logger']['debug']('Clicking\x20key\x20\x27'+_0x33a707+'\x27'+(_0x4506c8?'\x20(uppercase)':'')+_0xcbd810(0x2da)+_0x950dcd['x']+',\x20'+_0x950dcd['y']+')'),await this[_0xcbd810(0x3cc)](_0x37c6ac,_0x950dcd['x'],_0x950dcd['y'],0.15),await(0x0,_0x5b4fcf[_0xcbd810(0x404)])(0xc8);}this['logger'][_0xcbd810(0x19e)]('Text\x20input\x20completed\x20on\x20device\x20'+_0x37c6ac);}async['inputNumpadNumber'](_0x34c918,_0x33695f){const _0x3941a2=_0x427ac9;if(!_0x33695f||0x0===_0x33695f['length'])throw new Error(_0x3941a2(0x37e));for(let _0x151206=0x0;_0x151206<_0x33695f[_0x3941a2(0x2be)];_0x151206++){const _0xee53a3=_0x33695f[_0x151206],_0x1ce063=_0x4f3c2e['NUMPAD_LAYOUT'][_0xee53a3];await this['click'](_0x34c918,_0x1ce063['x'],_0x1ce063['y'],0.15),this[_0x3941a2(0x22a)]['debug']('Clicking\x20key\x20\x27'+_0xee53a3+'\x27\x20at\x20('+_0x1ce063['x']+',\x20'+_0x1ce063['y']+')'),await(0x0,_0x5b4fcf[_0x3941a2(0x404)])(0xc8);}}async['transferFile'](_0x3f514f,_0x2fdc7d,_0x4a5627=0x1){return Promise['resolve'](null);}['isConnectedStatus'](){const _0xf15d90=_0x427ac9;return this[_0xf15d90(0x17e)];}};_0xa5d79d['HCWebSocketService']=_0x59c8de,_0xa5d79d[_0x427ac9(0x385)]=_0x59c8de=_0x3654bb([(0x0,_0x4cae41['Injectable'])(),_0x1da7cb('design:paramtypes',[])],_0x59c8de);},_0x1e98f3=>{_0x1e98f3['exports']=require('ws');},function(_0x188e88,_0x2bbc39,_0x1f8055){const _0x125974=a0_0x5814;var _0x3c6077,_0x27eda2=this&&this['__decorate']||function(_0x4b3ce0,_0x502bea,_0x48bb94,_0x5ca4a0){const _0x438ce7=a0_0x5814;var _0x12e0d1,_0x412283=arguments['length'],_0x5dd75e=_0x412283<0x3?_0x502bea:null===_0x5ca4a0?_0x5ca4a0=Object['getOwnPropertyDescriptor'](_0x502bea,_0x48bb94):_0x5ca4a0;if(_0x438ce7(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x5dd75e=Reflect['decorate'](_0x4b3ce0,_0x502bea,_0x48bb94,_0x5ca4a0);else{for(var _0x2aad85=_0x4b3ce0['length']-0x1;_0x2aad85>=0x0;_0x2aad85--)(_0x12e0d1=_0x4b3ce0[_0x2aad85])&&(_0x5dd75e=(_0x412283<0x3?_0x12e0d1(_0x5dd75e):_0x412283>0x3?_0x12e0d1(_0x502bea,_0x48bb94,_0x5dd75e):_0x12e0d1(_0x502bea,_0x48bb94))||_0x5dd75e);}return _0x412283>0x3&&_0x5dd75e&&Object[_0x438ce7(0x2d5)](_0x502bea,_0x48bb94,_0x5dd75e),_0x5dd75e;},_0x146175=this&&this['__metadata']||function(_0x231d4b,_0x2823dd){const _0x2a7297=a0_0x5814;if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x2a7297(0x168)](_0x231d4b,_0x2823dd);};Object['defineProperty'](_0x2bbc39,'__esModule',{'value':!0x0}),_0x2bbc39['PandaWebSocketService']=void 0x0;const _0x520194=_0x1f8055(0x2),_0x523438=_0x1f8055(0x50),_0x1bebd2=_0x1f8055(0x16),_0x2abfc3=_0x1f8055(0x18),_0x11e51f=_0x1f8055(0x26),_0xcf117=_0x1f8055(0x2c);let _0x331250=class{constructor(_0xa0e9e2){const _0x615768=a0_0x5814;this['telegramService']=_0xa0e9e2,this['logger']=new _0x520194['Logger']('PandaWebSocketService'),this['ws']=null,this['reconnectAttempts']=0x0,this['maxReconnectAttempts']=0xa,this[_0x615768(0x34d)]=0x1388,this['requestQueue']=[],this['pendingRequests']=new Map(),this['isConnected']=!0x1,this['isProcessingRequest']=!0x1,this[_0x615768(0x1b5)]='ws://127.0.0.1:33333';}async['onModuleInit'](){await this['connect']();}async[_0x125974(0x362)](){const _0x2edf57=_0x125974;await this[_0x2edf57(0x1ce)]();}async['connect'](){return new Promise((_0x3c424c,_0x139e5a)=>{const _0x34143e=a0_0x5814;try{this[_0x34143e(0x22a)]['log']('Connecting\x20to\x20Panda\x20BOX\x20WebSocket:\x20'+this['wsUrl']),this['ws']=new _0x523438(this['wsUrl']),this['ws']['on'](_0x34143e(0x149),()=>{const _0x43fc02=_0x34143e;this['logger']['log']('Panda\x20BOX\x20WebSocket\x20connected'),this['isConnected']=!0x0,this[_0x43fc02(0x342)]=0x0,this['processRequestQueue'](),_0x3c424c();}),this['ws']['on']('message',_0x4d9559=>{try{const _0x16050e=_0x4d9559['toString'](),_0x4ddac5=JSON['parse'](_0x16050e);this['handleMessage'](_0x4ddac5);}catch(_0x5ca6e9){this['logger']['error']('Error\x20parsing\x20WebSocket\x20message:\x20'+_0x5ca6e9['message'],_0x5ca6e9['stack']),this['logger']['error']('Raw\x20message\x20was:\x20'+_0x4d9559['toString']());}}),this['ws']['on']('error',_0x8f096=>{const _0x470a7e=_0x34143e;this[_0x470a7e(0x22a)]['error']('WebSocket\x20error:\x20'+_0x8f096['message']),this['isConnected']=!0x1,0x0===this['reconnectAttempts']&&_0x139e5a(_0x8f096);}),this['ws']['on'](_0x34143e(0x26a),()=>{const _0x26add1=_0x34143e;this['logger']['warn'](_0x26add1(0x359)),this['isConnected']=!0x1,this['scheduleReconnect']();});}catch(_0x398dfb){this['logger']['error']('Error\x20creating\x20WebSocket\x20connection:\x20'+_0x398dfb[_0x34143e(0x36b)]),_0x139e5a(_0x398dfb);}});}[_0x125974(0x2aa)](){const _0x14319f=_0x125974;if(this['reconnectAttempts']>=this['maxReconnectAttempts'])return this['logger']['error']('Max\x20reconnection\x20attempts\x20reached'),void this[_0x14319f(0x226)][_0x14319f(0x246)]({'text':'🆘🆘🆘\x20Connection\x20Error\x0a\x0a<b>Kết\x20nối\x20vào\x20boxphone\x20software\x20thất\x20bại.</b>\x0a<b>Max\x20retry:</b>\x20'+this['maxReconnectAttempts']+'\x0a<b>Current\x20retry:</b>\x20'+this[_0x14319f(0x342)]+'\x0a<b>Retry\x20delay:</b>\x20'+this[_0x14319f(0x34d)]+'ms','options':{'parseMode':'HTML'}});this['reconnectAttempts']++;const _0x151fa6=this['reconnectDelay']*this[_0x14319f(0x342)];this['logger']['log'](_0x14319f(0x276)+this['reconnectAttempts']+'\x20in\x20'+_0x151fa6+'ms'),setTimeout(()=>{const _0x3109b2=_0x14319f;this[_0x3109b2(0x40c)]()[_0x3109b2(0x381)](_0x5ca1a6=>{this['logger']['error']('Reconnection\x20failed:\x20'+_0x5ca1a6['message']);});},_0x151fa6);}async[_0x125974(0x1ce)](){const _0x1588d1=_0x125974;this['ws']&&(this['ws'][_0x1588d1(0x26a)](),this['ws']=null,this['isConnected']=!0x1);}['handleMessage'](_0x5cefa4){const _0x3b20ec=_0x125974;if(this['pendingRequests'][_0x3b20ec(0x22e)]>0x0){const [_0x48f1de,_0x2acac3]=this['pendingRequests'][_0x3b20ec(0x22b)]()['next']()['value'];if(this[_0x3b20ec(0x40f)]['delete'](_0x48f1de),0x2710===_0x5cefa4['code'])_0x2acac3['resolve'](_0x5cefa4['data']);else{const _0x27f9b9=_0x5cefa4[_0x3b20ec(0x36b)]||_0x3b20ec(0x386)+_0x5cefa4['code'];_0x2acac3['reject'](new Error(_0x27f9b9));}}else{if(Array['isArray'](_0x5cefa4[_0x3b20ec(0x2b2)])&&_0x5cefa4['data'][_0x3b20ec(0x2be)]>0x0&&void 0x0!==_0x5cefa4['data'][0x0]?.['serial']&&0x2710===_0x5cefa4['code']){const _0x2f9263=_0x5cefa4['data'];this[_0x3b20ec(0x22a)]['debug'](_0x3b20ec(0x109)+_0x2f9263['length']+_0x3b20ec(0x17d));}else this[_0x3b20ec(0x22a)]['warn']('Received\x20response\x20but\x20no\x20pending\x20requests:\x20'+JSON['stringify'](_0x5cefa4));}}async['processRequestQueue'](){const _0x1b6ddf=_0x125974;if(this[_0x1b6ddf(0x253)]||0x0===this['requestQueue']['length'])return;if(!this['isConnected']||!this['ws'])return;this['isProcessingRequest']=!0x0;const {request:_0x50a761,resolve:_0x1c22e7,reject:_0x3da10c,timeout:_0x4aed34}=this[_0x1b6ddf(0x223)]['shift']();try{_0x1c22e7(await this['_sendRequestOnce'](_0x50a761,_0x4aed34));}catch(_0x2e530b){_0x3da10c(_0x2e530b);}finally{this['isProcessingRequest']=!0x1,this[_0x1b6ddf(0x223)][_0x1b6ddf(0x2be)]>0x0&&setImmediate(()=>this['processRequestQueue']());}}async['_sendRequestOnce'](_0x43991d,_0x279d70=0x7530){return new Promise((_0x596cd3,_0x42ef6b)=>{const _0x2b4fee=a0_0x5814,_0x417812=Date['now']()[_0x2b4fee(0x238)]()+Math['random']()[_0x2b4fee(0x238)](0x24)['substr'](0x2,0x9);this['pendingRequests']['set'](_0x417812,{'resolve':_0x596cd3,'reject':_0x42ef6b});const _0x12d17d=setTimeout(()=>{this['pendingRequests']['delete'](_0x417812),_0x42ef6b(new Error('WebSocket\x20request\x20timeout'));},_0x279d70),_0x14b0d0=_0x596cd3,_0x4d0df1=_0x42ef6b;_0x596cd3=_0x4be526=>{clearTimeout(_0x12d17d),_0x14b0d0(_0x4be526);},_0x42ef6b=_0x4921ce=>{clearTimeout(_0x12d17d),_0x4d0df1(_0x4921ce);},this['pendingRequests']['set'](_0x417812,{'resolve':_0x596cd3,'reject':_0x42ef6b});try{const _0x5dd488=JSON['stringify'](_0x43991d);this['ws']['send'](_0x5dd488);}catch(_0x5c6976){this['logger']['error'](_0x2b4fee(0x2e7)+_0x5c6976[_0x2b4fee(0x36b)],_0x5c6976['stack']),this['pendingRequests']['delete'](_0x417812),clearTimeout(_0x12d17d),_0x42ef6b(_0x5c6976);}});}async[_0x125974(0x311)](_0x4d71c1,_0x480d8a=0x7530){return new Promise((_0x5d5833,_0x97fd2d)=>{this['requestQueue']['push']({'request':_0x4d71c1,'resolve':_0x5d5833,'reject':_0x97fd2d,'timeout':_0x480d8a}),this['processRequestQueue']();});}async['listDevices'](){const _0x4b9dbd=_0x125974,_0xd1391b=(await this['sendRequest']({'action':'list'}))['map'](_0x32c4f6=>({..._0x32c4f6,'udid':_0x32c4f6[_0x4b9dbd(0x160)]}));return _0xd1391b['length']<=0x0&&this['logger'][_0x4b9dbd(0x3e9)]('No\x20devices\x20found!'),_0xd1391b;}async['click'](_0x43583b,_0x3811dd,_0x296f91,_0x35965c=0.2){const _0x21ec82=_0x125974;return this['sendRequest']({'action':'pointerEvent','devices':Array['isArray'](_0x43583b)?_0x43583b['join'](','):_0x43583b,'data':{'type':'10','x':(0x0,_0x1bebd2['toString'])(_0x3811dd),'y':(0x0,_0x1bebd2[_0x21ec82(0x238)])(_0x296f91)}});}async['swipe'](_0x15a5ee,_0xf25b7f){const _0x9bf4da=_0x125974,_0x9a2616=Array['isArray'](_0x15a5ee)?_0x15a5ee['join'](','):_0x15a5ee;return this[_0x9bf4da(0x311)]({'action':_0x9bf4da(0x131),'devices':_0x9a2616,'data':_0xf25b7f});}async['captureScreen'](_0x1c1aa6,_0x21750c){const _0x517b5b=_0x125974;return this['sendRequest']({'action':'screenFile','devices':_0x1c1aa6,'data':{'savePath':_0x21750c[_0x517b5b(0x217)]}});}async[_0x125974(0x242)](_0xf7ac4a){return this['sendRequest']({'action':'pushEvent','devices':_0xf7ac4a,'data':{'type':'2'}});}async['launchApp'](_0x5cba99,_0x263e4f){const _0x5f2e00=_0x125974,_0x2dcecd=Array['isArray'](_0x5cba99)?_0x5cba99['join'](','):_0x5cba99;return this[_0x5f2e00(0x311)]({'action':'startApp','devices':_0x2dcecd,'data':{'app':_0x263e4f}});}async['killApp'](_0x279cb7,_0xb0009f){const _0x546c88=_0x125974,_0x2c16a0=Array['isArray'](_0x279cb7)?_0x279cb7[_0x546c88(0x19c)](','):_0x279cb7;return this[_0x546c88(0x311)]({'action':_0x546c88(0x2cb),'devices':_0x2c16a0,'data':{'app':_0xb0009f}});}async[_0x125974(0x340)](_0x1828b5){const _0x91779e=_0x125974,{x:_0x11bf4f,y:_0x268bc7}=_0x11e51f['COMMON_COORDINATES']['KEYBOARD_SWITCH'];this[_0x91779e(0x22a)]['log'](_0x91779e(0x306)+_0x1828b5+'\x20at\x20coordinates\x20('+_0x11bf4f+',\x20'+_0x268bc7+')'),await this['click'](_0x1828b5,_0x11bf4f,_0x268bc7,0.2),await(0x0,_0x2abfc3['sleep'])(0x1f4),this[_0x91779e(0x22a)]['log']('Keyboard\x20mode\x20switched\x20successfully\x20on\x20device\x20'+_0x1828b5);}async['pressShiftKey'](_0x210e21){const _0x3206b1=_0x125974,{x:_0x30548a,y:_0x210c57}=_0x11e51f['COMMON_COORDINATES'][_0x3206b1(0x2df)];this[_0x3206b1(0x22a)]['debug']('Pressing\x20shift\x20key\x20on\x20device\x20'+_0x210e21+_0x3206b1(0x35b)+_0x30548a+',\x20'+_0x210c57+')'),await this[_0x3206b1(0x3cc)](_0x210e21,_0x30548a,_0x210c57,0.2),await(0x0,_0x2abfc3[_0x3206b1(0x404)])(0xc8),this[_0x3206b1(0x22a)][_0x3206b1(0x181)]('Shift\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0x210e21);}async[_0x125974(0x20c)](_0x34b9c4){const _0x2b1056=_0x125974,{x:_0x4d4004,y:_0x5b9c16}=_0x11e51f['COMMON_COORDINATES'][_0x2b1056(0x2dd)];await this['click'](_0x34b9c4,_0x4d4004,_0x5b9c16,0.2),await(0x0,_0x2abfc3['sleep'])(0x1f4);}async[_0x125974(0x3fe)](_0x1461db,_0x4e2f66){const _0x1d836b=Array['isArray'](_0x1461db)?_0x1461db['join'](','):_0x1461db;return this['sendRequest']({'action':'inputText','devices':_0x1d836b,'data':{'content':_0x4e2f66}});}async['inputNumpadNumber'](_0x29ee96,_0x65e453){const _0x2ed8a7=_0x125974;if(!_0x65e453||0x0===_0x65e453[_0x2ed8a7(0x2be)])throw new Error('value\x20cannot\x20be\x20empty');for(let _0x28b503=0x0;_0x28b503<_0x65e453[_0x2ed8a7(0x2be)];_0x28b503++){const _0x36835a=_0x65e453[_0x28b503],_0x508505=_0x11e51f['NUMPAD_LAYOUT'][_0x36835a];await this[_0x2ed8a7(0x3cc)](_0x29ee96,_0x508505['x'],_0x508505['y']),this['logger']['debug']('Clicking\x20key\x20\x27'+_0x36835a+'\x27\x20at\x20('+_0x508505['x']+',\x20'+_0x508505['y']+')'),await(0x0,_0x2abfc3[_0x2ed8a7(0x404)])(0xc8);}}async['transferFile'](_0x1edd69,_0x33b148,_0xf4ad71=0x1){const _0x51ec1a=_0x125974,_0x477a45=Array['isArray'](_0x1edd69)?_0x1edd69[_0x51ec1a(0x19c)](','):_0x1edd69;return this[_0x51ec1a(0x22a)][_0x51ec1a(0x19e)]('Transferring\x20file\x20'+_0x33b148+'\x20to\x20device(s)\x20'+_0x477a45+'\x20with\x20fileType\x20'+_0xf4ad71),this[_0x51ec1a(0x311)]({'action':_0x51ec1a(0x287),'devices':_0x477a45,'data':{'filePath':_0x33b148,'fileType':_0xf4ad71}});}['isConnectedStatus'](){const _0x4f28e7=_0x125974;return this[_0x4f28e7(0x17e)];}};_0x2bbc39[_0x125974(0x1cb)]=_0x331250,_0x2bbc39[_0x125974(0x1cb)]=_0x331250=_0x27eda2([(0x0,_0x520194['Injectable'])(),_0x146175('design:paramtypes',['function'==typeof(_0x3c6077=void 0x0!==_0xcf117['TelegramService']&&_0xcf117['TelegramService'])?_0x3c6077:Object])],_0x331250);},function(_0x5b8ec1,_0xafc886,_0x510747){const _0x21d978=a0_0x5814;var _0x1e8552,_0xcd74ed,_0x443846,_0x30b5bb,_0x531a82=this&&this[_0x21d978(0x21a)]||function(_0x4f3df3,_0xaf4231,_0x4eb28b,_0x40c896){const _0x38a39e=_0x21d978;var _0x29d76d,_0x227401=arguments['length'],_0x2344fb=_0x227401<0x3?_0xaf4231:null===_0x40c896?_0x40c896=Object['getOwnPropertyDescriptor'](_0xaf4231,_0x4eb28b):_0x40c896;if('object'==typeof Reflect&&_0x38a39e(0x379)==typeof Reflect['decorate'])_0x2344fb=Reflect['decorate'](_0x4f3df3,_0xaf4231,_0x4eb28b,_0x40c896);else{for(var _0x32c9c2=_0x4f3df3['length']-0x1;_0x32c9c2>=0x0;_0x32c9c2--)(_0x29d76d=_0x4f3df3[_0x32c9c2])&&(_0x2344fb=(_0x227401<0x3?_0x29d76d(_0x2344fb):_0x227401>0x3?_0x29d76d(_0xaf4231,_0x4eb28b,_0x2344fb):_0x29d76d(_0xaf4231,_0x4eb28b))||_0x2344fb);}return _0x227401>0x3&&_0x2344fb&&Object[_0x38a39e(0x2d5)](_0xaf4231,_0x4eb28b,_0x2344fb),_0x2344fb;},_0x4a32a0=this&&this['__metadata']||function(_0x271e72,_0x3d3b50){const _0x5064d2=_0x21d978;if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x5064d2(0x168)](_0x271e72,_0x3d3b50);};Object['defineProperty'](_0xafc886,'__esModule',{'value':!0x0}),_0xafc886[_0x21d978(0x3f1)]=void 0x0;const _0x2e0a36=_0x510747(0x2),_0x4421c2=_0x510747(0x7),_0x241e0e=_0x510747(0xb),_0x16c06b=_0x510747(0xe),_0x1ead7c=_0x510747(0x34),_0x59f973=_0x510747(0x40),_0x450d10=_0x510747(0x41);let _0x56fd76=class{constructor(_0x6869e8,_0x3a814c,_0x1ced26,_0x3f57c4){const _0xb3b00d=_0x21d978;this['bankService']=_0x6869e8,this['deviceService']=_0x3a814c,this['sessionManagement']=_0x1ced26,this['redisLockService']=_0x3f57c4,this['logger']=new _0x2e0a36[(_0xb3b00d(0x3c7))](_0xb3b00d(0x3f1));}async['refreshSessions'](){const _0x25d98c=_0x21d978;try{if(await this[_0x25d98c(0x390)]['getLock'](_0x450d10['SYSTEM_LOCK_BOXPHONE']))return;if('active'!==await this['deviceService']['getServiceStatus']())return;const _0x23c810=(await this['deviceService']['listDevices']())['filter'](_0x5e493c=>'active'===_0x5e493c['status']&&_0x5e493c[_0x25d98c(0x358)]);for(const _0x1f0334 of _0x23c810){const _0xccddfb=_0x1f0334[_0x25d98c(0x358)][_0x25d98c(0x2c9)]();try{await this['bankService']['refreshSessionIfNeeded'](_0x1f0334[_0x25d98c(0x33a)],_0xccddfb);}catch(_0x18a1be){this['logger']['error']('Error\x20refreshing\x20session\x20for\x20device\x20'+_0x1f0334['udid']+',\x20bank\x20'+_0xccddfb+':\x20'+_0x18a1be[_0x25d98c(0x36b)]);}}}catch(_0x444cee){this['logger']['error'](_0x25d98c(0x2a3)+_0x444cee['message']);}}};_0xafc886['SessionRefreshScheduler']=_0x56fd76,_0x531a82([(0x0,_0x4421c2['Cron'])(_0x4421c2[_0x21d978(0x2fd)]['EVERY_30_SECONDS']),_0x4a32a0('design:type',Function),_0x4a32a0(_0x21d978(0x17c),[]),_0x4a32a0(_0x21d978(0x2ee),Promise)],_0x56fd76['prototype'],'refreshSessions',null),_0xafc886['SessionRefreshScheduler']=_0x56fd76=_0x531a82([(0x0,_0x2e0a36['Injectable'])(),_0x4a32a0('design:paramtypes',[_0x21d978(0x379)==typeof(_0x1e8552=void 0x0!==_0x241e0e['BankService']&&_0x241e0e['BankService'])?_0x1e8552:Object,'function'==typeof(_0xcd74ed=void 0x0!==_0x16c06b['DeviceService']&&_0x16c06b[_0x21d978(0x1f4)])?_0xcd74ed:Object,'function'==typeof(_0x443846=void 0x0!==_0x1ead7c[_0x21d978(0x1e9)]&&_0x1ead7c['SessionManagementService'])?_0x443846:Object,_0x21d978(0x379)==typeof(_0x30b5bb=void 0x0!==_0x59f973['RedisLockService']&&_0x59f973['RedisLockService'])?_0x30b5bb:Object])],_0x56fd76);},function(_0x37c1c8,_0x1ccdeb,_0x5e23f7){const _0x2e8c7=a0_0x5814;var _0x5e4b9d=this&&this['__decorate']||function(_0x426d60,_0x38af48,_0x3a4b3a,_0x1cdc3d){const _0x1d6350=a0_0x5814;var _0x4da81d,_0x56053e=arguments['length'],_0x324b72=_0x56053e<0x3?_0x38af48:null===_0x1cdc3d?_0x1cdc3d=Object['getOwnPropertyDescriptor'](_0x38af48,_0x3a4b3a):_0x1cdc3d;if(_0x1d6350(0x1bb)==typeof Reflect&&_0x1d6350(0x379)==typeof Reflect['decorate'])_0x324b72=Reflect[_0x1d6350(0x1fe)](_0x426d60,_0x38af48,_0x3a4b3a,_0x1cdc3d);else{for(var _0x55540f=_0x426d60['length']-0x1;_0x55540f>=0x0;_0x55540f--)(_0x4da81d=_0x426d60[_0x55540f])&&(_0x324b72=(_0x56053e<0x3?_0x4da81d(_0x324b72):_0x56053e>0x3?_0x4da81d(_0x38af48,_0x3a4b3a,_0x324b72):_0x4da81d(_0x38af48,_0x3a4b3a))||_0x324b72);}return _0x56053e>0x3&&_0x324b72&&Object['defineProperty'](_0x38af48,_0x3a4b3a,_0x324b72),_0x324b72;};Object[_0x2e8c7(0x2d5)](_0x1ccdeb,_0x2e8c7(0x363),{'value':!0x0}),_0x1ccdeb['OCRModule']=void 0x0;const _0x4d9abe=_0x5e23f7(0x2),_0x27c435=_0x5e23f7(0x1c),_0x301075=_0x5e23f7(0x1e),_0x2451e7=_0x5e23f7(0x1b);let _0x160457=class{};_0x1ccdeb[_0x2e8c7(0x3d9)]=_0x160457,_0x1ccdeb['OCRModule']=_0x160457=_0x5e4b9d([(0x0,_0x4d9abe['Module'])({'providers':[_0x27c435[_0x2e8c7(0x124)],_0x301075['ImagePreprocessingService'],_0x2451e7['OCRService']],'exports':[_0x2451e7['OCRService'],_0x27c435[_0x2e8c7(0x124)],_0x301075['ImagePreprocessingService']]})],_0x160457);},function(_0x451a67,_0x356009,_0xd1273){const _0x1f98c3=a0_0x5814;var _0x2012a8=this&&this['__decorate']||function(_0x4789af,_0x5500a4,_0x509158,_0x2422da){const _0x14e1a2=a0_0x5814;var _0x156d0b,_0x21f60d=arguments['length'],_0x48c402=_0x21f60d<0x3?_0x5500a4:null===_0x2422da?_0x2422da=Object['getOwnPropertyDescriptor'](_0x5500a4,_0x509158):_0x2422da;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x48c402=Reflect[_0x14e1a2(0x1fe)](_0x4789af,_0x5500a4,_0x509158,_0x2422da);else{for(var _0x430e01=_0x4789af['length']-0x1;_0x430e01>=0x0;_0x430e01--)(_0x156d0b=_0x4789af[_0x430e01])&&(_0x48c402=(_0x21f60d<0x3?_0x156d0b(_0x48c402):_0x21f60d>0x3?_0x156d0b(_0x5500a4,_0x509158,_0x48c402):_0x156d0b(_0x5500a4,_0x509158))||_0x48c402);}return _0x21f60d>0x3&&_0x48c402&&Object[_0x14e1a2(0x2d5)](_0x5500a4,_0x509158,_0x48c402),_0x48c402;};Object['defineProperty'](_0x356009,'__esModule',{'value':!0x0}),_0x356009['NotificationModule']=void 0x0;const _0xabd720=_0xd1273(0x2),_0x2df235=_0xd1273(0x35),_0x2c8a9a=_0xd1273(0x36),_0x52b30c=_0xd1273(0x8),_0x30c136=_0xd1273(0x2c);let _0xdb7ae=class{};_0x356009[_0x1f98c3(0x18b)]=_0xdb7ae,_0x356009['NotificationModule']=_0xdb7ae=_0x2012a8([(0x0,_0xabd720[_0x1f98c3(0x218)])(),(0x0,_0xabd720['Module'])({'imports':[_0x52b30c['HttpModule']],'providers':[_0x2df235['NotificationService'],_0x2c8a9a[_0x1f98c3(0x3af)],_0x30c136['TelegramService']],'exports':[_0x2df235[_0x1f98c3(0x1a2)],_0x30c136['TelegramService']]})],_0xdb7ae);},function(_0x28023d,_0x43b1f6,_0x251e89){const _0xc75a6f=a0_0x5814;var _0x56ca2a=this&&this['__decorate']||function(_0xa05377,_0x300cea,_0x77dde5,_0x30e6b6){const _0x53120d=a0_0x5814;var _0x5d1011,_0x21012a=arguments[_0x53120d(0x2be)],_0x133766=_0x21012a<0x3?_0x300cea:null===_0x30e6b6?_0x30e6b6=Object[_0x53120d(0x313)](_0x300cea,_0x77dde5):_0x30e6b6;if(_0x53120d(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x133766=Reflect[_0x53120d(0x1fe)](_0xa05377,_0x300cea,_0x77dde5,_0x30e6b6);else{for(var _0x85ef8b=_0xa05377['length']-0x1;_0x85ef8b>=0x0;_0x85ef8b--)(_0x5d1011=_0xa05377[_0x85ef8b])&&(_0x133766=(_0x21012a<0x3?_0x5d1011(_0x133766):_0x21012a>0x3?_0x5d1011(_0x300cea,_0x77dde5,_0x133766):_0x5d1011(_0x300cea,_0x77dde5))||_0x133766);}return _0x21012a>0x3&&_0x133766&&Object[_0x53120d(0x2d5)](_0x300cea,_0x77dde5,_0x133766),_0x133766;};Object['defineProperty'](_0x43b1f6,_0xc75a6f(0x363),{'value':!0x0}),_0x43b1f6['WindowAppModule']=void 0x0;const _0x14907b=_0x251e89(0x2),_0x151fd0=_0x251e89(0x3d);let _0x4511fe=class{};_0x43b1f6[_0xc75a6f(0x249)]=_0x4511fe,_0x43b1f6['WindowAppModule']=_0x4511fe=_0x56ca2a([(0x0,_0x14907b['Module'])({'providers':[_0x151fd0['WindowsAppGitBashService']],'exports':[_0x151fd0['WindowsAppGitBashService']]})],_0x4511fe);},function(_0x4eb630,_0x5830c8,_0x33b25e){const _0x291dae=a0_0x5814;var _0x279734=this&&this['__decorate']||function(_0x4920e8,_0x7c2dc3,_0x41eb02,_0x40549f){const _0x254d66=a0_0x5814;var _0x4b1a31,_0x558a21=arguments['length'],_0x2db340=_0x558a21<0x3?_0x7c2dc3:null===_0x40549f?_0x40549f=Object[_0x254d66(0x313)](_0x7c2dc3,_0x41eb02):_0x40549f;if(_0x254d66(0x1bb)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x2db340=Reflect['decorate'](_0x4920e8,_0x7c2dc3,_0x41eb02,_0x40549f);else{for(var _0x1f3e82=_0x4920e8['length']-0x1;_0x1f3e82>=0x0;_0x1f3e82--)(_0x4b1a31=_0x4920e8[_0x1f3e82])&&(_0x2db340=(_0x558a21<0x3?_0x4b1a31(_0x2db340):_0x558a21>0x3?_0x4b1a31(_0x7c2dc3,_0x41eb02,_0x2db340):_0x4b1a31(_0x7c2dc3,_0x41eb02))||_0x2db340);}return _0x558a21>0x3&&_0x2db340&&Object['defineProperty'](_0x7c2dc3,_0x41eb02,_0x2db340),_0x2db340;};Object['defineProperty'](_0x5830c8,'__esModule',{'value':!0x0}),_0x5830c8['RedisLockModule']=void 0x0;const _0x32d807=_0x33b25e(0x2),_0x54d067=_0x33b25e(0xf),_0x44285d=_0x33b25e(0x40);let _0x19aed3=class{};_0x5830c8['RedisLockModule']=_0x19aed3,_0x5830c8['RedisLockModule']=_0x19aed3=_0x279734([(0x0,_0x32d807['Global'])(),(0x0,_0x32d807['Module'])({'providers':[_0x54d067['RedisService'],_0x44285d[_0x291dae(0x1da)]],'exports':[_0x44285d[_0x291dae(0x1da)]]})],_0x19aed3);}],_0x7dbd17={};function _0x5edf18(_0x5f06c5){const _0x551892=a0_0x5814;var _0x222267=_0x7dbd17[_0x5f06c5];if(void 0x0!==_0x222267)return _0x222267[_0x551892(0x255)];var _0x5e1201=_0x7dbd17[_0x5f06c5]={'exports':{}};return _0x38b1b5[_0x5f06c5]['call'](_0x5e1201[_0x551892(0x255)],_0x5e1201,_0x5e1201['exports'],_0x5edf18),_0x5e1201['exports'];}var _0x4b0cbf={};((()=>{const _0xeab5a2=a0_0x5814;var _0x462127=_0x4b0cbf;Object[_0xeab5a2(0x2d5)](_0x462127,'__esModule',{'value':!0x0});const _0x9070a9=_0x5edf18(0x1),_0x1b9791=_0x5edf18(0x2),_0x1fda87=_0x5edf18(0x3),_0x23185a=_0x5edf18(0x4),_0x3a7fde=_0x5edf18(0x5),_0x87a1bc=_0x5edf18(0x11);!(async function(){const _0x4ed558=_0xeab5a2,_0x55c59b=await _0x9070a9['NestFactory'][_0x4ed558(0x3ee)](_0x3a7fde['AppModule'],{}),_0x45e69b=new _0x1b9791[(_0x4ed558(0x3c7))](_0x4ed558(0x172)),_0x1b66d2='production'===process['env']['NODE_ENV']?(0x0,_0x23185a['join'])(__dirname,'views'):(0x0,_0x23185a['join'])(process[_0x4ed558(0x307)](),'src',_0x4ed558(0x146));_0x55c59b['setBaseViewsDir'](_0x1b66d2),_0x55c59b['setViewEngine']('ejs'),_0x45e69b[_0x4ed558(0x19e)]('Views\x20directory:\x20'+_0x1b66d2),_0x55c59b[_0x4ed558(0x1cc)](new _0x1b9791['ValidationPipe']({'transform':!0x0,'whitelist':!0x0,'forbidNonWhitelisted':!0x0}));const _0x175b0a=new _0x1fda87['DocumentBuilder']()[_0x4ed558(0x297)](_0x4ed558(0x346))['setDescription']('Automated\x20withdrawal\x20processing\x20service\x20with\x20HC\x20BOX\x20integration')['setVersion'](_0x4ed558(0x413))['addTag'](_0x4ed558(0x3b5),_0x4ed558(0x204))[_0x4ed558(0x295)](_0x4ed558(0x25f),'Withdrawal\x20processing')['addTag']('device','Device\x20management')[_0x4ed558(0x295)]('hcbox','HC\x20Box\x20integration')[_0x4ed558(0x2b7)](),_0x38bed0=_0x1fda87['SwaggerModule']['createDocument'](_0x55c59b,_0x175b0a);_0x1fda87['SwaggerModule'][_0x4ed558(0x33b)]('docs',_0x55c59b,_0x38bed0);const _0x17b401=process[_0x4ed558(0x31b)]['PORT']||0xbba;_0x45e69b['log'](_0x4ed558(0x12d)+_0x17b401+'/docs'),await _0x55c59b['listen'](_0x17b401),_0x45e69b['log'](_0x4ed558(0x2c4)+_0x17b401),_0x45e69b['log']('📊\x20Withdrawal\x20processing\x20started\x20by\x20'+_0x87a1bc['config']['boxType']+'\x20box'),_0x45e69b[_0x4ed558(0x19e)](_0x4ed558(0x2b9)+_0x17b401);}());})());})()));function a0_0x5814(_0x4b8389,_0x324d7d){_0x4b8389=_0x4b8389-0x100;const _0x1016a8=a0_0x1016();let _0x58142e=_0x1016a8[_0x4b8389];return _0x58142e;}function a0_0x1016(){const _0x201e1c=['design:returntype','worker','HTML','\x20already\x20completed','C:/boxscreen/','api/devices/:deviceId/config','\x20to\x20queue\x20for\x20retrying.\x20(','.\x20Process\x20may\x20require\x20administrator\x20privileges\x20to\x20terminate.','requestFormWithRetry','HOME_SCREEN','Error\x20extracting\x20transaction\x20amount:\x20','getJobs','ALBUM_SCREEN','deviceLockService','restartPandaBoxPeriodically','CronExpression','Folder\x20path\x20is\x20null\x20or\x20empty','Text\x20string\x20to\x20input\x20(e.g.,\x20\x22abc123\x22,\x20\x22test@email.com\x22)','hgetall','stat','onModuleInit','Click\x20completed\x20successfully\x20at\x20coordinates\x20(','decodeImage','Transaction\x20confirm\x20screen\x20not\x20found','Switching\x20keyboard\x20mode\x20on\x20device\x20','cwd','BANK_CODE','startApp',']\x20-\x20Error\x20uploading\x20receipt\x20for\x20','description','Error\x20testing\x20','OTP_ENTER','BACK_TO_HOME','Could\x20not\x20parse\x20amount\x20from\x20OCR\x20text:\x20','RedisService','sendRequest','\x0a<b>Description:</b>\x20\x20','getOwnPropertyDescriptor','readFile','Terminating\x20','ocrRecognize','HttpException','shift','VPBANK','ms)','env','danh\x20ba\x20thụ\x20hưởng','BaseBankService','Promote\x20skipped\x20for\x20job\x20','kernel','jobId','jobManagerService','updateDeviceConfig','VIETCOMBANK','endY','defaultChatId','LAUNCH_APP','X\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100).\x20Required\x20for\x20HC\x20and\x20Panda\x20types\x200,1,2,10.\x20Optional\x20for\x20Panda\x20types\x204,5,6,7,8,9','INTERNAL_SERVER_ERROR','ROI:\x20x=','Test\x20pressing\x20return\x20key\x20on\x20a\x20device','PGBANK','roi','ezpayBeClient','analyzedStatus','VIETABANK','cannot\x20find\x20a\x20process',']\x20Failed\x20to\x20detect\x20screen\x20after\x203\x20swipe\x20attempts','Transfer\x20execution\x20flow\x20needs\x20to\x20be\x20customized\x20per\x20bank\x20app\x20UI','caption','testInputText','folderCreated','BankController','deactive','redisClient','parse_mode','udid','setup','cleanupFolder','FORCE_LOGIN_NO_REQUEUE','killApp','customROI','switchKeyboardMode','Error\x20testing\x20press\x20return:\x20','reconnectAttempts','max','markLoggingIn','accountNo','EzPay\x20Auto\x20API','Failed:\x20MH\x20Xác\x20nhận\x20giao\x20dịch',',\x20h=','wda-','withdrawalId','Device\x20ID','unlink','reconnectDelay','Text\x20input\x20completed\x20successfully\x20on\x20device\x20','apiUrl','ApiTags','executeTransferWithQRCode','pickAndProcessJobs','Successfully\x20uploaded\x20bill\x20for\x20withdrawal\x20','map','parseMode','logTimingBreakdown','Password\x20not\x20configured\x20for\x20device\x20','bankCode','Panda\x20BOX\x20WebSocket\x20closed','Clicking\x20password\x20field\x20on\x20device\x20','\x20at\x20coordinates\x20(','post','api/bank/:bankCode','WindowsAppGitBashService','2060zLtXzI','expire','ApiOperation','onModuleDestroy','__esModule','deviceId','AGRIBANK','Received\x20response\x20but\x20no\x20pending\x20requests:\x20','\x0a\x20\x20\x20\x20\x20\x20if\x20redis.call(\x22GET\x22,\x20KEYS[1])\x20==\x20ARGV[1]\x20then\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20redis.call(\x22DEL\x22,\x20KEYS[1])\x0a\x20\x20\x20\x20\x20\x20end\x0a\x20\x20\x20\x20\x20\x20return\x200\x0a\x20\x20\x20\x20','ocr','scaleCoordinates','OCR\x20worker\x20pool\x20warmed\x20up\x20successfully\x20in\x20','message','\x0a\x0a<b>From:</b>\x20\x20','SWIPE_UP','del','hasActiveDevice','ApiResponse','inputSmartOTPFromConfig','validateROI','10cPTFUC','WithdrawalProcessingError','warn','psm','smartOTP','IsNotEmpty','function','HOME_ICON','OCR_PSM_SINGLE','all','parse','value\x20cannot\x20be\x20empty','response','BullModule','catch','api/service/start','Cannot\x20kill\x20process\x20(access\x20denied):\x20','isInitialized','HCWebSocketService','Panda\x20BOX\x20error:\x20','TRANSACTION_VERIFY','REDIS_DEVICE_CONFIG_SUFFIX','Process\x20not\x20found\x20(expected):\x20','executeInternalTransfer','isSpecialCharInNumberMode','loginTime','HD_ROI_EXPECTED','This\x20key\x20can\x20dismiss\x20keyboard\x20or\x20submit/enter\x20depending\x20on\x20context','processingTime','redisLockService','LOGIN_BTN','Testing\x20press\x20return\x20key\x20on\x20device:\x20','cron:promote_delayed:withdrawal','device:','EXIMBANK','trim','Controller','Y\x20coordinate\x20(Hc:\x200-1),\x20Panda:\x200-100',']\x20-\x20Get\x20login\x20app\x20screen','TPBANK','Marked\x20withdrawal\x20','ENTER_OTP','updateWithdrawal','process-withdrawal-request','screen','GPBANK','CONTINUE_OTP_VERIFY_BTN','hget','ceil','testClickAtCoordinates','powershell\x20-NoProfile\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22','ScheduleModule','❌\x20<b>Failed\x20Withdraw.\x20Max\x20retries\x20exceeded...</b>\x0a','HD_SCREEN_OTP_HINT','filter','Created\x20base\x20folder:\x20','Withdrawal\x20','OCR_PSM_FULL','COMPLETED','Invalid\x20image\x20dimensions:\x20width\x20or\x20height\x20is\x200','EzpayBeClientService','HcBoxService','Cron','prototype','reject','Scanning\x20folder\x20for\x20bill\x20image:\x20','bank','duration','quality','REDIS_LOCK_PREFIX','vie+eng','config','getBankBundleId','\x20or\x20','\x20(swipe\x20direction,\x20no\x20coordinates)','ACB','isLocked','design:type','Failed:\x20Vuốt\x20lên\x20để\x20tiếp\x20tục','rawPath','withdrawalCode','text','878148ihlvdk','Query','Logger','endX','\x20VND\x20(confidence:\x20','get','chat_id','click','BankCodeWithdrawal','Swipe\x20up\x20failed','requestWithRetry','OTP\x20se\x20tu\x20dong\x20lam\x20moi',']\x20Released\x20lock\x20(lockId:\x20',']\x20Lock\x20was\x20already\x20released\x20or\x20changed\x20(expected\x20lockId:\x20','Device\x20','PANDA','stopService','ROI','isLetter','\x22\x20on\x20device:\x20','OCRModule',']\x20-\x20Get\x20back\x20to\x20home\x20screen','getAvailableDevices','14.225.44.234','launchApp','Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)','Error\x20parsing\x20WebSocket\x20message:\x20','IMAGE_LIBRARY_BTN','redisService','Number\x20string\x20to\x20input\x20(e.g.,\x20\x22123\x22,\x20\x22456789\x22)','__param','VRB','splice','/bot','\x20attempts)','/api/bank/','error','\x20|\x20Matched\x20texts:\x20[','swipe','executeTransfer','\x0a<b>To:</b>\x20','create',']\x20-\x20Get\x20Transaction\x20verify\x20screen','\x22\x20/FO\x20CSV\x20/NH','SessionRefreshScheduler','login','Get\x20withdrawal\x20queue\x20statistics','poolSize','none','Bank\x20service\x20not\x20found\x20for\x20bank\x20code:\x20','Withdrawal\x20not\x20pending\x20or\x20retry,\x20skipping\x20(','Found\x20latest\x20bill\x20image:\x20','production',']\x20-\x20Login\x20successfully','withdrawalQueue','disableNotification','completed','inputText','COMMON_COORDINATES','Detailed\x20queue\x20debug\x20info','Tesseract\x20worker\x20','\x20|\x20','\x22\x20-ErrorAction\x20SilentlyContinue\x20|\x20ForEach-Object\x20{\x20$_.CloseMainWindow()\x20|\x20Out-Null\x20}','sleep','clickPasswordField','exists','Error\x20creating\x20WebSocket\x20connection:\x20','/test/swipe/{deviceId}?type=0','https://api-hn.botpro.world/payment','transferFile','HdBankService','connect','_sendRequestOnce',']\x20Successfully\x20logged\x20in\x20to\x20','pendingRequests','recognizeFromFile','ocrService','DeviceController','1.0','Telegram\x20request\x20failed,\x20retrying\x20in\x20','Choose\x20wrong\x20account\x20name',']\x20QR\x20code\x20is\x20created\x20and\x20transferred\x20for\x20withdrawal\x20','\x0aif\x20redis.call(\x22GET\x22,\x20KEYS[1])\x20==\x20ARGV[1]\x20then\x0a\x20\x20return\x20redis.call(\x22DEL\x22,\x20KEYS[1])\x0aelse\x0a\x20\x20return\x200\x0aend\x0a','❌\x20<b>Failed\x20Withdraw.\x20Retrying...</b>\x0a','chuyển\x20tiền\x20thành\x20công','listDevices','not\x20found','/api/internal/withdrawals/complete/','Received\x20unsolicited\x20device\x20list\x20update\x20(no\x20pending\x20requests):\x20','Manually\x20trigger\x20job\x20picking','\x20when\x20uploading\x20bill\x20for\x20withdrawal\x20','loginAllActiveBanks','Transaction\x20success\x20screen\x20not\x20found','TECHCOMBANK','fieldType','found','K82766678488957','setnx','readdir','now','beneficiaryAccountNo','verifyScreenState','availableAmount','ms:\x20','Invalid\x20box\x20type\x20configuration:\x20','ocrConfig','backoffMs',']\x20Device\x20is\x20not\x20locked,\x20nothing\x20to\x20release','IWebSocketService','delete','Body','deviceLock','TRANSACTION_CONFIRM','\x20as\x20failed:\x20','OCRService','OCRWorkerPoolService','https://apipro2.ocr.space/parse/image','inputNumpadNumber','ECONNRESET','getRefreshBeforeTime','Error\x20getting\x20session\x20for\x20device\x20','expiresAt','forceKill','SWIPE_RIGHT','📚\x20Swagger\x20documentation\x20available\x20at:\x20http://localhost:','set','waitUntilNotRunning','Failed:\x20MH\x20Chuyển\x20tiền\x20thành\x20công','pointerEvent','HDBANK','HttpStatus','IsOptional','REDIS_DEVICE_CONFIG_PREFIX','PreprocessOptions','Available\x20Amount\x20must\x20be\x20greater\x20than\x20or\x20equal\x20to\x200','disableWebPagePreview','Lock\x20was\x20already\x20released\x20or\x20changed\x20(expected\x20lockId:\x20','maxReconnectAttempts','.png','Successfully\x20picked\x20and\x20removed\x20withdrawal\x20','ApiQuery','REDIS_SERVICE_STATUS_KEY','password','number','TEMPORARY','VIB','\x20attempts','Error\x20updating\x20device\x20config\x20for\x20','REDIS_PROCESSED_PREFIX','views','</b>\x0a\x0a','TELEGRAM_DEFAULT_CHAT_ID\x20is\x20missing\x20and\x20no\x20chatId\x20was\x20provided.','open','manualRetryCount','Failed\x20to\x20click\x20image\x20library\x20button','createQRCodeAndTransferTo','SYSTEM_LOCK_BOXPHONE','Queue','/test/click/{deviceId}?x=0.5&y=0.55','test/input-text/:deviceId','WithdrawalService','621pmyarA','accountName','transfer','UNKNOWN','WebSocketModule','RETRY','sourceBankCode','waiting',',\x20lang:\x20','sadd','createBillFolder','SHINHANBANKVIETNAM','apiKey','notificationService','serial','DEFAULT_LOCK_TTL','qr_','\x20after\x20','confidence','split',']\x20Failed\x20to\x20cleanup\x20folder:\x20','acquireLock','metadata','getWithdrawalDetails','toBuffer',']\x20-\x20Get\x20image\x20library\x20screen','queue/trigger','clickWithTransition','__metadata','PROCESSING_TTL','workerPoolService','Giao\x20dịch\x20thành\x20công','Bootstrap','refreshBeforeMs','CONFIRM_AFTER_OTP','fullPath','isArray','height','.\x20Must\x20be\x20\x27HC\x27\x20or\x20\x27PANDA\x27','ValidateIf','min','ms.\x20Pool\x20size:\x20','design:paramtypes','\x20device(s)','isConnected','httpService','eval','debug','PENDING','singleLine','toLowerCase','Clicking\x20login\x20button\x20on\x20device\x20','stringify','HSBC','\x20attempts,\x20OCR:\x20','21376fkkeHI','lang','NotificationModule','Image\x20too\x20small:\x20','\x20swipe\x20attempts','OCR_MAX_WIDTH_FULL','goToHomeScreenFromBill','App\x20started\x20successfully:\x20','debugQueue','mkdir','pressShiftKey','tryAcquireFromPool','boxType','PgService','\x22\x20/T','Executing\x20transfer\x20for\x20withdrawal\x20','App\x20started\x20with\x20Administrator\x20privileges:\x20','forwardRef','waitForWorker','join','bankService','log','rois','existsSync','extractTransactionAmount','NotificationService','\x20as\x20logging\x20in','clickLoginButton','\x20available\x20devices.\x20Picking\x20','ImagePreprocessingService','Failed\x20to\x20upload\x20bill\x20for\x20withdrawal\x20','Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20numbers\x20between\x200\x20and\x201','uploadReceipt','resolve','ms,\x20pollInterval:\x20','acbService','Pressing\x20shift\x20key\x20on\x20device\x20','patch','Released\x20lock\x20(lockId:\x20','1005235NywWmF','clickAndWaitForScreen','Uploading\x20receipt\x20for\x20withdrawal\x20','Timeout\x20scanning\x20folder\x20for\x20bill\x20image:\x20','uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE','wsUrl','_id','ACB\x20not\x20implement','\x0a<b>Amount:</b>\x20\x20','🚀🚀🚀\x20<b>Boxphone\x20software...</b>','host','object','\x20-\x20','REDIS_PWD','isSessionValid','captureScreen','WEBSOCKET_SERVICE','baseTransactionFolderPath','createWorker','EVERY_5_SECONDS','🆘\x20<b>Devices\x20disconnected:\x20','Inject','Account\x20No\x20is\x20required\x20when\x20status\x20is\x20active','HD_SCREEN_HINT_NAME',']\x20Error\x20releasing\x20',',\x20timeout:\x20','DeviceModule','PandaWebSocketService','useGlobalPipes','BANK_SESSION_CONFIGS','disconnect','some','startService','folderCreationInProgress','qrcode','PERMANENT','width','keys','FORCE_LOGIN_AND_REQUEUE','TelegramService','ws://127.0.0.1:26608','Failed:\x20MH\x20Xác\x20thực\x20giao\x20dịch','RedisLockService','ACB\x20executeExternalTransfer','append','stderr','PG_UI_COORDINATES','Error\x20testing\x20numpad\x20number\x20input:\x20','processRequestQueue','success','Post','getDeviceConfigSafe','hint','pgbankApp.pgbank.com.vn','Injectable','isNumber','releaseWorker','SessionManagementService','FIRST_IMAGE_BTN','getServiceStatus','letter','SmartOTP\x20not\x20configured\x20for\x20device\x20','safeErr','https://apipro1.ocr.space/parse/image','\x20(attempt\x20','clearSession','stack',']\x20-\x20Get\x20Confirm\x20after\x20OTP\x20screen','DeviceService','\x27,\x27/T\x27\x20-Verb\x20RunAs\x20-Wait\x20-WindowStyle\x20Hidden','status=','GIAO\x20DỊCH\x20THÀNH\x20CÔNG','OCR\x20service\x20is\x20shutting\x20down','Module','devices','REDIS_SESSION_PREFIX','NCB','the\x20system\x20cannot\x20find','decorate','timeout','port','scan_','For\x20Panda\x20type\x20','crop','Bank\x20operations','InjectQueue','endsWith',')\x20+\x20width(','\x20with\x20folderPath:\x20',']\x20Error\x20checking\x20lock\x20status:\x20','BankService','sourceAccountName','pressReturnKey','deviceService','Service\x20started\x20successfully.\x20Devices\x20are\x20logging\x20in\x20and\x20will\x20accept\x20jobs\x20when\x20ready.','registerBankService','removeVietnameseTones','login:','initializationPromise','ApiParam','/sendPhoto','bank:session:','withdraw:','folderPath','Global','WithdrawalModule','__decorate','1596408WZcKaS','Number\x20is\x20required\x20and\x20cannot\x20be\x20empty','com.vcb.VCB','forRoot','BUNDLE_ID','WithdrawalJobManagerService','promoteDelayedJobsPeriodically','isInitializing','requestQueue','Redis\x20Client\x20Reconnecting...','Error\x20executing\x20transfer\x20for\x20withdrawal\x20','telegramService','https://api.telegram.org','promote','maxWidth','logger','entries','X\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100)','Withdrawal','size','name','Error\x20processing\x20job\x20','floor','Successfully\x20processed\x20withdrawal:\x20','findIndex','ANALYZE_BILL_ROI','push','Password\x20field\x20clicked\x20successfully\x20on\x20device\x20','getBankService','toString','forceKillWithPowerShell','matchedTexts','releaseLock','End\x20X\x20coordinate\x20for\x20HC\x20(required\x20for\x20HC:\x200-1)','Uploading\x20bill\x20for\x20withdrawal\x20','base64,','Failed\x20to\x20update\x20withdrawal\x20','ms\x20(','errors','home','markAsProcessing',']\x20Acquired\x20','Queue\x20statistics','sendMessage','PROCESSING','380VkZjgP','WindowAppModule','pgService','test/input-numpad/:deviceId','list','getMilliseconds','tessedit_char_whitelist','getDeviceConfig','wsService','getClient','Failed\x20to\x20launch\x20PGBank\x20app\x20and\x20go\x20to\x20login\x20screen','isProcessingRequest','mtimeMs','exports','Height','Failed\x20to\x20reset\x20worker\x20parameters:\x20','maxPoolSize',',\x20y=','HttpModule','then','BankModule','HD_UI_COORDINATES','imagePreprocessingService','withdrawal','ACB_UI_COORDINATES','isNil',')...','system:lock:pauseprocessing','HDBank','preprocess','releaseLockByType','restartApp','mustDefaultChatId',']\x20-\x20Get\x20Transaction\x20success\x20screen','close','withCronLock','replace','test/click/:deviceId','Failed\x20to\x20login\x20to\x20VIETCOMBANK','FAILED','Failed:\x20Tra\x20tên\x20tài\x20khoản\x20nội\x20bộ\x20HDBANK','normalizeBankAccountName',',\x20Required:\x20','isRetryable','Text\x20is\x20required\x20and\x20cannot\x20be\x20empty','Testing\x20screen\x20capture\x20on\x20device:\x20','Scheduling\x20reconnect\x20attempt\x20','getLock','VCB_UI_COORDINATES',':meta','SWIPE_UP_SCREEN','process\x20not\x20found','cronRestartBoxphoneEnabled','🚀🚀🚀\x20<b>Boxphone\x20software(local\x20dev)...</b>','SELECT_IMAGE_QR_CODE_BTN','Param','processingJobs','isRestartingBoxphone','AppModule','image/png',')\x20to\x20(','result','wda-request','uploadFile','Successfully\x20updated\x20withdrawal\x20','CONTINUE_TRANSFER_BTN','processWithdrawal','api/service/status','NAMABANK','pool','SHB','38780RaTjCh','getBillImagePath','1350603HviBKI','sessionManagement','IsString','Transaction\x20verify\x20screen\x20not\x20found','addTag','MIN_DIMENSION','setTitle','QR_CODE_BTN','handleJobFailure','NO_BILL_AFTER_OTP','Confirm\x20after\x20OTP\x20screen\x20not\x20found',',\x20Error:\x20','VIETBANK','Failed\x20to\x20login\x20','amount','Service\x20is\x20','Đăng\x20nhập','lastUsed','Error\x20in\x20session\x20refresh\x20scheduler:\x20','\x20error:\x20','Unknown\x20screen\x20state','\x27\x20not\x20found\x20in\x20keyboard\x20layout.\x20Skipping...','getQueueStats','status','OCR_ROI_SINGLE_HEIGHT','scheduleReconnect','unknown','WDA\x20','Error\x20clicking\x20login\x20button\x20on\x20device\x20','TRANSACTION_VERIFY_NO_INPUT_OTP','Xác\x20nhận\x20giao\x20dịch','/test/swipe/{deviceId}?x=50&y=30&type=','full','data','handleMessage','ROI\x20extends\x20beyond\x20image:\x20x(','includes','Updating\x20withdrawal\x20','build','image.png','🌐\x20Device\x20management:\x20http://localhost:','beneficiaryName','Password\x20is\x20required\x20when\x20status\x20is\x20active',',\x20bank\x20','DeviceLockService','length','getBankCode','):\x20','LIMIT','setParameters','Kill\x20process\x20warning:\x20','🚀\x20EzPay\x20Auto\x20is\x20running\x20on:\x20http://localhost:','rejectAllPending','api/withdrawal','type','Error\x20getting\x20device\x20config\x20for\x20','toUpperCase','\x20app\x20launch:\x20','stopApp','toFixed','\x20(ROI:\x20','Keyboard\x20mode\x20switched\x20successfully\x20on\x20device\x20','/3\x20-\x20OCR\x20detected\x20text:\x20\x22','windowsAppGitBashService','escapePs','PG_ROI_EXPECTED',']\x20-\x20Get\x20Swipe\x20up\x20screen','.\x20Supported\x20banks:\x20','defineProperty','redis','VCB_ROI_EXPECTED','ErrorType','inputPasswordFromConfig','\x20at\x20(','active','createTransactionFolder','RETURN_KEY','isAcquiring','SHIFT_KEY','Error\x20starting\x20service:\x20','\x20attempts).\x20Expected:\x20Find\x20[',']\x20Deleted\x20device\x20config','Couldn\x27t\x20get\x20HD\x20Screen\x20state\x20not\x20found','getSession','charWhitelist','\x20on\x20device\x20','Error\x20sending\x20WebSocket\x20request:\x20','ACB\x20executeTransferWithQRCode','waitingQueue',']\x20Error\x20getting\x20lock:\x20','WithdrawalStatus','PASSWORD_FIELD','Available\x20Amount\x20là\x20bắt\x20buộc\x20và\x20phải\x20>=\x200\x20khi\x20status\x20là\x20active'];a0_0x1016=function(){return _0x201e1c;};return a0_0x1016();}
//# sourceMappingURL=main.js.map
//# sourceMappingURL=main.js.map