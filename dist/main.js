function a0_0x2823(_0x73050d,_0x50caa4){_0x73050d=_0x73050d-0x131;const _0x234aa7=a0_0x234a();let _0x2823ac=_0x234aa7[_0x73050d];return _0x2823ac;}function a0_0x234a(){const _0xef2d31=['BANK_SEARCH_INPUT','AcbService','Error\x20extracting\x20transaction\x20amount:\x20','\x20does\x20not\x20have\x20valid\x20session\x20for\x20bank\x20','K82766678488957','maxWidth','eval','testLaunchApp','stopService','getWaitingCount','env','getDeviceConfig','Text\x20input\x20completed\x20on\x20device\x20','OCRService','End\x20X\x20coordinate\x20for\x20HC\x20(required\x20for\x20HC:\x200-1)','analyzedStatus','apiKey','pgService','OCR_ROI_SINGLE_Y','Pressing\x20shift\x20key\x20on\x20device\x20','\x20error:\x20','boxType','randomUUID','withdrawalId','promote',':config','REDIS_LOCK_PREFIX','isDestroyed','SessionManagementService','Post','hset','errorType','postprocess','\x20available\x20devices.\x20Picking\x20','worker','ms\x20(','__decorate','HttpException','\x20as\x20logging\x20in',']\x20-\x20Clicking\x20transfer\x20external\x20button\x20at\x20coordinates\x20(','Param','queue/stats','message','\x20to\x20device(s)\x20','login:','normalizeBankAccountName','waitForWorker','Assigned\x20device\x20','del','chuyá»ƒn\x20tiá»n\x20liÃªn\x20ngÃ¢n\x20hÃ ng','IsString','ApiOperation','function','ocrConfig','startApp','unlink','getDevicesPage','\x20as\x20completed','AppModule','recognizeFromFile',':\x20x\x20and\x20y\x20are\x20required','stack','validateROI','launchApp','\x20when\x20uploading\x20bill\x20for\x20withdrawal\x20','IWebSocketService','Invalid\x20type.\x20Type\x20must\x20be\x20one\x20of:\x200\x20(æŒ‰ä¸‹/press),\x201\x20(æŠ¬èµ·/lift),\x202\x20(ç§»åŠ¨/move),\x204\x20(æ»šè½®å‘ä¸Š/scroll\x20up),\x205\x20(æ»šè½®å‘ä¸‹/scroll\x20down),\x206\x20(ä¸Šæ»‘/swipe\x20up),\x207\x20(ä¸‹æ»‘/swipe\x20down),\x208\x20(å·¦æ»‘/swipe\x20left),\x209\x20(å³æ»‘/swipe\x20right),\x2010\x20(ç‚¹å‡»/click)','default','Unexpected\x20status\x20code\x20','ACB\x20executeTransferWithQRCode','opts','filter','extract','WebSocket\x20error:\x20','WebSocket\x20request\x20timeout','Received\x20response\x20but\x20no\x20pending\x20requests:\x20','ACB','wsService','WithdrawalProcessingError','folderCreationInProgress','BANK_SEARCH_BTN','getClient','getSession','deviceService','ROI\x20extends\x20beyond\x20image:\x20x(',']\x20-\x20Get\x20back\x20to\x20home\x20screen','Pressing\x20shift\x20key\x20for\x20uppercase\x20letter\x20\x27','ROI','List\x20of\x20devices\x20retrieved\x20successfully','\x20after\x20','OCRModule','setnx','lang','REDIS_PROCESSED_PREFIX','withdrawalService','maxReconnectAttempts','pool','__param','markAsProcessing','EZZPAY_BE','Image\x20preprocessing\x20error:\x20','742728tNDvOP','SessionRefreshScheduler','],\x20Unexpected:\x20[','\x20created\x20successfully',',\x20x=','Error\x20marking\x20withdrawal\x20','Scheduling\x20reconnect\x20attempt\x20','256LLRtiB','executeTransfer','includes','\x20(must\x20be\x200-1)','omit','log','HIDE_NUMPAD_BTN','lastUsed','8376434gkYBfx','disconnect','Testing\x20Panda\x20swipe\x20on\x20device:\x20','Test\x20inputting\x20text\x20using\x20keyboard\x20layout\x20on\x20a\x20device','RETURN_KEY','\x20when\x20updating\x20withdrawal\x20','startService','bankCode','SELECT_IMAGE_QR_CODE_BTN','getRefreshBeforeTime','toLowerCase','withdrawalCode','delete','Test\x20launching\x20bank\x20app\x20on\x20a\x20device','pickAndProcessJobs','\x20at\x20coordinates\x20(','mkdir','Invalid\x20ROI\x20x:\x20','withdrawalQueue','full','BAD_REQUEST','mÃ£\x20xÃ¡c\x20thá»±c','response','PANDA','logger','UNKNOWN','endX','WithdrawalService','height','254235sEbOwD','receipt','createQRCodeAndTransferTo','Failed\x20to\x20update\x20withdrawal\x20','preprocess','readdir','\x20terminated','BUNDLE_ID','27RIXDdY','\x20for\x20bank:\x20','promoteDelayedJobs','\x20-\x20','rois','ðŸŒ\x20Device\x20management:\x20http://localhost:','code','BVBANK','getAvailableDevices','Service\x20stopped\x20successfully','INTERNAL_AMOUNT_INPUT','debug','ApiParam','\x20on\x20device\x20','Error\x20processing\x20withdrawal\x20','listDevices','splice','sleep','pendingRequests','setBaseViewsDir','Cleared\x20session\x20for\x20device\x20','createWorker','sessionManagement','bank','some','Panda\x20swipe\x20completed\x20successfully\x20on\x20device\x20','Swipe\x20completed\x20successfully','imagePreprocessingService','tiáº¿t\x20kiá»‡m','acbService','initializationPromise','hcBoxService','WithdrawalController','inputText','device:lock:','isInitializing','folderCreated','LOGIN_BTN','Text\x20input\x20completed\x20successfully\x20on\x20device\x20','acquireLock','Smart\x20OTP\x20lÃ \x20báº¯t\x20buá»™c\x20khi\x20status\x20lÃ \x20active','waiting','reject','TRANSACTION_CONFIRM','design:returntype','FORCE_KILL_APP','Image\x20quality\x20(0-1,\x20default:\x200.5)','DeviceService','set','findIndex','Failed\x20to\x20terminate\x20temporary\x20worker:\x20','withdrawal-request-','parse','trang\x20chá»§','REDIS_SESSION_PREFIX','testInputText','Panda\x20BOX\x20error:\x20','accountNo','number','size','object','queue/start','http://localhost:3001','Clicking\x20login\x20button\x20on\x20device\x20','OCR_WHITELIST_SINGLE','testInputNumpadNumber','createTemporaryWorker','SAIGONBANK','releaseWorker','scaleCoordinates','Queue','/4):\x20','getOwnPropertyDescriptor','design:paramtypes','terminateAll','png',']\x20-\x20Clicking\x20close\x20allow\x20contact\x20popup\x20button\x20at\x20coordinates\x20(','clickAndWaitForScreen','forwardRef','WEBSOCKET_SERVICE','analyzeTransferBill','Could\x20not\x20parse\x20amount\x20from\x20OCR\x20text:\x20','DeviceLockService','clickWithTransition','ezpayBe','max','device','setServiceStatus','length','logged_in','click','PASSWORD_FIELD','triggerPickJobs','deductDeviceAmount','otp','error','Error\x20logging\x20in\x20all\x20active\x20banks:\x20','push','views','/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3','.\x20Must\x20be\x20\x27HC\x27\x20or\x20\x27PANDA\x27','executeInternalTransfer','\x20is\x20not\x20active.\x20Please\x20activate\x20the\x20device\x20first.','BACK_TO_HOME','periodicJobPicking','\x20as\x20completed:\x20','HcBoxService','exports',']\x20-\x20Clicking\x20account\x20number\x20field\x20at\x20coordinates\x20(','PVCOMBANK','__esModule','floor','Connecting\x20to\x20Panda\x20BOX\x20WebSocket:\x20','\x20not\x20supported,\x20cannot\x20analyze\x20transfer\x20bill','BaseBankService','classifyError','toLocaleString','Y\x20coordinate\x20(Hc:\x200-1),\x20Panda:\x200-100','SEABANK','process-withdrawal-request','getPoolStats','TRANSACTION_VERIFY','notifyEzpayBe','inputNumpadNumber','getBillImage','addTag','zrangebyscore','15ukIpok','HttpModule','keys','FORCE_LOGIN',',\x20Requested:\x20','\x20is\x20already\x20being\x20processed\x20by\x20another\x20instance','WebSocketModule','smartOTP','\x20is\x20already\x20locked,\x20cannot\x20acquire\x20lock','stringify','ocrService','switchKeyboardMode','beneficiaryAccountNo','ACCOUNT_NUMBER_INPUT',']\x20-\x20Get\x20login\x20app\x20screen','login','found','Error\x20testing\x20numpad\x20number\x20input:\x20','wda-request','home','expiresAt',',\x20Timeout:\x20','QR_CODE_BTN',',\x20Retrying\x20in\x20','startProcessing','pressShiftKey','maxPoolSize','OCR_POOL_SIZE\x20(','send','buffer','processingJobs','entries','handleMessage','transferCode','):\x20','PandaWebSocketService',',\x20bank\x20','ms)',')\x20>\x201',',\x20lang:\x20','getQueueStats','No\x20OCR\x20result\x20found\x20for\x20','postprocessText','substring','createTransactionFolder','mtimeMs','getBankService','Cron','inputSmartOTPFromConfig','Injectable','reconnectAttempts','design:type','waitingQueue','isSpecialCharInNumberMode','Module','map','min','Get','No\x20receipt\x20path\x20provided\x20for\x20withdrawal\x20','screenFile','HcBoxModule','BankService','isProcessingRequest','killApp','Get\x20list\x20of\x20available\x20devices','confirm','normalize','HC\x20BOX\x20WebSocket\x20connected','text','Failed\x20to\x20acquire\x20lock\x20for\x20device\x20','getFailedCount','_id','__metadata','VPBANK',']\x20-\x20Get\x20Transaction\x20confirm\x20screen','Password\x20not\x20configured\x20for\x20device\x20','Screen\x20captured\x20successfully','psm','\x20(swipe\x20direction,\x20no\x20coordinates)','refreshSessionIfNeeded',')\x20+\x20width(','Render','ROI:\x20x=','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\x20.-','active','715180HMBKPJ','1200',']\x20-\x20Get\x20Verified\x20account\x20name\x20screen','Retry\x20login\x20requested\x20for\x20device\x20','decorate','toUpperCase','get','Available\x20Amount\x20must\x20be\x20greater\x20than\x20or\x20equal\x20to\x200','redisClient','HttpStatus','swipe','list','now','defineProperty','unexpectedly\x20locked','getROIConfig','random','promoteDelayedJobsPeriodically','OCR\x20service\x20is\x20shutting\x20down','scheduleReconnect','baseTransactionFolderPath','\x20not\x20found\x20or\x20not\x20configured','Connecting\x20to\x20HC\x20BOX\x20WebSocket:\x20','extractTransactionAmount','800','Error\x20logging\x20in\x20on\x20device\x20','jobManagerService','triggerJobPicking','Failed\x20to\x20upload\x20bill\x20for\x20withdrawal\x20','BAC','setex','FIRST_IMAGE_BTN','setParameters','redisService','pressReturnKey','requestQueue','PERMANENT','Testing\x20screen\x20capture\x20on\x20device:\x20','CONTINUE_TRANSFER_BTN','OCRWorkerPoolService','Test\x20screen\x20capture\x20on\x20a\x20device','VIET\x20A\x20BANK','Bank\x20operations','refreshSessions',']\x20-\x20Clicking\x20transfer\x20button\x20at\x20coordinates\x20(','open','PGBANK','getSessionTimeout','isAcquiring','captureScreen','Full\x20screen','EzPay\x20Auto\x20API','hasActiveDevice','BankController','poolSize','PG_ROI_EXPECTED','device:','sendRequest','PORT','586826cOfnEb','Password\x20lÃ \x20báº¯t\x20buá»™c\x20khi\x20status\x20lÃ \x20active','ejs',':meta','Query','prototype','chuyá»ƒn\x20tiá»n','inputPasswordFromConfig','Failed\x20to\x20create\x20worker\x20','PgService','isConnected','checkIfProcessed','manualRetryCount','unknown','terminate','PG_UI_COORDINATES','logging_in','executeTransferWithQRCode','OCR_ROI_SINGLE_WIDTH',']\x20-\x20Clicking\x20continue\x20transfer\x20button\x20at\x20coordinates\x20(','Failed\x20to\x20login\x20to\x20PGBank','%,\x20time:\x20','serial','accountName','Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)','TRANSFER_INTERNAL_BTN','reconnecting','ErrorType','toFixed','transferFile','getBillImagePath','onModuleDestroy',').\x20Using\x20','width','ImagePreprocessingService','base64','/4)','ÄÄƒng\x20nháº­p','udid','Device\x20ID','deactive','confidence','wsUrl','Successfully\x20uploaded\x20bill\x20for\x20withdrawal\x20','WithdrawalJobManagerService','TRANSFER_EXTERNAL_BTN','Inject','Registered\x20bank\x20service:\x20','close','\x20lock\x20for\x20device\x20','Return\x20key\x20pressed\x20successfully\x20on\x20device\x20','ms\x20>\x201000ms\x20(p95\x20target)','matchedTexts','metadata','Manually\x20start\x20job\x20processing','createDocument','DeviceController','devices','replace','ApiResponse','Worker\x20','\x20device(s)','connect','App\x20launched\x20successfully','WithdrawalModule','Logging\x20in\x20to\x20','\x20by\x20','TEMPORARY','expire','ocr','zrange','allSettled','join','PreprocessOptions','deviceId','IsNotEmpty','Error\x20getting\x20session\x20for\x20device\x20','sourceAccountNo','TRANSFER_BTN','DeviceModule','warn','\x20(attempt\x20','isArray','Invalid\x20coordinates.\x20x,\x20y,\x20endX,\x20and\x20endY\x20must\x20be\x20numbers\x20between\x200\x20and\x201\x20for\x20HC','temporary','api/service/start','KEYBOARD_LAYOUT','Controller','catch','doWarmPool','UpdateDeviceConfigDto','Screen\x20capture\x20name\x20(optional)','ceil','withCronLock','Successfully\x20processed\x20withdrawal:\x20','markAsFailed','Bank\x20Code\x20lÃ \x20báº¯t\x20buá»™c\x20khi\x20status\x20lÃ \x20active','REDIS_DEVICE_CONFIG_SUFFIX','bankService','\x20as\x20processing:\x20','testPressReturn','getDevices','sismember','toISOString','HC\x20BOX\x20WebSocket\x20closed','/test/swipe/{deviceId}?type=0','maxWaitTime','RedisService','trim','patch','AGRIBANK','1jXVxkC','password','Error\x20starting\x20job\x20processing:\x20','Invalid\x20box\x20type\x20configuration:\x20','round','production','testClickAtCoordinates','releaseLock','Bank\x20Code\x20is\x20required\x20when\x20status\x20is\x20active','data','endY','NUMPAD_LAYOUT','ValidateIf','REDIS_DEVICE_CONFIG_PREFIX','processRequestQueue','181013XdELGG','status','\x20is\x20being\x20processed\x20by\x20another\x20instance','Numpad\x20number\x20input\x20completed\x20successfully','WithdrawalJobManagerService\x20initialized,\x20waiting\x205\x20seconds\x20before\x20starting...',')\x20with\x20lockId\x20','Switching\x20keyboard\x20mode\x20on\x20device\x20','getServiceStatus','Device\x20','redis','BANK_CODE','timeout','updateDeviceConfig','Testing\x20','EXTERNAL_AMOUNT_INPUT','X\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100).\x20Required\x20for\x20HC\x20and\x20Panda\x20types\x200,1,2,10.\x20Optional\x20for\x20Panda\x20types\x204,5,6,7,8,9','COMMON_COORDINATES','\x22\x20on\x20device:\x20','unauthorized','ACB_UI_COORDINATES','deviceLock','ocrRecognize','resolve','ApiQuery','baseTransactionExecutionFolder','apiUrl','6888','.\x20Error\x20Type:\x20','executeExternalTransfer','releaseLockByType','logTimingBreakdown','completed','getSupportedBanks','2820774WNUqil','Withdrawal\x20','OCR_MAX_WIDTH_BLOCK','_sendRequestOnce','Clicking\x20key\x20\x27','toString','Tesseract\x20worker\x20','Test\x20clicking\x20at\x20specific\x20coordinates\x20on\x20a\x20device','delayed','test-screen-capture-','\x20already\x20completed','all','getLock',']\x20-\x20Clicking\x20account\x20number\x20input\x20field\x20at\x20coordinates\x20(','availableAmount',']\x20-\x20Clicking\x20amount\x20input\x20field\x20at\x20coordinates\x20(','session','Logger','folderPath','C:/EasyTrx','decodeImage','config','/api/internal/withdrawals/upload-receipt/','inactive','Error\x20parsing\x20WebSocket\x20message:\x20','loginAllActiveBanks','HC_PG_BANK_SEARCH_UI_COORDINATES','firstValueFrom'];a0_0x234a=function(){return _0xef2d31;};return a0_0x234a();}(function(_0x344dd0,_0x444597){const _0x561c2a=a0_0x2823,_0x52bc50=_0x344dd0();while(!![]){try{const _0x2ffa0b=parseInt(_0x561c2a(0x253))/0x1*(parseInt(_0x561c2a(0x1e4))/0x2)+parseInt(_0x561c2a(0x330))/0x3+-parseInt(_0x561c2a(0x304))/0x4*(parseInt(_0x561c2a(0x154))/0x5)+parseInt(_0x561c2a(0x283))/0x6+-parseInt(_0x561c2a(0x262))/0x7*(parseInt(_0x561c2a(0x30b))/0x8)+parseInt(_0x561c2a(0x338))/0x9*(parseInt(_0x561c2a(0x1a9))/0xa)+parseInt(_0x561c2a(0x313))/0xb;if(_0x2ffa0b===_0x444597)break;else _0x52bc50['push'](_0x52bc50['shift']());}catch(_0x368214){_0x52bc50['push'](_0x52bc50['shift']());}}}(a0_0x234a,0x6b5f9),((()=>{'use strict';var _0x576df9=[,_0x23edeb=>{_0x23edeb['exports']=require('@nestjs/core');},_0x4ffc55=>{_0x4ffc55['exports']=require('@nestjs/common');},_0x4ab975=>{_0x4ab975['exports']=require('@nestjs/swagger');},_0x560454=>{_0x560454['exports']=require('path');},function(_0x425735,_0x4162cb,_0x413ded){const _0x1842e7=a0_0x2823;var _0x560762=this&&this['__decorate']||function(_0x103df2,_0x301700,_0x57846c,_0x433786){const _0x322fec=a0_0x2823;var _0x9ed5d6,_0x337c0e=arguments['length'],_0x8de12d=_0x337c0e<0x3?_0x301700:null===_0x433786?_0x433786=Object['getOwnPropertyDescriptor'](_0x301700,_0x57846c):_0x433786;if(_0x322fec(0x374)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x8de12d=Reflect['decorate'](_0x103df2,_0x301700,_0x57846c,_0x433786);else{for(var _0x173094=_0x103df2['length']-0x1;_0x173094>=0x0;_0x173094--)(_0x9ed5d6=_0x103df2[_0x173094])&&(_0x8de12d=(_0x337c0e<0x3?_0x9ed5d6(_0x8de12d):_0x337c0e>0x3?_0x9ed5d6(_0x301700,_0x57846c,_0x8de12d):_0x9ed5d6(_0x301700,_0x57846c))||_0x8de12d);}return _0x337c0e>0x3&&_0x8de12d&&Object['defineProperty'](_0x301700,_0x57846c,_0x8de12d),_0x8de12d;};Object['defineProperty'](_0x4162cb,'__esModule',{'value':!0x0}),_0x4162cb[_0x1842e7(0x2d9)]=void 0x0;const _0x28387c=_0x413ded(0x2),_0x72bf32=_0x413ded(0x6),_0x17549b=_0x413ded(0x7),_0x49fdfa=_0x413ded(0x8),_0x5aea37=_0x413ded(0x9),_0x3a7554=_0x413ded(0x33),_0x4861a9=_0x413ded(0x34),_0x4d6f22=_0x413ded(0x16),_0x57137a=_0x413ded(0x3a),_0x5a9f49=_0x413ded(0xf),_0x298446=_0x413ded(0x38),_0x3e8d9a=_0x413ded(0x3f);let _0x323b40=class{};_0x4162cb['AppModule']=_0x323b40,_0x4162cb[_0x1842e7(0x2d9)]=_0x323b40=_0x560762([(0x0,_0x28387c['Module'])({'imports':[_0x72bf32['BullModule']['forRoot']({'redis':{'host':_0x5a9f49['config'][_0x1842e7(0x26b)]['host'],'port':_0x5a9f49['config']['redis']['port'],'db':_0x5a9f49['config'][_0x1842e7(0x26b)]['db'],'password':_0x5a9f49['config']['redis']['password']},'defaultJobOptions':{'removeOnComplete':0xa,'removeOnFail':0x32,'attempts':0x3,'backoff':{'type':'exponential','delay':0x7d0}}}),_0x17549b['ScheduleModule']['forRoot'](),_0x49fdfa['HttpModule'],_0x5aea37[_0x1842e7(0x224)],_0x3a7554['HcBoxModule'],_0x4861a9['DeviceModule'],_0x57137a['WebSocketModule'],_0x298446['BankModule'],_0x3e8d9a['OCRModule']],'providers':[_0x4d6f22[_0x1842e7(0x24f)]],'exports':[_0x4d6f22[_0x1842e7(0x24f)]]})],_0x323b40);},_0xe56332=>{const _0x292d26=a0_0x2823;_0xe56332[_0x292d26(0x140)]=require('@nestjs/bull');},_0x199853=>{_0x199853['exports']=require('@nestjs/schedule');},_0x14301f=>{_0x14301f['exports']=require('@nestjs/axios');},function(_0x348156,_0x1f22bb,_0x1aa1c1){const _0x28e238=a0_0x2823;var _0x369390=this&&this['__decorate']||function(_0x3027a4,_0x4c31f4,_0x4ef009,_0x4a853e){const _0x130904=a0_0x2823;var _0x3f5b0a,_0x20e884=arguments['length'],_0x20fcfc=_0x20e884<0x3?_0x4c31f4:null===_0x4a853e?_0x4a853e=Object['getOwnPropertyDescriptor'](_0x4c31f4,_0x4ef009):_0x4a853e;if('object'==typeof Reflect&&_0x130904(0x2d3)==typeof Reflect['decorate'])_0x20fcfc=Reflect[_0x130904(0x1ad)](_0x3027a4,_0x4c31f4,_0x4ef009,_0x4a853e);else{for(var _0x42e363=_0x3027a4['length']-0x1;_0x42e363>=0x0;_0x42e363--)(_0x3f5b0a=_0x3027a4[_0x42e363])&&(_0x20fcfc=(_0x20e884<0x3?_0x3f5b0a(_0x20fcfc):_0x20e884>0x3?_0x3f5b0a(_0x4c31f4,_0x4ef009,_0x20fcfc):_0x3f5b0a(_0x4c31f4,_0x4ef009))||_0x20fcfc);}return _0x20e884>0x3&&_0x20fcfc&&Object['defineProperty'](_0x4c31f4,_0x4ef009,_0x20fcfc),_0x20fcfc;};Object[_0x28e238(0x1b6)](_0x1f22bb,'__esModule',{'value':!0x0}),_0x1f22bb['WithdrawalModule']=void 0x0;const _0x3e00ec=_0x1aa1c1(0x2),_0x518e63=_0x1aa1c1(0x6),_0x331a14=_0x1aa1c1(0x7),_0x3bcf03=_0x1aa1c1(0xa),_0xb125aa=_0x1aa1c1(0x2e),_0x3843c8=_0x1aa1c1(0x32),_0x49b949=_0x1aa1c1(0xb),_0x458226=_0x1aa1c1(0x16),_0x52c33f=_0x1aa1c1(0x33),_0x4f10ce=_0x1aa1c1(0x34),_0x4f3395=_0x1aa1c1(0x38),_0x396b68=_0x1aa1c1(0x8);let _0xfaa41d=class{};_0x1f22bb[_0x28e238(0x224)]=_0xfaa41d,_0x1f22bb['WithdrawalModule']=_0xfaa41d=_0x369390([(0x0,_0x3e00ec[_0x28e238(0x18a)])({'imports':[_0x518e63['BullModule']['registerQueue']({'name':'wda-request'}),_0x331a14['ScheduleModule'],_0x52c33f['HcBoxModule'],(0x0,_0x3e00ec[_0x28e238(0x386)])(()=>_0x4f10ce[_0x28e238(0x233)]),_0x4f3395['BankModule'],_0x396b68[_0x28e238(0x155)]],'controllers':[_0x3843c8['WithdrawalController']],'providers':[_0x3bcf03['WithdrawalService'],_0xb125aa[_0x28e238(0x210)],_0x49b949['EzpayBeClientService'],_0x458226['RedisService']],'exports':[_0x3bcf03['WithdrawalService']]})],_0xfaa41d);},function(_0x26234a,_0x15297e,_0x3850e4){const _0x52ddf9=a0_0x2823;var _0x1dae64,_0x39ecdc,_0x52e629,_0xc56198,_0x103037,_0x5003fc,_0x56c5bd=this&&this[_0x52ddf9(0x2c3)]||function(_0x1f8266,_0x5a94a0,_0x407d2a,_0x580269){const _0x443b57=_0x52ddf9;var _0x1569e5,_0x2b62f4=arguments['length'],_0x374d27=_0x2b62f4<0x3?_0x5a94a0:null===_0x580269?_0x580269=Object['getOwnPropertyDescriptor'](_0x5a94a0,_0x407d2a):_0x580269;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x443b57(0x1ad)])_0x374d27=Reflect['decorate'](_0x1f8266,_0x5a94a0,_0x407d2a,_0x580269);else{for(var _0x40c4d0=_0x1f8266['length']-0x1;_0x40c4d0>=0x0;_0x40c4d0--)(_0x1569e5=_0x1f8266[_0x40c4d0])&&(_0x374d27=(_0x2b62f4<0x3?_0x1569e5(_0x374d27):_0x2b62f4>0x3?_0x1569e5(_0x5a94a0,_0x407d2a,_0x374d27):_0x1569e5(_0x5a94a0,_0x407d2a))||_0x374d27);}return _0x2b62f4>0x3&&_0x374d27&&Object[_0x443b57(0x1b6)](_0x5a94a0,_0x407d2a,_0x374d27),_0x374d27;},_0x2061bf=this&&this['__metadata']||function(_0x2ef14b,_0xa6c00){const _0x3fac42=_0x52ddf9;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x3fac42(0x219)])return Reflect[_0x3fac42(0x219)](_0x2ef14b,_0xa6c00);},_0x588a63=this&&this['__param']||function(_0x364faf,_0x3d21c8){return function(_0x3036c,_0x12e215){_0x3d21c8(_0x3036c,_0x12e215,_0x364faf);};};Object['defineProperty'](_0x15297e,_0x52ddf9(0x143),{'value':!0x0}),_0x15297e['WithdrawalService']=void 0x0;const _0xef1588=_0x3850e4(0x2),_0x22239f=_0x3850e4(0xb),_0x1a8a59=_0x3850e4(0x12),_0xba1173=_0x3850e4(0x15),_0x11fc5e=_0x3850e4(0x2c),_0xa51ecb=_0x3850e4(0x16),_0x486c2c=_0x3850e4(0x14),_0x21bc47=_0x3850e4(0x19),_0x19dfb8=_0x3850e4(0x2a);let _0x5e3fbe=class{constructor(_0x35ef91,_0x271f8e,_0x2ebd55,_0x3c2c10,_0x6aa7aa,_0x48b4f8){const _0x12c205=_0x52ddf9;this['ezpayBeClient']=_0x35ef91,this['wsService']=_0x271f8e,this['bankService']=_0x2ebd55,this['deviceService']=_0x3c2c10,this['deviceLock']=_0x6aa7aa,this['redisService']=_0x48b4f8,this['logger']=new _0xef1588['Logger'](_0x12c205(0x32e)),this[_0x12c205(0x2fc)]='withdrawal:processed:',this['PROCESSING_TTL']=0xf731400,this['COMPLETED_TTL']=0xf731400;}async[_0x52ddf9(0x1ef)](_0xc4f00c){const _0xbc1f5f=_0x52ddf9;try{const _0x6c7523=''+this['REDIS_PROCESSED_PREFIX']+_0xc4f00c,_0x1a018c=await this['redisService']['get'](_0x6c7523);return _0xbc1f5f(0x281)===_0x1a018c?(this['logger'][_0xbc1f5f(0x234)]('Withdrawal\x20'+_0xc4f00c+_0xbc1f5f(0x28d)),!0x0):'processing'===_0x1a018c&&(this[_0xbc1f5f(0x32b)]['warn']('Withdrawal\x20'+_0xc4f00c+_0xbc1f5f(0x264)),!0x0);}catch(_0x266c95){return this[_0xbc1f5f(0x32b)]['error']('Error\x20checking\x20processed\x20status\x20for\x20'+_0xc4f00c+':\x20'+_0x266c95['message']),!0x1;}}async[_0x52ddf9(0x301)](_0x4d5c68){const _0x325229=_0x52ddf9;try{const _0x353838=''+this['REDIS_PROCESSED_PREFIX']+_0x4d5c68;return'OK'===await this['redisService'][_0x325229(0x2fa)](_0x353838,'processing',this['PROCESSING_TTL'])?(this['logger']['debug']('Marked\x20withdrawal\x20'+_0x4d5c68+'\x20as\x20processing'),!0x0):(this['logger'][_0x325229(0x234)](_0x325229(0x284)+_0x4d5c68+_0x325229(0x159)),!0x1);}catch(_0x1cf3ea){return this['logger']['error']('Error\x20marking\x20withdrawal\x20'+_0x4d5c68+_0x325229(0x247)+_0x1cf3ea['message']),!0x0;}}async['markAsCompleted'](_0x381e21){const _0x331a7b=_0x52ddf9;try{const _0x432729=''+this['REDIS_PROCESSED_PREFIX']+_0x381e21;await this['redisService']['set'](_0x432729,_0x331a7b(0x281),this['COMPLETED_TTL']),this['logger']['log']('Marked\x20withdrawal\x20'+_0x381e21+_0x331a7b(0x2d8));}catch(_0x1fc696){this['logger'][_0x331a7b(0x134)](_0x331a7b(0x309)+_0x381e21+_0x331a7b(0x13e)+_0x1fc696[_0x331a7b(0x2c9)]);}}async['markAsFailed'](_0xd1d86d){const _0xeb779e=_0x52ddf9;try{const _0x10ffd0=''+this['REDIS_PROCESSED_PREFIX']+_0xd1d86d;await this['redisService']['del'](_0x10ffd0),this['logger']['log']('Marked\x20withdrawal\x20'+_0xd1d86d+'\x20as\x20failed\x20(removed\x20from\x20processed\x20list)');}catch(_0xb6c9f8){this[_0xeb779e(0x32b)]['error'](_0xeb779e(0x309)+_0xd1d86d+'\x20as\x20failed:\x20'+_0xb6c9f8['message']);}}async['processWithdrawal'](_0xcb9d9,_0x533533){const _0x387bed=_0x52ddf9,{withdrawalId:_0x1406e7,bankCode:_0x2ee897,amount:_0x5bb66c}=_0xcb9d9;if(await this['checkIfProcessed'](_0x1406e7))return void this['logger']['warn']('Withdrawal\x20'+_0x1406e7+'\x20already\x20processed\x20or\x20being\x20processed,\x20skipping');if(!await this['markAsProcessing'](_0x1406e7)){const _0x3292c5=_0x387bed(0x284)+_0x1406e7+_0x387bed(0x264);throw this['logger'][_0x387bed(0x234)](_0x3292c5),new _0x19dfb8['WithdrawalProcessingError'](_0x3292c5,_0x19dfb8['ErrorType'][_0x387bed(0x227)],_0x1406e7);}let _0x43d298=!0x0,_0x393242=!0x1;try{this['logger']['log']('Processing\x20withdrawal:\x20'+_0x1406e7+_0x387bed(0x339)+_0x2ee897+',\x20amount:\x20'+_0x5bb66c+'\x20on\x20assigned\x20device:\x20'+_0x533533);const _0x20b5ec=await this['deviceService']['getDeviceConfig'](_0x533533);if(!_0x20b5ec||'active'!==_0x20b5ec['status']){const _0x5e78d4='Assigned\x20device\x20'+_0x533533+'\x20is\x20not\x20active\x20or\x20not\x20found';throw this[_0x387bed(0x32b)]['error'](_0x5e78d4),await this[_0x387bed(0x243)](_0x1406e7),_0x43d298=!0x1,new _0x19dfb8[(_0x387bed(0x2ed))](_0x5e78d4,_0x19dfb8['ErrorType']['TEMPORARY'],_0x1406e7);}if(_0x20b5ec['availableAmount']<_0x5bb66c){const _0x427c69='Assigned\x20device\x20'+_0x533533+'\x20has\x20insufficient\x20amount.\x20Available:\x20'+_0x20b5ec['availableAmount']+',\x20Required:\x20'+_0x5bb66c;throw this['logger'][_0x387bed(0x134)](_0x427c69),await this[_0x387bed(0x243)](_0x1406e7),_0x43d298=!0x1,await this['deviceService'][_0x387bed(0x26e)](_0x533533,{'status':_0x387bed(0x20c)}),new _0x19dfb8['WithdrawalProcessingError'](_0x427c69,_0x19dfb8['ErrorType'][_0x387bed(0x227)],_0x1406e7);}if(!await this[_0x387bed(0x246)]['isSessionValid'](_0x533533,_0x20b5ec['bankCode'])){const _0x9de75b=_0x387bed(0x2ce)+_0x533533+_0x387bed(0x2a2)+_0x20b5ec['bankCode'];throw this['logger']['error'](_0x9de75b),await this['markAsFailed'](_0x1406e7),_0x43d298=!0x1,new _0x19dfb8['WithdrawalProcessingError'](_0x9de75b,_0x19dfb8['ErrorType'][_0x387bed(0x227)],_0x1406e7);}const _0x4acec4=_0x533533;await this[_0x387bed(0x246)][_0x387bed(0x1f5)](_0xcb9d9,_0x20b5ec,_0x20b5ec['bankCode']),this[_0x387bed(0x2f2)]['deductDeviceAmount'](_0x4acec4,_0x5bb66c)[_0x387bed(0x23c)](()=>{}),await this['markAsCompleted'](_0x1406e7),_0x393242=!0x0,_0x43d298=!0x1;const _0x98fe5e=await this[_0x387bed(0x246)]['analyzeTransferBill'](_0x20b5ec['bankCode'],_0xcb9d9);this['notifyEzpayBe'](_0xcb9d9,_0x98fe5e,_0x20b5ec)[_0x387bed(0x23c)](()=>{}),_0x387bed(0x1f1)===_0x98fe5e['analyzedStatus']&&await this['bankService']['login'](_0x20b5ec['bankCode'],_0x4acec4,!0x0),this[_0x387bed(0x32b)]['log'](_0x387bed(0x242)+_0x1406e7);}catch(_0x1a727a){if(_0x1a727a instanceof _0x19dfb8['WithdrawalProcessingError'])throw _0x1a727a;throw this['logger']['error'](_0x387bed(0x346)+_0x1406e7+':\x20'+_0x1a727a['message'],_0x1a727a[_0x387bed(0x2dc)]),await this['markAsFailed'](_0x1406e7),_0x43d298=!0x1,new _0x19dfb8[(_0x387bed(0x2ed))](_0x1a727a['message']||'Unknown\x20error',_0x19dfb8[_0x387bed(0x1ff)]['UNKNOWN'],_0x1406e7);}finally{await this['deviceLock']['releaseLock'](_0x533533),_0x43d298&&!_0x393242&&await this['markAsFailed'](_0x1406e7);}}async[_0x52ddf9(0x14f)](_0x56667e,_0x1da257,_0x4642a6){const _0x4f9d82=_0x52ddf9;this['ezpayBeClient']['updateWithdrawalStatus'](_0x56667e[_0x4f9d82(0x19b)],{'analyzedStatus':_0x1da257['analyzedStatus'],'sourceAccountNo':_0x4642a6[_0x4f9d82(0x371)],'sourceBankCode':_0x4642a6['bankCode'],'sourceAccountName':_0x4642a6[_0x4f9d82(0x1fb)]})['catch'](_0x1c8994=>{const _0x3d6a2e=_0x4f9d82;this['logger']['error']('['+_0x56667e['withdrawalCode']+']\x20-\x20Error\x20updating\x20withdrawal\x20status\x20for\x20'+_0x56667e[_0x3d6a2e(0x19b)]+'\x20-\x20'+_0x1c8994['stack']);}),this['ezpayBeClient']['uploadReceipt'](_0x56667e['_id'],_0x1da257['rawPath'])['catch'](_0x57e127=>{const _0x5b9ea6=_0x4f9d82;this[_0x5b9ea6(0x32b)]['error']('['+_0x56667e['withdrawalCode']+']\x20-\x20Error\x20uploading\x20receipt\x20for\x20'+_0x56667e[_0x5b9ea6(0x19b)]+_0x5b9ea6(0x33b)+_0x57e127['stack']);});}};_0x15297e['WithdrawalService']=_0x5e3fbe,_0x15297e['WithdrawalService']=_0x5e3fbe=_0x56c5bd([(0x0,_0xef1588['Injectable'])(),_0x588a63(0x1,(0x0,_0xef1588['Inject'])(_0x486c2c['WEBSOCKET_SERVICE'])),_0x588a63(0x3,(0x0,_0xef1588['Inject'])((0x0,_0xef1588[_0x52ddf9(0x386)])(()=>_0xba1173[_0x52ddf9(0x367)]))),_0x2061bf(_0x52ddf9(0x381),['function'==typeof(_0x1dae64=void 0x0!==_0x22239f['EzpayBeClientService']&&_0x22239f['EzpayBeClientService'])?_0x1dae64:Object,'function'==typeof(_0x39ecdc=void 0x0!==_0x21bc47['IWebSocketService']&&_0x21bc47['IWebSocketService'])?_0x39ecdc:Object,'function'==typeof(_0x52e629=void 0x0!==_0x1a8a59['BankService']&&_0x1a8a59['BankService'])?_0x52e629:Object,'function'==typeof(_0xc56198=void 0x0!==_0xba1173['DeviceService']&&_0xba1173['DeviceService'])?_0xc56198:Object,'function'==typeof(_0x103037=void 0x0!==_0x11fc5e['DeviceLockService']&&_0x11fc5e['DeviceLockService'])?_0x103037:Object,'function'==typeof(_0x5003fc=void 0x0!==_0xa51ecb['RedisService']&&_0xa51ecb[_0x52ddf9(0x24f)])?_0x5003fc:Object])],_0x5e3fbe);},function(_0x38f588,_0x3b018e,_0x1dcdcf){const _0x563bef=a0_0x2823;var _0x5ab4ce,_0x7a2810=this&&this[_0x563bef(0x2c3)]||function(_0xac83d4,_0x35dbdd,_0xc882b5,_0x355436){var _0x26e34d,_0x3a099b=arguments['length'],_0x7c3b4e=_0x3a099b<0x3?_0x35dbdd:null===_0x355436?_0x355436=Object['getOwnPropertyDescriptor'](_0x35dbdd,_0xc882b5):_0x355436;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x7c3b4e=Reflect['decorate'](_0xac83d4,_0x35dbdd,_0xc882b5,_0x355436);else{for(var _0x32c619=_0xac83d4['length']-0x1;_0x32c619>=0x0;_0x32c619--)(_0x26e34d=_0xac83d4[_0x32c619])&&(_0x7c3b4e=(_0x3a099b<0x3?_0x26e34d(_0x7c3b4e):_0x3a099b>0x3?_0x26e34d(_0x35dbdd,_0xc882b5,_0x7c3b4e):_0x26e34d(_0x35dbdd,_0xc882b5))||_0x7c3b4e);}return _0x3a099b>0x3&&_0x7c3b4e&&Object['defineProperty'](_0x35dbdd,_0xc882b5,_0x7c3b4e),_0x7c3b4e;},_0x5b0126=this&&this[_0x563bef(0x19c)]||function(_0x17146f,_0x23ded1){const _0x5c1cd4=_0x563bef;if(_0x5c1cd4(0x374)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x17146f,_0x23ded1);};Object['defineProperty'](_0x3b018e,'__esModule',{'value':!0x0}),_0x3b018e['EzpayBeClientService']=void 0x0;const _0x13b469=_0x1dcdcf(0x2),_0x1ceabb=_0x1dcdcf(0x8),_0x1f1db9=_0x1dcdcf(0xc),_0x4c2e51=_0x1dcdcf(0xd),_0x352d04=_0x1dcdcf(0xe),_0x2ea833=_0x1dcdcf(0xf),_0x14fb7c=_0x1dcdcf(0x11);let _0x440235=class{constructor(_0x4c4b3c){const _0x414657=_0x563bef;this['httpService']=_0x4c4b3c,this[_0x414657(0x32b)]=new _0x13b469['Logger']('EzpayBeClientService'),this['apiUrl']=_0x2ea833[_0x414657(0x298)]['ezpayBe']['apiUrl']??_0x414657(0x376),this[_0x414657(0x2af)]=_0x2ea833[_0x414657(0x298)][_0x414657(0x38c)]['apiKey']??'';}async['updateWithdrawalStatus'](_0x2aed22,_0x53d815){const _0x341310=_0x563bef;for(let _0x2a44f9=0x0;_0x2a44f9<=0x3;_0x2a44f9++)try{const _0x4ca1ae=this['apiUrl']+'/api/internal/withdrawals/complete/'+_0x2aed22;this['logger']['log']('Updating\x20withdrawal\x20'+_0x2aed22+'\x20status\x20to\x20'+_0x53d815['analyzedStatus']+'\x20(attempt\x20'+(_0x2a44f9+0x1)+'/4)');const _0x468c27={'analyzedStatus':_0x53d815[_0x341310(0x2ae)],'sourceBankCode':_0x53d815['sourceBankCode'],'sourceAccountNo':_0x53d815[_0x341310(0x231)],'sourceAccountName':_0x53d815['sourceAccountName']},_0x32b6a0=await(0x0,_0x1f1db9['firstValueFrom'])(this['httpService']['patch'](_0x4ca1ae,_0x468c27,{'headers':{'Content-Type':'application/json','X-API-Key':this['apiKey'],'x-internal-secret-key':'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE'},'timeout':0x4e20}));if(0xc8===_0x32b6a0[_0x341310(0x263)]||0xcc===_0x32b6a0['status'])return void this['logger']['log']('Successfully\x20updated\x20withdrawal\x20'+_0x2aed22+'\x20status\x20to\x20'+_0x53d815[_0x341310(0x2ae)]);this[_0x341310(0x32b)]['warn'](_0x341310(0x2e3)+_0x32b6a0['status']+_0x341310(0x318)+_0x2aed22);}catch(_0x30f62d){const _0x51a407=_0x30f62d,_0x5073b9=_0x51a407['response']?.['data'],_0x2d33c0=_0x51a407['message'];if(_0x2a44f9<0x3){const _0x2e62da=0x7d0*Math['pow'](0x2,_0x2a44f9);this['logger']['warn'](_0x341310(0x333)+_0x2aed22+'\x20(attempt\x20'+(_0x2a44f9+0x1)+'/4):\x20'+_0x2d33c0+'.\x20Payload:\x20'+JSON['stringify'](_0x5073b9)+',\x20Retrying\x20in\x20'+_0x2e62da+'ms'),await(0x0,_0x14fb7c[_0x341310(0x349)])(_0x2e62da);}else this['logger']['error'](_0x341310(0x333)+_0x2aed22+'\x20after\x204\x20attempts.\x20Payload:\x20'+JSON[_0x341310(0x15d)](_0x5073b9)+',\x20Error:\x20'+_0x2d33c0);}}async['uploadReceipt'](_0x2985db,_0x3ec6e3){const _0x4e3465=_0x563bef;for(let _0x3c67b8=0x0;_0x3c67b8<=0x3;_0x3c67b8++)try{const _0x28fb61=this[_0x4e3465(0x27b)]+_0x4e3465(0x299)+_0x2985db;if(this['logger']['log']('Uploading\x20bill\x20for\x20withdrawal\x20'+_0x2985db+'\x20(attempt\x20'+(_0x3c67b8+0x1)+_0x4e3465(0x208)),!_0x3ec6e3)return void this[_0x4e3465(0x32b)][_0x4e3465(0x234)](_0x4e3465(0x18e)+_0x2985db);const _0x37c8f=new _0x4c2e51();_0x37c8f['append'](_0x4e3465(0x331),(0x0,_0x352d04['createReadStream'])(_0x3ec6e3));const _0x41ce7a=await(0x0,_0x1f1db9[_0x4e3465(0x29e)])(this['httpService'][_0x4e3465(0x251)](_0x28fb61,_0x37c8f,{'headers':{..._0x37c8f['getHeaders'](),'X-API-Key':this['apiKey'],'x-internal-secret-key':'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE'},'timeout':0x4e20}));if(0xc8===_0x41ce7a['status']||0xcc===_0x41ce7a['status'])return void this['logger']['log'](_0x4e3465(0x20f)+_0x2985db);this[_0x4e3465(0x32b)]['warn']('Unexpected\x20status\x20code\x20'+_0x41ce7a[_0x4e3465(0x263)]+_0x4e3465(0x2df)+_0x2985db);}catch(_0x2b49cb){const _0x5df5bd=_0x2b49cb,_0x2e3c4e=_0x5df5bd[_0x4e3465(0x329)]?.['data'],_0x4db022=_0x5df5bd['message'];if(_0x3c67b8<0x3){const _0x516a7b=0x7d0*Math['pow'](0x2,_0x3c67b8);this['logger']['warn']('Failed\x20to\x20upload\x20bill\x20for\x20withdrawal\x20'+_0x2985db+'\x20(attempt\x20'+(_0x3c67b8+0x1)+_0x4e3465(0x37f)+_0x4db022+'.\x20Response:\x20'+JSON['stringify'](_0x2e3c4e)+_0x4e3465(0x16b)+_0x516a7b+'ms'),await(0x0,_0x14fb7c['sleep'])(_0x516a7b);}else this[_0x4e3465(0x32b)]['error'](_0x4e3465(0x1c5)+_0x2985db+'\x20after\x204\x20attempts.\x20Response:\x20'+JSON['stringify'](_0x2e3c4e)+',\x20Error:\x20'+_0x4db022);}}};_0x3b018e['EzpayBeClientService']=_0x440235,_0x3b018e['EzpayBeClientService']=_0x440235=_0x7a2810([(0x0,_0x13b469['Injectable'])(),_0x5b0126(_0x563bef(0x381),['function'==typeof(_0x5ab4ce=void 0x0!==_0x1ceabb['HttpService']&&_0x1ceabb['HttpService'])?_0x5ab4ce:Object])],_0x440235);},_0x2f4854=>{_0x2f4854['exports']=require('rxjs');},_0x5c5009=>{_0x5c5009['exports']=require('form-data');},_0x42558e=>{_0x42558e['exports']=require('fs');},(_0x459c32,_0x57899b,_0x1be2ce)=>{const _0x176f00=a0_0x2823;Object['defineProperty'](_0x57899b,'__esModule',{'value':!0x0}),_0x57899b['config']=void 0x0;const _0x4a7c3e=_0x1be2ce(0x10),_0x37ad14=_0x1be2ce(0x4);(0x0,_0x4a7c3e['config'])({'path':(0x0,_0x37ad14['join'])(process['cwd'](),'.env')}),_0x57899b['config']={'boxType':'PANDA','redis':{'host':process['env']['REDIS_HOST']??'14.225.44.234','port':parseInt(process['env']['REDIS_PORT']??_0x176f00(0x27c)),'db':0x3,'password':process[_0x176f00(0x2a9)]['REDIS_PWD']??'Dcsvnqvmn1'},'ezpayBe':{'apiUrl':process[_0x176f00(0x2a9)][_0x176f00(0x302)]??'https://api-hn.botpro.world/payment','apiKey':process['env']['EZZPAY_KEY']??'uHqE5X9H0QEBsqlZpdTHG0fOyvmMtHjCGgsG4ouls3Gz9WvaWg4w9HV3sqETGWfE'},'ocr':{'poolSize':parseInt(process['env']['OCR_POOL_SIZE']||'4',0xa),'lang':process['env']['OCR_LANG']||'vie','rois':{'singleLine':{'crop':{'x':parseFloat(process['env']['OCR_ROI_SINGLE_X']||'0'),'y':parseFloat(process['env'][_0x176f00(0x2b1)]||'0'),'width':parseFloat(process[_0x176f00(0x2a9)][_0x176f00(0x1f6)]||'1'),'height':parseFloat(process['env']['OCR_ROI_SINGLE_HEIGHT']||'1')},'psm':parseInt(process['env']['OCR_PSM_SINGLE']||'7',0xa),'charWhitelist':process['env'][_0x176f00(0x378)]||_0x176f00(0x1a7),'maxWidth':parseInt(process['env']['OCR_MAX_WIDTH_SINGLE']||_0x176f00(0x1c1),0xa)},'block':{'crop':{'x':parseFloat(process['env']['OCR_ROI_BLOCK_X']||'0'),'y':parseFloat(process[_0x176f00(0x2a9)]['OCR_ROI_BLOCK_Y']||'0'),'width':parseFloat(process['env']['OCR_ROI_BLOCK_WIDTH']||'1'),'height':parseFloat(process[_0x176f00(0x2a9)]['OCR_ROI_BLOCK_HEIGHT']||'1')},'psm':parseInt(process['env']['OCR_PSM_BLOCK']||'6',0xa),'charWhitelist':process[_0x176f00(0x2a9)]['OCR_WHITELIST_BLOCK']||void 0x0,'maxWidth':parseInt(process['env'][_0x176f00(0x285)]||'1200',0xa)},'full':{'crop':{'x':0x0,'y':0x0,'width':0x1,'height':0x1},'psm':parseInt(process['env']['OCR_PSM_FULL']||'6',0xa),'charWhitelist':void 0x0,'maxWidth':parseInt(process['env']['OCR_MAX_WIDTH_FULL']||_0x176f00(0x1aa),0xa)}}},'spaceocr':{'datacenterPrimary':'https://apipro1.ocr.space/parse/image','datacenterSecond':'https://apipro2.ocr.space/parse/image','key':'G888CWKP2Y06X','keyFree':_0x176f00(0x2a3)}};},_0x3b3256=>{_0x3b3256['exports']=require('dotenv');},(_0x541f33,_0x50c8bb)=>{Object['defineProperty'](_0x50c8bb,'__esModule',{'value':!0x0}),_0x50c8bb['sleep']=void 0x0,_0x50c8bb['sleep']=_0x21b650=>new Promise(_0x58f7e0=>setTimeout(_0x58f7e0,_0x21b650));},function(_0xb9529d,_0x154326,_0x4390b7){const _0x27d389=a0_0x2823;var _0x379a28,_0x21c30e,_0x4fc10b,_0x33156e,_0x3c64d9,_0x5c0790=this&&this['__decorate']||function(_0x195e2d,_0x9c7da0,_0xa7c5d9,_0x1a902c){const _0x4a4c6f=a0_0x2823;var _0x2abf83,_0x3a9540=arguments[_0x4a4c6f(0x390)],_0x2140b5=_0x3a9540<0x3?_0x9c7da0:null===_0x1a902c?_0x1a902c=Object['getOwnPropertyDescriptor'](_0x9c7da0,_0xa7c5d9):_0x1a902c;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x2140b5=Reflect['decorate'](_0x195e2d,_0x9c7da0,_0xa7c5d9,_0x1a902c);else{for(var _0x5855d2=_0x195e2d['length']-0x1;_0x5855d2>=0x0;_0x5855d2--)(_0x2abf83=_0x195e2d[_0x5855d2])&&(_0x2140b5=(_0x3a9540<0x3?_0x2abf83(_0x2140b5):_0x3a9540>0x3?_0x2abf83(_0x9c7da0,_0xa7c5d9,_0x2140b5):_0x2abf83(_0x9c7da0,_0xa7c5d9))||_0x2140b5);}return _0x3a9540>0x3&&_0x2140b5&&Object['defineProperty'](_0x9c7da0,_0xa7c5d9,_0x2140b5),_0x2140b5;},_0x299340=this&&this['__metadata']||function(_0x822189,_0x4be7e5){const _0x5832f0=a0_0x2823;if('object'==typeof Reflect&&_0x5832f0(0x2d3)==typeof Reflect['metadata'])return Reflect['metadata'](_0x822189,_0x4be7e5);};Object['defineProperty'](_0x154326,_0x27d389(0x143),{'value':!0x0}),_0x154326['BankService']=void 0x0;const _0x5882c8=_0x4390b7(0x2),_0x12797d=_0x4390b7(0x13),_0xc112f4=_0x4390b7(0x27),_0x1ff513=_0x4390b7(0x15),_0x454fd2=_0x4390b7(0x2b),_0x25956b=_0x4390b7(0x2c);let _0x1e359f=class{constructor(_0x1204bc,_0x3fb239,_0x56f6c9,_0x51fb2f,_0x5bb2ab){const _0x599f50=_0x27d389;this[_0x599f50(0x355)]=_0x1204bc,this[_0x599f50(0x2b0)]=_0x3fb239,this['deviceService']=_0x56f6c9,this['sessionManagement']=_0x51fb2f,this['deviceLock']=_0x5bb2ab,this[_0x599f50(0x32b)]=new _0x5882c8['Logger']('BankService'),this['bankServices']=new Map(),this['registerBankService'](this['acbService']),this['registerBankService'](this['pgService']);}['registerBankService'](_0x13f24c){const _0x45f614=_0x27d389,_0x6ffdfb=_0x13f24c['getBankCode']()[_0x45f614(0x1ae)]();this['bankServices']['set'](_0x6ffdfb,_0x13f24c),this['logger']['log'](_0x45f614(0x213)+_0x6ffdfb);}['getBankService'](_0x49769d){const _0x5230f5=_0x27d389,_0x5921fb=this['bankServices']['get'](_0x49769d[_0x5230f5(0x1ae)]());return _0x5921fb||this['logger']['warn']('Bank\x20service\x20not\x20found\x20for\x20bank\x20code:\x20'+_0x49769d),_0x5921fb||null;}[_0x27d389(0x282)](){return Array['from'](this['bankServices']['keys']());}async['login'](_0x1496f8,_0x36af4c,_0x4295e5=!0x1){const _0x2523d7=_0x27d389;if(_0x4295e5&&await this['deviceLock']['releaseLock'](_0x36af4c),await this['deviceLock']['isLocked'](_0x36af4c)){const _0x13e180=await this[_0x2523d7(0x276)]['getLock'](_0x36af4c);throw new Error('Device\x20'+_0x36af4c+'\x20is\x20currently\x20locked\x20by\x20'+_0x13e180?.['lockType']+'\x20('+_0x13e180?.['lockedBy']+').\x20Cannot\x20login.');}const _0xa31b8c=_0x2523d7(0x2cb)+_0x1496f8+':'+_0x36af4c+':'+Date['now']();if(!await this[_0x2523d7(0x276)][_0x2523d7(0x35f)](_0x36af4c,'login',_0xa31b8c,0x41eb0))throw new Error(_0x2523d7(0x199)+_0x36af4c);try{await this[_0x2523d7(0x34e)]['markLoggingIn'](_0x36af4c,_0x1496f8);const _0x5b1f28=this['getBankService'](_0x1496f8);if(!_0x5b1f28)throw new Error('Bank\x20service\x20not\x20found\x20for\x20bank\x20code:\x20'+_0x1496f8);this['logger']['log'](_0x2523d7(0x225)+_0x1496f8+'\x20on\x20device\x20'+_0x36af4c),await _0x5b1f28['login'](_0x36af4c),await this['sessionManagement']['recordLogin'](_0x36af4c,_0x1496f8),this[_0x2523d7(0x32b)][_0x2523d7(0x310)]('Successfully\x20logged\x20in\x20to\x20'+_0x1496f8+'\x20on\x20device\x20'+_0x36af4c);}catch(_0x51711c){throw await this['sessionManagement']['clearSession'](_0x36af4c,_0x1496f8),_0x51711c;}finally{await this['deviceLock'][_0x2523d7(0x25a)](_0x36af4c);}}async[_0x27d389(0x29c)](){const _0x520298=_0x27d389;try{const _0x151385=(await this['deviceService']['listDevices']())[_0x520298(0x2e6)](_0x2a5571=>'active'===_0x2a5571[_0x520298(0x263)]&&_0x2a5571['bankCode']);if(0x0===_0x151385[_0x520298(0x390)])return void this[_0x520298(0x32b)]['warn']('No\x20active\x20devices\x20found\x20to\x20login');this['logger'][_0x520298(0x310)]('Logging\x20in\x20to\x20'+_0x151385['length']+'\x20active\x20device(s)');for(const _0x5cf225 of _0x151385){const _0x4ffdbc=_0x5cf225[_0x520298(0x20a)];try{await this['deviceLock'][_0x520298(0x27f)](_0x4ffdbc,'transfer');}catch(_0x581d39){this['logger']['warn']('Failed\x20to\x20release\x20transfer\x20lock\x20for\x20device\x20'+_0x4ffdbc+':\x20'+_0x581d39['message']);}}const _0x57bb25=[];for(const _0x1c901b of _0x151385){const _0xabff37=_0x1c901b['bankCode'][_0x520298(0x1ae)](),_0x4dbe64=_0x1c901b[_0x520298(0x20a)];_0x57bb25['push'](this['login'](_0xabff37,_0x4dbe64,!0x0)['catch'](_0x44e928=>{const _0x5b6df1=_0x520298;this['logger']['error']('Failed\x20to\x20login\x20'+_0xabff37+_0x5b6df1(0x345)+_0x4dbe64+':\x20'+_0x44e928['message']);}));}await Promise[_0x520298(0x22b)](_0x57bb25),this['logger']['log']('Completed\x20login\x20process\x20for\x20all\x20active\x20banks');}catch(_0x210bfb){throw this[_0x520298(0x32b)][_0x520298(0x134)](_0x520298(0x135)+_0x210bfb['message']),_0x210bfb;}}['executeTransfer'](_0x102cc5,_0xfd7de2,_0x169de7){return this['getBankService'](_0x169de7)['executeTransfer'](_0x102cc5,_0xfd7de2);}['executeTransferWithQRCode'](_0xe75762,_0x2a20d8,_0x392bcd){const _0x214f13=this['getBankService'](_0x392bcd);return _0x214f13?_0x214f13['executeTransferWithQRCode'](_0xe75762,_0x2a20d8):(this['logger']['warn']('Bank\x20'+_0x392bcd+'\x20not\x20supported,\x20cannot\x20execute\x20transfer\x20with\x20QR\x20code'),null);}async['isSessionValid'](_0x318433,_0x22fe9a){return await this['sessionManagement']['isSessionValid'](_0x318433,_0x22fe9a);}async['getBillImage'](_0x2cc54c,_0x3bc601){const _0x52dabb=_0x27d389,_0x275af1=this[_0x52dabb(0x182)](_0x2cc54c);return _0x275af1?await _0x275af1[_0x52dabb(0x151)](_0x3bc601):(this['logger']['warn']('Bank\x20'+_0x2cc54c+'\x20not\x20supported,\x20cannot\x20get\x20bill\x20image'),null);}['analyzeTransferBill'](_0x7dc2ad,_0xf1e12f){const _0xdf73bb=_0x27d389,_0x567953=this['getBankService'](_0x7dc2ad);return _0x567953?_0x567953[_0xdf73bb(0x388)](_0xf1e12f):(this[_0xdf73bb(0x32b)]['warn']('Bank\x20'+_0x7dc2ad+_0xdf73bb(0x146)),null);}async[_0x27d389(0x1a3)](_0x1e9d1b,_0x459580){const _0x300eed=_0x27d389,_0x118c7c=await this['sessionManagement']['getSession'](_0x1e9d1b,_0x459580);if(_0x300eed(0x1f4)===_0x118c7c?.['status'])return!0x1;const _0x512792=await this[_0x300eed(0x34e)]['needsRefresh'](_0x1e9d1b,_0x459580),_0xf583da=await this['sessionManagement']['isSessionValid'](_0x1e9d1b,_0x459580);if(!_0x512792&&_0xf583da)return!0x1;if(await this['deviceLock']['isLocked'](_0x1e9d1b))return this['logger'][_0x300eed(0x234)]('Cannot\x20refresh\x20session\x20for\x20device\x20'+_0x1e9d1b+'\x20-\x20device\x20is\x20locked'),!0x1;try{return _0xf583da?this[_0x300eed(0x32b)]['log']('Refreshing\x20session\x20for\x20device\x20'+_0x1e9d1b+_0x300eed(0x178)+_0x459580):this[_0x300eed(0x32b)]['log']('Session\x20expired\x20or\x20missing\x20for\x20device\x20'+_0x1e9d1b+_0x300eed(0x178)+_0x459580+'.\x20Retrying\x20login...'),await this['login'](_0x459580,_0x1e9d1b),!0x0;}catch(_0x1d87b6){return this['logger'][_0x300eed(0x134)]('Failed\x20to\x20refresh\x20session\x20for\x20device\x20'+_0x1e9d1b+':\x20'+_0x1d87b6[_0x300eed(0x2c9)]),!0x1;}}async['createQRCodeAndTransferTo'](_0x33faa6,_0xba6c80){const _0xd10d17=_0x27d389,_0x30b99a=this['getBankService'](_0xba6c80['bankCode']);_0x30b99a?await _0x30b99a['createQRCodeAndTransferTo'](_0x33faa6,_0xba6c80):this[_0xd10d17(0x32b)]['warn']('Bank\x20'+_0xba6c80['bankCode']+'\x20not\x20supported,\x20cannot\x20create\x20QR\x20code\x20and\x20transfer\x20to\x20device\x20'+_0x33faa6);}};_0x154326[_0x27d389(0x191)]=_0x1e359f,_0x154326['BankService']=_0x1e359f=_0x5c0790([(0x0,_0x5882c8['Injectable'])(),_0x299340('design:paramtypes',[_0x27d389(0x2d3)==typeof(_0x379a28=void 0x0!==_0x12797d['AcbService']&&_0x12797d[_0x27d389(0x2a0)])?_0x379a28:Object,'function'==typeof(_0x21c30e=void 0x0!==_0xc112f4['PgService']&&_0xc112f4['PgService'])?_0x21c30e:Object,'function'==typeof(_0x4fc10b=void 0x0!==_0x1ff513['DeviceService']&&_0x1ff513['DeviceService'])?_0x4fc10b:Object,_0x27d389(0x2d3)==typeof(_0x33156e=void 0x0!==_0x454fd2['SessionManagementService']&&_0x454fd2['SessionManagementService'])?_0x33156e:Object,'function'==typeof(_0x3c64d9=void 0x0!==_0x25956b[_0x27d389(0x38a)]&&_0x25956b[_0x27d389(0x38a)])?_0x3c64d9:Object])],_0x1e359f);},function(_0x427bc3,_0x3fb24b,_0x5a67f2){const _0x3de718=a0_0x2823;var _0x323906,_0x118441,_0x3e0be6,_0x36f3f8=this&&this[_0x3de718(0x2c3)]||function(_0x49c1a7,_0x2495ec,_0x2919b0,_0x37f9d4){const _0x53315a=_0x3de718;var _0x29958f,_0x3a0988=arguments['length'],_0xa7a3ac=_0x3a0988<0x3?_0x2495ec:null===_0x37f9d4?_0x37f9d4=Object['getOwnPropertyDescriptor'](_0x2495ec,_0x2919b0):_0x37f9d4;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0xa7a3ac=Reflect['decorate'](_0x49c1a7,_0x2495ec,_0x2919b0,_0x37f9d4);else{for(var _0x59e322=_0x49c1a7[_0x53315a(0x390)]-0x1;_0x59e322>=0x0;_0x59e322--)(_0x29958f=_0x49c1a7[_0x59e322])&&(_0xa7a3ac=(_0x3a0988<0x3?_0x29958f(_0xa7a3ac):_0x3a0988>0x3?_0x29958f(_0x2495ec,_0x2919b0,_0xa7a3ac):_0x29958f(_0x2495ec,_0x2919b0))||_0xa7a3ac);}return _0x3a0988>0x3&&_0xa7a3ac&&Object['defineProperty'](_0x2495ec,_0x2919b0,_0xa7a3ac),_0xa7a3ac;},_0x35b5b8=this&&this['__metadata']||function(_0x3b3c59,_0x579ba8){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x3b3c59,_0x579ba8);},_0x255b08=this&&this['__param']||function(_0x402bb3,_0x42e28d){return function(_0x27eec3,_0x38f60f){_0x42e28d(_0x27eec3,_0x38f60f,_0x402bb3);};};Object['defineProperty'](_0x3fb24b,'__esModule',{'value':!0x0}),_0x3fb24b[_0x3de718(0x2a0)]=void 0x0;const _0x1b4b43=_0x5a67f2(0x2),_0xe5d23f=_0x5a67f2(0x14),_0x4dac00=_0x5a67f2(0x15),_0x1c7d7b=_0x5a67f2(0x1a),_0x501b13=_0x5a67f2(0x19),_0x2d59c7=_0x5a67f2(0x11),_0x40b641=_0x5a67f2(0x25),_0x5cf606=_0x5a67f2(0x26),_0x28f945=_0x5a67f2(0x1d);let _0x4400e6=class extends _0x1c7d7b['BaseBankService']{constructor(_0x39a0ed,_0x3de2ea,_0x12da15){super(_0x39a0ed,_0x3de2ea,_0x12da15),this['wsService']=_0x39a0ed,this['BANK_CODE']='ACB',this['BUNDLE_ID']='mobileapp.acb.com.vn';}['launchApp'](_0x15eb36){throw new Error('Method\x20not\x20implemented.');}async['captureScreen'](_0x22cd11,_0x58cbdf){}async['clickPasswordField'](_0x1d78e0){const _0xcbac67=_0x3de718;try{const {x:_0x314945,y:_0x269713}=_0x5cf606['ACB_UI_COORDINATES']['PASSWORD_FIELD'];this['logger']['log']('Clicking\x20password\x20field\x20on\x20device\x20'+_0x1d78e0+'\x20at\x20coordinates\x20('+_0x314945+',\x20'+_0x269713+')'),await this['clickWithTransition'](_0x1d78e0,_0x314945,_0x269713,0.2),await(0x0,_0x2d59c7['sleep'])(0x3e8),this['logger']['log']('Password\x20field\x20clicked\x20successfully\x20on\x20device\x20'+_0x1d78e0);}catch(_0x5ebd0c){throw this[_0xcbac67(0x32b)]['error']('Error\x20clicking\x20password\x20field\x20on\x20device\x20'+_0x1d78e0+':\x20'+_0x5ebd0c['message']),_0x5ebd0c;}}async[_0x3de718(0x1eb)](_0x2e7724){const _0x3cf04c=_0x3de718;try{const _0x2f1da7=await this['deviceService']['getDeviceConfig'](_0x2e7724);if(!_0x2f1da7||!_0x2f1da7['password'])throw new Error(_0x3cf04c(0x19f)+_0x2e7724);await this[_0x3cf04c(0x2ec)]['inputText'](_0x2e7724,_0x2f1da7['password']);}catch(_0x12baec){throw this[_0x3cf04c(0x32b)][_0x3cf04c(0x134)]('Error\x20inputting\x20password\x20from\x20config\x20for\x20device\x20'+_0x2e7724+':\x20'+_0x12baec['message']),_0x12baec;}}async['clickLoginButton'](_0x4dc057){const _0x1e443c=_0x3de718;try{const {x:_0x16de42,y:_0x211403}=_0x5cf606[_0x1e443c(0x275)]['LOGIN_BUTTON'];this['logger']['log'](_0x1e443c(0x377)+_0x4dc057+'\x20at\x20coordinates\x20('+_0x16de42+',\x20'+_0x211403+')'),await this['wsService']['click'](_0x4dc057,_0x16de42,_0x211403,0.2),await(0x0,_0x2d59c7[_0x1e443c(0x349)])(0x1388),this[_0x1e443c(0x32b)]['log']('Login\x20button\x20clicked\x20successfully\x20on\x20device\x20'+_0x4dc057);}catch(_0x1c8419){throw this['logger']['error']('Error\x20clicking\x20login\x20button\x20on\x20device\x20'+_0x4dc057+':\x20'+_0x1c8419['message']),_0x1c8419;}}async['login'](_0x1563f2){const _0x110c8a=_0x3de718;try{await this['killApp'](_0x1563f2),await this[_0x110c8a(0x2de)](_0x1563f2);const {x:_0x97e78b,y:_0x573389}=_0x5cf606[_0x110c8a(0x275)]['LOGIN_BUTTON'];this['logger'][_0x110c8a(0x310)]('Clicking\x20login\x20button\x20on\x20device\x20'+_0x1563f2+'\x20at\x20coordinates\x20('+_0x97e78b+',\x20'+_0x573389+')'),await this['wsService']['click'](_0x1563f2,_0x97e78b,_0x573389,0.2),await(0x0,_0x2d59c7[_0x110c8a(0x349)])(0x7d0),await this['inputPasswordFromConfig'](_0x1563f2),await(0x0,_0x2d59c7['sleep'])(0x7d0);const {x:_0xe3c1ee,y:_0xdd30d9}=_0x40b641[_0x110c8a(0x272)][_0x110c8a(0x317)];this['logger']['log']('Clicking\x20return\x20key\x20on\x20device\x20'+_0x1563f2+'\x20at\x20coordinates\x20('+_0xe3c1ee+',\x20'+_0xdd30d9+')'),await this['wsService']['click'](_0x1563f2,_0xe3c1ee,_0xdd30d9,0.2),await(0x0,_0x2d59c7['sleep'])(0x7d0),await this['wsService']['click'](_0x1563f2,0.5,0.62,0.2),await(0x0,_0x2d59c7[_0x110c8a(0x349)])(0x1388),await this['wsService']['click'](_0x1563f2,0.3,0.55,0.2),await this['wsService'][_0x110c8a(0x392)](_0x1563f2,0.5,0.65,0.2);}catch(_0x4fc92c){throw this[_0x110c8a(0x32b)]['error'](_0x110c8a(0x1c2)+_0x1563f2+':\x20'+_0x4fc92c['message']),_0x4fc92c;}}async['executeTransfer'](_0x39d49d,_0x4d2df6){}async['executeTransferWithQRCode'](_0x2fdd5d,_0x30c434){const _0x37463e=_0x3de718;console['warn'](_0x37463e(0x2e4));}async[_0x3de718(0x13a)](_0x3500db,_0x1e8dfa){return this['executeExternalTransfer'](_0x3500db,_0x1e8dfa);}async[_0x3de718(0x27e)](_0x2e0369,_0x3befcb){const _0x2d5a29=_0x3de718;console[_0x2d5a29(0x234)]('ACB\x20executeExternalTransfer');}};_0x3fb24b['AcbService']=_0x4400e6,_0x3fb24b[_0x3de718(0x2a0)]=_0x4400e6=_0x36f3f8([(0x0,_0x1b4b43['Injectable'])(),_0x255b08(0x0,(0x0,_0x1b4b43[_0x3de718(0x212)])(_0xe5d23f['WEBSOCKET_SERVICE'])),_0x35b5b8('design:paramtypes',['function'==typeof(_0x323906=void 0x0!==_0x501b13[_0x3de718(0x2e0)]&&_0x501b13['IWebSocketService'])?_0x323906:Object,'function'==typeof(_0x118441=void 0x0!==_0x4dac00['DeviceService']&&_0x4dac00[_0x3de718(0x367)])?_0x118441:Object,_0x3de718(0x2d3)==typeof(_0x3e0be6=void 0x0!==_0x28f945['OCRService']&&_0x28f945['OCRService'])?_0x3e0be6:Object])],_0x4400e6);},(_0x161f79,_0x2af3b0)=>{const _0x5d05d0=a0_0x2823;Object['defineProperty'](_0x2af3b0,'__esModule',{'value':!0x0}),_0x2af3b0['WEBSOCKET_SERVICE']=void 0x0,_0x2af3b0[_0x5d05d0(0x387)]=Symbol(_0x5d05d0(0x387));},function(_0x47845c,_0x9aa4d6,_0x3d7724){const _0x53c055=a0_0x2823;var _0x38626b,_0x33cccd,_0x76ce79=this&&this['__decorate']||function(_0x38f276,_0x28b889,_0x525d29,_0x402b77){const _0x5a3867=a0_0x2823;var _0x189cfa,_0x3bb900=arguments[_0x5a3867(0x390)],_0x4a5dc1=_0x3bb900<0x3?_0x28b889:null===_0x402b77?_0x402b77=Object[_0x5a3867(0x380)](_0x28b889,_0x525d29):_0x402b77;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x5a3867(0x1ad)])_0x4a5dc1=Reflect['decorate'](_0x38f276,_0x28b889,_0x525d29,_0x402b77);else{for(var _0x2804f5=_0x38f276['length']-0x1;_0x2804f5>=0x0;_0x2804f5--)(_0x189cfa=_0x38f276[_0x2804f5])&&(_0x4a5dc1=(_0x3bb900<0x3?_0x189cfa(_0x4a5dc1):_0x3bb900>0x3?_0x189cfa(_0x28b889,_0x525d29,_0x4a5dc1):_0x189cfa(_0x28b889,_0x525d29))||_0x4a5dc1);}return _0x3bb900>0x3&&_0x4a5dc1&&Object['defineProperty'](_0x28b889,_0x525d29,_0x4a5dc1),_0x4a5dc1;},_0x1b0f31=this&&this['__metadata']||function(_0x350351,_0x2befe0){const _0x7ec43=a0_0x2823;if(_0x7ec43(0x374)==typeof Reflect&&_0x7ec43(0x2d3)==typeof Reflect['metadata'])return Reflect['metadata'](_0x350351,_0x2befe0);};Object[_0x53c055(0x1b6)](_0x9aa4d6,'__esModule',{'value':!0x0}),_0x9aa4d6['DeviceService']=void 0x0;const _0x4aa1ec=_0x3d7724(0x2),_0x2c645a=_0x3d7724(0x16),_0x5d43ab=_0x3d7724(0x18);let _0x4b417b=class{constructor(_0x548c91,_0x2f8143){const _0x326b0f=_0x53c055;this['redisService']=_0x548c91,this[_0x326b0f(0x357)]=_0x2f8143,this['logger']=new _0x4aa1ec['Logger']('DeviceService'),this[_0x326b0f(0x260)]=_0x326b0f(0x1e1),this['REDIS_DEVICE_CONFIG_SUFFIX']=_0x326b0f(0x2b8),this['REDIS_SERVICE_STATUS_KEY']='service:status';}async['onModuleInit'](){const _0x12d980=_0x53c055;try{await this['setServiceStatus']('inactive'),this['logger']['log']('Service\x20status\x20initialized\x20to:\x20inactive');}catch(_0x58c47a){this['logger']['error']('Failed\x20to\x20initialize\x20service\x20status:\x20'+_0x58c47a[_0x12d980(0x2c9)]);}}async['listDevices'](){const _0x9202e5=_0x53c055;try{const _0x4b1347=await this[_0x9202e5(0x357)]['listDevices']();return await Promise['all'](_0x4b1347[_0x9202e5(0x18b)](async _0x2b29d0=>{const _0x2cbd25=_0x9202e5,_0x1220dc=await this[_0x2cbd25(0x2aa)](_0x2b29d0[_0x2cbd25(0x20a)]);return{..._0x2b29d0,'bankCode':_0x1220dc?.['bankCode']||'','availableAmount':_0x1220dc?.[_0x2cbd25(0x291)]||0x0,'status':_0x1220dc?.['status']||_0x2cbd25(0x20c),'password':_0x1220dc?.[_0x2cbd25(0x254)]||'','smartOTP':_0x1220dc?.[_0x2cbd25(0x15b)]||'','accountNo':_0x1220dc?.['accountNo']||'','accountName':_0x1220dc?.['accountName']||''};}));}catch(_0x13b8d6){throw this['logger']['error']('Error\x20listing\x20devices:\x20'+_0x13b8d6['message']),_0x13b8d6;}}async['getDeviceConfig'](_0x1607d0){const _0x49ac4b=_0x53c055;try{const _0x185525=''+this[_0x49ac4b(0x260)]+_0x1607d0+this[_0x49ac4b(0x245)],_0x5d830d=await this[_0x49ac4b(0x1ca)]['get'](_0x185525);return _0x5d830d?JSON['parse'](_0x5d830d):null;}catch(_0x3fd336){return this[_0x49ac4b(0x32b)]['error']('Error\x20getting\x20device\x20config\x20for\x20'+_0x1607d0+':\x20'+_0x3fd336['message']),null;}}async['updateDeviceConfig'](_0x49e0b4,_0x4a7073){const _0xcef37d=_0x53c055;try{const _0x293210=''+this[_0xcef37d(0x260)]+_0x49e0b4+this[_0xcef37d(0x245)],_0x5eefc7=await this['getDeviceConfig'](_0x49e0b4),_0x4b5e45={'deviceId':_0x49e0b4,'bankCode':void 0x0!==_0x4a7073[_0xcef37d(0x31a)]?_0x4a7073['bankCode']:_0x5eefc7?.['bankCode']||'','availableAmount':void 0x0!==_0x4a7073['availableAmount']?_0x4a7073[_0xcef37d(0x291)]:_0x5eefc7?.['availableAmount']||0x0,'status':void 0x0!==_0x4a7073['status']?_0x4a7073['status']:_0x5eefc7?.['status']||'deactive','password':void 0x0!==_0x4a7073['password']?_0x4a7073[_0xcef37d(0x254)]:_0x5eefc7?.['password']||'','smartOTP':void 0x0!==_0x4a7073[_0xcef37d(0x15b)]?_0x4a7073['smartOTP']:_0x5eefc7?.[_0xcef37d(0x15b)]||'','accountNo':void 0x0!==_0x4a7073['accountNo']?_0x4a7073['accountNo']:_0x5eefc7?.['accountNo']||'','accountName':void 0x0!==_0x4a7073[_0xcef37d(0x1fb)]?_0x4a7073['accountName']:_0x5eefc7?.[_0xcef37d(0x1fb)]||''};return await this[_0xcef37d(0x1ca)]['set'](_0x293210,JSON['stringify'](_0x4b5e45)),this['logger']['log']('Updated\x20device\x20config\x20for\x20'+_0x49e0b4+'\x20(bankCode:\x20'+(_0x4b5e45['bankCode']||'not\x20set')+_0xcef37d(0x176)+JSON['stringify'](_0x4b5e45)),_0x4b5e45;}catch(_0x1759a0){throw this['logger']['error']('Error\x20updating\x20device\x20config\x20for\x20'+_0x49e0b4+':\x20'+_0x1759a0[_0xcef37d(0x2c9)]),_0x1759a0;}}async['getServiceStatus'](){const _0x3293f2=_0x53c055;try{return await this[_0x3293f2(0x1ca)]['get'](this['REDIS_SERVICE_STATUS_KEY'])||_0x3293f2(0x29a);}catch(_0x307bce){return this[_0x3293f2(0x32b)]['error']('Error\x20getting\x20service\x20status:\x20'+_0x307bce['message']),'inactive';}}async[_0x53c055(0x38f)](_0x1026c2){const _0xb23ee9=_0x53c055;try{await this['redisService']['set'](this['REDIS_SERVICE_STATUS_KEY'],_0x1026c2),this['logger']['log']('Service\x20status\x20set\x20to:\x20'+_0x1026c2);}catch(_0x3fffc6){throw this[_0xb23ee9(0x32b)][_0xb23ee9(0x134)]('Error\x20setting\x20service\x20status:\x20'+_0x3fffc6['message']),_0x3fffc6;}}async[_0x53c055(0x132)](_0x11c73f,_0x20f470){const _0x170912=_0x53c055;try{const _0x9bb75f=await this['getDeviceConfig'](_0x11c73f);if(!_0x9bb75f)return!0x1;const _0x1baa9e=_0x9bb75f['availableAmount']-_0x20f470;return _0x1baa9e<0x0?(this[_0x170912(0x32b)]['warn']('Insufficient\x20amount\x20for\x20device\x20'+_0x11c73f+'.\x20Available:\x20'+_0x9bb75f['availableAmount']+_0x170912(0x158)+_0x20f470),!0x1):(await this[_0x170912(0x26e)](_0x11c73f,{'availableAmount':_0x1baa9e}),!0x0);}catch(_0x3e5833){return this[_0x170912(0x32b)]['error']('Error\x20deducting\x20amount\x20for\x20device\x20'+_0x11c73f+':\x20'+_0x3e5833['message']),!0x1;}}async['hasActiveDevice'](){const _0x11615f=_0x53c055;try{return(await this['listDevices']())[_0x11615f(0x350)](_0x3639bb=>'active'===_0x3639bb['status']);}catch(_0x2b81f2){return this[_0x11615f(0x32b)]['error']('Error\x20checking\x20active\x20devices:\x20'+_0x2b81f2['message']),!0x1;}}};_0x9aa4d6['DeviceService']=_0x4b417b,_0x9aa4d6['DeviceService']=_0x4b417b=_0x76ce79([(0x0,_0x4aa1ec[_0x53c055(0x185)])(),_0x1b0f31('design:paramtypes',[_0x53c055(0x2d3)==typeof(_0x38626b=void 0x0!==_0x2c645a['RedisService']&&_0x2c645a['RedisService'])?_0x38626b:Object,'function'==typeof(_0x33cccd=void 0x0!==_0x5d43ab['HcBoxService']&&_0x5d43ab[_0x53c055(0x13f)])?_0x33cccd:Object])],_0x4b417b);},function(_0x1a580c,_0x3fa4bf,_0x59ae8a){const _0xa62bcb=a0_0x2823;var _0x58e112=this&&this['__decorate']||function(_0x272b92,_0x128090,_0x46957d,_0x5e06c3){const _0x2cb94f=a0_0x2823;var _0x317630,_0x488e50=arguments['length'],_0x51d142=_0x488e50<0x3?_0x128090:null===_0x5e06c3?_0x5e06c3=Object[_0x2cb94f(0x380)](_0x128090,_0x46957d):_0x5e06c3;if(_0x2cb94f(0x374)==typeof Reflect&&'function'==typeof Reflect[_0x2cb94f(0x1ad)])_0x51d142=Reflect[_0x2cb94f(0x1ad)](_0x272b92,_0x128090,_0x46957d,_0x5e06c3);else{for(var _0x13f3dc=_0x272b92['length']-0x1;_0x13f3dc>=0x0;_0x13f3dc--)(_0x317630=_0x272b92[_0x13f3dc])&&(_0x51d142=(_0x488e50<0x3?_0x317630(_0x51d142):_0x488e50>0x3?_0x317630(_0x128090,_0x46957d,_0x51d142):_0x317630(_0x128090,_0x46957d))||_0x51d142);}return _0x488e50>0x3&&_0x51d142&&Object[_0x2cb94f(0x1b6)](_0x128090,_0x46957d,_0x51d142),_0x51d142;},_0x35fb04=this&&this['__metadata']||function(_0x5ef698,_0x1e9748){const _0x27eb44=a0_0x2823;if(_0x27eb44(0x374)==typeof Reflect&&_0x27eb44(0x2d3)==typeof Reflect['metadata'])return Reflect['metadata'](_0x5ef698,_0x1e9748);};Object[_0xa62bcb(0x1b6)](_0x3fa4bf,'__esModule',{'value':!0x0}),_0x3fa4bf[_0xa62bcb(0x24f)]=void 0x0;const _0x7bfef9=_0x59ae8a(0x2),_0x36003f=_0x59ae8a(0x17),_0xa5b6c9=_0x59ae8a(0xf);let _0x3470df=class{constructor(){const _0x160346=_0xa62bcb;this[_0x160346(0x32b)]=new _0x7bfef9['Logger']('RedisService'),this['redisClient']=null;}async['getClient'](){const _0x5b02b1=_0xa62bcb;if(this['redisClient'])return this[_0x5b02b1(0x1b1)];const _0x171c13=_0xa5b6c9[_0x5b02b1(0x298)][_0x5b02b1(0x26b)]['host']??'localhost',_0x34235f=_0xa5b6c9['config']['redis']['port']??0x18eb,_0x37f94f=_0xa5b6c9['config']['redis']['password']??void 0x0,_0x35e19e=_0xa5b6c9[_0x5b02b1(0x298)]['redis']['db']??0x3;return this[_0x5b02b1(0x1b1)]=new _0x36003f['default']({'host':_0x171c13,'port':_0x34235f,'password':_0x37f94f,'db':_0x35e19e,'enableReadyCheck':!0x1,'maxRetriesPerRequest':null,'lazyConnect':!0x0}),this[_0x5b02b1(0x1b1)]['on']('error',_0x349e3e=>{this['logger']['error']('Redis\x20Client\x20Error',_0x349e3e['stack']||_0x349e3e['message']);}),this['redisClient']['on'](_0x5b02b1(0x222),()=>{const _0x2fb03f=_0x5b02b1;this[_0x2fb03f(0x32b)][_0x2fb03f(0x310)]('Redis\x20Client\x20Connected');}),this['redisClient']['on']('ready',()=>{const _0x26e2e0=_0x5b02b1;this['logger'][_0x26e2e0(0x310)]('Redis\x20Client\x20Ready');}),this[_0x5b02b1(0x1b1)]['on'](_0x5b02b1(0x214),()=>{this['logger']['warn']('Redis\x20Client\x20Connection\x20Closed');}),this['redisClient']['on'](_0x5b02b1(0x1fe),()=>{this['logger']['log']('Redis\x20Client\x20Reconnecting...');}),await this[_0x5b02b1(0x1b1)][_0x5b02b1(0x222)](),this['redisClient'];}async['disconnect'](){const _0x252acf=_0xa62bcb;this['redisClient']&&(await this['redisClient']['disconnect'](),this[_0x252acf(0x1b1)]=null,this['logger']['log']('Redis\x20Client\x20Disconnected'));}async['onModuleDestroy'](){await this['disconnect']();}async['get'](_0x38c14d){return(await this['getClient']())['get'](_0x38c14d);}async['set'](_0x35683e,_0x20f171,_0x26f9e0){const _0x5aa833=_0xa62bcb,_0x1f23e6=await this[_0x5aa833(0x2f0)]();if(_0x26f9e0){const _0x537511=Math['ceil'](_0x26f9e0/0x3e8);return _0x1f23e6[_0x5aa833(0x1c7)](_0x35683e,_0x537511,_0x20f171);}return _0x1f23e6['set'](_0x35683e,_0x20f171);}async['setex'](_0x11768d,_0x15a90c,_0x12480e){const _0x1ab28e=_0xa62bcb,_0x918a68=await this[_0x1ab28e(0x2f0)](),_0x4768bf=Math[_0x1ab28e(0x240)](_0x15a90c/0x3e8);return _0x918a68['setex'](_0x11768d,_0x4768bf,_0x12480e);}async[_0xa62bcb(0x2cf)](_0x37f718){const _0x361286=_0xa62bcb;return(await this[_0x361286(0x2f0)]())['del'](_0x37f718);}async['exists'](_0x41a3d2){return(await this['getClient']())['exists'](_0x41a3d2);}async['zadd'](_0x5083e2,_0x4e4483,_0x73c8cf){return(await this['getClient']())['zadd'](_0x5083e2,_0x4e4483,_0x73c8cf);}async[_0xa62bcb(0x22a)](_0x48bc88,_0x9220e4,_0x249374){return(await this['getClient']())['zrange'](_0x48bc88,_0x9220e4,_0x249374);}async['zrangebyscore'](_0xfc05fe,_0x44955a,_0x1bf77a,_0xa37b86){const _0x245989=_0xa62bcb,_0x37a5da=await this['getClient']();return _0xa37b86?_0x37a5da[_0x245989(0x153)](_0xfc05fe,_0x44955a,_0x1bf77a,'LIMIT',_0xa37b86['offset'],_0xa37b86['count']):_0x37a5da['zrangebyscore'](_0xfc05fe,_0x44955a,_0x1bf77a);}async['zrem'](_0x519c28,..._0x3adabb){return(await this['getClient']())['zrem'](_0x519c28,..._0x3adabb);}async['sadd'](_0x3cdd85,..._0x2b7321){const _0x2b324d=_0xa62bcb;return(await this[_0x2b324d(0x2f0)]())['sadd'](_0x3cdd85,..._0x2b7321);}async['sismember'](_0x17a1a0,_0x53405e){const _0x3511d1=_0xa62bcb;return(await this['getClient']())[_0x3511d1(0x24a)](_0x17a1a0,_0x53405e);}async['hset'](_0x504ae1,_0x3d8cd2,_0x236a2c){const _0x52df20=_0xa62bcb;return(await this['getClient']())[_0x52df20(0x2bd)](_0x504ae1,_0x3d8cd2,_0x236a2c);}async['hget'](_0x1b5a96,_0x2f3bf1){return(await this['getClient']())['hget'](_0x1b5a96,_0x2f3bf1);}async['hgetall'](_0x8da2c0){return(await this['getClient']())['hgetall'](_0x8da2c0);}async['expire'](_0x1e02f8,_0x571992){const _0x4a88ec=_0xa62bcb;return(await this[_0x4a88ec(0x2f0)]())[_0x4a88ec(0x228)](_0x1e02f8,_0x571992);}async['setnx'](_0x51478a,_0x20fdc8,_0x53a64e){const _0x5a018a=_0xa62bcb,_0x567962=await this[_0x5a018a(0x2f0)]();if(_0x53a64e){const _0x42834d=Math['ceil'](_0x53a64e/0x3e8);return await _0x567962['set'](_0x51478a,_0x20fdc8,'EX',_0x42834d,'NX');}return await _0x567962['set'](_0x51478a,_0x20fdc8,'NX');}};_0x3fa4bf[_0xa62bcb(0x24f)]=_0x3470df,_0x3fa4bf['RedisService']=_0x3470df=_0x58e112([(0x0,_0x7bfef9['Injectable'])(),_0x35fb04('design:paramtypes',[])],_0x3470df);},_0x1dba63=>{_0x1dba63['exports']=require('ioredis');},function(_0x2dc5f3,_0x21ae6a,_0x17dda4){const _0x3f8b8b=a0_0x2823;var _0x235358,_0x17096d=this&&this['__decorate']||function(_0x1c214d,_0x104e73,_0x7f4657,_0x3aeb97){const _0x193518=a0_0x2823;var _0x55d80e,_0x160766=arguments[_0x193518(0x390)],_0x5232a0=_0x160766<0x3?_0x104e73:null===_0x3aeb97?_0x3aeb97=Object['getOwnPropertyDescriptor'](_0x104e73,_0x7f4657):_0x3aeb97;if(_0x193518(0x374)==typeof Reflect&&'function'==typeof Reflect[_0x193518(0x1ad)])_0x5232a0=Reflect[_0x193518(0x1ad)](_0x1c214d,_0x104e73,_0x7f4657,_0x3aeb97);else{for(var _0x50e6af=_0x1c214d['length']-0x1;_0x50e6af>=0x0;_0x50e6af--)(_0x55d80e=_0x1c214d[_0x50e6af])&&(_0x5232a0=(_0x160766<0x3?_0x55d80e(_0x5232a0):_0x160766>0x3?_0x55d80e(_0x104e73,_0x7f4657,_0x5232a0):_0x55d80e(_0x104e73,_0x7f4657))||_0x5232a0);}return _0x160766>0x3&&_0x5232a0&&Object[_0x193518(0x1b6)](_0x104e73,_0x7f4657,_0x5232a0),_0x5232a0;},_0x5d3b4f=this&&this['__metadata']||function(_0x15ec14,_0x59b349){const _0x3338b7=a0_0x2823;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x3338b7(0x219)])return Reflect[_0x3338b7(0x219)](_0x15ec14,_0x59b349);},_0x41896b=this&&this['__param']||function(_0x16a4e4,_0x2fd32d){return function(_0x282f11,_0x581e3e){_0x2fd32d(_0x282f11,_0x581e3e,_0x16a4e4);};};Object['defineProperty'](_0x21ae6a,'__esModule',{'value':!0x0}),_0x21ae6a[_0x3f8b8b(0x13f)]=void 0x0;const _0x6cd9fd=_0x17dda4(0x2),_0x57cada=_0x17dda4(0x14),_0x2b53f5=_0x17dda4(0x19),_0x2a5dd6=_0x17dda4(0x11);let _0x5b128f=class{constructor(_0x189cab){const _0xd14265=_0x3f8b8b;this['wsService']=_0x189cab,this[_0xd14265(0x32b)]=new _0x6cd9fd['Logger']('HcBoxService');}async[_0x3f8b8b(0x347)](){const _0x302480=_0x3f8b8b;try{return await this['wsService'][_0x302480(0x347)]();}catch(_0x16a3f0){throw this['logger']['error']('Error\x20listing\x20devices:\x20'+_0x16a3f0[_0x302480(0x2c9)]),_0x16a3f0;}}async[_0x3f8b8b(0x30c)](_0x2a9832,_0x4b54dd){const _0x45bbee=_0x3f8b8b;try{this['logger'][_0x45bbee(0x310)]('Executing\x20transfer\x20for\x20withdrawal\x20'+_0x2a9832['withdrawalId']+_0x45bbee(0x345)+_0x4b54dd);const _0x1f7a84=this['getBankBundleId'](_0x2a9832['bankCode']);return _0x1f7a84&&(await this['wsService']['launchApp'](_0x4b54dd,_0x1f7a84),await(0x0,_0x2a5dd6[_0x45bbee(0x349)])(0xbb8)),await this['wsService']['click'](_0x4b54dd,0.5,0.3,0.2),await(0x0,_0x2a5dd6[_0x45bbee(0x349)])(0x7d0),this['logger']['warn']('Transfer\x20execution\x20flow\x20needs\x20to\x20be\x20customized\x20per\x20bank\x20app\x20UI'),this[_0x45bbee(0x32b)]['log']('Transfer\x20execution\x20completed\x20for\x20withdrawal\x20'+_0x2a9832['withdrawalId']),!0x0;}catch(_0x3705ab){throw this[_0x45bbee(0x32b)]['error']('Error\x20executing\x20transfer\x20for\x20withdrawal\x20'+_0x2a9832[_0x45bbee(0x2b6)]+':\x20'+_0x3705ab[_0x45bbee(0x2c9)]),_0x3705ab;}}['getBankBundleId'](_0x55bc0f){return{'VIETCOMBANK':'com.vietcombank.mobilebanking','TPBANK':'com.tpbank.mobilebanking','TECHCOMBANK':'com.techcombank.mobilebanking'}[_0x55bc0f]||null;}async['click'](_0x31075c,_0x3f27e4,_0x1d930e,_0x4edd11=0.2){return this['wsService']['click'](_0x31075c,_0x3f27e4,_0x1d930e,_0x4edd11);}async['swipe'](_0x4bb37d,_0x1f9f9f){return this['wsService']['swipe'](_0x4bb37d,_0x1f9f9f);}async['screen'](_0x5a149c,_0x408791){return this['wsService']['captureScreen'](_0x5a149c,_0x408791);}async['home'](_0x53d4af){const _0x11f613=_0x3f8b8b;return this['wsService'][_0x11f613(0x167)](_0x53d4af);}async['inputNumpadNumber'](_0x540543,_0x4cfcb1){return this['wsService']['inputNumpadNumber'](_0x540543,_0x4cfcb1);}[_0x3f8b8b(0x359)](_0x93c3c6,_0x3405f2){return this['wsService']['inputText'](_0x93c3c6,_0x3405f2);}};_0x21ae6a[_0x3f8b8b(0x13f)]=_0x5b128f,_0x21ae6a['HcBoxService']=_0x5b128f=_0x17096d([(0x0,_0x6cd9fd[_0x3f8b8b(0x185)])(),_0x41896b(0x0,(0x0,_0x6cd9fd['Inject'])(_0x57cada[_0x3f8b8b(0x387)])),_0x5d3b4f('design:paramtypes',['function'==typeof(_0x235358=void 0x0!==_0x2b53f5[_0x3f8b8b(0x2e0)]&&_0x2b53f5[_0x3f8b8b(0x2e0)])?_0x235358:Object])],_0x5b128f);},(_0x16c483,_0x4c0651)=>{Object['defineProperty'](_0x4c0651,'__esModule',{'value':!0x0});},function(_0x47cacc,_0x5bad06,_0x58b8c9){const _0x2e6f65=a0_0x2823;var _0x139dfa,_0x49ba95,_0x476f8d,_0x1597e7,_0x32fc07=this&&this[_0x2e6f65(0x2c3)]||function(_0x52a515,_0x37fe3e,_0x1b473d,_0x543299){const _0xb82379=_0x2e6f65;var _0x2df3bf,_0x1cdad2=arguments['length'],_0x59df90=_0x1cdad2<0x3?_0x37fe3e:null===_0x543299?_0x543299=Object['getOwnPropertyDescriptor'](_0x37fe3e,_0x1b473d):_0x543299;if(_0xb82379(0x374)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x59df90=Reflect['decorate'](_0x52a515,_0x37fe3e,_0x1b473d,_0x543299);else{for(var _0x31cb93=_0x52a515['length']-0x1;_0x31cb93>=0x0;_0x31cb93--)(_0x2df3bf=_0x52a515[_0x31cb93])&&(_0x59df90=(_0x1cdad2<0x3?_0x2df3bf(_0x59df90):_0x1cdad2>0x3?_0x2df3bf(_0x37fe3e,_0x1b473d,_0x59df90):_0x2df3bf(_0x37fe3e,_0x1b473d))||_0x59df90);}return _0x1cdad2>0x3&&_0x59df90&&Object[_0xb82379(0x1b6)](_0x37fe3e,_0x1b473d,_0x59df90),_0x59df90;},_0x4a227e=this&&this['__metadata']||function(_0x2a8668,_0x49e29b){const _0x588d3c=_0x2e6f65;if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x588d3c(0x219)](_0x2a8668,_0x49e29b);},_0x33c663=this&&this['__param']||function(_0x4060b7,_0x1898cd){return function(_0x1503a8,_0x401dfe){_0x1898cd(_0x1503a8,_0x401dfe,_0x4060b7);};};Object['defineProperty'](_0x5bad06,_0x2e6f65(0x143),{'value':!0x0}),_0x5bad06[_0x2e6f65(0x147)]=void 0x0;const _0x30567c=_0x58b8c9(0x2),_0x3a0473=_0x58b8c9(0x15),_0xeb8a3a=_0x58b8c9(0x19),_0x281f52=_0x58b8c9(0x14),_0x14e2cd=_0x58b8c9(0x11),_0x496fe3=_0x58b8c9(0xe),_0x4cd568=_0x58b8c9(0x1b),_0x398e11=_0x58b8c9(0x4),_0x5e776f=_0x58b8c9(0x1c),_0x1eb6c1=_0x58b8c9(0x1d),_0x3b58a7=_0x58b8c9(0x23),_0x3cc15a=_0x58b8c9(0x24);let _0x409f75=_0x139dfa=class{constructor(_0x420cb4,_0x3b862c,_0x31f71b){const _0x508f8b=_0x2e6f65;this['wsService']=_0x420cb4,this['deviceService']=_0x3b862c,this[_0x508f8b(0x15e)]=_0x31f71b,this['baseTransactionFolderPath']='C:/EasyData',this['baseTransactionExecutionFolder']=_0x508f8b(0x296),this['logger']=new _0x30567c[(_0x508f8b(0x294))]('BaseBankService'),_0x139dfa[_0x508f8b(0x180)](this[_0x508f8b(0x1bd)],this['logger']),_0x139dfa['createTransactionFolder'](this['baseTransactionExecutionFolder'],this['logger']);}static['createTransactionFolder'](_0x54be07,_0x34dbc2){const _0x49806e=_0x2e6f65;if(!_0x139dfa['folderCreated']){if(_0x139dfa['folderCreationInProgress']){let _0xe255f4=0x0;const _0x2a541f=0xa;for(;_0x139dfa['folderCreationInProgress']&&_0xe255f4<_0x2a541f;){_0xe255f4++;const _0x2bf2cb=Date['now']();for(;Date['now']()-_0x2bf2cb<0xa;);}if(_0x139dfa[_0x49806e(0x35c)]||(0x0,_0x496fe3['existsSync'])(_0x54be07))return void(_0x139dfa['folderCreated']=!0x0);}try{_0x139dfa[_0x49806e(0x2ee)]=!0x0,(0x0,_0x496fe3['existsSync'])(_0x54be07)?_0x34dbc2['debug']('Base\x20folder\x20already\x20exists:\x20'+_0x54be07):((0x0,_0x496fe3['mkdirSync'])(_0x54be07,{'recursive':!0x0}),_0x34dbc2['log']('Created\x20base\x20folder:\x20'+_0x54be07)),_0x139dfa['folderCreated']=!0x0;}catch(_0x202535){'EEXIST'!==_0x202535[_0x49806e(0x33e)]?_0x34dbc2[_0x49806e(0x134)]('Failed\x20to\x20create\x20base\x20folder\x20'+_0x54be07+':\x20'+_0x202535[_0x49806e(0x2c9)]):(_0x139dfa[_0x49806e(0x35c)]=!0x0,_0x34dbc2['debug']('Base\x20folder\x20already\x20exists\x20(created\x20by\x20another\x20process):\x20'+_0x54be07));}finally{_0x139dfa[_0x49806e(0x2ee)]=!0x1;}}}['getBankCode'](){const _0xef589f=_0x2e6f65;return this[_0xef589f(0x26c)];}async['killApp'](_0x8e43d8){const _0x1f9bab=_0x2e6f65;this[_0x1f9bab(0x32b)]['log']('Killing\x20'+this['BANK_CODE']+'\x20app\x20on\x20device\x20'+_0x8e43d8),await this['wsService'][_0x1f9bab(0x193)](_0x8e43d8,this[_0x1f9bab(0x337)]);}async['clickWithTransition'](_0x4c8d66,_0x4b1200,_0x294f52,_0x5949da,_0x437d0c=''){const _0x41c845=_0x2e6f65;await this['wsService']['click'](_0x4c8d66,_0x4b1200,_0x294f52,0.2),_0x437d0c&&this['logger']['log'](_0x437d0c),await(0x0,_0x14e2cd[_0x41c845(0x349)])(_0x5949da);}async['verifyScreenState'](_0x385975,_0x1c5c9d){const _0x8cf4a7=_0x2e6f65,{expectedTexts:_0x276d86=[],unexpectedTexts:_0x26c1c3=[],timeout:_0x4499fe=0x7530,pollInterval:_0x30b23d=0x1f4,roi:_0xf798f,fieldType:_0x62d70f='full',preprocess:_0xd467af}=_0x1c5c9d,_0x233ecb=Date['now']();let _0x1e6a64=0x0;const _0x2d2c2f=_0xf798f?_0x8cf4a7(0x1a6)+_0xf798f['x']+',\x20y='+_0xf798f['y']+',\x20w='+_0xf798f['width']+',\x20h='+_0xf798f[_0x8cf4a7(0x32f)]:_0x8cf4a7(0x1db);for(this['logger']['debug']('['+_0x385975+']\x20Starting\x20screen\x20verification.\x20Expected:\x20['+_0x276d86['join'](',\x20')+_0x8cf4a7(0x306)+_0x26c1c3['join'](',\x20')+'],\x20'+_0x2d2c2f+_0x8cf4a7(0x169)+_0x4499fe+'ms,\x20Poll:\x20'+_0x30b23d+'ms');Date[_0x8cf4a7(0x1b5)]()-_0x233ecb<_0x4499fe;){_0x1e6a64++;let _0xc2aa9e=null;try{const _0x59b5f8=(0x0,_0x398e11['join'])(this[_0x8cf4a7(0x27a)],'scan_'+_0x385975);try{await(0x0,_0x4cd568[_0x8cf4a7(0x323)])(_0x59b5f8,{'recursive':!0x0});}catch(_0x152352){}const _0x57d3ff=Date['now']();await this['wsService']['captureScreen'](_0x385975,{'folderPath':_0x59b5f8}),await(0x0,_0x14e2cd['sleep'])(0x320);let _0x2aa8b9=null,_0x36d813=0x0;try{const _0x30c1d3=(await(0x0,_0x4cd568['readdir'])(_0x59b5f8))['filter'](_0x1b43c5=>_0x1b43c5['endsWith']('.png'));if(0x0===_0x30c1d3[_0x8cf4a7(0x390)]){this['logger'][_0x8cf4a7(0x343)]('['+_0x385975+']\x20No\x20screenshot\x20files\x20found\x20in\x20folder,\x20retrying...'),await(0x0,_0x14e2cd['sleep'])(_0x30b23d);continue;}const _0x51e5ba=Date['now']();for(const _0x5a811b of _0x30c1d3){const _0xbeed38=(0x0,_0x398e11['join'])(_0x59b5f8,_0x5a811b);try{const _0x3c7e49=await(0x0,_0x4cd568['stat'])(_0xbeed38);if(0x0===_0x3c7e49['size'])continue;_0x51e5ba-_0x3c7e49['mtimeMs']<0x1388&&_0x3c7e49[_0x8cf4a7(0x181)]>=_0x57d3ff-0x7d0&&_0x3c7e49['mtimeMs']>_0x36d813&&(_0x36d813=_0x3c7e49['mtimeMs'],_0x2aa8b9=_0xbeed38);}catch(_0x1d26ab){continue;}}if(!_0x2aa8b9){this['logger'][_0x8cf4a7(0x343)]('['+_0x385975+']\x20No\x20valid\x20screenshot\x20file\x20found\x20(created\x20after\x20capture),\x20retrying...'),await(0x0,_0x14e2cd['sleep'])(_0x30b23d);continue;}_0xc2aa9e=_0x2aa8b9;}catch(_0x46a81c){this[_0x8cf4a7(0x32b)]['debug']('['+_0x385975+']\x20Cannot\x20read\x20screenshot\x20folder,\x20retrying...'),await(0x0,_0x14e2cd[_0x8cf4a7(0x349)])(_0x30b23d);continue;}const _0x48c524=[..._0x276d86,..._0x26c1c3],_0x26f635=await this[_0x8cf4a7(0x15e)]['fastScreenOCR'](_0xc2aa9e,_0x48c524,{'fieldType':_0xf798f?'singleLine':_0x62d70f,'customROI':_0xf798f,'preprocess':_0xd467af});if(_0xc2aa9e)try{await(0x0,_0x4cd568['unlink'])(_0xc2aa9e),_0xc2aa9e=null;}catch(_0x33392d){}if(!_0x26f635||!_0x26f635[_0x8cf4a7(0x164)]){this[_0x8cf4a7(0x32b)][_0x8cf4a7(0x343)]('['+_0x385975+']\x20OCR\x20returned\x20no\x20matches,\x20retrying...\x20(attempt\x20'+_0x1e6a64+')'),await(0x0,_0x14e2cd['sleep'])(_0x30b23d);continue;}const _0x5d8f76=_0x26f635[_0x8cf4a7(0x164)],_0x32f997=_0x26c1c3['some'](_0x4ff80b=>_0x26f635[_0x8cf4a7(0x218)]['includes'](_0x4ff80b));if(_0x5d8f76&&!_0x32f997)return!0x0;_0x1e6a64%0x5==0x0&&this['logger'][_0x8cf4a7(0x343)]('['+_0x385975+']\x20Screen\x20not\x20matched\x20yet\x20(attempt\x20'+_0x1e6a64+').\x20Matched\x20texts:\x20['+_0x26f635['matchedTexts'][_0x8cf4a7(0x22c)](',\x20')+'],\x20Expected:\x20['+_0x276d86['join'](',\x20')+']'),await(0x0,_0x14e2cd['sleep'])(_0x30b23d);}catch(_0x4174ad){if(_0xc2aa9e)try{await(0x0,_0x4cd568[_0x8cf4a7(0x2d6)])(_0xc2aa9e);}catch{}this['logger']['debug']('['+_0x385975+']\x20Error\x20verifying\x20screen\x20(attempt\x20'+_0x1e6a64+'):\x20'+_0x4174ad['message']+',\x20retrying...'),await(0x0,_0x14e2cd['sleep'])(_0x30b23d);}}const _0x37646d=Date['now']()-_0x233ecb;return this[_0x8cf4a7(0x32b)]['warn']('['+_0x385975+']\x20Screen\x20verification\x20timeout\x20after\x20'+_0x37646d+'ms\x20('+_0x1e6a64+'\x20attempts).\x20Expected:\x20['+_0x276d86['join'](',\x20')+']'),!0x1;}async['clickAndWaitForScreen'](_0x422db8,_0xf61511,_0x7d5bc5,_0x124aff,_0x320201){const _0x5e1974=_0x2e6f65;await this[_0x5e1974(0x2ec)][_0x5e1974(0x392)](_0x422db8,_0xf61511,_0x7d5bc5,0.2),_0x320201&&this['logger']['log'](_0x320201);const _0x573c82=await this['verifyScreenState'](_0x422db8,_0x124aff);return this[_0x5e1974(0x32b)]['debug']('['+_0x422db8+']\x20Screen\x20verified\x20after\x20click\x20at\x20('+_0xf61511+',\x20'+_0x7d5bc5+')'),_0x573c82;}async['createBillFolder'](_0x24a8d0){const _0x42cc86=(0x0,_0x398e11['resolve'])(this['baseTransactionFolderPath'],_0x24a8d0);await(0x0,_0x4cd568['mkdir'])(_0x42cc86,{'recursive':!0x0});}async['captureScreen'](_0x29d485,_0x403771){const _0x3d1898=_0x2e6f65;this['logger']['log']('Capturing\x20screen\x20on\x20device\x20'+_0x29d485+'\x20with\x20folderPath:\x20'+_0x403771['folderPath']);const _0x5afce7=(0x0,_0x398e11['resolve'])(this[_0x3d1898(0x1bd)],_0x403771['folderPath']);await this['wsService'][_0x3d1898(0x1da)](_0x29d485,{..._0x403771,'folderPath':_0x5afce7});}async['getBillImage'](_0x29a6c8){const _0x420d62=_0x2e6f65;try{const _0x11be88=(0x0,_0x398e11[_0x420d62(0x22c)])(this['baseTransactionFolderPath'],_0x29a6c8),_0x2225f0=(await(0x0,_0x4cd568['readdir'])(_0x11be88))[0x0];if(!_0x2225f0)return this['logger']['warn']('No\x20image\x20file\x20found\x20in\x20folder:\x20'+_0x29a6c8),null;const _0x4685cb=(0x0,_0x398e11['join'])(_0x11be88,_0x2225f0),_0x3ac5e5=(await(0x0,_0x4cd568['readFile'])(_0x4685cb))['toString'](_0x420d62(0x207)),_0x3e6a0b=_0x2225f0['toLowerCase']()[_0x420d62(0x17f)](_0x2225f0['lastIndexOf']('.'));return'data:'+(0x0,_0x5e776f['getMimeType'])(_0x3e6a0b)+';base64,'+_0x3ac5e5;}catch(_0x43413b){throw this[_0x420d62(0x32b)]['error']('Error\x20loading\x20image\x20from\x20folder\x20'+_0x29a6c8+':\x20'+_0x43413b['message']),_0x43413b;}}async[_0x2e6f65(0x202)](_0x63b39e,_0x2a12ac=0x2710,_0x1ce644=0x1f4){const _0x2c1969=_0x2e6f65;if(!_0x63b39e)return this['logger'][_0x2c1969(0x234)]('Folder\x20path\x20is\x20null\x20or\x20empty'),null;const _0x3d1202=(0x0,_0x398e11['join'])(this[_0x2c1969(0x1bd)],_0x63b39e),_0x5a78a4=Date['now']();let _0x3acab8=0x0;for(this['logger']['debug']('Scanning\x20folder\x20for\x20bill\x20image:\x20'+_0x63b39e+',\x20timeout:\x20'+_0x2a12ac+'ms,\x20pollInterval:\x20'+_0x1ce644+'ms');Date['now']()-_0x5a78a4<_0x2a12ac;){_0x3acab8++;try{if(!(0x0,_0x496fe3['existsSync'])(_0x3d1202)){await(0x0,_0x14e2cd['sleep'])(_0x1ce644);continue;}const _0x3fd93b=await(0x0,_0x4cd568[_0x2c1969(0x335)])(_0x3d1202);if(0x0===_0x3fd93b[_0x2c1969(0x390)]){await(0x0,_0x14e2cd['sleep'])(_0x1ce644);continue;}const _0x274e0c=(await Promise[_0x2c1969(0x28e)](_0x3fd93b['map'](async _0x4ce4df=>{const _0x585d8e=_0x2c1969;try{const _0x1ee0f4=(0x0,_0x398e11[_0x585d8e(0x22c)])(_0x3d1202,_0x4ce4df),_0x1c4758=await(0x0,_0x4cd568['stat'])(_0x1ee0f4);return{'fullPath':_0x1ee0f4,'mtime':_0x1c4758['mtimeMs'],'size':_0x1c4758['size']};}catch(_0x1f5f30){return null;}})))['filter'](_0x5e2673=>null!==_0x5e2673&&_0x5e2673[_0x2c1969(0x373)]>0x0);if(0x0===_0x274e0c['length']){await(0x0,_0x14e2cd[_0x2c1969(0x349)])(_0x1ce644);continue;}_0x274e0c['sort']((_0x38136f,_0x5a926e)=>_0x5a926e['mtime']-_0x38136f['mtime']);const _0x4ab025=_0x274e0c[0x0]['fullPath'],_0x1cb843=Date['now']()-_0x5a78a4;return this[_0x2c1969(0x32b)]['log']('Found\x20latest\x20bill\x20image:\x20'+_0x4ab025+_0x2c1969(0x2f8)+_0x1cb843+'ms\x20('+_0x3acab8+'\x20attempts)'),_0x4ab025;}catch(_0x53a98e){this['logger'][_0x2c1969(0x343)]('Error\x20scanning\x20folder\x20'+_0x63b39e+_0x2c1969(0x235)+_0x3acab8+_0x2c1969(0x176)+_0x53a98e['message']+',\x20retrying...'),await(0x0,_0x14e2cd[_0x2c1969(0x349)])(_0x1ce644);}}const _0x49c934=Date['now']()-_0x5a78a4;return this[_0x2c1969(0x32b)]['warn']('Timeout\x20scanning\x20folder\x20for\x20bill\x20image:\x20'+_0x63b39e+'\x20after\x20'+_0x49c934+_0x2c1969(0x2c2)+_0x3acab8+'\x20attempts)'),null;}async['analyzeTransferBill'](_0x3ecbe5){const _0x35516a=_0x2e6f65,_0x467586=await this['getBillImagePath'](_0x3ecbe5['withdrawalCode']);try{if(!_0x467586)return this[_0x35516a(0x32b)]['warn']('No\x20bill\x20image\x20path\x20'+_0x3ecbe5[_0x35516a(0x31e)]),{'rawPath':null,'analyzedStatus':'na'};const _0x4c5061=await this['ocrService']['fastScreenOCR'](_0x467586,['chuyá»ƒn\x20tiá»n\x20thÃ nh\x20cÃ´ng'],{'fieldType':'singleLine','customROI':_0x3cc15a['PG_ROI_EXPECTED']['TRANSACTION_SUCCESS'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});return _0x4c5061['found']?{'rawPath':_0x467586,'analyzedStatus':_0x4c5061['found']?'success':'unknown'}:(this['logger'][_0x35516a(0x234)](_0x35516a(0x17d)+_0x3ecbe5[_0x35516a(0x31e)]),{'rawPath':_0x467586,'analyzedStatus':'na'});}catch(_0x21578f){return this['logger']['error']('Error\x20analyzing\x20transfer\x20bill:\x20'+_0x21578f['message']),{'rawPath':_0x467586,'analyzedStatus':'na'};}}async['createQRCodeAndTransferTo'](_0x2cc8af,_0x429fff){const _0x133d69=_0x2e6f65,_0x334cdc=(0x0,_0x398e11['join'])(this['baseTransactionExecutionFolder'],'qrcode');await(0x0,_0x4cd568['mkdir'])(_0x334cdc,{'recursive':!0x0});const _0x1ebaea='qr_'+_0x429fff[_0x133d69(0x31e)]+'.png',_0x176400=(0x0,_0x398e11[_0x133d69(0x22c)])(_0x334cdc,_0x1ebaea);await(0x0,_0x3b58a7['toFile'])(_0x176400,_0x429fff[_0x133d69(0x175)],{'type':'png','width':0xe4,'margin':0x2}),this[_0x133d69(0x32b)]['log']('QR\x20code\x20created\x20for\x20withdrawal\x20'+_0x429fff['withdrawalCode']),await this['wsService']['transferFile'](_0x2cc8af,_0x176400,0x1),this[_0x133d69(0x32b)]['log']('['+_0x2cc8af+']\x20QR\x20code\x20is\x20transferred\x20for\x20withdrawal\x20'+_0x429fff['withdrawalId']);}};_0x5bad06['BaseBankService']=_0x409f75,_0x409f75['folderCreationInProgress']=!0x1,_0x409f75['folderCreated']=!0x1,_0x5bad06['BaseBankService']=_0x409f75=_0x139dfa=_0x32fc07([(0x0,_0x30567c[_0x2e6f65(0x185)])(),_0x33c663(0x0,(0x0,_0x30567c[_0x2e6f65(0x212)])(_0x281f52[_0x2e6f65(0x387)])),_0x4a227e(_0x2e6f65(0x381),['function'==typeof(_0x49ba95=void 0x0!==_0xeb8a3a[_0x2e6f65(0x2e0)]&&_0xeb8a3a['IWebSocketService'])?_0x49ba95:Object,_0x2e6f65(0x2d3)==typeof(_0x476f8d=void 0x0!==_0x3a0473['DeviceService']&&_0x3a0473['DeviceService'])?_0x476f8d:Object,_0x2e6f65(0x2d3)==typeof(_0x1597e7=void 0x0!==_0x1eb6c1['OCRService']&&_0x1eb6c1['OCRService'])?_0x1597e7:Object])],_0x409f75);},_0x5ce311=>{const _0x528446=a0_0x2823;_0x5ce311[_0x528446(0x140)]=require('fs/promises');},(_0x132f54,_0x3b03f1)=>{const _0xa025cc=a0_0x2823;Object[_0xa025cc(0x1b6)](_0x3b03f1,_0xa025cc(0x143),{'value':!0x0}),_0x3b03f1['getMimeType']=_0x3b03f1['BILL_IMAGE_EXTENSIONS']=void 0x0,_0x3b03f1['BILL_IMAGE_EXTENSIONS']=['.png'],_0x3b03f1['getMimeType']=_0x15a470=>({'.png':'image/png'}[_0x15a470['toLowerCase']()]||'image/png');},function(_0x390178,_0x79f4ba,_0x252da1){const _0x18662d=a0_0x2823;var _0x5191bc,_0x3a1f4f,_0x1e479c,_0xeed9cb=this&&this['__decorate']||function(_0x1c9579,_0x1fc0b1,_0x2f6fc4,_0x4e6e3e){const _0x4bd750=a0_0x2823;var _0x2421e4,_0x1ee69f=arguments['length'],_0x17c917=_0x1ee69f<0x3?_0x1fc0b1:null===_0x4e6e3e?_0x4e6e3e=Object[_0x4bd750(0x380)](_0x1fc0b1,_0x2f6fc4):_0x4e6e3e;if(_0x4bd750(0x374)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x17c917=Reflect['decorate'](_0x1c9579,_0x1fc0b1,_0x2f6fc4,_0x4e6e3e);else{for(var _0x5aa42a=_0x1c9579['length']-0x1;_0x5aa42a>=0x0;_0x5aa42a--)(_0x2421e4=_0x1c9579[_0x5aa42a])&&(_0x17c917=(_0x1ee69f<0x3?_0x2421e4(_0x17c917):_0x1ee69f>0x3?_0x2421e4(_0x1fc0b1,_0x2f6fc4,_0x17c917):_0x2421e4(_0x1fc0b1,_0x2f6fc4))||_0x17c917);}return _0x1ee69f>0x3&&_0x17c917&&Object[_0x4bd750(0x1b6)](_0x1fc0b1,_0x2f6fc4,_0x17c917),_0x17c917;},_0x335b63=this&&this['__metadata']||function(_0x3c4951,_0x1d77e1){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x3c4951,_0x1d77e1);};Object['defineProperty'](_0x79f4ba,_0x18662d(0x143),{'value':!0x0}),_0x79f4ba['OCRService']=_0x79f4ba[_0x18662d(0x22d)]=_0x79f4ba['ROI']=void 0x0;const _0x151edb=_0x252da1(0x2),_0x6f97ac=_0x252da1(0x1b),_0x374092=_0x252da1(0x1e),_0x129d86=_0x252da1(0x20),_0x388dd9=_0x252da1(0x22),_0x4951b3=_0x252da1(0xf);var _0xd7cedb=_0x252da1(0x20);Object['defineProperty'](_0x79f4ba,_0x18662d(0x2f6),{'enumerable':!0x0,'get':function(){return _0xd7cedb['ROI'];}}),Object['defineProperty'](_0x79f4ba,'PreprocessOptions',{'enumerable':!0x0,'get':function(){const _0x8400f7=_0x18662d;return _0xd7cedb[_0x8400f7(0x22d)];}});const _0x325d51={'crop':{'x':0x0,'y':0x0,'width':0x1,'height':0x1},'psm':0x6,'charWhitelist':void 0x0,'maxWidth':0x4b0};let _0x565c0e=_0x5191bc=class{constructor(_0x3e8008,_0x3d341a){const _0x2532c1=_0x18662d;this['workerPoolService']=_0x3e8008,this['imagePreprocessingService']=_0x3d341a,this['logger']=new _0x151edb[(_0x2532c1(0x294))](_0x5191bc['name']),this['ocrConfig']={'poolSize':_0x4951b3['config'][_0x2532c1(0x229)][_0x2532c1(0x1df)],'lang':_0x4951b3[_0x2532c1(0x298)][_0x2532c1(0x229)]['lang'],'rois':{'full':_0x325d51,'singleLine':{..._0x325d51,'psm':0x7},'block':{..._0x325d51,'psm':0x6}}};}['validateROI'](_0x4e6143){const _0x439834=_0x18662d;return{'x':Math[_0x439834(0x38d)](0x0,Math['min'](0x1,_0x4e6143['x']||0x0)),'y':Math['max'](0x0,Math['min'](0x1,_0x4e6143['y']||0x0)),'width':Math[_0x439834(0x38d)](0.01,Math['min'](0x1,_0x4e6143['width']||0x1)),'height':Math['max'](0.01,Math['min'](0x1,_0x4e6143['height']||0x1))};}['getROIConfig'](_0x34963e){const _0x499db0=_0x18662d,_0x4757e9=this['ocrConfig']['rois']?.[_0x34963e]||this[_0x499db0(0x2d4)][_0x499db0(0x33c)]?.['full']||_0x325d51;return{'crop':_0x4757e9['crop']||_0x325d51['crop'],'psm':_0x4757e9[_0x499db0(0x1a1)]??_0x325d51[_0x499db0(0x1a1)],'charWhitelist':_0x4757e9['charWhitelist'],'maxWidth':_0x4757e9[_0x499db0(0x2a4)]??_0x325d51['maxWidth']};}async[_0x18662d(0x2da)](_0x509c79,_0x18ae3d={}){const _0x2373c5=_0x18662d,_0x3a65d7=Date[_0x2373c5(0x1b5)](),_0x249729={'decodeImage':0x0,'preprocess':0x0,'ocrRecognize':0x0,'postprocess':0x0};try{const _0x5e3dae=Date[_0x2373c5(0x1b5)](),_0xaa463d=await(0x0,_0x6f97ac['readFile'])(_0x509c79);_0x249729[_0x2373c5(0x297)]=Date['now']()-_0x5e3dae;const _0x265e4a=_0x18ae3d['fieldType']||_0x2373c5(0x326),_0x51bd03=this[_0x2373c5(0x1b8)](_0x265e4a),_0x2e1761=this['validateROI'](_0x18ae3d['customROI']||_0x51bd03['crop']),_0x2c76f9=Date['now'](),_0x95ce69=await this[_0x2373c5(0x353)]['preprocess'](_0xaa463d,_0x2e1761,_0x51bd03[_0x2373c5(0x2a4)],_0x18ae3d['preprocess']);_0x249729[_0x2373c5(0x334)]=Date[_0x2373c5(0x1b5)]()-_0x2c76f9;const _0x2f84b1=Date[_0x2373c5(0x1b5)](),_0x51b224=await this['workerPoolService']['recognize'](_0x95ce69[_0x2373c5(0x171)],{'psm':_0x51bd03[_0x2373c5(0x1a1)],'charWhitelist':_0x51bd03['charWhitelist']});_0x249729['ocrRecognize']=Date['now']()-_0x2f84b1;const _0x21cc7b=Date[_0x2373c5(0x1b5)](),_0x5dd2b9=this[_0x2373c5(0x17e)](_0x51b224[_0x2373c5(0x198)]);_0x249729['postprocess']=Date['now']()-_0x21cc7b;const _0x510f22=Date['now']()-_0x3a65d7;return this['logTimingBreakdown'](_0x509c79,_0x265e4a,_0x510f22,_0x249729,_0x51b224['confidence']),{'text':_0x5dd2b9,'confidence':_0x51b224['confidence'],'processingTime':_0x510f22,'timingBreakdown':_0x249729};}catch(_0x41bf6b){return this[_0x2373c5(0x32b)]['error']('OCR\x20error\x20for\x20'+_0x509c79+':\x20'+_0x41bf6b[_0x2373c5(0x2c9)],_0x41bf6b[_0x2373c5(0x2dc)]),null;}}async['recognizeFromBuffer'](_0x2db898,_0x29fec6={}){const _0x16948c=_0x18662d,_0x240d97=Date['now'](),_0x198a97={'decodeImage':0x0,'preprocess':0x0,'ocrRecognize':0x0,'postprocess':0x0};try{_0x198a97['decodeImage']=0x0;const _0x59fe37=_0x29fec6['fieldType']||'full',_0x286ab4=this[_0x16948c(0x1b8)](_0x59fe37),_0x28d4b9=this['validateROI'](_0x29fec6['customROI']||_0x286ab4['crop']),_0x3f1dc1=Date[_0x16948c(0x1b5)](),_0x35d1c5=await this['imagePreprocessingService']['preprocess'](_0x2db898,_0x28d4b9,_0x286ab4[_0x16948c(0x2a4)],_0x29fec6[_0x16948c(0x334)]);_0x198a97[_0x16948c(0x334)]=Date[_0x16948c(0x1b5)]()-_0x3f1dc1;const _0xa6286c=Date['now'](),_0x17c903=await this['workerPoolService']['recognize'](_0x35d1c5['buffer'],{'psm':_0x286ab4[_0x16948c(0x1a1)],'charWhitelist':_0x286ab4['charWhitelist']});_0x198a97['ocrRecognize']=Date['now']()-_0xa6286c;const _0x5e0805=Date['now'](),_0x5d4316=this['postprocessText'](_0x17c903[_0x16948c(0x198)]);_0x198a97['postprocess']=Date['now']()-_0x5e0805;const _0xf15d77=Date[_0x16948c(0x1b5)]()-_0x240d97;return this['logTimingBreakdown']('buffer',_0x59fe37,_0xf15d77,_0x198a97,_0x17c903[_0x16948c(0x20d)]),{'text':_0x5d4316,'confidence':_0x17c903['confidence'],'processingTime':_0xf15d77,'timingBreakdown':_0x198a97};}catch(_0x40cc2f){return this['logger']['error']('OCR\x20error\x20from\x20buffer:\x20'+_0x40cc2f['message'],_0x40cc2f['stack']),null;}}async['fastScreenOCR'](_0x286553,_0x18c9f8,_0x260c1c={}){const _0x477c94=_0x18662d,_0x535e46=await this['recognizeFromFile'](_0x286553,{'fieldType':_0x260c1c['fieldType']||'full','customROI':_0x260c1c['customROI'],'preprocess':_0x260c1c['preprocess']});if(!_0x535e46||!_0x535e46['text'])return{'found':!0x1,'matchedTexts':[],'result':_0x535e46};const _0x230317=(0x0,_0x388dd9['normalizeBankAccountName'])(_0x535e46['text']),_0x35d013=_0x18c9f8['filter'](_0x2efee2=>_0x230317['includes']((0x0,_0x388dd9['normalizeBankAccountName'])(_0x2efee2)));return{'found':_0x35d013[_0x477c94(0x390)]>0x0,'matchedTexts':_0x35d013,'result':_0x535e46};}['postprocessText'](_0x38e1ff){const _0x3a78a9=_0x18662d;return _0x38e1ff[_0x3a78a9(0x250)]()[_0x3a78a9(0x21e)](/\s+/g,'\x20')['replace'](/\n{3,}/g,'\x0a\x0a');}[_0x18662d(0x280)](_0x4cb133,_0x578129,_0x3c8e78,_0x451247,_0x271e25){const _0xac3552=_0x18662d;['decode='+_0x451247['decodeImage']+'ms','preprocess='+_0x451247[_0xac3552(0x334)]+'ms','ocr='+_0x451247[_0xac3552(0x277)]+'ms','postprocess='+_0x451247[_0xac3552(0x2bf)]+'ms'][_0xac3552(0x22c)]('\x20|\x20'),_0x3c8e78>0x3e8&&this[_0xac3552(0x32b)][_0xac3552(0x234)]('âš ï¸\x20OCR\x20latency\x20exceeded\x20target:\x20'+_0x3c8e78+_0xac3552(0x217));}};_0x79f4ba[_0x18662d(0x2ac)]=_0x565c0e,_0x79f4ba[_0x18662d(0x2ac)]=_0x565c0e=_0x5191bc=_0xeed9cb([(0x0,_0x151edb[_0x18662d(0x185)])(),_0x335b63('design:paramtypes',[_0x18662d(0x2d3)==typeof(_0x3a1f4f=void 0x0!==_0x374092['OCRWorkerPoolService']&&_0x374092['OCRWorkerPoolService'])?_0x3a1f4f:Object,'function'==typeof(_0x1e479c=void 0x0!==_0x129d86['ImagePreprocessingService']&&_0x129d86['ImagePreprocessingService'])?_0x1e479c:Object])],_0x565c0e);},function(_0x16067d,_0x4709f1,_0xe18347){const _0x2d45fe=a0_0x2823;var _0x12ba67=this&&this['__decorate']||function(_0x2b3ef2,_0xf09b37,_0x276aaf,_0x2498d1){const _0x4751a5=a0_0x2823;var _0x4b926b,_0x14c069=arguments[_0x4751a5(0x390)],_0x5def57=_0x14c069<0x3?_0xf09b37:null===_0x2498d1?_0x2498d1=Object['getOwnPropertyDescriptor'](_0xf09b37,_0x276aaf):_0x2498d1;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x4751a5(0x1ad)])_0x5def57=Reflect['decorate'](_0x2b3ef2,_0xf09b37,_0x276aaf,_0x2498d1);else{for(var _0xda66d1=_0x2b3ef2['length']-0x1;_0xda66d1>=0x0;_0xda66d1--)(_0x4b926b=_0x2b3ef2[_0xda66d1])&&(_0x5def57=(_0x14c069<0x3?_0x4b926b(_0x5def57):_0x14c069>0x3?_0x4b926b(_0xf09b37,_0x276aaf,_0x5def57):_0x4b926b(_0xf09b37,_0x276aaf))||_0x5def57);}return _0x14c069>0x3&&_0x5def57&&Object['defineProperty'](_0xf09b37,_0x276aaf,_0x5def57),_0x5def57;},_0x3f7f35=this&&this['__metadata']||function(_0x4d1b67,_0x2ed14c){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x4d1b67,_0x2ed14c);};Object['defineProperty'](_0x4709f1,'__esModule',{'value':!0x0}),_0x4709f1['OCRWorkerPoolService']=void 0x0;const _0x40c660=_0xe18347(0x2),_0x3c8c28=_0xe18347(0x1f),_0x234a97=_0xe18347(0xf);let _0x158912=class{constructor(){const _0x213923=a0_0x2823;this['logger']=new _0x40c660[(_0x213923(0x294))](_0x213923(0x1d0)),this[_0x213923(0x2ff)]=[],this['waitingQueue']=[],this['maxWaitTime']=0x1388,this[_0x213923(0x16e)]=0xa,this['isInitializing']=!0x1,this['isDestroyed']=!0x1,this['isAcquiring']=!0x1,this['initializationPromise']=null,this['poolSize']=Math['max'](0x1,Math['min'](_0x234a97[_0x213923(0x298)][_0x213923(0x229)]['poolSize'],this['maxPoolSize'])),this['lang']=_0x234a97['config'][_0x213923(0x229)][_0x213923(0x2fb)],_0x234a97['config'][_0x213923(0x229)][_0x213923(0x1df)]>this[_0x213923(0x16e)]&&this['logger']['warn'](_0x213923(0x16f)+_0x234a97[_0x213923(0x298)]['ocr']['poolSize']+')\x20exceeds\x20maximum\x20('+this[_0x213923(0x16e)]+_0x213923(0x204)+this['maxPoolSize']+'.');}async['onModuleInit'](){await this['warmPool']();}async[_0x2d45fe(0x203)](){const _0x32ad84=_0x2d45fe;this[_0x32ad84(0x2ba)]=!0x0,this['rejectAllPending'](new Error(_0x32ad84(0x1bb))),await this['terminateAll']();}async['warmPool'](){const _0x21e8b3=_0x2d45fe;if(this[_0x21e8b3(0x35b)])return this['initializationPromise']||Promise[_0x21e8b3(0x278)]();this['isInitializing']=!0x0,this['initializationPromise']=this[_0x21e8b3(0x23d)]();try{await this['initializationPromise'];}finally{this['isInitializing']=!0x1;}}async['doWarmPool'](){const _0x8b131b=_0x2d45fe,_0x148492=Date['now']();this[_0x8b131b(0x32b)][_0x8b131b(0x310)]('Warming\x20up\x20OCR\x20worker\x20pool\x20(size:\x20'+this['poolSize']+_0x8b131b(0x17b)+this['lang']+')...');const _0x25366a=Array['from']({'length':this['poolSize']},(_0x4bcd27,_0x22175c)=>this[_0x8b131b(0x34d)](_0x22175c));try{await Promise['all'](_0x25366a);const _0x35cc0d=Date['now']()-_0x148492;this['logger'][_0x8b131b(0x310)]('OCR\x20worker\x20pool\x20warmed\x20up\x20successfully\x20in\x20'+_0x35cc0d+'ms.\x20Pool\x20size:\x20'+this['pool'][_0x8b131b(0x390)]);}catch(_0x1e3f8a){throw this[_0x8b131b(0x32b)]['error']('Failed\x20to\x20warm\x20up\x20worker\x20pool:\x20'+_0x1e3f8a['message'],_0x1e3f8a['stack']),await this[_0x8b131b(0x382)](),_0x1e3f8a;}}async['createWorker'](_0x2da444){const _0x53f7e2=_0x2d45fe;try{const _0x844408=await _0x3c8c28['createWorker'](this['lang'],0x1,{'logger':_0x3b0c0d=>{const _0x1fb3a3=a0_0x2823;'error'===_0x3b0c0d['status']&&this['logger']['error'](_0x1fb3a3(0x289)+_0x2da444+_0x1fb3a3(0x2b3)+_0x3b0c0d['message']);}});this['pool']['push']({'id':_0x2da444,'worker':_0x844408,'inUse':!0x1,'lastUsed':Date['now']()}),this[_0x53f7e2(0x32b)]['debug']('Worker\x20'+_0x2da444+_0x53f7e2(0x307));}catch(_0x41383c){throw this[_0x53f7e2(0x32b)]['error'](_0x53f7e2(0x1ec)+_0x2da444+':\x20'+_0x41383c['message']),_0x41383c;}}async['acquireWorker'](){const _0x4dd8b7=_0x2d45fe;if(this[_0x4dd8b7(0x2ba)])throw new Error('OCR\x20service\x20is\x20destroyed');return this[_0x4dd8b7(0x35b)]&&this['initializationPromise']&&await this[_0x4dd8b7(0x356)],this['tryAcquireFromPool']()||this['waitForWorker']();}['tryAcquireFromPool'](){const _0x26581b=_0x2d45fe;if(this[_0x26581b(0x1d9)])return null;this[_0x26581b(0x1d9)]=!0x0;try{for(const _0x4b8424 of this['pool'])if(!_0x4b8424['inUse'])return _0x4b8424['inUse']=!0x0,_0x4b8424['lastUsed']=Date['now'](),_0x4b8424;return null;}finally{this['isAcquiring']=!0x1;}}[_0x2d45fe(0x2cd)](){return new Promise((_0x2ea66d,_0x403ea2)=>{const _0x4fc942=a0_0x2823,_0x4ddd67=setTimeout(()=>{const _0x3fcd3b=a0_0x2823,_0xb30092=this[_0x3fcd3b(0x188)][_0x3fcd3b(0x369)](_0x2c3547=>_0x2c3547[_0x3fcd3b(0x278)]===_0x2ea66d);-0x1!==_0xb30092&&this[_0x3fcd3b(0x188)][_0x3fcd3b(0x348)](_0xb30092,0x1),this['logger']['warn']('Timeout\x20waiting\x20for\x20worker,\x20creating\x20temporary\x20worker'),this[_0x3fcd3b(0x37a)]()['then'](_0x2ea66d)['catch'](_0x403ea2);},this[_0x4fc942(0x24e)]);this['waitingQueue']['push']({'resolve':_0x2ea66d,'reject':_0x403ea2,'timeout':_0x4ddd67});});}async['createTemporaryWorker'](){const _0x438b61=_0x2d45fe;return{'id':-0x1,'worker':await _0x3c8c28['createWorker'](this[_0x438b61(0x2fb)],0x1,{'logger':()=>{}}),'inUse':!0x0,'lastUsed':Date['now']()};}[_0x2d45fe(0x37c)](_0xf2803b){const _0x469cd4=_0x2d45fe;if(this['waitingQueue']['length']>0x0){const _0x59a000=this['waitingQueue']['shift']();clearTimeout(_0x59a000['timeout']),_0xf2803b[_0x469cd4(0x312)]=Date[_0x469cd4(0x1b5)](),_0x59a000['resolve'](_0xf2803b);}else _0xf2803b['inUse']=!0x1,_0xf2803b['lastUsed']=Date['now']();}['rejectAllPending'](_0x2d7ecd){const _0x59a6d5=_0x2d45fe;for(;this['waitingQueue'][_0x59a6d5(0x390)]>0x0;){const _0x14bfa4=this['waitingQueue']['shift']();clearTimeout(_0x14bfa4['timeout']),_0x14bfa4['reject'](_0x2d7ecd);}}async['recognize'](_0x47e390,_0x402af6={}){const _0x264d45=_0x2d45fe,_0x2183e9=await this['acquireWorker'](),_0x50f6f2=_0x2183e9['id']<0x0,{psm:_0x46131d,charWhitelist:_0x5348ff}=_0x402af6,_0x1d7f92=void 0x0!==_0x46131d||!!_0x5348ff;try{const _0x208532={};void 0x0!==_0x46131d&&(_0x208532['tessedit_pageseg_mode']=_0x46131d),_0x5348ff&&(_0x208532['tessedit_char_whitelist']=_0x5348ff),Object[_0x264d45(0x156)](_0x208532)['length']>0x0&&await _0x2183e9[_0x264d45(0x2c1)]['setParameters'](_0x208532);const {data:_0x43c58e}=await _0x2183e9['worker']['recognize'](_0x47e390);return{'text':_0x43c58e['text'],'confidence':_0x43c58e[_0x264d45(0x20d)]};}finally{if(_0x50f6f2)try{await _0x2183e9[_0x264d45(0x2c1)][_0x264d45(0x1f2)]();}catch(_0x4787c6){this['logger']['warn'](_0x264d45(0x36a)+_0x4787c6[_0x264d45(0x2c9)]);}else{if(_0x1d7f92)try{await _0x2183e9[_0x264d45(0x2c1)][_0x264d45(0x1c9)]({'tessedit_pageseg_mode':0x6,'tessedit_char_whitelist':''});}catch(_0x2a2a90){this[_0x264d45(0x32b)][_0x264d45(0x234)]('Failed\x20to\x20reset\x20worker\x20parameters:\x20'+_0x2a2a90['message']);}this['releaseWorker'](_0x2183e9);}}}[_0x2d45fe(0x14d)](){const _0x319be1=_0x2d45fe;return{'total':this['pool']['length'],'inUse':this['pool']['filter'](_0x3d8d90=>_0x3d8d90['inUse'])[_0x319be1(0x390)],'waiting':this['waitingQueue']['length']};}async['terminateAll'](){const _0x228a7c=_0x2d45fe;if(0x0===this['pool']['length'])return;this['logger'][_0x228a7c(0x310)]('Terminating\x20'+this['pool']['length']+'\x20OCR\x20workers...');const _0x4390a7=this['pool']['map'](_0x1e1701=>_0x1e1701[_0x228a7c(0x2c1)]['terminate']()['then'](()=>{const _0x5f0709=_0x228a7c;this[_0x5f0709(0x32b)]['debug'](_0x5f0709(0x220)+_0x1e1701['id']+_0x5f0709(0x336));})['catch'](_0x3861fb=>{const _0x3be097=_0x228a7c;this['logger']['error']('Error\x20terminating\x20worker\x20'+_0x1e1701['id']+':\x20'+_0x3861fb[_0x3be097(0x2c9)]);}));await Promise['all'](_0x4390a7),this[_0x228a7c(0x2ff)][_0x228a7c(0x390)]=0x0,this['logger'][_0x228a7c(0x310)]('All\x20OCR\x20workers\x20terminated');}};_0x4709f1['OCRWorkerPoolService']=_0x158912,_0x4709f1['OCRWorkerPoolService']=_0x158912=_0x12ba67([(0x0,_0x40c660['Injectable'])(),_0x3f7f35('design:paramtypes',[])],_0x158912);},_0x276448=>{_0x276448['exports']=require('tesseract.js');},function(_0x19f8a1,_0x1ffe5c,_0x12991c){const _0xb28698=a0_0x2823;var _0x38ef6b=this&&this['__decorate']||function(_0x4c69ee,_0x2bb019,_0x31f338,_0x23d55d){var _0x3d0499,_0x1b25da=arguments['length'],_0x2b5e39=_0x1b25da<0x3?_0x2bb019:null===_0x23d55d?_0x23d55d=Object['getOwnPropertyDescriptor'](_0x2bb019,_0x31f338):_0x23d55d;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x2b5e39=Reflect['decorate'](_0x4c69ee,_0x2bb019,_0x31f338,_0x23d55d);else{for(var _0x5c27a8=_0x4c69ee['length']-0x1;_0x5c27a8>=0x0;_0x5c27a8--)(_0x3d0499=_0x4c69ee[_0x5c27a8])&&(_0x2b5e39=(_0x1b25da<0x3?_0x3d0499(_0x2b5e39):_0x1b25da>0x3?_0x3d0499(_0x2bb019,_0x31f338,_0x2b5e39):_0x3d0499(_0x2bb019,_0x31f338))||_0x2b5e39);}return _0x1b25da>0x3&&_0x2b5e39&&Object['defineProperty'](_0x2bb019,_0x31f338,_0x2b5e39),_0x2b5e39;};Object['defineProperty'](_0x1ffe5c,'__esModule',{'value':!0x0}),_0x1ffe5c['ImagePreprocessingService']=void 0x0;const _0x42f452=_0x12991c(0x2),_0x12f922=_0x12991c(0x21);let _0xd91f10=class{constructor(){const _0x4eebb4=a0_0x2823;this['logger']=new _0x42f452['Logger'](_0x4eebb4(0x206)),this['MIN_DIMENSION']=0xa;}['validateROI'](_0x513361){const _0x5d03f2=a0_0x2823;if(_0x513361['x']<0x0||_0x513361['x']>0x1)throw new Error(_0x5d03f2(0x324)+_0x513361['x']+'\x20(must\x20be\x200-1)');if(_0x513361['y']<0x0||_0x513361['y']>0x1)throw new Error('Invalid\x20ROI\x20y:\x20'+_0x513361['y']+_0x5d03f2(0x30e));if(_0x513361[_0x5d03f2(0x205)]<=0x0||_0x513361[_0x5d03f2(0x205)]>0x1)throw new Error('Invalid\x20ROI\x20width:\x20'+_0x513361[_0x5d03f2(0x205)]+'\x20(must\x20be\x200-1)');if(_0x513361['height']<=0x0||_0x513361['height']>0x1)throw new Error('Invalid\x20ROI\x20height:\x20'+_0x513361['height']+'\x20(must\x20be\x200-1)');if(_0x513361['x']+_0x513361['width']>1.001)throw new Error(_0x5d03f2(0x2f3)+_0x513361['x']+_0x5d03f2(0x1a4)+_0x513361[_0x5d03f2(0x205)]+_0x5d03f2(0x17a));if(_0x513361['y']+_0x513361['height']>1.001)throw new Error('ROI\x20extends\x20beyond\x20image:\x20y('+_0x513361['y']+')\x20+\x20height('+_0x513361[_0x5d03f2(0x32f)]+')\x20>\x201');}async['preprocess'](_0x4e5bfb,_0x3631c4,_0x4c5774,_0xe8215={}){const _0x5ee733=a0_0x2823;Date['now']();try{this[_0x5ee733(0x2dd)](_0x3631c4);const _0xc9b267=_0x12f922(_0x4e5bfb),_0x2407f4=await _0xc9b267['metadata'](),_0x4ab8db=_0x2407f4['width']||0x0,_0x3c44f9=_0x2407f4['height']||0x0;if(0x0===_0x4ab8db||0x0===_0x3c44f9)throw new Error('Invalid\x20image\x20dimensions:\x20width\x20or\x20height\x20is\x200');if(_0x4ab8db<this['MIN_DIMENSION']||_0x3c44f9<this['MIN_DIMENSION'])throw new Error('Image\x20too\x20small:\x20'+_0x4ab8db+'x'+_0x3c44f9+'\x20(min:\x20'+this['MIN_DIMENSION']+'x'+this['MIN_DIMENSION']+')');const _0x1b4ec8=Math['floor'](_0x3631c4['x']*_0x4ab8db),_0x28749e=Math['floor'](_0x3631c4['y']*_0x3c44f9),_0x421ccf=Math[_0x5ee733(0x144)](_0x3631c4[_0x5ee733(0x205)]*_0x4ab8db),_0x3bcb27=Math['floor'](_0x3631c4[_0x5ee733(0x32f)]*_0x3c44f9),_0x2aad29=Math['max'](0x0,Math[_0x5ee733(0x18c)](_0x1b4ec8,_0x4ab8db-0x1)),_0x354798=Math['max'](0x0,Math['min'](_0x28749e,_0x3c44f9-0x1)),_0x472e7f=Math['max'](this['MIN_DIMENSION'],Math['min'](_0x421ccf,_0x4ab8db-_0x2aad29)),_0xf01522=Math['max'](this['MIN_DIMENSION'],Math['min'](_0x3bcb27,_0x3c44f9-_0x354798));let _0x9da6fa=_0xc9b267[_0x5ee733(0x2e7)]({'left':_0x2aad29,'top':_0x354798,'width':_0x472e7f,'height':_0xf01522}),_0x4fc20e=_0x472e7f,_0x15c6b7=_0xf01522,_0x9f1202=0x1;return _0x4c5774&&_0x472e7f>_0x4c5774&&(_0x9f1202=_0x4c5774/_0x472e7f,_0x4fc20e=_0x4c5774,_0x15c6b7=Math['max'](this['MIN_DIMENSION'],Math['floor'](_0xf01522*_0x9f1202)),_0x9da6fa=_0x9da6fa['resize'](_0x4fc20e,_0x15c6b7,{'kernel':_0x12f922['kernel']['lanczos3'],'withoutEnlargement':!0x0})),_0xe8215['grayscale']&&(_0x9da6fa=_0x9da6fa['grayscale']()),_0xe8215['enhanceContrast']&&(_0x9da6fa=_0x9da6fa[_0x5ee733(0x196)]()),{'buffer':await _0x9da6fa[_0x5ee733(0x383)]()['toBuffer'](),'metadata':{'originalWidth':_0x4ab8db,'originalHeight':_0x3c44f9,'processedWidth':_0x4fc20e,'processedHeight':_0x15c6b7,'scaleFactor':_0x9f1202}};}catch(_0x1db681){throw this[_0x5ee733(0x32b)]['error'](_0x5ee733(0x303)+_0x1db681[_0x5ee733(0x2c9)],_0x1db681[_0x5ee733(0x2dc)]),_0x1db681;}}};_0x1ffe5c['ImagePreprocessingService']=_0xd91f10,_0x1ffe5c[_0xb28698(0x206)]=_0xd91f10=_0x38ef6b([(0x0,_0x42f452['Injectable'])()],_0xd91f10);},_0x320785=>{_0x320785['exports']=require('sharp');},(_0x1db728,_0x25b295)=>{const _0x1a5930=a0_0x2823;Object['defineProperty'](_0x25b295,'__esModule',{'value':!0x0}),_0x25b295['normalizeBankAccountName']=_0x25b295['removeVietnameseTones']=void 0x0,_0x25b295['removeVietnameseTones']=_0x10a0fa=>_0x10a0fa?_0x10a0fa[_0x1a5930(0x196)]('NFD')['replace'](/[\u0300-\u036f]/g,'')['replace'](/Ä‘/g,'d')['replace'](/Ä/g,'D'):'',_0x25b295[_0x1a5930(0x2cc)]=_0x56f5be=>_0x56f5be?(0x0,_0x25b295['removeVietnameseTones'])(_0x56f5be)[_0x1a5930(0x250)]()['replace'](/ /g,'')['toLocaleUpperCase']():'';},_0x75c5f4=>{_0x75c5f4['exports']=require('qrcode');},(_0x1aea50,_0xe5daf0)=>{const _0x320f8d=a0_0x2823;Object['defineProperty'](_0xe5daf0,_0x320f8d(0x143),{'value':!0x0}),_0xe5daf0['PG_ROI_EXPECTED']=void 0x0,_0xe5daf0['PG_ROI_EXPECTED']={'LAUNCH_APP':{'x':0.05,'y':0.54,'width':0.7,'height':0.1},'VERIFY_ACCOUNT_NAME':{'x':0.05,'y':0.55,'width':0.9,'height':0.25},'TRANSACTION_CONFIRM':{'x':0.05,'y':0.05,'width':0.9,'height':0.2},'TRANSACTION_VERIFY':{'x':0.05,'y':0.05,'width':0.9,'height':0.2},'TRANSACTION_SUCCESS':{'x':0.1,'y':0.2,'width':0.9,'height':0.3},'HOME_SCREEN':{'x':0.02,'y':0.7,'width':0.98,'height':0.3}};},(_0x38fdea,_0x2be752,_0x3e77e2)=>{const _0x2db531=a0_0x2823;Object[_0x2db531(0x1b6)](_0x2be752,'__esModule',{'value':!0x0}),_0x2be752['NUMPAD_LAYOUT']=_0x2be752[_0x2db531(0x23a)]=_0x2be752[_0x2db531(0x272)]=_0x2be752[_0x2db531(0x37d)]=void 0x0;const _0x4bb5ad=_0x3e77e2(0xf);_0x2be752[_0x2db531(0x37d)]=(_0x5aa0c4,_0x49f75d=0x64)=>Object['fromEntries'](Object['entries'](_0x5aa0c4)['map'](([_0x4c3f7f,_0x49d6ae])=>[_0x4c3f7f,{'x':Math['round'](_0x49d6ae['x']*_0x49f75d),'y':Math[_0x2db531(0x257)](_0x49d6ae['y']*_0x49f75d)}]));const _0x25add6={0x0:{'x':0.55,'y':0.95},0x1:{'x':0.25,'y':0.7},0x2:{'x':0.55,'y':0.7},0x3:{'x':0.85,'y':0.7},0x4:{'x':0.25,'y':0.8},0x5:{'x':0.55,'y':0.8},0x6:{'x':0.85,'y':0.8},0x7:{'x':0.25,'y':0.9},0x8:{'x':0.55,'y':0.9},0x9:{'x':0.85,'y':0.9}},_0x3966f1={'KEYBOARD_SWITCH':{'x':0.05,'y':0.95},'SHIFT_KEY':{'x':0.05,'y':0.88},'RETURN_KEY':{'x':0.95,'y':0.95}},_0x184829=(0x0,_0x2be752[_0x2db531(0x37d)])(_0x3966f1),_0x2e4415=(0x0,_0x2be752['scaleCoordinates'])(_0x25add6);_0x2be752['COMMON_COORDINATES']=_0x2db531(0x32a)===_0x4bb5ad['config']['boxType']?_0x184829:_0x3966f1,_0x2be752['KEYBOARD_LAYOUT']={0x0:{'x':0.95,'y':0.68},0x1:{'x':0.05,'y':0.68},0x2:{'x':0.15,'y':0.68},0x3:{'x':0.25,'y':0.68},0x4:{'x':0.35,'y':0.68},0x5:{'x':0.45,'y':0.68},0x6:{'x':0.55,'y':0.68},0x7:{'x':0.65,'y':0.68},0x8:{'x':0.75,'y':0.68},0x9:{'x':0.85,'y':0.68},'@':{'x':0.85,'y':0.78},'!':{'x':0.65,'y':0.88},'a':{'x':0.1,'y':0.78},'b':{'x':0.6,'y':0.88},'c':{'x':0.4,'y':0.88},'d':{'x':0.3,'y':0.78},'e':{'x':0.25,'y':0.68},'f':{'x':0.4,'y':0.78},'g':{'x':0.5,'y':0.78},'h':{'x':0.6,'y':0.78},'i':{'x':0.75,'y':0.68},'j':{'x':0.7,'y':0.78},'k':{'x':0.8,'y':0.78},'l':{'x':0.9,'y':0.78},'m':{'x':0.8,'y':0.88},'n':{'x':0.7,'y':0.88},'o':{'x':0.85,'y':0.68},'p':{'x':0.95,'y':0.68},'q':{'x':0.05,'y':0.68},'r':{'x':0.35,'y':0.68},'s':{'x':0.2,'y':0.78},'t':{'x':0.45,'y':0.68},'u':{'x':0.65,'y':0.68},'v':{'x':0.5,'y':0.88},'w':{'x':0.15,'y':0.68},'x':{'x':0.3,'y':0.88},'y':{'x':0.55,'y':0.68},'z':{'x':0.2,'y':0.88},'\x20':{'x':0.55,'y':0.95}},_0x2be752['NUMPAD_LAYOUT']='PANDA'===_0x4bb5ad['config']['boxType']?_0x2e4415:_0x25add6;},(_0x176cc1,_0x47866c,_0x13ef4c)=>{const _0x1a85a2=a0_0x2823;Object['defineProperty'](_0x47866c,'__esModule',{'value':!0x0}),_0x47866c['ACB_UI_COORDINATES']=void 0x0;const _0xd5c155=_0x13ef4c(0xf),_0x1cf54e={'LOGIN_BUTTON':{'x':0.5,'y':0.8},'LOGIN_BUTTON_API':{'x':0.5,'y':0.62},'PASSWORD_FIELD':{'x':0.5,'y':0.45}},_0x4049ca=(0x0,_0x13ef4c(0x25)[_0x1a85a2(0x37d)])(_0x1cf54e);_0x47866c[_0x1a85a2(0x275)]='PANDA'===_0xd5c155['config']['boxType']?_0x4049ca:_0x1cf54e;},function(_0x52c3b4,_0x5c2cd2,_0x47b8c1){const _0xb80c82=a0_0x2823;var _0x1523a7,_0x7e5f37,_0x2d1e13,_0x8d5e9d=this&&this[_0xb80c82(0x2c3)]||function(_0x1526bb,_0x1e87c0,_0x168012,_0x19733f){const _0x2f5c2d=_0xb80c82;var _0x3096c9,_0xb83c13=arguments['length'],_0x2a4acd=_0xb83c13<0x3?_0x1e87c0:null===_0x19733f?_0x19733f=Object[_0x2f5c2d(0x380)](_0x1e87c0,_0x168012):_0x19733f;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x2a4acd=Reflect[_0x2f5c2d(0x1ad)](_0x1526bb,_0x1e87c0,_0x168012,_0x19733f);else{for(var _0x1ef86a=_0x1526bb['length']-0x1;_0x1ef86a>=0x0;_0x1ef86a--)(_0x3096c9=_0x1526bb[_0x1ef86a])&&(_0x2a4acd=(_0xb83c13<0x3?_0x3096c9(_0x2a4acd):_0xb83c13>0x3?_0x3096c9(_0x1e87c0,_0x168012,_0x2a4acd):_0x3096c9(_0x1e87c0,_0x168012))||_0x2a4acd);}return _0xb83c13>0x3&&_0x2a4acd&&Object['defineProperty'](_0x1e87c0,_0x168012,_0x2a4acd),_0x2a4acd;},_0x338ac1=this&&this[_0xb80c82(0x19c)]||function(_0x1171f9,_0x2bff5f){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x1171f9,_0x2bff5f);},_0x5c56ef=this&&this['__param']||function(_0x7b7a2a,_0x504e23){return function(_0x1b355e,_0x363639){_0x504e23(_0x1b355e,_0x363639,_0x7b7a2a);};};Object['defineProperty'](_0x5c2cd2,'__esModule',{'value':!0x0}),_0x5c2cd2['PgService']=void 0x0;const _0xf0f865=_0x47b8c1(0x2),_0x58ec8b=_0x47b8c1(0x15),_0x1b3b46=_0x47b8c1(0x1a),_0x1334a8=_0x47b8c1(0x19),_0x994aa4=_0x47b8c1(0x14),_0x1be946=_0x47b8c1(0x11),_0x17761c=_0x47b8c1(0x28),_0x2feffe=_0x47b8c1(0xf),_0x57f91c=_0x47b8c1(0x29),_0x103d21=_0x47b8c1(0x1d),_0x2d3e41=_0x47b8c1(0x2a),_0xf4b765=_0x47b8c1(0x24);let _0x2f82d8=class extends _0x1b3b46['BaseBankService']{constructor(_0x3cf421,_0x11d884,_0xbbb485){super(_0x3cf421,_0x11d884,_0xbbb485),this['wsService']=_0x3cf421,this['BANK_CODE']='PGBANK',this['BUNDLE_ID']='pgbankApp.pgbank.com.vn';}async['inputPasswordFromConfig'](_0x373337){const _0x450c14=_0xb80c82,_0x53ed7e=await this['deviceService']['getDeviceConfig'](_0x373337);if(!_0x53ed7e||!_0x53ed7e[_0x450c14(0x254)])throw new Error('Password\x20not\x20configured\x20for\x20device\x20'+_0x373337);await this['clickWithTransition'](_0x373337,_0x17761c[_0x450c14(0x1f3)][_0x450c14(0x393)]['x'],_0x17761c['PG_UI_COORDINATES']['PASSWORD_FIELD']['y'],0x5dc),await this[_0x450c14(0x2ec)]['inputText'](_0x373337,_0x53ed7e['password']),await(0x0,_0x1be946['sleep'])(0x3e8),await this[_0x450c14(0x2ec)]['pressReturnKey'](_0x373337),await(0x0,_0x1be946[_0x450c14(0x349)])(0x3e8);}async[_0xb80c82(0x184)](_0x418e7d,_0x509075=0x3){const _0x41c1ed=await this['deviceService']['getDeviceConfig'](_0x418e7d);if(!_0x41c1ed||!_0x41c1ed['smartOTP'])throw new Error('SmartOTP\x20not\x20configured\x20for\x20device\x20'+_0x418e7d);await(0x0,_0x1be946['sleep'])(0x7d0),await this['wsService']['inputText'](_0x418e7d,_0x41c1ed['smartOTP']);}async['launchApp'](_0x26dab5){const _0x4eb6c8=_0xb80c82;if(await this['wsService'][_0x4eb6c8(0x2de)](_0x26dab5,this['BUNDLE_ID']),!await this['verifyScreenState'](_0x26dab5,{'expectedTexts':[_0x4eb6c8(0x209)],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0xf4b765[_0x4eb6c8(0x1e0)]['LAUNCH_APP'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x2d3e41['WithdrawalProcessingError']('Failed\x20to\x20launch\x20PGBank\x20app',_0x2d3e41[_0x4eb6c8(0x1ff)]['FORCE_KILL_APP'],_0x26dab5);this[_0x4eb6c8(0x32b)][_0x4eb6c8(0x310)]('['+_0x26dab5+_0x4eb6c8(0x162));}async[_0xb80c82(0x163)](_0x2c2589){const _0x1cd9b2=_0xb80c82;try{if(await this[_0x1cd9b2(0x193)](_0x2c2589),await(0x0,_0x1be946['sleep'])(0x7d0),await this['launchApp'](_0x2c2589),await this['inputPasswordFromConfig'](_0x2c2589),!await this[_0x1cd9b2(0x385)](_0x2c2589,_0x17761c['PG_UI_COORDINATES'][_0x1cd9b2(0x35d)]['x'],_0x17761c[_0x1cd9b2(0x1f3)]['LOGIN_BTN']['y'],{'expectedTexts':['tÃ i\x20khoáº£n',_0x1cd9b2(0x1ea),_0x1cd9b2(0x354)],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0xf4b765[_0x1cd9b2(0x1e0)]['HOME_SCREEN']}))throw new _0x2d3e41['WithdrawalProcessingError'](_0x1cd9b2(0x1f8),_0x2d3e41[_0x1cd9b2(0x1ff)]['FORCE_KILL_APP'],_0x2c2589);this['logger'][_0x1cd9b2(0x310)]('['+_0x2c2589+']\x20-\x20Login\x20successfully');}catch(_0x272ea6){throw this[_0x1cd9b2(0x32b)][_0x1cd9b2(0x134)]('Error\x20logging\x20in\x20to\x20PGBank\x20on\x20device\x20'+_0x2c2589+':\x20'+_0x272ea6['message']),_0x272ea6;}}async['executeTransfer'](_0x608077,_0x37ddd9){const _0x31bb0b=_0xb80c82,_0x33c4f4='PGBANK'===_0x608077['bankCode']?this['executeInternalTransfer'](_0x608077,_0x37ddd9):this[_0x31bb0b(0x27e)](_0x608077,_0x37ddd9);return await this['createBillFolder'](_0x608077['withdrawalCode']),_0x33c4f4;}async[_0xb80c82(0x1f5)](_0x33f368,_0x2ab977){const _0x3f55a9=_0xb80c82;if(this['logger'][_0x3f55a9(0x310)]('Executing\x20PG\x20transfer\x20for\x20withdrawal\x20'+_0x33f368['withdrawalId']+'\x20on\x20device\x20'+_0x2ab977['deviceId']),await this['createBillFolder'](_0x33f368['withdrawalCode']),await this['createQRCodeAndTransferTo'](_0x2ab977[_0x3f55a9(0x22e)],_0x33f368),await this['clickWithTransition'](_0x2ab977['deviceId'],_0x17761c['PG_UI_COORDINATES'][_0x3f55a9(0x16a)]['x'],_0x17761c[_0x3f55a9(0x1f3)]['QR_CODE_BTN']['y'],0xbb8),await this['clickWithTransition'](_0x2ab977[_0x3f55a9(0x22e)],_0x17761c[_0x3f55a9(0x1f3)]['IMAGE_LIBRARY_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['IMAGE_LIBRARY_BTN']['y'],0x7d0),await this['clickWithTransition'](_0x2ab977['deviceId'],_0x17761c[_0x3f55a9(0x1f3)]['FIRST_IMAGE_BTN']['x'],_0x17761c['PG_UI_COORDINATES'][_0x3f55a9(0x1c8)]['y'],0x3e8),!await this['clickAndWaitForScreen'](_0x2ab977['deviceId'],_0x17761c['PG_UI_COORDINATES']['SELECT_IMAGE_QR_CODE_BTN']['x'],_0x17761c['PG_UI_COORDINATES'][_0x3f55a9(0x31b)]['y'],{'expectedTexts':[_0x33f368['beneficiaryName']],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0xf4b765['PG_ROI_EXPECTED']['VERIFY_ACCOUNT_NAME']}))throw await this['clickWithTransition'](_0x2ab977['deviceId'],_0x17761c[_0x3f55a9(0x1f3)]['HOME_ICON_HEADER']['x'],_0x17761c['PG_UI_COORDINATES']['HOME_ICON_HEADER']['y'],0x7d0),new _0x2d3e41['WithdrawalProcessingError']('Choose\x20wrong\x20image\x20qrcode',_0x2d3e41['ErrorType']['TEMPORARY'],_0x33f368['withdrawalId']);if(this['logger'][_0x3f55a9(0x310)]('['+_0x2ab977['accountName']+_0x3f55a9(0x1ab)),!await this[_0x3f55a9(0x385)](_0x2ab977[_0x3f55a9(0x22e)],_0x17761c[_0x3f55a9(0x1f3)]['CONTINUE_TRANSFER_BTN']['x'],_0x17761c[_0x3f55a9(0x1f3)]['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['XÃ¡c\x20nháº­n\x20giao\x20dá»‹ch'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0xf4b765['PG_ROI_EXPECTED'][_0x3f55a9(0x363)]}))throw new _0x2d3e41['WithdrawalProcessingError']('Transaction\x20confirm\x20screen\x20not\x20found',_0x2d3e41['ErrorType'][_0x3f55a9(0x157)],_0x33f368['withdrawalId']);if(this[_0x3f55a9(0x32b)]['log']('['+_0x2ab977['accountName']+_0x3f55a9(0x19e)),!await this['clickAndWaitForScreen'](_0x2ab977[_0x3f55a9(0x22e)],_0x17761c[_0x3f55a9(0x1f3)]['CONTINUE_TRANSFER_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['XÃ¡c\x20thá»±c\x20giao\x20dá»‹ch'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0xf4b765['PG_ROI_EXPECTED'][_0x3f55a9(0x14e)]}))throw new _0x2d3e41['WithdrawalProcessingError']('Transaction\x20verification\x20screen\x20not\x20found',_0x2d3e41[_0x3f55a9(0x1ff)]['FORCE_LOGIN'],_0x33f368['withdrawalId']);if(this[_0x3f55a9(0x32b)][_0x3f55a9(0x310)]('['+_0x2ab977['accountName']+']\x20-\x20Get\x20Transaction\x20verification\x20screen'),await this['inputSmartOTPFromConfig'](_0x2ab977['deviceId']),!await this['verifyScreenState'](_0x2ab977[_0x3f55a9(0x22e)],{'expectedTexts':['Chuyá»ƒn\x20tiá»n\x20thÃ nh\x20cÃ´ng'],'timeout':0x7530,'pollInterval':0x1f4,'roi':_0xf4b765[_0x3f55a9(0x1e0)]['TRANSACTION_SUCCESS'],'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}}))throw new _0x2d3e41['WithdrawalProcessingError']('Transaction\x20success\x20screen\x20not\x20found',_0x2d3e41['ErrorType'][_0x3f55a9(0x157)],_0x33f368['withdrawalId']);this['logger']['log']('['+_0x2ab977[_0x3f55a9(0x1fb)]+']\x20-\x20Get\x20Transaction\x20success\x20screen'),this[_0x3f55a9(0x1da)](_0x2ab977['deviceId'],{'folderPath':_0x33f368['withdrawalCode']})['catch'](()=>{const _0x241a3f=_0x3f55a9;this['logger']['error']('['+_0x2ab977['accountName']+']\x20-\x20Error\x20capturing\x20screen\x20for\x20withdrawal\x20'+_0x33f368['withdrawalId']+_0x241a3f(0x33b)+_0x33f368['withdrawalCode']);}),await this[_0x3f55a9(0x38b)](_0x2ab977[_0x3f55a9(0x22e)],_0x17761c['PG_UI_COORDINATES'][_0x3f55a9(0x13c)]['x'],_0x17761c['PG_UI_COORDINATES']['BACK_TO_HOME']['y'],0x1388,'['+_0x2ab977[_0x3f55a9(0x1fb)]+_0x3f55a9(0x2f4));}async[_0xb80c82(0x13a)](_0x1f7eaa,_0xb62636){const _0x5def8d=_0xb80c82;try{this[_0x5def8d(0x32b)]['log']('Executing\x20PG\x20transfer\x20for\x20withdrawal\x20'+_0x1f7eaa['withdrawalId']+'\x20on\x20device\x20'+_0xb62636),await this['clickWithTransition'](_0xb62636,_0x17761c[_0x5def8d(0x1f3)]['TRANSFER_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['TRANSFER_BTN']['y'],0x1388,'['+_0xb62636+']\x20-\x20Clicking\x20transfer\x20button\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES']['TRANSFER_BTN']['x']+',\x20'+_0x17761c['PG_UI_COORDINATES']['TRANSFER_BTN']['y']+')'),await this['clickWithTransition'](_0xb62636,_0x17761c['PG_UI_COORDINATES']['TRANSFER_INTERNAL_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['TRANSFER_INTERNAL_BTN']['y'],0xbb8,'['+_0xb62636+']\x20-\x20Clicking\x20transfer\x20internal\x20button\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES']['TRANSFER_INTERNAL_BTN']['x']+',\x20'+_0x17761c[_0x5def8d(0x1f3)][_0x5def8d(0x1fd)]['y']+')'),await this['clickWithTransition'](_0xb62636,_0x17761c['PG_UI_COORDINATES']['CLOSE_ALLOW_CONTACT_POPUP_BTN']['x'],_0x17761c[_0x5def8d(0x1f3)]['CLOSE_ALLOW_CONTACT_POPUP_BTN']['y'],0xbb8,'['+_0xb62636+_0x5def8d(0x384)+_0x17761c['PG_UI_COORDINATES']['CLOSE_ALLOW_CONTACT_POPUP_BTN']['x']+',\x20'+_0x17761c['PG_UI_COORDINATES']['CLOSE_ALLOW_CONTACT_POPUP_BTN']['y']+')'),await this['clickWithTransition'](_0xb62636,_0x17761c['PG_UI_COORDINATES'][_0x5def8d(0x161)]['x'],_0x17761c['PG_UI_COORDINATES']['ACCOUNT_NUMBER_INPUT']['y'],0xbb8,'['+_0xb62636+_0x5def8d(0x290)+_0x17761c[_0x5def8d(0x1f3)]['ACCOUNT_NUMBER_INPUT']['x']+',\x20'+_0x17761c[_0x5def8d(0x1f3)][_0x5def8d(0x161)]['y']+')'),'HC'===_0x2feffe['config'][_0x5def8d(0x2b4)]&&await this[_0x5def8d(0x2ec)][_0x5def8d(0x15f)](_0xb62636),await this[_0x5def8d(0x2ec)][_0x5def8d(0x359)](_0xb62636,_0x1f7eaa[_0x5def8d(0x160)]),await(0x0,_0x1be946[_0x5def8d(0x349)])(0x3e8),await this['wsService'][_0x5def8d(0x1cb)](_0xb62636),await(0x0,_0x1be946['sleep'])(0x2710),await this['clickWithTransition'](_0xb62636,_0x17761c['PG_UI_COORDINATES'][_0x5def8d(0x342)]['x'],_0x17761c['PG_UI_COORDINATES']['INTERNAL_AMOUNT_INPUT']['y'],0x3e8,'['+_0xb62636+']\x20-\x20Clicking\x20amount\x20input\x20field\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES']['INTERNAL_AMOUNT_INPUT']['x']+',\x20'+_0x17761c['PG_UI_COORDINATES']['INTERNAL_AMOUNT_INPUT']['y']+')'),await this['wsService']['inputText'](_0xb62636,_0x1f7eaa['amount']['toString']()),await this['clickWithTransition'](_0xb62636,_0x17761c[_0x5def8d(0x1f3)]['HIDE_NUMPAD_BTN']['x'],_0x17761c['PG_UI_COORDINATES'][_0x5def8d(0x311)]['y'],0x3e8),await this['clickWithTransition'](_0xb62636,_0x17761c['PG_UI_COORDINATES'][_0x5def8d(0x1cf)]['x'],_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],0x3a98,'['+_0xb62636+']\x20-\x20Clicking\x20continue\x20transfer\x20button\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES'][_0x5def8d(0x1cf)]['x']+',\x20'+_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y']+')'),await this['clickWithTransition'](_0xb62636,_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],0x7530,'['+_0xb62636+']\x20-\x20Clicking\x20continue\x20transfer\x20button\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES'][_0x5def8d(0x1cf)]['x']+',\x20'+_0x17761c[_0x5def8d(0x1f3)]['CONTINUE_TRANSFER_BTN']['y']+')'),this[_0x5def8d(0x32b)]['log']('['+_0xb62636+']\x20-\x20Entering\x20OTP'),await this['inputSmartOTPFromConfig'](_0xb62636),await(0x0,_0x1be946[_0x5def8d(0x349)])(0x7530),await this[_0x5def8d(0x1da)](_0xb62636,{'quality':0.5,'folderPath':_0x1f7eaa['withdrawalCode']}),await this['clickWithTransition'](_0xb62636,_0x17761c['PG_UI_COORDINATES']['BACK_TO_HOME']['x'],_0x17761c[_0x5def8d(0x1f3)]['BACK_TO_HOME']['y'],0x2710,'['+_0xb62636+']\x20-\x20Clicking\x20back\x20to\x20home\x20button\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES']['BACK_TO_HOME']['x']+',\x20'+_0x17761c[_0x5def8d(0x1f3)]['BACK_TO_HOME']['y']+')');}catch(_0x3fedd6){throw this[_0x5def8d(0x32b)][_0x5def8d(0x134)]('['+_0xb62636+']\x20-\x20Error\x20executing\x20PG\x20transfer\x20for\x20withdrawal\x20'+_0x1f7eaa['withdrawalId']+':\x20'+_0x3fedd6[_0x5def8d(0x2c9)]),_0x3fedd6;}}async['executeExternalTransfer'](_0x2a1aef,_0x37724c){const _0xc2e8f2=_0xb80c82;try{this['logger']['log']('Executing\x20PG\x20transfer\x20for\x20withdrawal\x20'+_0x2a1aef[_0xc2e8f2(0x2b6)]+'\x20on\x20device\x20'+_0x37724c);const _0x2fde91=_0x57f91c['PG_BANK_SEARCH_UI_COORDINATES'][_0x2a1aef['bankCode']];if(!_0x2fde91)throw new Error('Bank\x20'+_0x2a1aef['bankCode']+'\x20not\x20found!');await this['clickAndWaitForScreen'](_0x37724c,_0x17761c['PG_UI_COORDINATES']['TRANSFER_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['TRANSFER_BTN']['y'],{'expectedTexts':['chuyá»ƒn\x20tiá»n','transfer'],'unexpectedTexts':[_0xc2e8f2(0x36d),'home'],'timeout':0x2710,'pollInterval':0x1f4},'['+_0x37724c+_0xc2e8f2(0x1d5)+_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x232)]['x']+',\x20'+_0x17761c[_0xc2e8f2(0x1f3)][_0xc2e8f2(0x232)]['y']+')'),await this['clickAndWaitForScreen'](_0x37724c,_0x17761c['PG_UI_COORDINATES']['TRANSFER_EXTERNAL_BTN']['x'],_0x17761c[_0xc2e8f2(0x1f3)][_0xc2e8f2(0x211)]['y'],{'expectedTexts':[_0xc2e8f2(0x2d0),'external\x20transfer','sá»‘\x20tÃ i\x20khoáº£n'],'timeout':0x1f40,'pollInterval':0x1f4},'['+_0x37724c+_0xc2e8f2(0x2c6)+_0x17761c[_0xc2e8f2(0x1f3)][_0xc2e8f2(0x211)]['x']+',\x20'+_0x17761c['PG_UI_COORDINATES']['TRANSFER_EXTERNAL_BTN']['y']+')'),await this['clickWithTransition'](_0x37724c,_0x17761c['PG_UI_COORDINATES']['ACCOUNT_NUMBER_INPUT']['x'],_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x161)]['y'],0x5dc,'['+_0x37724c+_0xc2e8f2(0x141)+_0x17761c[_0xc2e8f2(0x1f3)]['ACCOUNT_NUMBER_INPUT']['x']+',\x20'+_0x17761c[_0xc2e8f2(0x1f3)]['ACCOUNT_NUMBER_INPUT']['y']+')'),'HC'===_0x2feffe['config']['boxType']&&await this['wsService'][_0xc2e8f2(0x15f)](_0x37724c),await this['wsService']['inputText'](_0x37724c,_0x2a1aef['beneficiaryAccountNo']),await(0x0,_0x1be946['sleep'])(0x3e8),await this[_0xc2e8f2(0x2ec)][_0xc2e8f2(0x1cb)](_0x37724c),await(0x0,_0x1be946['sleep'])(0x3e8),await this['clickWithTransition'](_0x37724c,_0x17761c['PG_UI_COORDINATES']['BANK_SEARCH_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['BANK_SEARCH_BTN']['y'],0x3e8,'['+_0x37724c+']\x20-\x20Clicking\x20account\x20number\x20field\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x2ef)]['x']+',\x20'+_0x17761c[_0xc2e8f2(0x1f3)]['BANK_SEARCH_BTN']['y']+')'),await this[_0xc2e8f2(0x38b)](_0x37724c,_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x29f)]['x'],_0x17761c[_0xc2e8f2(0x1f3)]['BANK_SEARCH_INPUT']['y'],0x7d0,'['+_0x37724c+']\x20-\x20Clicking\x20account\x20number\x20field\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES']['BANK_SEARCH_INPUT']['x']+',\x20'+_0x17761c['PG_UI_COORDINATES']['BANK_SEARCH_INPUT']['y']+')'),await this['wsService']['inputText'](_0x37724c,_0x2fde91['searchValue']),await(0x0,_0x1be946['sleep'])(0x3e8),await this[_0xc2e8f2(0x2ec)][_0xc2e8f2(0x1cb)](_0x37724c),await(0x0,_0x1be946['sleep'])(0x3e8),await this['clickWithTransition'](_0x37724c,_0x2fde91['coordinates']['x'],_0x2fde91['coordinates']['y'],0x2710,'['+_0x37724c+']\x20-\x20Clicking\x20bank\x20at\x20coordinates\x20('+_0x2fde91['coordinates']['x']+',\x20'+_0x2fde91['coordinates']['y']+')'),await this[_0xc2e8f2(0x2ec)]['swipe'](_0x37724c,{'type':'6'}),await(0x0,_0x1be946['sleep'])(0xbb8),await this[_0xc2e8f2(0x38b)](_0x37724c,_0x17761c['PG_UI_COORDINATES']['EXTERNAL_AMOUNT_INPUT']['x'],_0x17761c['PG_UI_COORDINATES']['EXTERNAL_AMOUNT_INPUT']['y'],0x7d0,'['+_0x37724c+_0xc2e8f2(0x292)+_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x270)]['x']+',\x20'+_0x17761c['PG_UI_COORDINATES']['EXTERNAL_AMOUNT_INPUT']['y']+')'),await this['wsService']['inputText'](_0x37724c,_0x2a1aef['amount']['toString']()),await this['clickWithTransition'](_0x37724c,_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x311)]['x'],_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x311)]['y'],0x3e8),await this['clickAndWaitForScreen'](_0x37724c,_0x17761c[_0xc2e8f2(0x1f3)]['CONTINUE_TRANSFER_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],{'expectedTexts':['xÃ¡c\x20nháº­n',_0xc2e8f2(0x195),_0xc2e8f2(0x133),_0xc2e8f2(0x328)],'timeout':0x4e20,'pollInterval':0x1f4},'['+_0x37724c+_0xc2e8f2(0x1f7)+_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x1cf)]['x']+',\x20'+_0x17761c[_0xc2e8f2(0x1f3)]['CONTINUE_TRANSFER_BTN']['y']+')'),await this['clickWithTransition'](_0x37724c,_0x17761c[_0xc2e8f2(0x1f3)]['CONTINUE_TRANSFER_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],0x2710,'['+_0x37724c+']\x20-\x20Clicking\x20continue\x20transfer\x20button\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['x']+',\x20'+_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x1cf)]['y']+')'),await this['clickWithTransition'](_0x37724c,_0x17761c[_0xc2e8f2(0x1f3)]['CONTINUE_TRANSFER_BTN']['x'],_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y'],0x61a8,'['+_0x37724c+']\x20-\x20Clicking\x20continue\x20transfer\x20button\x20at\x20coordinates\x20('+_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x1cf)]['x']+',\x20'+_0x17761c['PG_UI_COORDINATES']['CONTINUE_TRANSFER_BTN']['y']+')'),this[_0xc2e8f2(0x32b)]['log']('['+_0x37724c+']\x20-\x20Entering\x20OTP'),await this['inputSmartOTPFromConfig'](_0x37724c),await(0x0,_0x1be946['sleep'])(0x4e20),await this['captureScreen'](_0x37724c,{'quality':0.5,'folderPath':_0x2a1aef['withdrawalCode']}),await(0x0,_0x1be946[_0xc2e8f2(0x349)])(0x1388),await this['clickWithTransition'](_0x37724c,_0x17761c['PG_UI_COORDINATES']['BACK_TO_HOME']['x'],_0x17761c['PG_UI_COORDINATES']['BACK_TO_HOME']['y'],0x1388,'['+_0x37724c+']\x20-\x20Clicking\x20back\x20to\x20home\x20button\x20at\x20coordinates\x20('+_0x17761c[_0xc2e8f2(0x1f3)]['BACK_TO_HOME']['x']+',\x20'+_0x17761c['PG_UI_COORDINATES'][_0xc2e8f2(0x13c)]['y']+')');}catch(_0x50245a){throw this['logger'][_0xc2e8f2(0x134)]('['+_0x37724c+']\x20-\x20Error\x20executing\x20PG\x20transfer\x20for\x20withdrawal\x20'+_0x2a1aef['withdrawalId']+':\x20'+_0x50245a[_0xc2e8f2(0x2c9)]),_0x50245a;}}async[_0xb80c82(0x1c0)](_0x2c41a9){const _0x706c71=_0xb80c82;try{const _0x216e17=await this[_0x706c71(0x15e)][_0x706c71(0x2da)](_0x2c41a9,{'fieldType':'singleLine','customROI':{'x':0.05,'y':0.75,'width':0.9,'height':0.12},'preprocess':{'grayscale':!0x0,'enhanceContrast':!0x0}});if(!_0x216e17)return this['logger'][_0x706c71(0x234)]('Failed\x20to\x20extract\x20transaction\x20amount\x20from\x20ROI'),null;const _0x3a7843=_0x216e17['text'][_0x706c71(0x21e)](/[^\d.,]/g,'')['replace'](/,/g,''),_0x217b6d=parseFloat(_0x3a7843);return isNaN(_0x217b6d)?(this['logger'][_0x706c71(0x234)](_0x706c71(0x389)+_0x216e17['text']),null):(this['logger'][_0x706c71(0x310)]('Extracted\x20transaction\x20amount:\x20'+_0x217b6d[_0x706c71(0x149)]('vi-VN')+'\x20VND\x20(confidence:\x20'+_0x216e17['confidence'][_0x706c71(0x200)](0x2)+_0x706c71(0x1f9)+_0x216e17['processingTime']+_0x706c71(0x179)),_0x217b6d);}catch(_0xba0d6a){return this['logger']['error'](_0x706c71(0x2a1)+_0xba0d6a['message'],_0xba0d6a['stack']),null;}}async['onModuleInit'](){}[_0xb80c82(0x203)](){}};_0x5c2cd2['PgService']=_0x2f82d8,_0x5c2cd2['PgService']=_0x2f82d8=_0x8d5e9d([(0x0,_0xf0f865['Injectable'])(),_0x5c56ef(0x0,(0x0,_0xf0f865['Inject'])(_0x994aa4['WEBSOCKET_SERVICE'])),_0x338ac1(_0xb80c82(0x381),['function'==typeof(_0x1523a7=void 0x0!==_0x1334a8['IWebSocketService']&&_0x1334a8['IWebSocketService'])?_0x1523a7:Object,'function'==typeof(_0x7e5f37=void 0x0!==_0x58ec8b['DeviceService']&&_0x58ec8b['DeviceService'])?_0x7e5f37:Object,'function'==typeof(_0x2d1e13=void 0x0!==_0x103d21['OCRService']&&_0x103d21['OCRService'])?_0x2d1e13:Object])],_0x2f82d8);},(_0x2a853f,_0x491f85,_0x48e741)=>{const _0x26c3a9=a0_0x2823;Object[_0x26c3a9(0x1b6)](_0x491f85,'__esModule',{'value':!0x0}),_0x491f85['PG_UI_COORDINATES']=void 0x0;const _0x14c573=_0x48e741(0xf),_0x3343fb={'LOGIN_BTN':{'x':0.5,'y':0.6},'PASSWORD_FIELD':{'x':0.5,'y':0.4},'TRANSFER_BTN':{'x':0.7,'y':0.7},'TRANSFER_INTERNAL_BTN':{'x':0.2,'y':0.2},'TRANSFER_EXTERNAL_BTN':{'x':0.4,'y':0.2},'CLOSE_ALLOW_CONTACT_POPUP_BTN':{'x':0.3,'y':0.6},'ACCOUNT_NUMBER_INPUT':{'x':0.4,'y':0.43},'SELECT_BANK_BTN':{'x':0.4,'y':0.47},'SEARCH_BANK_BTN':{'x':0.4,'y':0.48},'INTERNAL_AMOUNT_INPUT':{'x':0.5,'y':0.6},'HIDE_NUMPAD_BTN':{'x':0.05,'y':0.4},'CONTINUE_TRANSFER_BTN':{'x':0.5,'y':0.9},'BANK_SEARCH_BTN':{'x':0.4,'y':0.45},'BANK_SEARCH_INPUT':{'x':0.4,'y':0.45},'EXTERNAL_AMOUNT_INPUT':{'x':0.3,'y':0.37},'BACK_TO_HOME':{'x':0.2,'y':0.9},'QR_CODE_BTN':{'x':0.2,'y':0.9},'IMAGE_LIBRARY_BTN':{'x':0.8,'y':0.9},'FIRST_IMAGE_BTN':{'x':0.3,'y':0.3},'SELECT_IMAGE_QR_CODE_BTN':{'x':0.95,'y':0.95},'HOME_ICON_HEADER':{'x':0.95,'y':0.05}},_0x548855=(0x0,_0x48e741(0x25)['scaleCoordinates'])(_0x3343fb);_0x491f85['PG_UI_COORDINATES']=_0x26c3a9(0x32a)===_0x14c573[_0x26c3a9(0x298)]['boxType']?_0x548855:_0x3343fb;},(_0x482002,_0x270e65,_0x156ab3)=>{const _0x57b450=a0_0x2823;Object['defineProperty'](_0x270e65,'__esModule',{'value':!0x0}),_0x270e65['PG_BANK_SEARCH_UI_COORDINATES']=_0x270e65['HC_PG_BANK_SEARCH_UI_COORDINATES']=void 0x0;const _0xf0d3c6=_0x156ab3(0xf);_0x270e65['HC_PG_BANK_SEARCH_UI_COORDINATES']={'VIETCOMBANK':{'searchValue':'VIETCOMBANK','coordinates':{'x':0.5,'y':0.58}},'AGRIBANK':{'searchValue':_0x57b450(0x252),'coordinates':{'x':0.5,'y':0.58}},'BIDV':{'searchValue':'BIDV','coordinates':{'x':0.5,'y':0.58}},'SACOMBANK':{'searchValue':'SACOMBANK','coordinates':{'x':0.5,'y':0.58}},'TECHCOMBANK':{'searchValue':'TECHCOMBANK','coordinates':{'x':0.5,'y':0.58}},'TPBANK':{'searchValue':'TPBANK','coordinates':{'x':0.5,'y':0.58}},'HDBank':{'searchValue':'HDBank','coordinates':{'x':0.5,'y':0.58}},'VPBANK':{'searchValue':_0x57b450(0x19d),'coordinates':{'x':0.5,'y':0.78}},'MBBANK':{'searchValue':'QUAN\x20DOI','coordinates':{'x':0.5,'y':0.58}},'MSB':{'searchValue':'MSB','coordinates':{'x':0.5,'y':0.58}},'LPBANK':{'searchValue':'LPBANK','coordinates':{'x':0.5,'y':0.58}},'ACB':{'searchValue':_0x57b450(0x2eb),'coordinates':{'x':0.5,'y':0.58}},'ABBANK':{'searchValue':'ABANK','coordinates':{'x':0.5,'y':0.58}},'NCB':{'searchValue':'NCB','coordinates':{'x':0.5,'y':0.58}},'EXIMBANK':{'searchValue':'EXIMBANK','coordinates':{'x':0.5,'y':0.58}},'SEABANK':{'searchValue':_0x57b450(0x14b),'coordinates':{'x':0.5,'y':0.58}},'SCB':{'searchValue':'SCB','coordinates':{'x':0.5,'y':0.58}},'PVCOMBANK':{'searchValue':_0x57b450(0x142),'coordinates':{'x':0.5,'y':0.58}},'KIENLONGBANK':{'searchValue':'KIENLONG','coordinates':{'x':0.5,'y':0.58}},'BVBANK':{'searchValue':_0x57b450(0x33f),'coordinates':{'x':0.5,'y':0.58}},'VIETINBANK':{'searchValue':'VIETINBANK','coordinates':{'x':0.5,'y':0.58}},'OCB':{'searchValue':'OCB','coordinates':{'x':0.5,'y':0.58}},'VIETBANK':{'searchValue':'VIETBANK','coordinates':{'x':0.5,'y':0.58}},'SHB':{'searchValue':'SHB','coordinates':{'x':0.5,'y':0.58}},'NAMABANK':{'searchValue':'NAM\x20A\x20BANK','coordinates':{'x':0.5,'y':0.58}},'SHINHANBANKVIETNAM':{'searchValue':'SHINHAN\x20BANK','coordinates':{'x':0.5,'y':0.58}},'CIMB':{'searchValue':'CIMB','coordinates':{'x':0.5,'y':0.58}},'SAIGONBANK':{'searchValue':_0x57b450(0x37b),'coordinates':{'x':0.5,'y':0.58}},'BACABANK':{'searchValue':_0x57b450(0x1c6),'coordinates':{'x':0.5,'y':0.58}},'VIETABANK':{'searchValue':_0x57b450(0x1d2),'coordinates':{'x':0.5,'y':0.58}},'GPBANK':{'searchValue':'GPBANK','coordinates':{'x':0.5,'y':0.58}},'HSBC':{'searchValue':'HSBC','coordinates':{'x':0.5,'y':0.58}},'VRB':{'searchValue':'VRB','coordinates':{'x':0.5,'y':0.58}},'VIB':{'searchValue':'VIB','coordinates':{'x':0.5,'y':0.58}}};const _0x5009e4=((_0x11f1f0,_0x1c289d=0x64)=>Object['fromEntries'](Object['entries'](_0x11f1f0)['map'](([_0x2adaee,_0xab4d17])=>[_0x2adaee,{..._0xab4d17,'coordinates':{'x':Math['round'](_0xab4d17['coordinates']['x']*_0x1c289d),'y':Math[_0x57b450(0x257)](_0xab4d17['coordinates']['y']*_0x1c289d)}}])))(_0x270e65['HC_PG_BANK_SEARCH_UI_COORDINATES'],0x64);_0x270e65['PG_BANK_SEARCH_UI_COORDINATES']='PANDA'===_0xf0d3c6[_0x57b450(0x298)]['boxType']?_0x5009e4:_0x270e65[_0x57b450(0x29d)];},(_0x5b2be6,_0x24f9d2)=>{const _0x4d4fd8=a0_0x2823;var _0x560a7d;Object['defineProperty'](_0x24f9d2,'__esModule',{'value':!0x0}),_0x24f9d2['WithdrawalProcessingError']=_0x24f9d2['ErrorType']=void 0x0,_0x24f9d2[_0x4d4fd8(0x148)]=function(_0xabb7d2,_0xd3941c){const _0x2ec2c0=_0x4d4fd8,_0x7ea966=_0xabb7d2[_0x2ec2c0(0x31d)]()+'\x20'+(_0xd3941c?.['message']?.['toLowerCase']()||'');return['insufficient','invalid','not\x20found',_0x2ec2c0(0x274),'forbidden','bad\x20request','required']['some'](_0x11186b=>_0x7ea966['includes'](_0x11186b))?_0x560a7d[_0x2ec2c0(0x1cd)]:[_0x2ec2c0(0x293),'network',_0x2ec2c0(0x26d),'device','locked','busy','connection',_0x2ec2c0(0x238),'not\x20active',_0x2ec2c0(0x1b7)]['some'](_0xee23d8=>_0x7ea966['includes'](_0xee23d8))?_0x560a7d['TEMPORARY']:_0x560a7d[_0x2ec2c0(0x32c)];},function(_0x37d45a){const _0x47cae1=_0x4d4fd8;_0x37d45a['TEMPORARY']=_0x47cae1(0x227),_0x37d45a['PERMANENT']=_0x47cae1(0x1cd),_0x37d45a['UNKNOWN']='UNKNOWN',_0x37d45a[_0x47cae1(0x157)]='FORCE_LOGIN',_0x37d45a['FORCE_KILL_APP']=_0x47cae1(0x365);}(_0x560a7d||(_0x24f9d2[_0x4d4fd8(0x1ff)]=_0x560a7d={}));class _0x181054 extends Error{constructor(_0x4a9b6b,_0x5a2aa0,_0xa8ff4d){const _0x35ef10=_0x4d4fd8;super(_0x4a9b6b),this[_0x35ef10(0x2be)]=_0x5a2aa0,this['withdrawalId']=_0xa8ff4d,this['name']=_0x35ef10(0x2ed);}}_0x24f9d2['WithdrawalProcessingError']=_0x181054;},function(_0x3ed3ba,_0x317170,_0x5acc6a){const _0x3855c6=a0_0x2823;var _0x278ab8,_0x425961=this&&this[_0x3855c6(0x2c3)]||function(_0x3bd9b1,_0x1d3670,_0x2dbc81,_0x474f97){const _0xdf5317=_0x3855c6;var _0x5fc198,_0x239136=arguments[_0xdf5317(0x390)],_0x496823=_0x239136<0x3?_0x1d3670:null===_0x474f97?_0x474f97=Object['getOwnPropertyDescriptor'](_0x1d3670,_0x2dbc81):_0x474f97;if(_0xdf5317(0x374)==typeof Reflect&&_0xdf5317(0x2d3)==typeof Reflect['decorate'])_0x496823=Reflect['decorate'](_0x3bd9b1,_0x1d3670,_0x2dbc81,_0x474f97);else{for(var _0x59038f=_0x3bd9b1['length']-0x1;_0x59038f>=0x0;_0x59038f--)(_0x5fc198=_0x3bd9b1[_0x59038f])&&(_0x496823=(_0x239136<0x3?_0x5fc198(_0x496823):_0x239136>0x3?_0x5fc198(_0x1d3670,_0x2dbc81,_0x496823):_0x5fc198(_0x1d3670,_0x2dbc81))||_0x496823);}return _0x239136>0x3&&_0x496823&&Object[_0xdf5317(0x1b6)](_0x1d3670,_0x2dbc81,_0x496823),_0x496823;},_0x1da511=this&&this['__metadata']||function(_0x18d0c3,_0x401fdf){const _0x411ae7=_0x3855c6;if(_0x411ae7(0x374)==typeof Reflect&&'function'==typeof Reflect[_0x411ae7(0x219)])return Reflect['metadata'](_0x18d0c3,_0x401fdf);};Object[_0x3855c6(0x1b6)](_0x317170,'__esModule',{'value':!0x0}),_0x317170['SessionManagementService']=void 0x0;const _0x253ecc=_0x5acc6a(0x2),_0x5df0e9=_0x5acc6a(0x16);let _0x44305c=class{constructor(_0x24f1bb){const _0x209a8d=_0x3855c6;this['redisService']=_0x24f1bb,this['logger']=new _0x253ecc['Logger'](_0x209a8d(0x2bb)),this[_0x209a8d(0x36e)]='bank:session:',this['BANK_SESSION_CONFIGS']=new Map([[_0x209a8d(0x2eb),{'bankCode':_0x209a8d(0x2eb),'sessionTimeoutMs':0xdbba0,'refreshBeforeMs':0xea60}],['PGBANK',{'bankCode':_0x209a8d(0x1d7),'sessionTimeoutMs':0x41eb0,'refreshBeforeMs':0x7530}]]);}['getSessionTimeout'](_0x2ea0f7){const _0x17a864=this['BANK_SESSION_CONFIGS']['get'](_0x2ea0f7['toUpperCase']());return _0x17a864?.['sessionTimeoutMs']||0x41eb0;}['getRefreshBeforeTime'](_0x1dfc85){const _0x122aab=_0x3855c6,_0x35ae3c=this['BANK_SESSION_CONFIGS']['get'](_0x1dfc85[_0x122aab(0x1ae)]());return _0x35ae3c?.['refreshBeforeMs']||0x7530;}async['recordLogin'](_0x3020db,_0x2ca304){const _0x36e364=_0x3855c6,_0x4c6792=this[_0x36e364(0x1d8)](_0x2ca304),_0x15a0a1=Date[_0x36e364(0x1b5)]()+_0x4c6792,_0x15f858={'deviceId':_0x3020db,'bankCode':_0x2ca304['toUpperCase'](),'loginTime':Date[_0x36e364(0x1b5)](),'expiresAt':_0x15a0a1,'status':'logged_in'},_0x506d93=''+this[_0x36e364(0x36e)]+_0x3020db+':'+_0x2ca304['toUpperCase']();await this['redisService']['set'](_0x506d93,JSON['stringify'](_0x15f858),_0x4c6792),this['logger'][_0x36e364(0x310)]('Recorded\x20login\x20session\x20for\x20device\x20'+_0x3020db+_0x36e364(0x178)+_0x2ca304+',\x20expires\x20at\x20'+new Date(_0x15a0a1)[_0x36e364(0x24b)]());}async['markLoggingIn'](_0x39cf79,_0x3df477){const _0x163810=_0x3855c6,_0xd9ed4c=''+this[_0x163810(0x36e)]+_0x39cf79+':'+_0x3df477[_0x163810(0x1ae)](),_0x46b89a=await this['getSession'](_0x39cf79,_0x3df477),_0x39b71d={'deviceId':_0x39cf79,'bankCode':_0x3df477['toUpperCase'](),'loginTime':_0x46b89a?.['loginTime']||Date[_0x163810(0x1b5)](),'expiresAt':_0x46b89a?.['expiresAt']||Date['now']()+this['getSessionTimeout'](_0x3df477),'status':_0x163810(0x1f4)};await this['redisService']['set'](_0xd9ed4c,JSON[_0x163810(0x15d)](_0x39b71d),0x493e0),this['logger'][_0x163810(0x310)]('Marked\x20device\x20'+_0x39cf79+',\x20bank\x20'+_0x3df477+_0x163810(0x2c5));}async['getSession'](_0x19552d,_0x4f242c){const _0x183404=_0x3855c6;try{const _0x12fae7=''+this['REDIS_SESSION_PREFIX']+_0x19552d+':'+_0x4f242c[_0x183404(0x1ae)](),_0x258e47=await this['redisService']['get'](_0x12fae7);return _0x258e47?JSON['parse'](_0x258e47):null;}catch(_0x1214ef){return this['logger']['error'](_0x183404(0x230)+_0x19552d+',\x20bank\x20'+_0x4f242c+':\x20'+_0x1214ef['message']),null;}}async['isSessionValid'](_0x81de9e,_0x59923b){const _0x567a02=_0x3855c6,_0x259a06=await this[_0x567a02(0x2f1)](_0x81de9e,_0x59923b);return!(!_0x259a06||_0x259a06[_0x567a02(0x168)]<Date['now']()||'logging_in'===_0x259a06[_0x567a02(0x263)]||'logged_in'!==_0x259a06['status']);}async['needsRefresh'](_0x4ffd2e,_0x5a4ea1){const _0x1f91b6=_0x3855c6,_0x17596f=await this['getSession'](_0x4ffd2e,_0x5a4ea1);if(!_0x17596f||_0x1f91b6(0x391)!==_0x17596f['status'])return!0x1;const _0x24d4dc=this[_0x1f91b6(0x31c)](_0x5a4ea1);return _0x17596f['expiresAt']-Date['now']()<=_0x24d4dc;}async['clearSession'](_0x390a4a,_0x48ce22){const _0x157595=_0x3855c6,_0x1ee215=''+this['REDIS_SESSION_PREFIX']+_0x390a4a+':'+_0x48ce22[_0x157595(0x1ae)]();await this[_0x157595(0x1ca)]['del'](_0x1ee215),this[_0x157595(0x32b)]['log'](_0x157595(0x34c)+_0x390a4a+',\x20bank\x20'+_0x48ce22);}};_0x317170[_0x3855c6(0x2bb)]=_0x44305c,_0x317170['SessionManagementService']=_0x44305c=_0x425961([(0x0,_0x253ecc['Injectable'])(),_0x1da511(_0x3855c6(0x381),[_0x3855c6(0x2d3)==typeof(_0x278ab8=void 0x0!==_0x5df0e9[_0x3855c6(0x24f)]&&_0x5df0e9['RedisService'])?_0x278ab8:Object])],_0x44305c);},function(_0x5de114,_0x2c4b8a,_0x7b91e9){const _0x3eca46=a0_0x2823;var _0x46d08f,_0x2e082a=this&&this['__decorate']||function(_0x2122c5,_0x256be9,_0x2e741d,_0x1fbb33){const _0x4b368b=a0_0x2823;var _0x533974,_0x1ea4fd=arguments['length'],_0x46197d=_0x1ea4fd<0x3?_0x256be9:null===_0x1fbb33?_0x1fbb33=Object['getOwnPropertyDescriptor'](_0x256be9,_0x2e741d):_0x1fbb33;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x46197d=Reflect['decorate'](_0x2122c5,_0x256be9,_0x2e741d,_0x1fbb33);else{for(var _0x9a2f4c=_0x2122c5['length']-0x1;_0x9a2f4c>=0x0;_0x9a2f4c--)(_0x533974=_0x2122c5[_0x9a2f4c])&&(_0x46197d=(_0x1ea4fd<0x3?_0x533974(_0x46197d):_0x1ea4fd>0x3?_0x533974(_0x256be9,_0x2e741d,_0x46197d):_0x533974(_0x256be9,_0x2e741d))||_0x46197d);}return _0x1ea4fd>0x3&&_0x46197d&&Object[_0x4b368b(0x1b6)](_0x256be9,_0x2e741d,_0x46197d),_0x46197d;},_0x53ff8d=this&&this[_0x3eca46(0x19c)]||function(_0x5ab633,_0x440a34){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x5ab633,_0x440a34);};Object['defineProperty'](_0x2c4b8a,'__esModule',{'value':!0x0}),_0x2c4b8a['DeviceLockService']=void 0x0;const _0x1a11d2=_0x7b91e9(0x2),_0x375e71=_0x7b91e9(0x16),_0x5a62b7=_0x7b91e9(0x2d);let _0x44d664=class{constructor(_0x4af8c3){const _0x485333=_0x3eca46;this['redisService']=_0x4af8c3,this['logger']=new _0x1a11d2['Logger']('DeviceLockService'),this[_0x485333(0x2b9)]=_0x485333(0x35a),this['DEFAULT_LOCK_TTL']=0x927c0;}async[_0x3eca46(0x35f)](_0x2d9eb7,_0x2960d7,_0x367dd1,_0x4764e4=this['DEFAULT_LOCK_TTL']){const _0x31f8ca=_0x3eca46;try{const _0x101b73=''+this['REDIS_LOCK_PREFIX']+_0x2d9eb7,_0x1ff9f7=''+this[_0x31f8ca(0x2b9)]+_0x2d9eb7+':meta',_0x2e84ad=(0x0,_0x5a62b7[_0x31f8ca(0x2b5)])(),_0x2fba64=Math['ceil'](_0x4764e4/0x3e8),_0x55dacc=await this[_0x31f8ca(0x1ca)]['getClient']();if('OK'===await _0x55dacc[_0x31f8ca(0x368)](_0x101b73,_0x2e84ad,'EX',_0x2fba64,'NX')){const _0x23a3d2={'deviceId':_0x2d9eb7,'lockType':_0x2960d7,'lockedAt':Date[_0x31f8ca(0x1b5)](),'lockedBy':_0x367dd1,'ttl':_0x4764e4};return await this['redisService'][_0x31f8ca(0x1c7)](_0x1ff9f7,_0x2fba64,JSON[_0x31f8ca(0x15d)](_0x23a3d2)),this['logger']['log']('Acquired\x20'+_0x2960d7+_0x31f8ca(0x215)+_0x2d9eb7+'\x20('+_0x367dd1+_0x31f8ca(0x267)+_0x2e84ad),!0x0;}return this[_0x31f8ca(0x32b)]['warn'](_0x31f8ca(0x26a)+_0x2d9eb7+_0x31f8ca(0x15c)),!0x1;}catch(_0xaf597){return this['logger']['error']('Error\x20acquiring\x20lock\x20for\x20device\x20'+_0x2d9eb7+':\x20'+_0xaf597[_0x31f8ca(0x2c9)]),!0x1;}}async['releaseLock'](_0x1c29ea){const _0x5e99eb=_0x3eca46;try{const _0x4fc889=''+this[_0x5e99eb(0x2b9)]+_0x1c29ea,_0x1598ba=''+this['REDIS_LOCK_PREFIX']+_0x1c29ea+_0x5e99eb(0x1e7),_0x53a9c8=await this['redisService']['getClient'](),_0x703d76=await _0x53a9c8['get'](_0x4fc889);if(!_0x703d76)return await this['redisService'][_0x5e99eb(0x2cf)](_0x1598ba),void this[_0x5e99eb(0x32b)]['debug']('Device\x20'+_0x1c29ea+'\x20is\x20not\x20locked,\x20nothing\x20to\x20release');0x1===await _0x53a9c8['eval']('\x0aif\x20redis.call(\x22GET\x22,\x20KEYS[1])\x20==\x20ARGV[1]\x20then\x0a\x20\x20redis.call(\x22DEL\x22,\x20KEYS[2])\x0a\x20\x20return\x20redis.call(\x22DEL\x22,\x20KEYS[1])\x0aelse\x0a\x20\x20return\x200\x0aend\x0a',0x2,_0x4fc889,_0x1598ba,_0x703d76)?this['logger']['log']('Released\x20lock\x20for\x20device\x20'+_0x1c29ea+'\x20(lockId:\x20'+_0x703d76+')'):this[_0x5e99eb(0x32b)][_0x5e99eb(0x234)]('Lock\x20for\x20device\x20'+_0x1c29ea+'\x20was\x20already\x20released\x20or\x20changed\x20(expected\x20lockId:\x20'+_0x703d76+')');}catch(_0x28dce3){this[_0x5e99eb(0x32b)]['error']('Error\x20releasing\x20lock\x20for\x20device\x20'+_0x1c29ea+':\x20'+_0x28dce3[_0x5e99eb(0x2c9)],_0x28dce3['stack']);}}async['getLock'](_0x222119){const _0x39f6b6=_0x3eca46;try{const _0x1d8d37=''+this[_0x39f6b6(0x2b9)]+_0x222119,_0x4a87c8=await this['redisService']['get'](_0x1d8d37);if(!_0x4a87c8)return null;const _0x242e37=''+this['REDIS_LOCK_PREFIX']+_0x222119+':meta',_0x5536b4=await this['redisService'][_0x39f6b6(0x1af)](_0x242e37);return _0x5536b4?{...JSON['parse'](_0x5536b4),'lockId':_0x4a87c8}:{'deviceId':_0x222119,'lockType':'transfer','lockedAt':Date['now'](),'lockedBy':'unknown','ttl':this['DEFAULT_LOCK_TTL'],'lockId':_0x4a87c8};}catch(_0x3299ae){return this[_0x39f6b6(0x32b)]['error']('Error\x20getting\x20lock\x20for\x20device\x20'+_0x222119+':\x20'+_0x3299ae['message']),null;}}async['isLocked'](_0x727900,_0x5c1106){const _0x196f9b=_0x3eca46;try{const _0x14e68c=''+this['REDIS_LOCK_PREFIX']+_0x727900;if(!await this['redisService']['exists'](_0x14e68c))return!0x1;const _0x5b4a14=await this[_0x196f9b(0x28f)](_0x727900);return!(!_0x5b4a14||_0x5c1106&&_0x5b4a14['lockType']===_0x5c1106);}catch(_0x5ace70){return this[_0x196f9b(0x32b)]['error']('Error\x20checking\x20lock\x20status\x20for\x20device\x20'+_0x727900+':\x20'+_0x5ace70['message']),!0x1;}}async['extendLock'](_0x1a7429,_0x329acd){const _0x4178db=_0x3eca46;try{if(!await this['getLock'](_0x1a7429))return!0x1;const _0x3ac937=''+this['REDIS_LOCK_PREFIX']+_0x1a7429,_0x25fb98=''+this[_0x4178db(0x2b9)]+_0x1a7429+':meta',_0x74bad3=await this[_0x4178db(0x1ca)]['getClient'](),_0x2a3007=await _0x74bad3['ttl'](_0x3ac937);if(_0x2a3007<=0x0)return!0x1;const _0x475dea=Math[_0x4178db(0x240)]((0x3e8*_0x2a3007+_0x329acd)/0x3e8);return 0x1===await _0x74bad3['expire'](_0x3ac937,_0x475dea)&&(await this[_0x4178db(0x1ca)]['expire'](_0x25fb98,_0x475dea),this['logger']['log']('Extended\x20lock\x20for\x20device\x20'+_0x1a7429+_0x4178db(0x226)+_0x329acd+'ms'),!0x0);}catch(_0x2c7bc0){return this['logger']['error']('Error\x20extending\x20lock\x20for\x20device\x20'+_0x1a7429+':\x20'+_0x2c7bc0['message']),!0x1;}}async['releaseLockByType'](_0x55544f,_0x5018f3){const _0x4b318f=_0x3eca46;try{const _0x46bf36=await this[_0x4b318f(0x28f)](_0x55544f);if(!_0x46bf36)return!0x1;if(_0x46bf36['lockType']!==_0x5018f3)return!0x1;const _0x54a3f9=''+this['REDIS_LOCK_PREFIX']+_0x55544f,_0x39236e=''+this['REDIS_LOCK_PREFIX']+_0x55544f+_0x4b318f(0x1e7);return await this['redisService']['del'](_0x54a3f9),await this['redisService'][_0x4b318f(0x2cf)](_0x39236e),this['logger']['log']('Force\x20released\x20'+_0x5018f3+_0x4b318f(0x215)+_0x55544f),!0x0;}catch(_0x3e284d){return this['logger'][_0x4b318f(0x134)]('Error\x20releasing\x20'+_0x5018f3+_0x4b318f(0x215)+_0x55544f+':\x20'+_0x3e284d[_0x4b318f(0x2c9)]),!0x1;}}};_0x2c4b8a[_0x3eca46(0x38a)]=_0x44d664,_0x2c4b8a[_0x3eca46(0x38a)]=_0x44d664=_0x2e082a([(0x0,_0x1a11d2['Injectable'])(),_0x53ff8d(_0x3eca46(0x381),['function'==typeof(_0x46d08f=void 0x0!==_0x375e71['RedisService']&&_0x375e71['RedisService'])?_0x46d08f:Object])],_0x44d664);},_0x322ad2=>{_0x322ad2['exports']=require('crypto');},function(_0x54cc28,_0x1ef0ea,_0x13ee5c){const _0x4dad67=a0_0x2823;var _0x23ecfd,_0x56ed01,_0x5036ab,_0x33783a,_0x2443d1,_0x48091d,_0x5e811f=this&&this['__decorate']||function(_0x185e51,_0x30060a,_0x3b2538,_0x49a6b8){const _0x5e4520=a0_0x2823;var _0x4671cf,_0x4547a5=arguments[_0x5e4520(0x390)],_0x510826=_0x4547a5<0x3?_0x30060a:null===_0x49a6b8?_0x49a6b8=Object['getOwnPropertyDescriptor'](_0x30060a,_0x3b2538):_0x49a6b8;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x510826=Reflect['decorate'](_0x185e51,_0x30060a,_0x3b2538,_0x49a6b8);else{for(var _0x26f3af=_0x185e51['length']-0x1;_0x26f3af>=0x0;_0x26f3af--)(_0x4671cf=_0x185e51[_0x26f3af])&&(_0x510826=(_0x4547a5<0x3?_0x4671cf(_0x510826):_0x4547a5>0x3?_0x4671cf(_0x30060a,_0x3b2538,_0x510826):_0x4671cf(_0x30060a,_0x3b2538))||_0x510826);}return _0x4547a5>0x3&&_0x510826&&Object['defineProperty'](_0x30060a,_0x3b2538,_0x510826),_0x510826;},_0x2bbfc9=this&&this['__metadata']||function(_0x2ed374,_0x1999bd){if('object'==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x2ed374,_0x1999bd);},_0x1c744a=this&&this['__param']||function(_0xf7fff4,_0xc9196){return function(_0x116ace,_0x267a47){_0xc9196(_0x116ace,_0x267a47,_0xf7fff4);};};Object[_0x4dad67(0x1b6)](_0x1ef0ea,'__esModule',{'value':!0x0}),_0x1ef0ea['WithdrawalJobManagerService']=void 0x0;const _0x4c6de0=_0x13ee5c(0x2),_0x5b551e=_0x13ee5c(0x7),_0x3cf1a0=_0x13ee5c(0x6),_0x42efb0=_0x13ee5c(0x2f),_0x284208=_0x13ee5c(0xa),_0x578496=_0x13ee5c(0x15),_0x5844c5=_0x13ee5c(0x2c),_0x1af12b=_0x13ee5c(0x14),_0x449d7a=_0x13ee5c(0x19),_0x1835e4=_0x13ee5c(0x2a),_0x12c36a=_0x13ee5c(0x30),_0x516f31=_0x13ee5c(0x31),_0x28f083=_0x13ee5c(0x12);let _0x31fd9c=class{constructor(_0x2c857e,_0x11f680,_0x144d2d,_0x17e200,_0x2d1b27,_0x451f7a){const _0x106359=_0x4dad67;this[_0x106359(0x325)]=_0x2c857e,this['withdrawalService']=_0x11f680,this[_0x106359(0x2f2)]=_0x144d2d,this[_0x106359(0x276)]=_0x17e200,this[_0x106359(0x2ec)]=_0x2d1b27,this['bankService']=_0x451f7a,this[_0x106359(0x32b)]=new _0x4c6de0['Logger'](_0x106359(0x210)),this[_0x106359(0x172)]=new Set(),this['isInitialized']=!0x1;}async['onModuleInit'](){const _0x184c17=_0x4dad67;this['logger']['log'](_0x184c17(0x266)),setTimeout(()=>{this['initializeJobProcessing']();},0x1388);}async['initializeJobProcessing'](){this['isInitialized']||await this['startProcessing']();}async[_0x4dad67(0x16c)](){const _0x5a2e30=_0x4dad67;try{this['logger']['log']('Starting\x20withdrawal\x20job\x20processing...'),await this['pickAndProcessJobs'](),this['isInitialized']=!0x0;}catch(_0x508d27){this['logger']['error'](_0x5a2e30(0x255)+_0x508d27['message'],_0x508d27['stack']);}}async[_0x4dad67(0x340)](){const _0x52c309=_0x4dad67;try{const _0xee73a=await this['wsService']['listDevices'](),_0x4023ea=[];for(const _0x4742db of _0xee73a){const _0x50a61d=await this['deviceService']['getDeviceConfig'](_0x4742db['udid']);'active'===_0x50a61d?.[_0x52c309(0x263)]&&(await this['deviceLock']['isLocked'](_0x4742db[_0x52c309(0x20a)])||_0x4023ea['push']({'udid':_0x4742db[_0x52c309(0x20a)],'config':_0x50a61d}));}return _0x4023ea;}catch(_0x51654c){return this['logger']['error']('Error\x20getting\x20available\x20devices:\x20'+_0x51654c['message']),[];}}async['pickAndProcessJobs'](_0x486a79){const _0x47234d=_0x4dad67;try{const _0x3323c4=await this['deviceService']['getServiceStatus']();if(_0x47234d(0x1a8)!==_0x3323c4)return void this['logger']['debug']('Service\x20is\x20'+_0x3323c4+',\x20cannot\x20pick\x20jobs');const _0x4e87ef=await this['getAvailableDevices'](),_0x1505db=_0x4e87ef['length'];if(_0x1505db<=0x0)return;const _0x59b05d=_0x486a79?Math[_0x47234d(0x18c)](_0x486a79,_0x1505db):_0x1505db,_0x319797=await this['withdrawalQueue']['getJobs']([_0x47234d(0x361)],0x0,_0x59b05d-0x1);if(0x0===_0x319797[_0x47234d(0x390)])return;this['logger']['log']('Found\x20'+_0x4e87ef['length']+_0x47234d(0x2c0)+_0x319797['length']+'\x20jobs\x20('+(_0x319797||[])['length']+'\x20waiting.');for(let _0x50a066=0x0;_0x50a066<_0x319797['length'];_0x50a066++){const _0x1805a7=_0x319797[_0x50a066],_0x550b56=_0x4e87ef[_0x50a066];if(this['processingJobs']['has'](_0x1805a7['id']))continue;const _0x1ebf4c='withdraw:'+_0x1805a7['data']['withdrawalId']+':'+_0x550b56['udid'];await this['deviceLock']['acquireLock'](_0x550b56[_0x47234d(0x20a)],'transfer',_0x1ebf4c,0x35e80)?this['processJob'](_0x1805a7,_0x550b56[_0x47234d(0x20a)])[_0x47234d(0x23c)](_0x2e08d2=>{this['deviceLock']['releaseLock'](_0x550b56['udid'])['catch'](()=>{}),this['logger']['error']('Error\x20processing\x20job\x20'+_0x1805a7['id']+':\x20'+_0x2e08d2['message'],_0x2e08d2['stack']);}):this['logger'][_0x47234d(0x234)](_0x47234d(0x26a)+_0x550b56['udid']+'\x20was\x20locked\x20after\x20assignment,\x20skipping\x20job\x20'+_0x1805a7['id']);}}catch(_0x1809b5){this['logger'][_0x47234d(0x134)]('Error\x20picking\x20jobs:\x20'+_0x1809b5['message'],_0x1809b5[_0x47234d(0x2dc)]);}}async['processJob'](_0x55df57,_0x133732){const _0x23328b=_0x4dad67,_0x5279d1=(0x0,_0x12c36a['cloneDeep'])(_0x55df57['data']),{withdrawalId:_0x4c9936}=_0x5279d1;try{this['logger'][_0x23328b(0x310)]('Successfully\x20processed\x20and\x20removed\x20withdrawal\x20'+_0x4c9936+'\x20from\x20queue'),await _0x55df57['remove']();}catch(_0x27735a){this['logger']['warn']('Could\x20not\x20remove\x20completed\x20job\x20'+_0x55df57['id']+':\x20'+_0x27735a['message']);}_0x5279d1&&_0x5279d1['withdrawalId']||this['logger']['error']('Invalid\x20withdrawal\x20data\x20in\x20job\x20'+_0x55df57['id']),_0x5279d1[_0x23328b(0x175)]&&await this[_0x23328b(0x246)][_0x23328b(0x332)](_0x133732,_0x5279d1),this['processingJobs']['add'](_0x55df57['id']);try{await this[_0x23328b(0x2fd)]['processWithdrawal'](_0x5279d1,_0x133732);}catch(_0x138c33){let _0x2faafd;this[_0x23328b(0x32b)]['error']('Error\x20processing\x20withdrawal\x20'+_0x4c9936+':\x20'+_0x138c33['message'],_0x138c33['stack']),_0x2faafd=_0x138c33 instanceof _0x1835e4['WithdrawalProcessingError']?_0x138c33['errorType']:(0x0,_0x1835e4['classifyError'])(_0x138c33[_0x23328b(0x2c9)],_0x138c33),_0x2faafd===_0x1835e4[_0x23328b(0x1ff)]['FORCE_LOGIN']&&await this['bankService'][_0x23328b(0x163)](_0x5279d1['bankCode'],_0x133732,!0x0),await this['handleJobFailure'](_0x5279d1,_0x138c33[_0x23328b(0x2c9)],_0x2faafd);}finally{this[_0x23328b(0x172)]['delete'](_0x55df57['id']);}}async['handleJobFailure'](_0x47e87f,_0x239cbf,_0x3122c9=_0x1835e4['ErrorType'][_0x4dad67(0x32c)]){const _0x357b14=_0x4dad67,_0x6871aa=_0x47e87f['manualRetryCount']??0x0;if(this[_0x357b14(0x32b)][_0x357b14(0x234)](_0x357b14(0x284)+_0x47e87f['withdrawalId']+'\x20failed.\x20Reason:\x20'+_0x239cbf+_0x357b14(0x27d)+_0x3122c9+'.\x20Retry\x20attempt:\x20'+_0x6871aa+'/3'),_0x6871aa<0x3){if(_0x3122c9===_0x1835e4[_0x357b14(0x1ff)]['UNKNOWN']||_0x3122c9===_0x1835e4['ErrorType'][_0x357b14(0x157)])return;await this['withdrawalQueue']['add'](_0x357b14(0x14c),{..._0x47e87f,'manualRetryCount':_0x6871aa+0x1,'lastErrorType':_0x3122c9,'lastErrorReason':_0x239cbf},{'attempts':0x0,'removeOnComplete':!0x1,'removeOnFail':!0x1,'jobId':_0x357b14(0x36b)+_0x47e87f['withdrawalId'],'priority':0x0,'delay':0x7530});}else this['logger']['warn']('Max\x20retries\x20(3)\x20exceeded\x20for\x20withdrawal\x20'+_0x47e87f['withdrawalId']+':\x20'+_0x3122c9+'\x20error:\x20'+_0x239cbf);}async[_0x4dad67(0x33a)](){return(0x0,_0x516f31['withCronLock'])('cron:promote_delayed:withdrawal',0x1388,async()=>{const _0x38764a=a0_0x2823,_0x4bed74=Date['now'](),_0x42da3b=await this['withdrawalQueue']['getJobs']([_0x38764a(0x28b)],0x0,0x63);if(!_0x42da3b['length'])return;let _0x14a9b9=0x0;for(const _0x1fa89b of _0x42da3b){const _0x3d17ab='number'==typeof _0x1fa89b[_0x38764a(0x2e5)]?.['delay']?_0x1fa89b['opts']['delay']:0x0;if(('number'==typeof _0x1fa89b['timestamp']?_0x1fa89b['timestamp']:0x0)+_0x3d17ab<=_0x4bed74)try{await _0x1fa89b[_0x38764a(0x2b7)](),_0x14a9b9++;}catch(_0x5ec186){this['logger']['debug']('Promote\x20skipped\x20for\x20job\x20'+_0x1fa89b['id']+':\x20'+String(_0x5ec186));}}_0x14a9b9>0x0&&this['logger'][_0x38764a(0x310)]('Promoted\x20'+_0x14a9b9+'\x20delayed\x20jobs\x20to\x20waiting');});}async[_0x4dad67(0x131)](_0x463ada=0x1){await this['pickAndProcessJobs'](_0x463ada);}async['getQueueStats'](){const _0x461334=_0x4dad67,[_0x3b6214,_0x522c4a,_0x444c88,_0x67bd9d,_0x2611e7,_0x41b600,_0x1345d0]=await Promise[_0x461334(0x28e)]([this['withdrawalQueue'][_0x461334(0x2a8)](),this['withdrawalQueue']['getDelayedCount'](),this['withdrawalQueue']['getActiveCount'](),this['withdrawalQueue']['getCompletedCount'](),this[_0x461334(0x325)][_0x461334(0x19a)](),this['getAvailableDevices'](),this['deviceService']['getServiceStatus']()]);return{'serviceStatus':_0x1345d0,'activeDevices':_0x41b600['length'],'processingJobs':this[_0x461334(0x172)]['size'],'isInitialized':this['isInitialized'],'queue':{'waiting':_0x3b6214,'delayed':_0x522c4a,'active':_0x444c88,'completed':_0x67bd9d,'failed':_0x2611e7,'total':_0x3b6214+_0x522c4a+_0x444c88}};}async['debugQueue'](){const _0x4a0139=_0x4dad67,_0x299d95=await this['getQueueStats'](),[_0x577d76,_0x2c833e]=await Promise['all']([this['withdrawalQueue']['getJobs'](['waiting'],0x0,0x9),this[_0x4a0139(0x325)]['getJobs']([_0x4a0139(0x28b)],0x0,0x9)]);return{..._0x299d95,'sampleWaitingJobs':_0x577d76['map'](_0x77147a=>({'id':_0x77147a['id'],'data':_0x77147a['data'],'opts':_0x77147a['opts'],'manualRetryCount':_0x77147a['data'][_0x4a0139(0x1f0)]})),'sampleDelayedJobs':_0x2c833e['map'](_0x56b111=>({'id':_0x56b111['id'],'data':_0x56b111['data'],'opts':_0x56b111[_0x4a0139(0x2e5)],'manualRetryCount':_0x56b111['data']['manualRetryCount']}))};}async['periodicJobPicking'](){const _0x189d8a=_0x4dad67;await this[_0x189d8a(0x321)]();}async['promoteDelayedJobsPeriodically'](){await this['promoteDelayedJobs']();}};_0x1ef0ea['WithdrawalJobManagerService']=_0x31fd9c,_0x5e811f([(0x0,_0x5b551e['Cron'])('*/5\x20*\x20*\x20*\x20*\x20*'),_0x2bbfc9('design:type',Function),_0x2bbfc9('design:paramtypes',[]),_0x2bbfc9(_0x4dad67(0x364),Promise)],_0x31fd9c['prototype'],_0x4dad67(0x13d),null),_0x5e811f([(0x0,_0x5b551e[_0x4dad67(0x183)])('*/5\x20*\x20*\x20*\x20*\x20*'),_0x2bbfc9('design:type',Function),_0x2bbfc9(_0x4dad67(0x381),[]),_0x2bbfc9('design:returntype',Promise)],_0x31fd9c['prototype'],_0x4dad67(0x1ba),null),_0x1ef0ea['WithdrawalJobManagerService']=_0x31fd9c=_0x5e811f([(0x0,_0x4c6de0[_0x4dad67(0x185)])(),_0x1c744a(0x0,(0x0,_0x3cf1a0['InjectQueue'])(_0x4dad67(0x166))),_0x1c744a(0x4,(0x0,_0x4c6de0['Inject'])(_0x1af12b['WEBSOCKET_SERVICE'])),_0x2bbfc9('design:paramtypes',[_0x4dad67(0x2d3)==typeof(_0x23ecfd=void 0x0!==_0x42efb0['Queue']&&_0x42efb0[_0x4dad67(0x37e)])?_0x23ecfd:Object,'function'==typeof(_0x56ed01=void 0x0!==_0x284208['WithdrawalService']&&_0x284208['WithdrawalService'])?_0x56ed01:Object,_0x4dad67(0x2d3)==typeof(_0x5036ab=void 0x0!==_0x578496[_0x4dad67(0x367)]&&_0x578496['DeviceService'])?_0x5036ab:Object,_0x4dad67(0x2d3)==typeof(_0x33783a=void 0x0!==_0x5844c5['DeviceLockService']&&_0x5844c5['DeviceLockService'])?_0x33783a:Object,_0x4dad67(0x2d3)==typeof(_0x2443d1=void 0x0!==_0x449d7a['IWebSocketService']&&_0x449d7a[_0x4dad67(0x2e0)])?_0x2443d1:Object,'function'==typeof(_0x48091d=void 0x0!==_0x28f083['BankService']&&_0x28f083['BankService'])?_0x48091d:Object])],_0x31fd9c);},_0x3f8c81=>{const _0x5e0756=a0_0x2823;_0x3f8c81[_0x5e0756(0x140)]=require('bull');},_0x5621cc=>{_0x5621cc['exports']=require('lodash');},(_0x1711a6,_0x2e8ce1,_0xc2e8e0)=>{const _0x4d504e=a0_0x2823;Object[_0x4d504e(0x1b6)](_0x2e8ce1,'__esModule',{'value':!0x0}),_0x2e8ce1['withCronLock']=void 0x0;const _0x2fae0e=_0xc2e8e0(0x17),_0x378c13=_0xc2e8e0(0xf),_0x47a866=new _0x2fae0e[(_0x4d504e(0x2e2))]({'host':_0x378c13['config']['redis']['host'],'port':_0x378c13[_0x4d504e(0x298)]['redis']['port'],'password':_0x378c13['config']['redis']['password'],'db':_0x378c13['config']['redis']['db']});_0x2e8ce1[_0x4d504e(0x241)]=async(_0x2c81a2,_0x44d3a3,_0x4ac5bc)=>{const _0x4de8c2=_0x4d504e,_0x9d4305=process['pid']+':'+Date[_0x4de8c2(0x1b5)]();if(await _0x47a866['set'](_0x2c81a2,_0x9d4305,'PX',_0x44d3a3,'NX'))try{await _0x4ac5bc();}finally{const _0x1a81ba='\x0a\x20\x20\x20\x20\x20\x20if\x20redis.call(\x22GET\x22,\x20KEYS[1])\x20==\x20ARGV[1]\x20then\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20redis.call(\x22DEL\x22,\x20KEYS[1])\x0a\x20\x20\x20\x20\x20\x20end\x0a\x20\x20\x20\x20\x20\x20return\x200\x0a\x20\x20\x20\x20';await _0x47a866[_0x4de8c2(0x2a5)](_0x1a81ba,0x1,_0x2c81a2,_0x9d4305);}};},function(_0x1a7215,_0xe68808,_0x37462b){const _0x2d4396=a0_0x2823;var _0x3e68b0,_0x101ec2=this&&this[_0x2d4396(0x2c3)]||function(_0x55564c,_0x19e835,_0x408103,_0x10bd98){const _0x20e7dd=_0x2d4396;var _0x4f3f7c,_0x5109b0=arguments[_0x20e7dd(0x390)],_0x45e0fb=_0x5109b0<0x3?_0x19e835:null===_0x10bd98?_0x10bd98=Object['getOwnPropertyDescriptor'](_0x19e835,_0x408103):_0x10bd98;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x45e0fb=Reflect['decorate'](_0x55564c,_0x19e835,_0x408103,_0x10bd98);else{for(var _0x2c2c7c=_0x55564c[_0x20e7dd(0x390)]-0x1;_0x2c2c7c>=0x0;_0x2c2c7c--)(_0x4f3f7c=_0x55564c[_0x2c2c7c])&&(_0x45e0fb=(_0x5109b0<0x3?_0x4f3f7c(_0x45e0fb):_0x5109b0>0x3?_0x4f3f7c(_0x19e835,_0x408103,_0x45e0fb):_0x4f3f7c(_0x19e835,_0x408103))||_0x45e0fb);}return _0x5109b0>0x3&&_0x45e0fb&&Object['defineProperty'](_0x19e835,_0x408103,_0x45e0fb),_0x45e0fb;},_0x590071=this&&this['__metadata']||function(_0x21cabb,_0x588893){const _0x3a5824=_0x2d4396;if(_0x3a5824(0x374)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect['metadata'](_0x21cabb,_0x588893);};Object['defineProperty'](_0xe68808,'__esModule',{'value':!0x0}),_0xe68808['WithdrawalController']=void 0x0;const _0x2044bc=_0x37462b(0x2),_0x178697=_0x37462b(0x3),_0x2c50de=_0x37462b(0x2e);let _0x4d4244=class{constructor(_0x29d2b7){const _0x49f531=_0x2d4396;this['jobManagerService']=_0x29d2b7,this['logger']=new _0x2044bc[(_0x49f531(0x294))]('WithdrawalController');}async['getQueueStats'](){const _0x32bd8c=_0x2d4396;return await this['jobManagerService'][_0x32bd8c(0x17c)]();}async['debugQueue'](){const _0x969c21=_0x2d4396;return await this[_0x969c21(0x1c3)]['debugQueue']();}async['triggerJobPicking'](){return this['logger']['log']('Manually\x20triggering\x20job\x20picking...'),await this['jobManagerService']['triggerPickJobs'](0x1),{'success':!0x0,'message':'Job\x20picking\x20triggered','stats':await this['jobManagerService']['getQueueStats']()};}async['startProcessing'](){const _0x5f1e21=_0x2d4396;return this['logger'][_0x5f1e21(0x310)]('Manually\x20starting\x20job\x20processing...'),await this['jobManagerService']['startProcessing'](),{'success':!0x0,'message':'Job\x20processing\x20started','stats':await this['jobManagerService'][_0x5f1e21(0x17c)]()};}};_0xe68808[_0x2d4396(0x358)]=_0x4d4244,_0x101ec2([(0x0,_0x2044bc['Get'])(_0x2d4396(0x2c8)),(0x0,_0x178697[_0x2d4396(0x2d2)])({'summary':'Get\x20withdrawal\x20queue\x20statistics'}),(0x0,_0x178697['ApiResponse'])({'status':0xc8,'description':'Queue\x20statistics'}),_0x590071(_0x2d4396(0x187),Function),_0x590071('design:paramtypes',[]),_0x590071('design:returntype',Promise)],_0x4d4244['prototype'],'getQueueStats',null),_0x101ec2([(0x0,_0x2044bc['Get'])('queue/debug'),(0x0,_0x178697['ApiOperation'])({'summary':'Get\x20detailed\x20queue\x20debug\x20information'}),(0x0,_0x178697['ApiResponse'])({'status':0xc8,'description':'Detailed\x20queue\x20debug\x20info'}),_0x590071('design:type',Function),_0x590071('design:paramtypes',[]),_0x590071('design:returntype',Promise)],_0x4d4244['prototype'],'debugQueue',null),_0x101ec2([(0x0,_0x2044bc['Post'])('queue/trigger'),(0x0,_0x178697['ApiOperation'])({'summary':'Manually\x20trigger\x20job\x20picking'}),(0x0,_0x178697['ApiResponse'])({'status':0xc8,'description':'Job\x20picking\x20triggered'}),_0x590071('design:type',Function),_0x590071('design:paramtypes',[]),_0x590071('design:returntype',Promise)],_0x4d4244['prototype'],_0x2d4396(0x1c4),null),_0x101ec2([(0x0,_0x2044bc[_0x2d4396(0x2bc)])(_0x2d4396(0x375)),(0x0,_0x178697['ApiOperation'])({'summary':_0x2d4396(0x21a)}),(0x0,_0x178697['ApiResponse'])({'status':0xc8,'description':'Job\x20processing\x20started'}),_0x590071(_0x2d4396(0x187),Function),_0x590071('design:paramtypes',[]),_0x590071('design:returntype',Promise)],_0x4d4244['prototype'],_0x2d4396(0x16c),null),_0xe68808['WithdrawalController']=_0x4d4244=_0x101ec2([(0x0,_0x178697['ApiTags'])('withdrawal'),(0x0,_0x2044bc['Controller'])('api/withdrawal'),_0x590071('design:paramtypes',['function'==typeof(_0x3e68b0=void 0x0!==_0x2c50de['WithdrawalJobManagerService']&&_0x2c50de['WithdrawalJobManagerService'])?_0x3e68b0:Object])],_0x4d4244);},function(_0x56cd18,_0x446d40,_0x34e7d4){const _0x3582a4=a0_0x2823;var _0x1c57fd=this&&this['__decorate']||function(_0x3e2351,_0x12d302,_0x68056d,_0x260a7b){const _0x523aec=a0_0x2823;var _0x47af90,_0x1c96e3=arguments['length'],_0x5e43e7=_0x1c96e3<0x3?_0x12d302:null===_0x260a7b?_0x260a7b=Object['getOwnPropertyDescriptor'](_0x12d302,_0x68056d):_0x260a7b;if(_0x523aec(0x374)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x5e43e7=Reflect['decorate'](_0x3e2351,_0x12d302,_0x68056d,_0x260a7b);else{for(var _0x2c1eea=_0x3e2351['length']-0x1;_0x2c1eea>=0x0;_0x2c1eea--)(_0x47af90=_0x3e2351[_0x2c1eea])&&(_0x5e43e7=(_0x1c96e3<0x3?_0x47af90(_0x5e43e7):_0x1c96e3>0x3?_0x47af90(_0x12d302,_0x68056d,_0x5e43e7):_0x47af90(_0x12d302,_0x68056d))||_0x5e43e7);}return _0x1c96e3>0x3&&_0x5e43e7&&Object['defineProperty'](_0x12d302,_0x68056d,_0x5e43e7),_0x5e43e7;};Object[_0x3582a4(0x1b6)](_0x446d40,'__esModule',{'value':!0x0}),_0x446d40[_0x3582a4(0x190)]=void 0x0;const _0x5e6e46=_0x34e7d4(0x2),_0x14bf52=_0x34e7d4(0x18);let _0x3f425f=class{};_0x446d40[_0x3582a4(0x190)]=_0x3f425f,_0x446d40['HcBoxModule']=_0x3f425f=_0x1c57fd([(0x0,_0x5e6e46['Module'])({'providers':[_0x14bf52['HcBoxService']],'exports':[_0x14bf52[_0x3582a4(0x13f)]]})],_0x3f425f);},function(_0x359281,_0x547c1f,_0x342aa7){const _0x5a9383=a0_0x2823;var _0x492001=this&&this[_0x5a9383(0x2c3)]||function(_0x27cbd7,_0xf031a,_0x5ba130,_0x1ffa49){const _0x541c7c=_0x5a9383;var _0x2392c9,_0x305652=arguments['length'],_0x1cfe73=_0x305652<0x3?_0xf031a:null===_0x1ffa49?_0x1ffa49=Object['getOwnPropertyDescriptor'](_0xf031a,_0x5ba130):_0x1ffa49;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x1cfe73=Reflect['decorate'](_0x27cbd7,_0xf031a,_0x5ba130,_0x1ffa49);else{for(var _0x50a704=_0x27cbd7[_0x541c7c(0x390)]-0x1;_0x50a704>=0x0;_0x50a704--)(_0x2392c9=_0x27cbd7[_0x50a704])&&(_0x1cfe73=(_0x305652<0x3?_0x2392c9(_0x1cfe73):_0x305652>0x3?_0x2392c9(_0xf031a,_0x5ba130,_0x1cfe73):_0x2392c9(_0xf031a,_0x5ba130))||_0x1cfe73);}return _0x305652>0x3&&_0x1cfe73&&Object['defineProperty'](_0xf031a,_0x5ba130,_0x1cfe73),_0x1cfe73;};Object[_0x5a9383(0x1b6)](_0x547c1f,_0x5a9383(0x143),{'value':!0x0}),_0x547c1f[_0x5a9383(0x233)]=void 0x0;const _0x3b368f=_0x342aa7(0x2),_0x36c4a4=_0x342aa7(0x35),_0x57db19=_0x342aa7(0x15),_0x5f0245=_0x342aa7(0x2c),_0x4dd1e9=_0x342aa7(0x33),_0x17422e=_0x342aa7(0x16),_0x3501d1=_0x342aa7(0x38);let _0x2d748e=class{};_0x547c1f['DeviceModule']=_0x2d748e,_0x547c1f['DeviceModule']=_0x2d748e=_0x492001([(0x0,_0x3b368f['Module'])({'imports':[_0x4dd1e9[_0x5a9383(0x190)],(0x0,_0x3b368f['forwardRef'])(()=>_0x3501d1['BankModule'])],'controllers':[_0x36c4a4['DeviceController']],'providers':[_0x57db19[_0x5a9383(0x367)],_0x5f0245['DeviceLockService'],_0x17422e['RedisService']],'exports':[_0x57db19[_0x5a9383(0x367)],_0x5f0245['DeviceLockService']]})],_0x2d748e);},function(_0x1390ac,_0x195995,_0x275e41){const _0x443e35=a0_0x2823;var _0x21eba3,_0xf1b342,_0x591eb9,_0x1ec2b2=this&&this[_0x443e35(0x2c3)]||function(_0x42b06c,_0x4e6040,_0x594410,_0x24000b){const _0x6ee44a=_0x443e35;var _0x53720b,_0x24ace=arguments['length'],_0x3544bf=_0x24ace<0x3?_0x4e6040:null===_0x24000b?_0x24000b=Object[_0x6ee44a(0x380)](_0x4e6040,_0x594410):_0x24000b;if(_0x6ee44a(0x374)==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x3544bf=Reflect['decorate'](_0x42b06c,_0x4e6040,_0x594410,_0x24000b);else{for(var _0x9b524a=_0x42b06c[_0x6ee44a(0x390)]-0x1;_0x9b524a>=0x0;_0x9b524a--)(_0x53720b=_0x42b06c[_0x9b524a])&&(_0x3544bf=(_0x24ace<0x3?_0x53720b(_0x3544bf):_0x24ace>0x3?_0x53720b(_0x4e6040,_0x594410,_0x3544bf):_0x53720b(_0x4e6040,_0x594410))||_0x3544bf);}return _0x24ace>0x3&&_0x3544bf&&Object['defineProperty'](_0x4e6040,_0x594410,_0x3544bf),_0x3544bf;},_0x1fe69b=this&&this['__metadata']||function(_0x1d93a1,_0x3c41f7){const _0xb30438=_0x443e35;if('object'==typeof Reflect&&'function'==typeof Reflect[_0xb30438(0x219)])return Reflect[_0xb30438(0x219)](_0x1d93a1,_0x3c41f7);},_0x2bb108=this&&this['__param']||function(_0xf633dd,_0x26a22b){return function(_0x361680,_0x412677){_0x26a22b(_0x361680,_0x412677,_0xf633dd);};};Object['defineProperty'](_0x195995,_0x443e35(0x143),{'value':!0x0}),_0x195995['DeviceController']=void 0x0;const _0x3fae0=_0x275e41(0x2),_0x383ce9=_0x275e41(0x15),_0x53e071=_0x275e41(0x36),_0x340600=_0x275e41(0x12),_0x157587=_0x275e41(0xf);let _0x11df51=class{constructor(_0x493010,_0x245b35){const _0x1bbcc4=_0x443e35;this['deviceService']=_0x493010,this['bankService']=_0x245b35,this['logger']=new _0x3fae0[(_0x1bbcc4(0x294))]('DeviceController');}async[_0x443e35(0x2d7)](){const _0x518761=_0x443e35;return{'devices':await this[_0x518761(0x2f2)][_0x518761(0x347)](),'serviceStatus':await this[_0x518761(0x2f2)]['getServiceStatus'](),'banks':['VIETCOMBANK','TPBANK','TECHCOMBANK',_0x518761(0x2eb),'PGBANK'],'boxType':_0x157587['config']['boxType']};}async['getDevices'](){return{'success':!0x0,'data':await this['deviceService']['listDevices']()};}async['getDeviceConfig'](_0x333fde){const _0x568c36=_0x443e35;return{'success':!0x0,'data':await this['deviceService'][_0x568c36(0x2aa)](_0x333fde)};}async['retryLogin'](_0x2a927f){const _0x58e20d=_0x443e35;try{this['logger']['log'](_0x58e20d(0x1ac)+_0x2a927f);const _0xb73040=await this['deviceService']['getDeviceConfig'](_0x2a927f);if(!_0xb73040)throw new _0x3fae0[(_0x58e20d(0x2c4))]({'success':!0x1,'error':_0x58e20d(0x26a)+_0x2a927f+_0x58e20d(0x1be)},_0x3fae0[_0x58e20d(0x1b2)][_0x58e20d(0x327)]);if(!_0xb73040['bankCode']||''===_0xb73040['bankCode']['trim']())throw new _0x3fae0['HttpException']({'success':!0x1,'error':'Device\x20'+_0x2a927f+'\x20does\x20not\x20have\x20bankCode\x20configured.\x20Please\x20configure\x20bankCode\x20first.'},_0x3fae0['HttpStatus'][_0x58e20d(0x327)]);if('active'!==_0xb73040[_0x58e20d(0x263)])throw new _0x3fae0['HttpException']({'success':!0x1,'error':'Device\x20'+_0x2a927f+_0x58e20d(0x13b)},_0x3fae0['HttpStatus']['BAD_REQUEST']);const _0x24e410=_0xb73040['bankCode']['toUpperCase']();return await this['bankService'][_0x58e20d(0x163)](_0x24e410,_0x2a927f),{'success':!0x0,'message':'Successfully\x20logged\x20in\x20to\x20'+_0x24e410+'\x20on\x20device\x20'+_0x2a927f};}catch(_0x141d43){if(_0x141d43 instanceof _0x3fae0[_0x58e20d(0x2c4)])throw _0x141d43;throw this['logger'][_0x58e20d(0x134)]('Error\x20retrying\x20login\x20for\x20device\x20'+_0x2a927f+':\x20'+_0x141d43['message'],_0x141d43[_0x58e20d(0x2dc)]),new _0x3fae0[(_0x58e20d(0x2c4))]({'success':!0x1,'error':_0x141d43['message']||'Failed\x20to\x20retry\x20login'},_0x3fae0['HttpStatus']['INTERNAL_SERVER_ERROR']);}}async[_0x443e35(0x26e)](_0x489805,_0x674cde){const _0x1052c6=_0x443e35;try{this[_0x1052c6(0x32b)]['log']('Updating\x20device\x20config\x20for\x20'+_0x489805+':\x20'+JSON['stringify'](_0x674cde));const _0x47c28f=await this[_0x1052c6(0x2f2)]['getDeviceConfig'](_0x489805);if('active'===(void 0x0!==_0x674cde['status']?_0x674cde[_0x1052c6(0x263)]:_0x47c28f?.['status']||'deactive')){const _0x47e94e=[],_0xd0fa46=void 0x0!==_0x674cde['bankCode']?_0x674cde['bankCode']:_0x47c28f?.['bankCode'];_0xd0fa46&&''!==_0xd0fa46['trim']()||_0x47e94e['push'](_0x1052c6(0x244));const _0xde096a=void 0x0!==_0x674cde['availableAmount']?_0x674cde[_0x1052c6(0x291)]:_0x47c28f?.['availableAmount'];(null==_0xde096a||_0xde096a<0x0)&&_0x47e94e['push']('Available\x20Amount\x20lÃ \x20báº¯t\x20buá»™c\x20vÃ \x20pháº£i\x20>=\x200\x20khi\x20status\x20lÃ \x20active');const _0x1308fc=void 0x0!==_0x674cde['password']?_0x674cde[_0x1052c6(0x254)]:_0x47c28f?.['password'];_0x1308fc&&''!==_0x1308fc[_0x1052c6(0x250)]()||_0x47e94e['push'](_0x1052c6(0x1e5));const _0x43f685=void 0x0!==_0x674cde['smartOTP']?_0x674cde['smartOTP']:_0x47c28f?.['smartOTP'];if(_0x43f685&&''!==_0x43f685['trim']()||_0x47e94e['push'](_0x1052c6(0x360)),_0x47e94e['length']>0x0)throw new _0x3fae0[(_0x1052c6(0x2c4))]({'success':!0x1,'error':_0x47e94e['join'](',\x20')},_0x3fae0['HttpStatus']['BAD_REQUEST']);}return{'success':!0x0,'data':await this['deviceService']['updateDeviceConfig'](_0x489805,_0x674cde)};}catch(_0x545ec6){if(_0x545ec6 instanceof _0x3fae0[_0x1052c6(0x2c4)])throw _0x545ec6;throw this['logger'][_0x1052c6(0x134)]('Error\x20updating\x20device\x20config\x20for\x20'+_0x489805+':\x20'+_0x545ec6[_0x1052c6(0x2c9)],_0x545ec6['stack']),new _0x3fae0[(_0x1052c6(0x2c4))]({'success':!0x1,'error':_0x545ec6['message']||'Failed\x20to\x20update\x20device\x20config'},_0x3fae0['HttpStatus']['INTERNAL_SERVER_ERROR']);}}async['getServiceStatus'](){return{'success':!0x0,'data':{'status':await this['deviceService']['getServiceStatus']()}};}async[_0x443e35(0x319)](){const _0x90f4a2=_0x443e35;try{if(!await this['deviceService'][_0x90f4a2(0x1dd)]())throw new _0x3fae0['HttpException']({'success':!0x1,'error':'Vui\x20lÃ²ng\x20active\x20bank\x20trÆ°á»›c\x20khi\x20start'},_0x3fae0['HttpStatus']['BAD_REQUEST']);return this['bankService']['loginAllActiveBanks']()[_0x90f4a2(0x23c)](_0x50d33c=>{const _0x475510=_0x90f4a2;this['logger']['error']('Error\x20during\x20background\x20login\x20process:\x20'+_0x50d33c[_0x475510(0x2c9)]);}),await new Promise(_0x26d51e=>setTimeout(_0x26d51e,0x7d0)),await this['deviceService']['setServiceStatus']('active'),{'success':!0x0,'message':'Service\x20started\x20successfully.\x20Devices\x20are\x20logging\x20in\x20and\x20will\x20accept\x20jobs\x20when\x20ready.'};}catch(_0x1065d0){if(_0x1065d0 instanceof _0x3fae0['HttpException'])throw _0x1065d0;throw this['logger'][_0x90f4a2(0x134)]('Error\x20starting\x20service:\x20'+_0x1065d0[_0x90f4a2(0x2c9)],_0x1065d0[_0x90f4a2(0x2dc)]),new _0x3fae0[(_0x90f4a2(0x2c4))]({'success':!0x1,'error':_0x1065d0[_0x90f4a2(0x2c9)]||'Failed\x20to\x20start\x20service'},_0x3fae0[_0x90f4a2(0x1b2)]['INTERNAL_SERVER_ERROR']);}}async[_0x443e35(0x2a7)](){const _0x443e54=_0x443e35;return await this['deviceService'][_0x443e54(0x38f)](_0x443e54(0x29a)),{'success':!0x0,'message':_0x443e54(0x341)};}};_0x195995['DeviceController']=_0x11df51,_0x1ec2b2([(0x0,_0x3fae0[_0x443e35(0x18d)])(),(0x0,_0x3fae0[_0x443e35(0x1a5)])('devices'),_0x1fe69b('design:type',Function),_0x1fe69b(_0x443e35(0x381),[]),_0x1fe69b('design:returntype',Promise)],_0x11df51[_0x443e35(0x1e9)],_0x443e35(0x2d7),null),_0x1ec2b2([(0x0,_0x3fae0['Get'])('api/devices'),_0x1fe69b('design:type',Function),_0x1fe69b('design:paramtypes',[]),_0x1fe69b('design:returntype',Promise)],_0x11df51[_0x443e35(0x1e9)],_0x443e35(0x249),null),_0x1ec2b2([(0x0,_0x3fae0['Get'])('api/devices/:deviceId/config'),_0x2bb108(0x0,(0x0,_0x3fae0['Param'])('deviceId')),_0x1fe69b('design:type',Function),_0x1fe69b('design:paramtypes',[String]),_0x1fe69b('design:returntype',Promise)],_0x11df51['prototype'],_0x443e35(0x2aa),null),_0x1ec2b2([(0x0,_0x3fae0[_0x443e35(0x2bc)])('api/devices/:deviceId/retryLogin'),_0x2bb108(0x0,(0x0,_0x3fae0[_0x443e35(0x2c7)])('deviceId')),_0x1fe69b(_0x443e35(0x187),Function),_0x1fe69b('design:paramtypes',[String]),_0x1fe69b('design:returntype',Promise)],_0x11df51['prototype'],'retryLogin',null),_0x1ec2b2([(0x0,_0x3fae0['Put'])('api/devices/:deviceId/config'),_0x2bb108(0x0,(0x0,_0x3fae0['Param'])('deviceId')),_0x2bb108(0x1,(0x0,_0x3fae0['Body'])()),_0x1fe69b('design:type',Function),_0x1fe69b(_0x443e35(0x381),[String,'function'==typeof(_0x591eb9=void 0x0!==_0x53e071[_0x443e35(0x23e)]&&_0x53e071['UpdateDeviceConfigDto'])?_0x591eb9:Object]),_0x1fe69b(_0x443e35(0x364),Promise)],_0x11df51['prototype'],'updateDeviceConfig',null),_0x1ec2b2([(0x0,_0x3fae0['Get'])('api/service/status'),_0x1fe69b(_0x443e35(0x187),Function),_0x1fe69b('design:paramtypes',[]),_0x1fe69b('design:returntype',Promise)],_0x11df51['prototype'],_0x443e35(0x269),null),_0x1ec2b2([(0x0,_0x3fae0['Post'])(_0x443e35(0x239)),_0x1fe69b('design:type',Function),_0x1fe69b(_0x443e35(0x381),[]),_0x1fe69b('design:returntype',Promise)],_0x11df51['prototype'],'startService',null),_0x1ec2b2([(0x0,_0x3fae0['Post'])('api/service/stop'),_0x1fe69b('design:type',Function),_0x1fe69b('design:paramtypes',[]),_0x1fe69b('design:returntype',Promise)],_0x11df51[_0x443e35(0x1e9)],'stopService',null),_0x195995[_0x443e35(0x21c)]=_0x11df51=_0x1ec2b2([(0x0,_0x3fae0[_0x443e35(0x23b)])(),_0x1fe69b(_0x443e35(0x381),[_0x443e35(0x2d3)==typeof(_0x21eba3=void 0x0!==_0x383ce9[_0x443e35(0x367)]&&_0x383ce9['DeviceService'])?_0x21eba3:Object,'function'==typeof(_0xf1b342=void 0x0!==_0x340600[_0x443e35(0x191)]&&_0x340600['BankService'])?_0xf1b342:Object])],_0x11df51);},function(_0x157e2c,_0xc01448,_0x147be0){const _0x1b2528=a0_0x2823;var _0x557847=this&&this['__decorate']||function(_0x2c69cd,_0x3f7743,_0x5895da,_0x3b0dd0){const _0xd8fcd4=a0_0x2823;var _0x10c80c,_0x489aeb=arguments[_0xd8fcd4(0x390)],_0x279e81=_0x489aeb<0x3?_0x3f7743:null===_0x3b0dd0?_0x3b0dd0=Object[_0xd8fcd4(0x380)](_0x3f7743,_0x5895da):_0x3b0dd0;if('object'==typeof Reflect&&_0xd8fcd4(0x2d3)==typeof Reflect['decorate'])_0x279e81=Reflect[_0xd8fcd4(0x1ad)](_0x2c69cd,_0x3f7743,_0x5895da,_0x3b0dd0);else{for(var _0x850f37=_0x2c69cd[_0xd8fcd4(0x390)]-0x1;_0x850f37>=0x0;_0x850f37--)(_0x10c80c=_0x2c69cd[_0x850f37])&&(_0x279e81=(_0x489aeb<0x3?_0x10c80c(_0x279e81):_0x489aeb>0x3?_0x10c80c(_0x3f7743,_0x5895da,_0x279e81):_0x10c80c(_0x3f7743,_0x5895da))||_0x279e81);}return _0x489aeb>0x3&&_0x279e81&&Object['defineProperty'](_0x3f7743,_0x5895da,_0x279e81),_0x279e81;},_0x5a984d=this&&this['__metadata']||function(_0x8741b9,_0x4515cc){const _0x3cd267=a0_0x2823;if(_0x3cd267(0x374)==typeof Reflect&&_0x3cd267(0x2d3)==typeof Reflect['metadata'])return Reflect[_0x3cd267(0x219)](_0x8741b9,_0x4515cc);};Object[_0x1b2528(0x1b6)](_0xc01448,'__esModule',{'value':!0x0}),_0xc01448['UpdateDeviceConfigDto']=void 0x0;const _0x2b8203=_0x147be0(0x37);class _0x5d0522{}_0xc01448['UpdateDeviceConfigDto']=_0x5d0522,_0x557847([(0x0,_0x2b8203[_0x1b2528(0x25f)])(_0x111ce5=>'active'===_0x111ce5['status']),(0x0,_0x2b8203[_0x1b2528(0x22f)])({'message':_0x1b2528(0x25b)}),(0x0,_0x2b8203['IsString'])(),(0x0,_0x2b8203['IsOptional'])(),_0x5a984d('design:type',String)],_0x5d0522[_0x1b2528(0x1e9)],_0x1b2528(0x31a),void 0x0),_0x557847([(0x0,_0x2b8203['ValidateIf'])(_0xab7107=>'active'===_0xab7107[_0x1b2528(0x263)]),(0x0,_0x2b8203['IsNotEmpty'])({'message':'Available\x20Amount\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x2b8203['IsNumber'])(),(0x0,_0x2b8203['Min'])(0x0,{'message':_0x1b2528(0x1b0)}),(0x0,_0x2b8203['IsOptional'])(),_0x5a984d('design:type',Number)],_0x5d0522['prototype'],_0x1b2528(0x291),void 0x0),_0x557847([(0x0,_0x2b8203['IsOptional'])(),(0x0,_0x2b8203['IsString'])(),(0x0,_0x2b8203['IsIn'])([_0x1b2528(0x1a8),'deactive']),_0x5a984d('design:type',String)],_0x5d0522[_0x1b2528(0x1e9)],_0x1b2528(0x263),void 0x0),_0x557847([(0x0,_0x2b8203['ValidateIf'])(_0x40d02f=>'active'===_0x40d02f[_0x1b2528(0x263)]),(0x0,_0x2b8203[_0x1b2528(0x22f)])({'message':'Password\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x2b8203[_0x1b2528(0x2d1)])(),(0x0,_0x2b8203['IsOptional'])(),_0x5a984d('design:type',String)],_0x5d0522[_0x1b2528(0x1e9)],_0x1b2528(0x254),void 0x0),_0x557847([(0x0,_0x2b8203[_0x1b2528(0x25f)])(_0x171ef8=>'active'===_0x171ef8[_0x1b2528(0x263)]),(0x0,_0x2b8203['IsNotEmpty'])({'message':'Smart\x20OTP\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x2b8203['IsString'])(),(0x0,_0x2b8203['IsOptional'])(),_0x5a984d('design:type',String)],_0x5d0522['prototype'],'smartOTP',void 0x0),_0x557847([(0x0,_0x2b8203['ValidateIf'])(_0x3f044e=>'active'===_0x3f044e['status']),(0x0,_0x2b8203[_0x1b2528(0x22f)])({'message':'Account\x20No\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x2b8203['IsString'])(),(0x0,_0x2b8203['IsOptional'])(),_0x5a984d(_0x1b2528(0x187),String)],_0x5d0522[_0x1b2528(0x1e9)],_0x1b2528(0x371),void 0x0),_0x557847([(0x0,_0x2b8203['ValidateIf'])(_0x380be6=>'active'===_0x380be6['status']),(0x0,_0x2b8203['IsNotEmpty'])({'message':'Account\x20Name\x20is\x20required\x20when\x20status\x20is\x20active'}),(0x0,_0x2b8203['IsString'])(),(0x0,_0x2b8203['IsOptional'])(),_0x5a984d('design:type',String)],_0x5d0522['prototype'],'accountName',void 0x0);},_0x5b00e1=>{_0x5b00e1['exports']=require('class-validator');},function(_0x5ba530,_0x227d99,_0x5209c9){const _0x331579=a0_0x2823;var _0x5262d8=this&&this['__decorate']||function(_0x303017,_0x510205,_0x127e08,_0x1f3802){const _0x262207=a0_0x2823;var _0x11024a,_0x25af1b=arguments['length'],_0x5b5157=_0x25af1b<0x3?_0x510205:null===_0x1f3802?_0x1f3802=Object[_0x262207(0x380)](_0x510205,_0x127e08):_0x1f3802;if('object'==typeof Reflect&&_0x262207(0x2d3)==typeof Reflect['decorate'])_0x5b5157=Reflect['decorate'](_0x303017,_0x510205,_0x127e08,_0x1f3802);else{for(var _0x104ba7=_0x303017['length']-0x1;_0x104ba7>=0x0;_0x104ba7--)(_0x11024a=_0x303017[_0x104ba7])&&(_0x5b5157=(_0x25af1b<0x3?_0x11024a(_0x5b5157):_0x25af1b>0x3?_0x11024a(_0x510205,_0x127e08,_0x5b5157):_0x11024a(_0x510205,_0x127e08))||_0x5b5157);}return _0x25af1b>0x3&&_0x5b5157&&Object['defineProperty'](_0x510205,_0x127e08,_0x5b5157),_0x5b5157;};Object['defineProperty'](_0x227d99,'__esModule',{'value':!0x0}),_0x227d99['BankModule']=void 0x0;const _0x1e0c39=_0x5209c9(0x2),_0x57e59e=_0x5209c9(0x12),_0x5d5307=_0x5209c9(0x13),_0x15523e=_0x5209c9(0x27),_0x113bf3=_0x5209c9(0x39),_0x26d7e1=_0x5209c9(0x33),_0x9f4fb7=_0x5209c9(0x34),_0x236eeb=_0x5209c9(0x3a),_0x6f513d=_0x5209c9(0x2b),_0x3b5eef=_0x5209c9(0x3e),_0x945c16=_0x5209c9(0x16),_0x2dd5d8=_0x5209c9(0x3f);let _0x522cb7=class{};_0x227d99['BankModule']=_0x522cb7,_0x227d99['BankModule']=_0x522cb7=_0x5262d8([(0x0,_0x1e0c39['Module'])({'imports':[_0x26d7e1['HcBoxModule'],(0x0,_0x1e0c39['forwardRef'])(()=>_0x9f4fb7['DeviceModule']),_0x236eeb[_0x331579(0x15a)],_0x2dd5d8['OCRModule']],'controllers':[_0x113bf3['BankController']],'providers':[_0x57e59e['BankService'],_0x5d5307['AcbService'],_0x15523e[_0x331579(0x1ed)],_0x6f513d['SessionManagementService'],_0x3b5eef[_0x331579(0x305)],_0x945c16['RedisService']],'exports':[_0x57e59e['BankService']]})],_0x522cb7);},function(_0x594b58,_0x118289,_0x74b54e){const _0x2a9862=a0_0x2823;var _0x3d0d7e,_0x272e10,_0x4d4ad5,_0x1cd5e8=this&&this['__decorate']||function(_0x1db1c5,_0x2a121d,_0x385fbf,_0x2b2ac7){const _0x1b777a=a0_0x2823;var _0x3a473c,_0xe2bf23=arguments[_0x1b777a(0x390)],_0x103e88=_0xe2bf23<0x3?_0x2a121d:null===_0x2b2ac7?_0x2b2ac7=Object['getOwnPropertyDescriptor'](_0x2a121d,_0x385fbf):_0x2b2ac7;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x1b777a(0x1ad)])_0x103e88=Reflect['decorate'](_0x1db1c5,_0x2a121d,_0x385fbf,_0x2b2ac7);else{for(var _0x3db1e2=_0x1db1c5[_0x1b777a(0x390)]-0x1;_0x3db1e2>=0x0;_0x3db1e2--)(_0x3a473c=_0x1db1c5[_0x3db1e2])&&(_0x103e88=(_0xe2bf23<0x3?_0x3a473c(_0x103e88):_0xe2bf23>0x3?_0x3a473c(_0x2a121d,_0x385fbf,_0x103e88):_0x3a473c(_0x2a121d,_0x385fbf))||_0x103e88);}return _0xe2bf23>0x3&&_0x103e88&&Object[_0x1b777a(0x1b6)](_0x2a121d,_0x385fbf,_0x103e88),_0x103e88;},_0x1383ee=this&&this['__metadata']||function(_0x293d4a,_0x182fcc){const _0x330ae8=a0_0x2823;if('object'==typeof Reflect&&_0x330ae8(0x2d3)==typeof Reflect[_0x330ae8(0x219)])return Reflect['metadata'](_0x293d4a,_0x182fcc);},_0x10457d=this&&this[_0x2a9862(0x300)]||function(_0x1b74ca,_0x30fe41){return function(_0x1f190e,_0x3d7443){_0x30fe41(_0x1f190e,_0x3d7443,_0x1b74ca);};};Object['defineProperty'](_0x118289,_0x2a9862(0x143),{'value':!0x0}),_0x118289['BankController']=void 0x0;const _0x4411d1=_0x74b54e(0x2),_0x37437a=_0x74b54e(0x3),_0x27efaf=_0x74b54e(0x12),_0x577196=_0x74b54e(0x18),_0xd21bc5=_0x74b54e(0xf),_0x43f610=_0x74b54e(0x19),_0x59be7b=_0x74b54e(0x14);let _0x555285=class{constructor(_0x2f6a53,_0x38dc69,_0x4149cb){const _0x142799=_0x2a9862;this['bankService']=_0x2f6a53,this['hcBoxService']=_0x38dc69,this['wsService']=_0x4149cb,this['logger']=new _0x4411d1['Logger'](_0x142799(0x1de));}[_0x2a9862(0x182)](_0x4b7d62){const _0x4fa245=_0x2a9862,_0x8af911=this[_0x4fa245(0x246)][_0x4fa245(0x182)](_0x4b7d62);if(!_0x8af911)throw new _0x4411d1[(_0x4fa245(0x2c4))]({'success':!0x1,'error':'Bank\x20service\x20not\x20found\x20for\x20bank\x20code:\x20'+_0x4b7d62+'.\x20Supported\x20banks:\x20'+this[_0x4fa245(0x246)]['getSupportedBanks']()['join'](',\x20')},_0x4411d1[_0x4fa245(0x1b2)]['BAD_REQUEST']);return _0x8af911;}async['getDevices'](_0x11b136){const _0x3444cb=_0x2a9862;try{return{'success':!0x0,'data':await this[_0x3444cb(0x357)]['listDevices']()};}catch(_0x2c3725){return this['logger']['error']('Error\x20getting\x20devices:\x20'+_0x2c3725['message']),{'success':!0x1,'error':_0x2c3725['message']};}}async[_0x2a9862(0x2a6)](_0x52eee8,_0x2b10e8){const _0x443551=_0x2a9862;try{const _0x24c38c=this['getBankService'](_0x52eee8);return this['logger']['log'](_0x443551(0x26f)+_0x52eee8+'\x20app\x20launch\x20on\x20device:\x20'+_0x2b10e8),await _0x24c38c[_0x443551(0x2de)](_0x2b10e8),{'success':!0x0,'message':_0x52eee8+'\x20app\x20launched\x20successfully\x20on\x20device\x20'+_0x2b10e8};}catch(_0x1266e8){return this['logger']['error']('Error\x20testing\x20'+_0x52eee8+'\x20app\x20launch:\x20'+_0x1266e8['message']),{'success':!0x1,'error':_0x1266e8['message']};}}async['testCaptureScreen'](_0x4131f5,_0x322f87,_0x3c2fd8,_0x431202){const _0x1d63b2=_0x2a9862;try{this['getBankService'](_0x4131f5),this[_0x1d63b2(0x32b)][_0x1d63b2(0x310)](_0x1d63b2(0x1ce)+_0x322f87);const _0x4f4ea6=_0x431202?parseFloat(_0x431202):0.5,_0x14bf3d=_0x3c2fd8||_0x1d63b2(0x28c)+Date[_0x1d63b2(0x1b5)](),_0x278205=await this['wsService'][_0x1d63b2(0x1da)](_0x322f87,{'quality':_0x4f4ea6,'folderPath':'C:/boxscreen/'+_0x14bf3d+'.png'});return{'success':!0x0,'message':'Screen\x20captured\x20successfully\x20on\x20device\x20'+_0x322f87,'data':{'base64Image':_0x278205,'imageLength':_0x278205?.['length']??0x0}};}catch(_0x3a6f65){return this['logger']['error']('Error\x20testing\x20screen\x20capture:\x20'+_0x3a6f65['message']),{'success':!0x1,'error':_0x3a6f65['message']};}}async['testClickAtCoordinates'](_0x591dc9,_0x36942e,_0x4620b5,_0x4727a5){const _0x1dab5f=_0x2a9862;try{const _0x5c6719=parseFloat(_0x4620b5),_0x48295c=parseFloat(_0x4727a5);return isNaN(_0x5c6719)||isNaN(_0x48295c)?{'success':!0x1,'error':'Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20numbers\x20between\x200\x20and\x201','example':'/api/bank/'+_0x591dc9+'/test/click/{deviceId}?x=0.5&y=0.55'}:(this['logger']['log']('Testing\x20click\x20at\x20coordinates\x20('+_0x5c6719+',\x20'+_0x48295c+')\x20on\x20device:\x20'+_0x36942e),await this['wsService'][_0x1dab5f(0x392)](_0x36942e,_0x5c6719,_0x48295c),{'success':!0x0,'message':'Click\x20completed\x20successfully\x20at\x20coordinates\x20('+_0x5c6719+',\x20'+_0x48295c+')\x20on\x20device\x20'+_0x36942e,'coordinates':{'x':_0x5c6719,'y':_0x48295c}});}catch(_0x646ac2){return this['logger']['error']('Error\x20testing\x20click\x20at\x20coordinates:\x20'+_0x646ac2['message']),{'success':!0x1,'error':_0x646ac2['message']};}}async['testSwipe'](_0x46e73f,_0x22d159,_0x4113e4,_0x574212,_0x23bdb1,_0xe91650,_0x29cdb3,_0xc5e9d3){const _0x425477=_0x2a9862;try{this[_0x425477(0x182)](_0x46e73f);const _0x721fd4=_0x425477(0x32a)===_0xd21bc5[_0x425477(0x298)][_0x425477(0x2b4)],_0x69ae04='HC'===_0xd21bc5['config']['boxType'];if(_0x721fd4){if(!_0x23bdb1)return{'success':!0x1,'error':'For\x20Panda\x20format:\x20type\x20is\x20required','example':'/api/bank/'+_0x46e73f+'/test/swipe/{deviceId}?type=0'};if(!['0','1','2','4','5','6','7','8','9','10']['includes'](_0x23bdb1))return{'success':!0x1,'error':_0x425477(0x2e1),'example':'/api/bank/'+_0x46e73f+_0x425477(0x24d)};if(!(['4','5','6','7','8','9'][_0x425477(0x30d)](_0x23bdb1)||_0x4113e4&&_0x574212))return{'success':!0x1,'error':'For\x20Panda\x20type\x20'+_0x23bdb1+_0x425477(0x2db),'example':'/api/bank/'+_0x46e73f+'/test/swipe/{deviceId}?x=50&y=30&type='+_0x23bdb1};const _0x54edc2={'type':_0x23bdb1};if(_0x4113e4&&_0x574212){const _0x320cd1=parseFloat(_0x4113e4),_0x31f796=parseFloat(_0x574212);if(isNaN(_0x320cd1)||isNaN(_0x31f796))return{'success':!0x1,'error':'Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20numbers\x20between\x200\x20and\x20100\x20for\x20Panda','example':'/api/bank/'+_0x46e73f+'/test/swipe/{deviceId}?x=50&y=30&type='+_0x23bdb1};if(_0x320cd1<0x0||_0x320cd1>0x64||_0x31f796<0x0||_0x31f796>0x64)return{'success':!0x1,'error':'Invalid\x20coordinates.\x20x\x20and\x20y\x20must\x20be\x20between\x200\x20and\x20100\x20for\x20Panda','example':'/api/bank/'+_0x46e73f+'/test/swipe/{deviceId}?x=50&y=30&type='+_0x23bdb1};_0x54edc2['x']=_0x320cd1['toString'](),_0x54edc2['y']=_0x31f796['toString']();}return this['logger'][_0x425477(0x310)](_0x425477(0x315)+_0x22d159+'\x20with\x20type='+_0x23bdb1+(_0x4113e4&&_0x574212?_0x425477(0x308)+_0x4113e4+',\x20y='+_0x574212:_0x425477(0x1a2))),await this['wsService']['swipe'](_0x22d159,_0x54edc2),{'success':!0x0,'message':_0x425477(0x351)+_0x22d159,'coordinates':{'type':_0x23bdb1,..._0x4113e4&&_0x574212?{'x':_0x4113e4,'y':_0x574212}:{}}};}if(_0x69ae04){if(!(_0x4113e4&&_0x574212&&_0xe91650&&_0x29cdb3))return{'success':!0x1,'error':'For\x20HC\x20format:\x20x,\x20y,\x20endX,\x20and\x20endY\x20are\x20required','example':'/api/bank/'+_0x46e73f+'/test/swipe/{deviceId}?x=0.2&y=0.5&endX=0.8&endY=0.5&duration=0.3'};const _0x4fcb40=parseFloat(_0x4113e4),_0x39e7b4=parseFloat(_0x574212),_0x519535=parseFloat(_0xe91650),_0x3d1e31=parseFloat(_0x29cdb3),_0x59c849=_0xc5e9d3?parseFloat(_0xc5e9d3):0.2;return isNaN(_0x4fcb40)||isNaN(_0x39e7b4)||isNaN(_0x519535)||isNaN(_0x3d1e31)?{'success':!0x1,'error':_0x425477(0x237),'example':'/api/bank/'+_0x46e73f+_0x425477(0x138)}:_0x4fcb40<0x0||_0x4fcb40>0x1||_0x39e7b4<0x0||_0x39e7b4>0x1||_0x519535<0x0||_0x519535>0x1||_0x3d1e31<0x0||_0x3d1e31>0x1?{'success':!0x1,'error':'Invalid\x20coordinates.\x20x,\x20y,\x20endX,\x20and\x20endY\x20must\x20be\x20between\x200\x20and\x201\x20for\x20HC','example':'/api/bank/'+_0x46e73f+_0x425477(0x138)}:(this[_0x425477(0x32b)][_0x425477(0x310)]('Testing\x20HC\x20swipe\x20from\x20('+_0x4fcb40+',\x20'+_0x39e7b4+')\x20to\x20('+_0x519535+',\x20'+_0x3d1e31+')\x20on\x20device:\x20'+_0x22d159),await this['wsService']['swipe'](_0x22d159,{'x':_0x4fcb40,'y':_0x39e7b4,'endX':_0x519535,'endY':_0x3d1e31,'duration':_0x59c849}),{'success':!0x0,'message':'HC\x20swipe\x20completed\x20successfully\x20from\x20('+_0x4fcb40+',\x20'+_0x39e7b4+')\x20to\x20('+_0x519535+',\x20'+_0x3d1e31+')\x20on\x20device\x20'+_0x22d159,'coordinates':{'start':{'x':_0x4fcb40,'y':_0x39e7b4},'end':{'x':_0x519535,'y':_0x3d1e31},'duration':_0x59c849}});}return{'success':!0x1,'error':_0x425477(0x256)+_0xd21bc5['config'][_0x425477(0x2b4)]+_0x425477(0x139)};}catch(_0x4baa00){return this['logger'][_0x425477(0x134)]('Error\x20testing\x20swipe:\x20'+_0x4baa00[_0x425477(0x2c9)]),{'success':!0x1,'error':_0x4baa00['message']};}}async['testInputNumpadNumber'](_0x5deab1,_0x1f8d96,_0x50e490){const _0x285da3=_0x2a9862;try{return this['getBankService'](_0x5deab1),_0x50e490&&0x0!==_0x50e490['trim']()['length']?/^\d+$/['test'](_0x50e490)?(this['logger'][_0x285da3(0x310)]('Testing\x20numpad\x20number\x20input\x20\x22'+_0x50e490+_0x285da3(0x273)+_0x1f8d96),await this[_0x285da3(0x357)][_0x285da3(0x150)](_0x1f8d96,_0x50e490),{'success':!0x0,'message':'Numpad\x20number\x20input\x20completed\x20successfully\x20on\x20device\x20'+_0x1f8d96,'data':{'number':_0x50e490,'digits':_0x50e490['split']('')['map'](_0x1f9793=>parseInt(_0x1f9793))}}):{'success':!0x1,'error':'Number\x20must\x20contain\x20only\x20digits\x20(0-9)','example':'/api/bank/'+_0x5deab1+'/test/input-numpad/{deviceId}?number=123456'}:{'success':!0x1,'error':'Number\x20is\x20required\x20and\x20cannot\x20be\x20empty','example':'/api/bank/'+_0x5deab1+'/test/input-numpad/{deviceId}?number=123456'};}catch(_0x370273){return this[_0x285da3(0x32b)]['error'](_0x285da3(0x165)+_0x370273['message']),{'success':!0x1,'error':_0x370273[_0x285da3(0x2c9)]};}}async['testInputText'](_0x363381,_0x1af165,_0x163d34){const _0x2a50f3=_0x2a9862;try{return this[_0x2a50f3(0x182)](_0x363381),_0x163d34&&0x0!==_0x163d34[_0x2a50f3(0x250)]()['length']?(this['logger']['log']('Testing\x20text\x20input\x20\x22'+_0x163d34+'\x22\x20on\x20device:\x20'+_0x1af165),await this['hcBoxService']['inputText'](_0x1af165,_0x163d34),{'success':!0x0,'message':_0x2a50f3(0x35e)+_0x1af165}):{'success':!0x1,'error':'Text\x20is\x20required\x20and\x20cannot\x20be\x20empty','example':'/api/bank/'+_0x363381+'/test/input-text/{deviceId}?text=abc123'};}catch(_0x31c03d){return this['logger'][_0x2a50f3(0x134)]('Error\x20testing\x20text\x20input:\x20'+_0x31c03d['message']),{'success':!0x1,'error':_0x31c03d['message']};}}async[_0x2a9862(0x248)](_0x438d9c,_0x49130f){const _0x227181=_0x2a9862;try{return this[_0x227181(0x182)](_0x438d9c),this['logger']['log']('Testing\x20press\x20return\x20key\x20on\x20device:\x20'+_0x49130f),await this[_0x227181(0x2ec)]['pressReturnKey'](_0x49130f),{'success':!0x0,'message':_0x227181(0x216)+_0x49130f,'note':'This\x20key\x20can\x20dismiss\x20keyboard\x20or\x20submit/enter\x20depending\x20on\x20context'};}catch(_0x279441){return this[_0x227181(0x32b)][_0x227181(0x134)]('Error\x20testing\x20press\x20return:\x20'+_0x279441[_0x227181(0x2c9)]),{'success':!0x1,'error':_0x279441[_0x227181(0x2c9)]};}}};_0x118289[_0x2a9862(0x1de)]=_0x555285,_0x1cd5e8([(0x0,_0x4411d1[_0x2a9862(0x18d)])(_0x2a9862(0x21d)),(0x0,_0x37437a['ApiOperation'])({'summary':_0x2a9862(0x194)}),(0x0,_0x37437a[_0x2a9862(0x344)])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x37437a['ApiResponse'])({'status':0xc8,'description':_0x2a9862(0x2f7)}),_0x10457d(0x0,(0x0,_0x4411d1['Param'])('bankCode')),_0x1383ee(_0x2a9862(0x187),Function),_0x1383ee('design:paramtypes',[String]),_0x1383ee(_0x2a9862(0x364),Promise)],_0x555285['prototype'],'getDevices',null),_0x1cd5e8([(0x0,_0x4411d1['Post'])('test/launch-app/:deviceId'),(0x0,_0x37437a['ApiOperation'])({'summary':_0x2a9862(0x320)}),(0x0,_0x37437a['ApiParam'])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x37437a['ApiParam'])({'name':'deviceId','description':_0x2a9862(0x20b)}),(0x0,_0x37437a['ApiResponse'])({'status':0xc8,'description':_0x2a9862(0x223)}),_0x10457d(0x0,(0x0,_0x4411d1[_0x2a9862(0x2c7)])('bankCode')),_0x10457d(0x1,(0x0,_0x4411d1[_0x2a9862(0x2c7)])('deviceId')),_0x1383ee('design:type',Function),_0x1383ee('design:paramtypes',[String,String]),_0x1383ee('design:returntype',Promise)],_0x555285[_0x2a9862(0x1e9)],'testLaunchApp',null),_0x1cd5e8([(0x0,_0x4411d1[_0x2a9862(0x2bc)])('test/capture-screen/:deviceId'),(0x0,_0x37437a[_0x2a9862(0x2d2)])({'summary':_0x2a9862(0x1d1)}),(0x0,_0x37437a['ApiParam'])({'name':_0x2a9862(0x31a),'description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x37437a['ApiParam'])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x37437a['ApiQuery'])({'name':'name','description':_0x2a9862(0x23f),'required':!0x1}),(0x0,_0x37437a[_0x2a9862(0x279)])({'name':'quality','description':_0x2a9862(0x366),'required':!0x1}),(0x0,_0x37437a['ApiResponse'])({'status':0xc8,'description':_0x2a9862(0x1a0)}),_0x10457d(0x0,(0x0,_0x4411d1['Param'])('bankCode')),_0x10457d(0x1,(0x0,_0x4411d1['Param'])(_0x2a9862(0x22e))),_0x10457d(0x2,(0x0,_0x4411d1[_0x2a9862(0x1e8)])('name')),_0x10457d(0x3,(0x0,_0x4411d1['Query'])('quality')),_0x1383ee('design:type',Function),_0x1383ee('design:paramtypes',[String,String,String,String]),_0x1383ee(_0x2a9862(0x364),Promise)],_0x555285['prototype'],'testCaptureScreen',null),_0x1cd5e8([(0x0,_0x4411d1['Post'])('test/click/:deviceId'),(0x0,_0x37437a['ApiOperation'])({'summary':_0x2a9862(0x28a)}),(0x0,_0x37437a['ApiParam'])({'name':'bankCode','description':_0x2a9862(0x1fc)}),(0x0,_0x37437a[_0x2a9862(0x344)])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x37437a['ApiQuery'])({'name':'x','description':'X\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100)','required':!0x0}),(0x0,_0x37437a['ApiQuery'])({'name':'y','description':_0x2a9862(0x14a),'required':!0x0}),(0x0,_0x37437a[_0x2a9862(0x21f)])({'status':0xc8,'description':'Click\x20completed\x20successfully'}),_0x10457d(0x0,(0x0,_0x4411d1['Param'])('bankCode')),_0x10457d(0x1,(0x0,_0x4411d1['Param'])(_0x2a9862(0x22e))),_0x10457d(0x2,(0x0,_0x4411d1[_0x2a9862(0x1e8)])('x')),_0x10457d(0x3,(0x0,_0x4411d1['Query'])('y')),_0x1383ee('design:type',Function),_0x1383ee(_0x2a9862(0x381),[String,String,String,String]),_0x1383ee('design:returntype',Promise)],_0x555285['prototype'],_0x2a9862(0x259),null),_0x1cd5e8([(0x0,_0x4411d1['Post'])('test/swipe/:deviceId'),(0x0,_0x37437a[_0x2a9862(0x2d2)])({'summary':'Test\x20swiping\x20on\x20a\x20device.\x20Format\x20is\x20determined\x20by\x20config.boxType\x20(HC\x20or\x20PANDA)'}),(0x0,_0x37437a['ApiParam'])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x37437a['ApiParam'])({'name':'deviceId','description':_0x2a9862(0x20b)}),(0x0,_0x37437a['ApiQuery'])({'name':'x','description':_0x2a9862(0x271),'required':!0x1}),(0x0,_0x37437a['ApiQuery'])({'name':'y','description':'Y\x20coordinate\x20(HC:\x200-1,\x20Panda:\x200-100).\x20Required\x20for\x20HC\x20and\x20Panda\x20types\x200,1,2,10.\x20Optional\x20for\x20Panda\x20types\x204,5,6,7,8,9','required':!0x1}),(0x0,_0x37437a['ApiQuery'])({'name':'type','description':'Panda\x20pointer\x20event\x20type:\x200=æŒ‰ä¸‹(press),\x201=æŠ¬èµ·(lift),\x202=ç§»åŠ¨(move),\x204=æ»šè½®å‘ä¸Š(scroll\x20up),\x205=æ»šè½®å‘ä¸‹(scroll\x20down),\x206=ä¸Šæ»‘(swipe\x20up),\x207=ä¸‹æ»‘(swipe\x20down),\x208=å·¦æ»‘(swipe\x20left),\x209=å³æ»‘(swipe\x20right),\x2010=ç‚¹å‡»(click).\x20Required\x20for\x20Panda\x20format.','required':!0x1}),(0x0,_0x37437a['ApiQuery'])({'name':'endX','description':_0x2a9862(0x2ad),'required':!0x1}),(0x0,_0x37437a[_0x2a9862(0x279)])({'name':_0x2a9862(0x25d),'description':'End\x20Y\x20coordinate\x20for\x20HC\x20(required\x20for\x20HC:\x200-1)','required':!0x1}),(0x0,_0x37437a[_0x2a9862(0x279)])({'name':'duration','description':'Swipe\x20duration\x20for\x20HC\x20(default:\x200.2)','required':!0x1}),(0x0,_0x37437a[_0x2a9862(0x21f)])({'status':0xc8,'description':_0x2a9862(0x352)}),_0x10457d(0x0,(0x0,_0x4411d1['Param'])(_0x2a9862(0x31a))),_0x10457d(0x1,(0x0,_0x4411d1[_0x2a9862(0x2c7)])('deviceId')),_0x10457d(0x2,(0x0,_0x4411d1[_0x2a9862(0x1e8)])('x')),_0x10457d(0x3,(0x0,_0x4411d1['Query'])('y')),_0x10457d(0x4,(0x0,_0x4411d1['Query'])('type')),_0x10457d(0x5,(0x0,_0x4411d1['Query'])(_0x2a9862(0x32d))),_0x10457d(0x6,(0x0,_0x4411d1[_0x2a9862(0x1e8)])('endY')),_0x10457d(0x7,(0x0,_0x4411d1['Query'])('duration')),_0x1383ee('design:type',Function),_0x1383ee(_0x2a9862(0x381),[String,String,String,String,String,String,String,String]),_0x1383ee('design:returntype',Promise)],_0x555285['prototype'],'testSwipe',null),_0x1cd5e8([(0x0,_0x4411d1['Post'])('test/input-numpad/:deviceId'),(0x0,_0x37437a[_0x2a9862(0x2d2)])({'summary':'Test\x20inputting\x20number\x20using\x20numpad\x20layout\x20on\x20a\x20device'}),(0x0,_0x37437a[_0x2a9862(0x344)])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x37437a['ApiParam'])({'name':'deviceId','description':'Device\x20ID'}),(0x0,_0x37437a['ApiQuery'])({'name':_0x2a9862(0x372),'description':'Number\x20string\x20to\x20input\x20(e.g.,\x20\x22123\x22,\x20\x22456789\x22)','required':!0x0}),(0x0,_0x37437a['ApiResponse'])({'status':0xc8,'description':_0x2a9862(0x265)}),_0x10457d(0x0,(0x0,_0x4411d1['Param'])('bankCode')),_0x10457d(0x1,(0x0,_0x4411d1['Param'])('deviceId')),_0x10457d(0x2,(0x0,_0x4411d1['Query'])('number')),_0x1383ee('design:type',Function),_0x1383ee('design:paramtypes',[String,String,String]),_0x1383ee('design:returntype',Promise)],_0x555285['prototype'],_0x2a9862(0x379),null),_0x1cd5e8([(0x0,_0x4411d1['Post'])('test/input-text/:deviceId'),(0x0,_0x37437a['ApiOperation'])({'summary':_0x2a9862(0x316)}),(0x0,_0x37437a['ApiParam'])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x37437a['ApiParam'])({'name':_0x2a9862(0x22e),'description':_0x2a9862(0x20b)}),(0x0,_0x37437a['ApiQuery'])({'name':'text','description':'Text\x20string\x20to\x20input\x20(e.g.,\x20\x22abc123\x22,\x20\x22test@email.com\x22)','required':!0x0}),(0x0,_0x37437a['ApiResponse'])({'status':0xc8,'description':'Text\x20input\x20completed\x20successfully'}),_0x10457d(0x0,(0x0,_0x4411d1['Param'])('bankCode')),_0x10457d(0x1,(0x0,_0x4411d1['Param'])('deviceId')),_0x10457d(0x2,(0x0,_0x4411d1['Query'])(_0x2a9862(0x198))),_0x1383ee(_0x2a9862(0x187),Function),_0x1383ee(_0x2a9862(0x381),[String,String,String]),_0x1383ee('design:returntype',Promise)],_0x555285[_0x2a9862(0x1e9)],_0x2a9862(0x36f),null),_0x1cd5e8([(0x0,_0x4411d1['Post'])('test/press-return/:deviceId'),(0x0,_0x37437a['ApiOperation'])({'summary':'Test\x20pressing\x20return\x20key\x20on\x20a\x20device'}),(0x0,_0x37437a[_0x2a9862(0x344)])({'name':'bankCode','description':'Bank\x20code\x20(ACB,\x20PGBANK,\x20etc.)'}),(0x0,_0x37437a['ApiParam'])({'name':_0x2a9862(0x22e),'description':_0x2a9862(0x20b)}),(0x0,_0x37437a[_0x2a9862(0x21f)])({'status':0xc8,'description':'Return\x20key\x20pressed\x20successfully'}),_0x10457d(0x0,(0x0,_0x4411d1['Param'])(_0x2a9862(0x31a))),_0x10457d(0x1,(0x0,_0x4411d1['Param'])('deviceId')),_0x1383ee(_0x2a9862(0x187),Function),_0x1383ee('design:paramtypes',[String,String]),_0x1383ee('design:returntype',Promise)],_0x555285['prototype'],'testPressReturn',null),_0x118289[_0x2a9862(0x1de)]=_0x555285=_0x1cd5e8([(0x0,_0x37437a['ApiTags'])('bank'),(0x0,_0x4411d1[_0x2a9862(0x23b)])('api/bank/:bankCode'),_0x10457d(0x2,(0x0,_0x4411d1['Inject'])(_0x59be7b['WEBSOCKET_SERVICE'])),_0x1383ee(_0x2a9862(0x381),['function'==typeof(_0x3d0d7e=void 0x0!==_0x27efaf['BankService']&&_0x27efaf['BankService'])?_0x3d0d7e:Object,'function'==typeof(_0x272e10=void 0x0!==_0x577196['HcBoxService']&&_0x577196['HcBoxService'])?_0x272e10:Object,'function'==typeof(_0x4d4ad5=void 0x0!==_0x43f610['IWebSocketService']&&_0x43f610[_0x2a9862(0x2e0)])?_0x4d4ad5:Object])],_0x555285);},function(_0x3ae55e,_0x55d4bb,_0x34b016){const _0xeafb7=a0_0x2823;var _0x47ef9a=this&&this['__decorate']||function(_0x4ff6a6,_0x3b25b0,_0x4c57e8,_0xa0299){const _0x5360d0=a0_0x2823;var _0x4e389c,_0xafaf62=arguments[_0x5360d0(0x390)],_0x4bf533=_0xafaf62<0x3?_0x3b25b0:null===_0xa0299?_0xa0299=Object[_0x5360d0(0x380)](_0x3b25b0,_0x4c57e8):_0xa0299;if('object'==typeof Reflect&&_0x5360d0(0x2d3)==typeof Reflect['decorate'])_0x4bf533=Reflect['decorate'](_0x4ff6a6,_0x3b25b0,_0x4c57e8,_0xa0299);else{for(var _0x1028e8=_0x4ff6a6['length']-0x1;_0x1028e8>=0x0;_0x1028e8--)(_0x4e389c=_0x4ff6a6[_0x1028e8])&&(_0x4bf533=(_0xafaf62<0x3?_0x4e389c(_0x4bf533):_0xafaf62>0x3?_0x4e389c(_0x3b25b0,_0x4c57e8,_0x4bf533):_0x4e389c(_0x3b25b0,_0x4c57e8))||_0x4bf533);}return _0xafaf62>0x3&&_0x4bf533&&Object[_0x5360d0(0x1b6)](_0x3b25b0,_0x4c57e8,_0x4bf533),_0x4bf533;};Object['defineProperty'](_0x55d4bb,'__esModule',{'value':!0x0}),_0x55d4bb[_0xeafb7(0x15a)]=void 0x0;const _0x58a79b=_0x34b016(0x2),_0x3856e7=_0x34b016(0x3b),_0x193cbf=_0x34b016(0x3d),_0x38b419=_0x34b016(0x14),_0x428394=_0x34b016(0xf);let _0x31627c=class{};_0x55d4bb[_0xeafb7(0x15a)]=_0x31627c,_0x55d4bb['WebSocketModule']=_0x31627c=_0x47ef9a([(0x0,_0x58a79b['Global'])(),(0x0,_0x58a79b['Module'])({'providers':[{'provide':_0x38b419[_0xeafb7(0x387)],'useClass':'PANDA'===_0x428394[_0xeafb7(0x298)]['boxType']?_0x193cbf[_0xeafb7(0x177)]:_0x3856e7['HCWebSocketService']}],'exports':[_0x38b419['WEBSOCKET_SERVICE']]})],_0x31627c);},function(_0xf03c31,_0x23004c,_0x53ffef){const _0x112e8d=a0_0x2823;var _0x45a9aa=this&&this['__decorate']||function(_0x311901,_0x2953d8,_0x141b9d,_0x26f1d3){const _0x1ca8ea=a0_0x2823;var _0x4d75ca,_0x3ac93e=arguments[_0x1ca8ea(0x390)],_0x386898=_0x3ac93e<0x3?_0x2953d8:null===_0x26f1d3?_0x26f1d3=Object['getOwnPropertyDescriptor'](_0x2953d8,_0x141b9d):_0x26f1d3;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x386898=Reflect['decorate'](_0x311901,_0x2953d8,_0x141b9d,_0x26f1d3);else{for(var _0x486d93=_0x311901[_0x1ca8ea(0x390)]-0x1;_0x486d93>=0x0;_0x486d93--)(_0x4d75ca=_0x311901[_0x486d93])&&(_0x386898=(_0x3ac93e<0x3?_0x4d75ca(_0x386898):_0x3ac93e>0x3?_0x4d75ca(_0x2953d8,_0x141b9d,_0x386898):_0x4d75ca(_0x2953d8,_0x141b9d))||_0x386898);}return _0x3ac93e>0x3&&_0x386898&&Object[_0x1ca8ea(0x1b6)](_0x2953d8,_0x141b9d,_0x386898),_0x386898;},_0x860e89=this&&this[_0x112e8d(0x19c)]||function(_0x899a8,_0x111e82){const _0x4a0f72=_0x112e8d;if(_0x4a0f72(0x374)==typeof Reflect&&'function'==typeof Reflect['metadata'])return Reflect[_0x4a0f72(0x219)](_0x899a8,_0x111e82);};Object[_0x112e8d(0x1b6)](_0x23004c,'__esModule',{'value':!0x0}),_0x23004c['HCWebSocketService']=void 0x0;const _0x57f133=_0x53ffef(0x2),_0x103c86=_0x53ffef(0x3c),_0x4e5847=_0x53ffef(0x25),_0x2cb2dd=_0x53ffef(0x11),_0x53a2aa=_0x53ffef(0x30);let _0x3b151d=class{constructor(){const _0x5792fb=_0x112e8d;this['logger']=new _0x57f133[(_0x5792fb(0x294))]('HCWebSocketService'),this['ws']=null,this['reconnectAttempts']=0x0,this['maxReconnectAttempts']=0xa,this['reconnectDelay']=0x1388,this[_0x5792fb(0x1cc)]=[],this[_0x5792fb(0x34a)]=new Map(),this['isConnected']=!0x1,this[_0x5792fb(0x192)]=!0x1,this['wsUrl']='ws://127.0.0.1:26608';}async['onModuleInit'](){await this['connect']();}async['onModuleDestroy'](){await this['disconnect']();}async['connect'](){return new Promise((_0x434179,_0x281998)=>{const _0x4d3fc7=a0_0x2823;try{this['logger']['log'](_0x4d3fc7(0x1bf)+this[_0x4d3fc7(0x20e)]),this['ws']=new _0x103c86(this[_0x4d3fc7(0x20e)]),this['ws']['on'](_0x4d3fc7(0x1d6),()=>{const _0xf880d7=_0x4d3fc7;this['logger']['log'](_0xf880d7(0x197)),this['isConnected']=!0x0,this['reconnectAttempts']=0x0,this['processRequestQueue'](),_0x434179();}),this['ws']['on']('message',_0x355600=>{const _0x44ad40=_0x4d3fc7;try{const _0x1af616=JSON[_0x44ad40(0x36c)](_0x355600['toString']());this['handleMessage'](_0x1af616);}catch(_0x55570c){this['logger'][_0x44ad40(0x134)]('Error\x20parsing\x20WebSocket\x20message:\x20'+_0x55570c['message']);}}),this['ws']['on'](_0x4d3fc7(0x134),_0x4034b7=>{const _0x1de139=_0x4d3fc7;this['logger']['error']('WebSocket\x20error:\x20'+_0x4034b7['message']),this[_0x1de139(0x1ee)]=!0x1,0x0===this['reconnectAttempts']&&_0x281998(_0x4034b7);}),this['ws']['on']('close',()=>{const _0x3b364b=_0x4d3fc7;this['logger']['warn'](_0x3b364b(0x24c)),this['isConnected']=!0x1,this['scheduleReconnect']();});}catch(_0x2e21dc){this['logger']['error']('Error\x20creating\x20WebSocket\x20connection:\x20'+_0x2e21dc['message']),_0x281998(_0x2e21dc);}});}[_0x112e8d(0x1bc)](){const _0x43a366=_0x112e8d;if(this['reconnectAttempts']>=this['maxReconnectAttempts'])return void this['logger']['error']('Max\x20reconnection\x20attempts\x20reached');this['reconnectAttempts']++;const _0x57e4cd=this['reconnectDelay']*this['reconnectAttempts'];this['logger']['log'](_0x43a366(0x30a)+this[_0x43a366(0x186)]+'\x20in\x20'+_0x57e4cd+'ms'),setTimeout(()=>{this['connect']()['catch'](_0x31c3fd=>{const _0x11ee4b=a0_0x2823;this[_0x11ee4b(0x32b)]['error']('Reconnection\x20failed:\x20'+_0x31c3fd[_0x11ee4b(0x2c9)]);});},_0x57e4cd);}async['disconnect'](){this['ws']&&(this['ws']['close'](),this['ws']=null,this['isConnected']=!0x1);}['handleMessage'](_0x2256b3){const _0x11741b=_0x112e8d;if(this['pendingRequests']['size']>0x0){const [_0x527eca,_0x21b70d]=this['pendingRequests'][_0x11741b(0x173)]()['next']()['value'];this[_0x11741b(0x34a)][_0x11741b(0x31f)](_0x527eca),0xc8===_0x2256b3['StatusCode']?_0x21b70d['resolve'](_0x2256b3['result']):_0x21b70d['reject'](new Error('HC\x20BOX\x20error:\x20'+_0x2256b3['StatusCode']));}else this['logger']['warn']('Received\x20response\x20but\x20no\x20pending\x20requests:\x20'+JSON['stringify'](_0x2256b3));}async['processRequestQueue'](){if(this['isProcessingRequest']||0x0===this['requestQueue']['length'])return;if(!this['isConnected']||!this['ws'])return;this['isProcessingRequest']=!0x0;const {request:_0x4f6053,resolve:_0x46db32,reject:_0x5b350,timeout:_0x432c31}=this['requestQueue']['shift']();try{_0x46db32(await this['_sendRequestOnce'](_0x4f6053,_0x432c31));}catch(_0x1158f7){_0x5b350(_0x1158f7);}finally{this['isProcessingRequest']=!0x1,this['requestQueue']['length']>0x0&&setImmediate(()=>this['processRequestQueue']());}}async['_sendRequestOnce'](_0x390206,_0x598a3c=0x7530){return new Promise((_0x1d98e1,_0x85b8d4)=>{const _0x3ce9dc=a0_0x2823,_0x295f27=Date['now']()['toString']()+Math['random']()['toString'](0x24)['substr'](0x2,0x9);this['pendingRequests']['set'](_0x295f27,{'resolve':_0x1d98e1,'reject':_0x85b8d4});const _0x2b0e9c=setTimeout(()=>{this['pendingRequests']['delete'](_0x295f27),_0x85b8d4(new Error('WebSocket\x20request\x20timeout'));},_0x598a3c),_0x4774b4=_0x1d98e1,_0x4a2183=_0x85b8d4;_0x1d98e1=_0x2441bd=>{clearTimeout(_0x2b0e9c),_0x4774b4(_0x2441bd);},_0x85b8d4=_0x468345=>{clearTimeout(_0x2b0e9c),_0x4a2183(_0x468345);},this['pendingRequests'][_0x3ce9dc(0x368)](_0x295f27,{'resolve':_0x1d98e1,'reject':_0x85b8d4});try{this['ws']['send'](JSON[_0x3ce9dc(0x15d)](_0x390206));}catch(_0x202c61){this['pendingRequests']['delete'](_0x295f27),clearTimeout(_0x2b0e9c),_0x85b8d4(_0x202c61);}});}async['sendRequest'](_0x5330c6,_0x53b065=0x7530){return new Promise((_0x1e5f59,_0x3c32c8)=>{this['requestQueue']['push']({'request':_0x5330c6,'resolve':_0x1e5f59,'reject':_0x3c32c8,'timeout':_0x53b065}),this['processRequestQueue']();});}async['listDevices'](){const _0x34dc92=_0x112e8d,_0x4ebe84=await this['sendRequest']({'action':_0x34dc92(0x1b4)});return Array[_0x34dc92(0x236)](_0x4ebe84)?_0x4ebe84:[];}async[_0x112e8d(0x392)](_0x5a4ab5,_0x2e7312,_0x3f1d41,_0x11a7e6=0.2){const _0x52eb09=_0x112e8d,_0x565645=Array['isArray'](_0x5a4ab5)?_0x5a4ab5['join'](','):_0x5a4ab5;return this[_0x52eb09(0x1e2)]({'action':'click','comm':{'deviceIds':_0x565645,'x':_0x2e7312,'y':_0x3f1d41,'duration':_0x11a7e6}});}async['swipe'](_0x40dde9,_0x368a08){const _0xf68c32=_0x112e8d,_0x86b1af=Array['isArray'](_0x40dde9)?_0x40dde9[_0xf68c32(0x22c)](','):_0x40dde9;return this['sendRequest']({'action':_0xf68c32(0x1b3),'comm':{'deviceIds':_0x86b1af,..._0x368a08}});}async['captureScreen'](_0x19a6db,_0x19f33f){const _0x579d1a=_0x112e8d;return this['sendRequest']({'action':'screen','comm':{'deviceIds':_0x19a6db,...(0x0,_0x53a2aa[_0x579d1a(0x30f)])(_0x19f33f,'folderPath'),'filePath':_0x19f33f[_0x579d1a(0x295)]}});}async['home'](_0x3f0805){const _0x520502=Array['isArray'](_0x3f0805)?_0x3f0805['join'](','):_0x3f0805;return this['sendRequest']({'action':'home','comm':{'deviceIds':_0x520502}});}async['launchApp'](_0x49f6e4,_0x1a01d2){const _0x4cd0a1=Array['isArray'](_0x49f6e4)?_0x49f6e4['join'](','):_0x49f6e4;return this['sendRequest']({'action':'launchApp','comm':{'deviceIds':_0x4cd0a1,'content':_0x1a01d2}});}async[_0x112e8d(0x193)](_0x577bcf,_0x5b636f){const _0xc79040=_0x112e8d,_0x398f5d=Array[_0xc79040(0x236)](_0x577bcf)?_0x577bcf['join'](','):_0x577bcf;return this['sendRequest']({'action':'killApp','comm':{'deviceIds':_0x398f5d,'content':_0x5b636f}});}['isNumber'](_0x504ddb){return/^[0-9]$/['test'](_0x504ddb);}['isLetter'](_0x372a){return/^[a-zA-Z]$/['test'](_0x372a);}[_0x112e8d(0x189)](_0x257a70){return['@','!']['includes'](_0x257a70);}async['switchKeyboardMode'](_0x2d04ff){const _0x40188b=_0x112e8d,{x:_0x206121,y:_0x44e914}=_0x4e5847[_0x40188b(0x272)]['KEYBOARD_SWITCH'];this[_0x40188b(0x32b)]['log']('Switching\x20keyboard\x20mode\x20on\x20device\x20'+_0x2d04ff+'\x20at\x20coordinates\x20('+_0x206121+',\x20'+_0x44e914+')'),await this['click'](_0x2d04ff,_0x206121,_0x44e914,0.2),await(0x0,_0x2cb2dd['sleep'])(0x1f4),this[_0x40188b(0x32b)][_0x40188b(0x310)]('Keyboard\x20mode\x20switched\x20successfully\x20on\x20device\x20'+_0x2d04ff);}async['pressShiftKey'](_0xd64dbc){const _0x5c4fef=_0x112e8d,{x:_0xc6d9c4,y:_0x3f06cb}=_0x4e5847['COMMON_COORDINATES']['SHIFT_KEY'];this[_0x5c4fef(0x32b)]['debug']('Pressing\x20shift\x20key\x20on\x20device\x20'+_0xd64dbc+_0x5c4fef(0x322)+_0xc6d9c4+',\x20'+_0x3f06cb+')'),await this[_0x5c4fef(0x392)](_0xd64dbc,_0xc6d9c4,_0x3f06cb,0.2),await(0x0,_0x2cb2dd['sleep'])(0xc8),this['logger'][_0x5c4fef(0x343)]('Shift\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0xd64dbc);}async['pressReturnKey'](_0xd370e3){const _0xf3ed9b=_0x112e8d,{x:_0x13fd77,y:_0x2dabd4}=_0x4e5847['COMMON_COORDINATES']['RETURN_KEY'];this['logger']['log']('Pressing\x20return\x20key\x20on\x20device\x20'+_0xd370e3+'\x20at\x20coordinates\x20('+_0x13fd77+',\x20'+_0x2dabd4+')'),await this[_0xf3ed9b(0x392)](_0xd370e3,_0x13fd77,_0x2dabd4,0.2),await(0x0,_0x2cb2dd['sleep'])(0x1f4),this['logger'][_0xf3ed9b(0x310)](_0xf3ed9b(0x216)+_0xd370e3);}async['inputText'](_0x477182,_0x506ed5){const _0x46579d=_0x112e8d;if(!_0x506ed5||0x0===_0x506ed5[_0x46579d(0x390)])throw new Error('Password\x20cannot\x20be\x20empty');let _0x4e9725='letter';for(let _0x3d216f=0x0;_0x3d216f<_0x506ed5['length'];_0x3d216f++){const _0x9591ba=_0x506ed5[_0x3d216f],_0x581fbf=_0x9591ba['toLowerCase'](),_0x2a5785=_0x9591ba!==_0x581fbf&&this['isLetter'](_0x9591ba),_0x397103=this[_0x46579d(0x189)](_0x9591ba)?_0x9591ba:_0x581fbf,_0x29a81d=_0x4e5847['KEYBOARD_LAYOUT'][_0x397103];if(!_0x29a81d){this['logger'][_0x46579d(0x234)]('Character\x20\x27'+_0x9591ba+'\x27\x20not\x20found\x20in\x20keyboard\x20layout.\x20Skipping...');continue;}let _0xbfec8f=null;this['isNumber'](_0x581fbf)?_0xbfec8f='number':this['isLetter'](_0x581fbf)?_0xbfec8f='letter':this[_0x46579d(0x189)](_0x9591ba)&&(_0xbfec8f='number'),_0xbfec8f&&_0x4e9725!==_0xbfec8f&&(this['logger']['debug']('Switching\x20keyboard\x20to\x20'+_0xbfec8f+'\x20mode\x20for\x20character\x20\x27'+_0x9591ba+'\x27'),await this[_0x46579d(0x15f)](_0x477182),_0x4e9725=_0xbfec8f),_0x2a5785&&'letter'===_0x4e9725&&(this[_0x46579d(0x32b)][_0x46579d(0x343)](_0x46579d(0x2f5)+_0x9591ba+'\x27'),await this['pressShiftKey'](_0x477182)),this['logger']['debug']('Clicking\x20key\x20\x27'+_0x397103+'\x27'+(_0x2a5785?'\x20(uppercase)':'')+'\x20at\x20('+_0x29a81d['x']+',\x20'+_0x29a81d['y']+')'),await this['click'](_0x477182,_0x29a81d['x'],_0x29a81d['y'],0.15),await(0x0,_0x2cb2dd['sleep'])(0xc8);}this[_0x46579d(0x32b)]['log'](_0x46579d(0x2ab)+_0x477182);}async['inputNumpadNumber'](_0x38ad62,_0x2c5156){const _0x3013cb=_0x112e8d;if(!_0x2c5156||0x0===_0x2c5156['length'])throw new Error('value\x20cannot\x20be\x20empty');for(let _0x3cd87b=0x0;_0x3cd87b<_0x2c5156['length'];_0x3cd87b++){const _0x285a45=_0x2c5156[_0x3cd87b],_0x4ae201=_0x4e5847[_0x3013cb(0x25e)][_0x285a45];await this[_0x3013cb(0x392)](_0x38ad62,_0x4ae201['x'],_0x4ae201['y'],0.15),this[_0x3013cb(0x32b)]['debug'](_0x3013cb(0x287)+_0x285a45+'\x27\x20at\x20('+_0x4ae201['x']+',\x20'+_0x4ae201['y']+')'),await(0x0,_0x2cb2dd[_0x3013cb(0x349)])(0xc8);}}async[_0x112e8d(0x201)](_0x3932e1,_0x47b8ac,_0x8dc20c=0x1){return Promise['resolve'](null);}};_0x23004c['HCWebSocketService']=_0x3b151d,_0x23004c['HCWebSocketService']=_0x3b151d=_0x45a9aa([(0x0,_0x57f133[_0x112e8d(0x185)])(),_0x860e89('design:paramtypes',[])],_0x3b151d);},_0x1c3691=>{_0x1c3691['exports']=require('ws');},function(_0xd38995,_0x4f6dd6,_0x99a44b){const _0x5d2520=a0_0x2823;var _0x1f5ed3=this&&this['__decorate']||function(_0x446a00,_0x214139,_0x1f3485,_0x4a7988){const _0x1f39ee=a0_0x2823;var _0x54c302,_0x2eee59=arguments['length'],_0x4b7d88=_0x2eee59<0x3?_0x214139:null===_0x4a7988?_0x4a7988=Object['getOwnPropertyDescriptor'](_0x214139,_0x1f3485):_0x4a7988;if('object'==typeof Reflect&&_0x1f39ee(0x2d3)==typeof Reflect[_0x1f39ee(0x1ad)])_0x4b7d88=Reflect['decorate'](_0x446a00,_0x214139,_0x1f3485,_0x4a7988);else{for(var _0x57c2d3=_0x446a00[_0x1f39ee(0x390)]-0x1;_0x57c2d3>=0x0;_0x57c2d3--)(_0x54c302=_0x446a00[_0x57c2d3])&&(_0x4b7d88=(_0x2eee59<0x3?_0x54c302(_0x4b7d88):_0x2eee59>0x3?_0x54c302(_0x214139,_0x1f3485,_0x4b7d88):_0x54c302(_0x214139,_0x1f3485))||_0x4b7d88);}return _0x2eee59>0x3&&_0x4b7d88&&Object['defineProperty'](_0x214139,_0x1f3485,_0x4b7d88),_0x4b7d88;},_0x10a454=this&&this['__metadata']||function(_0x1aa1c7,_0x349e1d){const _0x178eb3=a0_0x2823;if(_0x178eb3(0x374)==typeof Reflect&&_0x178eb3(0x2d3)==typeof Reflect['metadata'])return Reflect[_0x178eb3(0x219)](_0x1aa1c7,_0x349e1d);};Object[_0x5d2520(0x1b6)](_0x4f6dd6,'__esModule',{'value':!0x0}),_0x4f6dd6[_0x5d2520(0x177)]=void 0x0;const _0x398ba7=_0x99a44b(0x2),_0x3d3770=_0x99a44b(0x3c),_0x214deb=_0x99a44b(0x30),_0x23b526=_0x99a44b(0x11),_0x276965=_0x99a44b(0x25);let _0x40d657=class{constructor(){const _0x506fd6=_0x5d2520;this['logger']=new _0x398ba7['Logger']('PandaWebSocketService'),this['ws']=null,this[_0x506fd6(0x186)]=0x0,this[_0x506fd6(0x2fe)]=0xa,this['reconnectDelay']=0x1388,this[_0x506fd6(0x1cc)]=[],this[_0x506fd6(0x34a)]=new Map(),this['isConnected']=!0x1,this['isProcessingRequest']=!0x1,this['wsUrl']='ws://127.0.0.1:33333';}async['onModuleInit'](){await this['connect']();}async['onModuleDestroy'](){const _0x4a3618=_0x5d2520;await this[_0x4a3618(0x314)]();}async['connect'](){return new Promise((_0x281383,_0x5b05e8)=>{const _0x1a068f=a0_0x2823;try{this['logger'][_0x1a068f(0x310)](_0x1a068f(0x145)+this['wsUrl']),this['ws']=new _0x3d3770(this['wsUrl']),this['ws']['on']('open',()=>{const _0x289a49=_0x1a068f;this['logger']['log']('Panda\x20BOX\x20WebSocket\x20connected'),this['isConnected']=!0x0,this[_0x289a49(0x186)]=0x0,this['processRequestQueue'](),_0x281383();}),this['ws']['on']('message',_0x43da5f=>{const _0x3cadf0=_0x1a068f;try{const _0x38546a=_0x43da5f[_0x3cadf0(0x288)](),_0x1265f9=JSON[_0x3cadf0(0x36c)](_0x38546a);this[_0x3cadf0(0x174)](_0x1265f9);}catch(_0x4c0adb){this['logger']['error'](_0x3cadf0(0x29b)+_0x4c0adb['message'],_0x4c0adb['stack']),this['logger']['error']('Raw\x20message\x20was:\x20'+_0x43da5f['toString']());}}),this['ws']['on']('error',_0x4b8ea2=>{const _0x373771=_0x1a068f;this['logger']['error'](_0x373771(0x2e8)+_0x4b8ea2['message']),this[_0x373771(0x1ee)]=!0x1,0x0===this['reconnectAttempts']&&_0x5b05e8(_0x4b8ea2);}),this['ws']['on']('close',()=>{const _0x2433b7=_0x1a068f;this['logger']['warn']('Panda\x20BOX\x20WebSocket\x20closed'),this[_0x2433b7(0x1ee)]=!0x1,this[_0x2433b7(0x1bc)]();});}catch(_0x1839d4){this['logger']['error']('Error\x20creating\x20WebSocket\x20connection:\x20'+_0x1839d4['message']),_0x5b05e8(_0x1839d4);}});}['scheduleReconnect'](){const _0x3dab76=_0x5d2520;if(this['reconnectAttempts']>=this['maxReconnectAttempts'])return void this[_0x3dab76(0x32b)][_0x3dab76(0x134)]('Max\x20reconnection\x20attempts\x20reached');this[_0x3dab76(0x186)]++;const _0x2763aa=this['reconnectDelay']*this['reconnectAttempts'];this[_0x3dab76(0x32b)]['log']('Scheduling\x20reconnect\x20attempt\x20'+this['reconnectAttempts']+'\x20in\x20'+_0x2763aa+'ms'),setTimeout(()=>{const _0x3d2b68=_0x3dab76;this[_0x3d2b68(0x222)]()['catch'](_0x1ddd10=>{const _0x35390c=_0x3d2b68;this[_0x35390c(0x32b)]['error']('Reconnection\x20failed:\x20'+_0x1ddd10[_0x35390c(0x2c9)]);});},_0x2763aa);}async['disconnect'](){this['ws']&&(this['ws']['close'](),this['ws']=null,this['isConnected']=!0x1);}[_0x5d2520(0x174)](_0xa22170){const _0x531cb6=_0x5d2520;if(this['pendingRequests']['size']>0x0){const [_0xd95c4f,_0x577d80]=this['pendingRequests'][_0x531cb6(0x173)]()['next']()['value'];if(this['pendingRequests']['delete'](_0xd95c4f),0x2710===_0xa22170[_0x531cb6(0x33e)])_0x577d80['resolve'](_0xa22170['data']);else{const _0x2de51b=_0xa22170['message']||_0x531cb6(0x370)+_0xa22170['code'];_0x577d80[_0x531cb6(0x362)](new Error(_0x2de51b));}}else{if(Array['isArray'](_0xa22170['data'])&&_0xa22170['data'][_0x531cb6(0x390)]>0x0&&void 0x0!==_0xa22170[_0x531cb6(0x25c)][0x0]?.[_0x531cb6(0x1fa)]&&0x2710===_0xa22170[_0x531cb6(0x33e)]){const _0x3fcf62=_0xa22170['data'];this['logger']['debug']('Received\x20unsolicited\x20device\x20list\x20update\x20(no\x20pending\x20requests):\x20'+_0x3fcf62['length']+_0x531cb6(0x221));}else this[_0x531cb6(0x32b)]['warn'](_0x531cb6(0x2ea)+JSON['stringify'](_0xa22170));}}async[_0x5d2520(0x261)](){const _0x36ff31=_0x5d2520;if(this[_0x36ff31(0x192)]||0x0===this[_0x36ff31(0x1cc)]['length'])return;if(!this['isConnected']||!this['ws'])return;this['isProcessingRequest']=!0x0;const {request:_0x1f0b7e,resolve:_0x3bff17,reject:_0x21256c,timeout:_0x1b1f8a}=this[_0x36ff31(0x1cc)]['shift']();try{_0x3bff17(await this[_0x36ff31(0x286)](_0x1f0b7e,_0x1b1f8a));}catch(_0x53995e){_0x21256c(_0x53995e);}finally{this['isProcessingRequest']=!0x1,this[_0x36ff31(0x1cc)]['length']>0x0&&setImmediate(()=>this[_0x36ff31(0x261)]());}}async['_sendRequestOnce'](_0x3bb14b,_0x3b492f=0x7530){return new Promise((_0x3f40d5,_0x51b694)=>{const _0x400089=a0_0x2823,_0x49e619=Date[_0x400089(0x1b5)]()[_0x400089(0x288)]()+Math[_0x400089(0x1b9)]()[_0x400089(0x288)](0x24)['substr'](0x2,0x9);this['pendingRequests']['set'](_0x49e619,{'resolve':_0x3f40d5,'reject':_0x51b694});const _0x1c6c13=setTimeout(()=>{const _0x4cb759=_0x400089;this['pendingRequests'][_0x4cb759(0x31f)](_0x49e619),_0x51b694(new Error(_0x4cb759(0x2e9)));},_0x3b492f),_0x5a4987=_0x3f40d5,_0x4b2051=_0x51b694;_0x3f40d5=_0x1e606c=>{clearTimeout(_0x1c6c13),_0x5a4987(_0x1e606c);},_0x51b694=_0x206330=>{clearTimeout(_0x1c6c13),_0x4b2051(_0x206330);},this['pendingRequests']['set'](_0x49e619,{'resolve':_0x3f40d5,'reject':_0x51b694});try{const _0xa26624=JSON['stringify'](_0x3bb14b);this['ws'][_0x400089(0x170)](_0xa26624);}catch(_0x46a56c){this['logger']['error']('Error\x20sending\x20WebSocket\x20request:\x20'+_0x46a56c['message'],_0x46a56c['stack']),this['pendingRequests'][_0x400089(0x31f)](_0x49e619),clearTimeout(_0x1c6c13),_0x51b694(_0x46a56c);}});}async['sendRequest'](_0x274e21,_0x21e75e=0x7530){return new Promise((_0x314dc8,_0x56b0cf)=>{const _0x11cdeb=a0_0x2823;this['requestQueue'][_0x11cdeb(0x136)]({'request':_0x274e21,'resolve':_0x314dc8,'reject':_0x56b0cf,'timeout':_0x21e75e}),this['processRequestQueue']();});}async['listDevices'](){const _0x14a584=_0x5d2520,_0xe07e3d=(await this['sendRequest']({'action':_0x14a584(0x1b4)}))['map'](_0x3dcdb2=>({..._0x3dcdb2,'udid':_0x3dcdb2['serial']}));return _0xe07e3d[_0x14a584(0x390)]<=0x0&&this['logger']['error']('No\x20devices\x20found!'),_0xe07e3d;}async['click'](_0x41fb8a,_0x2ea622,_0x4a9113,_0x23dd61=0.2){const _0x396e49=_0x5d2520;return this['sendRequest']({'action':'pointerEvent','devices':Array['isArray'](_0x41fb8a)?_0x41fb8a[_0x396e49(0x22c)](','):_0x41fb8a,'data':{'type':'10','x':(0x0,_0x214deb['toString'])(_0x2ea622),'y':(0x0,_0x214deb[_0x396e49(0x288)])(_0x4a9113)}});}async[_0x5d2520(0x1b3)](_0x2161fa,_0x91e92f){const _0x2e2250=_0x5d2520,_0x1c2dab=Array[_0x2e2250(0x236)](_0x2161fa)?_0x2161fa['join'](','):_0x2161fa;return this['sendRequest']({'action':'pointerEvent','devices':_0x1c2dab,'data':_0x91e92f});}async[_0x5d2520(0x1da)](_0x32b9b6,_0x3fe99b){const _0x40763a=_0x5d2520;return this['sendRequest']({'action':_0x40763a(0x18f),'devices':_0x32b9b6,'data':{'savePath':_0x3fe99b['folderPath']}});}async[_0x5d2520(0x167)](_0x70d688){return this['sendRequest']({'action':'pushEvent','devices':_0x70d688,'data':{'type':'2'}});}async['launchApp'](_0xd76b15,_0x3f0067){const _0xfc9ac6=_0x5d2520,_0x3c7559=Array['isArray'](_0xd76b15)?_0xd76b15['join'](','):_0xd76b15;return this['sendRequest']({'action':_0xfc9ac6(0x2d5),'devices':_0x3c7559,'data':{'app':_0x3f0067}});}async['killApp'](_0x3b6468,_0x3f245c){const _0x732f49=_0x5d2520,_0x351975=Array['isArray'](_0x3b6468)?_0x3b6468['join'](','):_0x3b6468;return this[_0x732f49(0x1e2)]({'action':'stopApp','devices':_0x351975,'data':{'app':_0x3f245c}});}async['switchKeyboardMode'](_0x22151e){const _0x135e77=_0x5d2520,{x:_0x50bd9c,y:_0x5951a4}=_0x276965['COMMON_COORDINATES']['KEYBOARD_SWITCH'];this['logger']['log'](_0x135e77(0x268)+_0x22151e+'\x20at\x20coordinates\x20('+_0x50bd9c+',\x20'+_0x5951a4+')'),await this['click'](_0x22151e,0x64*_0x50bd9c,0x64*_0x5951a4,0.2),await(0x0,_0x23b526['sleep'])(0x1f4),this['logger'][_0x135e77(0x310)]('Keyboard\x20mode\x20switched\x20successfully\x20on\x20device\x20'+_0x22151e);}async[_0x5d2520(0x16d)](_0xa1f009){const _0x6f17b=_0x5d2520,{x:_0x122277,y:_0x1bf3b2}=_0x276965['COMMON_COORDINATES']['SHIFT_KEY'];this['logger']['debug'](_0x6f17b(0x2b2)+_0xa1f009+_0x6f17b(0x322)+_0x122277+',\x20'+_0x1bf3b2+')'),await this['click'](_0xa1f009,0x64*_0x122277,0x64*_0x1bf3b2,0.2),await(0x0,_0x23b526['sleep'])(0xc8),this['logger']['debug']('Shift\x20key\x20pressed\x20successfully\x20on\x20device\x20'+_0xa1f009);}async[_0x5d2520(0x1cb)](_0x400bac){const _0x62d433=_0x5d2520,{x:_0x59674f,y:_0x1cf2d1}=_0x276965[_0x62d433(0x272)]['RETURN_KEY'];this['logger']['log']('Pressing\x20return\x20key\x20on\x20device\x20'+_0x400bac+'\x20at\x20coordinates\x20('+_0x59674f+',\x20'+_0x1cf2d1+')'),await this[_0x62d433(0x392)](_0x400bac,0x64*_0x59674f,0x64*_0x1cf2d1,0.2),await(0x0,_0x23b526[_0x62d433(0x349)])(0x1f4),this[_0x62d433(0x32b)]['log'](_0x62d433(0x216)+_0x400bac);}async['inputText'](_0x311353,_0x4e4bbc){const _0x3bac1c=_0x5d2520,_0x1dbc2f=Array['isArray'](_0x311353)?_0x311353[_0x3bac1c(0x22c)](','):_0x311353;return this['sendRequest']({'action':_0x3bac1c(0x359),'devices':_0x1dbc2f,'data':{'content':_0x4e4bbc}});}async['inputNumpadNumber'](_0x1bf57b,_0x5256b7){const _0x167978=_0x5d2520;if(!_0x5256b7||0x0===_0x5256b7['length'])throw new Error('value\x20cannot\x20be\x20empty');for(let _0x7e1647=0x0;_0x7e1647<_0x5256b7['length'];_0x7e1647++){const _0x57eebe=_0x5256b7[_0x7e1647],_0x1a6ea5=_0x276965['NUMPAD_LAYOUT'][_0x57eebe];await this[_0x167978(0x392)](_0x1bf57b,_0x1a6ea5['x'],_0x1a6ea5['y']),this[_0x167978(0x32b)][_0x167978(0x343)]('Clicking\x20key\x20\x27'+_0x57eebe+'\x27\x20at\x20('+_0x1a6ea5['x']+',\x20'+_0x1a6ea5['y']+')'),await(0x0,_0x23b526['sleep'])(0xc8);}}async['transferFile'](_0x5bef8d,_0x3214c9,_0x498102=0x1){const _0x40ba10=_0x5d2520,_0x365afa=Array[_0x40ba10(0x236)](_0x5bef8d)?_0x5bef8d['join'](','):_0x5bef8d;return this['logger']['log']('Transferring\x20file\x20'+_0x3214c9+_0x40ba10(0x2ca)+_0x365afa+'\x20with\x20fileType\x20'+_0x498102),this['sendRequest']({'action':'uploadFile','devices':_0x365afa,'data':{'filePath':_0x3214c9,'fileType':_0x498102}});}};_0x4f6dd6[_0x5d2520(0x177)]=_0x40d657,_0x4f6dd6[_0x5d2520(0x177)]=_0x40d657=_0x1f5ed3([(0x0,_0x398ba7[_0x5d2520(0x185)])(),_0x10a454('design:paramtypes',[])],_0x40d657);},function(_0x181a1c,_0x23c879,_0x33d0c8){const _0x580ae9=a0_0x2823;var _0x4bfd18,_0x273a21,_0xd58e94,_0xe44d19=this&&this['__decorate']||function(_0x2b293e,_0xf390cd,_0x40e5bf,_0x1517f4){const _0xe0b372=a0_0x2823;var _0x368957,_0x25152e=arguments['length'],_0x216509=_0x25152e<0x3?_0xf390cd:null===_0x1517f4?_0x1517f4=Object[_0xe0b372(0x380)](_0xf390cd,_0x40e5bf):_0x1517f4;if('object'==typeof Reflect&&_0xe0b372(0x2d3)==typeof Reflect['decorate'])_0x216509=Reflect['decorate'](_0x2b293e,_0xf390cd,_0x40e5bf,_0x1517f4);else{for(var _0x543915=_0x2b293e['length']-0x1;_0x543915>=0x0;_0x543915--)(_0x368957=_0x2b293e[_0x543915])&&(_0x216509=(_0x25152e<0x3?_0x368957(_0x216509):_0x25152e>0x3?_0x368957(_0xf390cd,_0x40e5bf,_0x216509):_0x368957(_0xf390cd,_0x40e5bf))||_0x216509);}return _0x25152e>0x3&&_0x216509&&Object[_0xe0b372(0x1b6)](_0xf390cd,_0x40e5bf,_0x216509),_0x216509;},_0x14e118=this&&this[_0x580ae9(0x19c)]||function(_0x39a31f,_0x5ead46){const _0x13f687=_0x580ae9;if('object'==typeof Reflect&&'function'==typeof Reflect[_0x13f687(0x219)])return Reflect['metadata'](_0x39a31f,_0x5ead46);};Object['defineProperty'](_0x23c879,_0x580ae9(0x143),{'value':!0x0}),_0x23c879['SessionRefreshScheduler']=void 0x0;const _0x4778b2=_0x33d0c8(0x2),_0x1d58da=_0x33d0c8(0x7),_0x13498e=_0x33d0c8(0x12),_0x159ba9=_0x33d0c8(0x15),_0x44a156=_0x33d0c8(0x2b);let _0x1dadf0=class{constructor(_0x520c88,_0x21a0f8,_0x259b0a){const _0xfdde21=_0x580ae9;this[_0xfdde21(0x246)]=_0x520c88,this['deviceService']=_0x21a0f8,this['sessionManagement']=_0x259b0a,this['logger']=new _0x4778b2['Logger'](_0xfdde21(0x305));}async['refreshSessions'](){const _0x548bb9=_0x580ae9;try{if(_0x548bb9(0x1a8)!==await this['deviceService']['getServiceStatus']())return;const _0x17d740=(await this['deviceService']['listDevices']())['filter'](_0x155d5f=>_0x548bb9(0x1a8)===_0x155d5f[_0x548bb9(0x263)]&&_0x155d5f['bankCode']);for(const _0x27057d of _0x17d740){const _0x3dca21=_0x27057d[_0x548bb9(0x31a)]['toUpperCase']();try{await this['bankService'][_0x548bb9(0x1a3)](_0x27057d['udid'],_0x3dca21);}catch(_0x3cf532){this['logger']['error']('Error\x20refreshing\x20session\x20for\x20device\x20'+_0x27057d[_0x548bb9(0x20a)]+_0x548bb9(0x178)+_0x3dca21+':\x20'+_0x3cf532['message']);}}}catch(_0x58e662){this['logger']['error']('Error\x20in\x20session\x20refresh\x20scheduler:\x20'+_0x58e662['message']);}}};_0x23c879['SessionRefreshScheduler']=_0x1dadf0,_0xe44d19([(0x0,_0x1d58da['Cron'])(_0x1d58da['CronExpression']['EVERY_30_SECONDS']),_0x14e118('design:type',Function),_0x14e118(_0x580ae9(0x381),[]),_0x14e118('design:returntype',Promise)],_0x1dadf0[_0x580ae9(0x1e9)],_0x580ae9(0x1d4),null),_0x23c879['SessionRefreshScheduler']=_0x1dadf0=_0xe44d19([(0x0,_0x4778b2[_0x580ae9(0x185)])(),_0x14e118('design:paramtypes',['function'==typeof(_0x4bfd18=void 0x0!==_0x13498e['BankService']&&_0x13498e['BankService'])?_0x4bfd18:Object,'function'==typeof(_0x273a21=void 0x0!==_0x159ba9['DeviceService']&&_0x159ba9['DeviceService'])?_0x273a21:Object,_0x580ae9(0x2d3)==typeof(_0xd58e94=void 0x0!==_0x44a156['SessionManagementService']&&_0x44a156['SessionManagementService'])?_0xd58e94:Object])],_0x1dadf0);},function(_0x42f7a2,_0x581141,_0x58479d){const _0x33209f=a0_0x2823;var _0x1be113=this&&this['__decorate']||function(_0xf4961a,_0x587a1d,_0x3e629f,_0x4634a0){const _0xdce2a4=a0_0x2823;var _0x35d22e,_0x1cd3c7=arguments['length'],_0x5d369f=_0x1cd3c7<0x3?_0x587a1d:null===_0x4634a0?_0x4634a0=Object['getOwnPropertyDescriptor'](_0x587a1d,_0x3e629f):_0x4634a0;if('object'==typeof Reflect&&'function'==typeof Reflect['decorate'])_0x5d369f=Reflect['decorate'](_0xf4961a,_0x587a1d,_0x3e629f,_0x4634a0);else{for(var _0x503750=_0xf4961a[_0xdce2a4(0x390)]-0x1;_0x503750>=0x0;_0x503750--)(_0x35d22e=_0xf4961a[_0x503750])&&(_0x5d369f=(_0x1cd3c7<0x3?_0x35d22e(_0x5d369f):_0x1cd3c7>0x3?_0x35d22e(_0x587a1d,_0x3e629f,_0x5d369f):_0x35d22e(_0x587a1d,_0x3e629f))||_0x5d369f);}return _0x1cd3c7>0x3&&_0x5d369f&&Object['defineProperty'](_0x587a1d,_0x3e629f,_0x5d369f),_0x5d369f;};Object['defineProperty'](_0x581141,'__esModule',{'value':!0x0}),_0x581141['OCRModule']=void 0x0;const _0x5bb819=_0x58479d(0x2),_0x5d3bfe=_0x58479d(0x1e),_0x1018e2=_0x58479d(0x20),_0x53ce17=_0x58479d(0x1d);let _0x644741=class{};_0x581141['OCRModule']=_0x644741,_0x581141[_0x33209f(0x2f9)]=_0x644741=_0x1be113([(0x0,_0x5bb819['Module'])({'providers':[_0x5d3bfe[_0x33209f(0x1d0)],_0x1018e2['ImagePreprocessingService'],_0x53ce17[_0x33209f(0x2ac)]],'exports':[_0x53ce17['OCRService'],_0x5d3bfe['OCRWorkerPoolService'],_0x1018e2['ImagePreprocessingService']]})],_0x644741);}],_0x13742f={};function _0x23ec88(_0x2ee832){const _0x3f2339=a0_0x2823;var _0x2577d7=_0x13742f[_0x2ee832];if(void 0x0!==_0x2577d7)return _0x2577d7[_0x3f2339(0x140)];var _0x18fdaf=_0x13742f[_0x2ee832]={'exports':{}};return _0x576df9[_0x2ee832]['call'](_0x18fdaf['exports'],_0x18fdaf,_0x18fdaf[_0x3f2339(0x140)],_0x23ec88),_0x18fdaf[_0x3f2339(0x140)];}var _0x4d8499={};((()=>{var _0x370e91=_0x4d8499;Object['defineProperty'](_0x370e91,'__esModule',{'value':!0x0});const _0x497b21=_0x23ec88(0x1),_0x197ea0=_0x23ec88(0x2),_0x2e7bc3=_0x23ec88(0x3),_0x579ad5=_0x23ec88(0x4),_0x3592f6=_0x23ec88(0x5),_0x265983=_0x23ec88(0xf);!(async function(){const _0xd4ec14=a0_0x2823,_0x271728=await _0x497b21['NestFactory']['create'](_0x3592f6['AppModule']),_0x4282df=new _0x197ea0['Logger']('Bootstrap'),_0x3dda23=_0xd4ec14(0x258)===process['env']['NODE_ENV']?(0x0,_0x579ad5['join'])(__dirname,_0xd4ec14(0x137)):(0x0,_0x579ad5['join'])(process['cwd'](),'src','views');_0x271728[_0xd4ec14(0x34b)](_0x3dda23),_0x271728['setViewEngine'](_0xd4ec14(0x1e6)),_0x4282df['log']('Views\x20directory:\x20'+_0x3dda23),_0x271728['useGlobalPipes'](new _0x197ea0['ValidationPipe']({'transform':!0x0,'whitelist':!0x0,'forbidNonWhitelisted':!0x0}));const _0x112b35=new _0x2e7bc3['DocumentBuilder']()['setTitle'](_0xd4ec14(0x1dc))['setDescription']('Automated\x20withdrawal\x20processing\x20service\x20with\x20HC\x20BOX\x20integration')['setVersion']('1.0')['addTag'](_0xd4ec14(0x34f),_0xd4ec14(0x1d3))[_0xd4ec14(0x152)]('withdrawal','Withdrawal\x20processing')['addTag'](_0xd4ec14(0x38e),'Device\x20management')['addTag']('hcbox','HC\x20Box\x20integration')['build'](),_0x22be9c=_0x2e7bc3['SwaggerModule'][_0xd4ec14(0x21b)](_0x271728,_0x112b35);_0x2e7bc3['SwaggerModule']['setup']('docs',_0x271728,_0x22be9c);const _0x290b05=process[_0xd4ec14(0x2a9)][_0xd4ec14(0x1e3)]||0xbba;_0x4282df['log']('ðŸ“š\x20Swagger\x20documentation\x20available\x20at:\x20http://localhost:'+_0x290b05+'/docs'),await _0x271728['listen'](_0x290b05),_0x4282df['log']('ðŸš€\x20EzPay\x20Auto\x20is\x20running\x20on:\x20http://localhost:'+_0x290b05),_0x4282df[_0xd4ec14(0x310)]('ðŸ“Š\x20Withdrawal\x20processing\x20started\x20by\x20'+_0x265983[_0xd4ec14(0x298)]['boxType']+'\x20box'),_0x4282df[_0xd4ec14(0x310)](_0xd4ec14(0x33d)+_0x290b05);}());})());})()));
//# sourceMappingURL=main.js.map
//# sourceMappingURL=main.js.map